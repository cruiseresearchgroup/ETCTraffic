Traceback (most recent call last):
  File "run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 2, in <module>
    from exp.exp_basic import Exp_Basic
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_basic.py", line 3, in <module>
    from models import Autoformer, Transformer, TimesNet, Nonstationary_Transformer, DLinear, FEDformer, \
  File "/g/data/hn98/du/exlts/ddd2/models/Mamba.py", line 7, in <module>
    from mamba_ssm import Mamba
ModuleNotFoundError: No module named 'mamba_ssm'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems07_all_filter10.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems07_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164097
val 247681
test 247681
	iters: 100, epoch: 1 | loss: 1.7543552
	speed: 0.3456s/iter; left time: 25105.1469s
	iters: 200, epoch: 1 | loss: 1.7450544
	speed: 0.3351s/iter; left time: 24313.7952s
	iters: 300, epoch: 1 | loss: 1.6515017
	speed: 0.3343s/iter; left time: 24222.9074s
	iters: 400, epoch: 1 | loss: 1.6023448
	speed: 0.3345s/iter; left time: 24203.9924s
	iters: 500, epoch: 1 | loss: 1.7274110
	speed: 0.3345s/iter; left time: 24167.4426s
	iters: 600, epoch: 1 | loss: 1.6333499
	speed: 0.3348s/iter; left time: 24158.1121s
	iters: 700, epoch: 1 | loss: 1.7106451
	speed: 0.3345s/iter; left time: 24104.1040s
	iters: 800, epoch: 1 | loss: 1.5022128
	speed: 0.3346s/iter; left time: 24077.0169s
	iters: 900, epoch: 1 | loss: 1.6771171
	speed: 0.3346s/iter; left time: 24043.7287s
	iters: 1000, epoch: 1 | loss: 1.3861300
	speed: 0.3346s/iter; left time: 24005.0422s
	iters: 1100, epoch: 1 | loss: 1.4655939
	speed: 0.3346s/iter; left time: 23974.6377s
	iters: 1200, epoch: 1 | loss: 1.6639563
	speed: 0.3346s/iter; left time: 23944.4389s
	iters: 1300, epoch: 1 | loss: 1.6788809
	speed: 0.3347s/iter; left time: 23915.3182s
	iters: 1400, epoch: 1 | loss: 1.6156821
	speed: 0.3348s/iter; left time: 23891.1261s
	iters: 1500, epoch: 1 | loss: 1.8057398
	speed: 0.3353s/iter; left time: 23887.5727s
	iters: 1600, epoch: 1 | loss: 1.4639741
	speed: 0.3350s/iter; left time: 23838.5369s
	iters: 1700, epoch: 1 | loss: 1.5992247
	speed: 0.3346s/iter; left time: 23773.7048s
	iters: 1800, epoch: 1 | loss: 1.8115389
	speed: 0.3351s/iter; left time: 23775.3485s
	iters: 1900, epoch: 1 | loss: 1.6576411
	speed: 0.3345s/iter; left time: 23699.8877s
	iters: 2000, epoch: 1 | loss: 1.6239469
	speed: 0.3348s/iter; left time: 23686.8294s
	iters: 2100, epoch: 1 | loss: 1.5550904
	speed: 0.3346s/iter; left time: 23639.7406s
	iters: 2200, epoch: 1 | loss: 1.5951502
	speed: 0.3346s/iter; left time: 23607.7231s
	iters: 2300, epoch: 1 | loss: 1.6723001
	speed: 0.3345s/iter; left time: 23565.6163s
	iters: 2400, epoch: 1 | loss: 1.7576463
	speed: 0.3347s/iter; left time: 23548.4388s
	iters: 2500, epoch: 1 | loss: 1.6632853
	speed: 0.3341s/iter; left time: 23472.1833s
	iters: 2600, epoch: 1 | loss: 1.7226090
	speed: 0.3344s/iter; left time: 23460.8480s
	iters: 2700, epoch: 1 | loss: 1.8639827
	speed: 0.3347s/iter; left time: 23447.8506s
	iters: 2800, epoch: 1 | loss: 1.7821934
	speed: 0.3347s/iter; left time: 23410.4888s
	iters: 2900, epoch: 1 | loss: 1.7015029
	speed: 0.3347s/iter; left time: 23376.0558s
	iters: 3000, epoch: 1 | loss: 1.7349159
	speed: 0.3345s/iter; left time: 23330.8188s
	iters: 3100, epoch: 1 | loss: 1.7100112
	speed: 0.3347s/iter; left time: 23311.4262s
	iters: 3200, epoch: 1 | loss: 1.6801941
	speed: 0.3344s/iter; left time: 23260.6051s
	iters: 3300, epoch: 1 | loss: 1.7134266
	speed: 0.3346s/iter; left time: 23235.6493s
	iters: 3400, epoch: 1 | loss: 1.5125415
	speed: 0.3344s/iter; left time: 23193.3769s
	iters: 3500, epoch: 1 | loss: 1.7529843
	speed: 0.3346s/iter; left time: 23171.2641s
	iters: 3600, epoch: 1 | loss: 1.7972822
	speed: 0.3344s/iter; left time: 23125.1412s
	iters: 3700, epoch: 1 | loss: 1.5634514
	speed: 0.3346s/iter; left time: 23104.5219s
	iters: 3800, epoch: 1 | loss: 1.6725014
	speed: 0.3346s/iter; left time: 23073.8534s
	iters: 3900, epoch: 1 | loss: 1.6389558
	speed: 0.3351s/iter; left time: 23071.8540s
	iters: 4000, epoch: 1 | loss: 1.6679701
	speed: 0.3350s/iter; left time: 23030.1089s
	iters: 4100, epoch: 1 | loss: 1.5963005
	speed: 0.3345s/iter; left time: 22962.0702s
	iters: 4200, epoch: 1 | loss: 1.7442014
	speed: 0.3347s/iter; left time: 22943.4166s
	iters: 4300, epoch: 1 | loss: 1.7792383
	speed: 0.3346s/iter; left time: 22903.9512s
	iters: 4400, epoch: 1 | loss: 1.7343825
	speed: 0.3349s/iter; left time: 22887.9905s
	iters: 4500, epoch: 1 | loss: 1.7392064
	speed: 0.3346s/iter; left time: 22836.3645s
	iters: 4600, epoch: 1 | loss: 1.6929039
	speed: 0.3347s/iter; left time: 22808.9104s
	iters: 4700, epoch: 1 | loss: 1.6938041
	speed: 0.3345s/iter; left time: 22765.7223s
	iters: 4800, epoch: 1 | loss: 1.6584489
	speed: 0.3348s/iter; left time: 22750.4052s
	iters: 4900, epoch: 1 | loss: 1.8164387
	speed: 0.3346s/iter; left time: 22704.3242s
	iters: 5000, epoch: 1 | loss: 1.4529303
	speed: 0.3347s/iter; left time: 22678.2921s
	iters: 5100, epoch: 1 | loss: 1.6827776
	speed: 0.3346s/iter; left time: 22638.1027s
	iters: 5200, epoch: 1 | loss: 1.6754501
	speed: 0.3345s/iter; left time: 22597.5893s
	iters: 5300, epoch: 1 | loss: 1.8571603
	speed: 0.3345s/iter; left time: 22564.2076s
	iters: 5400, epoch: 1 | loss: 1.6735901
	speed: 0.3350s/iter; left time: 22562.7247s
	iters: 5500, epoch: 1 | loss: 1.6495010
	speed: 0.3351s/iter; left time: 22536.4442s
	iters: 5600, epoch: 1 | loss: 1.6588346
	speed: 0.3350s/iter; left time: 22495.5912s
	iters: 5700, epoch: 1 | loss: 1.6554620
	speed: 0.3347s/iter; left time: 22439.6918s
	iters: 5800, epoch: 1 | loss: 1.5777959
	speed: 0.3350s/iter; left time: 22425.7522s
	iters: 5900, epoch: 1 | loss: 1.7087992
	speed: 0.3345s/iter; left time: 22358.6561s
	iters: 6000, epoch: 1 | loss: 1.7302020
	speed: 0.3345s/iter; left time: 22329.7373s
	iters: 6100, epoch: 1 | loss: 1.5609673
	speed: 0.3345s/iter; left time: 22291.4797s
	iters: 6200, epoch: 1 | loss: 1.7343863
	speed: 0.3347s/iter; left time: 22271.5571s
	iters: 6300, epoch: 1 | loss: 1.5750556
	speed: 0.3346s/iter; left time: 22235.6485s
	iters: 6400, epoch: 1 | loss: 1.7199203
	speed: 0.3350s/iter; left time: 22230.0565s
	iters: 6500, epoch: 1 | loss: 1.6772900
	speed: 0.3347s/iter; left time: 22172.4152s
	iters: 6600, epoch: 1 | loss: 1.8157096
	speed: 0.3348s/iter; left time: 22147.1510s
	iters: 6700, epoch: 1 | loss: 1.6693904
	speed: 0.3346s/iter; left time: 22103.6110s
	iters: 6800, epoch: 1 | loss: 1.6629510
	speed: 0.3347s/iter; left time: 22074.1106s
	iters: 6900, epoch: 1 | loss: 1.6804450
	speed: 0.3353s/iter; left time: 22081.0192s
	iters: 7000, epoch: 1 | loss: 1.6823362
	speed: 0.3351s/iter; left time: 22034.3540s
	iters: 7100, epoch: 1 | loss: 1.7087630
	speed: 0.3343s/iter; left time: 21945.3015s
	iters: 7200, epoch: 1 | loss: 1.7448609
	speed: 0.3348s/iter; left time: 21944.2548s
Epoch: 1 cost time: 2436.2802362442017
Epoch: 1, Steps: 7275 | Train Loss: 1.6512043 Vali Loss: 1.6783564 Test Loss: 1.8118876
Validation loss decreased (inf --> 1.678356).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6316724
	speed: 7.4131s/iter; left time: 484641.7507s
	iters: 200, epoch: 2 | loss: 1.7356490
	speed: 0.3342s/iter; left time: 21817.7396s
	iters: 300, epoch: 2 | loss: 1.5585079
	speed: 0.3344s/iter; left time: 21794.1045s
	iters: 400, epoch: 2 | loss: 1.5416079
	speed: 0.3348s/iter; left time: 21790.2751s
	iters: 500, epoch: 2 | loss: 1.7785506
	speed: 0.3346s/iter; left time: 21738.5564s
	iters: 600, epoch: 2 | loss: 1.5904331
	speed: 0.3347s/iter; left time: 21714.8885s
	iters: 700, epoch: 2 | loss: 1.6902965
	speed: 0.3350s/iter; left time: 21699.5520s
	iters: 800, epoch: 2 | loss: 1.8536884
	speed: 0.3346s/iter; left time: 21638.7531s
	iters: 900, epoch: 2 | loss: 1.7251887
	speed: 0.3348s/iter; left time: 21621.8766s
	iters: 1000, epoch: 2 | loss: 1.5531132
	speed: 0.3346s/iter; left time: 21570.6079s
	iters: 1100, epoch: 2 | loss: 1.7238115
	speed: 0.3348s/iter; left time: 21550.1353s
	iters: 1200, epoch: 2 | loss: 1.6170292
	speed: 0.3345s/iter; left time: 21498.7816s
	iters: 1300, epoch: 2 | loss: 1.7230065
	speed: 0.3352s/iter; left time: 21510.7708s
	iters: 1400, epoch: 2 | loss: 1.5456650
	speed: 0.3353s/iter; left time: 21484.3423s
	iters: 1500, epoch: 2 | loss: 1.7286761
	speed: 0.3351s/iter; left time: 21435.7476s
	iters: 1600, epoch: 2 | loss: 1.6728942
	speed: 0.3346s/iter; left time: 21371.0306s
	iters: 1700, epoch: 2 | loss: 1.5512154
	speed: 0.3347s/iter; left time: 21343.9472s
	iters: 1800, epoch: 2 | loss: 1.6491179
	speed: 0.3346s/iter; left time: 21303.2322s
	iters: 1900, epoch: 2 | loss: 1.5857239
	speed: 0.3348s/iter; left time: 21286.5664s
	iters: 2000, epoch: 2 | loss: 1.6174135
	speed: 0.3345s/iter; left time: 21234.2313s
	iters: 2100, epoch: 2 | loss: 1.7736183
	speed: 0.3351s/iter; left time: 21234.5477s
	iters: 2200, epoch: 2 | loss: 1.4606404
	speed: 0.3354s/iter; left time: 21220.8223s
	iters: 2300, epoch: 2 | loss: 1.6297244
	speed: 0.3347s/iter; left time: 21146.7666s
	iters: 2400, epoch: 2 | loss: 1.8965154
	speed: 0.3347s/iter; left time: 21110.1407s
	iters: 2500, epoch: 2 | loss: 1.6238532
	speed: 0.3348s/iter; left time: 21081.5300s
	iters: 2600, epoch: 2 | loss: 1.7723471
	speed: 0.3346s/iter; left time: 21039.6715s
	iters: 2700, epoch: 2 | loss: 1.6457043
	speed: 0.3350s/iter; left time: 21028.8289s
	iters: 2800, epoch: 2 | loss: 1.6416529
	speed: 0.3346s/iter; left time: 20970.0237s
	iters: 2900, epoch: 2 | loss: 1.6395848
	speed: 0.3352s/iter; left time: 20975.2508s
	iters: 3000, epoch: 2 | loss: 1.5854758
	speed: 0.3352s/iter; left time: 20944.7972s
	iters: 3100, epoch: 2 | loss: 1.3508931
	speed: 0.3348s/iter; left time: 20881.1492s
	iters: 3200, epoch: 2 | loss: 1.6369091
	speed: 0.3346s/iter; left time: 20838.2760s
	iters: 3300, epoch: 2 | loss: 1.4803724
	speed: 0.3347s/iter; left time: 20808.5378s
	iters: 3400, epoch: 2 | loss: 1.6295378
	speed: 0.3341s/iter; left time: 20740.3861s
	iters: 3500, epoch: 2 | loss: 1.6348521
	speed: 0.3341s/iter; left time: 20706.4995s
	iters: 3600, epoch: 2 | loss: 1.6683104
	speed: 0.3344s/iter; left time: 20692.6918s
	iters: 3700, epoch: 2 | loss: 1.6899650
	speed: 0.3341s/iter; left time: 20640.1720s
	iters: 3800, epoch: 2 | loss: 1.8238083
	speed: 0.3342s/iter; left time: 20609.3373s
	iters: 3900, epoch: 2 | loss: 1.5921392
	speed: 0.3341s/iter; left time: 20574.0483s
	iters: 4000, epoch: 2 | loss: 1.6920938
	speed: 0.3344s/iter; left time: 20560.1668s
	iters: 4100, epoch: 2 | loss: 1.8986833
	speed: 0.3341s/iter; left time: 20502.7319s
	iters: 4200, epoch: 2 | loss: 1.7221786
	speed: 0.3341s/iter; left time: 20472.4563s
	iters: 4300, epoch: 2 | loss: 1.5367937
	speed: 0.3344s/iter; left time: 20454.9628s
	iters: 4400, epoch: 2 | loss: 1.7753386
	speed: 0.3348s/iter; left time: 20447.2495s
	iters: 4500, epoch: 2 | loss: 1.6109021
	speed: 0.3348s/iter; left time: 20415.9563s
	iters: 4600, epoch: 2 | loss: 1.7395731
	speed: 0.3346s/iter; left time: 20368.6468s
	iters: 4700, epoch: 2 | loss: 1.7051736
	speed: 0.3348s/iter; left time: 20346.9644s
	iters: 4800, epoch: 2 | loss: 1.5685449
	speed: 0.3346s/iter; left time: 20304.4430s
	iters: 4900, epoch: 2 | loss: 1.5437707
	speed: 0.3347s/iter; left time: 20274.6011s
	iters: 5000, epoch: 2 | loss: 1.7278829
	speed: 0.3345s/iter; left time: 20230.7753s
	iters: 5100, epoch: 2 | loss: 1.6568345
	speed: 0.3347s/iter; left time: 20206.1675s
	iters: 5200, epoch: 2 | loss: 1.6072643
	speed: 0.3345s/iter; left time: 20165.1456s
	iters: 5300, epoch: 2 | loss: 1.4464124
	speed: 0.3348s/iter; left time: 20144.6858s
	iters: 5400, epoch: 2 | loss: 1.5416726
	speed: 0.3346s/iter; left time: 20099.6225s
	iters: 5500, epoch: 2 | loss: 1.6175967
	speed: 0.3351s/iter; left time: 20098.4649s
	iters: 5600, epoch: 2 | loss: 1.4633393
	speed: 0.3353s/iter; left time: 20074.1111s
	iters: 5700, epoch: 2 | loss: 1.5660578
	speed: 0.3344s/iter; left time: 19990.7479s
	iters: 5800, epoch: 2 | loss: 1.5525502
	speed: 0.3347s/iter; left time: 19971.6158s
	iters: 5900, epoch: 2 | loss: 1.6079632
	speed: 0.3349s/iter; left time: 19953.8408s
	iters: 6000, epoch: 2 | loss: 1.6289212
	speed: 0.3346s/iter; left time: 19899.6482s
	iters: 6100, epoch: 2 | loss: 1.6292540
	speed: 0.3349s/iter; left time: 19883.9260s
	iters: 6200, epoch: 2 | loss: 1.7136475
	speed: 0.3345s/iter; left time: 19827.4405s
	iters: 6300, epoch: 2 | loss: 1.7450135
	speed: 0.3351s/iter; left time: 19827.1701s
	iters: 6400, epoch: 2 | loss: 1.6126604
	speed: 0.3341s/iter; left time: 19740.1786s
	iters: 6500, epoch: 2 | loss: 1.6165805
	speed: 0.3342s/iter; left time: 19712.6040s
	iters: 6600, epoch: 2 | loss: 1.7835054
	speed: 0.3344s/iter; left time: 19686.9681s
	iters: 6700, epoch: 2 | loss: 1.5476334
	speed: 0.3341s/iter; left time: 19638.5827s
	iters: 6800, epoch: 2 | loss: 1.5971863
	speed: 0.3345s/iter; left time: 19627.9885s
	iters: 6900, epoch: 2 | loss: 1.7227106
	speed: 0.3342s/iter; left time: 19578.9651s
	iters: 7000, epoch: 2 | loss: 1.6668071
	speed: 0.3340s/iter; left time: 19530.0919s
	iters: 7100, epoch: 2 | loss: 1.6181893
	speed: 0.3344s/iter; left time: 19518.0975s
	iters: 7200, epoch: 2 | loss: 1.7817179
	speed: 0.3342s/iter; left time: 19478.4415s
Epoch: 2 cost time: 2434.8998534679413
Epoch: 2, Steps: 7275 | Train Loss: 1.6546781 Vali Loss: 1.6755488 Test Loss: 1.8117658
Validation loss decreased (1.678356 --> 1.675549).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.8840131
	speed: 7.3871s/iter; left time: 429198.1581s
	iters: 200, epoch: 3 | loss: 1.6731908
	speed: 0.3345s/iter; left time: 19401.4312s
	iters: 300, epoch: 3 | loss: 1.6173749
	speed: 0.3348s/iter; left time: 19386.2891s
	iters: 400, epoch: 3 | loss: 1.3720081
	speed: 0.3349s/iter; left time: 19354.7322s
	iters: 500, epoch: 3 | loss: 1.5097955
	speed: 0.3345s/iter; left time: 19301.2650s
	iters: 600, epoch: 3 | loss: 1.6953045
	speed: 0.3345s/iter; left time: 19268.2227s
	iters: 700, epoch: 3 | loss: 1.5595655
	speed: 0.3346s/iter; left time: 19238.8837s
	iters: 800, epoch: 3 | loss: 1.7852801
	speed: 0.3342s/iter; left time: 19185.6877s
	iters: 900, epoch: 3 | loss: 1.5116291
	speed: 0.3347s/iter; left time: 19178.6480s
	iters: 1000, epoch: 3 | loss: 1.8360039
	speed: 0.3344s/iter; left time: 19129.3778s
	iters: 1100, epoch: 3 | loss: 1.5171582
	speed: 0.3346s/iter; left time: 19107.1465s
	iters: 1200, epoch: 3 | loss: 1.4831948
	speed: 0.3342s/iter; left time: 19050.9945s
	iters: 1300, epoch: 3 | loss: 1.5841353
	speed: 0.3346s/iter; left time: 19037.0256s
	iters: 1400, epoch: 3 | loss: 1.6398371
	speed: 0.3344s/iter; left time: 18993.1157s
	iters: 1500, epoch: 3 | loss: 1.6515330
	speed: 0.3345s/iter; left time: 18965.5704s
	iters: 1600, epoch: 3 | loss: 1.6255636
	speed: 0.3349s/iter; left time: 18953.2700s
	iters: 1700, epoch: 3 | loss: 1.4996538
	speed: 0.3354s/iter; left time: 18949.2979s
	iters: 1800, epoch: 3 | loss: 1.4799320
	speed: 0.3349s/iter; left time: 18888.3096s
	iters: 1900, epoch: 3 | loss: 1.7182746
	speed: 0.3345s/iter; left time: 18835.1058s
	iters: 2000, epoch: 3 | loss: 1.7306216
	speed: 0.3348s/iter; left time: 18817.2640s
	iters: 2100, epoch: 3 | loss: 1.6478747
	speed: 0.3345s/iter; left time: 18765.1064s
	iters: 2200, epoch: 3 | loss: 1.5516576
	speed: 0.3347s/iter; left time: 18742.4794s
	iters: 2300, epoch: 3 | loss: 1.6564893
	speed: 0.3346s/iter; left time: 18703.4163s
	iters: 2400, epoch: 3 | loss: 1.6757768
	speed: 0.3345s/iter; left time: 18663.1327s
	iters: 2500, epoch: 3 | loss: 1.6116872
	speed: 0.3344s/iter; left time: 18624.7346s
	iters: 2600, epoch: 3 | loss: 1.5921477
	speed: 0.3345s/iter; left time: 18599.9837s
	iters: 2700, epoch: 3 | loss: 1.7840995
	speed: 0.3347s/iter; left time: 18578.6923s
	iters: 2800, epoch: 3 | loss: 1.6428393
	speed: 0.3348s/iter; left time: 18549.0414s
	iters: 2900, epoch: 3 | loss: 1.5112348
	speed: 0.3344s/iter; left time: 18494.2581s
	iters: 3000, epoch: 3 | loss: 1.5321591
	speed: 0.3348s/iter; left time: 18481.0063s
	iters: 3100, epoch: 3 | loss: 1.5659384
	speed: 0.3345s/iter; left time: 18428.6290s
	iters: 3200, epoch: 3 | loss: 1.5394845
	speed: 0.3345s/iter; left time: 18400.5128s
	iters: 3300, epoch: 3 | loss: 1.6558491
	speed: 0.3346s/iter; left time: 18368.2883s
	iters: 3400, epoch: 3 | loss: 1.6137627
	speed: 0.3348s/iter; left time: 18345.9253s
	iters: 3500, epoch: 3 | loss: 1.6979573
	speed: 0.3346s/iter; left time: 18301.3620s
	iters: 3600, epoch: 3 | loss: 1.3665714
	speed: 0.3347s/iter; left time: 18272.8414s
	iters: 3700, epoch: 3 | loss: 1.5991350
	speed: 0.3345s/iter; left time: 18231.1018s
	iters: 3800, epoch: 3 | loss: 1.6579484
	speed: 0.3348s/iter; left time: 18212.2382s
	iters: 3900, epoch: 3 | loss: 1.6001065
	speed: 0.3344s/iter; left time: 18157.4348s
	iters: 4000, epoch: 3 | loss: 1.6516442
	speed: 0.3346s/iter; left time: 18134.7587s
	iters: 4100, epoch: 3 | loss: 1.8503160
	speed: 0.3346s/iter; left time: 18101.2907s
	iters: 4200, epoch: 3 | loss: 1.6784363
	speed: 0.3347s/iter; left time: 18074.3501s
	iters: 4300, epoch: 3 | loss: 1.5219097
	speed: 0.3342s/iter; left time: 18011.2303s
	iters: 4400, epoch: 3 | loss: 1.5678988
	speed: 0.3343s/iter; left time: 17987.8791s
	iters: 4500, epoch: 3 | loss: 1.6347723
	speed: 0.3348s/iter; left time: 17980.8973s
	iters: 4600, epoch: 3 | loss: 1.7630496
	speed: 0.3349s/iter; left time: 17952.3864s
	iters: 4700, epoch: 3 | loss: 1.5154424
	speed: 0.3344s/iter; left time: 17888.2621s
	iters: 4800, epoch: 3 | loss: 1.6260448
	speed: 0.3343s/iter; left time: 17853.5683s
	iters: 4900, epoch: 3 | loss: 1.8346839
	speed: 0.3346s/iter; left time: 17836.8770s
	iters: 5000, epoch: 3 | loss: 1.7265277
	speed: 0.3349s/iter; left time: 17815.0437s
	iters: 5100, epoch: 3 | loss: 1.7467599
	speed: 0.3346s/iter; left time: 17765.1769s
	iters: 5200, epoch: 3 | loss: 1.5523744
	speed: 0.3348s/iter; left time: 17746.9651s
	iters: 5300, epoch: 3 | loss: 1.4437220
	speed: 0.3346s/iter; left time: 17698.1870s
	iters: 5400, epoch: 3 | loss: 1.6208764
	speed: 0.3347s/iter; left time: 17674.3901s
	iters: 5500, epoch: 3 | loss: 1.7220832
	speed: 0.3345s/iter; left time: 17626.0376s
	iters: 5600, epoch: 3 | loss: 1.6908535
	speed: 0.3348s/iter; left time: 17610.2523s
	iters: 5700, epoch: 3 | loss: 1.4764917
	speed: 0.3345s/iter; left time: 17560.3024s
	iters: 5800, epoch: 3 | loss: 1.5300000
	speed: 0.3346s/iter; left time: 17531.2135s
	iters: 5900, epoch: 3 | loss: 1.8607674
	speed: 0.3345s/iter; left time: 17494.4525s
	iters: 6000, epoch: 3 | loss: 1.6599215
	speed: 0.3347s/iter; left time: 17471.7666s
	iters: 6100, epoch: 3 | loss: 1.7876844
	speed: 0.3345s/iter; left time: 17426.7266s
	iters: 6200, epoch: 3 | loss: 1.7854841
	speed: 0.3344s/iter; left time: 17387.2111s
	iters: 6300, epoch: 3 | loss: 1.4185053
	speed: 0.3345s/iter; left time: 17359.8001s
	iters: 6400, epoch: 3 | loss: 1.6483639
	speed: 0.3350s/iter; left time: 17351.0893s
	iters: 6500, epoch: 3 | loss: 1.9415118
	speed: 0.3344s/iter; left time: 17288.8316s
	iters: 6600, epoch: 3 | loss: 1.6117057
	speed: 0.3348s/iter; left time: 17274.4145s
	iters: 6700, epoch: 3 | loss: 1.7903739
	speed: 0.3344s/iter; left time: 17220.7347s
	iters: 6800, epoch: 3 | loss: 1.6042739
	speed: 0.3348s/iter; left time: 17209.8203s
	iters: 6900, epoch: 3 | loss: 1.6065513
	speed: 0.3346s/iter; left time: 17164.6637s
	iters: 7000, epoch: 3 | loss: 1.6451339
	speed: 0.3346s/iter; left time: 17133.4150s
	iters: 7100, epoch: 3 | loss: 1.7225198
	speed: 0.3346s/iter; left time: 17098.7147s
	iters: 7200, epoch: 3 | loss: 1.7531242
	speed: 0.3343s/iter; left time: 17048.5251s
Epoch: 3 cost time: 2434.764840364456
Epoch: 3, Steps: 7275 | Train Loss: 1.6539552 Vali Loss: 1.6791188 Test Loss: 1.8155754
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6278454
	speed: 7.4135s/iter; left time: 376799.1149s
	iters: 200, epoch: 4 | loss: 1.5235519
	speed: 0.3344s/iter; left time: 16964.2771s
	iters: 300, epoch: 4 | loss: 1.2860924
	speed: 0.3345s/iter; left time: 16934.1015s
	iters: 400, epoch: 4 | loss: 1.5097040
	speed: 0.3346s/iter; left time: 16908.4092s
	iters: 500, epoch: 4 | loss: 1.6198152
	speed: 0.3349s/iter; left time: 16888.6148s
	iters: 600, epoch: 4 | loss: 1.7153819
	speed: 0.3344s/iter; left time: 16827.6004s
	iters: 700, epoch: 4 | loss: 1.4939015
	speed: 0.3344s/iter; left time: 16797.6667s
	iters: 800, epoch: 4 | loss: 1.4928974
	speed: 0.3344s/iter; left time: 16759.8599s
	iters: 900, epoch: 4 | loss: 1.7144129
	speed: 0.3342s/iter; left time: 16718.0596s
	iters: 1000, epoch: 4 | loss: 1.5137247
	speed: 0.3346s/iter; left time: 16706.6783s
	iters: 1100, epoch: 4 | loss: 1.6849419
	speed: 0.3346s/iter; left time: 16670.1468s
	iters: 1200, epoch: 4 | loss: 1.8096350
	speed: 0.3354s/iter; left time: 16676.9273s
	iters: 1300, epoch: 4 | loss: 1.5608211
	speed: 0.3350s/iter; left time: 16622.6791s
	iters: 1400, epoch: 4 | loss: 1.5529487
	speed: 0.3346s/iter; left time: 16571.6948s
	iters: 1500, epoch: 4 | loss: 1.7433277
	speed: 0.3347s/iter; left time: 16543.4121s
	iters: 1600, epoch: 4 | loss: 1.7260051
	speed: 0.3347s/iter; left time: 16509.4474s
	iters: 1700, epoch: 4 | loss: 1.6513966
	speed: 0.3351s/iter; left time: 16496.9980s
	iters: 1800, epoch: 4 | loss: 1.5248247
	speed: 0.3351s/iter; left time: 16462.3982s
	iters: 1900, epoch: 4 | loss: 1.6862313
	speed: 0.3350s/iter; left time: 16423.0997s
	iters: 2000, epoch: 4 | loss: 1.5762330
	speed: 0.3345s/iter; left time: 16367.3828s
	iters: 2100, epoch: 4 | loss: 1.4345037
	speed: 0.3353s/iter; left time: 16369.8662s
	iters: 2200, epoch: 4 | loss: 1.6832509
	speed: 0.3352s/iter; left time: 16333.6789s
	iters: 2300, epoch: 4 | loss: 1.6163049
	speed: 0.3351s/iter; left time: 16293.6863s
	iters: 2400, epoch: 4 | loss: 1.7158271
	speed: 0.3345s/iter; left time: 16233.8824s
	iters: 2500, epoch: 4 | loss: 1.8738726
	speed: 0.3353s/iter; left time: 16236.6789s
	iters: 2600, epoch: 4 | loss: 1.5700452
	speed: 0.3350s/iter; left time: 16191.1868s
	iters: 2700, epoch: 4 | loss: 1.5652165
	speed: 0.3349s/iter; left time: 16151.4430s
	iters: 2800, epoch: 4 | loss: 1.5495173
	speed: 0.3346s/iter; left time: 16102.0360s
	iters: 2900, epoch: 4 | loss: 1.7450311
	speed: 0.3347s/iter; left time: 16074.1791s
	iters: 3000, epoch: 4 | loss: 1.7427660
	speed: 0.3346s/iter; left time: 16037.5335s
	iters: 3100, epoch: 4 | loss: 1.6675111
	speed: 0.3349s/iter; left time: 16017.5891s
	iters: 3200, epoch: 4 | loss: 1.6821665
	speed: 0.3346s/iter; left time: 15970.6801s
	iters: 3300, epoch: 4 | loss: 1.5623083
	speed: 0.3351s/iter; left time: 15959.5964s
	iters: 3400, epoch: 4 | loss: 1.6843283
	speed: 0.3352s/iter; left time: 15932.8125s
	iters: 3500, epoch: 4 | loss: 1.5069370
	speed: 0.3348s/iter; left time: 15877.4753s
	iters: 3600, epoch: 4 | loss: 1.5334313
	speed: 0.3347s/iter; left time: 15840.7312s
	iters: 3700, epoch: 4 | loss: 1.6392901
	speed: 0.3347s/iter; left time: 15806.5612s
	iters: 3800, epoch: 4 | loss: 1.6961732
	speed: 0.3347s/iter; left time: 15771.2234s
	iters: 3900, epoch: 4 | loss: 1.4407196
	speed: 0.3353s/iter; left time: 15766.5085s
	iters: 4000, epoch: 4 | loss: 1.7482010
	speed: 0.3351s/iter; left time: 15722.5991s
	iters: 4100, epoch: 4 | loss: 1.5896809
	speed: 0.3350s/iter; left time: 15685.7329s
	iters: 4200, epoch: 4 | loss: 1.6906167
	speed: 0.3346s/iter; left time: 15632.7060s
	iters: 4300, epoch: 4 | loss: 1.7301319
	speed: 0.3352s/iter; left time: 15628.6513s
	iters: 4400, epoch: 4 | loss: 1.6261829
	speed: 0.3352s/iter; left time: 15595.5510s
	iters: 4500, epoch: 4 | loss: 1.6177344
	speed: 0.3348s/iter; left time: 15545.3278s
	iters: 4600, epoch: 4 | loss: 1.5016438
	speed: 0.3346s/iter; left time: 15500.8967s
	iters: 4700, epoch: 4 | loss: 1.6291958
	speed: 0.3351s/iter; left time: 15488.7366s
	iters: 4800, epoch: 4 | loss: 1.6460689
	speed: 0.3349s/iter; left time: 15445.5661s
	iters: 4900, epoch: 4 | loss: 1.6141135
	speed: 0.3347s/iter; left time: 15406.1308s
	iters: 5000, epoch: 4 | loss: 1.5114541
	speed: 0.3350s/iter; left time: 15385.0232s
	iters: 5100, epoch: 4 | loss: 1.5679401
	speed: 0.3346s/iter; left time: 15334.9382s
	iters: 5200, epoch: 4 | loss: 1.6424222
	speed: 0.3344s/iter; left time: 15288.5946s
	iters: 5300, epoch: 4 | loss: 1.6562626
	speed: 0.3342s/iter; left time: 15249.9803s
	iters: 5400, epoch: 4 | loss: 1.5514838
	speed: 0.3349s/iter; left time: 15246.7862s
	iters: 5500, epoch: 4 | loss: 1.6469555
	speed: 0.3344s/iter; left time: 15188.2747s
	iters: 5600, epoch: 4 | loss: 1.6700782
	speed: 0.3350s/iter; left time: 15184.6237s
	iters: 5700, epoch: 4 | loss: 1.4978713
	speed: 0.3349s/iter; left time: 15147.3622s
	iters: 5800, epoch: 4 | loss: 1.6466799
	speed: 0.3345s/iter; left time: 15095.1658s
	iters: 5900, epoch: 4 | loss: 1.7640541
	speed: 0.3348s/iter; left time: 15076.4465s
	iters: 6000, epoch: 4 | loss: 1.4698082
	speed: 0.3345s/iter; left time: 15029.4710s
	iters: 6100, epoch: 4 | loss: 1.4825677
	speed: 0.3348s/iter; left time: 15006.2129s
	iters: 6200, epoch: 4 | loss: 1.7252332
	speed: 0.3346s/iter; left time: 14963.8976s
	iters: 6300, epoch: 4 | loss: 1.7117039
	speed: 0.3352s/iter; left time: 14959.0111s
	iters: 6400, epoch: 4 | loss: 1.7577610
	speed: 0.3354s/iter; left time: 14931.8315s
	iters: 6500, epoch: 4 | loss: 1.9504694
	speed: 0.3349s/iter; left time: 14878.2939s
	iters: 6600, epoch: 4 | loss: 1.5345038
	speed: 0.3342s/iter; left time: 14813.3485s
	iters: 6700, epoch: 4 | loss: 1.7107767
	speed: 0.3343s/iter; left time: 14786.6524s
	iters: 6800, epoch: 4 | loss: 1.6536424
	speed: 0.3344s/iter; left time: 14756.1313s
	iters: 6900, epoch: 4 | loss: 1.5143725
	speed: 0.3344s/iter; left time: 14722.9048s
	iters: 7000, epoch: 4 | loss: 1.4844202
	speed: 0.3343s/iter; left time: 14686.1756s
	iters: 7100, epoch: 4 | loss: 1.5030166
	speed: 0.3350s/iter; left time: 14681.9708s
	iters: 7200, epoch: 4 | loss: 1.5401618
	speed: 0.3351s/iter; left time: 14653.6283s
Epoch: 4 cost time: 2436.1317002773285
Epoch: 4, Steps: 7275 | Train Loss: 1.6538011 Vali Loss: 1.6762424 Test Loss: 1.8099045
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.6482168
	speed: 7.3964s/iter; left time: 322120.7948s
	iters: 200, epoch: 5 | loss: 1.5824512
	speed: 0.3343s/iter; left time: 14526.6567s
	iters: 300, epoch: 5 | loss: 1.5471036
	speed: 0.3352s/iter; left time: 14530.0538s
	iters: 400, epoch: 5 | loss: 1.6515682
	speed: 0.3345s/iter; left time: 14469.0677s
	iters: 500, epoch: 5 | loss: 1.8317084
	speed: 0.3348s/iter; left time: 14446.6882s
	iters: 600, epoch: 5 | loss: 1.5875160
	speed: 0.3347s/iter; left time: 14408.7807s
	iters: 700, epoch: 5 | loss: 1.6766405
	speed: 0.3342s/iter; left time: 14353.3289s
	iters: 800, epoch: 5 | loss: 1.6308368
	speed: 0.3343s/iter; left time: 14324.3513s
	iters: 900, epoch: 5 | loss: 1.8023213
	speed: 0.3345s/iter; left time: 14299.9896s
	iters: 1000, epoch: 5 | loss: 1.7002655
	speed: 0.3345s/iter; left time: 14267.4403s
	iters: 1100, epoch: 5 | loss: 1.7058008
	speed: 0.3346s/iter; left time: 14237.2327s
	iters: 1200, epoch: 5 | loss: 1.7140143
	speed: 0.3344s/iter; left time: 14196.4147s
	iters: 1300, epoch: 5 | loss: 1.6986912
	speed: 0.3344s/iter; left time: 14160.6950s
	iters: 1400, epoch: 5 | loss: 1.6570646
	speed: 0.3348s/iter; left time: 14146.1776s
	iters: 1500, epoch: 5 | loss: 1.6238424
	speed: 0.3350s/iter; left time: 14120.4923s
	iters: 1600, epoch: 5 | loss: 1.5943040
	speed: 0.3349s/iter; left time: 14084.8156s
	iters: 1700, epoch: 5 | loss: 1.6694937
	speed: 0.3346s/iter; left time: 14035.4352s
	iters: 1800, epoch: 5 | loss: 1.4117966
	speed: 0.3350s/iter; left time: 14019.6390s
	iters: 1900, epoch: 5 | loss: 1.6225808
	speed: 0.3346s/iter; left time: 13968.1841s
	iters: 2000, epoch: 5 | loss: 1.6728178
	speed: 0.3351s/iter; left time: 13958.9089s
	iters: 2100, epoch: 5 | loss: 1.6685904
	speed: 0.3351s/iter; left time: 13922.1989s
	iters: 2200, epoch: 5 | loss: 1.7190369
	speed: 0.3349s/iter; left time: 13880.4722s
	iters: 2300, epoch: 5 | loss: 1.7073932
	speed: 0.3346s/iter; left time: 13834.9401s
	iters: 2400, epoch: 5 | loss: 1.6421980
	speed: 0.3351s/iter; left time: 13822.5841s
	iters: 2500, epoch: 5 | loss: 1.5305874
	speed: 0.3354s/iter; left time: 13803.3201s
	iters: 2600, epoch: 5 | loss: 1.6720303
	speed: 0.3351s/iter; left time: 13756.4242s
	iters: 2700, epoch: 5 | loss: 1.8128222
	speed: 0.3344s/iter; left time: 13694.9573s
	iters: 2800, epoch: 5 | loss: 1.6295054
	speed: 0.3354s/iter; left time: 13700.1233s
	iters: 2900, epoch: 5 | loss: 1.6011655
	speed: 0.3352s/iter; left time: 13659.8330s
	iters: 3000, epoch: 5 | loss: 1.7539376
	speed: 0.3349s/iter; left time: 13613.9776s
	iters: 3100, epoch: 5 | loss: 1.5774587
	speed: 0.3347s/iter; left time: 13571.1127s
	iters: 3200, epoch: 5 | loss: 1.5300375
	speed: 0.3352s/iter; left time: 13559.8093s
	iters: 3300, epoch: 5 | loss: 1.5956187
	speed: 0.3352s/iter; left time: 13527.2487s
	iters: 3400, epoch: 5 | loss: 1.8195373
	speed: 0.3349s/iter; left time: 13481.0725s
	iters: 3500, epoch: 5 | loss: 1.7053941
	speed: 0.3345s/iter; left time: 13430.4644s
	iters: 3600, epoch: 5 | loss: 1.7388446
	speed: 0.3347s/iter; left time: 13406.9656s
	iters: 3700, epoch: 5 | loss: 1.7967650
	speed: 0.3346s/iter; left time: 13366.0296s
	iters: 3800, epoch: 5 | loss: 1.5495101
	speed: 0.3352s/iter; left time: 13357.6084s
	iters: 3900, epoch: 5 | loss: 1.5144312
	speed: 0.3349s/iter; left time: 13313.7596s
	iters: 4000, epoch: 5 | loss: 1.7835343
	speed: 0.3348s/iter; left time: 13275.5297s
	iters: 4100, epoch: 5 | loss: 1.6767930
	speed: 0.3347s/iter; left time: 13235.9017s
	iters: 4200, epoch: 5 | loss: 1.7021450
	speed: 0.3353s/iter; left time: 13228.0107s
	iters: 4300, epoch: 5 | loss: 1.7384613
	speed: 0.3351s/iter; left time: 13186.7438s
	iters: 4400, epoch: 5 | loss: 1.5882840
	speed: 0.3351s/iter; left time: 13151.1476s
	iters: 4500, epoch: 5 | loss: 1.7574040
	speed: 0.3345s/iter; left time: 13097.8903s
	iters: 4600, epoch: 5 | loss: 1.8890251
	speed: 0.3349s/iter; left time: 13076.3434s
	iters: 4700, epoch: 5 | loss: 1.7373837
	speed: 0.3345s/iter; left time: 13030.4320s
	iters: 4800, epoch: 5 | loss: 1.5892980
	speed: 0.3354s/iter; left time: 13029.0474s
	iters: 4900, epoch: 5 | loss: 1.6761172
	speed: 0.3351s/iter; left time: 12986.7560s
	iters: 5000, epoch: 5 | loss: 1.5488666
	speed: 0.3349s/iter; left time: 12944.4837s
	iters: 5100, epoch: 5 | loss: 1.5202740
	speed: 0.3347s/iter; left time: 12902.7687s
	iters: 5200, epoch: 5 | loss: 1.6528785
	speed: 0.3352s/iter; left time: 12888.0149s
	iters: 5300, epoch: 5 | loss: 1.6026981
	speed: 0.3351s/iter; left time: 12850.0693s
	iters: 5400, epoch: 5 | loss: 1.4835690
	speed: 0.3350s/iter; left time: 12814.5163s
	iters: 5500, epoch: 5 | loss: 1.6748439
	speed: 0.3344s/iter; left time: 12757.6724s
	iters: 5600, epoch: 5 | loss: 1.4613224
	speed: 0.3342s/iter; left time: 12715.1263s
	iters: 5700, epoch: 5 | loss: 1.6658235
	speed: 0.3345s/iter; left time: 12695.1638s
	iters: 5800, epoch: 5 | loss: 1.6451290
	speed: 0.3343s/iter; left time: 12651.7363s
	iters: 5900, epoch: 5 | loss: 1.7360220
	speed: 0.3345s/iter; left time: 12627.8541s
	iters: 6000, epoch: 5 | loss: 1.7542173
	speed: 0.3343s/iter; left time: 12587.5504s
	iters: 6100, epoch: 5 | loss: 1.7227277
	speed: 0.3342s/iter; left time: 12548.2165s
	iters: 6200, epoch: 5 | loss: 1.6103204
	speed: 0.3343s/iter; left time: 12521.1747s
	iters: 6300, epoch: 5 | loss: 1.6386887
	speed: 0.3343s/iter; left time: 12485.6384s
	iters: 6400, epoch: 5 | loss: 1.6839551
	speed: 0.3348s/iter; left time: 12470.9078s
	iters: 6500, epoch: 5 | loss: 1.7140114
	speed: 0.3346s/iter; left time: 12431.4826s
	iters: 6600, epoch: 5 | loss: 1.5825765
	speed: 0.3348s/iter; left time: 12403.9724s
	iters: 6700, epoch: 5 | loss: 1.7869632
	speed: 0.3347s/iter; left time: 12366.0317s
	iters: 6800, epoch: 5 | loss: 1.7395706
	speed: 0.3347s/iter; left time: 12332.7567s
	iters: 6900, epoch: 5 | loss: 1.7147568
	speed: 0.3346s/iter; left time: 12297.6632s
	iters: 7000, epoch: 5 | loss: 1.7771734
	speed: 0.3352s/iter; left time: 12286.5785s
	iters: 7100, epoch: 5 | loss: 1.5055861
	speed: 0.3353s/iter; left time: 12254.4174s
	iters: 7200, epoch: 5 | loss: 1.9315510
	speed: 0.3349s/iter; left time: 12208.3376s
Epoch: 5 cost time: 2436.0591037273407
Epoch: 5, Steps: 7275 | Train Loss: 1.6537427 Vali Loss: 1.6771295 Test Loss: 1.8115885
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems07_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247681
test shape: (24768, 1, 336, 1613) (24768, 1, 336, 1613)
test shape: (24768, 336, 1613) (24768, 336, 1613)
mse:1.812083125114441, mae:1.0568108558654785
>>>>>>>Overall time: 18837 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
