Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690054
val 89412
test 89410
	iters: 100, epoch: 1 | loss: 1.9267927
	speed: 0.0338s/iter; left time: 1453.0897s
	iters: 200, epoch: 1 | loss: 1.4639649
	speed: 0.0306s/iter; left time: 1313.7701s
	iters: 300, epoch: 1 | loss: 1.2380542
	speed: 0.0305s/iter; left time: 1305.7343s
	iters: 400, epoch: 1 | loss: 1.4990622
	speed: 0.0309s/iter; left time: 1320.4038s
	iters: 500, epoch: 1 | loss: 1.3069767
	speed: 0.0305s/iter; left time: 1301.8060s
	iters: 600, epoch: 1 | loss: 1.5176846
	speed: 0.0304s/iter; left time: 1291.6365s
	iters: 700, epoch: 1 | loss: 1.7310663
	speed: 0.0306s/iter; left time: 1298.8685s
	iters: 800, epoch: 1 | loss: 1.6208861
	speed: 0.0311s/iter; left time: 1318.1378s
	iters: 900, epoch: 1 | loss: 1.9737072
	speed: 0.0305s/iter; left time: 1287.0497s
	iters: 1000, epoch: 1 | loss: 2.3264132
	speed: 0.0303s/iter; left time: 1277.4353s
	iters: 1100, epoch: 1 | loss: 1.6457298
	speed: 0.0304s/iter; left time: 1275.9601s
	iters: 1200, epoch: 1 | loss: 1.7502289
	speed: 0.0305s/iter; left time: 1278.0726s
	iters: 1300, epoch: 1 | loss: 1.5883050
	speed: 0.0309s/iter; left time: 1292.1338s
	iters: 1400, epoch: 1 | loss: 1.4003398
	speed: 0.0304s/iter; left time: 1268.9053s
	iters: 1500, epoch: 1 | loss: 1.5518059
	speed: 0.0305s/iter; left time: 1269.5126s
	iters: 1600, epoch: 1 | loss: 1.6642947
	speed: 0.0306s/iter; left time: 1268.8144s
	iters: 1700, epoch: 1 | loss: 1.4214576
	speed: 0.0307s/iter; left time: 1272.9112s
	iters: 1800, epoch: 1 | loss: 1.7257051
	speed: 0.0308s/iter; left time: 1272.5728s
	iters: 1900, epoch: 1 | loss: 1.7480168
	speed: 0.0309s/iter; left time: 1272.6127s
	iters: 2000, epoch: 1 | loss: 1.7876936
	speed: 0.0305s/iter; left time: 1252.3029s
	iters: 2100, epoch: 1 | loss: 1.7458719
	speed: 0.0309s/iter; left time: 1267.7766s
	iters: 2200, epoch: 1 | loss: 1.5764383
	speed: 0.0306s/iter; left time: 1252.6078s
	iters: 2300, epoch: 1 | loss: 2.3087730
	speed: 0.0307s/iter; left time: 1253.9432s
	iters: 2400, epoch: 1 | loss: 2.0912042
	speed: 0.0304s/iter; left time: 1235.9117s
	iters: 2500, epoch: 1 | loss: 1.5376394
	speed: 0.0306s/iter; left time: 1243.4955s
	iters: 2600, epoch: 1 | loss: 1.7463257
	speed: 0.0310s/iter; left time: 1255.0787s
	iters: 2700, epoch: 1 | loss: 1.4919983
	speed: 0.0309s/iter; left time: 1248.7774s
	iters: 2800, epoch: 1 | loss: 1.8283241
	speed: 0.0313s/iter; left time: 1260.7276s
	iters: 2900, epoch: 1 | loss: 1.3113943
	speed: 0.0311s/iter; left time: 1250.1927s
	iters: 3000, epoch: 1 | loss: 1.7406771
	speed: 0.0309s/iter; left time: 1238.3486s
	iters: 3100, epoch: 1 | loss: 1.6793165
	speed: 0.0303s/iter; left time: 1214.2041s
	iters: 3200, epoch: 1 | loss: 1.5220056
	speed: 0.0306s/iter; left time: 1221.1543s
	iters: 3300, epoch: 1 | loss: 1.7535403
	speed: 0.0308s/iter; left time: 1225.9750s
	iters: 3400, epoch: 1 | loss: 1.5881251
	speed: 0.0305s/iter; left time: 1210.4725s
	iters: 3500, epoch: 1 | loss: 1.7840656
	speed: 0.0310s/iter; left time: 1230.2150s
	iters: 3600, epoch: 1 | loss: 1.5543252
	speed: 0.0304s/iter; left time: 1202.6121s
	iters: 3700, epoch: 1 | loss: 1.3391579
	speed: 0.0311s/iter; left time: 1224.3472s
	iters: 3800, epoch: 1 | loss: 1.6749870
	speed: 0.0311s/iter; left time: 1221.7987s
	iters: 3900, epoch: 1 | loss: 1.6660914
	speed: 0.0308s/iter; left time: 1206.0531s
	iters: 4000, epoch: 1 | loss: 1.5325655
	speed: 0.0307s/iter; left time: 1200.5662s
	iters: 4100, epoch: 1 | loss: 1.4867932
	speed: 0.0309s/iter; left time: 1204.1215s
	iters: 4200, epoch: 1 | loss: 1.7444518
	speed: 0.0308s/iter; left time: 1198.6907s
	iters: 4300, epoch: 1 | loss: 1.4344864
	speed: 0.0305s/iter; left time: 1185.4309s
Epoch: 1 cost time: 132.75032091140747
Epoch: 1, Steps: 4312 | Train Loss: 1.6269996 Vali Loss: 1.3607761 Test Loss: 1.4052831
Validation loss decreased (inf --> 1.360776).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.7061692
	speed: 0.5474s/iter; left time: 21188.9587s
	iters: 200, epoch: 2 | loss: 1.2833430
	speed: 0.0304s/iter; left time: 1172.5893s
	iters: 300, epoch: 2 | loss: 1.5128174
	speed: 0.0304s/iter; left time: 1170.1049s
	iters: 400, epoch: 2 | loss: 1.6939460
	speed: 0.0304s/iter; left time: 1165.9540s
	iters: 500, epoch: 2 | loss: 1.5710456
	speed: 0.0304s/iter; left time: 1163.3880s
	iters: 600, epoch: 2 | loss: 2.0276825
	speed: 0.0304s/iter; left time: 1160.6525s
	iters: 700, epoch: 2 | loss: 1.8925891
	speed: 0.0304s/iter; left time: 1157.4230s
	iters: 800, epoch: 2 | loss: 1.8611431
	speed: 0.0306s/iter; left time: 1161.6882s
	iters: 900, epoch: 2 | loss: 1.9891340
	speed: 0.0306s/iter; left time: 1158.2239s
	iters: 1000, epoch: 2 | loss: 1.6776997
	speed: 0.0308s/iter; left time: 1162.7188s
	iters: 1100, epoch: 2 | loss: 1.6499012
	speed: 0.0307s/iter; left time: 1156.5097s
	iters: 1200, epoch: 2 | loss: 1.6529156
	speed: 0.0306s/iter; left time: 1149.2307s
	iters: 1300, epoch: 2 | loss: 1.8840748
	speed: 0.0304s/iter; left time: 1138.5505s
	iters: 1400, epoch: 2 | loss: 1.6690532
	speed: 0.0306s/iter; left time: 1146.1720s
	iters: 1500, epoch: 2 | loss: 1.3818012
	speed: 0.0308s/iter; left time: 1148.6303s
	iters: 1600, epoch: 2 | loss: 1.7527970
	speed: 0.0304s/iter; left time: 1131.4335s
	iters: 1700, epoch: 2 | loss: 1.7032125
	speed: 0.0304s/iter; left time: 1127.0477s
	iters: 1800, epoch: 2 | loss: 1.6720777
	speed: 0.0303s/iter; left time: 1122.9224s
	iters: 1900, epoch: 2 | loss: 1.5530455
	speed: 0.0308s/iter; left time: 1137.9534s
	iters: 2000, epoch: 2 | loss: 1.4780926
	speed: 0.0316s/iter; left time: 1162.6628s
	iters: 2100, epoch: 2 | loss: 1.6257169
	speed: 0.0304s/iter; left time: 1115.2365s
	iters: 2200, epoch: 2 | loss: 1.6206710
	speed: 0.0304s/iter; left time: 1114.4595s
	iters: 2300, epoch: 2 | loss: 1.4889536
	speed: 0.0307s/iter; left time: 1122.0617s
	iters: 2400, epoch: 2 | loss: 1.6344386
	speed: 0.0306s/iter; left time: 1114.3163s
	iters: 2500, epoch: 2 | loss: 1.7223681
	speed: 0.0309s/iter; left time: 1120.7620s
	iters: 2600, epoch: 2 | loss: 1.5579083
	speed: 0.0304s/iter; left time: 1099.1873s
	iters: 2700, epoch: 2 | loss: 1.6621653
	speed: 0.0309s/iter; left time: 1114.7531s
	iters: 2800, epoch: 2 | loss: 1.6594425
	speed: 0.0308s/iter; left time: 1110.2175s
	iters: 2900, epoch: 2 | loss: 1.1805575
	speed: 0.0309s/iter; left time: 1108.7418s
	iters: 3000, epoch: 2 | loss: 1.6874779
	speed: 0.0310s/iter; left time: 1111.3612s
	iters: 3100, epoch: 2 | loss: 1.8661271
	speed: 0.0308s/iter; left time: 1098.8632s
	iters: 3200, epoch: 2 | loss: 1.6554599
	speed: 0.0308s/iter; left time: 1096.5957s
	iters: 3300, epoch: 2 | loss: 1.6619492
	speed: 0.0304s/iter; left time: 1077.7412s
	iters: 3400, epoch: 2 | loss: 1.7340056
	speed: 0.0308s/iter; left time: 1089.1601s
	iters: 3500, epoch: 2 | loss: 1.8076419
	speed: 0.0314s/iter; left time: 1108.8873s
	iters: 3600, epoch: 2 | loss: 1.7624538
	speed: 0.0312s/iter; left time: 1099.1759s
	iters: 3700, epoch: 2 | loss: 1.6804202
	speed: 0.0314s/iter; left time: 1101.1815s
	iters: 3800, epoch: 2 | loss: 1.7825220
	speed: 0.0314s/iter; left time: 1098.0779s
	iters: 3900, epoch: 2 | loss: 1.3599712
	speed: 0.0313s/iter; left time: 1091.4775s
	iters: 4000, epoch: 2 | loss: 1.6822757
	speed: 0.0307s/iter; left time: 1069.5694s
	iters: 4100, epoch: 2 | loss: 1.5360295
	speed: 0.0305s/iter; left time: 1058.1058s
	iters: 4200, epoch: 2 | loss: 1.8667381
	speed: 0.0310s/iter; left time: 1074.5490s
	iters: 4300, epoch: 2 | loss: 1.5417655
	speed: 0.0307s/iter; left time: 1060.7364s
Epoch: 2 cost time: 132.5461208820343
Epoch: 2, Steps: 4312 | Train Loss: 1.6614100 Vali Loss: 1.2239519 Test Loss: 1.4500095
Validation loss decreased (1.360776 --> 1.223952).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 2.0239344
	speed: 0.5475s/iter; left time: 18831.0083s
	iters: 200, epoch: 3 | loss: 1.9917685
	speed: 0.0306s/iter; left time: 1051.1225s
	iters: 300, epoch: 3 | loss: 1.3987311
	speed: 0.0307s/iter; left time: 1049.1281s
	iters: 400, epoch: 3 | loss: 1.6559544
	speed: 0.0306s/iter; left time: 1044.9941s
	iters: 500, epoch: 3 | loss: 1.7791059
	speed: 0.0307s/iter; left time: 1042.1036s
	iters: 600, epoch: 3 | loss: 2.1363459
	speed: 0.0308s/iter; left time: 1042.3359s
	iters: 700, epoch: 3 | loss: 1.6656629
	speed: 0.0312s/iter; left time: 1055.5475s
	iters: 800, epoch: 3 | loss: 1.4975631
	speed: 0.0304s/iter; left time: 1023.6515s
	iters: 900, epoch: 3 | loss: 1.5674578
	speed: 0.0304s/iter; left time: 1020.5245s
	iters: 1000, epoch: 3 | loss: 1.4591928
	speed: 0.0305s/iter; left time: 1021.9402s
	iters: 1100, epoch: 3 | loss: 1.5146164
	speed: 0.0305s/iter; left time: 1018.7167s
	iters: 1200, epoch: 3 | loss: 1.8060728
	speed: 0.0304s/iter; left time: 1010.7358s
	iters: 1300, epoch: 3 | loss: 1.6983664
	speed: 0.0305s/iter; left time: 1011.1309s
	iters: 1400, epoch: 3 | loss: 1.4561787
	speed: 0.0306s/iter; left time: 1011.4270s
	iters: 1500, epoch: 3 | loss: 1.8623768
	speed: 0.0306s/iter; left time: 1008.3408s
	iters: 1600, epoch: 3 | loss: 1.6753215
	speed: 0.0307s/iter; left time: 1009.1456s
	iters: 1700, epoch: 3 | loss: 1.3896863
	speed: 0.0315s/iter; left time: 1031.5353s
	iters: 1800, epoch: 3 | loss: 1.6070703
	speed: 0.0310s/iter; left time: 1014.8262s
	iters: 1900, epoch: 3 | loss: 2.0022984
	speed: 0.0306s/iter; left time: 996.6036s
	iters: 2000, epoch: 3 | loss: 1.8072242
	speed: 0.0307s/iter; left time: 997.1568s
	iters: 2100, epoch: 3 | loss: 1.5344890
	speed: 0.0315s/iter; left time: 1019.4119s
	iters: 2200, epoch: 3 | loss: 2.0649962
	speed: 0.0310s/iter; left time: 1000.8700s
	iters: 2300, epoch: 3 | loss: 1.5409244
	speed: 0.0316s/iter; left time: 1018.5946s
	iters: 2400, epoch: 3 | loss: 1.4322327
	speed: 0.0305s/iter; left time: 978.1982s
	iters: 2500, epoch: 3 | loss: 1.7415066
	speed: 0.0304s/iter; left time: 971.1816s
	iters: 2600, epoch: 3 | loss: 1.5540134
	speed: 0.0305s/iter; left time: 974.2388s
	iters: 2700, epoch: 3 | loss: 1.6404558
	speed: 0.0305s/iter; left time: 968.3961s
	iters: 2800, epoch: 3 | loss: 1.5484095
	speed: 0.0314s/iter; left time: 996.8700s
	iters: 2900, epoch: 3 | loss: 1.9041902
	speed: 0.0310s/iter; left time: 978.4673s
	iters: 3000, epoch: 3 | loss: 1.5086641
	speed: 0.0308s/iter; left time: 969.0479s
	iters: 3100, epoch: 3 | loss: 1.5451405
	speed: 0.0306s/iter; left time: 959.8524s
	iters: 3200, epoch: 3 | loss: 1.8292831
	speed: 0.0304s/iter; left time: 950.6430s
	iters: 3300, epoch: 3 | loss: 1.5812954
	speed: 0.0311s/iter; left time: 971.1173s
	iters: 3400, epoch: 3 | loss: 1.6461421
	speed: 0.0308s/iter; left time: 957.5595s
	iters: 3500, epoch: 3 | loss: 1.4787530
	speed: 0.0303s/iter; left time: 940.6048s
	iters: 3600, epoch: 3 | loss: 1.5605093
	speed: 0.0308s/iter; left time: 950.7352s
	iters: 3700, epoch: 3 | loss: 2.1354859
	speed: 0.0310s/iter; left time: 953.7726s
	iters: 3800, epoch: 3 | loss: 1.5560994
	speed: 0.0303s/iter; left time: 931.3062s
	iters: 3900, epoch: 3 | loss: 1.6670034
	speed: 0.0306s/iter; left time: 935.7236s
	iters: 4000, epoch: 3 | loss: 1.9276440
	speed: 0.0309s/iter; left time: 941.3201s
	iters: 4100, epoch: 3 | loss: 1.4936496
	speed: 0.0306s/iter; left time: 929.2582s
	iters: 4200, epoch: 3 | loss: 1.8135557
	speed: 0.0303s/iter; left time: 919.3066s
	iters: 4300, epoch: 3 | loss: 2.3369894
	speed: 0.0309s/iter; left time: 932.8716s
Epoch: 3 cost time: 132.6626329421997
Epoch: 3, Steps: 4312 | Train Loss: 1.6664183 Vali Loss: 1.2237172 Test Loss: 1.4515300
Validation loss decreased (1.223952 --> 1.223717).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 2.2395988
	speed: 0.5499s/iter; left time: 16543.4263s
	iters: 200, epoch: 4 | loss: 1.5473912
	speed: 0.0306s/iter; left time: 916.3762s
	iters: 300, epoch: 4 | loss: 1.4788667
	speed: 0.0304s/iter; left time: 907.0757s
	iters: 400, epoch: 4 | loss: 1.7524093
	speed: 0.0308s/iter; left time: 917.0748s
	iters: 500, epoch: 4 | loss: 1.5771959
	speed: 0.0312s/iter; left time: 927.1169s
	iters: 600, epoch: 4 | loss: 1.3980116
	speed: 0.0304s/iter; left time: 898.1718s
	iters: 700, epoch: 4 | loss: 1.7079616
	speed: 0.0308s/iter; left time: 908.2197s
	iters: 800, epoch: 4 | loss: 1.5492469
	speed: 0.0306s/iter; left time: 900.2128s
	iters: 900, epoch: 4 | loss: 1.5499022
	speed: 0.0312s/iter; left time: 914.7227s
	iters: 1000, epoch: 4 | loss: 1.7909690
	speed: 0.0308s/iter; left time: 900.1116s
	iters: 1100, epoch: 4 | loss: 1.2374258
	speed: 0.0311s/iter; left time: 905.1531s
	iters: 1200, epoch: 4 | loss: 1.9351697
	speed: 0.0310s/iter; left time: 897.3108s
	iters: 1300, epoch: 4 | loss: 1.7268184
	speed: 0.0310s/iter; left time: 895.2985s
	iters: 1400, epoch: 4 | loss: 1.4671605
	speed: 0.0306s/iter; left time: 880.2744s
	iters: 1500, epoch: 4 | loss: 2.0759661
	speed: 0.0307s/iter; left time: 881.3587s
	iters: 1600, epoch: 4 | loss: 1.7162223
	speed: 0.0311s/iter; left time: 889.4154s
	iters: 1700, epoch: 4 | loss: 2.2148690
	speed: 0.0317s/iter; left time: 901.6478s
	iters: 1800, epoch: 4 | loss: 1.4712422
	speed: 0.0303s/iter; left time: 861.4662s
	iters: 1900, epoch: 4 | loss: 1.5532542
	speed: 0.0313s/iter; left time: 884.8958s
	iters: 2000, epoch: 4 | loss: 1.9019752
	speed: 0.0312s/iter; left time: 880.4895s
	iters: 2100, epoch: 4 | loss: 1.5317867
	speed: 0.0309s/iter; left time: 868.8421s
	iters: 2200, epoch: 4 | loss: 1.4832449
	speed: 0.0310s/iter; left time: 867.1190s
	iters: 2300, epoch: 4 | loss: 1.7658882
	speed: 0.0309s/iter; left time: 861.2082s
	iters: 2400, epoch: 4 | loss: 1.5300007
	speed: 0.0309s/iter; left time: 858.6726s
	iters: 2500, epoch: 4 | loss: 1.8030345
	speed: 0.0314s/iter; left time: 869.8369s
	iters: 2600, epoch: 4 | loss: 1.7761558
	speed: 0.0304s/iter; left time: 837.7577s
	iters: 2700, epoch: 4 | loss: 1.7648838
	speed: 0.0314s/iter; left time: 863.5029s
	iters: 2800, epoch: 4 | loss: 1.3908514
	speed: 0.0314s/iter; left time: 860.1541s
	iters: 2900, epoch: 4 | loss: 2.0109878
	speed: 0.0312s/iter; left time: 849.9789s
	iters: 3000, epoch: 4 | loss: 1.4256462
	speed: 0.0307s/iter; left time: 833.7185s
	iters: 3100, epoch: 4 | loss: 1.8474944
	speed: 0.0313s/iter; left time: 847.5608s
	iters: 3200, epoch: 4 | loss: 1.6253375
	speed: 0.0309s/iter; left time: 834.1079s
	iters: 3300, epoch: 4 | loss: 1.8198321
	speed: 0.0310s/iter; left time: 832.5611s
	iters: 3400, epoch: 4 | loss: 1.4649396
	speed: 0.0311s/iter; left time: 832.6843s
	iters: 3500, epoch: 4 | loss: 1.8630823
	speed: 0.0313s/iter; left time: 834.1489s
	iters: 3600, epoch: 4 | loss: 2.0699487
	speed: 0.0311s/iter; left time: 826.9489s
	iters: 3700, epoch: 4 | loss: 1.6197599
	speed: 0.0308s/iter; left time: 815.3692s
	iters: 3800, epoch: 4 | loss: 1.8313721
	speed: 0.0310s/iter; left time: 817.5415s
	iters: 3900, epoch: 4 | loss: 1.7137412
	speed: 0.0310s/iter; left time: 815.1815s
	iters: 4000, epoch: 4 | loss: 1.5783203
	speed: 0.0309s/iter; left time: 808.6843s
	iters: 4100, epoch: 4 | loss: 1.6498665
	speed: 0.0311s/iter; left time: 811.3485s
	iters: 4200, epoch: 4 | loss: 1.5231365
	speed: 0.0310s/iter; left time: 805.5595s
	iters: 4300, epoch: 4 | loss: 1.7795119
	speed: 0.0308s/iter; left time: 798.4764s
Epoch: 4 cost time: 133.6773726940155
Epoch: 4, Steps: 4312 | Train Loss: 1.6662887 Vali Loss: 1.2239313 Test Loss: 1.4519306
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.9202170
	speed: 0.5489s/iter; left time: 14146.0536s
	iters: 200, epoch: 5 | loss: 1.4973496
	speed: 0.0308s/iter; left time: 790.6860s
	iters: 300, epoch: 5 | loss: 2.1780837
	speed: 0.0308s/iter; left time: 787.3660s
	iters: 400, epoch: 5 | loss: 1.6517888
	speed: 0.0310s/iter; left time: 788.9574s
	iters: 500, epoch: 5 | loss: 1.6971313
	speed: 0.0309s/iter; left time: 784.6065s
	iters: 600, epoch: 5 | loss: 1.4450085
	speed: 0.0309s/iter; left time: 781.9936s
	iters: 700, epoch: 5 | loss: 1.6814294
	speed: 0.0311s/iter; left time: 782.3938s
	iters: 800, epoch: 5 | loss: 1.7088294
	speed: 0.0311s/iter; left time: 779.5557s
	iters: 900, epoch: 5 | loss: 1.7367831
	speed: 0.0309s/iter; left time: 771.6339s
	iters: 1000, epoch: 5 | loss: 1.5817915
	speed: 0.0311s/iter; left time: 773.4992s
	iters: 1100, epoch: 5 | loss: 1.5366894
	speed: 0.0311s/iter; left time: 769.7095s
	iters: 1200, epoch: 5 | loss: 1.7427852
	speed: 0.0309s/iter; left time: 762.3569s
	iters: 1300, epoch: 5 | loss: 1.6864771
	speed: 0.0309s/iter; left time: 758.3353s
	iters: 1400, epoch: 5 | loss: 1.8018144
	speed: 0.0308s/iter; left time: 753.6312s
	iters: 1500, epoch: 5 | loss: 1.6467648
	speed: 0.0313s/iter; left time: 761.9090s
	iters: 1600, epoch: 5 | loss: 1.9564239
	speed: 0.0312s/iter; left time: 757.9390s
	iters: 1700, epoch: 5 | loss: 1.5473748
	speed: 0.0308s/iter; left time: 745.5101s
	iters: 1800, epoch: 5 | loss: 1.7441018
	speed: 0.0310s/iter; left time: 746.2567s
	iters: 1900, epoch: 5 | loss: 1.4842970
	speed: 0.0309s/iter; left time: 740.5852s
	iters: 2000, epoch: 5 | loss: 1.9536777
	speed: 0.0310s/iter; left time: 738.9674s
	iters: 2100, epoch: 5 | loss: 1.6985056
	speed: 0.0309s/iter; left time: 735.3702s
	iters: 2200, epoch: 5 | loss: 1.5060797
	speed: 0.0308s/iter; left time: 728.4567s
	iters: 2300, epoch: 5 | loss: 1.5047773
	speed: 0.0309s/iter; left time: 728.7867s
	iters: 2400, epoch: 5 | loss: 1.5510687
	speed: 0.0309s/iter; left time: 725.0530s
	iters: 2500, epoch: 5 | loss: 1.9145062
	speed: 0.0310s/iter; left time: 724.1830s
	iters: 2600, epoch: 5 | loss: 1.9944893
	speed: 0.0312s/iter; left time: 725.6904s
	iters: 2700, epoch: 5 | loss: 1.4359926
	speed: 0.0311s/iter; left time: 720.5849s
	iters: 2800, epoch: 5 | loss: 1.7021006
	speed: 0.0309s/iter; left time: 713.0850s
	iters: 2900, epoch: 5 | loss: 1.9338748
	speed: 0.0311s/iter; left time: 715.1164s
	iters: 3000, epoch: 5 | loss: 1.9390295
	speed: 0.0313s/iter; left time: 715.7959s
	iters: 3100, epoch: 5 | loss: 1.7579130
	speed: 0.0313s/iter; left time: 712.2925s
	iters: 3200, epoch: 5 | loss: 1.3158797
	speed: 0.0310s/iter; left time: 703.0642s
	iters: 3300, epoch: 5 | loss: 1.8712851
	speed: 0.0309s/iter; left time: 697.5850s
	iters: 3400, epoch: 5 | loss: 1.6451993
	speed: 0.0308s/iter; left time: 692.0921s
	iters: 3500, epoch: 5 | loss: 1.5287647
	speed: 0.0310s/iter; left time: 693.8922s
	iters: 3600, epoch: 5 | loss: 1.7333348
	speed: 0.0309s/iter; left time: 687.8312s
	iters: 3700, epoch: 5 | loss: 1.8276284
	speed: 0.0309s/iter; left time: 685.3235s
	iters: 3800, epoch: 5 | loss: 1.8299577
	speed: 0.0310s/iter; left time: 683.6014s
	iters: 3900, epoch: 5 | loss: 1.9323130
	speed: 0.0308s/iter; left time: 677.3014s
	iters: 4000, epoch: 5 | loss: 1.5267912
	speed: 0.0309s/iter; left time: 675.8567s
	iters: 4100, epoch: 5 | loss: 1.3308203
	speed: 0.0308s/iter; left time: 670.5427s
	iters: 4200, epoch: 5 | loss: 1.4602571
	speed: 0.0310s/iter; left time: 671.6917s
	iters: 4300, epoch: 5 | loss: 1.5411545
	speed: 0.0311s/iter; left time: 670.8128s
Epoch: 5 cost time: 133.72430109977722
Epoch: 5, Steps: 4312 | Train Loss: 1.6661225 Vali Loss: 1.2243208 Test Loss: 1.4517781
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.7609131
	speed: 0.5490s/iter; left time: 11782.9964s
	iters: 200, epoch: 6 | loss: 1.5158572
	speed: 0.0316s/iter; left time: 674.6374s
	iters: 300, epoch: 6 | loss: 1.5864804
	speed: 0.0317s/iter; left time: 673.5179s
	iters: 400, epoch: 6 | loss: 1.8731350
	speed: 0.0318s/iter; left time: 672.9582s
	iters: 500, epoch: 6 | loss: 1.7841027
	speed: 0.0315s/iter; left time: 664.1039s
	iters: 600, epoch: 6 | loss: 1.8435998
	speed: 0.0316s/iter; left time: 662.2879s
	iters: 700, epoch: 6 | loss: 1.5342628
	speed: 0.0313s/iter; left time: 653.8242s
	iters: 800, epoch: 6 | loss: 1.6767170
	speed: 0.0316s/iter; left time: 655.8682s
	iters: 900, epoch: 6 | loss: 1.4115194
	speed: 0.0315s/iter; left time: 650.8807s
	iters: 1000, epoch: 6 | loss: 1.5231277
	speed: 0.0318s/iter; left time: 652.8187s
	iters: 1100, epoch: 6 | loss: 1.4513830
	speed: 0.0317s/iter; left time: 648.4913s
	iters: 1200, epoch: 6 | loss: 1.7195853
	speed: 0.0316s/iter; left time: 643.8856s
	iters: 1300, epoch: 6 | loss: 1.4938331
	speed: 0.0315s/iter; left time: 637.9410s
	iters: 1400, epoch: 6 | loss: 1.8374958
	speed: 0.0314s/iter; left time: 633.7712s
	iters: 1500, epoch: 6 | loss: 1.5342407
	speed: 0.0318s/iter; left time: 638.0358s
	iters: 1600, epoch: 6 | loss: 1.6454799
	speed: 0.0314s/iter; left time: 627.3915s
	iters: 1700, epoch: 6 | loss: 1.6147060
	speed: 0.0316s/iter; left time: 627.5435s
	iters: 1800, epoch: 6 | loss: 1.7216046
	speed: 0.0318s/iter; left time: 628.1756s
	iters: 1900, epoch: 6 | loss: 1.6621763
	speed: 0.0315s/iter; left time: 619.2362s
	iters: 2000, epoch: 6 | loss: 1.3248979
	speed: 0.0315s/iter; left time: 616.7425s
	iters: 2100, epoch: 6 | loss: 1.7451576
	speed: 0.0316s/iter; left time: 614.7239s
	iters: 2200, epoch: 6 | loss: 1.5060316
	speed: 0.0319s/iter; left time: 617.6948s
	iters: 2300, epoch: 6 | loss: 1.3830762
	speed: 0.0316s/iter; left time: 608.1959s
	iters: 2400, epoch: 6 | loss: 1.7117872
	speed: 0.0317s/iter; left time: 607.0323s
	iters: 2500, epoch: 6 | loss: 1.5841501
	speed: 0.0316s/iter; left time: 601.6572s
	iters: 2600, epoch: 6 | loss: 1.6660444
	speed: 0.0317s/iter; left time: 600.2509s
	iters: 2700, epoch: 6 | loss: 1.6474644
	speed: 0.0313s/iter; left time: 590.4199s
	iters: 2800, epoch: 6 | loss: 1.6127560
	speed: 0.0315s/iter; left time: 590.1128s
	iters: 2900, epoch: 6 | loss: 1.9791098
	speed: 0.0313s/iter; left time: 584.2026s
	iters: 3000, epoch: 6 | loss: 1.5898608
	speed: 0.0313s/iter; left time: 581.1577s
	iters: 3100, epoch: 6 | loss: 1.6549028
	speed: 0.0319s/iter; left time: 589.2853s
	iters: 3200, epoch: 6 | loss: 1.5152780
	speed: 0.0315s/iter; left time: 578.4627s
	iters: 3300, epoch: 6 | loss: 1.6746430
	speed: 0.0316s/iter; left time: 576.4043s
	iters: 3400, epoch: 6 | loss: 1.7366505
	speed: 0.0318s/iter; left time: 578.2830s
	iters: 3500, epoch: 6 | loss: 1.6737993
	speed: 0.0316s/iter; left time: 570.9737s
	iters: 3600, epoch: 6 | loss: 1.9067996
	speed: 0.0321s/iter; left time: 575.6735s
	iters: 3700, epoch: 6 | loss: 1.7207866
	speed: 0.0316s/iter; left time: 563.7703s
	iters: 3800, epoch: 6 | loss: 1.6808571
	speed: 0.0316s/iter; left time: 561.9099s
	iters: 3900, epoch: 6 | loss: 1.6207101
	speed: 0.0318s/iter; left time: 561.9362s
	iters: 4000, epoch: 6 | loss: 2.2193229
	speed: 0.0315s/iter; left time: 552.5887s
	iters: 4100, epoch: 6 | loss: 1.4669367
	speed: 0.0316s/iter; left time: 551.9450s
	iters: 4200, epoch: 6 | loss: 1.9560281
	speed: 0.0319s/iter; left time: 553.4983s
	iters: 4300, epoch: 6 | loss: 1.5536530
	speed: 0.0314s/iter; left time: 542.3769s
Epoch: 6 cost time: 136.4543159008026
Epoch: 6, Steps: 4312 | Train Loss: 1.6661360 Vali Loss: 1.2239034 Test Loss: 1.4507430
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 89410
test shape: (8941, 1, 720, 130) (8941, 1, 720, 130)
test shape: (8941, 720, 130) (8941, 720, 130)
mse:1.451540231704712, mae:0.9327722191810608
>>>>>>>Overall time: 1229 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
