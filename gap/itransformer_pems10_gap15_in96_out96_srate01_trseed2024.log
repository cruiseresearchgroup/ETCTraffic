Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 896967
val 193743
test 193741
	iters: 100, epoch: 1 | loss: 1.9815429
	speed: 0.0325s/iter; left time: 1819.3114s
	iters: 200, epoch: 1 | loss: 2.0642779
	speed: 0.0299s/iter; left time: 1671.9082s
	iters: 300, epoch: 1 | loss: 1.7684730
	speed: 0.0302s/iter; left time: 1686.5591s
	iters: 400, epoch: 1 | loss: 2.1940751
	speed: 0.0297s/iter; left time: 1651.2705s
	iters: 500, epoch: 1 | loss: 1.6040446
	speed: 0.0299s/iter; left time: 1662.9463s
	iters: 600, epoch: 1 | loss: 2.1895378
	speed: 0.0303s/iter; left time: 1679.2675s
	iters: 700, epoch: 1 | loss: 1.9680039
	speed: 0.0304s/iter; left time: 1684.9830s
	iters: 800, epoch: 1 | loss: 1.7494544
	speed: 0.0303s/iter; left time: 1675.9980s
	iters: 900, epoch: 1 | loss: 2.2811179
	speed: 0.0298s/iter; left time: 1644.2597s
	iters: 1000, epoch: 1 | loss: 1.8747061
	speed: 0.0304s/iter; left time: 1672.8564s
	iters: 1100, epoch: 1 | loss: 1.9064237
	speed: 0.0303s/iter; left time: 1667.9643s
	iters: 1200, epoch: 1 | loss: 1.7237058
	speed: 0.0293s/iter; left time: 1609.6058s
	iters: 1300, epoch: 1 | loss: 1.8289875
	speed: 0.0302s/iter; left time: 1651.6554s
	iters: 1400, epoch: 1 | loss: 2.2359600
	speed: 0.0302s/iter; left time: 1648.6807s
	iters: 1500, epoch: 1 | loss: 1.8705212
	speed: 0.0299s/iter; left time: 1629.5440s
	iters: 1600, epoch: 1 | loss: 1.9481360
	speed: 0.0300s/iter; left time: 1634.4577s
	iters: 1700, epoch: 1 | loss: 1.9987642
	speed: 0.0301s/iter; left time: 1637.9928s
	iters: 1800, epoch: 1 | loss: 2.0679977
	speed: 0.0292s/iter; left time: 1583.6784s
	iters: 1900, epoch: 1 | loss: 2.0278704
	speed: 0.0305s/iter; left time: 1652.4258s
	iters: 2000, epoch: 1 | loss: 2.4652081
	speed: 0.0299s/iter; left time: 1618.5750s
	iters: 2100, epoch: 1 | loss: 1.8421309
	speed: 0.0302s/iter; left time: 1631.9266s
	iters: 2200, epoch: 1 | loss: 1.9564543
	speed: 0.0304s/iter; left time: 1634.7081s
	iters: 2300, epoch: 1 | loss: 1.9642092
	speed: 0.0300s/iter; left time: 1610.9241s
	iters: 2400, epoch: 1 | loss: 1.7117614
	speed: 0.0296s/iter; left time: 1590.5096s
	iters: 2500, epoch: 1 | loss: 1.6921620
	speed: 0.0304s/iter; left time: 1626.1613s
	iters: 2600, epoch: 1 | loss: 1.8202242
	speed: 0.0304s/iter; left time: 1627.5187s
	iters: 2700, epoch: 1 | loss: 1.9081160
	speed: 0.0298s/iter; left time: 1589.6779s
	iters: 2800, epoch: 1 | loss: 2.0540597
	speed: 0.0303s/iter; left time: 1611.2110s
	iters: 2900, epoch: 1 | loss: 1.7598009
	speed: 0.0302s/iter; left time: 1605.0808s
	iters: 3000, epoch: 1 | loss: 1.5166310
	speed: 0.0305s/iter; left time: 1617.2301s
	iters: 3100, epoch: 1 | loss: 1.8866792
	speed: 0.0302s/iter; left time: 1598.8945s
	iters: 3200, epoch: 1 | loss: 1.6327162
	speed: 0.0298s/iter; left time: 1576.5571s
	iters: 3300, epoch: 1 | loss: 1.8128129
	speed: 0.0300s/iter; left time: 1584.3089s
	iters: 3400, epoch: 1 | loss: 1.6652752
	speed: 0.0300s/iter; left time: 1581.6874s
	iters: 3500, epoch: 1 | loss: 2.0016263
	speed: 0.0301s/iter; left time: 1582.9370s
	iters: 3600, epoch: 1 | loss: 1.7555748
	speed: 0.0295s/iter; left time: 1546.9275s
	iters: 3700, epoch: 1 | loss: 1.8406794
	speed: 0.0302s/iter; left time: 1583.2046s
	iters: 3800, epoch: 1 | loss: 2.0548868
	speed: 0.0303s/iter; left time: 1585.5669s
	iters: 3900, epoch: 1 | loss: 1.7228872
	speed: 0.0292s/iter; left time: 1520.8704s
	iters: 4000, epoch: 1 | loss: 2.2113416
	speed: 0.0304s/iter; left time: 1583.1553s
	iters: 4100, epoch: 1 | loss: 1.7319742
	speed: 0.0310s/iter; left time: 1608.3795s
	iters: 4200, epoch: 1 | loss: 1.8562253
	speed: 0.0296s/iter; left time: 1536.8758s
	iters: 4300, epoch: 1 | loss: 1.8803735
	speed: 0.0303s/iter; left time: 1570.7065s
	iters: 4400, epoch: 1 | loss: 1.7639580
	speed: 0.0298s/iter; left time: 1540.0277s
	iters: 4500, epoch: 1 | loss: 1.6434274
	speed: 0.0298s/iter; left time: 1534.4815s
	iters: 4600, epoch: 1 | loss: 1.6624731
	speed: 0.0303s/iter; left time: 1559.0706s
	iters: 4700, epoch: 1 | loss: 2.2021110
	speed: 0.0297s/iter; left time: 1527.7776s
	iters: 4800, epoch: 1 | loss: 1.8161210
	speed: 0.0300s/iter; left time: 1537.8321s
	iters: 4900, epoch: 1 | loss: 1.7155733
	speed: 0.0297s/iter; left time: 1521.0061s
	iters: 5000, epoch: 1 | loss: 1.6237730
	speed: 0.0301s/iter; left time: 1535.0641s
	iters: 5100, epoch: 1 | loss: 1.9476744
	speed: 0.0302s/iter; left time: 1538.6252s
	iters: 5200, epoch: 1 | loss: 1.9449875
	speed: 0.0298s/iter; left time: 1514.5079s
	iters: 5300, epoch: 1 | loss: 1.6509577
	speed: 0.0298s/iter; left time: 1513.9723s
	iters: 5400, epoch: 1 | loss: 2.1476903
	speed: 0.0305s/iter; left time: 1546.8255s
	iters: 5500, epoch: 1 | loss: 2.2849491
	speed: 0.0293s/iter; left time: 1483.5728s
	iters: 5600, epoch: 1 | loss: 1.9059819
	speed: 0.0304s/iter; left time: 1532.0947s
Epoch: 1 cost time: 168.75325226783752
Epoch: 1, Steps: 5606 | Train Loss: 1.9819492 Vali Loss: 2.3739746 Test Loss: 1.8120177
Validation loss decreased (inf --> 2.373975).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.9476249
	speed: 0.8544s/iter; left time: 43025.7253s
	iters: 200, epoch: 2 | loss: 2.1811149
	speed: 0.0301s/iter; left time: 1510.2752s
	iters: 300, epoch: 2 | loss: 1.8959943
	speed: 0.0299s/iter; left time: 1499.1522s
	iters: 400, epoch: 2 | loss: 1.8482727
	speed: 0.0299s/iter; left time: 1494.4284s
	iters: 500, epoch: 2 | loss: 2.4111011
	speed: 0.0295s/iter; left time: 1475.2261s
	iters: 600, epoch: 2 | loss: 2.1354194
	speed: 0.0304s/iter; left time: 1513.6875s
	iters: 700, epoch: 2 | loss: 2.0009975
	speed: 0.0304s/iter; left time: 1510.7558s
	iters: 800, epoch: 2 | loss: 1.7125567
	speed: 0.0299s/iter; left time: 1486.4035s
	iters: 900, epoch: 2 | loss: 2.5157745
	speed: 0.0296s/iter; left time: 1465.9755s
	iters: 1000, epoch: 2 | loss: 2.0338891
	speed: 0.0298s/iter; left time: 1473.7800s
	iters: 1100, epoch: 2 | loss: 2.1874938
	speed: 0.0304s/iter; left time: 1500.3957s
	iters: 1200, epoch: 2 | loss: 1.7619431
	speed: 0.0304s/iter; left time: 1496.1189s
	iters: 1300, epoch: 2 | loss: 2.0060239
	speed: 0.0300s/iter; left time: 1473.4288s
	iters: 1400, epoch: 2 | loss: 2.5782213
	speed: 0.0303s/iter; left time: 1486.4403s
	iters: 1500, epoch: 2 | loss: 1.5533696
	speed: 0.0296s/iter; left time: 1447.7886s
	iters: 1600, epoch: 2 | loss: 2.0915816
	speed: 0.0300s/iter; left time: 1463.4177s
	iters: 1700, epoch: 2 | loss: 1.9659138
	speed: 0.0304s/iter; left time: 1481.2608s
	iters: 1800, epoch: 2 | loss: 1.6927619
	speed: 0.0293s/iter; left time: 1427.6090s
	iters: 1900, epoch: 2 | loss: 2.8759651
	speed: 0.0301s/iter; left time: 1461.1672s
	iters: 2000, epoch: 2 | loss: 2.0789771
	speed: 0.0304s/iter; left time: 1474.9824s
	iters: 2100, epoch: 2 | loss: 1.7738779
	speed: 0.0299s/iter; left time: 1443.8534s
	iters: 2200, epoch: 2 | loss: 2.0111139
	speed: 0.0304s/iter; left time: 1465.7447s
	iters: 2300, epoch: 2 | loss: 2.0099649
	speed: 0.0301s/iter; left time: 1447.6298s
	iters: 2400, epoch: 2 | loss: 1.8924752
	speed: 0.0300s/iter; left time: 1443.9134s
	iters: 2500, epoch: 2 | loss: 1.5202030
	speed: 0.0299s/iter; left time: 1435.7897s
	iters: 2600, epoch: 2 | loss: 1.9659137
	speed: 0.0299s/iter; left time: 1428.5178s
	iters: 2700, epoch: 2 | loss: 2.1077180
	speed: 0.0299s/iter; left time: 1428.8049s
	iters: 2800, epoch: 2 | loss: 2.4271064
	speed: 0.0300s/iter; left time: 1431.5215s
	iters: 2900, epoch: 2 | loss: 1.9843192
	speed: 0.0306s/iter; left time: 1452.9577s
	iters: 3000, epoch: 2 | loss: 1.8213677
	speed: 0.0296s/iter; left time: 1402.5145s
	iters: 3100, epoch: 2 | loss: 2.2688158
	speed: 0.0301s/iter; left time: 1423.0671s
	iters: 3200, epoch: 2 | loss: 1.7320266
	speed: 0.0304s/iter; left time: 1435.9187s
	iters: 3300, epoch: 2 | loss: 1.9610341
	speed: 0.0304s/iter; left time: 1432.4390s
	iters: 3400, epoch: 2 | loss: 1.8304787
	speed: 0.0300s/iter; left time: 1413.7960s
	iters: 3500, epoch: 2 | loss: 2.0175979
	speed: 0.0304s/iter; left time: 1427.1398s
	iters: 3600, epoch: 2 | loss: 2.1912205
	speed: 0.0303s/iter; left time: 1420.2388s
	iters: 3700, epoch: 2 | loss: 1.9679797
	speed: 0.0302s/iter; left time: 1410.9453s
	iters: 3800, epoch: 2 | loss: 2.1383586
	speed: 0.0304s/iter; left time: 1420.5394s
	iters: 3900, epoch: 2 | loss: 1.5869236
	speed: 0.0304s/iter; left time: 1414.8343s
	iters: 4000, epoch: 2 | loss: 1.6190253
	speed: 0.0302s/iter; left time: 1400.7028s
	iters: 4100, epoch: 2 | loss: 2.0297267
	speed: 0.0309s/iter; left time: 1432.1798s
	iters: 4200, epoch: 2 | loss: 1.8033935
	speed: 0.0302s/iter; left time: 1399.0517s
	iters: 4300, epoch: 2 | loss: 2.4184115
	speed: 0.0296s/iter; left time: 1365.2825s
	iters: 4400, epoch: 2 | loss: 2.3184702
	speed: 0.0301s/iter; left time: 1388.0439s
	iters: 4500, epoch: 2 | loss: 1.7739588
	speed: 0.0304s/iter; left time: 1395.2317s
	iters: 4600, epoch: 2 | loss: 2.0616755
	speed: 0.0302s/iter; left time: 1386.7876s
	iters: 4700, epoch: 2 | loss: 2.4166524
	speed: 0.0299s/iter; left time: 1370.1724s
	iters: 4800, epoch: 2 | loss: 2.2534289
	speed: 0.0300s/iter; left time: 1371.4597s
	iters: 4900, epoch: 2 | loss: 1.6772293
	speed: 0.0302s/iter; left time: 1376.9407s
	iters: 5000, epoch: 2 | loss: 1.7329921
	speed: 0.0299s/iter; left time: 1357.8073s
	iters: 5100, epoch: 2 | loss: 1.9339799
	speed: 0.0301s/iter; left time: 1363.7900s
	iters: 5200, epoch: 2 | loss: 1.7035006
	speed: 0.0303s/iter; left time: 1372.6282s
	iters: 5300, epoch: 2 | loss: 1.6978745
	speed: 0.0303s/iter; left time: 1367.5497s
	iters: 5400, epoch: 2 | loss: 2.0907538
	speed: 0.0298s/iter; left time: 1344.3452s
	iters: 5500, epoch: 2 | loss: 2.0401406
	speed: 0.0302s/iter; left time: 1357.9869s
	iters: 5600, epoch: 2 | loss: 1.8713392
	speed: 0.0302s/iter; left time: 1356.3211s
Epoch: 2 cost time: 168.84777355194092
Epoch: 2, Steps: 5606 | Train Loss: 1.9820091 Vali Loss: 2.3924081 Test Loss: 1.8278018
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.8222998
	speed: 0.8484s/iter; left time: 37966.4270s
	iters: 200, epoch: 3 | loss: 2.2724075
	speed: 0.0268s/iter; left time: 1197.2986s
	iters: 300, epoch: 3 | loss: 2.0890930
	speed: 0.0279s/iter; left time: 1242.5663s
	iters: 400, epoch: 3 | loss: 2.0086582
	speed: 0.0274s/iter; left time: 1216.6211s
	iters: 500, epoch: 3 | loss: 2.0974512
	speed: 0.0298s/iter; left time: 1320.2005s
	iters: 600, epoch: 3 | loss: 1.6321601
	speed: 0.0298s/iter; left time: 1320.2237s
	iters: 700, epoch: 3 | loss: 1.6720505
	speed: 0.0302s/iter; left time: 1335.3871s
	iters: 800, epoch: 3 | loss: 1.9297000
	speed: 0.0304s/iter; left time: 1339.7388s
	iters: 900, epoch: 3 | loss: 1.9732546
	speed: 0.0302s/iter; left time: 1329.2423s
	iters: 1000, epoch: 3 | loss: 1.9234288
	speed: 0.0301s/iter; left time: 1319.2588s
	iters: 1100, epoch: 3 | loss: 2.1480396
	speed: 0.0300s/iter; left time: 1310.8178s
	iters: 1200, epoch: 3 | loss: 2.2003093
	speed: 0.0297s/iter; left time: 1295.4173s
	iters: 1300, epoch: 3 | loss: 2.3164730
	speed: 0.0301s/iter; left time: 1309.1250s
	iters: 1400, epoch: 3 | loss: 1.8301917
	speed: 0.0298s/iter; left time: 1293.2626s
	iters: 1500, epoch: 3 | loss: 1.8474326
	speed: 0.0304s/iter; left time: 1317.7225s
	iters: 1600, epoch: 3 | loss: 1.9097461
	speed: 0.0299s/iter; left time: 1291.7899s
	iters: 1700, epoch: 3 | loss: 2.1744187
	speed: 0.0304s/iter; left time: 1309.8220s
	iters: 1800, epoch: 3 | loss: 2.3247232
	speed: 0.0302s/iter; left time: 1298.2004s
	iters: 1900, epoch: 3 | loss: 2.1048663
	speed: 0.0303s/iter; left time: 1303.4524s
	iters: 2000, epoch: 3 | loss: 2.0331211
	speed: 0.0299s/iter; left time: 1283.1204s
	iters: 2100, epoch: 3 | loss: 1.7453742
	speed: 0.0303s/iter; left time: 1293.7910s
	iters: 2200, epoch: 3 | loss: 1.8468632
	speed: 0.0304s/iter; left time: 1295.0777s
	iters: 2300, epoch: 3 | loss: 1.9736022
	speed: 0.0293s/iter; left time: 1245.4215s
	iters: 2400, epoch: 3 | loss: 2.0853488
	speed: 0.0296s/iter; left time: 1255.0837s
	iters: 2500, epoch: 3 | loss: 1.4618000
	speed: 0.0300s/iter; left time: 1271.2675s
	iters: 2600, epoch: 3 | loss: 1.4427458
	speed: 0.0295s/iter; left time: 1245.1553s
	iters: 2700, epoch: 3 | loss: 1.6802514
	speed: 0.0301s/iter; left time: 1270.0087s
	iters: 2800, epoch: 3 | loss: 2.0583162
	speed: 0.0302s/iter; left time: 1269.8540s
	iters: 2900, epoch: 3 | loss: 1.8299935
	speed: 0.0304s/iter; left time: 1273.2803s
	iters: 3000, epoch: 3 | loss: 1.8247762
	speed: 0.0304s/iter; left time: 1271.4563s
	iters: 3100, epoch: 3 | loss: 2.5031953
	speed: 0.0302s/iter; left time: 1260.1843s
	iters: 3200, epoch: 3 | loss: 1.9916596
	speed: 0.0302s/iter; left time: 1257.4118s
	iters: 3300, epoch: 3 | loss: 2.0118232
	speed: 0.0303s/iter; left time: 1260.4327s
	iters: 3400, epoch: 3 | loss: 1.9965214
	speed: 0.0304s/iter; left time: 1257.9931s
	iters: 3500, epoch: 3 | loss: 2.1413836
	speed: 0.0303s/iter; left time: 1254.5142s
	iters: 3600, epoch: 3 | loss: 2.1358318
	speed: 0.0302s/iter; left time: 1244.9360s
	iters: 3700, epoch: 3 | loss: 1.8427771
	speed: 0.0300s/iter; left time: 1236.1470s
	iters: 3800, epoch: 3 | loss: 2.1457298
	speed: 0.0305s/iter; left time: 1251.1250s
	iters: 3900, epoch: 3 | loss: 2.1482158
	speed: 0.0300s/iter; left time: 1229.2512s
	iters: 4000, epoch: 3 | loss: 2.2338798
	speed: 0.0296s/iter; left time: 1209.9252s
	iters: 4100, epoch: 3 | loss: 1.6757309
	speed: 0.0307s/iter; left time: 1251.3692s
	iters: 4200, epoch: 3 | loss: 1.8101737
	speed: 0.0305s/iter; left time: 1238.2508s
	iters: 4300, epoch: 3 | loss: 1.6461607
	speed: 0.0302s/iter; left time: 1223.3880s
	iters: 4400, epoch: 3 | loss: 2.1146655
	speed: 0.0304s/iter; left time: 1229.8547s
	iters: 4500, epoch: 3 | loss: 2.3408113
	speed: 0.0305s/iter; left time: 1229.5746s
	iters: 4600, epoch: 3 | loss: 2.0008726
	speed: 0.0300s/iter; left time: 1208.7827s
	iters: 4700, epoch: 3 | loss: 1.9533468
	speed: 0.0300s/iter; left time: 1202.8906s
	iters: 4800, epoch: 3 | loss: 1.6259770
	speed: 0.0303s/iter; left time: 1211.9457s
	iters: 4900, epoch: 3 | loss: 2.2579153
	speed: 0.0302s/iter; left time: 1206.1062s
	iters: 5000, epoch: 3 | loss: 1.8084345
	speed: 0.0300s/iter; left time: 1197.4099s
	iters: 5100, epoch: 3 | loss: 1.9264435
	speed: 0.0301s/iter; left time: 1194.5995s
	iters: 5200, epoch: 3 | loss: 1.8824816
	speed: 0.0303s/iter; left time: 1203.3164s
	iters: 5300, epoch: 3 | loss: 2.3067760
	speed: 0.0305s/iter; left time: 1205.5363s
	iters: 5400, epoch: 3 | loss: 1.9409606
	speed: 0.0303s/iter; left time: 1196.0854s
	iters: 5500, epoch: 3 | loss: 2.0672741
	speed: 0.0301s/iter; left time: 1185.2584s
	iters: 5600, epoch: 3 | loss: 2.1167905
	speed: 0.0300s/iter; left time: 1179.1155s
Epoch: 3 cost time: 167.90512132644653
Epoch: 3, Steps: 5606 | Train Loss: 1.9814819 Vali Loss: 2.3974574 Test Loss: 1.8320740
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.7204607
	speed: 0.8517s/iter; left time: 33339.4013s
	iters: 200, epoch: 4 | loss: 1.9679745
	speed: 0.0278s/iter; left time: 1086.2183s
	iters: 300, epoch: 4 | loss: 1.8915573
	speed: 0.0291s/iter; left time: 1131.8975s
	iters: 400, epoch: 4 | loss: 1.4783161
	speed: 0.0301s/iter; left time: 1169.4844s
	iters: 500, epoch: 4 | loss: 2.5043161
	speed: 0.0304s/iter; left time: 1177.0253s
	iters: 600, epoch: 4 | loss: 2.2985923
	speed: 0.0304s/iter; left time: 1173.7417s
	iters: 700, epoch: 4 | loss: 1.6758373
	speed: 0.0295s/iter; left time: 1135.6235s
	iters: 800, epoch: 4 | loss: 1.7336327
	speed: 0.0302s/iter; left time: 1160.8725s
	iters: 900, epoch: 4 | loss: 1.8517464
	speed: 0.0303s/iter; left time: 1160.3754s
	iters: 1000, epoch: 4 | loss: 1.9901389
	speed: 0.0295s/iter; left time: 1128.1165s
	iters: 1100, epoch: 4 | loss: 1.8358226
	speed: 0.0292s/iter; left time: 1114.0324s
	iters: 1200, epoch: 4 | loss: 2.0279965
	speed: 0.0305s/iter; left time: 1162.1476s
	iters: 1300, epoch: 4 | loss: 1.9179434
	speed: 0.0300s/iter; left time: 1138.9212s
	iters: 1400, epoch: 4 | loss: 2.1940205
	speed: 0.0293s/iter; left time: 1108.3679s
	iters: 1500, epoch: 4 | loss: 1.6587359
	speed: 0.0302s/iter; left time: 1138.5632s
	iters: 1600, epoch: 4 | loss: 1.7554508
	speed: 0.0297s/iter; left time: 1116.3791s
	iters: 1700, epoch: 4 | loss: 2.0099273
	speed: 0.0303s/iter; left time: 1136.5980s
	iters: 1800, epoch: 4 | loss: 1.8478806
	speed: 0.0302s/iter; left time: 1129.2877s
	iters: 1900, epoch: 4 | loss: 1.9834379
	speed: 0.0304s/iter; left time: 1135.0276s
	iters: 2000, epoch: 4 | loss: 1.7640653
	speed: 0.0298s/iter; left time: 1108.8844s
	iters: 2100, epoch: 4 | loss: 1.7539725
	speed: 0.0304s/iter; left time: 1127.9529s
	iters: 2200, epoch: 4 | loss: 1.7093402
	speed: 0.0301s/iter; left time: 1113.9015s
	iters: 2300, epoch: 4 | loss: 2.5160832
	speed: 0.0304s/iter; left time: 1123.8722s
	iters: 2400, epoch: 4 | loss: 2.2606926
	speed: 0.0302s/iter; left time: 1111.5096s
	iters: 2500, epoch: 4 | loss: 2.0220804
	speed: 0.0301s/iter; left time: 1105.5891s
	iters: 2600, epoch: 4 | loss: 2.0011344
	speed: 0.0302s/iter; left time: 1106.4951s
	iters: 2700, epoch: 4 | loss: 1.7752571
	speed: 0.0300s/iter; left time: 1097.6319s
	iters: 2800, epoch: 4 | loss: 1.8193120
	speed: 0.0300s/iter; left time: 1093.4998s
	iters: 2900, epoch: 4 | loss: 2.3525021
	speed: 0.0296s/iter; left time: 1074.4359s
	iters: 3000, epoch: 4 | loss: 2.1465130
	speed: 0.0302s/iter; left time: 1095.8205s
	iters: 3100, epoch: 4 | loss: 2.0556092
	speed: 0.0305s/iter; left time: 1101.9219s
	iters: 3200, epoch: 4 | loss: 1.7837414
	speed: 0.0300s/iter; left time: 1080.4144s
	iters: 3300, epoch: 4 | loss: 1.9712442
	speed: 0.0304s/iter; left time: 1093.5661s
	iters: 3400, epoch: 4 | loss: 1.7840594
	speed: 0.0305s/iter; left time: 1091.5657s
	iters: 3500, epoch: 4 | loss: 2.0130672
	speed: 0.0303s/iter; left time: 1082.7897s
	iters: 3600, epoch: 4 | loss: 1.7577896
	speed: 0.0302s/iter; left time: 1076.8230s
	iters: 3700, epoch: 4 | loss: 2.2035646
	speed: 0.0304s/iter; left time: 1079.4260s
	iters: 3800, epoch: 4 | loss: 1.7504343
	speed: 0.0297s/iter; left time: 1052.8638s
	iters: 3900, epoch: 4 | loss: 2.0532203
	speed: 0.0298s/iter; left time: 1051.4545s
	iters: 4000, epoch: 4 | loss: 1.7219468
	speed: 0.0299s/iter; left time: 1052.7549s
	iters: 4100, epoch: 4 | loss: 1.6098078
	speed: 0.0307s/iter; left time: 1078.7005s
	iters: 4200, epoch: 4 | loss: 1.6265244
	speed: 0.0302s/iter; left time: 1057.2511s
	iters: 4300, epoch: 4 | loss: 2.2327018
	speed: 0.0299s/iter; left time: 1043.0926s
	iters: 4400, epoch: 4 | loss: 2.3218091
	speed: 0.0302s/iter; left time: 1051.1445s
	iters: 4500, epoch: 4 | loss: 1.8196732
	speed: 0.0297s/iter; left time: 1033.2321s
	iters: 4600, epoch: 4 | loss: 2.0921061
	speed: 0.0302s/iter; left time: 1044.7325s
	iters: 4700, epoch: 4 | loss: 1.9189668
	speed: 0.0305s/iter; left time: 1051.9666s
	iters: 4800, epoch: 4 | loss: 2.1129217
	speed: 0.0301s/iter; left time: 1038.3411s
	iters: 4900, epoch: 4 | loss: 2.0501804
	speed: 0.0305s/iter; left time: 1047.6087s
	iters: 5000, epoch: 4 | loss: 2.0652287
	speed: 0.0304s/iter; left time: 1042.4480s
	iters: 5100, epoch: 4 | loss: 1.8646142
	speed: 0.0301s/iter; left time: 1026.7529s
	iters: 5200, epoch: 4 | loss: 2.0432220
	speed: 0.0299s/iter; left time: 1017.5046s
	iters: 5300, epoch: 4 | loss: 2.3254671
	speed: 0.0301s/iter; left time: 1021.7486s
	iters: 5400, epoch: 4 | loss: 2.2256494
	speed: 0.0304s/iter; left time: 1028.3247s
	iters: 5500, epoch: 4 | loss: 2.1322360
	speed: 0.0292s/iter; left time: 983.9524s
	iters: 5600, epoch: 4 | loss: 1.4764160
	speed: 0.0301s/iter; left time: 1011.4292s
Epoch: 4 cost time: 168.0637354850769
Epoch: 4, Steps: 5606 | Train Loss: 1.9813510 Vali Loss: 2.4056048 Test Loss: 1.8396455
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 193741
test shape: (19374, 1, 96, 107) (19374, 1, 96, 107)
test shape: (19374, 96, 107) (19374, 96, 107)
mse:1.8120157718658447, mae:1.0522370338439941
>>>>>>>Overall time: 1154 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
