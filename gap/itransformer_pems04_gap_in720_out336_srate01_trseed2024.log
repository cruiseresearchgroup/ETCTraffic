Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=822, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems04_all_common_flow.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems04_all_720_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=720, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_720_336_iTransformer_custom_ftM_sl720_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1497590
val 123655
test 352763
	iters: 100, epoch: 1 | loss: 0.7998813
	speed: 0.1430s/iter; left time: 13373.5655s
	iters: 200, epoch: 1 | loss: 0.8099517
	speed: 0.1342s/iter; left time: 12532.3359s
	iters: 300, epoch: 1 | loss: 0.9388677
	speed: 0.1314s/iter; left time: 12258.9279s
	iters: 400, epoch: 1 | loss: 1.0906084
	speed: 0.1315s/iter; left time: 12250.3458s
	iters: 500, epoch: 1 | loss: 1.1056383
	speed: 0.1316s/iter; left time: 12254.7166s
	iters: 600, epoch: 1 | loss: 0.9404251
	speed: 0.1311s/iter; left time: 12188.2697s
	iters: 700, epoch: 1 | loss: 1.1748695
	speed: 0.1340s/iter; left time: 12447.4670s
	iters: 800, epoch: 1 | loss: 1.1942210
	speed: 0.1363s/iter; left time: 12650.3341s
	iters: 900, epoch: 1 | loss: 1.0452374
	speed: 0.1357s/iter; left time: 12577.1945s
	iters: 1000, epoch: 1 | loss: 1.1306623
	speed: 0.1368s/iter; left time: 12662.8673s
	iters: 1100, epoch: 1 | loss: 0.9685419
	speed: 0.1364s/iter; left time: 12611.8601s
	iters: 1200, epoch: 1 | loss: 0.9428581
	speed: 0.1340s/iter; left time: 12376.9802s
	iters: 1300, epoch: 1 | loss: 1.1575123
	speed: 0.1342s/iter; left time: 12389.5771s
	iters: 1400, epoch: 1 | loss: 1.0314715
	speed: 0.1378s/iter; left time: 12699.9629s
	iters: 1500, epoch: 1 | loss: 1.1036903
	speed: 0.1360s/iter; left time: 12521.7838s
	iters: 1600, epoch: 1 | loss: 1.1096991
	speed: 0.1311s/iter; left time: 12058.6688s
	iters: 1700, epoch: 1 | loss: 1.1785666
	speed: 0.1325s/iter; left time: 12178.7778s
	iters: 1800, epoch: 1 | loss: 1.2751967
	speed: 0.1306s/iter; left time: 11983.7167s
	iters: 1900, epoch: 1 | loss: 1.1253412
	speed: 0.1304s/iter; left time: 11955.4092s
	iters: 2000, epoch: 1 | loss: 1.0292743
	speed: 0.1323s/iter; left time: 12114.2579s
	iters: 2100, epoch: 1 | loss: 1.1622043
	speed: 0.1380s/iter; left time: 12622.2707s
	iters: 2200, epoch: 1 | loss: 1.1159269
	speed: 0.1304s/iter; left time: 11918.2719s
	iters: 2300, epoch: 1 | loss: 1.1341480
	speed: 0.1305s/iter; left time: 11912.5454s
	iters: 2400, epoch: 1 | loss: 1.0878379
	speed: 0.1368s/iter; left time: 12476.3212s
	iters: 2500, epoch: 1 | loss: 1.0509651
	speed: 0.1360s/iter; left time: 12388.5848s
	iters: 2600, epoch: 1 | loss: 1.0149779
	speed: 0.1301s/iter; left time: 11839.8421s
	iters: 2700, epoch: 1 | loss: 1.2193296
	speed: 0.1303s/iter; left time: 11838.7815s
	iters: 2800, epoch: 1 | loss: 1.1307331
	speed: 0.1358s/iter; left time: 12331.4139s
	iters: 2900, epoch: 1 | loss: 1.0119654
	speed: 0.1315s/iter; left time: 11928.8031s
	iters: 3000, epoch: 1 | loss: 0.9764211
	speed: 0.1315s/iter; left time: 11916.1408s
	iters: 3100, epoch: 1 | loss: 1.0775028
	speed: 0.1318s/iter; left time: 11924.9648s
	iters: 3200, epoch: 1 | loss: 1.0050924
	speed: 0.1306s/iter; left time: 11809.5627s
	iters: 3300, epoch: 1 | loss: 1.0904660
	speed: 0.1305s/iter; left time: 11782.9244s
	iters: 3400, epoch: 1 | loss: 1.3812267
	speed: 0.1328s/iter; left time: 11980.4754s
	iters: 3500, epoch: 1 | loss: 1.0797536
	speed: 0.1321s/iter; left time: 11901.2136s
	iters: 3600, epoch: 1 | loss: 1.0669417
	speed: 0.1314s/iter; left time: 11827.2018s
	iters: 3700, epoch: 1 | loss: 1.1266288
	speed: 0.1320s/iter; left time: 11866.8081s
	iters: 3800, epoch: 1 | loss: 1.1412369
	speed: 0.1317s/iter; left time: 11829.0816s
	iters: 3900, epoch: 1 | loss: 1.3557668
	speed: 0.1311s/iter; left time: 11758.9337s
	iters: 4000, epoch: 1 | loss: 1.1099070
	speed: 0.1321s/iter; left time: 11839.1436s
	iters: 4100, epoch: 1 | loss: 1.0579470
	speed: 0.1313s/iter; left time: 11750.2100s
	iters: 4200, epoch: 1 | loss: 1.0156451
	speed: 0.1315s/iter; left time: 11759.0934s
	iters: 4300, epoch: 1 | loss: 1.0288161
	speed: 0.1316s/iter; left time: 11748.2266s
	iters: 4400, epoch: 1 | loss: 1.1641723
	speed: 0.1333s/iter; left time: 11893.3583s
	iters: 4500, epoch: 1 | loss: 1.0444860
	speed: 0.1319s/iter; left time: 11753.9856s
	iters: 4600, epoch: 1 | loss: 1.0674710
	speed: 0.1319s/iter; left time: 11736.7040s
	iters: 4700, epoch: 1 | loss: 1.1080269
	speed: 0.1320s/iter; left time: 11737.1556s
	iters: 4800, epoch: 1 | loss: 1.0452460
	speed: 0.1317s/iter; left time: 11693.4996s
	iters: 4900, epoch: 1 | loss: 1.1310775
	speed: 0.1318s/iter; left time: 11689.9786s
	iters: 5000, epoch: 1 | loss: 1.0484357
	speed: 0.1320s/iter; left time: 11695.7284s
	iters: 5100, epoch: 1 | loss: 1.1276981
	speed: 0.1321s/iter; left time: 11690.5477s
	iters: 5200, epoch: 1 | loss: 1.0919852
	speed: 0.1323s/iter; left time: 11697.0120s
	iters: 5300, epoch: 1 | loss: 1.1308137
	speed: 0.1320s/iter; left time: 11656.5419s
	iters: 5400, epoch: 1 | loss: 1.0348411
	speed: 0.1317s/iter; left time: 11616.7060s
	iters: 5500, epoch: 1 | loss: 1.1147431
	speed: 0.1334s/iter; left time: 11754.2106s
	iters: 5600, epoch: 1 | loss: 1.0880066
	speed: 0.1348s/iter; left time: 11862.2458s
	iters: 5700, epoch: 1 | loss: 1.1977986
	speed: 0.1325s/iter; left time: 11644.2962s
	iters: 5800, epoch: 1 | loss: 1.0995134
	speed: 0.1325s/iter; left time: 11630.6690s
	iters: 5900, epoch: 1 | loss: 1.1072966
	speed: 0.1327s/iter; left time: 11633.6559s
	iters: 6000, epoch: 1 | loss: 1.0409740
	speed: 0.1331s/iter; left time: 11659.0838s
	iters: 6100, epoch: 1 | loss: 1.1592214
	speed: 0.1318s/iter; left time: 11530.4588s
	iters: 6200, epoch: 1 | loss: 1.0555530
	speed: 0.1370s/iter; left time: 11976.6604s
	iters: 6300, epoch: 1 | loss: 1.0517701
	speed: 0.1349s/iter; left time: 11775.2335s
	iters: 6400, epoch: 1 | loss: 1.0581189
	speed: 0.1304s/iter; left time: 11366.2751s
	iters: 6500, epoch: 1 | loss: 1.1052588
	speed: 0.1339s/iter; left time: 11661.2377s
	iters: 6600, epoch: 1 | loss: 1.0559516
	speed: 0.1346s/iter; left time: 11710.0609s
	iters: 6700, epoch: 1 | loss: 1.1097500
	speed: 0.1317s/iter; left time: 11444.2663s
	iters: 6800, epoch: 1 | loss: 1.1214805
	speed: 0.1308s/iter; left time: 11349.5973s
	iters: 6900, epoch: 1 | loss: 1.0563422
	speed: 0.1311s/iter; left time: 11362.8573s
	iters: 7000, epoch: 1 | loss: 1.0616263
	speed: 0.1364s/iter; left time: 11807.1589s
	iters: 7100, epoch: 1 | loss: 1.0598820
	speed: 0.1318s/iter; left time: 11399.4677s
	iters: 7200, epoch: 1 | loss: 1.0971758
	speed: 0.1344s/iter; left time: 11612.1704s
	iters: 7300, epoch: 1 | loss: 1.0494509
	speed: 0.1351s/iter; left time: 11657.4314s
	iters: 7400, epoch: 1 | loss: 0.9760653
	speed: 0.1330s/iter; left time: 11466.6903s
	iters: 7500, epoch: 1 | loss: 1.1559714
	speed: 0.1304s/iter; left time: 11227.3862s
	iters: 7600, epoch: 1 | loss: 1.1668392
	speed: 0.1307s/iter; left time: 11235.8953s
	iters: 7700, epoch: 1 | loss: 1.0975975
	speed: 0.1320s/iter; left time: 11333.4335s
	iters: 7800, epoch: 1 | loss: 1.1594104
	speed: 0.1327s/iter; left time: 11381.7756s
	iters: 7900, epoch: 1 | loss: 1.1029944
	speed: 0.1321s/iter; left time: 11318.6630s
	iters: 8000, epoch: 1 | loss: 1.0483733
	speed: 0.1318s/iter; left time: 11282.2684s
	iters: 8100, epoch: 1 | loss: 1.0362140
	speed: 0.1327s/iter; left time: 11341.7880s
	iters: 8200, epoch: 1 | loss: 0.9860849
	speed: 0.1311s/iter; left time: 11192.9239s
	iters: 8300, epoch: 1 | loss: 1.1529367
	speed: 0.1326s/iter; left time: 11313.4917s
	iters: 8400, epoch: 1 | loss: 1.0015540
	speed: 0.1327s/iter; left time: 11305.0074s
	iters: 8500, epoch: 1 | loss: 1.0816677
	speed: 0.1342s/iter; left time: 11416.3852s
	iters: 8600, epoch: 1 | loss: 1.1545857
	speed: 0.1316s/iter; left time: 11185.4917s
	iters: 8700, epoch: 1 | loss: 1.0989913
	speed: 0.1323s/iter; left time: 11235.2307s
	iters: 8800, epoch: 1 | loss: 1.0565091
	speed: 0.1321s/iter; left time: 11197.8422s
	iters: 8900, epoch: 1 | loss: 1.0400012
	speed: 0.1333s/iter; left time: 11292.0365s
	iters: 9000, epoch: 1 | loss: 1.0400802
	speed: 0.1332s/iter; left time: 11268.8075s
	iters: 9100, epoch: 1 | loss: 1.0846788
	speed: 0.1323s/iter; left time: 11181.6517s
	iters: 9200, epoch: 1 | loss: 1.0773695
	speed: 0.1313s/iter; left time: 11078.5755s
	iters: 9300, epoch: 1 | loss: 1.0860376
	speed: 0.1367s/iter; left time: 11522.0343s
Epoch: 1 cost time: 1243.8510835170746
Epoch: 1, Steps: 9359 | Train Loss: 1.0805634 Vali Loss: 1.0902500 Test Loss: 0.9732136
Validation loss decreased (inf --> 1.090250).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.0633622
	speed: 4.4214s/iter; left time: 371981.2756s
	iters: 200, epoch: 2 | loss: 1.0501268
	speed: 0.1303s/iter; left time: 10950.8984s
	iters: 300, epoch: 2 | loss: 1.0328101
	speed: 0.1304s/iter; left time: 10945.3409s
	iters: 400, epoch: 2 | loss: 1.1008755
	speed: 0.1303s/iter; left time: 10926.0912s
	iters: 500, epoch: 2 | loss: 1.0911031
	speed: 0.1306s/iter; left time: 10937.8055s
	iters: 600, epoch: 2 | loss: 1.1386527
	speed: 0.1307s/iter; left time: 10929.8800s
	iters: 700, epoch: 2 | loss: 1.0949444
	speed: 0.1304s/iter; left time: 10895.0061s
	iters: 800, epoch: 2 | loss: 1.0134568
	speed: 0.1305s/iter; left time: 10887.0473s
	iters: 900, epoch: 2 | loss: 1.1226733
	speed: 0.1305s/iter; left time: 10874.6440s
	iters: 1000, epoch: 2 | loss: 0.9920883
	speed: 0.1306s/iter; left time: 10867.9131s
	iters: 1100, epoch: 2 | loss: 1.0675223
	speed: 0.1306s/iter; left time: 10854.8694s
	iters: 1200, epoch: 2 | loss: 1.1253692
	speed: 0.1305s/iter; left time: 10838.0288s
	iters: 1300, epoch: 2 | loss: 1.1320939
	speed: 0.1303s/iter; left time: 10809.6722s
	iters: 1400, epoch: 2 | loss: 1.0937166
	speed: 0.1362s/iter; left time: 11285.2496s
	iters: 1500, epoch: 2 | loss: 1.2408066
	speed: 0.1325s/iter; left time: 10959.6978s
	iters: 1600, epoch: 2 | loss: 1.1260799
	speed: 0.1305s/iter; left time: 10787.5334s
	iters: 1700, epoch: 2 | loss: 1.1221756
	speed: 0.1305s/iter; left time: 10773.8041s
	iters: 1800, epoch: 2 | loss: 1.0493134
	speed: 0.1306s/iter; left time: 10769.2088s
	iters: 1900, epoch: 2 | loss: 1.0930018
	speed: 0.1305s/iter; left time: 10740.7226s
	iters: 2000, epoch: 2 | loss: 1.0477426
	speed: 0.1338s/iter; left time: 11005.0973s
	iters: 2100, epoch: 2 | loss: 1.0726643
	speed: 0.1382s/iter; left time: 11349.1954s
	iters: 2200, epoch: 2 | loss: 1.0453135
	speed: 0.1318s/iter; left time: 10809.3303s
	iters: 2300, epoch: 2 | loss: 1.0682019
	speed: 0.1308s/iter; left time: 10714.7805s
	iters: 2400, epoch: 2 | loss: 1.2150599
	speed: 0.1313s/iter; left time: 10742.5136s
	iters: 2500, epoch: 2 | loss: 1.0418535
	speed: 0.1337s/iter; left time: 10929.2284s
	iters: 2600, epoch: 2 | loss: 1.0094441
	speed: 0.1336s/iter; left time: 10907.0528s
	iters: 2700, epoch: 2 | loss: 1.1043186
	speed: 0.1306s/iter; left time: 10645.9662s
	iters: 2800, epoch: 2 | loss: 1.0461307
	speed: 0.1320s/iter; left time: 10747.2359s
	iters: 2900, epoch: 2 | loss: 1.1064041
	speed: 0.1325s/iter; left time: 10774.3830s
	iters: 3000, epoch: 2 | loss: 1.2018788
	speed: 0.1314s/iter; left time: 10677.6739s
	iters: 3100, epoch: 2 | loss: 1.1017290
	speed: 0.1316s/iter; left time: 10678.5512s
	iters: 3200, epoch: 2 | loss: 1.1009227
	speed: 0.1372s/iter; left time: 11114.2520s
	iters: 3300, epoch: 2 | loss: 1.1580505
	speed: 0.1313s/iter; left time: 10625.0648s
	iters: 3400, epoch: 2 | loss: 1.0476385
	speed: 0.1319s/iter; left time: 10661.5871s
	iters: 3500, epoch: 2 | loss: 1.0464134
	speed: 0.1318s/iter; left time: 10641.5120s
	iters: 3600, epoch: 2 | loss: 1.0790370
	speed: 0.1326s/iter; left time: 10691.5748s
	iters: 3700, epoch: 2 | loss: 1.0785404
	speed: 0.1314s/iter; left time: 10585.9105s
	iters: 3800, epoch: 2 | loss: 1.0651463
	speed: 0.1324s/iter; left time: 10651.0842s
	iters: 3900, epoch: 2 | loss: 1.0210189
	speed: 0.1317s/iter; left time: 10580.7974s
	iters: 4000, epoch: 2 | loss: 1.0626650
	speed: 0.1321s/iter; left time: 10602.1468s
	iters: 4100, epoch: 2 | loss: 1.1366136
	speed: 0.1338s/iter; left time: 10719.0946s
	iters: 4200, epoch: 2 | loss: 1.1187558
	speed: 0.1321s/iter; left time: 10573.2217s
	iters: 4300, epoch: 2 | loss: 1.0630486
	speed: 0.1353s/iter; left time: 10812.0145s
	iters: 4400, epoch: 2 | loss: 1.0421755
	speed: 0.1288s/iter; left time: 10280.2206s
	iters: 4500, epoch: 2 | loss: 0.9505274
	speed: 0.1347s/iter; left time: 10736.2468s
	iters: 4600, epoch: 2 | loss: 1.0537117
	speed: 0.1340s/iter; left time: 10672.6888s
	iters: 4700, epoch: 2 | loss: 1.0586429
	speed: 0.1318s/iter; left time: 10481.5973s
	iters: 4800, epoch: 2 | loss: 1.0239084
	speed: 0.1333s/iter; left time: 10586.2111s
	iters: 4900, epoch: 2 | loss: 1.0601364
	speed: 0.1338s/iter; left time: 10611.7830s
	iters: 5000, epoch: 2 | loss: 1.0737455
	speed: 0.1318s/iter; left time: 10441.6231s
	iters: 5100, epoch: 2 | loss: 1.1005020
	speed: 0.1265s/iter; left time: 10006.4191s
	iters: 5200, epoch: 2 | loss: 1.2564569
	speed: 0.1275s/iter; left time: 10073.5983s
	iters: 5300, epoch: 2 | loss: 1.0731736
	speed: 0.1268s/iter; left time: 10009.8874s
	iters: 5400, epoch: 2 | loss: 1.1506673
	speed: 0.1291s/iter; left time: 10174.7424s
	iters: 5500, epoch: 2 | loss: 1.0771140
	speed: 0.1253s/iter; left time: 9864.2065s
	iters: 5600, epoch: 2 | loss: 1.0839431
	speed: 0.1309s/iter; left time: 10293.6471s
	iters: 5700, epoch: 2 | loss: 1.0051137
	speed: 0.1318s/iter; left time: 10350.5427s
	iters: 5800, epoch: 2 | loss: 1.0807462
	speed: 0.1340s/iter; left time: 10512.0541s
	iters: 5900, epoch: 2 | loss: 0.9985973
	speed: 0.1323s/iter; left time: 10364.7900s
	iters: 6000, epoch: 2 | loss: 1.0025048
	speed: 0.1345s/iter; left time: 10518.8025s
	iters: 6100, epoch: 2 | loss: 1.0822250
	speed: 0.1353s/iter; left time: 10571.8620s
	iters: 6200, epoch: 2 | loss: 1.0565029
	speed: 0.1367s/iter; left time: 10668.3339s
	iters: 6300, epoch: 2 | loss: 1.1286744
	speed: 0.1360s/iter; left time: 10600.4662s
	iters: 6400, epoch: 2 | loss: 1.0811970
	speed: 0.1336s/iter; left time: 10399.6407s
	iters: 6500, epoch: 2 | loss: 1.1743023
	speed: 0.1340s/iter; left time: 10418.6298s
	iters: 6600, epoch: 2 | loss: 1.1915890
	speed: 0.1351s/iter; left time: 10490.3983s
	iters: 6700, epoch: 2 | loss: 1.0868294
	speed: 0.1359s/iter; left time: 10535.7980s
	iters: 6800, epoch: 2 | loss: 1.1073427
	speed: 0.1359s/iter; left time: 10526.3777s
	iters: 6900, epoch: 2 | loss: 1.0938331
	speed: 0.1360s/iter; left time: 10514.9193s
	iters: 7000, epoch: 2 | loss: 1.1925479
	speed: 0.1321s/iter; left time: 10199.7935s
	iters: 7100, epoch: 2 | loss: 1.0396398
	speed: 0.1315s/iter; left time: 10143.4065s
	iters: 7200, epoch: 2 | loss: 1.1048769
	speed: 0.1341s/iter; left time: 10326.4018s
	iters: 7300, epoch: 2 | loss: 1.0404506
	speed: 0.1325s/iter; left time: 10195.4706s
	iters: 7400, epoch: 2 | loss: 1.0921484
	speed: 0.1331s/iter; left time: 10228.6564s
	iters: 7500, epoch: 2 | loss: 1.0319755
	speed: 0.1321s/iter; left time: 10132.6675s
	iters: 7600, epoch: 2 | loss: 1.0923505
	speed: 0.1312s/iter; left time: 10057.4510s
	iters: 7700, epoch: 2 | loss: 1.1487690
	speed: 0.1294s/iter; left time: 9905.7339s
	iters: 7800, epoch: 2 | loss: 1.0923384
	speed: 0.1335s/iter; left time: 10200.4926s
	iters: 7900, epoch: 2 | loss: 1.0657851
	speed: 0.1321s/iter; left time: 10083.6119s
	iters: 8000, epoch: 2 | loss: 1.0969049
	speed: 0.1312s/iter; left time: 9998.8622s
	iters: 8100, epoch: 2 | loss: 1.1416188
	speed: 0.1332s/iter; left time: 10139.3411s
	iters: 8200, epoch: 2 | loss: 1.0148463
	speed: 0.1316s/iter; left time: 10007.6405s
	iters: 8300, epoch: 2 | loss: 1.1150664
	speed: 0.1328s/iter; left time: 10087.5359s
	iters: 8400, epoch: 2 | loss: 0.9887444
	speed: 0.1319s/iter; left time: 10002.2526s
	iters: 8500, epoch: 2 | loss: 1.0277307
	speed: 0.1318s/iter; left time: 9983.7227s
	iters: 8600, epoch: 2 | loss: 1.0295466
	speed: 0.1316s/iter; left time: 9954.7615s
	iters: 8700, epoch: 2 | loss: 1.0888689
	speed: 0.1315s/iter; left time: 9933.8674s
	iters: 8800, epoch: 2 | loss: 1.0868652
	speed: 0.1338s/iter; left time: 10093.3054s
	iters: 8900, epoch: 2 | loss: 1.0389847
	speed: 0.1341s/iter; left time: 10102.6402s
	iters: 9000, epoch: 2 | loss: 1.0979011
	speed: 0.1316s/iter; left time: 9898.2198s
	iters: 9100, epoch: 2 | loss: 0.9946288
	speed: 0.1350s/iter; left time: 10143.6263s
	iters: 9200, epoch: 2 | loss: 1.0433725
	speed: 0.1313s/iter; left time: 9850.3099s
	iters: 9300, epoch: 2 | loss: 1.0450171
	speed: 0.1316s/iter; left time: 9863.4347s
Epoch: 2 cost time: 1238.0443794727325
Epoch: 2, Steps: 9359 | Train Loss: 1.0901597 Vali Loss: 1.0901225 Test Loss: 0.9751968
Validation loss decreased (1.090250 --> 1.090122).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.9763215
	speed: 4.5498s/iter; left time: 340199.4858s
	iters: 200, epoch: 3 | loss: 1.0729507
	speed: 0.1272s/iter; left time: 9497.2979s
	iters: 300, epoch: 3 | loss: 0.9912009
	speed: 0.1335s/iter; left time: 9956.0631s
	iters: 400, epoch: 3 | loss: 1.1252286
	speed: 0.1316s/iter; left time: 9799.6495s
	iters: 500, epoch: 3 | loss: 0.9932991
	speed: 0.1329s/iter; left time: 9886.2789s
	iters: 600, epoch: 3 | loss: 1.0574363
	speed: 0.1322s/iter; left time: 9817.8308s
	iters: 700, epoch: 3 | loss: 1.2862835
	speed: 0.1318s/iter; left time: 9778.9837s
	iters: 800, epoch: 3 | loss: 1.0638652
	speed: 0.1313s/iter; left time: 9727.4025s
	iters: 900, epoch: 3 | loss: 1.1176611
	speed: 0.1353s/iter; left time: 10006.6077s
	iters: 1000, epoch: 3 | loss: 1.1194981
	speed: 0.1327s/iter; left time: 9802.1903s
	iters: 1100, epoch: 3 | loss: 1.0999515
	speed: 0.1318s/iter; left time: 9725.3065s
	iters: 1200, epoch: 3 | loss: 1.2611010
	speed: 0.1325s/iter; left time: 9763.6580s
	iters: 1300, epoch: 3 | loss: 1.0794247
	speed: 0.1333s/iter; left time: 9810.5244s
	iters: 1400, epoch: 3 | loss: 1.1062400
	speed: 0.1341s/iter; left time: 9850.6924s
	iters: 1500, epoch: 3 | loss: 1.1491691
	speed: 0.1323s/iter; left time: 9706.0096s
	iters: 1600, epoch: 3 | loss: 1.1685776
	speed: 0.1361s/iter; left time: 9972.7901s
	iters: 1700, epoch: 3 | loss: 1.0810966
	speed: 0.1319s/iter; left time: 9647.9910s
	iters: 1800, epoch: 3 | loss: 1.1042349
	speed: 0.1330s/iter; left time: 9715.5502s
	iters: 1900, epoch: 3 | loss: 1.1121790
	speed: 0.1319s/iter; left time: 9622.1336s
	iters: 2000, epoch: 3 | loss: 1.2182862
	speed: 0.1315s/iter; left time: 9581.5088s
	iters: 2100, epoch: 3 | loss: 1.1289933
	speed: 0.1325s/iter; left time: 9643.8903s
	iters: 2200, epoch: 3 | loss: 1.1543286
	speed: 0.1310s/iter; left time: 9523.7159s
	iters: 2300, epoch: 3 | loss: 1.1230682
	speed: 0.1314s/iter; left time: 9539.6151s
	iters: 2400, epoch: 3 | loss: 1.1126585
	speed: 0.1318s/iter; left time: 9550.4169s
	iters: 2500, epoch: 3 | loss: 1.2037159
	speed: 0.1320s/iter; left time: 9551.4632s
	iters: 2600, epoch: 3 | loss: 1.2945014
	speed: 0.1328s/iter; left time: 9598.3503s
	iters: 2700, epoch: 3 | loss: 1.1165869
	speed: 0.1309s/iter; left time: 9447.7693s
	iters: 2800, epoch: 3 | loss: 1.0865731
	speed: 0.1312s/iter; left time: 9458.1052s
	iters: 2900, epoch: 3 | loss: 1.0774019
	speed: 0.1324s/iter; left time: 9527.1285s
	iters: 3000, epoch: 3 | loss: 1.0451282
	speed: 0.1312s/iter; left time: 9427.1396s
	iters: 3100, epoch: 3 | loss: 1.0906123
	speed: 0.1308s/iter; left time: 9388.7386s
	iters: 3200, epoch: 3 | loss: 0.9478093
	speed: 0.1308s/iter; left time: 9377.9046s
	iters: 3300, epoch: 3 | loss: 1.1132610
	speed: 0.1339s/iter; left time: 9583.4845s
	iters: 3400, epoch: 3 | loss: 1.0474561
	speed: 0.1309s/iter; left time: 9352.7765s
	iters: 3500, epoch: 3 | loss: 1.0287452
	speed: 0.1326s/iter; left time: 9460.7138s
	iters: 3600, epoch: 3 | loss: 1.1046462
	speed: 0.1330s/iter; left time: 9475.9352s
	iters: 3700, epoch: 3 | loss: 1.0700721
	speed: 0.1308s/iter; left time: 9310.0072s
	iters: 3800, epoch: 3 | loss: 1.0766464
	speed: 0.1334s/iter; left time: 9480.2077s
	iters: 3900, epoch: 3 | loss: 1.0482663
	speed: 0.1323s/iter; left time: 9391.2319s
	iters: 4000, epoch: 3 | loss: 1.1336882
	speed: 0.1328s/iter; left time: 9414.3685s
	iters: 4100, epoch: 3 | loss: 1.0586548
	speed: 0.1328s/iter; left time: 9400.9325s
	iters: 4200, epoch: 3 | loss: 1.0395176
	speed: 0.1374s/iter; left time: 9711.8084s
	iters: 4300, epoch: 3 | loss: 1.0762416
	speed: 0.1348s/iter; left time: 9511.6177s
	iters: 4400, epoch: 3 | loss: 1.0718226
	speed: 0.1317s/iter; left time: 9279.2798s
	iters: 4500, epoch: 3 | loss: 1.1197884
	speed: 0.1317s/iter; left time: 9265.6205s
	iters: 4600, epoch: 3 | loss: 1.0054613
	speed: 0.1317s/iter; left time: 9255.7262s
	iters: 4700, epoch: 3 | loss: 1.0168331
	speed: 0.1313s/iter; left time: 9214.9735s
	iters: 4800, epoch: 3 | loss: 1.0375358
	speed: 0.1316s/iter; left time: 9218.8561s
	iters: 4900, epoch: 3 | loss: 1.0470505
	speed: 0.1321s/iter; left time: 9243.3372s
	iters: 5000, epoch: 3 | loss: 1.0085899
	speed: 0.1344s/iter; left time: 9393.2823s
	iters: 5100, epoch: 3 | loss: 0.9829516
	speed: 0.1365s/iter; left time: 9524.3995s
	iters: 5200, epoch: 3 | loss: 1.0923153
	speed: 0.1371s/iter; left time: 9552.8202s
	iters: 5300, epoch: 3 | loss: 1.1068842
	speed: 0.1344s/iter; left time: 9352.1904s
	iters: 5400, epoch: 3 | loss: 1.0220743
	speed: 0.1356s/iter; left time: 9421.9574s
	iters: 5500, epoch: 3 | loss: 1.0849727
	speed: 0.1339s/iter; left time: 9291.1038s
	iters: 5600, epoch: 3 | loss: 1.0750231
	speed: 0.1340s/iter; left time: 9283.8204s
	iters: 5700, epoch: 3 | loss: 1.0425346
	speed: 0.1317s/iter; left time: 9112.0924s
	iters: 5800, epoch: 3 | loss: 1.0249050
	speed: 0.1299s/iter; left time: 8970.5294s
	iters: 5900, epoch: 3 | loss: 1.1432347
	speed: 0.1330s/iter; left time: 9172.7487s
	iters: 6000, epoch: 3 | loss: 1.0290543
	speed: 0.1316s/iter; left time: 9062.2064s
	iters: 6100, epoch: 3 | loss: 1.0839193
	speed: 0.1315s/iter; left time: 9043.9895s
	iters: 6200, epoch: 3 | loss: 1.0300760
	speed: 0.1314s/iter; left time: 9023.1611s
	iters: 6300, epoch: 3 | loss: 1.0524255
	speed: 0.1337s/iter; left time: 9171.2887s
	iters: 6400, epoch: 3 | loss: 1.1212132
	speed: 0.1307s/iter; left time: 8948.8642s
	iters: 6500, epoch: 3 | loss: 1.0234693
	speed: 0.1311s/iter; left time: 8963.8288s
	iters: 6600, epoch: 3 | loss: 1.0936002
	speed: 0.1320s/iter; left time: 9013.6194s
	iters: 6700, epoch: 3 | loss: 1.0371847
	speed: 0.1323s/iter; left time: 9021.3898s
	iters: 6800, epoch: 3 | loss: 1.1071236
	speed: 0.1325s/iter; left time: 9022.2261s
	iters: 6900, epoch: 3 | loss: 1.0632412
	speed: 0.1312s/iter; left time: 8920.2573s
	iters: 7000, epoch: 3 | loss: 1.0558853
	speed: 0.1321s/iter; left time: 8963.5780s
	iters: 7100, epoch: 3 | loss: 1.1060590
	speed: 0.1341s/iter; left time: 9085.7162s
	iters: 7200, epoch: 3 | loss: 1.0295345
	speed: 0.1327s/iter; left time: 8982.4385s
	iters: 7300, epoch: 3 | loss: 1.1033849
	speed: 0.1314s/iter; left time: 8882.1285s
	iters: 7400, epoch: 3 | loss: 1.0825304
	speed: 0.1310s/iter; left time: 8840.1823s
	iters: 7500, epoch: 3 | loss: 1.0952822
	speed: 0.1376s/iter; left time: 9267.3745s
	iters: 7600, epoch: 3 | loss: 1.1691351
	speed: 0.1333s/iter; left time: 8970.1718s
	iters: 7700, epoch: 3 | loss: 1.2125306
	speed: 0.1343s/iter; left time: 9022.0666s
	iters: 7800, epoch: 3 | loss: 1.1365685
	speed: 0.1370s/iter; left time: 9189.1622s
	iters: 7900, epoch: 3 | loss: 1.0794876
	speed: 0.1318s/iter; left time: 8829.8805s
	iters: 8000, epoch: 3 | loss: 1.1435039
	speed: 0.1314s/iter; left time: 8786.1195s
	iters: 8100, epoch: 3 | loss: 1.1161075
	speed: 0.1316s/iter; left time: 8788.8509s
	iters: 8200, epoch: 3 | loss: 1.0540967
	speed: 0.1315s/iter; left time: 8769.1267s
	iters: 8300, epoch: 3 | loss: 1.0681386
	speed: 0.1316s/iter; left time: 8758.2892s
	iters: 8400, epoch: 3 | loss: 1.0932924
	speed: 0.1312s/iter; left time: 8719.4006s
	iters: 8500, epoch: 3 | loss: 1.0640304
	speed: 0.1310s/iter; left time: 8692.0834s
	iters: 8600, epoch: 3 | loss: 0.9912648
	speed: 0.1319s/iter; left time: 8743.3772s
	iters: 8700, epoch: 3 | loss: 1.0770037
	speed: 0.1323s/iter; left time: 8754.2403s
	iters: 8800, epoch: 3 | loss: 1.0123463
	speed: 0.1327s/iter; left time: 8770.9577s
	iters: 8900, epoch: 3 | loss: 1.0827109
	speed: 0.1312s/iter; left time: 8658.5290s
	iters: 9000, epoch: 3 | loss: 1.0193117
	speed: 0.1314s/iter; left time: 8655.4005s
	iters: 9100, epoch: 3 | loss: 1.0813696
	speed: 0.1317s/iter; left time: 8659.1875s
	iters: 9200, epoch: 3 | loss: 1.0747539
	speed: 0.1313s/iter; left time: 8621.4945s
	iters: 9300, epoch: 3 | loss: 1.1903452
	speed: 0.1312s/iter; left time: 8605.9045s
Epoch: 3 cost time: 1240.346348285675
Epoch: 3, Steps: 9359 | Train Loss: 1.0898571 Vali Loss: 1.0902773 Test Loss: 0.9716848
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.2560689
	speed: 4.3740s/iter; left time: 286119.2389s
	iters: 200, epoch: 4 | loss: 1.0520920
	speed: 0.1318s/iter; left time: 8606.5270s
	iters: 300, epoch: 4 | loss: 1.0985173
	speed: 0.1316s/iter; left time: 8582.5112s
	iters: 400, epoch: 4 | loss: 1.1172630
	speed: 0.1318s/iter; left time: 8581.5853s
	iters: 500, epoch: 4 | loss: 1.1401727
	speed: 0.1315s/iter; left time: 8546.3591s
	iters: 600, epoch: 4 | loss: 1.0389881
	speed: 0.1326s/iter; left time: 8607.7413s
	iters: 700, epoch: 4 | loss: 1.0884408
	speed: 0.1348s/iter; left time: 8740.0895s
	iters: 800, epoch: 4 | loss: 1.0616890
	speed: 0.1330s/iter; left time: 8603.9939s
	iters: 900, epoch: 4 | loss: 1.0842677
	speed: 0.1341s/iter; left time: 8661.7546s
	iters: 1000, epoch: 4 | loss: 0.9760416
	speed: 0.1304s/iter; left time: 8414.0114s
	iters: 1100, epoch: 4 | loss: 1.0309389
	speed: 0.1304s/iter; left time: 8401.2391s
	iters: 1200, epoch: 4 | loss: 1.0717087
	speed: 0.1305s/iter; left time: 8390.3430s
	iters: 1300, epoch: 4 | loss: 1.0728978
	speed: 0.1305s/iter; left time: 8379.5004s
	iters: 1400, epoch: 4 | loss: 1.0705019
	speed: 0.1304s/iter; left time: 8363.6643s
	iters: 1500, epoch: 4 | loss: 1.0515857
	speed: 0.1304s/iter; left time: 8348.7398s
	iters: 1600, epoch: 4 | loss: 1.1262696
	speed: 0.1305s/iter; left time: 8341.9820s
	iters: 1700, epoch: 4 | loss: 1.0719138
	speed: 0.1352s/iter; left time: 8629.2109s
	iters: 1800, epoch: 4 | loss: 1.1034942
	speed: 0.1306s/iter; left time: 8319.7389s
	iters: 1900, epoch: 4 | loss: 1.0354673
	speed: 0.1308s/iter; left time: 8318.8837s
	iters: 2000, epoch: 4 | loss: 1.1344455
	speed: 0.1306s/iter; left time: 8293.2891s
	iters: 2100, epoch: 4 | loss: 1.4323413
	speed: 0.1305s/iter; left time: 8272.6621s
	iters: 2200, epoch: 4 | loss: 1.0864027
	speed: 0.1305s/iter; left time: 8259.3841s
	iters: 2300, epoch: 4 | loss: 1.0856919
	speed: 0.1305s/iter; left time: 8248.1102s
	iters: 2400, epoch: 4 | loss: 1.0806590
	speed: 0.1348s/iter; left time: 8508.0581s
	iters: 2500, epoch: 4 | loss: 1.1564679
	speed: 0.1308s/iter; left time: 8241.7026s
	iters: 2600, epoch: 4 | loss: 1.0944289
	speed: 0.1320s/iter; left time: 8305.2606s
	iters: 2700, epoch: 4 | loss: 1.0225614
	speed: 0.1335s/iter; left time: 8387.1161s
	iters: 2800, epoch: 4 | loss: 1.0822667
	speed: 0.1338s/iter; left time: 8393.6025s
	iters: 2900, epoch: 4 | loss: 1.0974978
	speed: 0.1305s/iter; left time: 8171.3896s
	iters: 3000, epoch: 4 | loss: 1.0860473
	speed: 0.1303s/iter; left time: 8146.4688s
	iters: 3100, epoch: 4 | loss: 1.1171646
	speed: 0.1388s/iter; left time: 8662.3572s
	iters: 3200, epoch: 4 | loss: 1.0878614
	speed: 0.1356s/iter; left time: 8447.4995s
	iters: 3300, epoch: 4 | loss: 0.9884900
	speed: 0.1302s/iter; left time: 8102.1549s
	iters: 3400, epoch: 4 | loss: 1.1115077
	speed: 0.1302s/iter; left time: 8085.4706s
	iters: 3500, epoch: 4 | loss: 1.0700883
	speed: 0.1303s/iter; left time: 8081.5553s
	iters: 3600, epoch: 4 | loss: 1.1254021
	speed: 0.1308s/iter; left time: 8096.9169s
	iters: 3700, epoch: 4 | loss: 1.0498435
	speed: 0.1307s/iter; left time: 8077.5161s
	iters: 3800, epoch: 4 | loss: 1.0275893
	speed: 0.1329s/iter; left time: 8200.2116s
	iters: 3900, epoch: 4 | loss: 1.0330555
	speed: 0.1363s/iter; left time: 8396.0225s
	iters: 4000, epoch: 4 | loss: 0.9745214
	speed: 0.1319s/iter; left time: 8115.8430s
	iters: 4100, epoch: 4 | loss: 1.0150254
	speed: 0.1310s/iter; left time: 8047.4098s
	iters: 4200, epoch: 4 | loss: 1.0516561
	speed: 0.1304s/iter; left time: 7996.7130s
	iters: 4300, epoch: 4 | loss: 1.0390918
	speed: 0.1304s/iter; left time: 7981.4007s
	iters: 4400, epoch: 4 | loss: 1.0305628
	speed: 0.1304s/iter; left time: 7968.6336s
	iters: 4500, epoch: 4 | loss: 1.1188042
	speed: 0.1304s/iter; left time: 7957.2533s
	iters: 4600, epoch: 4 | loss: 1.0454227
	speed: 0.1304s/iter; left time: 7944.1283s
	iters: 4700, epoch: 4 | loss: 1.0449467
	speed: 0.1320s/iter; left time: 8025.1692s
	iters: 4800, epoch: 4 | loss: 1.0986302
	speed: 0.1328s/iter; left time: 8063.0813s
	iters: 4900, epoch: 4 | loss: 1.1794343
	speed: 0.1305s/iter; left time: 7907.9815s
	iters: 5000, epoch: 4 | loss: 1.0826215
	speed: 0.1316s/iter; left time: 7965.6042s
	iters: 5100, epoch: 4 | loss: 1.0765202
	speed: 0.1334s/iter; left time: 8057.0929s
	iters: 5200, epoch: 4 | loss: 1.1398226
	speed: 0.1318s/iter; left time: 7950.8214s
	iters: 5300, epoch: 4 | loss: 1.1427381
	speed: 0.1307s/iter; left time: 7868.1263s
	iters: 5400, epoch: 4 | loss: 1.0580132
	speed: 0.1306s/iter; left time: 7851.4152s
	iters: 5500, epoch: 4 | loss: 1.1738427
	speed: 0.1307s/iter; left time: 7842.9455s
	iters: 5600, epoch: 4 | loss: 1.0473326
	speed: 0.1307s/iter; left time: 7832.1179s
	iters: 5700, epoch: 4 | loss: 1.0867975
	speed: 0.1307s/iter; left time: 7815.8999s
	iters: 5800, epoch: 4 | loss: 1.1053871
	speed: 0.1305s/iter; left time: 7791.2802s
	iters: 5900, epoch: 4 | loss: 1.0887399
	speed: 0.1318s/iter; left time: 7857.9031s
	iters: 6000, epoch: 4 | loss: 1.0067804
	speed: 0.1306s/iter; left time: 7769.7407s
	iters: 6100, epoch: 4 | loss: 1.1130284
	speed: 0.1303s/iter; left time: 7741.5986s
	iters: 6200, epoch: 4 | loss: 1.0283576
	speed: 0.1345s/iter; left time: 7975.9537s
	iters: 6300, epoch: 4 | loss: 1.0393018
	speed: 0.1316s/iter; left time: 7792.7206s
	iters: 6400, epoch: 4 | loss: 1.0598538
	speed: 0.1321s/iter; left time: 7811.5899s
	iters: 6500, epoch: 4 | loss: 1.1213986
	speed: 0.1313s/iter; left time: 7750.1991s
	iters: 6600, epoch: 4 | loss: 1.1425594
	speed: 0.1315s/iter; left time: 7746.2108s
	iters: 6700, epoch: 4 | loss: 1.0888872
	speed: 0.1312s/iter; left time: 7713.6413s
	iters: 6800, epoch: 4 | loss: 1.1278418
	speed: 0.1302s/iter; left time: 7643.6725s
	iters: 6900, epoch: 4 | loss: 1.1250650
	speed: 0.1302s/iter; left time: 7629.9038s
	iters: 7000, epoch: 4 | loss: 1.0391408
	speed: 0.1308s/iter; left time: 7652.5660s
	iters: 7100, epoch: 4 | loss: 1.1557862
	speed: 0.1363s/iter; left time: 7963.9360s
	iters: 7200, epoch: 4 | loss: 1.1507400
	speed: 0.1304s/iter; left time: 7604.9103s
	iters: 7300, epoch: 4 | loss: 1.2696700
	speed: 0.1332s/iter; left time: 7751.8458s
	iters: 7400, epoch: 4 | loss: 1.1387290
	speed: 0.1303s/iter; left time: 7570.4713s
	iters: 7500, epoch: 4 | loss: 1.1066477
	speed: 0.1302s/iter; left time: 7552.1376s
	iters: 7600, epoch: 4 | loss: 1.0606723
	speed: 0.1302s/iter; left time: 7539.9507s
	iters: 7700, epoch: 4 | loss: 1.0521822
	speed: 0.1303s/iter; left time: 7531.5898s
	iters: 7800, epoch: 4 | loss: 1.1685451
	speed: 0.1319s/iter; left time: 7612.0366s
	iters: 7900, epoch: 4 | loss: 1.0557791
	speed: 0.1305s/iter; left time: 7519.5437s
	iters: 8000, epoch: 4 | loss: 1.0832305
	speed: 0.1343s/iter; left time: 7724.2339s
	iters: 8100, epoch: 4 | loss: 1.0878502
	speed: 0.1322s/iter; left time: 7591.3921s
	iters: 8200, epoch: 4 | loss: 1.1806830
	speed: 0.1315s/iter; left time: 7539.1469s
	iters: 8300, epoch: 4 | loss: 1.1011962
	speed: 0.1315s/iter; left time: 7524.0476s
	iters: 8400, epoch: 4 | loss: 1.1024837
	speed: 0.1315s/iter; left time: 7509.9096s
	iters: 8500, epoch: 4 | loss: 1.0572940
	speed: 0.1316s/iter; left time: 7500.5056s
	iters: 8600, epoch: 4 | loss: 1.1100669
	speed: 0.1311s/iter; left time: 7464.2110s
	iters: 8700, epoch: 4 | loss: 1.1409112
	speed: 0.1315s/iter; left time: 7469.6043s
	iters: 8800, epoch: 4 | loss: 1.0315645
	speed: 0.1303s/iter; left time: 7390.1891s
	iters: 8900, epoch: 4 | loss: 1.0610708
	speed: 0.1303s/iter; left time: 7378.7607s
	iters: 9000, epoch: 4 | loss: 1.1239896
	speed: 0.1303s/iter; left time: 7361.2246s
	iters: 9100, epoch: 4 | loss: 1.0885538
	speed: 0.1305s/iter; left time: 7360.5617s
	iters: 9200, epoch: 4 | loss: 1.0513183
	speed: 0.1304s/iter; left time: 7342.5017s
	iters: 9300, epoch: 4 | loss: 1.1028365
	speed: 0.1305s/iter; left time: 7333.1532s
Epoch: 4 cost time: 1231.858994960785
Epoch: 4, Steps: 9359 | Train Loss: 1.0897667 Vali Loss: 1.0903512 Test Loss: 0.9710646
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.0710739
	speed: 4.6565s/iter; left time: 261019.6709s
	iters: 200, epoch: 5 | loss: 1.0705254
	speed: 0.1319s/iter; left time: 7380.5713s
	iters: 300, epoch: 5 | loss: 1.1020917
	speed: 0.1318s/iter; left time: 7359.8070s
	iters: 400, epoch: 5 | loss: 1.0589163
	speed: 0.1320s/iter; left time: 7358.6228s
	iters: 500, epoch: 5 | loss: 1.0199374
	speed: 0.1322s/iter; left time: 7360.0392s
	iters: 600, epoch: 5 | loss: 1.0715506
	speed: 0.1322s/iter; left time: 7345.4104s
	iters: 700, epoch: 5 | loss: 0.9999803
	speed: 0.1318s/iter; left time: 7311.3534s
	iters: 800, epoch: 5 | loss: 1.1131496
	speed: 0.1319s/iter; left time: 7300.8989s
	iters: 900, epoch: 5 | loss: 1.2820185
	speed: 0.1319s/iter; left time: 7286.4482s
	iters: 1000, epoch: 5 | loss: 1.0535434
	speed: 0.1317s/iter; left time: 7261.5818s
	iters: 1100, epoch: 5 | loss: 1.1387205
	speed: 0.1317s/iter; left time: 7250.1102s
	iters: 1200, epoch: 5 | loss: 1.0568615
	speed: 0.1311s/iter; left time: 7205.6012s
	iters: 1300, epoch: 5 | loss: 1.3728942
	speed: 0.1315s/iter; left time: 7215.7880s
	iters: 1400, epoch: 5 | loss: 1.0450881
	speed: 0.1312s/iter; left time: 7185.9867s
	iters: 1500, epoch: 5 | loss: 1.0874573
	speed: 0.1303s/iter; left time: 7120.9287s
	iters: 1600, epoch: 5 | loss: 1.0981365
	speed: 0.1299s/iter; left time: 7085.2784s
	iters: 1700, epoch: 5 | loss: 1.1490599
	speed: 0.1298s/iter; left time: 7069.7975s
	iters: 1800, epoch: 5 | loss: 1.1097364
	speed: 0.1365s/iter; left time: 7421.9795s
	iters: 1900, epoch: 5 | loss: 1.0653067
	speed: 0.1333s/iter; left time: 7231.8985s
	iters: 2000, epoch: 5 | loss: 1.0199860
	speed: 0.1305s/iter; left time: 7067.1354s
	iters: 2100, epoch: 5 | loss: 1.0848051
	speed: 0.1333s/iter; left time: 7205.5482s
	iters: 2200, epoch: 5 | loss: 1.0876204
	speed: 0.1367s/iter; left time: 7374.6225s
	iters: 2300, epoch: 5 | loss: 1.1211216
	speed: 0.1335s/iter; left time: 7191.2814s
	iters: 2400, epoch: 5 | loss: 1.2520287
	speed: 0.1321s/iter; left time: 7100.7419s
	iters: 2500, epoch: 5 | loss: 1.0837418
	speed: 0.1310s/iter; left time: 7027.6527s
	iters: 2600, epoch: 5 | loss: 1.1219862
	speed: 0.1323s/iter; left time: 7084.7281s
	iters: 2700, epoch: 5 | loss: 1.2052209
	speed: 0.1312s/iter; left time: 7012.5921s
	iters: 2800, epoch: 5 | loss: 1.0825320
	speed: 0.1302s/iter; left time: 6946.4228s
	iters: 2900, epoch: 5 | loss: 1.0434775
	speed: 0.1304s/iter; left time: 6942.1998s
	iters: 3000, epoch: 5 | loss: 1.0606476
	speed: 0.1303s/iter; left time: 6927.5801s
	iters: 3100, epoch: 5 | loss: 1.0772715
	speed: 0.1316s/iter; left time: 6980.2343s
	iters: 3200, epoch: 5 | loss: 1.0866288
	speed: 0.1323s/iter; left time: 7007.9569s
	iters: 3300, epoch: 5 | loss: 1.0670773
	speed: 0.1331s/iter; left time: 7037.2854s
	iters: 3400, epoch: 5 | loss: 1.0887057
	speed: 0.1315s/iter; left time: 6934.9978s
	iters: 3500, epoch: 5 | loss: 1.0744603
	speed: 0.1303s/iter; left time: 6860.7501s
	iters: 3600, epoch: 5 | loss: 1.0894706
	speed: 0.1302s/iter; left time: 6842.7766s
	iters: 3700, epoch: 5 | loss: 1.0644149
	speed: 0.1303s/iter; left time: 6833.0059s
	iters: 3800, epoch: 5 | loss: 1.0653824
	speed: 0.1308s/iter; left time: 6848.2162s
	iters: 3900, epoch: 5 | loss: 1.1234424
	speed: 0.1303s/iter; left time: 6808.9020s
	iters: 4000, epoch: 5 | loss: 1.1157674
	speed: 0.1344s/iter; left time: 7007.6747s
	iters: 4100, epoch: 5 | loss: 1.1144681
	speed: 0.1349s/iter; left time: 7021.9657s
	iters: 4200, epoch: 5 | loss: 0.9882986
	speed: 0.1319s/iter; left time: 6855.2207s
	iters: 4300, epoch: 5 | loss: 1.0218916
	speed: 0.1319s/iter; left time: 6838.4071s
	iters: 4400, epoch: 5 | loss: 1.0414603
	speed: 0.1311s/iter; left time: 6783.0010s
	iters: 4500, epoch: 5 | loss: 1.0090845
	speed: 0.1315s/iter; left time: 6791.5489s
	iters: 4600, epoch: 5 | loss: 1.0259470
	speed: 0.1327s/iter; left time: 6843.5419s
	iters: 4700, epoch: 5 | loss: 1.0778244
	speed: 0.1360s/iter; left time: 6996.7555s
	iters: 4800, epoch: 5 | loss: 1.0974970
	speed: 0.1338s/iter; left time: 6871.2800s
	iters: 4900, epoch: 5 | loss: 1.0109967
	speed: 0.1323s/iter; left time: 6778.9235s
	iters: 5000, epoch: 5 | loss: 1.0173297
	speed: 0.1318s/iter; left time: 6741.0816s
	iters: 5100, epoch: 5 | loss: 1.0163454
	speed: 0.1317s/iter; left time: 6723.5621s
	iters: 5200, epoch: 5 | loss: 1.1025678
	speed: 0.1310s/iter; left time: 6675.7052s
	iters: 5300, epoch: 5 | loss: 1.0509274
	speed: 0.1304s/iter; left time: 6629.2277s
	iters: 5400, epoch: 5 | loss: 1.0334376
	speed: 0.1320s/iter; left time: 6699.4957s
	iters: 5500, epoch: 5 | loss: 1.2003070
	speed: 0.1351s/iter; left time: 6841.7632s
	iters: 5600, epoch: 5 | loss: 1.0627677
	speed: 0.1335s/iter; left time: 6746.7081s
	iters: 5700, epoch: 5 | loss: 1.1288360
	speed: 0.1318s/iter; left time: 6649.8296s
	iters: 5800, epoch: 5 | loss: 1.1180538
	speed: 0.1317s/iter; left time: 6629.3135s
	iters: 5900, epoch: 5 | loss: 1.0943909
	speed: 0.1314s/iter; left time: 6603.8759s
	iters: 6000, epoch: 5 | loss: 1.0315678
	speed: 0.1313s/iter; left time: 6586.6081s
	iters: 6100, epoch: 5 | loss: 1.0577369
	speed: 0.1314s/iter; left time: 6579.5044s
	iters: 6200, epoch: 5 | loss: 1.0409052
	speed: 0.1326s/iter; left time: 6624.5458s
	iters: 6300, epoch: 5 | loss: 1.0974358
	speed: 0.1314s/iter; left time: 6551.3336s
	iters: 6400, epoch: 5 | loss: 1.1005971
	speed: 0.1315s/iter; left time: 6542.3610s
	iters: 6500, epoch: 5 | loss: 1.0852987
	speed: 0.1315s/iter; left time: 6531.9837s
	iters: 6600, epoch: 5 | loss: 1.0624682
	speed: 0.1306s/iter; left time: 6470.7997s
	iters: 6700, epoch: 5 | loss: 1.0371447
	speed: 0.1302s/iter; left time: 6438.1235s
	iters: 6800, epoch: 5 | loss: 1.0766994
	speed: 0.1299s/iter; left time: 6408.9156s
	iters: 6900, epoch: 5 | loss: 1.0412596
	speed: 0.1297s/iter; left time: 6388.0698s
	iters: 7000, epoch: 5 | loss: 1.0550568
	speed: 0.1299s/iter; left time: 6384.2864s
	iters: 7100, epoch: 5 | loss: 1.1445727
	speed: 0.1321s/iter; left time: 6479.9683s
	iters: 7200, epoch: 5 | loss: 1.0367668
	speed: 0.1314s/iter; left time: 6434.0403s
	iters: 7300, epoch: 5 | loss: 1.0244544
	speed: 0.1314s/iter; left time: 6418.2822s
	iters: 7400, epoch: 5 | loss: 1.1265997
	speed: 0.1308s/iter; left time: 6377.2030s
	iters: 7500, epoch: 5 | loss: 1.1382482
	speed: 0.1302s/iter; left time: 6334.1041s
	iters: 7600, epoch: 5 | loss: 1.1286234
	speed: 0.1307s/iter; left time: 6348.0941s
	iters: 7700, epoch: 5 | loss: 1.0287210
	speed: 0.1317s/iter; left time: 6380.1055s
	iters: 7800, epoch: 5 | loss: 1.1240205
	speed: 0.1311s/iter; left time: 6339.5232s
	iters: 7900, epoch: 5 | loss: 1.0958320
	speed: 0.1328s/iter; left time: 6405.9986s
	iters: 8000, epoch: 5 | loss: 1.0972403
	speed: 0.1314s/iter; left time: 6326.0195s
	iters: 8100, epoch: 5 | loss: 1.0444440
	speed: 0.1310s/iter; left time: 6294.8492s
	iters: 8200, epoch: 5 | loss: 1.1193154
	speed: 0.1301s/iter; left time: 6241.1430s
	iters: 8300, epoch: 5 | loss: 1.1086555
	speed: 0.1302s/iter; left time: 6229.6899s
	iters: 8400, epoch: 5 | loss: 1.0669123
	speed: 0.1307s/iter; left time: 6241.2177s
	iters: 8500, epoch: 5 | loss: 0.9673740
	speed: 0.1311s/iter; left time: 6249.7326s
	iters: 8600, epoch: 5 | loss: 1.0386726
	speed: 0.1313s/iter; left time: 6244.1525s
	iters: 8700, epoch: 5 | loss: 0.9878629
	speed: 0.1314s/iter; left time: 6235.5585s
	iters: 8800, epoch: 5 | loss: 1.0934446
	speed: 0.1311s/iter; left time: 6210.0959s
	iters: 8900, epoch: 5 | loss: 1.0546267
	speed: 0.1313s/iter; left time: 6205.9859s
	iters: 9000, epoch: 5 | loss: 1.0712862
	speed: 0.1305s/iter; left time: 6152.7893s
	iters: 9100, epoch: 5 | loss: 1.0931776
	speed: 0.1303s/iter; left time: 6130.4558s
	iters: 9200, epoch: 5 | loss: 1.0816395
	speed: 0.1302s/iter; left time: 6113.2994s
	iters: 9300, epoch: 5 | loss: 1.1005162
	speed: 0.1303s/iter; left time: 6103.1911s
Epoch: 5 cost time: 1233.137059211731
Epoch: 5, Steps: 9359 | Train Loss: 1.0897502 Vali Loss: 1.0903643 Test Loss: 0.9710050
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_720_336_iTransformer_custom_ftM_sl720_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 352763
test shape: (35276, 1, 336, 822) (35276, 1, 336, 822)
test shape: (35276, 336, 822) (35276, 336, 822)
