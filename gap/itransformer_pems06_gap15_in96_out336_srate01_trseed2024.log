Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 742854
val 142212
test 142210
	iters: 100, epoch: 1 | loss: 1.7860513
	speed: 0.0335s/iter; left time: 1551.0019s
	iters: 200, epoch: 1 | loss: 1.4370667
	speed: 0.0304s/iter; left time: 1404.1784s
	iters: 300, epoch: 1 | loss: 1.8570222
	speed: 0.0304s/iter; left time: 1402.5094s
	iters: 400, epoch: 1 | loss: 1.4139339
	speed: 0.0304s/iter; left time: 1399.2725s
	iters: 500, epoch: 1 | loss: 1.3714844
	speed: 0.0304s/iter; left time: 1395.7310s
	iters: 600, epoch: 1 | loss: 1.4085951
	speed: 0.0304s/iter; left time: 1393.3890s
	iters: 700, epoch: 1 | loss: 1.6387839
	speed: 0.0304s/iter; left time: 1390.3208s
	iters: 800, epoch: 1 | loss: 1.6281272
	speed: 0.0304s/iter; left time: 1387.5619s
	iters: 900, epoch: 1 | loss: 1.3567884
	speed: 0.0305s/iter; left time: 1390.2307s
	iters: 1000, epoch: 1 | loss: 1.6014574
	speed: 0.0303s/iter; left time: 1377.9951s
	iters: 1100, epoch: 1 | loss: 1.6850063
	speed: 0.0304s/iter; left time: 1378.2753s
	iters: 1200, epoch: 1 | loss: 2.0671854
	speed: 0.0306s/iter; left time: 1383.4055s
	iters: 1300, epoch: 1 | loss: 1.7964553
	speed: 0.0304s/iter; left time: 1370.8114s
	iters: 1400, epoch: 1 | loss: 1.8796246
	speed: 0.0304s/iter; left time: 1369.0320s
	iters: 1500, epoch: 1 | loss: 1.6560605
	speed: 0.0304s/iter; left time: 1365.0444s
	iters: 1600, epoch: 1 | loss: 1.4413878
	speed: 0.0304s/iter; left time: 1363.0993s
	iters: 1700, epoch: 1 | loss: 1.7935046
	speed: 0.0304s/iter; left time: 1358.6716s
	iters: 1800, epoch: 1 | loss: 1.2589365
	speed: 0.0304s/iter; left time: 1356.8633s
	iters: 1900, epoch: 1 | loss: 1.7538269
	speed: 0.0305s/iter; left time: 1356.3019s
	iters: 2000, epoch: 1 | loss: 1.4366795
	speed: 0.0307s/iter; left time: 1364.2715s
	iters: 2100, epoch: 1 | loss: 1.5625077
	speed: 0.0304s/iter; left time: 1348.4962s
	iters: 2200, epoch: 1 | loss: 1.5007126
	speed: 0.0304s/iter; left time: 1344.7746s
	iters: 2300, epoch: 1 | loss: 1.8239398
	speed: 0.0304s/iter; left time: 1340.1866s
	iters: 2400, epoch: 1 | loss: 1.4709798
	speed: 0.0305s/iter; left time: 1343.9682s
	iters: 2500, epoch: 1 | loss: 2.0322857
	speed: 0.0306s/iter; left time: 1342.1300s
	iters: 2600, epoch: 1 | loss: 1.3830352
	speed: 0.0304s/iter; left time: 1331.1461s
	iters: 2700, epoch: 1 | loss: 1.7936935
	speed: 0.0304s/iter; left time: 1327.9339s
	iters: 2800, epoch: 1 | loss: 1.5021361
	speed: 0.0304s/iter; left time: 1325.4075s
	iters: 2900, epoch: 1 | loss: 1.7598767
	speed: 0.0304s/iter; left time: 1323.6280s
	iters: 3000, epoch: 1 | loss: 1.5770118
	speed: 0.0304s/iter; left time: 1319.2450s
	iters: 3100, epoch: 1 | loss: 1.8792603
	speed: 0.0304s/iter; left time: 1316.6034s
	iters: 3200, epoch: 1 | loss: 1.6427246
	speed: 0.0304s/iter; left time: 1315.4857s
	iters: 3300, epoch: 1 | loss: 1.6172149
	speed: 0.0305s/iter; left time: 1314.5710s
	iters: 3400, epoch: 1 | loss: 1.4063547
	speed: 0.0305s/iter; left time: 1311.7666s
	iters: 3500, epoch: 1 | loss: 1.2502767
	speed: 0.0304s/iter; left time: 1305.8302s
	iters: 3600, epoch: 1 | loss: 1.2454014
	speed: 0.0304s/iter; left time: 1300.5514s
	iters: 3700, epoch: 1 | loss: 1.2278239
	speed: 0.0304s/iter; left time: 1300.5427s
	iters: 3800, epoch: 1 | loss: 1.5258777
	speed: 0.0304s/iter; left time: 1295.6019s
	iters: 3900, epoch: 1 | loss: 1.6179925
	speed: 0.0304s/iter; left time: 1292.2722s
	iters: 4000, epoch: 1 | loss: 1.4675343
	speed: 0.0304s/iter; left time: 1289.8236s
	iters: 4100, epoch: 1 | loss: 1.7094752
	speed: 0.0304s/iter; left time: 1287.8312s
	iters: 4200, epoch: 1 | loss: 1.4080257
	speed: 0.0304s/iter; left time: 1282.6422s
	iters: 4300, epoch: 1 | loss: 1.6217310
	speed: 0.0304s/iter; left time: 1281.2519s
	iters: 4400, epoch: 1 | loss: 1.5571300
	speed: 0.0304s/iter; left time: 1278.5999s
	iters: 4500, epoch: 1 | loss: 1.4567248
	speed: 0.0304s/iter; left time: 1275.0035s
	iters: 4600, epoch: 1 | loss: 1.6850944
	speed: 0.0304s/iter; left time: 1269.6173s
Epoch: 1 cost time: 141.61342525482178
Epoch: 1, Steps: 4642 | Train Loss: 1.5565750 Vali Loss: 1.3198795 Test Loss: 1.4999650
Validation loss decreased (inf --> 1.319880).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.5625982
	speed: 0.7450s/iter; left time: 31050.8897s
	iters: 200, epoch: 2 | loss: 1.5870883
	speed: 0.0304s/iter; left time: 1262.0059s
	iters: 300, epoch: 2 | loss: 1.3779848
	speed: 0.0304s/iter; left time: 1260.5735s
	iters: 400, epoch: 2 | loss: 1.4163561
	speed: 0.0304s/iter; left time: 1259.6285s
	iters: 500, epoch: 2 | loss: 1.5413408
	speed: 0.0304s/iter; left time: 1254.6260s
	iters: 600, epoch: 2 | loss: 1.3747698
	speed: 0.0304s/iter; left time: 1251.3572s
	iters: 700, epoch: 2 | loss: 1.5169661
	speed: 0.0304s/iter; left time: 1249.7059s
	iters: 800, epoch: 2 | loss: 1.7883832
	speed: 0.0304s/iter; left time: 1244.9270s
	iters: 900, epoch: 2 | loss: 1.5189936
	speed: 0.0304s/iter; left time: 1242.9443s
	iters: 1000, epoch: 2 | loss: 1.5725082
	speed: 0.0305s/iter; left time: 1244.8584s
	iters: 1100, epoch: 2 | loss: 1.4551243
	speed: 0.0304s/iter; left time: 1236.3610s
	iters: 1200, epoch: 2 | loss: 1.5350889
	speed: 0.0304s/iter; left time: 1234.2302s
	iters: 1300, epoch: 2 | loss: 1.5506096
	speed: 0.0305s/iter; left time: 1234.3864s
	iters: 1400, epoch: 2 | loss: 1.3433365
	speed: 0.0305s/iter; left time: 1232.0770s
	iters: 1500, epoch: 2 | loss: 1.4300812
	speed: 0.0305s/iter; left time: 1228.3117s
	iters: 1600, epoch: 2 | loss: 1.4248874
	speed: 0.0304s/iter; left time: 1220.8341s
	iters: 1700, epoch: 2 | loss: 1.6714073
	speed: 0.0304s/iter; left time: 1218.2975s
	iters: 1800, epoch: 2 | loss: 1.2262162
	speed: 0.0304s/iter; left time: 1215.5602s
	iters: 1900, epoch: 2 | loss: 1.4579966
	speed: 0.0304s/iter; left time: 1213.3217s
	iters: 2000, epoch: 2 | loss: 1.3557453
	speed: 0.0304s/iter; left time: 1209.7274s
	iters: 2100, epoch: 2 | loss: 1.5748577
	speed: 0.0304s/iter; left time: 1206.8260s
	iters: 2200, epoch: 2 | loss: 1.6210598
	speed: 0.0305s/iter; left time: 1207.0215s
	iters: 2300, epoch: 2 | loss: 1.9002408
	speed: 0.0304s/iter; left time: 1200.2070s
	iters: 2400, epoch: 2 | loss: 1.1621813
	speed: 0.0305s/iter; left time: 1201.4297s
	iters: 2500, epoch: 2 | loss: 1.5847948
	speed: 0.0304s/iter; left time: 1193.5192s
	iters: 2600, epoch: 2 | loss: 1.5711814
	speed: 0.0304s/iter; left time: 1190.7728s
	iters: 2700, epoch: 2 | loss: 1.4289696
	speed: 0.0304s/iter; left time: 1187.8465s
	iters: 2800, epoch: 2 | loss: 1.6934839
	speed: 0.0304s/iter; left time: 1185.0146s
	iters: 2900, epoch: 2 | loss: 1.3261867
	speed: 0.0304s/iter; left time: 1182.0269s
	iters: 3000, epoch: 2 | loss: 1.2620020
	speed: 0.0304s/iter; left time: 1179.9328s
	iters: 3100, epoch: 2 | loss: 1.2571346
	speed: 0.0305s/iter; left time: 1179.7158s
	iters: 3200, epoch: 2 | loss: 1.7934097
	speed: 0.0304s/iter; left time: 1172.3648s
	iters: 3300, epoch: 2 | loss: 1.7640532
	speed: 0.0304s/iter; left time: 1170.0270s
	iters: 3400, epoch: 2 | loss: 1.4334096
	speed: 0.0304s/iter; left time: 1166.3509s
	iters: 3500, epoch: 2 | loss: 1.8757721
	speed: 0.0303s/iter; left time: 1161.2801s
	iters: 3600, epoch: 2 | loss: 1.0912555
	speed: 0.0304s/iter; left time: 1160.3478s
	iters: 3700, epoch: 2 | loss: 2.0787506
	speed: 0.0304s/iter; left time: 1159.2034s
	iters: 3800, epoch: 2 | loss: 1.8396313
	speed: 0.0304s/iter; left time: 1154.5148s
	iters: 3900, epoch: 2 | loss: 1.5564075
	speed: 0.0308s/iter; left time: 1165.5355s
	iters: 4000, epoch: 2 | loss: 1.3277695
	speed: 0.0304s/iter; left time: 1149.0979s
	iters: 4100, epoch: 2 | loss: 1.3050336
	speed: 0.0304s/iter; left time: 1144.5981s
	iters: 4200, epoch: 2 | loss: 1.3160015
	speed: 0.0304s/iter; left time: 1142.1823s
	iters: 4300, epoch: 2 | loss: 1.9038336
	speed: 0.0304s/iter; left time: 1139.4414s
	iters: 4400, epoch: 2 | loss: 1.4726890
	speed: 0.0305s/iter; left time: 1140.5085s
	iters: 4500, epoch: 2 | loss: 1.3466152
	speed: 0.0304s/iter; left time: 1132.2001s
	iters: 4600, epoch: 2 | loss: 1.6362947
	speed: 0.0304s/iter; left time: 1129.7224s
Epoch: 2 cost time: 141.34481239318848
Epoch: 2, Steps: 4642 | Train Loss: 1.5204175 Vali Loss: 1.4899608 Test Loss: 1.7119931
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.4704131
	speed: 0.7437s/iter; left time: 27543.8345s
	iters: 200, epoch: 3 | loss: 1.2749412
	speed: 0.0304s/iter; left time: 1122.9972s
	iters: 300, epoch: 3 | loss: 1.6980267
	speed: 0.0304s/iter; left time: 1119.6878s
	iters: 400, epoch: 3 | loss: 1.2702180
	speed: 0.0304s/iter; left time: 1116.7851s
	iters: 500, epoch: 3 | loss: 1.1650029
	speed: 0.0304s/iter; left time: 1114.7549s
	iters: 600, epoch: 3 | loss: 1.5407510
	speed: 0.0304s/iter; left time: 1109.7035s
	iters: 700, epoch: 3 | loss: 1.1960037
	speed: 0.0304s/iter; left time: 1108.1662s
	iters: 800, epoch: 3 | loss: 1.4897493
	speed: 0.0304s/iter; left time: 1104.4300s
	iters: 900, epoch: 3 | loss: 1.3165872
	speed: 0.0304s/iter; left time: 1100.7997s
	iters: 1000, epoch: 3 | loss: 1.5763123
	speed: 0.0304s/iter; left time: 1098.7475s
	iters: 1100, epoch: 3 | loss: 1.4781998
	speed: 0.0304s/iter; left time: 1095.8236s
	iters: 1200, epoch: 3 | loss: 1.7415240
	speed: 0.0304s/iter; left time: 1091.3469s
	iters: 1300, epoch: 3 | loss: 1.6292086
	speed: 0.0304s/iter; left time: 1089.4680s
	iters: 1400, epoch: 3 | loss: 1.4653409
	speed: 0.0304s/iter; left time: 1086.3891s
	iters: 1500, epoch: 3 | loss: 1.4677300
	speed: 0.0305s/iter; left time: 1085.5052s
	iters: 1600, epoch: 3 | loss: 1.5250809
	speed: 0.0304s/iter; left time: 1080.3439s
	iters: 1700, epoch: 3 | loss: 1.5810812
	speed: 0.0304s/iter; left time: 1078.3190s
	iters: 1800, epoch: 3 | loss: 1.5664058
	speed: 0.0304s/iter; left time: 1073.2500s
	iters: 1900, epoch: 3 | loss: 1.3186222
	speed: 0.0304s/iter; left time: 1071.3287s
	iters: 2000, epoch: 3 | loss: 1.4911575
	speed: 0.0303s/iter; left time: 1066.0978s
	iters: 2100, epoch: 3 | loss: 1.4612052
	speed: 0.0305s/iter; left time: 1068.9942s
	iters: 2200, epoch: 3 | loss: 1.5308590
	speed: 0.0304s/iter; left time: 1062.1052s
	iters: 2300, epoch: 3 | loss: 1.6991000
	speed: 0.0305s/iter; left time: 1061.9620s
	iters: 2400, epoch: 3 | loss: 1.2154045
	speed: 0.0305s/iter; left time: 1058.8272s
	iters: 2500, epoch: 3 | loss: 1.4581982
	speed: 0.0304s/iter; left time: 1052.4983s
	iters: 2600, epoch: 3 | loss: 1.6543570
	speed: 0.0303s/iter; left time: 1047.5280s
	iters: 2700, epoch: 3 | loss: 1.4867263
	speed: 0.0304s/iter; left time: 1046.8645s
	iters: 2800, epoch: 3 | loss: 1.5433322
	speed: 0.0304s/iter; left time: 1043.8208s
	iters: 2900, epoch: 3 | loss: 1.7784996
	speed: 0.0304s/iter; left time: 1040.6224s
	iters: 3000, epoch: 3 | loss: 1.4566504
	speed: 0.0304s/iter; left time: 1036.7037s
	iters: 3100, epoch: 3 | loss: 1.5658928
	speed: 0.0304s/iter; left time: 1033.5201s
	iters: 3200, epoch: 3 | loss: 1.7131640
	speed: 0.0304s/iter; left time: 1032.5281s
	iters: 3300, epoch: 3 | loss: 1.4176291
	speed: 0.0304s/iter; left time: 1028.3302s
	iters: 3400, epoch: 3 | loss: 1.4566814
	speed: 0.0304s/iter; left time: 1025.0449s
	iters: 3500, epoch: 3 | loss: 1.4432111
	speed: 0.0304s/iter; left time: 1021.2082s
	iters: 3600, epoch: 3 | loss: 1.5945295
	speed: 0.0304s/iter; left time: 1019.4236s
	iters: 3700, epoch: 3 | loss: 1.5881894
	speed: 0.0304s/iter; left time: 1017.2542s
	iters: 3800, epoch: 3 | loss: 1.5657586
	speed: 0.0303s/iter; left time: 1011.1548s
	iters: 3900, epoch: 3 | loss: 1.6414011
	speed: 0.0304s/iter; left time: 1009.9563s
	iters: 4000, epoch: 3 | loss: 1.6274786
	speed: 0.0305s/iter; left time: 1010.4915s
	iters: 4100, epoch: 3 | loss: 1.2375255
	speed: 0.0304s/iter; left time: 1003.9302s
	iters: 4200, epoch: 3 | loss: 1.5263261
	speed: 0.0304s/iter; left time: 999.7920s
	iters: 4300, epoch: 3 | loss: 1.4751871
	speed: 0.0304s/iter; left time: 998.0515s
	iters: 4400, epoch: 3 | loss: 1.5416946
	speed: 0.0304s/iter; left time: 994.3658s
	iters: 4500, epoch: 3 | loss: 1.6624043
	speed: 0.0304s/iter; left time: 991.6637s
	iters: 4600, epoch: 3 | loss: 1.3731083
	speed: 0.0303s/iter; left time: 987.1950s
Epoch: 3 cost time: 141.21869564056396
Epoch: 3, Steps: 4642 | Train Loss: 1.5208310 Vali Loss: 1.4907001 Test Loss: 1.7228502
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.4366648
	speed: 0.7450s/iter; left time: 24133.0795s
	iters: 200, epoch: 4 | loss: 1.1206956
	speed: 0.0304s/iter; left time: 982.0301s
	iters: 300, epoch: 4 | loss: 1.3431058
	speed: 0.0304s/iter; left time: 978.9189s
	iters: 400, epoch: 4 | loss: 1.4607769
	speed: 0.0304s/iter; left time: 974.3352s
	iters: 500, epoch: 4 | loss: 1.4305592
	speed: 0.0304s/iter; left time: 971.8178s
	iters: 600, epoch: 4 | loss: 1.4593437
	speed: 0.0304s/iter; left time: 968.1464s
	iters: 700, epoch: 4 | loss: 1.7252656
	speed: 0.0304s/iter; left time: 967.5838s
	iters: 800, epoch: 4 | loss: 1.4222118
	speed: 0.0304s/iter; left time: 962.6646s
	iters: 900, epoch: 4 | loss: 1.4434491
	speed: 0.0304s/iter; left time: 959.8268s
	iters: 1000, epoch: 4 | loss: 1.8230609
	speed: 0.0306s/iter; left time: 962.7258s
	iters: 1100, epoch: 4 | loss: 1.1720848
	speed: 0.0304s/iter; left time: 952.9085s
	iters: 1200, epoch: 4 | loss: 1.4674884
	speed: 0.0304s/iter; left time: 952.2911s
	iters: 1300, epoch: 4 | loss: 1.4136925
	speed: 0.0303s/iter; left time: 946.7502s
	iters: 1400, epoch: 4 | loss: 1.4204050
	speed: 0.0305s/iter; left time: 948.2648s
	iters: 1500, epoch: 4 | loss: 1.5147510
	speed: 0.0304s/iter; left time: 941.5107s
	iters: 1600, epoch: 4 | loss: 1.5396932
	speed: 0.0304s/iter; left time: 940.1524s
	iters: 1700, epoch: 4 | loss: 1.3771467
	speed: 0.0304s/iter; left time: 934.9051s
	iters: 1800, epoch: 4 | loss: 1.6855197
	speed: 0.0304s/iter; left time: 933.1889s
	iters: 1900, epoch: 4 | loss: 1.7198479
	speed: 0.0304s/iter; left time: 929.3994s
	iters: 2000, epoch: 4 | loss: 1.2891859
	speed: 0.0304s/iter; left time: 927.0532s
	iters: 2100, epoch: 4 | loss: 1.5398721
	speed: 0.0304s/iter; left time: 924.5577s
	iters: 2200, epoch: 4 | loss: 1.6177772
	speed: 0.0304s/iter; left time: 919.8323s
	iters: 2300, epoch: 4 | loss: 1.1797092
	speed: 0.0305s/iter; left time: 921.0779s
	iters: 2400, epoch: 4 | loss: 1.4993765
	speed: 0.0304s/iter; left time: 914.3608s
	iters: 2500, epoch: 4 | loss: 1.4710088
	speed: 0.0305s/iter; left time: 913.9230s
	iters: 2600, epoch: 4 | loss: 1.7689395
	speed: 0.0304s/iter; left time: 909.4847s
	iters: 2700, epoch: 4 | loss: 1.8253086
	speed: 0.0304s/iter; left time: 905.0146s
	iters: 2800, epoch: 4 | loss: 1.7795624
	speed: 0.0304s/iter; left time: 903.5010s
	iters: 2900, epoch: 4 | loss: 1.2833148
	speed: 0.0304s/iter; left time: 898.5621s
	iters: 3000, epoch: 4 | loss: 1.7842784
	speed: 0.0304s/iter; left time: 895.7701s
	iters: 3100, epoch: 4 | loss: 1.6052163
	speed: 0.0304s/iter; left time: 893.4308s
	iters: 3200, epoch: 4 | loss: 1.3565743
	speed: 0.0304s/iter; left time: 890.5647s
	iters: 3300, epoch: 4 | loss: 1.5974231
	speed: 0.0304s/iter; left time: 886.7494s
	iters: 3400, epoch: 4 | loss: 1.6170951
	speed: 0.0304s/iter; left time: 884.9819s
	iters: 3500, epoch: 4 | loss: 1.2820224
	speed: 0.0304s/iter; left time: 880.6986s
	iters: 3600, epoch: 4 | loss: 1.4005817
	speed: 0.0304s/iter; left time: 878.0624s
	iters: 3700, epoch: 4 | loss: 1.2211311
	speed: 0.0304s/iter; left time: 874.6464s
	iters: 3800, epoch: 4 | loss: 1.8077743
	speed: 0.0305s/iter; left time: 875.5337s
	iters: 3900, epoch: 4 | loss: 1.6655538
	speed: 0.0304s/iter; left time: 869.5192s
	iters: 4000, epoch: 4 | loss: 1.4288214
	speed: 0.0304s/iter; left time: 865.8374s
	iters: 4100, epoch: 4 | loss: 1.6815858
	speed: 0.0304s/iter; left time: 863.2819s
	iters: 4200, epoch: 4 | loss: 1.4770361
	speed: 0.0304s/iter; left time: 861.4534s
	iters: 4300, epoch: 4 | loss: 1.8771883
	speed: 0.0304s/iter; left time: 856.9041s
	iters: 4400, epoch: 4 | loss: 1.3404528
	speed: 0.0304s/iter; left time: 852.8924s
	iters: 4500, epoch: 4 | loss: 1.1995282
	speed: 0.0305s/iter; left time: 853.1264s
	iters: 4600, epoch: 4 | loss: 1.4628540
	speed: 0.0304s/iter; left time: 848.6270s
Epoch: 4 cost time: 141.24354672431946
Epoch: 4, Steps: 4642 | Train Loss: 1.5242481 Vali Loss: 1.4113318 Test Loss: 1.6320451
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 142210
test shape: (14221, 1, 336, 130) (14221, 1, 336, 130)
test shape: (14221, 336, 130) (14221, 336, 130)
mse:1.4999667406082153, mae:0.9612427353858948
>>>>>>>Overall time: 981 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
