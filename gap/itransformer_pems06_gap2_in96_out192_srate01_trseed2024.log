Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690582
val 89940
test 89938
	iters: 100, epoch: 1 | loss: 1.7527195
	speed: 0.0329s/iter; left time: 1417.9756s
	iters: 200, epoch: 1 | loss: 1.8768263
	speed: 0.0303s/iter; left time: 1303.8261s
	iters: 300, epoch: 1 | loss: 1.5657248
	speed: 0.0303s/iter; left time: 1300.7995s
	iters: 400, epoch: 1 | loss: 1.9208146
	speed: 0.0304s/iter; left time: 1298.2107s
	iters: 500, epoch: 1 | loss: 1.5314075
	speed: 0.0302s/iter; left time: 1288.9179s
	iters: 600, epoch: 1 | loss: 1.6330395
	speed: 0.0302s/iter; left time: 1284.7916s
	iters: 700, epoch: 1 | loss: 1.8735098
	speed: 0.0305s/iter; left time: 1293.0541s
	iters: 800, epoch: 1 | loss: 1.4605848
	speed: 0.0304s/iter; left time: 1289.4454s
	iters: 900, epoch: 1 | loss: 1.8999202
	speed: 0.0304s/iter; left time: 1284.0770s
	iters: 1000, epoch: 1 | loss: 1.7627611
	speed: 0.0303s/iter; left time: 1278.2376s
	iters: 1100, epoch: 1 | loss: 1.4762999
	speed: 0.0304s/iter; left time: 1277.4487s
	iters: 1200, epoch: 1 | loss: 2.2223647
	speed: 0.0301s/iter; left time: 1264.7217s
	iters: 1300, epoch: 1 | loss: 2.1527331
	speed: 0.0302s/iter; left time: 1264.6359s
	iters: 1400, epoch: 1 | loss: 1.7454098
	speed: 0.0296s/iter; left time: 1235.0245s
	iters: 1500, epoch: 1 | loss: 1.6737971
	speed: 0.0303s/iter; left time: 1261.1842s
	iters: 1600, epoch: 1 | loss: 1.9385026
	speed: 0.0303s/iter; left time: 1260.4811s
	iters: 1700, epoch: 1 | loss: 1.7805640
	speed: 0.0304s/iter; left time: 1258.5626s
	iters: 1800, epoch: 1 | loss: 1.8254578
	speed: 0.0303s/iter; left time: 1254.9248s
	iters: 1900, epoch: 1 | loss: 1.7342176
	speed: 0.0304s/iter; left time: 1253.7428s
	iters: 2000, epoch: 1 | loss: 1.3346515
	speed: 0.0300s/iter; left time: 1232.8999s
	iters: 2100, epoch: 1 | loss: 1.6566685
	speed: 0.0301s/iter; left time: 1234.0390s
	iters: 2200, epoch: 1 | loss: 1.7347056
	speed: 0.0302s/iter; left time: 1238.9320s
	iters: 2300, epoch: 1 | loss: 1.5527842
	speed: 0.0298s/iter; left time: 1215.8926s
	iters: 2400, epoch: 1 | loss: 1.7000821
	speed: 0.0303s/iter; left time: 1236.9581s
	iters: 2500, epoch: 1 | loss: 2.0630524
	speed: 0.0303s/iter; left time: 1233.7295s
	iters: 2600, epoch: 1 | loss: 2.1805246
	speed: 0.0303s/iter; left time: 1230.0936s
	iters: 2700, epoch: 1 | loss: 1.5348554
	speed: 0.0300s/iter; left time: 1215.6018s
	iters: 2800, epoch: 1 | loss: 1.7809975
	speed: 0.0301s/iter; left time: 1216.0787s
	iters: 2900, epoch: 1 | loss: 1.7379539
	speed: 0.0303s/iter; left time: 1219.1677s
	iters: 3000, epoch: 1 | loss: 2.1999686
	speed: 0.0303s/iter; left time: 1215.7859s
	iters: 3100, epoch: 1 | loss: 1.6093462
	speed: 0.0304s/iter; left time: 1217.0048s
	iters: 3200, epoch: 1 | loss: 1.3259212
	speed: 0.0301s/iter; left time: 1204.1129s
	iters: 3300, epoch: 1 | loss: 1.7955807
	speed: 0.0302s/iter; left time: 1204.8052s
	iters: 3400, epoch: 1 | loss: 1.7053342
	speed: 0.0300s/iter; left time: 1193.9890s
	iters: 3500, epoch: 1 | loss: 2.0606639
	speed: 0.0303s/iter; left time: 1200.6709s
	iters: 3600, epoch: 1 | loss: 1.6724923
	speed: 0.0303s/iter; left time: 1197.5039s
	iters: 3700, epoch: 1 | loss: 1.6233793
	speed: 0.0303s/iter; left time: 1193.9898s
	iters: 3800, epoch: 1 | loss: 1.8032095
	speed: 0.0301s/iter; left time: 1183.2483s
	iters: 3900, epoch: 1 | loss: 1.8153598
	speed: 0.0301s/iter; left time: 1182.3596s
	iters: 4000, epoch: 1 | loss: 1.7308557
	speed: 0.0302s/iter; left time: 1181.2564s
	iters: 4100, epoch: 1 | loss: 1.5363271
	speed: 0.0302s/iter; left time: 1179.1865s
	iters: 4200, epoch: 1 | loss: 1.8686031
	speed: 0.0301s/iter; left time: 1171.1128s
	iters: 4300, epoch: 1 | loss: 1.7403568
	speed: 0.0303s/iter; left time: 1179.3175s
Epoch: 1 cost time: 130.7868857383728
Epoch: 1, Steps: 4316 | Train Loss: 1.7533618 Vali Loss: 1.0485077 Test Loss: 1.3352066
Validation loss decreased (inf --> 1.048508).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6628300
	speed: 0.4489s/iter; left time: 17393.2059s
	iters: 200, epoch: 2 | loss: 2.0922039
	speed: 0.0304s/iter; left time: 1173.8086s
	iters: 300, epoch: 2 | loss: 1.7514137
	speed: 0.0299s/iter; left time: 1153.8197s
	iters: 400, epoch: 2 | loss: 1.6237767
	speed: 0.0305s/iter; left time: 1173.1774s
	iters: 500, epoch: 2 | loss: 1.5119278
	speed: 0.0304s/iter; left time: 1164.8283s
	iters: 600, epoch: 2 | loss: 1.8670571
	speed: 0.0298s/iter; left time: 1140.7703s
	iters: 700, epoch: 2 | loss: 1.7368472
	speed: 0.0304s/iter; left time: 1158.3068s
	iters: 800, epoch: 2 | loss: 1.9677802
	speed: 0.0302s/iter; left time: 1148.3146s
	iters: 900, epoch: 2 | loss: 1.6202631
	speed: 0.0302s/iter; left time: 1144.0824s
	iters: 1000, epoch: 2 | loss: 1.9554495
	speed: 0.0304s/iter; left time: 1151.4090s
	iters: 1100, epoch: 2 | loss: 1.7215004
	speed: 0.0302s/iter; left time: 1139.1271s
	iters: 1200, epoch: 2 | loss: 1.4928061
	speed: 0.0305s/iter; left time: 1148.1674s
	iters: 1300, epoch: 2 | loss: 1.8236986
	speed: 0.0303s/iter; left time: 1138.9453s
	iters: 1400, epoch: 2 | loss: 1.7868569
	speed: 0.0303s/iter; left time: 1134.5216s
	iters: 1500, epoch: 2 | loss: 1.5434299
	speed: 0.0301s/iter; left time: 1124.6989s
	iters: 1600, epoch: 2 | loss: 1.6744977
	speed: 0.0304s/iter; left time: 1131.9133s
	iters: 1700, epoch: 2 | loss: 1.9922177
	speed: 0.0301s/iter; left time: 1116.3318s
	iters: 1800, epoch: 2 | loss: 1.5716652
	speed: 0.0302s/iter; left time: 1117.5610s
	iters: 1900, epoch: 2 | loss: 1.5409043
	speed: 0.0300s/iter; left time: 1107.4803s
	iters: 2000, epoch: 2 | loss: 1.6952922
	speed: 0.0299s/iter; left time: 1102.2434s
	iters: 2100, epoch: 2 | loss: 1.5981997
	speed: 0.0301s/iter; left time: 1104.2815s
	iters: 2200, epoch: 2 | loss: 1.7368689
	speed: 0.0304s/iter; left time: 1113.2039s
	iters: 2300, epoch: 2 | loss: 1.5797293
	speed: 0.0304s/iter; left time: 1109.5065s
	iters: 2400, epoch: 2 | loss: 1.7580714
	speed: 0.0303s/iter; left time: 1104.4816s
	iters: 2500, epoch: 2 | loss: 1.6095040
	speed: 0.0303s/iter; left time: 1103.0079s
	iters: 2600, epoch: 2 | loss: 1.6723937
	speed: 0.0299s/iter; left time: 1083.7975s
	iters: 2700, epoch: 2 | loss: 1.9956566
	speed: 0.0302s/iter; left time: 1092.3292s
	iters: 2800, epoch: 2 | loss: 1.5681491
	speed: 0.0301s/iter; left time: 1085.5842s
	iters: 2900, epoch: 2 | loss: 1.5683959
	speed: 0.0302s/iter; left time: 1086.6475s
	iters: 3000, epoch: 2 | loss: 1.7479520
	speed: 0.0298s/iter; left time: 1067.9163s
	iters: 3100, epoch: 2 | loss: 1.5531194
	speed: 0.0302s/iter; left time: 1078.0522s
	iters: 3200, epoch: 2 | loss: 1.5061491
	speed: 0.0302s/iter; left time: 1078.2264s
	iters: 3300, epoch: 2 | loss: 1.9229853
	speed: 0.0303s/iter; left time: 1075.3089s
	iters: 3400, epoch: 2 | loss: 1.7709185
	speed: 0.0302s/iter; left time: 1072.0735s
	iters: 3500, epoch: 2 | loss: 1.5124625
	speed: 0.0303s/iter; left time: 1070.5638s
	iters: 3600, epoch: 2 | loss: 1.6951207
	speed: 0.0302s/iter; left time: 1062.9166s
	iters: 3700, epoch: 2 | loss: 1.5834132
	speed: 0.0301s/iter; left time: 1059.1996s
	iters: 3800, epoch: 2 | loss: 1.7928274
	speed: 0.0302s/iter; left time: 1057.4854s
	iters: 3900, epoch: 2 | loss: 1.7490038
	speed: 0.0302s/iter; left time: 1053.6664s
	iters: 4000, epoch: 2 | loss: 1.7453551
	speed: 0.0303s/iter; left time: 1055.2707s
	iters: 4100, epoch: 2 | loss: 1.9345332
	speed: 0.0304s/iter; left time: 1055.1801s
	iters: 4200, epoch: 2 | loss: 2.1770196
	speed: 0.0301s/iter; left time: 1043.9692s
	iters: 4300, epoch: 2 | loss: 1.7700906
	speed: 0.0304s/iter; left time: 1049.9239s
Epoch: 2 cost time: 130.52465057373047
Epoch: 2, Steps: 4316 | Train Loss: 1.7709296 Vali Loss: 1.0468637 Test Loss: 1.3432707
Validation loss decreased (1.048508 --> 1.046864).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 2.1091840
	speed: 0.4483s/iter; left time: 15434.4493s
	iters: 200, epoch: 3 | loss: 1.8772748
	speed: 0.0305s/iter; left time: 1046.9100s
	iters: 300, epoch: 3 | loss: 1.8259672
	speed: 0.0302s/iter; left time: 1032.0408s
	iters: 400, epoch: 3 | loss: 1.7668091
	speed: 0.0301s/iter; left time: 1025.8972s
	iters: 500, epoch: 3 | loss: 1.9287531
	speed: 0.0303s/iter; left time: 1030.8207s
	iters: 600, epoch: 3 | loss: 2.0148244
	speed: 0.0302s/iter; left time: 1022.9755s
	iters: 700, epoch: 3 | loss: 1.9723537
	speed: 0.0303s/iter; left time: 1025.6592s
	iters: 800, epoch: 3 | loss: 1.6164620
	speed: 0.0304s/iter; left time: 1025.1195s
	iters: 900, epoch: 3 | loss: 1.5296620
	speed: 0.0304s/iter; left time: 1020.9210s
	iters: 1000, epoch: 3 | loss: 1.6592596
	speed: 0.0303s/iter; left time: 1014.5822s
	iters: 1100, epoch: 3 | loss: 2.1278527
	speed: 0.0304s/iter; left time: 1015.2018s
	iters: 1200, epoch: 3 | loss: 1.5672160
	speed: 0.0304s/iter; left time: 1012.1671s
	iters: 1300, epoch: 3 | loss: 1.9909897
	speed: 0.0304s/iter; left time: 1009.3829s
	iters: 1400, epoch: 3 | loss: 1.5412623
	speed: 0.0304s/iter; left time: 1006.4052s
	iters: 1500, epoch: 3 | loss: 2.0292273
	speed: 0.0303s/iter; left time: 999.8603s
	iters: 1600, epoch: 3 | loss: 2.0439024
	speed: 0.0304s/iter; left time: 1000.8835s
	iters: 1700, epoch: 3 | loss: 1.9321285
	speed: 0.0302s/iter; left time: 990.2252s
	iters: 1800, epoch: 3 | loss: 1.4733975
	speed: 0.0302s/iter; left time: 988.4245s
	iters: 1900, epoch: 3 | loss: 1.5757328
	speed: 0.0302s/iter; left time: 986.1457s
	iters: 2000, epoch: 3 | loss: 1.7066548
	speed: 0.0301s/iter; left time: 977.7254s
	iters: 2100, epoch: 3 | loss: 1.6613619
	speed: 0.0304s/iter; left time: 984.9704s
	iters: 2200, epoch: 3 | loss: 1.9175375
	speed: 0.0302s/iter; left time: 976.9623s
	iters: 2300, epoch: 3 | loss: 1.6229305
	speed: 0.0303s/iter; left time: 977.2507s
	iters: 2400, epoch: 3 | loss: 2.0593321
	speed: 0.0303s/iter; left time: 974.7283s
	iters: 2500, epoch: 3 | loss: 1.5656550
	speed: 0.0304s/iter; left time: 973.5529s
	iters: 2600, epoch: 3 | loss: 1.8921156
	speed: 0.0303s/iter; left time: 966.4057s
	iters: 2700, epoch: 3 | loss: 2.0674684
	speed: 0.0304s/iter; left time: 967.0416s
	iters: 2800, epoch: 3 | loss: 1.7190385
	speed: 0.0303s/iter; left time: 961.4236s
	iters: 2900, epoch: 3 | loss: 1.9509921
	speed: 0.0303s/iter; left time: 959.7805s
	iters: 3000, epoch: 3 | loss: 1.8828745
	speed: 0.0302s/iter; left time: 953.5266s
	iters: 3100, epoch: 3 | loss: 1.9678017
	speed: 0.0300s/iter; left time: 941.8257s
	iters: 3200, epoch: 3 | loss: 2.0219522
	speed: 0.0296s/iter; left time: 928.8552s
	iters: 3300, epoch: 3 | loss: 1.4188153
	speed: 0.0303s/iter; left time: 944.6960s
	iters: 3400, epoch: 3 | loss: 1.8262061
	speed: 0.0304s/iter; left time: 944.9771s
	iters: 3500, epoch: 3 | loss: 1.6216549
	speed: 0.0304s/iter; left time: 944.5790s
	iters: 3600, epoch: 3 | loss: 1.7327152
	speed: 0.0302s/iter; left time: 934.2157s
	iters: 3700, epoch: 3 | loss: 1.8909787
	speed: 0.0302s/iter; left time: 932.5035s
	iters: 3800, epoch: 3 | loss: 1.5655049
	speed: 0.0304s/iter; left time: 933.1544s
	iters: 3900, epoch: 3 | loss: 2.1147015
	speed: 0.0304s/iter; left time: 930.0306s
	iters: 4000, epoch: 3 | loss: 1.9822147
	speed: 0.0302s/iter; left time: 923.2593s
	iters: 4100, epoch: 3 | loss: 1.8753895
	speed: 0.0304s/iter; left time: 924.2325s
	iters: 4200, epoch: 3 | loss: 1.4844475
	speed: 0.0302s/iter; left time: 914.6333s
	iters: 4300, epoch: 3 | loss: 1.3962206
	speed: 0.0300s/iter; left time: 908.2012s
Epoch: 3 cost time: 130.72900223731995
Epoch: 3, Steps: 4316 | Train Loss: 1.7703790 Vali Loss: 1.0485576 Test Loss: 1.3346297
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 2.2729812
	speed: 0.4473s/iter; left time: 13469.3260s
	iters: 200, epoch: 4 | loss: 1.6402377
	speed: 0.0301s/iter; left time: 902.3596s
	iters: 300, epoch: 4 | loss: 1.8268940
	speed: 0.0302s/iter; left time: 904.6764s
	iters: 400, epoch: 4 | loss: 1.6226673
	speed: 0.0302s/iter; left time: 900.1529s
	iters: 500, epoch: 4 | loss: 1.5612108
	speed: 0.0299s/iter; left time: 889.3911s
	iters: 600, epoch: 4 | loss: 1.7996705
	speed: 0.0303s/iter; left time: 896.8234s
	iters: 700, epoch: 4 | loss: 1.7584578
	speed: 0.0304s/iter; left time: 896.5590s
	iters: 800, epoch: 4 | loss: 1.6071036
	speed: 0.0304s/iter; left time: 893.3426s
	iters: 900, epoch: 4 | loss: 1.5221981
	speed: 0.0298s/iter; left time: 873.2206s
	iters: 1000, epoch: 4 | loss: 1.6975962
	speed: 0.0296s/iter; left time: 865.6585s
	iters: 1100, epoch: 4 | loss: 1.4715791
	speed: 0.0302s/iter; left time: 877.9039s
	iters: 1200, epoch: 4 | loss: 1.7536916
	speed: 0.0303s/iter; left time: 878.4390s
	iters: 1300, epoch: 4 | loss: 1.6324153
	speed: 0.0303s/iter; left time: 874.7508s
	iters: 1400, epoch: 4 | loss: 1.4320022
	speed: 0.0303s/iter; left time: 871.6339s
	iters: 1500, epoch: 4 | loss: 1.5047681
	speed: 0.0303s/iter; left time: 869.1544s
	iters: 1600, epoch: 4 | loss: 1.5595315
	speed: 0.0304s/iter; left time: 869.5704s
	iters: 1700, epoch: 4 | loss: 1.5265745
	speed: 0.0304s/iter; left time: 866.0424s
	iters: 1800, epoch: 4 | loss: 1.9614521
	speed: 0.0301s/iter; left time: 856.4042s
	iters: 1900, epoch: 4 | loss: 1.5555602
	speed: 0.0303s/iter; left time: 859.2694s
	iters: 2000, epoch: 4 | loss: 2.1071200
	speed: 0.0304s/iter; left time: 857.9755s
	iters: 2100, epoch: 4 | loss: 1.9452364
	speed: 0.0302s/iter; left time: 847.8808s
	iters: 2200, epoch: 4 | loss: 2.2529454
	speed: 0.0304s/iter; left time: 851.0793s
	iters: 2300, epoch: 4 | loss: 2.0391691
	speed: 0.0304s/iter; left time: 847.5075s
	iters: 2400, epoch: 4 | loss: 1.4902467
	speed: 0.0301s/iter; left time: 838.0928s
	iters: 2500, epoch: 4 | loss: 2.1265070
	speed: 0.0304s/iter; left time: 841.2228s
	iters: 2600, epoch: 4 | loss: 1.5648471
	speed: 0.0303s/iter; left time: 838.0221s
	iters: 2700, epoch: 4 | loss: 1.5513395
	speed: 0.0305s/iter; left time: 838.8207s
	iters: 2800, epoch: 4 | loss: 1.7504230
	speed: 0.0298s/iter; left time: 817.6497s
	iters: 2900, epoch: 4 | loss: 1.7153287
	speed: 0.0303s/iter; left time: 827.6123s
	iters: 3000, epoch: 4 | loss: 1.9902047
	speed: 0.0302s/iter; left time: 822.7782s
	iters: 3100, epoch: 4 | loss: 1.6388391
	speed: 0.0300s/iter; left time: 814.6187s
	iters: 3200, epoch: 4 | loss: 1.9852626
	speed: 0.0304s/iter; left time: 820.2848s
	iters: 3300, epoch: 4 | loss: 2.5235093
	speed: 0.0302s/iter; left time: 813.2359s
	iters: 3400, epoch: 4 | loss: 1.7305630
	speed: 0.0302s/iter; left time: 809.2298s
	iters: 3500, epoch: 4 | loss: 1.8338376
	speed: 0.0304s/iter; left time: 811.0604s
	iters: 3600, epoch: 4 | loss: 1.7149385
	speed: 0.0304s/iter; left time: 808.0037s
	iters: 3700, epoch: 4 | loss: 1.7530826
	speed: 0.0300s/iter; left time: 795.1961s
	iters: 3800, epoch: 4 | loss: 2.5685279
	speed: 0.0303s/iter; left time: 800.6895s
	iters: 3900, epoch: 4 | loss: 1.4576248
	speed: 0.0301s/iter; left time: 791.0837s
	iters: 4000, epoch: 4 | loss: 1.5946803
	speed: 0.0303s/iter; left time: 793.6846s
	iters: 4100, epoch: 4 | loss: 1.8142596
	speed: 0.0304s/iter; left time: 792.6144s
	iters: 4200, epoch: 4 | loss: 2.0369191
	speed: 0.0302s/iter; left time: 784.2920s
	iters: 4300, epoch: 4 | loss: 1.7033440
	speed: 0.0302s/iter; left time: 781.6091s
Epoch: 4 cost time: 130.5697603225708
Epoch: 4, Steps: 4316 | Train Loss: 1.7701889 Vali Loss: 1.0478537 Test Loss: 1.3341626
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.6997099
	speed: 0.4508s/iter; left time: 11628.0631s
	iters: 200, epoch: 5 | loss: 1.8230354
	speed: 0.0301s/iter; left time: 774.0456s
	iters: 300, epoch: 5 | loss: 1.5774940
	speed: 0.0303s/iter; left time: 775.6069s
	iters: 400, epoch: 5 | loss: 1.8037298
	speed: 0.0299s/iter; left time: 762.6121s
	iters: 500, epoch: 5 | loss: 1.9368014
	speed: 0.0299s/iter; left time: 760.1552s
	iters: 600, epoch: 5 | loss: 1.9107680
	speed: 0.0299s/iter; left time: 756.3138s
	iters: 700, epoch: 5 | loss: 1.5011456
	speed: 0.0299s/iter; left time: 752.2634s
	iters: 800, epoch: 5 | loss: 1.6541476
	speed: 0.0299s/iter; left time: 750.0413s
	iters: 900, epoch: 5 | loss: 1.6322213
	speed: 0.0303s/iter; left time: 757.8202s
	iters: 1000, epoch: 5 | loss: 1.9140348
	speed: 0.0304s/iter; left time: 757.6553s
	iters: 1100, epoch: 5 | loss: 1.7704661
	speed: 0.0301s/iter; left time: 745.8020s
	iters: 1200, epoch: 5 | loss: 1.9676307
	speed: 0.0302s/iter; left time: 745.7368s
	iters: 1300, epoch: 5 | loss: 1.6383483
	speed: 0.0301s/iter; left time: 739.8764s
	iters: 1400, epoch: 5 | loss: 1.5008320
	speed: 0.0302s/iter; left time: 739.8670s
	iters: 1500, epoch: 5 | loss: 1.9100816
	speed: 0.0304s/iter; left time: 740.8224s
	iters: 1600, epoch: 5 | loss: 1.8647693
	speed: 0.0303s/iter; left time: 736.8232s
	iters: 1700, epoch: 5 | loss: 1.6926758
	speed: 0.0300s/iter; left time: 726.9409s
	iters: 1800, epoch: 5 | loss: 1.8419272
	speed: 0.0304s/iter; left time: 732.0806s
	iters: 1900, epoch: 5 | loss: 1.9831587
	speed: 0.0303s/iter; left time: 728.2694s
	iters: 2000, epoch: 5 | loss: 1.5037695
	speed: 0.0305s/iter; left time: 728.0712s
	iters: 2100, epoch: 5 | loss: 2.0899010
	speed: 0.0299s/iter; left time: 712.5452s
	iters: 2200, epoch: 5 | loss: 1.4944621
	speed: 0.0300s/iter; left time: 711.1979s
	iters: 2300, epoch: 5 | loss: 2.0826175
	speed: 0.0302s/iter; left time: 712.6176s
	iters: 2400, epoch: 5 | loss: 1.6686909
	speed: 0.0302s/iter; left time: 709.2083s
	iters: 2500, epoch: 5 | loss: 1.5716891
	speed: 0.0304s/iter; left time: 710.2508s
	iters: 2600, epoch: 5 | loss: 1.4329903
	speed: 0.0304s/iter; left time: 707.2464s
	iters: 2700, epoch: 5 | loss: 1.9460117
	speed: 0.0303s/iter; left time: 702.7790s
	iters: 2800, epoch: 5 | loss: 1.4225109
	speed: 0.0302s/iter; left time: 697.1076s
	iters: 2900, epoch: 5 | loss: 1.6858878
	speed: 0.0301s/iter; left time: 693.1443s
	iters: 3000, epoch: 5 | loss: 1.8506004
	speed: 0.0304s/iter; left time: 695.9316s
	iters: 3100, epoch: 5 | loss: 2.1599174
	speed: 0.0302s/iter; left time: 688.1156s
	iters: 3200, epoch: 5 | loss: 1.4753295
	speed: 0.0304s/iter; left time: 690.3904s
	iters: 3300, epoch: 5 | loss: 1.7681509
	speed: 0.0304s/iter; left time: 686.5398s
	iters: 3400, epoch: 5 | loss: 1.9520638
	speed: 0.0302s/iter; left time: 678.6959s
	iters: 3500, epoch: 5 | loss: 1.9293922
	speed: 0.0299s/iter; left time: 670.0088s
	iters: 3600, epoch: 5 | loss: 2.5554671
	speed: 0.0299s/iter; left time: 666.9184s
	iters: 3700, epoch: 5 | loss: 1.5247267
	speed: 0.0300s/iter; left time: 665.9981s
	iters: 3800, epoch: 5 | loss: 1.6922475
	speed: 0.0302s/iter; left time: 667.8363s
	iters: 3900, epoch: 5 | loss: 1.9575448
	speed: 0.0300s/iter; left time: 658.9868s
	iters: 4000, epoch: 5 | loss: 1.9490213
	speed: 0.0304s/iter; left time: 665.5531s
	iters: 4100, epoch: 5 | loss: 1.4200232
	speed: 0.0304s/iter; left time: 662.3070s
	iters: 4200, epoch: 5 | loss: 1.5913608
	speed: 0.0301s/iter; left time: 653.1518s
	iters: 4300, epoch: 5 | loss: 1.9151325
	speed: 0.0302s/iter; left time: 652.3041s
Epoch: 5 cost time: 130.36778903007507
Epoch: 5, Steps: 4316 | Train Loss: 1.7701435 Vali Loss: 1.0479362 Test Loss: 1.3359162
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 89938
test shape: (8993, 1, 192, 130) (8993, 1, 192, 130)
test shape: (8993, 192, 130) (8993, 192, 130)
mse:1.3432676792144775, mae:0.8790837526321411
>>>>>>>Overall time: 966 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
