Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=521, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems11_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1480318
val 121304
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=521, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems11_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1480318
val 121304
test 347822
	iters: 100, epoch: 1 | loss: 1.1503344
	speed: 0.1159s/iter; left time: 107198.5831s
	iters: 200, epoch: 1 | loss: 0.9847488
	speed: 0.1102s/iter; left time: 101912.0271s
	iters: 300, epoch: 1 | loss: 0.8561165
	speed: 0.1104s/iter; left time: 102120.5538s
	iters: 400, epoch: 1 | loss: 0.7307124
	speed: 0.1100s/iter; left time: 101675.5435s
	iters: 500, epoch: 1 | loss: 0.7665374
	speed: 0.1101s/iter; left time: 101773.8764s
	iters: 600, epoch: 1 | loss: 0.7268400
	speed: 0.1103s/iter; left time: 101988.4438s
	iters: 700, epoch: 1 | loss: 0.8007123
	speed: 0.1102s/iter; left time: 101849.2830s
	iters: 800, epoch: 1 | loss: 0.8475754
	speed: 0.1099s/iter; left time: 101540.1723s
	iters: 900, epoch: 1 | loss: 0.6836789
	speed: 0.1103s/iter; left time: 101921.3558s
	iters: 1000, epoch: 1 | loss: 0.7995810
	speed: 0.1100s/iter; left time: 101596.2330s
	iters: 1100, epoch: 1 | loss: 1.1651438
	speed: 0.1098s/iter; left time: 101426.9525s
	iters: 1200, epoch: 1 | loss: 0.9151303
	speed: 0.1101s/iter; left time: 101665.0918s
	iters: 1300, epoch: 1 | loss: 0.8250808
	speed: 0.1101s/iter; left time: 101720.8553s
	iters: 1400, epoch: 1 | loss: 0.9008328
	speed: 0.1105s/iter; left time: 102050.7689s
	iters: 1500, epoch: 1 | loss: 0.8729406
	speed: 0.1104s/iter; left time: 101939.7382s
	iters: 1600, epoch: 1 | loss: 0.8851364
	speed: 0.1098s/iter; left time: 101416.5048s
	iters: 1700, epoch: 1 | loss: 0.8010254
	speed: 0.1099s/iter; left time: 101461.8822s
	iters: 1800, epoch: 1 | loss: 0.7536573
	speed: 0.1098s/iter; left time: 101394.6754s
	iters: 1900, epoch: 1 | loss: 0.9555174
	speed: 0.1094s/iter; left time: 101001.1218s
	iters: 2000, epoch: 1 | loss: 0.7172794
	speed: 0.1096s/iter; left time: 101162.6418s
	iters: 2100, epoch: 1 | loss: 0.8240210
	speed: 0.1097s/iter; left time: 101279.2171s
	iters: 2200, epoch: 1 | loss: 0.6036265
	speed: 0.1100s/iter; left time: 101499.9849s
	iters: 2300, epoch: 1 | loss: 0.6878657
	speed: 0.1098s/iter; left time: 101316.3670s
	iters: 2400, epoch: 1 | loss: 0.7320781
	speed: 0.1100s/iter; left time: 101524.3708s
	iters: 2500, epoch: 1 | loss: 0.8473563
	speed: 0.1099s/iter; left time: 101385.3013s
	iters: 2600, epoch: 1 | loss: 0.6311072
	speed: 0.1093s/iter; left time: 100794.2962s
	iters: 2700, epoch: 1 | loss: 0.6628670
	speed: 0.1098s/iter; left time: 101312.4286s
	iters: 2800, epoch: 1 | loss: 0.6217921
	speed: 0.1096s/iter; left time: 101118.6441s
	iters: 2900, epoch: 1 | loss: 0.6939523
	speed: 0.1097s/iter; left time: 101123.3476s
	iters: 3000, epoch: 1 | loss: 0.6332873
	speed: 0.1095s/iter; left time: 100930.8870s
	iters: 3100, epoch: 1 | loss: 0.6820155
	speed: 0.1097s/iter; left time: 101176.2710s
	iters: 3200, epoch: 1 | loss: 0.6328017
	speed: 0.1091s/iter; left time: 100583.1467s
	iters: 3300, epoch: 1 | loss: 0.6887568
	speed: 0.1099s/iter; left time: 101263.7508s
	iters: 3400, epoch: 1 | loss: 0.6396489
	speed: 0.1097s/iter; left time: 101118.1134s
	iters: 3500, epoch: 1 | loss: 0.6461290
	speed: 0.1097s/iter; left time: 101078.8612s
	iters: 3600, epoch: 1 | loss: 0.5392289
	speed: 0.1096s/iter; left time: 101030.7270s
	iters: 3700, epoch: 1 | loss: 0.6742450
	speed: 0.1090s/iter; left time: 100433.9283s
	iters: 3800, epoch: 1 | loss: 0.6513774
	speed: 0.1094s/iter; left time: 100817.7244s
	iters: 3900, epoch: 1 | loss: 0.6568961
	speed: 0.1093s/iter; left time: 100711.2487s
	iters: 4000, epoch: 1 | loss: 0.6375169
	speed: 0.1095s/iter; left time: 100832.8842s
	iters: 4100, epoch: 1 | loss: 0.6037571
	speed: 0.1096s/iter; left time: 100916.9243s
	iters: 4200, epoch: 1 | loss: 0.6071918
	speed: 0.1095s/iter; left time: 100784.3603s
	iters: 4300, epoch: 1 | loss: 0.6393547
	speed: 0.1093s/iter; left time: 100601.0541s
	iters: 4400, epoch: 1 | loss: 0.6555402
	speed: 0.1088s/iter; left time: 100171.0869s
	iters: 4500, epoch: 1 | loss: 0.7096835
	speed: 0.1099s/iter; left time: 101178.9382s
	iters: 4600, epoch: 1 | loss: 0.5742616
	speed: 0.1120s/iter; left time: 103095.5443s
Epoch: 1 cost time: 508.8843092918396
Epoch: 1, Steps: 4625 | Train Loss: 0.7462630 Vali Loss: 0.9952113 Test Loss: 4.9300480
Validation loss decreased (inf --> 0.995211).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6398017
	speed: 4.5087s/iter; left time: 4149241.5063s
	iters: 200, epoch: 2 | loss: 0.5578499
	speed: 0.1099s/iter; left time: 101129.1349s
	iters: 300, epoch: 2 | loss: 0.6253638
	speed: 0.1097s/iter; left time: 100923.9029s
	iters: 400, epoch: 2 | loss: 0.5798990
	speed: 0.1101s/iter; left time: 101325.5332s
	iters: 500, epoch: 2 | loss: 0.6052490
	speed: 0.1096s/iter; left time: 100787.2364s
	iters: 600, epoch: 2 | loss: 0.5441168
	speed: 0.1098s/iter; left time: 101019.6278s
	iters: 700, epoch: 2 | loss: 0.5241781
	speed: 0.1117s/iter; left time: 102737.0192s
	iters: 800, epoch: 2 | loss: 0.5182863
	speed: 0.1134s/iter; left time: 104248.8332s
	iters: 900, epoch: 2 | loss: 0.5335345
	speed: 0.1140s/iter; left time: 104812.4321s
	iters: 1000, epoch: 2 | loss: 0.5318813
	speed: 0.1128s/iter; left time: 103660.1118s
	iters: 1100, epoch: 2 | loss: 0.5117376
	speed: 0.1139s/iter; left time: 104720.8597s
	iters: 1200, epoch: 2 | loss: 0.5389109
	speed: 0.1136s/iter; left time: 104400.0784s
	iters: 1300, epoch: 2 | loss: 0.5923092
	speed: 0.1137s/iter; left time: 104486.8861s
	iters: 1400, epoch: 2 | loss: 0.5452355
	speed: 0.1139s/iter; left time: 104674.1960s
	iters: 1500, epoch: 2 | loss: 0.5627042
	speed: 0.1137s/iter; left time: 104496.4823s
	iters: 1600, epoch: 2 | loss: 0.7050238
	speed: 0.1138s/iter; left time: 104566.7951s
	iters: 1700, epoch: 2 | loss: 0.5178745
	speed: 0.1135s/iter; left time: 104308.8942s
	iters: 1800, epoch: 2 | loss: 0.5327753
	speed: 0.1139s/iter; left time: 104656.9719s
	iters: 1900, epoch: 2 | loss: 0.5183699
	speed: 0.1131s/iter; left time: 103900.3792s
	iters: 2000, epoch: 2 | loss: 0.5594773
	speed: 0.1138s/iter; left time: 104541.6075s
	iters: 2100, epoch: 2 | loss: 0.6010057
	speed: 0.1135s/iter; left time: 104248.8895s
	iters: 2200, epoch: 2 | loss: 0.4856082
	speed: 0.1139s/iter; left time: 104600.5732s
	iters: 2300, epoch: 2 | loss: 0.4801790
	speed: 0.1138s/iter; left time: 104432.0446s
	iters: 2400, epoch: 2 | loss: 0.4910483
	speed: 0.1134s/iter; left time: 104108.9918s
	iters: 2500, epoch: 2 | loss: 0.4797061
	speed: 0.1136s/iter; left time: 104240.1956s
	iters: 2600, epoch: 2 | loss: 0.5160259
	speed: 0.1138s/iter; left time: 104472.4608s
	iters: 2700, epoch: 2 | loss: 0.5104536
	speed: 0.1139s/iter; left time: 104498.7512s
	iters: 2800, epoch: 2 | loss: 0.5847751
	speed: 0.1135s/iter; left time: 104132.9698s
	iters: 2900, epoch: 2 | loss: 0.5851570
	speed: 0.1134s/iter; left time: 104061.3464s
	iters: 3000, epoch: 2 | loss: 0.5146015
	speed: 0.1137s/iter; left time: 104265.0339s
	iters: 3100, epoch: 2 | loss: 0.4859122
	speed: 0.1137s/iter; left time: 104297.1910s
	iters: 3200, epoch: 2 | loss: 0.5496600
	speed: 0.1132s/iter; left time: 103784.6730s
	iters: 3300, epoch: 2 | loss: 0.5129563
	speed: 0.1135s/iter; left time: 104116.7768s
	iters: 3400, epoch: 2 | loss: 0.4941436
	speed: 0.1129s/iter; left time: 103544.0428s
	iters: 3500, epoch: 2 | loss: 0.4527861
	speed: 0.1132s/iter; left time: 103806.3554s
	iters: 3600, epoch: 2 | loss: 0.5809840
	speed: 0.1135s/iter; left time: 104014.4144s
	iters: 3700, epoch: 2 | loss: 0.5127580
	speed: 0.1127s/iter; left time: 103321.5300s
	iters: 3800, epoch: 2 | loss: 0.4349061
	speed: 0.1132s/iter; left time: 103793.5656s
	iters: 3900, epoch: 2 | loss: 0.5479623
	speed: 0.1131s/iter; left time: 103696.4281s
	iters: 4000, epoch: 2 | loss: 0.5265043
	speed: 0.1137s/iter; left time: 104180.7333s
	iters: 4100, epoch: 2 | loss: 0.5348315
	speed: 0.1136s/iter; left time: 104111.0561s
	iters: 4200, epoch: 2 | loss: 0.5126193
	speed: 0.1135s/iter; left time: 104012.3007s
	iters: 4300, epoch: 2 | loss: 0.5023782
	speed: 0.1139s/iter; left time: 104362.7782s
	iters: 4400, epoch: 2 | loss: 0.4440826
	speed: 0.1132s/iter; left time: 103713.8022s
	iters: 4500, epoch: 2 | loss: 0.5280342
	speed: 0.1136s/iter; left time: 104064.9492s
	iters: 4600, epoch: 2 | loss: 0.4970462
	speed: 0.1132s/iter; left time: 103628.9456s
Epoch: 2 cost time: 523.0411777496338
Epoch: 2, Steps: 4625 | Train Loss: 0.5360204 Vali Loss: 0.9444885 Test Loss: 4.8902369
Validation loss decreased (0.995211 --> 0.944488).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4606887
	speed: 4.4988s/iter; left time: 4119357.0675s
	iters: 200, epoch: 3 | loss: 0.4667504
	speed: 0.1100s/iter; left time: 100704.5220s
	iters: 300, epoch: 3 | loss: 0.5171309
	speed: 0.1101s/iter; left time: 100821.2728s
	iters: 400, epoch: 3 | loss: 0.5269223
	speed: 0.1099s/iter; left time: 100617.6809s
	iters: 500, epoch: 3 | loss: 0.4827639
	speed: 0.1097s/iter; left time: 100440.6156s
	iters: 600, epoch: 3 | loss: 0.5165327
	speed: 0.1100s/iter; left time: 100630.6590s
	iters: 700, epoch: 3 | loss: 0.4175787
	speed: 0.1099s/iter; left time: 100569.6704s
	iters: 800, epoch: 3 | loss: 0.4493630
	speed: 0.1095s/iter; left time: 100164.2345s
	iters: 900, epoch: 3 | loss: 0.5006671
	speed: 0.1096s/iter; left time: 100233.0525s
	iters: 1000, epoch: 3 | loss: 0.4780495
	speed: 0.1094s/iter; left time: 100047.9180s
	iters: 1100, epoch: 3 | loss: 0.4625064
	speed: 0.1098s/iter; left time: 100417.9422s
	iters: 1200, epoch: 3 | loss: 0.3836718
	speed: 0.1096s/iter; left time: 100271.1840s
	iters: 1300, epoch: 3 | loss: 0.4603760
	speed: 0.1103s/iter; left time: 100905.7312s
	iters: 1400, epoch: 3 | loss: 0.4312793
	speed: 0.1097s/iter; left time: 100275.4333s
	iters: 1500, epoch: 3 | loss: 0.4727333
	speed: 0.1092s/iter; left time: 99834.8824s
	iters: 1600, epoch: 3 | loss: 0.4257691
	speed: 0.1097s/iter; left time: 100300.5682s
	iters: 1700, epoch: 3 | loss: 0.4530311
	speed: 0.1094s/iter; left time: 99978.3314s
	iters: 1800, epoch: 3 | loss: 0.3985177
	speed: 0.1098s/iter; left time: 100338.3340s
	iters: 1900, epoch: 3 | loss: 0.4162168
	speed: 0.1096s/iter; left time: 100148.1303s
	iters: 2000, epoch: 3 | loss: 0.5039601
	speed: 0.1091s/iter; left time: 99700.8836s
	iters: 2100, epoch: 3 | loss: 0.4188976
	speed: 0.1093s/iter; left time: 99875.2185s
	iters: 2200, epoch: 3 | loss: 0.4405966
	speed: 0.1089s/iter; left time: 99512.0029s
	iters: 2300, epoch: 3 | loss: 0.4238057
	speed: 0.1094s/iter; left time: 99967.0975s
	iters: 2400, epoch: 3 | loss: 0.4947135
	speed: 0.1094s/iter; left time: 99945.5095s
	iters: 2500, epoch: 3 | loss: 0.4307360
	speed: 0.1094s/iter; left time: 99889.3321s
	iters: 2600, epoch: 3 | loss: 0.4123942
	speed: 0.1095s/iter; left time: 100005.8495s
	iters: 2700, epoch: 3 | loss: 0.4257771
	speed: 0.1093s/iter; left time: 99811.5629s
	iters: 2800, epoch: 3 | loss: 0.4566388
	speed: 0.1095s/iter; left time: 99951.8166s
	iters: 2900, epoch: 3 | loss: 0.4628308
	speed: 0.1092s/iter; left time: 99689.5522s
	iters: 3000, epoch: 3 | loss: 0.4919919
	speed: 0.1092s/iter; left time: 99709.4940s
	iters: 3100, epoch: 3 | loss: 0.4376785
	speed: 0.1095s/iter; left time: 99905.2136s
	iters: 3200, epoch: 3 | loss: 0.4882948
	speed: 0.1094s/iter; left time: 99790.1165s
	iters: 3300, epoch: 3 | loss: 0.4034280
	speed: 0.1093s/iter; left time: 99733.7208s
	iters: 3400, epoch: 3 | loss: 0.4276090
	speed: 0.1096s/iter; left time: 99991.7666s
	iters: 3500, epoch: 3 | loss: 0.4309608
	speed: 0.1087s/iter; left time: 99137.3969s
	iters: 3600, epoch: 3 | loss: 0.4377250
	speed: 0.1089s/iter; left time: 99374.0886s
	iters: 3700, epoch: 3 | loss: 0.4121596
	speed: 0.1088s/iter; left time: 99266.0201s
	iters: 3800, epoch: 3 | loss: 0.4006973
	speed: 0.1092s/iter; left time: 99604.0942s
	iters: 3900, epoch: 3 | loss: 0.3945961
	speed: 0.1091s/iter; left time: 99477.2816s
	iters: 4000, epoch: 3 | loss: 0.4176090
	speed: 0.1092s/iter; left time: 99544.9479s
	iters: 4100, epoch: 3 | loss: 0.4848441
	speed: 0.1094s/iter; left time: 99724.8955s
	iters: 4200, epoch: 3 | loss: 0.4309905
	speed: 0.1092s/iter; left time: 99529.2646s
	iters: 4300, epoch: 3 | loss: 0.4691540
	speed: 0.1092s/iter; left time: 99571.8099s
	iters: 4400, epoch: 3 | loss: 0.4051427
	speed: 0.1094s/iter; left time: 99670.4416s
	iters: 4500, epoch: 3 | loss: 0.4538340
	speed: 0.1089s/iter; left time: 99229.4253s
	iters: 4600, epoch: 3 | loss: 0.4357036
	speed: 0.1092s/iter; left time: 99538.3107s
Epoch: 3 cost time: 506.6051743030548
Epoch: 3, Steps: 4625 | Train Loss: 0.4473077 Vali Loss: 0.9615398 Test Loss: 4.8761926
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.4357739
	speed: 4.5142s/iter; left time: 4112543.6827s
	iters: 200, epoch: 4 | loss: 0.3749274
	speed: 0.1121s/iter; left time: 102091.3993s
	iters: 300, epoch: 4 | loss: 0.4069992
	speed: 0.1125s/iter; left time: 102480.5701s
	iters: 400, epoch: 4 | loss: 0.3609996
	speed: 0.1121s/iter; left time: 102052.2608s
	iters: 500, epoch: 4 | loss: 0.4206719
	speed: 0.1124s/iter; left time: 102350.1657s
	iters: 600, epoch: 4 | loss: 0.4003899
	speed: 0.1124s/iter; left time: 102302.2234s
	iters: 700, epoch: 4 | loss: 0.4091058
	speed: 0.1119s/iter; left time: 101905.3960s
	iters: 800, epoch: 4 | loss: 0.3815477
	speed: 0.1124s/iter; left time: 102322.7130s
	iters: 900, epoch: 4 | loss: 0.4214858
	speed: 0.1117s/iter; left time: 101686.9498s
	iters: 1000, epoch: 4 | loss: 0.3527467
	speed: 0.1104s/iter; left time: 100459.5114s
	iters: 1100, epoch: 4 | loss: 0.4286105
	speed: 0.1102s/iter; left time: 100246.0127s
	iters: 1200, epoch: 4 | loss: 0.4027780
	speed: 0.1104s/iter; left time: 100474.7692s
	iters: 1300, epoch: 4 | loss: 0.4111845
	speed: 0.1099s/iter; left time: 99962.9231s
	iters: 1400, epoch: 4 | loss: 0.3507359
	speed: 0.1102s/iter; left time: 100206.4305s
	iters: 1500, epoch: 4 | loss: 0.3620631
	speed: 0.1116s/iter; left time: 101544.4162s
	iters: 1600, epoch: 4 | loss: 0.3422880
	speed: 0.1101s/iter; left time: 100111.3119s
	iters: 1700, epoch: 4 | loss: 0.3575929
	speed: 0.1102s/iter; left time: 100253.2938s
	iters: 1800, epoch: 4 | loss: 0.4107445
	speed: 0.1103s/iter; left time: 100320.2595s
	iters: 1900, epoch: 4 | loss: 0.3775696
	speed: 0.1100s/iter; left time: 100017.6347s
	iters: 2000, epoch: 4 | loss: 0.4055089
	speed: 0.1096s/iter; left time: 99648.7868s
	iters: 2100, epoch: 4 | loss: 0.4312705
	speed: 0.1099s/iter; left time: 99865.9870s
	iters: 2200, epoch: 4 | loss: 0.3540422
	speed: 0.1100s/iter; left time: 99988.8292s
	iters: 2300, epoch: 4 | loss: 0.3460824
	speed: 0.1099s/iter; left time: 99866.1186s
	iters: 2400, epoch: 4 | loss: 0.4548668
	speed: 0.1098s/iter; left time: 99812.3078s
	iters: 2500, epoch: 4 | loss: 0.4421035
	speed: 0.1100s/iter; left time: 99938.6002s
	iters: 2600, epoch: 4 | loss: 0.3398589
	speed: 0.1102s/iter; left time: 100102.1951s
	iters: 2700, epoch: 4 | loss: 0.3792032
	speed: 0.1098s/iter; left time: 99759.2119s
	iters: 2800, epoch: 4 | loss: 0.3858695
	speed: 0.1099s/iter; left time: 99807.6744s
	iters: 2900, epoch: 4 | loss: 0.4494984
	speed: 0.1097s/iter; left time: 99592.4152s
	iters: 3000, epoch: 4 | loss: 0.4392647
	speed: 0.1096s/iter; left time: 99533.1172s
	iters: 3100, epoch: 4 | loss: 0.4061804
	speed: 0.1100s/iter; left time: 99924.7032s
	iters: 3200, epoch: 4 | loss: 0.4162509
	speed: 0.1100s/iter; left time: 99857.4282s
	iters: 3300, epoch: 4 | loss: 0.3935236
	speed: 0.1098s/iter; left time: 99684.1909s
	iters: 3400, epoch: 4 | loss: 0.3286251
	speed: 0.1100s/iter; left time: 99853.7880s
	iters: 3500, epoch: 4 | loss: 0.3414646
	speed: 0.1095s/iter; left time: 99428.3957s
	iters: 3600, epoch: 4 | loss: 0.3527139
	speed: 0.1099s/iter; left time: 99741.9239s
	iters: 3700, epoch: 4 | loss: 0.3595729
	speed: 0.1097s/iter; left time: 99572.4763s
	iters: 3800, epoch: 4 | loss: 0.3661910
	speed: 0.1096s/iter; left time: 99456.7487s
	iters: 3900, epoch: 4 | loss: 0.4039079
	speed: 0.1094s/iter; left time: 99236.4936s
	iters: 4000, epoch: 4 | loss: 0.3949922
	speed: 0.1097s/iter; left time: 99500.1863s
	iters: 4100, epoch: 4 | loss: 0.3370099
	speed: 0.1097s/iter; left time: 99478.7315s
	iters: 4200, epoch: 4 | loss: 0.3995183
	speed: 0.1100s/iter; left time: 99735.9862s
	iters: 4300, epoch: 4 | loss: 0.3763552
	speed: 0.1097s/iter; left time: 99461.7756s
	iters: 4400, epoch: 4 | loss: 0.3393141
	speed: 0.1093s/iter; left time: 99123.7763s
	iters: 4500, epoch: 4 | loss: 0.3532112
	speed: 0.1095s/iter; left time: 99241.0251s
	iters: 4600, epoch: 4 | loss: 0.3849734
	speed: 0.1090s/iter; left time: 98766.8893s
Epoch: 4 cost time: 510.72364687919617
Epoch: 4, Steps: 4625 | Train Loss: 0.3963663 Vali Loss: 0.9607438 Test Loss: 4.9077444
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.4300359
	speed: 4.5126s/iter; left time: 4090264.8441s
	iters: 200, epoch: 5 | loss: 0.3896329
	speed: 0.1138s/iter; left time: 103178.7905s
	iters: 300, epoch: 5 | loss: 0.3920977
	speed: 0.1135s/iter; left time: 102894.3921s
	iters: 400, epoch: 5 | loss: 0.3682590
	speed: 0.1129s/iter; left time: 102294.7433s
	iters: 500, epoch: 5 | loss: 0.2847753
	speed: 0.1137s/iter; left time: 103035.4816s
	iters: 600, epoch: 5 | loss: 0.3585812
	speed: 0.1134s/iter; left time: 102729.5074s
	iters: 700, epoch: 5 | loss: 0.3400491
	speed: 0.1137s/iter; left time: 103032.3608s
	iters: 800, epoch: 5 | loss: 0.3449712
	speed: 0.1133s/iter; left time: 102647.6976s
	iters: 900, epoch: 5 | loss: 0.3515905
	speed: 0.1137s/iter; left time: 102988.3267s
	iters: 1000, epoch: 5 | loss: 0.3489228
	speed: 0.1131s/iter; left time: 102455.5194s
	iters: 1100, epoch: 5 | loss: 0.3959383
	speed: 0.1132s/iter; left time: 102531.8413s
	iters: 1200, epoch: 5 | loss: 0.3508797
	speed: 0.1142s/iter; left time: 103381.5610s
	iters: 1300, epoch: 5 | loss: 0.3296437
	speed: 0.1137s/iter; left time: 102881.4330s
	iters: 1400, epoch: 5 | loss: 0.4020431
	speed: 0.1143s/iter; left time: 103448.8413s
	iters: 1500, epoch: 5 | loss: 0.3497019
	speed: 0.1133s/iter; left time: 102568.7902s
	iters: 1600, epoch: 5 | loss: 0.4050021
	speed: 0.1140s/iter; left time: 103129.0456s
	iters: 1700, epoch: 5 | loss: 0.3598488
	speed: 0.1135s/iter; left time: 102663.7884s
	iters: 1800, epoch: 5 | loss: 0.4016708
	speed: 0.1137s/iter; left time: 102858.4955s
	iters: 1900, epoch: 5 | loss: 0.3598478
	speed: 0.1138s/iter; left time: 102938.9924s
	iters: 2000, epoch: 5 | loss: 0.3605729
	speed: 0.1133s/iter; left time: 102485.6126s
	iters: 2100, epoch: 5 | loss: 0.3497683
	speed: 0.1141s/iter; left time: 103205.6207s
	iters: 2200, epoch: 5 | loss: 0.3718202
	speed: 0.1135s/iter; left time: 102599.7035s
	iters: 2300, epoch: 5 | loss: 0.4056876
	speed: 0.1135s/iter; left time: 102588.4095s
	iters: 2400, epoch: 5 | loss: 0.4168220
	speed: 0.1139s/iter; left time: 102959.7333s
	iters: 2500, epoch: 5 | loss: 0.3676999
	speed: 0.1132s/iter; left time: 102370.0615s
	iters: 2600, epoch: 5 | loss: 0.3490037
	speed: 0.1146s/iter; left time: 103561.9333s
	iters: 2700, epoch: 5 | loss: 0.3758766
	speed: 0.1138s/iter; left time: 102855.5544s
	iters: 2800, epoch: 5 | loss: 0.3366168
	speed: 0.1135s/iter; left time: 102575.5159s
	iters: 2900, epoch: 5 | loss: 0.3484027
	speed: 0.1134s/iter; left time: 102496.0921s
	iters: 3000, epoch: 5 | loss: 0.3784459
	speed: 0.1135s/iter; left time: 102503.8689s
	iters: 3100, epoch: 5 | loss: 0.3577683
	speed: 0.1132s/iter; left time: 102284.8707s
	iters: 3200, epoch: 5 | loss: 0.3676688
	speed: 0.1139s/iter; left time: 102864.4097s
	iters: 3300, epoch: 5 | loss: 0.3276686
	speed: 0.1131s/iter; left time: 102182.9748s
	iters: 3400, epoch: 5 | loss: 0.3517303
	speed: 0.1132s/iter; left time: 102252.1120s
	iters: 3500, epoch: 5 | loss: 0.3898297
	speed: 0.1137s/iter; left time: 102709.7392s
	iters: 3600, epoch: 5 | loss: 0.3137252
	speed: 0.1130s/iter; left time: 102047.8541s
	iters: 3700, epoch: 5 | loss: 0.3625311
	speed: 0.1138s/iter; left time: 102753.8069s
	iters: 3800, epoch: 5 | loss: 0.3192108
	speed: 0.1131s/iter; left time: 102109.7732s
	iters: 3900, epoch: 5 | loss: 0.3597265
	speed: 0.1125s/iter; left time: 101580.3623s
	iters: 4000, epoch: 5 | loss: 0.3506492
	speed: 0.1136s/iter; left time: 102544.8360s
	iters: 4100, epoch: 5 | loss: 0.3657975
	speed: 0.1131s/iter; left time: 102086.7788s
	iters: 4200, epoch: 5 | loss: 0.3689278
	speed: 0.1136s/iter; left time: 102541.2984s
	iters: 4300, epoch: 5 | loss: 0.4207438
	speed: 0.1137s/iter; left time: 102560.7688s
	iters: 4400, epoch: 5 | loss: 0.3468585
	speed: 0.1128s/iter; left time: 101775.1150s
	iters: 4500, epoch: 5 | loss: 0.3041880
	speed: 0.1137s/iter; left time: 102526.6632s
	iters: 4600, epoch: 5 | loss: 0.3950644
	speed: 0.1132s/iter; left time: 102083.3272s
Epoch: 5 cost time: 525.4092605113983
Epoch: 5, Steps: 4625 | Train Loss: 0.3572303 Vali Loss: 0.9848481 Test Loss: 4.8900175
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.3735308
	speed: 4.5101s/iter; left time: 4067138.6289s
	iters: 200, epoch: 6 | loss: 0.3640272
	speed: 0.1114s/iter; left time: 100463.2003s
	iters: 300, epoch: 6 | loss: 0.3647863
	speed: 0.1105s/iter; left time: 99657.5361s
	iters: 400, epoch: 6 | loss: 0.3619351
	speed: 0.1103s/iter; left time: 99412.1071s
	iters: 500, epoch: 6 | loss: 0.3678790
	speed: 0.1108s/iter; left time: 99885.3372s
	iters: 600, epoch: 6 | loss: 0.3124933
	speed: 0.1100s/iter; left time: 99106.7354s
	iters: 700, epoch: 6 | loss: 0.3539413
	speed: 0.1096s/iter; left time: 98761.1293s
	iters: 800, epoch: 6 | loss: 0.2972247
	speed: 0.1099s/iter; left time: 99040.0984s
	iters: 900, epoch: 6 | loss: 0.3253698
	speed: 0.1096s/iter; left time: 98756.9414s
	iters: 1000, epoch: 6 | loss: 0.3229810
	speed: 0.1098s/iter; left time: 98940.5202s
	iters: 1100, epoch: 6 | loss: 0.3143718
	speed: 0.1096s/iter; left time: 98727.6593s
	iters: 1200, epoch: 6 | loss: 0.3667937
	speed: 0.1097s/iter; left time: 98831.7556s
	iters: 1300, epoch: 6 | loss: 0.3617809
	speed: 0.1102s/iter; left time: 99268.2745s
	iters: 1400, epoch: 6 | loss: 0.3007354
	speed: 0.1107s/iter; left time: 99690.4687s
	iters: 1500, epoch: 6 | loss: 0.2832668
	speed: 0.1099s/iter; left time: 98933.6190s
	iters: 1600, epoch: 6 | loss: 0.3378710
	speed: 0.1099s/iter; left time: 98971.2002s
	iters: 1700, epoch: 6 | loss: 0.3598611
	speed: 0.1095s/iter; left time: 98612.2648s
	iters: 1800, epoch: 6 | loss: 0.3022273
	speed: 0.1098s/iter; left time: 98866.0643s
	iters: 1900, epoch: 6 | loss: 0.3079577
	speed: 0.1096s/iter; left time: 98670.6993s
	iters: 2000, epoch: 6 | loss: 0.2768135
	speed: 0.1097s/iter; left time: 98757.5240s
	iters: 2100, epoch: 6 | loss: 0.3164814
	speed: 0.1095s/iter; left time: 98559.2663s
	iters: 2200, epoch: 6 | loss: 0.2877343
	speed: 0.1094s/iter; left time: 98418.3988s
	iters: 2300, epoch: 6 | loss: 0.3417500
	speed: 0.1098s/iter; left time: 98817.9701s
	iters: 2400, epoch: 6 | loss: 0.3178150
	speed: 0.1100s/iter; left time: 98927.1082s
	iters: 2500, epoch: 6 | loss: 0.3080444
	speed: 0.1104s/iter; left time: 99248.2030s
	iters: 2600, epoch: 6 | loss: 0.3039570
	speed: 0.1094s/iter; left time: 98345.6455s
	iters: 2700, epoch: 6 | loss: 0.3362376
	speed: 0.1099s/iter; left time: 98830.4145s
	iters: 2800, epoch: 6 | loss: 0.3295279
	speed: 0.1095s/iter; left time: 98438.6791s
	iters: 2900, epoch: 6 | loss: 0.2981147
	speed: 0.1093s/iter; left time: 98218.9381s
	iters: 3000, epoch: 6 | loss: 0.3348703
	speed: 0.1095s/iter; left time: 98452.5516s
	iters: 3100, epoch: 6 | loss: 0.3355445
	speed: 0.1095s/iter; left time: 98425.9667s
	iters: 3200, epoch: 6 | loss: 0.3262993
	speed: 0.1097s/iter; left time: 98627.7961s
	iters: 3300, epoch: 6 | loss: 0.3111243
	speed: 0.1096s/iter; left time: 98450.8796s
	iters: 3400, epoch: 6 | loss: 0.2869286
	speed: 0.1092s/iter; left time: 98107.8261s
	iters: 3500, epoch: 6 | loss: 0.3222562
	speed: 0.1095s/iter; left time: 98407.3017s
	iters: 3600, epoch: 6 | loss: 0.3113864
	speed: 0.1099s/iter; left time: 98677.9221s
	iters: 3700, epoch: 6 | loss: 0.3179053
	speed: 0.1093s/iter; left time: 98194.7369s
	iters: 3800, epoch: 6 | loss: 0.3232794
	speed: 0.1094s/iter; left time: 98275.2262s
	iters: 3900, epoch: 6 | loss: 0.3403107
	speed: 0.1099s/iter; left time: 98707.5460s
	iters: 4000, epoch: 6 | loss: 0.3325258
	speed: 0.1093s/iter; left time: 98096.0181s
	iters: 4100, epoch: 6 | loss: 0.3338917
	speed: 0.1098s/iter; left time: 98590.7133s
	iters: 4200, epoch: 6 | loss: 0.3191817
	speed: 0.1094s/iter; left time: 98232.0797s
	iters: 4300, epoch: 6 | loss: 0.3179857
	speed: 0.1095s/iter; left time: 98249.8340s
	iters: 4400, epoch: 6 | loss: 0.3151605
	speed: 0.1095s/iter; left time: 98233.2133s
	iters: 4500, epoch: 6 | loss: 0.3164178
	speed: 0.1093s/iter; left time: 98074.0852s
	iters: 4600, epoch: 6 | loss: 0.3079566
	speed: 0.1092s/iter; left time: 97974.9433s
Epoch: 6 cost time: 508.28597259521484
Epoch: 6, Steps: 4625 | Train Loss: 0.3300520 Vali Loss: 1.0128664 Test Loss: 4.9161024
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.3080402
	speed: 4.5087s/iter; left time: 4044999.9379s
	iters: 200, epoch: 7 | loss: 0.3142906
	speed: 0.1120s/iter; left time: 100474.3278s
	iters: 300, epoch: 7 | loss: 0.3562382
	speed: 0.1117s/iter; left time: 100177.1203s
	iters: 400, epoch: 7 | loss: 0.3867707
	speed: 0.1114s/iter; left time: 99894.1618s
	iters: 500, epoch: 7 | loss: 0.2974948
	speed: 0.1116s/iter; left time: 100121.8939s
	iters: 600, epoch: 7 | loss: 0.3002887
	speed: 0.1118s/iter; left time: 100288.1371s
	iters: 700, epoch: 7 | loss: 0.2845267
	speed: 0.1116s/iter; left time: 100097.5696s
	iters: 800, epoch: 7 | loss: 0.3032735
	speed: 0.1118s/iter; left time: 100252.1637s
	iters: 900, epoch: 7 | loss: 0.3251544
	speed: 0.1117s/iter; left time: 100135.2896s
	iters: 1000, epoch: 7 | loss: 0.2944727
	speed: 0.1100s/iter; left time: 98602.2409s
	iters: 1100, epoch: 7 | loss: 0.3195794
	speed: 0.1100s/iter; left time: 98609.3084s
	iters: 1200, epoch: 7 | loss: 0.3132773
	speed: 0.1100s/iter; left time: 98586.2984s
	iters: 1300, epoch: 7 | loss: 0.3044815
	speed: 0.1096s/iter; left time: 98200.3099s
	iters: 1400, epoch: 7 | loss: 0.3669342
	speed: 0.1097s/iter; left time: 98231.4518s
	iters: 1500, epoch: 7 | loss: 0.2927518
	speed: 0.1099s/iter; left time: 98460.6818s
	iters: 1600, epoch: 7 | loss: 0.3788196
	speed: 0.1095s/iter; left time: 98099.2496s
	iters: 1700, epoch: 7 | loss: 0.2878088
	speed: 0.1097s/iter; left time: 98282.7457s
	iters: 1800, epoch: 7 | loss: 0.3299695
	speed: 0.1099s/iter; left time: 98373.2184s
	iters: 1900, epoch: 7 | loss: 0.3242287
	speed: 0.1097s/iter; left time: 98263.5866s
	iters: 2000, epoch: 7 | loss: 0.3188251
	speed: 0.1095s/iter; left time: 98056.9323s
	iters: 2100, epoch: 7 | loss: 0.3186533
	speed: 0.1095s/iter; left time: 98011.3112s
	iters: 2200, epoch: 7 | loss: 0.3200537
	speed: 0.1096s/iter; left time: 98088.7617s
	iters: 2300, epoch: 7 | loss: 0.2954311
	speed: 0.1094s/iter; left time: 97939.9659s
	iters: 2400, epoch: 7 | loss: 0.3003126
	speed: 0.1094s/iter; left time: 97878.7893s
	iters: 2500, epoch: 7 | loss: 0.3184152
	speed: 0.1096s/iter; left time: 98090.6034s
	iters: 2600, epoch: 7 | loss: 0.3182883
	speed: 0.1095s/iter; left time: 97961.8256s
	iters: 2700, epoch: 7 | loss: 0.3584746
	speed: 0.1092s/iter; left time: 97649.0625s
	iters: 2800, epoch: 7 | loss: 0.2953230
	speed: 0.1098s/iter; left time: 98246.0860s
	iters: 2900, epoch: 7 | loss: 0.3629942
	speed: 0.1092s/iter; left time: 97664.2557s
	iters: 3000, epoch: 7 | loss: 0.3188125
	speed: 0.1095s/iter; left time: 97912.7626s
	iters: 3100, epoch: 7 | loss: 0.2827789
	speed: 0.1094s/iter; left time: 97807.7617s
	iters: 3200, epoch: 7 | loss: 0.3328314
	speed: 0.1090s/iter; left time: 97459.9540s
	iters: 3300, epoch: 7 | loss: 0.3171262
	speed: 0.1093s/iter; left time: 97667.9124s
	iters: 3400, epoch: 7 | loss: 0.3650350
	speed: 0.1090s/iter; left time: 97459.1286s
	iters: 3500, epoch: 7 | loss: 0.2997869
	speed: 0.1099s/iter; left time: 98242.6536s
	iters: 3600, epoch: 7 | loss: 0.2706250
	speed: 0.1092s/iter; left time: 97585.2389s
	iters: 3700, epoch: 7 | loss: 0.3028862
	speed: 0.1093s/iter; left time: 97700.5512s
	iters: 3800, epoch: 7 | loss: 0.3063519
	speed: 0.1093s/iter; left time: 97681.6845s
	iters: 3900, epoch: 7 | loss: 0.3048750
	speed: 0.1092s/iter; left time: 97553.4187s
	iters: 4000, epoch: 7 | loss: 0.2701668
	speed: 0.1091s/iter; left time: 97439.4139s
	iters: 4100, epoch: 7 | loss: 0.2777981
	speed: 0.1093s/iter; left time: 97655.8762s
	iters: 4200, epoch: 7 | loss: 0.3194696
	speed: 0.1095s/iter; left time: 97795.5662s
	iters: 4300, epoch: 7 | loss: 0.2854481
	speed: 0.1093s/iter; left time: 97561.3577s
	iters: 4400, epoch: 7 | loss: 0.3134086
	speed: 0.1090s/iter; left time: 97294.6702s
	iters: 4500, epoch: 7 | loss: 0.3037899
	speed: 0.1092s/iter; left time: 97532.8548s
	iters: 4600, epoch: 7 | loss: 0.3391986
	speed: 0.1091s/iter; left time: 97348.1947s
Epoch: 7 cost time: 508.727823972702
Epoch: 7, Steps: 4625 | Train Loss: 0.3097447 Vali Loss: 1.0256373 Test Loss: 4.9274073
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems11_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 347822
Traceback (most recent call last):
  File "run.py", line 161, in <module>
    exp.test(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 286, in test
    visual(gt, pd, os.path.join(folder_path, str(i) + '.pdf'))
  File "/g/data/hn98/du/exlts/ddd2/utils/tools.py", line 89, in visual
    plt.savefig(name, bbox_inches='tight')
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/matplotlib/pyplot.py", line 996, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/matplotlib/figure.py", line 3328, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/matplotlib/backend_bases.py", line 2362, in print_figure
    result = print_method(
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/matplotlib/backend_bases.py", line 2228, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/matplotlib/backends/backend_pdf.py", line 2823, in print_pdf
    file.close()
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/matplotlib/backends/backend_pdf.py", line 890, in close
    self.fh.close()
OSError: [Errno 122] Disk quota exceeded
