Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1216550
val 299854
test 299853
	iters: 100, epoch: 1 | loss: 1.4104344
	speed: 0.2999s/iter; left time: 227949.1559s
	iters: 200, epoch: 1 | loss: 1.1808139
	speed: 0.2990s/iter; left time: 227225.0464s
	iters: 300, epoch: 1 | loss: 1.3177395
	speed: 0.2984s/iter; left time: 226770.6819s
	iters: 400, epoch: 1 | loss: 1.2594328
	speed: 0.2987s/iter; left time: 226950.9601s
	iters: 500, epoch: 1 | loss: 1.2686558
	speed: 0.2988s/iter; left time: 226994.0645s
	iters: 600, epoch: 1 | loss: 1.3247819
	speed: 0.2984s/iter; left time: 226657.3495s
	iters: 700, epoch: 1 | loss: 1.2631975
	speed: 0.2983s/iter; left time: 226570.3982s
	iters: 800, epoch: 1 | loss: 1.2728449
	speed: 0.2985s/iter; left time: 226662.7772s
	iters: 900, epoch: 1 | loss: 1.3001217
	speed: 0.2990s/iter; left time: 227020.4818s
	iters: 1000, epoch: 1 | loss: 1.2487437
	speed: 0.2988s/iter; left time: 226850.8905s
	iters: 1100, epoch: 1 | loss: 1.3062340
	speed: 0.2989s/iter; left time: 226862.2131s
	iters: 1200, epoch: 1 | loss: 1.1323305
	speed: 0.2991s/iter; left time: 227046.4447s
	iters: 1300, epoch: 1 | loss: 1.1941339
	speed: 0.2982s/iter; left time: 226319.6555s
	iters: 1400, epoch: 1 | loss: 1.3552070
	speed: 0.2985s/iter; left time: 226511.7693s
	iters: 1500, epoch: 1 | loss: 1.3816379
	speed: 0.2988s/iter; left time: 226703.0017s
	iters: 1600, epoch: 1 | loss: 1.2781414
	speed: 0.2993s/iter; left time: 227011.5605s
	iters: 1700, epoch: 1 | loss: 1.2636883
	speed: 0.2955s/iter; left time: 224142.7073s
	iters: 1800, epoch: 1 | loss: 1.2714114
	speed: 0.2956s/iter; left time: 224155.9975s
	iters: 1900, epoch: 1 | loss: 1.2661744
	speed: 0.2948s/iter; left time: 223537.0358s
	iters: 2000, epoch: 1 | loss: 1.1771282
	speed: 0.2947s/iter; left time: 223410.9957s
	iters: 2100, epoch: 1 | loss: 1.2839612
	speed: 0.2955s/iter; left time: 224048.5145s
	iters: 2200, epoch: 1 | loss: 1.1060251
	speed: 0.2948s/iter; left time: 223421.9506s
	iters: 2300, epoch: 1 | loss: 1.1366638
	speed: 0.2952s/iter; left time: 223701.4577s
	iters: 2400, epoch: 1 | loss: 1.1931088
	speed: 0.2948s/iter; left time: 223408.7343s
	iters: 2500, epoch: 1 | loss: 1.2493371
	speed: 0.2950s/iter; left time: 223535.1974s
	iters: 2600, epoch: 1 | loss: 1.2964966
	speed: 0.2948s/iter; left time: 223375.6376s
	iters: 2700, epoch: 1 | loss: 1.1785743
	speed: 0.2944s/iter; left time: 222973.2020s
	iters: 2800, epoch: 1 | loss: 1.0746377
	speed: 0.2953s/iter; left time: 223690.4062s
	iters: 2900, epoch: 1 | loss: 1.0632110
	speed: 0.2952s/iter; left time: 223568.9339s
	iters: 3000, epoch: 1 | loss: 1.0312090
	speed: 0.2949s/iter; left time: 223320.0654s
	iters: 3100, epoch: 1 | loss: 1.0401134
	speed: 0.2951s/iter; left time: 223452.6533s
	iters: 3200, epoch: 1 | loss: 1.1598680
	speed: 0.2947s/iter; left time: 223079.6581s
	iters: 3300, epoch: 1 | loss: 1.1577131
	speed: 0.2955s/iter; left time: 223664.6891s
	iters: 3400, epoch: 1 | loss: 1.2780887
	speed: 0.2950s/iter; left time: 223232.8979s
	iters: 3500, epoch: 1 | loss: 1.1430202
	speed: 0.2950s/iter; left time: 223230.1200s
	iters: 3600, epoch: 1 | loss: 1.2095087
	speed: 0.2952s/iter; left time: 223326.5933s
	iters: 3700, epoch: 1 | loss: 1.0745906
	speed: 0.2951s/iter; left time: 223277.1785s
	iters: 3800, epoch: 1 | loss: 1.0882127
	speed: 0.2952s/iter; left time: 223298.4424s
Epoch: 1 cost time: 1127.8181772232056
Epoch: 1, Steps: 3801 | Train Loss: 1.2310505 Vali Loss: 1.4041862 Test Loss: 1.4640083
Validation loss decreased (inf --> 1.404186).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0642539
	speed: 5.0528s/iter; left time: 3821460.8989s
	iters: 200, epoch: 2 | loss: 1.1225713
	speed: 0.2998s/iter; left time: 226737.1219s
	iters: 300, epoch: 2 | loss: 1.1436411
	speed: 0.2996s/iter; left time: 226550.0758s
	iters: 400, epoch: 2 | loss: 1.2513282
	speed: 0.2996s/iter; left time: 226463.4512s
	iters: 500, epoch: 2 | loss: 1.0257719
	speed: 0.2997s/iter; left time: 226522.5896s
	iters: 600, epoch: 2 | loss: 0.9898718
	speed: 0.2998s/iter; left time: 226556.7291s
	iters: 700, epoch: 2 | loss: 1.0308446
	speed: 0.2998s/iter; left time: 226542.2176s
	iters: 800, epoch: 2 | loss: 1.1238098
	speed: 0.2997s/iter; left time: 226420.8249s
	iters: 900, epoch: 2 | loss: 1.0544890
	speed: 0.3002s/iter; left time: 226787.3635s
	iters: 1000, epoch: 2 | loss: 1.0072727
	speed: 0.2999s/iter; left time: 226574.0345s
	iters: 1100, epoch: 2 | loss: 1.2308763
	speed: 0.3000s/iter; left time: 226595.9426s
	iters: 1200, epoch: 2 | loss: 0.9610682
	speed: 0.2995s/iter; left time: 226187.1178s
	iters: 1300, epoch: 2 | loss: 1.1830150
	speed: 0.3000s/iter; left time: 226522.0391s
	iters: 1400, epoch: 2 | loss: 1.1636207
	speed: 0.2998s/iter; left time: 226373.1318s
	iters: 1500, epoch: 2 | loss: 0.9651116
	speed: 0.2997s/iter; left time: 226254.2302s
	iters: 1600, epoch: 2 | loss: 1.0022936
	speed: 0.3002s/iter; left time: 226593.0204s
	iters: 1700, epoch: 2 | loss: 1.1319195
	speed: 0.2996s/iter; left time: 226124.4979s
	iters: 1800, epoch: 2 | loss: 0.9280101
	speed: 0.2995s/iter; left time: 226034.2351s
	iters: 1900, epoch: 2 | loss: 1.0542006
	speed: 0.2999s/iter; left time: 226289.0328s
	iters: 2000, epoch: 2 | loss: 0.9882547
	speed: 0.2999s/iter; left time: 226237.8008s
	iters: 2100, epoch: 2 | loss: 1.0332111
	speed: 0.2999s/iter; left time: 226202.9669s
	iters: 2200, epoch: 2 | loss: 1.0434856
	speed: 0.3001s/iter; left time: 226299.2069s
	iters: 2300, epoch: 2 | loss: 0.9997324
	speed: 0.3004s/iter; left time: 226557.6987s
	iters: 2400, epoch: 2 | loss: 0.9874907
	speed: 0.3000s/iter; left time: 226227.6950s
	iters: 2500, epoch: 2 | loss: 1.0540301
	speed: 0.2997s/iter; left time: 225955.2008s
	iters: 2600, epoch: 2 | loss: 0.9303609
	speed: 0.3002s/iter; left time: 226295.7022s
	iters: 2700, epoch: 2 | loss: 0.9797950
	speed: 0.3002s/iter; left time: 226288.5478s
	iters: 2800, epoch: 2 | loss: 1.0236915
	speed: 0.3004s/iter; left time: 226379.9700s
	iters: 2900, epoch: 2 | loss: 0.9924602
	speed: 0.3014s/iter; left time: 227098.7874s
	iters: 3000, epoch: 2 | loss: 0.9958810
	speed: 0.3000s/iter; left time: 226037.9876s
	iters: 3100, epoch: 2 | loss: 0.9908794
	speed: 0.3002s/iter; left time: 226130.6615s
	iters: 3200, epoch: 2 | loss: 1.0076362
	speed: 0.3003s/iter; left time: 226200.7946s
	iters: 3300, epoch: 2 | loss: 0.9919418
	speed: 0.2995s/iter; left time: 225579.9524s
	iters: 3400, epoch: 2 | loss: 0.9663770
	speed: 0.3008s/iter; left time: 226513.0096s
	iters: 3500, epoch: 2 | loss: 1.0190405
	speed: 0.3012s/iter; left time: 226751.5023s
	iters: 3600, epoch: 2 | loss: 0.9590533
	speed: 0.2995s/iter; left time: 225491.4379s
	iters: 3700, epoch: 2 | loss: 0.8895769
	speed: 0.3014s/iter; left time: 226849.5677s
	iters: 3800, epoch: 2 | loss: 1.0460681
	speed: 0.2999s/iter; left time: 225689.9601s
Epoch: 2 cost time: 1140.6314630508423
Epoch: 2, Steps: 3801 | Train Loss: 1.0314284 Vali Loss: 1.2416770 Test Loss: 1.2446200
Validation loss decreased (1.404186 --> 1.241677).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9149829
	speed: 5.0687s/iter; left time: 3814154.7830s
	iters: 200, epoch: 3 | loss: 1.0467883
	speed: 0.2967s/iter; left time: 223212.5560s
	iters: 300, epoch: 3 | loss: 0.9880989
	speed: 0.2970s/iter; left time: 223415.7335s
	iters: 400, epoch: 3 | loss: 1.0461655
	speed: 0.2964s/iter; left time: 222948.8809s
	iters: 500, epoch: 3 | loss: 0.9677362
	speed: 0.2958s/iter; left time: 222461.8085s
	iters: 600, epoch: 3 | loss: 1.0095028
	speed: 0.2968s/iter; left time: 223182.3401s
	iters: 700, epoch: 3 | loss: 0.9653656
	speed: 0.2962s/iter; left time: 222717.0453s
	iters: 800, epoch: 3 | loss: 0.9636888
	speed: 0.2969s/iter; left time: 223202.9146s
	iters: 900, epoch: 3 | loss: 0.9865917
	speed: 0.2958s/iter; left time: 222319.1482s
	iters: 1000, epoch: 3 | loss: 0.9359295
	speed: 0.2962s/iter; left time: 222659.4817s
	iters: 1100, epoch: 3 | loss: 0.9801745
	speed: 0.2970s/iter; left time: 223207.0036s
	iters: 1200, epoch: 3 | loss: 0.9507368
	speed: 0.2957s/iter; left time: 222197.6734s
	iters: 1300, epoch: 3 | loss: 0.9219739
	speed: 0.2963s/iter; left time: 222625.0036s
	iters: 1400, epoch: 3 | loss: 0.9876043
	speed: 0.2962s/iter; left time: 222520.4040s
	iters: 1500, epoch: 3 | loss: 1.0033206
	speed: 0.2964s/iter; left time: 222636.6555s
	iters: 1600, epoch: 3 | loss: 0.9768285
	speed: 0.2964s/iter; left time: 222600.1581s
	iters: 1700, epoch: 3 | loss: 0.9698040
	speed: 0.2964s/iter; left time: 222588.0928s
	iters: 1800, epoch: 3 | loss: 0.9709767
	speed: 0.2963s/iter; left time: 222440.7133s
	iters: 1900, epoch: 3 | loss: 0.9831004
	speed: 0.2957s/iter; left time: 222003.9805s
	iters: 2000, epoch: 3 | loss: 1.0146114
	speed: 0.2960s/iter; left time: 222179.6601s
	iters: 2100, epoch: 3 | loss: 1.0181159
	speed: 0.2970s/iter; left time: 222866.1475s
	iters: 2200, epoch: 3 | loss: 0.9764208
	speed: 0.2959s/iter; left time: 222057.5569s
	iters: 2300, epoch: 3 | loss: 0.9959803
	speed: 0.2962s/iter; left time: 222221.3023s
	iters: 2400, epoch: 3 | loss: 0.9326751
	speed: 0.2966s/iter; left time: 222508.9507s
	iters: 2500, epoch: 3 | loss: 0.9844406
	speed: 0.2961s/iter; left time: 222101.0869s
	iters: 2600, epoch: 3 | loss: 0.9788176
	speed: 0.2953s/iter; left time: 221484.5750s
	iters: 2700, epoch: 3 | loss: 0.9382929
	speed: 0.2969s/iter; left time: 222661.6660s
	iters: 2800, epoch: 3 | loss: 0.9002035
	speed: 0.2959s/iter; left time: 221833.1275s
	iters: 2900, epoch: 3 | loss: 1.0939027
	speed: 0.2964s/iter; left time: 222242.6917s
	iters: 3000, epoch: 3 | loss: 0.9415636
	speed: 0.2965s/iter; left time: 222293.5475s
	iters: 3100, epoch: 3 | loss: 0.9500629
	speed: 0.2963s/iter; left time: 222076.2686s
	iters: 3200, epoch: 3 | loss: 0.9038563
	speed: 0.2977s/iter; left time: 223088.9103s
	iters: 3300, epoch: 3 | loss: 0.8813332
	speed: 0.2958s/iter; left time: 221620.4896s
	iters: 3400, epoch: 3 | loss: 0.9526763
	speed: 0.2962s/iter; left time: 221884.1543s
	iters: 3500, epoch: 3 | loss: 0.8888643
	speed: 0.2966s/iter; left time: 222190.6581s
	iters: 3600, epoch: 3 | loss: 0.9754696
	speed: 0.2960s/iter; left time: 221677.8902s
	iters: 3700, epoch: 3 | loss: 1.0015997
	speed: 0.2953s/iter; left time: 221162.9266s
	iters: 3800, epoch: 3 | loss: 0.9082560
	speed: 0.2956s/iter; left time: 221322.1967s
Epoch: 3 cost time: 1126.4227850437164
Epoch: 3, Steps: 3801 | Train Loss: 0.9732875 Vali Loss: 1.2930799 Test Loss: 1.2393857
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.9166931
	speed: 5.0569s/iter; left time: 3786094.0279s
	iters: 200, epoch: 4 | loss: 0.9483739
	speed: 0.3000s/iter; left time: 224588.5060s
	iters: 300, epoch: 4 | loss: 0.9419062
	speed: 0.2998s/iter; left time: 224409.9867s
	iters: 400, epoch: 4 | loss: 0.9804951
	speed: 0.2999s/iter; left time: 224476.7940s
	iters: 500, epoch: 4 | loss: 0.9875748
	speed: 0.2998s/iter; left time: 224343.1981s
	iters: 600, epoch: 4 | loss: 0.9696191
	speed: 0.2993s/iter; left time: 223965.2612s
	iters: 700, epoch: 4 | loss: 0.8655691
	speed: 0.2992s/iter; left time: 223822.9762s
	iters: 800, epoch: 4 | loss: 0.8871642
	speed: 0.2994s/iter; left time: 223933.3725s
	iters: 900, epoch: 4 | loss: 0.9832343
	speed: 0.2995s/iter; left time: 223983.7202s
	iters: 1000, epoch: 4 | loss: 1.0989096
	speed: 0.2999s/iter; left time: 224243.5376s
	iters: 1100, epoch: 4 | loss: 1.0077859
	speed: 0.2993s/iter; left time: 223822.9306s
	iters: 1200, epoch: 4 | loss: 0.9176344
	speed: 0.2993s/iter; left time: 223758.9017s
	iters: 1300, epoch: 4 | loss: 0.8800488
	speed: 0.2991s/iter; left time: 223560.4596s
	iters: 1400, epoch: 4 | loss: 0.9575012
	speed: 0.2994s/iter; left time: 223768.3867s
	iters: 1500, epoch: 4 | loss: 0.9950503
	speed: 0.2997s/iter; left time: 223955.5255s
	iters: 1600, epoch: 4 | loss: 0.9884861
	speed: 0.3006s/iter; left time: 224578.9977s
	iters: 1700, epoch: 4 | loss: 0.9772622
	speed: 0.3005s/iter; left time: 224491.8623s
	iters: 1800, epoch: 4 | loss: 0.9884815
	speed: 0.2996s/iter; left time: 223799.2921s
	iters: 1900, epoch: 4 | loss: 0.9617769
	speed: 0.2996s/iter; left time: 223806.8044s
	iters: 2000, epoch: 4 | loss: 0.9346711
	speed: 0.2998s/iter; left time: 223880.4027s
	iters: 2100, epoch: 4 | loss: 0.9039857
	speed: 0.2996s/iter; left time: 223705.5761s
	iters: 2200, epoch: 4 | loss: 1.0311009
	speed: 0.2988s/iter; left time: 223076.6693s
	iters: 2300, epoch: 4 | loss: 0.9759345
	speed: 0.2997s/iter; left time: 223702.9543s
	iters: 2400, epoch: 4 | loss: 0.9353405
	speed: 0.3007s/iter; left time: 224477.8286s
	iters: 2500, epoch: 4 | loss: 0.9734553
	speed: 0.3001s/iter; left time: 223977.8034s
	iters: 2600, epoch: 4 | loss: 0.9092313
	speed: 0.2991s/iter; left time: 223153.3315s
	iters: 2700, epoch: 4 | loss: 1.0006390
	speed: 0.2990s/iter; left time: 223071.3863s
	iters: 2800, epoch: 4 | loss: 0.9541883
	speed: 0.2994s/iter; left time: 223344.2675s
	iters: 2900, epoch: 4 | loss: 0.9365931
	speed: 0.2994s/iter; left time: 223295.1542s
	iters: 3000, epoch: 4 | loss: 1.0214396
	speed: 0.2991s/iter; left time: 223099.5858s
	iters: 3100, epoch: 4 | loss: 0.9273092
	speed: 0.2996s/iter; left time: 223376.5644s
	iters: 3200, epoch: 4 | loss: 0.9571641
	speed: 0.2999s/iter; left time: 223623.1571s
	iters: 3300, epoch: 4 | loss: 0.8943269
	speed: 0.2990s/iter; left time: 222880.5369s
	iters: 3400, epoch: 4 | loss: 0.8853515
	speed: 0.2990s/iter; left time: 222884.4098s
	iters: 3500, epoch: 4 | loss: 0.9983036
	speed: 0.2993s/iter; left time: 223076.9355s
	iters: 3600, epoch: 4 | loss: 0.9666963
	speed: 0.3000s/iter; left time: 223522.6936s
	iters: 3700, epoch: 4 | loss: 0.9120547
	speed: 0.2992s/iter; left time: 222953.7212s
	iters: 3800, epoch: 4 | loss: 1.0610504
	speed: 0.3000s/iter; left time: 223527.0468s
Epoch: 4 cost time: 1138.993141412735
Epoch: 4, Steps: 3801 | Train Loss: 0.9469940 Vali Loss: 1.3015983 Test Loss: 1.2601885
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.8975980
	speed: 5.0636s/iter; left time: 3771893.4353s
	iters: 200, epoch: 5 | loss: 0.9108604
	speed: 0.2975s/iter; left time: 221600.9130s
	iters: 300, epoch: 5 | loss: 0.9559202
	speed: 0.2972s/iter; left time: 221306.3233s
	iters: 400, epoch: 5 | loss: 0.9130281
	speed: 0.2972s/iter; left time: 221274.3528s
	iters: 500, epoch: 5 | loss: 0.9070452
	speed: 0.2967s/iter; left time: 220925.8101s
	iters: 600, epoch: 5 | loss: 0.9453596
	speed: 0.2970s/iter; left time: 221051.1591s
	iters: 700, epoch: 5 | loss: 1.0021720
	speed: 0.3005s/iter; left time: 223643.7831s
	iters: 800, epoch: 5 | loss: 0.8890407
	speed: 0.3045s/iter; left time: 226580.1374s
	iters: 900, epoch: 5 | loss: 0.9341381
	speed: 0.2979s/iter; left time: 221689.5535s
	iters: 1000, epoch: 5 | loss: 0.9953897
	speed: 0.2986s/iter; left time: 222163.0307s
	iters: 1100, epoch: 5 | loss: 0.9035730
	speed: 0.3045s/iter; left time: 226508.0048s
	iters: 1200, epoch: 5 | loss: 0.8957534
	speed: 0.3041s/iter; left time: 226181.8587s
	iters: 1300, epoch: 5 | loss: 0.9327183
	speed: 0.3045s/iter; left time: 226476.1755s
	iters: 1400, epoch: 5 | loss: 0.8601769
	speed: 0.3036s/iter; left time: 225778.0852s
	iters: 1500, epoch: 5 | loss: 0.9145951
	speed: 0.3040s/iter; left time: 226004.4760s
	iters: 1600, epoch: 5 | loss: 0.9340116
	speed: 0.3022s/iter; left time: 224639.1254s
	iters: 1700, epoch: 5 | loss: 0.9171036
	speed: 0.2937s/iter; left time: 218276.9616s
	iters: 1800, epoch: 5 | loss: 0.8681677
	speed: 0.2945s/iter; left time: 218850.9838s
	iters: 1900, epoch: 5 | loss: 0.9102924
	speed: 0.2995s/iter; left time: 222558.0798s
	iters: 2000, epoch: 5 | loss: 0.8779628
	speed: 0.2950s/iter; left time: 219180.4942s
	iters: 2100, epoch: 5 | loss: 0.8107753
	speed: 0.3042s/iter; left time: 225972.3512s
	iters: 2200, epoch: 5 | loss: 0.8652065
	speed: 0.3042s/iter; left time: 225951.2877s
	iters: 2300, epoch: 5 | loss: 0.8271978
	speed: 0.2961s/iter; left time: 219942.7276s
	iters: 2400, epoch: 5 | loss: 0.8434879
	speed: 0.3033s/iter; left time: 225240.1792s
	iters: 2500, epoch: 5 | loss: 0.8497774
	speed: 0.3042s/iter; left time: 225872.1765s
	iters: 2600, epoch: 5 | loss: 0.7785732
	speed: 0.3038s/iter; left time: 225564.0020s
	iters: 2700, epoch: 5 | loss: 0.7820191
	speed: 0.3043s/iter; left time: 225858.6218s
	iters: 2800, epoch: 5 | loss: 0.7832383
	speed: 0.3043s/iter; left time: 225883.9334s
	iters: 2900, epoch: 5 | loss: 0.8397146
	speed: 0.3040s/iter; left time: 225565.2592s
	iters: 3000, epoch: 5 | loss: 0.9125746
	speed: 0.3041s/iter; left time: 225633.9521s
	iters: 3100, epoch: 5 | loss: 0.8634230
	speed: 0.3042s/iter; left time: 225651.0412s
	iters: 3200, epoch: 5 | loss: 0.8460035
	speed: 0.3046s/iter; left time: 225935.9038s
	iters: 3300, epoch: 5 | loss: 0.7871417
	speed: 0.2936s/iter; left time: 217771.4303s
	iters: 3400, epoch: 5 | loss: 0.7969449
	speed: 0.2938s/iter; left time: 217865.0460s
	iters: 3500, epoch: 5 | loss: 0.7866081
	speed: 0.2955s/iter; left time: 219137.8629s
	iters: 3600, epoch: 5 | loss: 0.8219094
	speed: 0.3000s/iter; left time: 222383.9277s
	iters: 3700, epoch: 5 | loss: 0.7328545
	speed: 0.2991s/iter; left time: 221719.1338s
	iters: 3800, epoch: 5 | loss: 0.8192105
	speed: 0.2993s/iter; left time: 221825.9010s
Epoch: 5 cost time: 1141.7161448001862
Epoch: 5, Steps: 3801 | Train Loss: 0.8816565 Vali Loss: 1.3016115 Test Loss: 1.2823057
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.8059164
	speed: 5.0645s/iter; left time: 3753271.0804s
	iters: 200, epoch: 6 | loss: 0.8425416
	speed: 0.2944s/iter; left time: 218112.3859s
	iters: 300, epoch: 6 | loss: 0.8278933
	speed: 0.2968s/iter; left time: 219914.8822s
	iters: 400, epoch: 6 | loss: 0.7704249
	speed: 0.2955s/iter; left time: 218927.1149s
	iters: 500, epoch: 6 | loss: 0.8209542
	speed: 0.2959s/iter; left time: 219137.0716s
	iters: 600, epoch: 6 | loss: 0.8592967
	speed: 0.2959s/iter; left time: 219156.5521s
	iters: 700, epoch: 6 | loss: 1.0048329
	speed: 0.2963s/iter; left time: 219427.8704s
	iters: 800, epoch: 6 | loss: 0.8121035
	speed: 0.2957s/iter; left time: 218902.4556s
	iters: 900, epoch: 6 | loss: 0.8131638
	speed: 0.2959s/iter; left time: 219046.0033s
	iters: 1000, epoch: 6 | loss: 0.7926660
	speed: 0.2949s/iter; left time: 218266.1616s
	iters: 1100, epoch: 6 | loss: 0.8711282
	speed: 0.2951s/iter; left time: 218372.1914s
	iters: 1200, epoch: 6 | loss: 0.8309667
	speed: 0.2959s/iter; left time: 218958.2508s
	iters: 1300, epoch: 6 | loss: 0.7679768
	speed: 0.2954s/iter; left time: 218581.7314s
	iters: 1400, epoch: 6 | loss: 0.7147405
	speed: 0.2952s/iter; left time: 218391.5342s
	iters: 1500, epoch: 6 | loss: 0.8137502
	speed: 0.2953s/iter; left time: 218402.9991s
	iters: 1600, epoch: 6 | loss: 0.8025550
	speed: 0.2951s/iter; left time: 218222.0520s
	iters: 1700, epoch: 6 | loss: 0.7448077
	speed: 0.2964s/iter; left time: 219195.1574s
	iters: 1800, epoch: 6 | loss: 0.7418850
	speed: 0.2958s/iter; left time: 218678.0086s
	iters: 1900, epoch: 6 | loss: 0.8131399
	speed: 0.2968s/iter; left time: 219397.5905s
	iters: 2000, epoch: 6 | loss: 0.7724404
	speed: 0.2975s/iter; left time: 219947.0445s
	iters: 2100, epoch: 6 | loss: 0.8289713
	speed: 0.2957s/iter; left time: 218544.6760s
	iters: 2200, epoch: 6 | loss: 0.7075808
	speed: 0.2985s/iter; left time: 220575.5634s
	iters: 2300, epoch: 6 | loss: 0.7719452
	speed: 0.2968s/iter; left time: 219328.6548s
	iters: 2400, epoch: 6 | loss: 0.7629170
	speed: 0.2952s/iter; left time: 218080.5608s
	iters: 2500, epoch: 6 | loss: 0.8335389
	speed: 0.2947s/iter; left time: 217710.4920s
	iters: 2600, epoch: 6 | loss: 0.8263680
	speed: 0.2961s/iter; left time: 218717.8953s
	iters: 2700, epoch: 6 | loss: 0.7808728
	speed: 0.2992s/iter; left time: 220991.3288s
	iters: 2800, epoch: 6 | loss: 0.7256830
	speed: 0.2954s/iter; left time: 218099.9539s
	iters: 2900, epoch: 6 | loss: 0.9097028
	speed: 0.2949s/iter; left time: 217745.5832s
	iters: 3000, epoch: 6 | loss: 0.7398801
	speed: 0.2967s/iter; left time: 219014.9939s
	iters: 3100, epoch: 6 | loss: 0.7503039
	speed: 0.2951s/iter; left time: 217829.3857s
	iters: 3200, epoch: 6 | loss: 0.7483652
	speed: 0.2975s/iter; left time: 219555.6417s
	iters: 3300, epoch: 6 | loss: 0.6752101
	speed: 0.2948s/iter; left time: 217499.3842s
	iters: 3400, epoch: 6 | loss: 0.7478677
	speed: 0.2967s/iter; left time: 218886.9055s
	iters: 3500, epoch: 6 | loss: 0.7442328
	speed: 0.2970s/iter; left time: 219059.4581s
	iters: 3600, epoch: 6 | loss: 0.7330609
	speed: 0.2950s/iter; left time: 217575.9126s
	iters: 3700, epoch: 6 | loss: 0.7726513
	speed: 0.2958s/iter; left time: 218157.5126s
	iters: 3800, epoch: 6 | loss: 0.8117104
	speed: 0.2957s/iter; left time: 218078.2780s
Epoch: 6 cost time: 1125.1682620048523
Epoch: 6, Steps: 3801 | Train Loss: 0.7910774 Vali Loss: 1.3407018 Test Loss: 1.2948625
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.7456683
	speed: 5.0647s/iter; left time: 3734172.8837s
	iters: 200, epoch: 7 | loss: 0.7619085
	speed: 0.2961s/iter; left time: 218266.4655s
	iters: 300, epoch: 7 | loss: 0.7105305
	speed: 0.2954s/iter; left time: 217720.1291s
	iters: 400, epoch: 7 | loss: 0.6923452
	speed: 0.2957s/iter; left time: 217895.1587s
	iters: 500, epoch: 7 | loss: 0.7277302
	speed: 0.2955s/iter; left time: 217752.9219s
	iters: 600, epoch: 7 | loss: 0.7492961
	speed: 0.2952s/iter; left time: 217502.0736s
	iters: 700, epoch: 7 | loss: 0.7101385
	speed: 0.2954s/iter; left time: 217608.9271s
	iters: 800, epoch: 7 | loss: 0.7918567
	speed: 0.2957s/iter; left time: 217806.8120s
	iters: 900, epoch: 7 | loss: 0.7473596
	speed: 0.2950s/iter; left time: 217264.4938s
	iters: 1000, epoch: 7 | loss: 0.7444865
	speed: 0.2956s/iter; left time: 217675.0644s
	iters: 1100, epoch: 7 | loss: 0.8793922
	speed: 0.2952s/iter; left time: 217343.9547s
	iters: 1200, epoch: 7 | loss: 0.7624554
	speed: 0.2957s/iter; left time: 217669.4779s
	iters: 1300, epoch: 7 | loss: 0.7622164
	speed: 0.2954s/iter; left time: 217438.6386s
	iters: 1400, epoch: 7 | loss: 0.8330603
	speed: 0.2953s/iter; left time: 217373.8778s
	iters: 1500, epoch: 7 | loss: 0.7031205
	speed: 0.2953s/iter; left time: 217296.6362s
	iters: 1600, epoch: 7 | loss: 0.7501406
	speed: 0.2955s/iter; left time: 217453.7573s
	iters: 1700, epoch: 7 | loss: 0.8159212
	speed: 0.2958s/iter; left time: 217590.7036s
	iters: 1800, epoch: 7 | loss: 0.7257724
	speed: 0.2955s/iter; left time: 217338.7251s
	iters: 1900, epoch: 7 | loss: 0.7477161
	speed: 0.2952s/iter; left time: 217139.3787s
	iters: 2000, epoch: 7 | loss: 0.7134238
	speed: 0.2956s/iter; left time: 217403.7102s
	iters: 2100, epoch: 7 | loss: 0.7258680
	speed: 0.2957s/iter; left time: 217413.7687s
	iters: 2200, epoch: 7 | loss: 0.7526842
	speed: 0.2952s/iter; left time: 217062.8065s
	iters: 2300, epoch: 7 | loss: 0.7508422
	speed: 0.2972s/iter; left time: 218481.6735s
	iters: 2400, epoch: 7 | loss: 0.7477825
	speed: 0.2965s/iter; left time: 217892.2379s
	iters: 2500, epoch: 7 | loss: 0.7010546
	speed: 0.2970s/iter; left time: 218280.0506s
	iters: 2600, epoch: 7 | loss: 0.7330820
	speed: 0.2956s/iter; left time: 217183.9410s
	iters: 2700, epoch: 7 | loss: 0.8368572
	speed: 0.2963s/iter; left time: 217720.3541s
	iters: 2800, epoch: 7 | loss: 0.7483708
	speed: 0.2965s/iter; left time: 217781.3712s
	iters: 2900, epoch: 7 | loss: 0.7603680
	speed: 0.2957s/iter; left time: 217189.2464s
	iters: 3000, epoch: 7 | loss: 0.7333897
	speed: 0.2959s/iter; left time: 217312.2196s
	iters: 3100, epoch: 7 | loss: 0.7458046
	speed: 0.2957s/iter; left time: 217162.6258s
	iters: 3200, epoch: 7 | loss: 0.7084441
	speed: 0.2955s/iter; left time: 216986.3317s
	iters: 3300, epoch: 7 | loss: 0.7917345
	speed: 0.2965s/iter; left time: 217670.5586s
	iters: 3400, epoch: 7 | loss: 0.7840886
	speed: 0.2955s/iter; left time: 216904.1898s
	iters: 3500, epoch: 7 | loss: 0.7861480
	speed: 0.2955s/iter; left time: 216864.0404s
	iters: 3600, epoch: 7 | loss: 0.8043274
	speed: 0.2987s/iter; left time: 219181.2469s
	iters: 3700, epoch: 7 | loss: 0.7264225
	speed: 0.3001s/iter; left time: 220209.0810s
	iters: 3800, epoch: 7 | loss: 0.8200050
	speed: 0.2997s/iter; left time: 219878.6982s
Epoch: 7 cost time: 1125.3678534030914
Epoch: 7, Steps: 3801 | Train Loss: 0.7614067 Vali Loss: 1.3429912 Test Loss: 1.3235589
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 299853
test shape: (29985, 1, 720, 151) (29985, 1, 720, 151)
test shape: (29985, 720, 151) (29985, 720, 151)
mse:1.2446297407150269, mae:0.835565984249115
>>>>>>>Overall time: 11827 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
