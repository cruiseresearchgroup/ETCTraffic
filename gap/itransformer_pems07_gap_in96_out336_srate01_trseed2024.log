Traceback (most recent call last):
  File "run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 2, in <module>
    from exp.exp_basic import Exp_Basic
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_basic.py", line 3, in <module>
    from models import Autoformer, Transformer, TimesNet, Nonstationary_Transformer, DLinear, FEDformer, \
  File "/g/data/hn98/du/exlts/ddd2/models/Mamba.py", line 7, in <module>
    from mamba_ssm import Mamba
ModuleNotFoundError: No module named 'mamba_ssm'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems07_all_filter10.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems07_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems07_all_filter10.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems07_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1269217
val 352801
test 352801
	iters: 100, epoch: 1 | loss: 1.6436597
	speed: 0.3456s/iter; left time: 27378.8272s
	iters: 200, epoch: 1 | loss: 1.8362195
	speed: 0.3335s/iter; left time: 26387.0411s
	iters: 300, epoch: 1 | loss: 1.7985981
	speed: 0.3336s/iter; left time: 26363.0401s
	iters: 400, epoch: 1 | loss: 1.4157630
	speed: 0.3335s/iter; left time: 26323.1973s
	iters: 500, epoch: 1 | loss: 1.5714186
	speed: 0.3330s/iter; left time: 26244.0002s
	iters: 600, epoch: 1 | loss: 1.5361297
	speed: 0.3328s/iter; left time: 26198.7962s
	iters: 700, epoch: 1 | loss: 1.4608771
	speed: 0.3327s/iter; left time: 26157.2162s
	iters: 800, epoch: 1 | loss: 1.5278200
	speed: 0.3327s/iter; left time: 26120.3402s
	iters: 900, epoch: 1 | loss: 1.6860464
	speed: 0.3322s/iter; left time: 26054.4616s
	iters: 1000, epoch: 1 | loss: 1.5694195
	speed: 0.3326s/iter; left time: 26052.1900s
	iters: 1100, epoch: 1 | loss: 1.5832452
	speed: 0.3322s/iter; left time: 25987.7784s
	iters: 1200, epoch: 1 | loss: 1.5408499
	speed: 0.3326s/iter; left time: 25980.1409s
	iters: 1300, epoch: 1 | loss: 1.4275718
	speed: 0.3326s/iter; left time: 25946.3087s
	iters: 1400, epoch: 1 | loss: 1.5037712
	speed: 0.3323s/iter; left time: 25890.9446s
	iters: 1500, epoch: 1 | loss: 1.5725532
	speed: 0.3328s/iter; left time: 25901.0853s
	iters: 1600, epoch: 1 | loss: 1.4421681
	speed: 0.3331s/iter; left time: 25890.8411s
	iters: 1700, epoch: 1 | loss: 1.6292735
	speed: 0.3331s/iter; left time: 25854.6621s
	iters: 1800, epoch: 1 | loss: 1.6911637
	speed: 0.3331s/iter; left time: 25822.4687s
	iters: 1900, epoch: 1 | loss: 1.6356729
	speed: 0.3330s/iter; left time: 25782.2263s
	iters: 2000, epoch: 1 | loss: 1.6120640
	speed: 0.3323s/iter; left time: 25692.6812s
	iters: 2100, epoch: 1 | loss: 1.6178688
	speed: 0.3325s/iter; left time: 25678.7572s
	iters: 2200, epoch: 1 | loss: 1.4756485
	speed: 0.3327s/iter; left time: 25658.7804s
	iters: 2300, epoch: 1 | loss: 1.6916018
	speed: 0.3324s/iter; left time: 25604.7323s
	iters: 2400, epoch: 1 | loss: 1.5018966
	speed: 0.3323s/iter; left time: 25563.9910s
	iters: 2500, epoch: 1 | loss: 1.6210358
	speed: 0.3323s/iter; left time: 25530.5186s
	iters: 2600, epoch: 1 | loss: 1.5408642
	speed: 0.3324s/iter; left time: 25501.5212s
	iters: 2700, epoch: 1 | loss: 1.6416677
	speed: 0.3322s/iter; left time: 25455.9317s
	iters: 2800, epoch: 1 | loss: 1.6163297
	speed: 0.3324s/iter; left time: 25435.5870s
	iters: 2900, epoch: 1 | loss: 1.6618146
	speed: 0.3325s/iter; left time: 25408.1736s
	iters: 3000, epoch: 1 | loss: 1.6831794
	speed: 0.3325s/iter; left time: 25375.8811s
	iters: 3100, epoch: 1 | loss: 1.5103933
	speed: 0.3324s/iter; left time: 25335.1346s
	iters: 3200, epoch: 1 | loss: 1.5490253
	speed: 0.3330s/iter; left time: 25348.1200s
	iters: 3300, epoch: 1 | loss: 1.6221197
	speed: 0.3331s/iter; left time: 25321.1917s
	iters: 3400, epoch: 1 | loss: 1.4160403
	speed: 0.3330s/iter; left time: 25279.1071s
	iters: 3500, epoch: 1 | loss: 1.6367066
	speed: 0.3331s/iter; left time: 25253.3703s
	iters: 3600, epoch: 1 | loss: 1.4464158
	speed: 0.3331s/iter; left time: 25219.5397s
	iters: 3700, epoch: 1 | loss: 1.6225511
	speed: 0.3328s/iter; left time: 25166.9097s
	iters: 3800, epoch: 1 | loss: 1.4406602
	speed: 0.3331s/iter; left time: 25155.8526s
	iters: 3900, epoch: 1 | loss: 1.5422167
	speed: 0.3332s/iter; left time: 25126.6060s
	iters: 4000, epoch: 1 | loss: 1.6388617
	speed: 0.3329s/iter; left time: 25077.3302s
	iters: 4100, epoch: 1 | loss: 1.5242895
	speed: 0.3331s/iter; left time: 25054.2906s
	iters: 4200, epoch: 1 | loss: 1.6396581
	speed: 0.3331s/iter; left time: 25025.9098s
	iters: 4300, epoch: 1 | loss: 1.5986998
	speed: 0.3330s/iter; left time: 24982.8377s
	iters: 4400, epoch: 1 | loss: 1.6566578
	speed: 0.3331s/iter; left time: 24958.5429s
	iters: 4500, epoch: 1 | loss: 1.6086051
	speed: 0.3330s/iter; left time: 24917.5659s
	iters: 4600, epoch: 1 | loss: 1.7371715
	speed: 0.3331s/iter; left time: 24892.2352s
	iters: 4700, epoch: 1 | loss: 1.6595466
	speed: 0.3332s/iter; left time: 24862.2606s
	iters: 4800, epoch: 1 | loss: 1.6700517
	speed: 0.3331s/iter; left time: 24820.9043s
	iters: 4900, epoch: 1 | loss: 1.5207452
	speed: 0.3331s/iter; left time: 24790.8633s
	iters: 5000, epoch: 1 | loss: 1.5807031
	speed: 0.3331s/iter; left time: 24755.6937s
	iters: 5100, epoch: 1 | loss: 1.4121540
	speed: 0.3327s/iter; left time: 24694.0322s
	iters: 5200, epoch: 1 | loss: 1.6105487
	speed: 0.3331s/iter; left time: 24691.6794s
	iters: 5300, epoch: 1 | loss: 1.4384573
	speed: 0.3330s/iter; left time: 24648.4478s
	iters: 5400, epoch: 1 | loss: 1.5870053
	speed: 0.3331s/iter; left time: 24626.0565s
	iters: 5500, epoch: 1 | loss: 1.6381377
	speed: 0.3332s/iter; left time: 24597.6436s
	iters: 5600, epoch: 1 | loss: 1.6373821
	speed: 0.3331s/iter; left time: 24553.6855s
	iters: 5700, epoch: 1 | loss: 1.7794269
	speed: 0.3333s/iter; left time: 24538.3293s
	iters: 5800, epoch: 1 | loss: 1.4774237
	speed: 0.3330s/iter; left time: 24484.1915s
	iters: 5900, epoch: 1 | loss: 1.5735633
	speed: 0.3331s/iter; left time: 24458.2824s
	iters: 6000, epoch: 1 | loss: 1.5834184
	speed: 0.3331s/iter; left time: 24420.9546s
	iters: 6100, epoch: 1 | loss: 1.6733534
	speed: 0.3330s/iter; left time: 24385.6794s
	iters: 6200, epoch: 1 | loss: 1.4886298
	speed: 0.3332s/iter; left time: 24360.4294s
	iters: 6300, epoch: 1 | loss: 1.6540761
	speed: 0.3328s/iter; left time: 24301.6501s
	iters: 6400, epoch: 1 | loss: 1.6349680
	speed: 0.3323s/iter; left time: 24233.1703s
	iters: 6500, epoch: 1 | loss: 1.5136349
	speed: 0.3332s/iter; left time: 24262.1276s
	iters: 6600, epoch: 1 | loss: 1.5903811
	speed: 0.3330s/iter; left time: 24214.3612s
	iters: 6700, epoch: 1 | loss: 1.5832169
	speed: 0.3331s/iter; left time: 24187.9919s
	iters: 6800, epoch: 1 | loss: 1.6516134
	speed: 0.3331s/iter; left time: 24159.1277s
	iters: 6900, epoch: 1 | loss: 1.5113305
	speed: 0.3323s/iter; left time: 24064.8142s
	iters: 7000, epoch: 1 | loss: 1.5579106
	speed: 0.3323s/iter; left time: 24035.2872s
	iters: 7100, epoch: 1 | loss: 1.6834036
	speed: 0.3322s/iter; left time: 23991.5986s
	iters: 7200, epoch: 1 | loss: 1.6992986
	speed: 0.3322s/iter; left time: 23957.0421s
	iters: 7300, epoch: 1 | loss: 1.5273042
	speed: 0.3326s/iter; left time: 23950.5951s
	iters: 7400, epoch: 1 | loss: 1.6623392
	speed: 0.3330s/iter; left time: 23951.7733s
	iters: 7500, epoch: 1 | loss: 1.4675785
	speed: 0.3332s/iter; left time: 23929.9090s
	iters: 7600, epoch: 1 | loss: 1.7190913
	speed: 0.3331s/iter; left time: 23887.9173s
	iters: 7700, epoch: 1 | loss: 1.4961091
	speed: 0.3331s/iter; left time: 23859.0911s
	iters: 7800, epoch: 1 | loss: 1.8422025
	speed: 0.3332s/iter; left time: 23831.9691s
	iters: 7900, epoch: 1 | loss: 1.5916510
	speed: 0.3330s/iter; left time: 23784.7071s
Epoch: 1 cost time: 2641.9279952049255
Epoch: 1, Steps: 7932 | Train Loss: 1.5790055 Vali Loss: 1.6040763 Test Loss: 1.7852601
Validation loss decreased (inf --> 1.604076).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.5401218
	speed: 10.1864s/iter; left time: 726177.2426s
	iters: 200, epoch: 2 | loss: 1.4834740
	speed: 0.3326s/iter; left time: 23677.2241s
	iters: 300, epoch: 2 | loss: 1.5749992
	speed: 0.3332s/iter; left time: 23688.2635s
	iters: 400, epoch: 2 | loss: 1.6739999
	speed: 0.3333s/iter; left time: 23659.3861s
	iters: 500, epoch: 2 | loss: 1.6256901
	speed: 0.3332s/iter; left time: 23619.6945s
	iters: 600, epoch: 2 | loss: 1.6829603
	speed: 0.3327s/iter; left time: 23551.4198s
	iters: 700, epoch: 2 | loss: 1.6121988
	speed: 0.3332s/iter; left time: 23555.0941s
	iters: 800, epoch: 2 | loss: 1.5237041
	speed: 0.3335s/iter; left time: 23544.6617s
	iters: 900, epoch: 2 | loss: 1.6281888
	speed: 0.3327s/iter; left time: 23449.6610s
	iters: 1000, epoch: 2 | loss: 1.4730556
	speed: 0.3324s/iter; left time: 23400.2297s
	iters: 1100, epoch: 2 | loss: 1.4236772
	speed: 0.3325s/iter; left time: 23367.6324s
	iters: 1200, epoch: 2 | loss: 1.5522105
	speed: 0.3324s/iter; left time: 23330.6906s
	iters: 1300, epoch: 2 | loss: 1.7562129
	speed: 0.3337s/iter; left time: 23386.9371s
	iters: 1400, epoch: 2 | loss: 1.5388454
	speed: 0.3336s/iter; left time: 23349.5538s
	iters: 1500, epoch: 2 | loss: 1.7093518
	speed: 0.3336s/iter; left time: 23312.6202s
	iters: 1600, epoch: 2 | loss: 1.7062646
	speed: 0.3335s/iter; left time: 23272.8972s
	iters: 1700, epoch: 2 | loss: 1.5286013
	speed: 0.3329s/iter; left time: 23198.6290s
	iters: 1800, epoch: 2 | loss: 1.5199748
	speed: 0.3325s/iter; left time: 23141.8089s
	iters: 1900, epoch: 2 | loss: 1.5982516
	speed: 0.3325s/iter; left time: 23103.8315s
	iters: 2000, epoch: 2 | loss: 1.7930906
	speed: 0.3324s/iter; left time: 23068.0854s
	iters: 2100, epoch: 2 | loss: 1.7615464
	speed: 0.3326s/iter; left time: 23042.0927s
	iters: 2200, epoch: 2 | loss: 1.6360062
	speed: 0.3328s/iter; left time: 23026.5084s
	iters: 2300, epoch: 2 | loss: 1.7491492
	speed: 0.3325s/iter; left time: 22974.8855s
	iters: 2400, epoch: 2 | loss: 1.5711150
	speed: 0.3326s/iter; left time: 22944.3382s
	iters: 2500, epoch: 2 | loss: 1.4281218
	speed: 0.3324s/iter; left time: 22897.8435s
	iters: 2600, epoch: 2 | loss: 1.6330382
	speed: 0.3325s/iter; left time: 22872.6070s
	iters: 2700, epoch: 2 | loss: 1.7208377
	speed: 0.3324s/iter; left time: 22833.1407s
	iters: 2800, epoch: 2 | loss: 1.6358519
	speed: 0.3324s/iter; left time: 22796.9233s
	iters: 2900, epoch: 2 | loss: 1.5530174
	speed: 0.3325s/iter; left time: 22770.8275s
	iters: 3000, epoch: 2 | loss: 1.5979451
	speed: 0.3323s/iter; left time: 22727.7126s
	iters: 3100, epoch: 2 | loss: 1.6019973
	speed: 0.3325s/iter; left time: 22705.5627s
	iters: 3200, epoch: 2 | loss: 1.4395375
	speed: 0.3323s/iter; left time: 22661.4068s
	iters: 3300, epoch: 2 | loss: 1.5657498
	speed: 0.3324s/iter; left time: 22629.9042s
	iters: 3400, epoch: 2 | loss: 1.4904132
	speed: 0.3325s/iter; left time: 22603.2822s
	iters: 3500, epoch: 2 | loss: 1.5572016
	speed: 0.3324s/iter; left time: 22563.7025s
	iters: 3600, epoch: 2 | loss: 1.6451335
	speed: 0.3325s/iter; left time: 22541.7736s
	iters: 3700, epoch: 2 | loss: 1.6588281
	speed: 0.3324s/iter; left time: 22497.9690s
	iters: 3800, epoch: 2 | loss: 1.3162063
	speed: 0.3324s/iter; left time: 22466.3324s
	iters: 3900, epoch: 2 | loss: 1.3663534
	speed: 0.3325s/iter; left time: 22440.0360s
	iters: 4000, epoch: 2 | loss: 1.7880269
	speed: 0.3335s/iter; left time: 22477.4241s
	iters: 4100, epoch: 2 | loss: 1.6429760
	speed: 0.3336s/iter; left time: 22450.4438s
	iters: 4200, epoch: 2 | loss: 1.5984380
	speed: 0.3335s/iter; left time: 22410.7546s
	iters: 4300, epoch: 2 | loss: 1.6429955
	speed: 0.3337s/iter; left time: 22384.5320s
	iters: 4400, epoch: 2 | loss: 1.5403118
	speed: 0.3337s/iter; left time: 22355.8205s
	iters: 4500, epoch: 2 | loss: 1.6155338
	speed: 0.3336s/iter; left time: 22314.5202s
	iters: 4600, epoch: 2 | loss: 1.7072297
	speed: 0.3336s/iter; left time: 22279.5387s
	iters: 4700, epoch: 2 | loss: 1.6263343
	speed: 0.3337s/iter; left time: 22251.9093s
	iters: 4800, epoch: 2 | loss: 1.4631952
	speed: 0.3334s/iter; left time: 22198.4045s
	iters: 4900, epoch: 2 | loss: 1.4820863
	speed: 0.3325s/iter; left time: 22106.3189s
	iters: 5000, epoch: 2 | loss: 1.3685285
	speed: 0.3323s/iter; left time: 22063.5078s
	iters: 5100, epoch: 2 | loss: 1.3274386
	speed: 0.3325s/iter; left time: 22039.1400s
	iters: 5200, epoch: 2 | loss: 1.5674964
	speed: 0.3325s/iter; left time: 22009.6636s
	iters: 5300, epoch: 2 | loss: 1.6283120
	speed: 0.3332s/iter; left time: 22022.4615s
	iters: 5400, epoch: 2 | loss: 1.4958193
	speed: 0.3337s/iter; left time: 22022.4140s
	iters: 5500, epoch: 2 | loss: 1.6192178
	speed: 0.3335s/iter; left time: 21974.4390s
	iters: 5600, epoch: 2 | loss: 1.5421610
	speed: 0.3336s/iter; left time: 21948.5761s
	iters: 5700, epoch: 2 | loss: 1.6109962
	speed: 0.3337s/iter; left time: 21920.9733s
	iters: 5800, epoch: 2 | loss: 1.4747173
	speed: 0.3336s/iter; left time: 21877.8305s
	iters: 5900, epoch: 2 | loss: 1.7128112
	speed: 0.3337s/iter; left time: 21852.6278s
	iters: 6000, epoch: 2 | loss: 1.4772480
	speed: 0.3335s/iter; left time: 21808.2114s
	iters: 6100, epoch: 2 | loss: 1.5451926
	speed: 0.3335s/iter; left time: 21777.1128s
	iters: 6200, epoch: 2 | loss: 1.5783874
	speed: 0.3337s/iter; left time: 21754.7686s
	iters: 6300, epoch: 2 | loss: 1.5337505
	speed: 0.3336s/iter; left time: 21710.7617s
	iters: 6400, epoch: 2 | loss: 1.6763854
	speed: 0.3336s/iter; left time: 21681.9460s
	iters: 6500, epoch: 2 | loss: 1.4620402
	speed: 0.3336s/iter; left time: 21646.6846s
	iters: 6600, epoch: 2 | loss: 1.4587349
	speed: 0.3335s/iter; left time: 21609.3989s
	iters: 6700, epoch: 2 | loss: 1.5451967
	speed: 0.3337s/iter; left time: 21584.0237s
	iters: 6800, epoch: 2 | loss: 1.5127152
	speed: 0.3334s/iter; left time: 21531.3873s
	iters: 6900, epoch: 2 | loss: 1.6167152
	speed: 0.3324s/iter; left time: 21438.4047s
	iters: 7000, epoch: 2 | loss: 1.6973054
	speed: 0.3326s/iter; left time: 21415.7748s
	iters: 7100, epoch: 2 | loss: 1.5338728
	speed: 0.3323s/iter; left time: 21365.8067s
	iters: 7200, epoch: 2 | loss: 1.6385396
	speed: 0.3325s/iter; left time: 21340.2767s
	iters: 7300, epoch: 2 | loss: 1.7817497
	speed: 0.3326s/iter; left time: 21316.2720s
	iters: 7400, epoch: 2 | loss: 1.4056916
	speed: 0.3336s/iter; left time: 21344.8634s
	iters: 7500, epoch: 2 | loss: 1.5525678
	speed: 0.3337s/iter; left time: 21320.4218s
	iters: 7600, epoch: 2 | loss: 1.4051393
	speed: 0.3335s/iter; left time: 21275.3208s
	iters: 7700, epoch: 2 | loss: 1.4825622
	speed: 0.3336s/iter; left time: 21245.5195s
	iters: 7800, epoch: 2 | loss: 1.8562721
	speed: 0.3335s/iter; left time: 21205.9496s
	iters: 7900, epoch: 2 | loss: 1.6609122
	speed: 0.3336s/iter; left time: 21178.5118s
Epoch: 2 cost time: 2642.26380443573
Epoch: 2, Steps: 7932 | Train Loss: 1.5869278 Vali Loss: 1.6044431 Test Loss: 1.7806842
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.4956871
	speed: 10.2243s/iter; left time: 647778.3791s
	iters: 200, epoch: 3 | loss: 1.5458180
	speed: 0.3330s/iter; left time: 21065.7312s
	iters: 300, epoch: 3 | loss: 1.5126870
	speed: 0.3327s/iter; left time: 21013.6645s
	iters: 400, epoch: 3 | loss: 1.5297492
	speed: 0.3336s/iter; left time: 21034.5306s
	iters: 500, epoch: 3 | loss: 1.6060941
	speed: 0.3334s/iter; left time: 20989.8819s
	iters: 600, epoch: 3 | loss: 1.5478458
	speed: 0.3335s/iter; left time: 20965.9177s
	iters: 700, epoch: 3 | loss: 1.7391733
	speed: 0.3334s/iter; left time: 20924.0356s
	iters: 800, epoch: 3 | loss: 1.5968654
	speed: 0.3328s/iter; left time: 20852.7645s
	iters: 900, epoch: 3 | loss: 1.6404412
	speed: 0.3325s/iter; left time: 20803.2563s
	iters: 1000, epoch: 3 | loss: 1.5356928
	speed: 0.3325s/iter; left time: 20766.7801s
	iters: 1100, epoch: 3 | loss: 1.4043370
	speed: 0.3325s/iter; left time: 20733.8979s
	iters: 1200, epoch: 3 | loss: 1.4863396
	speed: 0.3328s/iter; left time: 20716.0780s
	iters: 1300, epoch: 3 | loss: 1.5970478
	speed: 0.3330s/iter; left time: 20698.3143s
	iters: 1400, epoch: 3 | loss: 1.6014320
	speed: 0.3337s/iter; left time: 20709.2429s
	iters: 1500, epoch: 3 | loss: 1.6724057
	speed: 0.3336s/iter; left time: 20666.0216s
	iters: 1600, epoch: 3 | loss: 1.6770526
	speed: 0.3336s/iter; left time: 20633.5906s
	iters: 1700, epoch: 3 | loss: 1.4870689
	speed: 0.3337s/iter; left time: 20607.0228s
	iters: 1800, epoch: 3 | loss: 1.5046474
	speed: 0.3336s/iter; left time: 20570.8974s
	iters: 1900, epoch: 3 | loss: 1.7234191
	speed: 0.3336s/iter; left time: 20532.8811s
	iters: 2000, epoch: 3 | loss: 1.7225283
	speed: 0.3329s/iter; left time: 20460.9852s
	iters: 2100, epoch: 3 | loss: 1.5525956
	speed: 0.3329s/iter; left time: 20422.9370s
	iters: 2200, epoch: 3 | loss: 1.4591779
	speed: 0.3337s/iter; left time: 20443.4529s
	iters: 2300, epoch: 3 | loss: 1.6569695
	speed: 0.3337s/iter; left time: 20407.5935s
	iters: 2400, epoch: 3 | loss: 1.5787355
	speed: 0.3337s/iter; left time: 20373.4694s
	iters: 2500, epoch: 3 | loss: 1.5025855
	speed: 0.3337s/iter; left time: 20339.5956s
	iters: 2600, epoch: 3 | loss: 1.6376032
	speed: 0.3333s/iter; left time: 20282.6649s
	iters: 2700, epoch: 3 | loss: 1.5295786
	speed: 0.3325s/iter; left time: 20204.1126s
	iters: 2800, epoch: 3 | loss: 1.5033498
	speed: 0.3325s/iter; left time: 20168.4486s
	iters: 2900, epoch: 3 | loss: 1.7483625
	speed: 0.3325s/iter; left time: 20136.9251s
	iters: 3000, epoch: 3 | loss: 1.4783158
	speed: 0.3326s/iter; left time: 20109.7560s
	iters: 3100, epoch: 3 | loss: 1.4642433
	speed: 0.3325s/iter; left time: 20070.4099s
	iters: 3200, epoch: 3 | loss: 1.4694668
	speed: 0.3327s/iter; left time: 20044.5770s
	iters: 3300, epoch: 3 | loss: 1.4147263
	speed: 0.3325s/iter; left time: 20000.5540s
	iters: 3400, epoch: 3 | loss: 1.5496737
	speed: 0.3326s/iter; left time: 19975.8089s
	iters: 3500, epoch: 3 | loss: 1.5334111
	speed: 0.3337s/iter; left time: 20004.9046s
	iters: 3600, epoch: 3 | loss: 1.6199242
	speed: 0.3337s/iter; left time: 19971.8406s
	iters: 3700, epoch: 3 | loss: 1.5154871
	speed: 0.3334s/iter; left time: 19920.5939s
	iters: 3800, epoch: 3 | loss: 1.7127247
	speed: 0.3332s/iter; left time: 19878.0123s
	iters: 3900, epoch: 3 | loss: 1.5606717
	speed: 0.3331s/iter; left time: 19839.0356s
	iters: 4000, epoch: 3 | loss: 1.5773300
	speed: 0.3333s/iter; left time: 19818.4685s
	iters: 4100, epoch: 3 | loss: 1.5851121
	speed: 0.3330s/iter; left time: 19764.9213s
	iters: 4200, epoch: 3 | loss: 1.5643064
	speed: 0.3325s/iter; left time: 19704.2681s
	iters: 4300, epoch: 3 | loss: 1.4250715
	speed: 0.3324s/iter; left time: 19661.5311s
	iters: 4400, epoch: 3 | loss: 1.8202389
	speed: 0.3328s/iter; left time: 19657.1118s
	iters: 4500, epoch: 3 | loss: 1.6418120
	speed: 0.3332s/iter; left time: 19644.2954s
	iters: 4600, epoch: 3 | loss: 1.5330287
	speed: 0.3331s/iter; left time: 19606.3765s
	iters: 4700, epoch: 3 | loss: 1.6104678
	speed: 0.3332s/iter; left time: 19580.3710s
	iters: 4800, epoch: 3 | loss: 1.6204693
	speed: 0.3332s/iter; left time: 19546.5921s
	iters: 4900, epoch: 3 | loss: 1.6293278
	speed: 0.3332s/iter; left time: 19511.5276s
	iters: 5000, epoch: 3 | loss: 1.5506015
	speed: 0.3332s/iter; left time: 19478.3430s
	iters: 5100, epoch: 3 | loss: 1.6114900
	speed: 0.3331s/iter; left time: 19440.4540s
	iters: 5200, epoch: 3 | loss: 1.5159174
	speed: 0.3337s/iter; left time: 19440.7447s
	iters: 5300, epoch: 3 | loss: 1.6111937
	speed: 0.3337s/iter; left time: 19406.6805s
	iters: 5400, epoch: 3 | loss: 1.4942838
	speed: 0.3337s/iter; left time: 19370.8644s
	iters: 5500, epoch: 3 | loss: 1.7409805
	speed: 0.3337s/iter; left time: 19341.6220s
	iters: 5600, epoch: 3 | loss: 1.5934896
	speed: 0.3336s/iter; left time: 19299.9250s
	iters: 5700, epoch: 3 | loss: 1.6744459
	speed: 0.3334s/iter; left time: 19257.9656s
	iters: 5800, epoch: 3 | loss: 1.6076959
	speed: 0.3326s/iter; left time: 19177.5883s
	iters: 5900, epoch: 3 | loss: 1.5423968
	speed: 0.3324s/iter; left time: 19132.7331s
	iters: 6000, epoch: 3 | loss: 1.6557202
	speed: 0.3326s/iter; left time: 19109.2845s
	iters: 6100, epoch: 3 | loss: 1.5085986
	speed: 0.3325s/iter; left time: 19071.7924s
	iters: 6200, epoch: 3 | loss: 1.6966501
	speed: 0.3333s/iter; left time: 19083.3511s
	iters: 6300, epoch: 3 | loss: 1.6382771
	speed: 0.3338s/iter; left time: 19079.2999s
	iters: 6400, epoch: 3 | loss: 1.5947831
	speed: 0.3336s/iter; left time: 19033.8232s
	iters: 6500, epoch: 3 | loss: 1.4891822
	speed: 0.3337s/iter; left time: 19004.2203s
	iters: 6600, epoch: 3 | loss: 1.7386583
	speed: 0.3337s/iter; left time: 18972.3482s
	iters: 6700, epoch: 3 | loss: 1.6925893
	speed: 0.3337s/iter; left time: 18937.1292s
	iters: 6800, epoch: 3 | loss: 1.6659733
	speed: 0.3338s/iter; left time: 18909.4122s
	iters: 6900, epoch: 3 | loss: 1.6427681
	speed: 0.3335s/iter; left time: 18860.5807s
	iters: 7000, epoch: 3 | loss: 1.7525076
	speed: 0.3336s/iter; left time: 18834.8441s
	iters: 7100, epoch: 3 | loss: 1.4191563
	speed: 0.3338s/iter; left time: 18809.7210s
	iters: 7200, epoch: 3 | loss: 1.5660776
	speed: 0.3335s/iter; left time: 18763.9429s
	iters: 7300, epoch: 3 | loss: 1.5974929
	speed: 0.3338s/iter; left time: 18743.3009s
	iters: 7400, epoch: 3 | loss: 1.5792844
	speed: 0.3336s/iter; left time: 18701.7945s
	iters: 7500, epoch: 3 | loss: 1.6093862
	speed: 0.3336s/iter; left time: 18666.2959s
	iters: 7600, epoch: 3 | loss: 1.4869787
	speed: 0.3336s/iter; left time: 18632.8816s
	iters: 7700, epoch: 3 | loss: 1.5895791
	speed: 0.3336s/iter; left time: 18600.5347s
	iters: 7800, epoch: 3 | loss: 1.5413971
	speed: 0.3337s/iter; left time: 18571.1648s
	iters: 7900, epoch: 3 | loss: 1.7195159
	speed: 0.3326s/iter; left time: 18478.0570s
Epoch: 3 cost time: 2643.771544933319
Epoch: 3, Steps: 7932 | Train Loss: 1.5865469 Vali Loss: 1.6028477 Test Loss: 1.7862917
Validation loss decreased (1.604076 --> 1.602848).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6700689
	speed: 10.2121s/iter; left time: 566008.0948s
	iters: 200, epoch: 4 | loss: 1.6464245
	speed: 0.3326s/iter; left time: 18402.8892s
	iters: 300, epoch: 4 | loss: 1.3829223
	speed: 0.3327s/iter; left time: 18373.0228s
	iters: 400, epoch: 4 | loss: 1.6172808
	speed: 0.3330s/iter; left time: 18355.9325s
	iters: 500, epoch: 4 | loss: 1.6060288
	speed: 0.3330s/iter; left time: 18324.3274s
	iters: 600, epoch: 4 | loss: 1.6119268
	speed: 0.3332s/iter; left time: 18298.2948s
	iters: 700, epoch: 4 | loss: 1.4917046
	speed: 0.3330s/iter; left time: 18256.6974s
	iters: 800, epoch: 4 | loss: 1.4936802
	speed: 0.3330s/iter; left time: 18224.8886s
	iters: 900, epoch: 4 | loss: 1.6566684
	speed: 0.3331s/iter; left time: 18196.5438s
	iters: 1000, epoch: 4 | loss: 1.8454661
	speed: 0.3331s/iter; left time: 18160.6642s
	iters: 1100, epoch: 4 | loss: 1.7493720
	speed: 0.3332s/iter; left time: 18131.7437s
	iters: 1200, epoch: 4 | loss: 1.6175500
	speed: 0.3331s/iter; left time: 18096.8962s
	iters: 1300, epoch: 4 | loss: 1.7223763
	speed: 0.3331s/iter; left time: 18063.6610s
	iters: 1400, epoch: 4 | loss: 1.6670616
	speed: 0.3332s/iter; left time: 18034.0147s
	iters: 1500, epoch: 4 | loss: 1.6271849
	speed: 0.3331s/iter; left time: 17994.3593s
	iters: 1600, epoch: 4 | loss: 1.5472572
	speed: 0.3331s/iter; left time: 17964.0823s
	iters: 1700, epoch: 4 | loss: 1.6302058
	speed: 0.3331s/iter; left time: 17929.2671s
	iters: 1800, epoch: 4 | loss: 1.4613974
	speed: 0.3331s/iter; left time: 17893.6268s
	iters: 1900, epoch: 4 | loss: 1.5487357
	speed: 0.3328s/iter; left time: 17846.5874s
	iters: 2000, epoch: 4 | loss: 1.5703747
	speed: 0.3325s/iter; left time: 17795.8596s
	iters: 2100, epoch: 4 | loss: 1.4348234
	speed: 0.3324s/iter; left time: 17759.5434s
	iters: 2200, epoch: 4 | loss: 1.5154101
	speed: 0.3324s/iter; left time: 17724.7681s
	iters: 2300, epoch: 4 | loss: 1.4756521
	speed: 0.3323s/iter; left time: 17685.1837s
	iters: 2400, epoch: 4 | loss: 1.7661871
	speed: 0.3325s/iter; left time: 17664.1520s
	iters: 2500, epoch: 4 | loss: 1.6422526
	speed: 0.3324s/iter; left time: 17624.4928s
	iters: 2600, epoch: 4 | loss: 1.6292382
	speed: 0.3324s/iter; left time: 17590.7596s
	iters: 2700, epoch: 4 | loss: 1.4672376
	speed: 0.3325s/iter; left time: 17563.0591s
	iters: 2800, epoch: 4 | loss: 1.5574840
	speed: 0.3331s/iter; left time: 17564.4306s
	iters: 2900, epoch: 4 | loss: 1.5754620
	speed: 0.3332s/iter; left time: 17535.1952s
	iters: 3000, epoch: 4 | loss: 1.8271483
	speed: 0.3331s/iter; left time: 17495.3716s
	iters: 3100, epoch: 4 | loss: 1.7076088
	speed: 0.3324s/iter; left time: 17426.9973s
	iters: 3200, epoch: 4 | loss: 1.7213762
	speed: 0.3324s/iter; left time: 17394.1187s
	iters: 3300, epoch: 4 | loss: 1.6361538
	speed: 0.3323s/iter; left time: 17354.8024s
	iters: 3400, epoch: 4 | loss: 1.5271343
	speed: 0.3325s/iter; left time: 17331.7125s
	iters: 3500, epoch: 4 | loss: 1.6858062
	speed: 0.3323s/iter; left time: 17289.0454s
	iters: 3600, epoch: 4 | loss: 1.6331589
	speed: 0.3324s/iter; left time: 17261.4164s
	iters: 3700, epoch: 4 | loss: 1.5929552
	speed: 0.3325s/iter; left time: 17230.2396s
	iters: 3800, epoch: 4 | loss: 1.5628215
	speed: 0.3325s/iter; left time: 17200.0384s
	iters: 3900, epoch: 4 | loss: 1.7912817
	speed: 0.3324s/iter; left time: 17157.9167s
	iters: 4000, epoch: 4 | loss: 1.5787994
	speed: 0.3323s/iter; left time: 17124.3241s
	iters: 4100, epoch: 4 | loss: 1.5792147
	speed: 0.3323s/iter; left time: 17090.4684s
	iters: 4200, epoch: 4 | loss: 1.5402399
	speed: 0.3331s/iter; left time: 17093.8121s
	iters: 4300, epoch: 4 | loss: 1.4820794
	speed: 0.3331s/iter; left time: 17061.9555s
	iters: 4400, epoch: 4 | loss: 1.6891551
	speed: 0.3332s/iter; left time: 17035.3362s
	iters: 4500, epoch: 4 | loss: 1.4540406
	speed: 0.3331s/iter; left time: 16996.6048s
	iters: 4600, epoch: 4 | loss: 1.5028532
	speed: 0.3326s/iter; left time: 16938.2084s
	iters: 4700, epoch: 4 | loss: 1.5468115
	speed: 0.3324s/iter; left time: 16893.5244s
	iters: 4800, epoch: 4 | loss: 1.5651270
	speed: 0.3324s/iter; left time: 16860.9040s
	iters: 4900, epoch: 4 | loss: 1.7725904
	speed: 0.3324s/iter; left time: 16827.8305s
	iters: 5000, epoch: 4 | loss: 1.5839806
	speed: 0.3324s/iter; left time: 16794.7567s
	iters: 5100, epoch: 4 | loss: 1.5865663
	speed: 0.3323s/iter; left time: 16757.5778s
	iters: 5200, epoch: 4 | loss: 1.5444140
	speed: 0.3324s/iter; left time: 16728.9322s
	iters: 5300, epoch: 4 | loss: 1.5694346
	speed: 0.3324s/iter; left time: 16692.6736s
	iters: 5400, epoch: 4 | loss: 1.5960788
	speed: 0.3324s/iter; left time: 16660.3805s
	iters: 5500, epoch: 4 | loss: 1.5879867
	speed: 0.3323s/iter; left time: 16624.7869s
	iters: 5600, epoch: 4 | loss: 1.7236977
	speed: 0.3323s/iter; left time: 16592.5066s
	iters: 5700, epoch: 4 | loss: 1.6749824
	speed: 0.3324s/iter; left time: 16561.2771s
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems07_all_filter10.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems07_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 5800, epoch: 4 | loss: 1.3519557
	speed: 0.3324s/iter; left time: 16529.9026s
	iters: 5900, epoch: 4 | loss: 1.5598873
	speed: 0.3324s/iter; left time: 16495.9917s
	iters: 6000, epoch: 4 | loss: 1.6238599
	speed: 0.3325s/iter; left time: 16466.4493s
	iters: 6100, epoch: 4 | loss: 1.4686668
	speed: 0.3322s/iter; left time: 16420.3479s
	iters: 6200, epoch: 4 | loss: 1.4665278
	speed: 0.3330s/iter; left time: 16426.5750s
	iters: 6300, epoch: 4 | loss: 1.4628209
	speed: 0.3330s/iter; left time: 16392.8675s
	iters: 6400, epoch: 4 | loss: 1.4439063
	speed: 0.3332s/iter; left time: 16366.1845s
	iters: 6500, epoch: 4 | loss: 1.5253665
	speed: 0.3324s/iter; left time: 16295.3280s
	iters: 6600, epoch: 4 | loss: 1.4524509
	speed: 0.3324s/iter; left time: 16260.9585s
	iters: 6700, epoch: 4 | loss: 1.5837308
	speed: 0.3330s/iter; left time: 16258.1138s
	iters: 6800, epoch: 4 | loss: 1.6979741
	speed: 0.3331s/iter; left time: 16228.0675s
	iters: 6900, epoch: 4 | loss: 1.5193856
	speed: 0.3331s/iter; left time: 16198.9087s
	iters: 7000, epoch: 4 | loss: 1.7300267
	speed: 0.3332s/iter; left time: 16168.8128s
	iters: 7100, epoch: 4 | loss: 1.2253991
	speed: 0.3331s/iter; left time: 16131.2077s
	iters: 7200, epoch: 4 | loss: 1.6219387
	speed: 0.3332s/iter; left time: 16102.6018s
	iters: 7300, epoch: 4 | loss: 1.4544227
	speed: 0.3332s/iter; left time: 16066.8097s
	iters: 7400, epoch: 4 | loss: 1.6805240
	speed: 0.3331s/iter; left time: 16032.1584s
	iters: 7500, epoch: 4 | loss: 1.7078017
	speed: 0.3331s/iter; left time: 15998.4134s
	iters: 7600, epoch: 4 | loss: 1.4640372
	speed: 0.3331s/iter; left time: 15962.0808s
	iters: 7700, epoch: 4 | loss: 1.5813961
	speed: 0.3331s/iter; left time: 15929.4278s
	iters: 7800, epoch: 4 | loss: 1.5953257
	speed: 0.3331s/iter; left time: 15895.3956s
	iters: 7900, epoch: 4 | loss: 1.4771192
	speed: 0.3331s/iter; left time: 15864.9131s
Epoch: 4 cost time: 2640.100561618805
Epoch: 4, Steps: 7932 | Train Loss: 1.5864662 Vali Loss: 1.6030712 Test Loss: 1.7888299
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.4775653
	speed: 10.2116s/iter; left time: 484980.8688s
	iters: 200, epoch: 5 | loss: 1.5220785
	speed: 0.3329s/iter; left time: 15777.3780s
	iters: 300, epoch: 5 | loss: 1.7641671
	speed: 0.3333s/iter; left time: 15762.9803s
	iters: 400, epoch: 5 | loss: 1.6024525
	speed: 0.3334s/iter; left time: 15734.6421s
	iters: 500, epoch: 5 | loss: 1.6296068
	speed: 0.3337s/iter; left time: 15715.6127s
	iters: 600, epoch: 5 | loss: 1.5109634
	speed: 0.3329s/iter; left time: 15644.6505s
	iters: 700, epoch: 5 | loss: 1.6550109
	speed: 0.3329s/iter; left time: 15609.8407s
	iters: 800, epoch: 5 | loss: 1.5176481
	speed: 0.3336s/iter; left time: 15608.3580s
	iters: 900, epoch: 5 | loss: 1.7284497
	speed: 0.3327s/iter; left time: 15532.9218s
	iters: 1000, epoch: 5 | loss: 1.3404417
	speed: 0.3327s/iter; left time: 15499.9163s
	iters: 1100, epoch: 5 | loss: 1.5816022
	speed: 0.3325s/iter; left time: 15460.4949s
	iters: 1200, epoch: 5 | loss: 1.5698432
	speed: 0.3327s/iter; left time: 15435.9719s
	iters: 1300, epoch: 5 | loss: 1.5544490
	speed: 0.3332s/iter; left time: 15422.8922s
	iters: 1400, epoch: 5 | loss: 1.7938243
	speed: 0.3326s/iter; left time: 15361.7654s
	iters: 1500, epoch: 5 | loss: 1.4737053
	speed: 0.3328s/iter; left time: 15340.1212s
	iters: 1600, epoch: 5 | loss: 1.8405993
	speed: 0.3326s/iter; left time: 15294.9994s
	iters: 1700, epoch: 5 | loss: 1.8073354
	speed: 0.3326s/iter; left time: 15263.3622s
	iters: 1800, epoch: 5 | loss: 1.6133510
	speed: 0.3327s/iter; left time: 15233.7413s
	iters: 1900, epoch: 5 | loss: 1.5974406
	speed: 0.3325s/iter; left time: 15194.7066s
	iters: 2000, epoch: 5 | loss: 1.6017733
	speed: 0.3327s/iter; left time: 15166.9964s
	iters: 2100, epoch: 5 | loss: 1.6356658
	speed: 0.3326s/iter; left time: 15131.1418s
	iters: 2200, epoch: 5 | loss: 1.7917221
	speed: 0.3332s/iter; left time: 15127.1352s
	iters: 2300, epoch: 5 | loss: 1.5263889
	speed: 0.3336s/iter; left time: 15111.9914s
	iters: 2400, epoch: 5 | loss: 1.4709002
	speed: 0.3336s/iter; left time: 15077.2618s
	iters: 2500, epoch: 5 | loss: 1.5000827
	speed: 0.3337s/iter; left time: 15046.1705s
	iters: 2600, epoch: 5 | loss: 1.5507619
	speed: 0.3337s/iter; left time: 15012.2584s
	iters: 2700, epoch: 5 | loss: 1.5679235
	speed: 0.3336s/iter; left time: 14977.4079s
	iters: 2800, epoch: 5 | loss: 1.7365739
	speed: 0.3338s/iter; left time: 14953.4529s
	iters: 2900, epoch: 5 | loss: 1.6645037
	speed: 0.3327s/iter; left time: 14867.8188s
	iters: 3000, epoch: 5 | loss: 1.4799145
	speed: 0.3326s/iter; left time: 14831.0820s
	iters: 3100, epoch: 5 | loss: 1.5233221
	speed: 0.3329s/iter; left time: 14809.5977s
	iters: 3200, epoch: 5 | loss: 1.5123762
	speed: 0.3335s/iter; left time: 14807.0614s
	iters: 3300, epoch: 5 | loss: 1.4732755
	speed: 0.3338s/iter; left time: 14786.1256s
	iters: 3400, epoch: 5 | loss: 1.4608845
	speed: 0.3336s/iter; left time: 14744.0863s
	iters: 3500, epoch: 5 | loss: 1.7478423
	speed: 0.3337s/iter; left time: 14715.6570s
	iters: 3600, epoch: 5 | loss: 1.4686176
	speed: 0.3338s/iter; left time: 14683.3237s
	iters: 3700, epoch: 5 | loss: 1.6307485
	speed: 0.3338s/iter; left time: 14650.7241s
	iters: 3800, epoch: 5 | loss: 1.7277292
	speed: 0.3337s/iter; left time: 14613.2544s
	iters: 3900, epoch: 5 | loss: 1.6294791
	speed: 0.3336s/iter; left time: 14575.7920s
	iters: 4000, epoch: 5 | loss: 1.4841343
	speed: 0.3336s/iter; left time: 14542.4672s
	iters: 4100, epoch: 5 | loss: 1.4514041
	speed: 0.3337s/iter; left time: 14513.0858s
	iters: 4200, epoch: 5 | loss: 1.6100445
	speed: 0.3337s/iter; left time: 14478.2004s
	iters: 4300, epoch: 5 | loss: 1.5688894
	speed: 0.3337s/iter; left time: 14446.7223s
	iters: 4400, epoch: 5 | loss: 1.5930300
	speed: 0.3336s/iter; left time: 14408.2400s
	iters: 4500, epoch: 5 | loss: 1.8366753
	speed: 0.3337s/iter; left time: 14378.3340s
	iters: 4600, epoch: 5 | loss: 1.5927702
	speed: 0.3328s/iter; left time: 14307.6498s
	iters: 4700, epoch: 5 | loss: 1.4917557
	speed: 0.3324s/iter; left time: 14258.3312s
	iters: 4800, epoch: 5 | loss: 1.5519327
	speed: 0.3326s/iter; left time: 14230.9173s
	iters: 4900, epoch: 5 | loss: 1.5914270
	speed: 0.3326s/iter; left time: 14197.5786s
	iters: 5000, epoch: 5 | loss: 1.5288780
	speed: 0.3325s/iter; left time: 14160.7220s
	iters: 5100, epoch: 5 | loss: 1.6852436
	speed: 0.3330s/iter; left time: 14149.1209s
	iters: 5200, epoch: 5 | loss: 1.5306586
	speed: 0.3337s/iter; left time: 14147.2264s
	iters: 5300, epoch: 5 | loss: 1.6004468
	speed: 0.3336s/iter; left time: 14109.9467s
	iters: 5400, epoch: 5 | loss: 1.5687766
	speed: 0.3336s/iter; left time: 14076.2324s
	iters: 5500, epoch: 5 | loss: 1.4492946
	speed: 0.3336s/iter; left time: 14042.3970s
	iters: 5600, epoch: 5 | loss: 1.4721688
	speed: 0.3337s/iter; left time: 14013.2457s
	iters: 5700, epoch: 5 | loss: 1.5595648
	speed: 0.3336s/iter; left time: 13973.6636s
	iters: 5800, epoch: 5 | loss: 1.5772318
	speed: 0.3336s/iter; left time: 13943.6782s
	iters: 5900, epoch: 5 | loss: 1.6274348
	speed: 0.3336s/iter; left time: 13906.7869s
	iters: 6000, epoch: 5 | loss: 1.5650175
	speed: 0.3326s/iter; left time: 13832.5531s
	iters: 6100, epoch: 5 | loss: 1.7527038
	speed: 0.3326s/iter; left time: 13802.2320s
	iters: 6200, epoch: 5 | loss: 1.5901675
	speed: 0.3325s/iter; left time: 13762.8406s
	iters: 6300, epoch: 5 | loss: 1.5834097
	speed: 0.3326s/iter; left time: 13733.6180s
	iters: 6400, epoch: 5 | loss: 1.5302262
	speed: 0.3337s/iter; left time: 13745.8551s
	iters: 6500, epoch: 5 | loss: 1.5223893
	speed: 0.3336s/iter; left time: 13707.2139s
	iters: 6600, epoch: 5 | loss: 1.5371261
	speed: 0.3328s/iter; left time: 13642.4482s
	iters: 6700, epoch: 5 | loss: 1.7230488
	speed: 0.3325s/iter; left time: 13598.0650s
	iters: 6800, epoch: 5 | loss: 1.5073860
	speed: 0.3325s/iter; left time: 13564.5964s
	iters: 6900, epoch: 5 | loss: 1.5239091
	speed: 0.3326s/iter; left time: 13535.9178s
	iters: 7000, epoch: 5 | loss: 1.5754523
	speed: 0.3325s/iter; left time: 13498.8498s
	iters: 7100, epoch: 5 | loss: 1.5450975
	speed: 0.3326s/iter; left time: 13468.1489s
	iters: 7200, epoch: 5 | loss: 1.6057467
	speed: 0.3324s/iter; left time: 13428.3515s
	iters: 7300, epoch: 5 | loss: 1.6369029
	speed: 0.3326s/iter; left time: 13401.9238s
	iters: 7400, epoch: 5 | loss: 1.4872361
	speed: 0.3337s/iter; left time: 13412.7711s
	iters: 7500, epoch: 5 | loss: 1.5338863
	speed: 0.3337s/iter; left time: 13378.0593s
	iters: 7600, epoch: 5 | loss: 1.5087126
	speed: 0.3336s/iter; left time: 13342.3619s
	iters: 7700, epoch: 5 | loss: 1.5743458
	speed: 0.3336s/iter; left time: 13309.3989s
	iters: 7800, epoch: 5 | loss: 1.6344230
	speed: 0.3335s/iter; left time: 13271.7087s
	iters: 7900, epoch: 5 | loss: 1.5486546
	speed: 0.3337s/iter; left time: 13244.9823s
Epoch: 5 cost time: 2643.3768820762634
Epoch: 5, Steps: 7932 | Train Loss: 1.5864059 Vali Loss: 1.6034818 Test Loss: 1.7885931
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.7421644
	speed: 10.2320s/iter; left time: 404788.9075s
	iters: 200, epoch: 6 | loss: 1.6346655
	speed: 0.3331s/iter; left time: 13143.2289s
	iters: 300, epoch: 6 | loss: 1.6021749
	speed: 0.3329s/iter; left time: 13102.5768s
	iters: 400, epoch: 6 | loss: 1.5620729
	speed: 0.3330s/iter; left time: 13074.8723s
	iters: 500, epoch: 6 | loss: 1.3974279
	speed: 0.3332s/iter; left time: 13050.1473s
	iters: 600, epoch: 6 | loss: 1.6158035
	speed: 0.3335s/iter; left time: 13028.1470s
	iters: 700, epoch: 6 | loss: 1.5641221
	speed: 0.3335s/iter; left time: 12995.0275s
	iters: 800, epoch: 6 | loss: 1.4800191
	speed: 0.3328s/iter; left time: 12931.1269s
	iters: 900, epoch: 6 | loss: 1.5702100
	speed: 0.3326s/iter; left time: 12893.2776s
	iters: 1000, epoch: 6 | loss: 1.5715642
	speed: 0.3326s/iter; left time: 12860.2849s
	iters: 1100, epoch: 6 | loss: 1.5079775
	speed: 0.3326s/iter; left time: 12824.4016s
	iters: 1200, epoch: 6 | loss: 1.6062568
	speed: 0.3338s/iter; left time: 12836.8046s
	iters: 1300, epoch: 6 | loss: 1.4799248
	speed: 0.3335s/iter; left time: 12795.2434s
	iters: 1400, epoch: 6 | loss: 1.4552383
	speed: 0.3326s/iter; left time: 12724.5581s
	iters: 1500, epoch: 6 | loss: 1.6140749
	speed: 0.3326s/iter; left time: 12690.5682s
	iters: 1600, epoch: 6 | loss: 1.6456320
	speed: 0.3325s/iter; left time: 12656.1410s
	iters: 1700, epoch: 6 | loss: 1.5469135
	speed: 0.3328s/iter; left time: 12633.0276s
	iters: 1800, epoch: 6 | loss: 1.6080536
	speed: 0.3325s/iter; left time: 12589.9210s
	iters: 1900, epoch: 6 | loss: 1.8213681
	speed: 0.3327s/iter; left time: 12562.2029s
	iters: 2000, epoch: 6 | loss: 1.6735140
	speed: 0.3326s/iter; left time: 12527.3762s
	iters: 2100, epoch: 6 | loss: 1.6959711
	speed: 0.3335s/iter; left time: 12526.1972s
	iters: 2200, epoch: 6 | loss: 1.6001245
	speed: 0.3337s/iter; left time: 12498.9393s
	iters: 2300, epoch: 6 | loss: 1.6215969
	speed: 0.3336s/iter; left time: 12464.2023s
	iters: 2400, epoch: 6 | loss: 1.4262929
	speed: 0.3336s/iter; left time: 12430.8576s
	iters: 2500, epoch: 6 | loss: 1.4814882
	speed: 0.3337s/iter; left time: 12399.2877s
	iters: 2600, epoch: 6 | loss: 1.5981101
	speed: 0.3336s/iter; left time: 12361.9194s
	iters: 2700, epoch: 6 | loss: 1.5488050
	speed: 0.3335s/iter; left time: 12328.2406s
	iters: 2800, epoch: 6 | loss: 1.4495279
	speed: 0.3336s/iter; left time: 12297.2689s
	iters: 2900, epoch: 6 | loss: 1.5359023
	speed: 0.3336s/iter; left time: 12264.8118s
	iters: 3000, epoch: 6 | loss: 1.5772879
	speed: 0.3336s/iter; left time: 12231.6754s
	iters: 3100, epoch: 6 | loss: 1.6943952
	speed: 0.3336s/iter; left time: 12195.7982s
	iters: 3200, epoch: 6 | loss: 1.7189291
	speed: 0.3337s/iter; left time: 12165.2271s
	iters: 3300, epoch: 6 | loss: 1.6177014
	speed: 0.3337s/iter; left time: 12132.1585s
	iters: 3400, epoch: 6 | loss: 1.6191444
	speed: 0.3336s/iter; left time: 12096.4123s
	iters: 3500, epoch: 6 | loss: 1.6383597
	speed: 0.3337s/iter; left time: 12068.4376s
	iters: 3600, epoch: 6 | loss: 1.5626587
	speed: 0.3336s/iter; left time: 12029.7581s
	iters: 3700, epoch: 6 | loss: 1.5204965
	speed: 0.3336s/iter; left time: 11998.2548s
	iters: 3800, epoch: 6 | loss: 1.5126958
	speed: 0.3328s/iter; left time: 11932.7962s
	iters: 3900, epoch: 6 | loss: 1.6190447
	speed: 0.3324s/iter; left time: 11887.9117s
	iters: 4000, epoch: 6 | loss: 1.5311582
	speed: 0.3336s/iter; left time: 11894.8134s
	iters: 4100, epoch: 6 | loss: 1.6323674
	speed: 0.3336s/iter; left time: 11864.3824s
	iters: 4200, epoch: 6 | loss: 1.7164468
	speed: 0.3336s/iter; left time: 11831.1410s
	iters: 4300, epoch: 6 | loss: 1.5283442
	speed: 0.3337s/iter; left time: 11800.6768s
	iters: 4400, epoch: 6 | loss: 1.7516406
	speed: 0.3335s/iter; left time: 11760.9374s
	iters: 4500, epoch: 6 | loss: 1.4689050
	speed: 0.3337s/iter; left time: 11733.4502s
	iters: 4600, epoch: 6 | loss: 1.6119298
	speed: 0.3337s/iter; left time: 11698.5976s
	iters: 4700, epoch: 6 | loss: 1.5655887
	speed: 0.3337s/iter; left time: 11665.6983s
	iters: 4800, epoch: 6 | loss: 1.5858812
	speed: 0.3337s/iter; left time: 11632.0769s
	iters: 4900, epoch: 6 | loss: 1.6452507
	speed: 0.3336s/iter; left time: 11597.0563s
	iters: 5000, epoch: 6 | loss: 1.5624995
	speed: 0.3337s/iter; left time: 11566.1610s
	iters: 5100, epoch: 6 | loss: 1.6443419
	speed: 0.3336s/iter; left time: 11530.5881s
	iters: 5200, epoch: 6 | loss: 1.7243690
	speed: 0.3337s/iter; left time: 11500.6425s
	iters: 5300, epoch: 6 | loss: 1.7411549
	speed: 0.3336s/iter; left time: 11464.3532s
	iters: 5400, epoch: 6 | loss: 1.5113937
	speed: 0.3336s/iter; left time: 11430.3807s
	iters: 5500, epoch: 6 | loss: 1.6813325
	speed: 0.3337s/iter; left time: 11398.8691s
	iters: 5600, epoch: 6 | loss: 1.5449250
	speed: 0.3337s/iter; left time: 11365.3812s
	iters: 5700, epoch: 6 | loss: 1.4457582
	speed: 0.3336s/iter; left time: 11328.9623s
	iters: 5800, epoch: 6 | loss: 1.6896150
	speed: 0.3331s/iter; left time: 11280.2752s
	iters: 5900, epoch: 6 | loss: 1.5304370
	speed: 0.3337s/iter; left time: 11265.4275s
	iters: 6000, epoch: 6 | loss: 1.4317542
	speed: 0.3338s/iter; left time: 11236.2281s
	iters: 6100, epoch: 6 | loss: 1.5439510
	speed: 0.3337s/iter; left time: 11199.6941s
	iters: 6200, epoch: 6 | loss: 1.5149035
	speed: 0.3336s/iter; left time: 11162.8465s
	iters: 6300, epoch: 6 | loss: 1.4434326
	speed: 0.3337s/iter; left time: 11131.8670s
	iters: 6400, epoch: 6 | loss: 1.4647670
	speed: 0.3337s/iter; left time: 11100.2379s
	iters: 6500, epoch: 6 | loss: 1.6111233
	speed: 0.3336s/iter; left time: 11062.5957s
	iters: 6600, epoch: 6 | loss: 1.5481869
	speed: 0.3337s/iter; left time: 11031.4341s
	iters: 6700, epoch: 6 | loss: 1.7190164
	speed: 0.3336s/iter; left time: 10995.7589s
	iters: 6800, epoch: 6 | loss: 1.8158835
	speed: 0.3336s/iter; left time: 10962.4696s
	iters: 6900, epoch: 6 | loss: 1.6871916
	speed: 0.3336s/iter; left time: 10930.4145s
	iters: 7000, epoch: 6 | loss: 1.7879888
	speed: 0.3336s/iter; left time: 10894.7680s
	iters: 7100, epoch: 6 | loss: 1.5260552
	speed: 0.3330s/iter; left time: 10842.3270s
	iters: 7200, epoch: 6 | loss: 1.5283558
	speed: 0.3324s/iter; left time: 10790.2196s
	iters: 7300, epoch: 6 | loss: 1.5947834
	speed: 0.3325s/iter; left time: 10761.6095s
	iters: 7400, epoch: 6 | loss: 1.4785956
	speed: 0.3328s/iter; left time: 10735.3517s
	iters: 7500, epoch: 6 | loss: 1.6013217
	speed: 0.3324s/iter; left time: 10691.7309s
	iters: 7600, epoch: 6 | loss: 1.4673064
	speed: 0.3326s/iter; left time: 10663.6629s
	iters: 7700, epoch: 6 | loss: 1.5670044
	speed: 0.3324s/iter; left time: 10624.5444s
	iters: 7800, epoch: 6 | loss: 1.7020288
	speed: 0.3326s/iter; left time: 10596.8099s
	iters: 7900, epoch: 6 | loss: 1.6576444
	speed: 0.3327s/iter; left time: 10565.3441s
Epoch: 6 cost time: 2644.489906311035
Epoch: 6, Steps: 7932 | Train Loss: 1.5864059 Vali Loss: 1.6032262 Test Loss: 1.7872560
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems07_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap365_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 352801
test shape: (35280, 1, 336, 1613) (35280, 1, 336, 1613)
test shape: (35280, 336, 1613) (35280, 336, 1613)
