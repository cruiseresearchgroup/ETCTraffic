Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems04_all_common_flow.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems04_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164128
val 247789
test 247787
	iters: 100, epoch: 1 | loss: 1.1247808
	speed: 0.1699s/iter; left time: 123540.9315s
	iters: 200, epoch: 1 | loss: 0.8445044
	speed: 0.1605s/iter; left time: 116741.5484s
	iters: 300, epoch: 1 | loss: 0.9247975
	speed: 0.1605s/iter; left time: 116675.8445s
	iters: 400, epoch: 1 | loss: 0.9147996
	speed: 0.1604s/iter; left time: 116580.4817s
	iters: 500, epoch: 1 | loss: 0.7765760
	speed: 0.1596s/iter; left time: 115994.8803s
	iters: 600, epoch: 1 | loss: 0.8655343
	speed: 0.1590s/iter; left time: 115551.7945s
	iters: 700, epoch: 1 | loss: 0.7997149
	speed: 0.1587s/iter; left time: 115331.7845s
	iters: 800, epoch: 1 | loss: 0.7560354
	speed: 0.1600s/iter; left time: 116251.1466s
	iters: 900, epoch: 1 | loss: 0.8924223
	speed: 0.1589s/iter; left time: 115472.5792s
	iters: 1000, epoch: 1 | loss: 0.7933636
	speed: 0.1612s/iter; left time: 117092.9170s
	iters: 1100, epoch: 1 | loss: 0.6876815
	speed: 0.1619s/iter; left time: 117564.5163s
	iters: 1200, epoch: 1 | loss: 0.6759344
	speed: 0.1610s/iter; left time: 116917.1830s
	iters: 1300, epoch: 1 | loss: 0.6661888
	speed: 0.1604s/iter; left time: 116490.7169s
	iters: 1400, epoch: 1 | loss: 0.7532620
	speed: 0.1614s/iter; left time: 117187.0187s
	iters: 1500, epoch: 1 | loss: 0.7856489
	speed: 0.1608s/iter; left time: 116738.9230s
	iters: 1600, epoch: 1 | loss: 0.7419258
	speed: 0.1611s/iter; left time: 116923.8097s
	iters: 1700, epoch: 1 | loss: 0.6402205
	speed: 0.1616s/iter; left time: 117245.6007s
	iters: 1800, epoch: 1 | loss: 0.7429225
	speed: 0.1600s/iter; left time: 116094.9542s
	iters: 1900, epoch: 1 | loss: 0.6982813
	speed: 0.1613s/iter; left time: 117005.7796s
	iters: 2000, epoch: 1 | loss: 0.6894780
	speed: 0.1608s/iter; left time: 116662.1522s
	iters: 2100, epoch: 1 | loss: 0.6326261
	speed: 0.1610s/iter; left time: 116786.6165s
	iters: 2200, epoch: 1 | loss: 0.8055753
	speed: 0.1612s/iter; left time: 116882.4251s
	iters: 2300, epoch: 1 | loss: 0.6455132
	speed: 0.1608s/iter; left time: 116591.2527s
	iters: 2400, epoch: 1 | loss: 0.9415393
	speed: 0.1597s/iter; left time: 115815.5108s
	iters: 2500, epoch: 1 | loss: 0.6562088
	speed: 0.1606s/iter; left time: 116397.4913s
	iters: 2600, epoch: 1 | loss: 0.6384766
	speed: 0.1595s/iter; left time: 115599.3487s
	iters: 2700, epoch: 1 | loss: 0.6428232
	speed: 0.1605s/iter; left time: 116331.1543s
	iters: 2800, epoch: 1 | loss: 0.6401547
	speed: 0.1604s/iter; left time: 116227.9678s
	iters: 2900, epoch: 1 | loss: 0.6631446
	speed: 0.1598s/iter; left time: 115772.2492s
	iters: 3000, epoch: 1 | loss: 0.5980310
	speed: 0.1598s/iter; left time: 115790.0207s
	iters: 3100, epoch: 1 | loss: 0.6650729
	speed: 0.1612s/iter; left time: 116722.2788s
	iters: 3200, epoch: 1 | loss: 0.6249245
	speed: 0.1614s/iter; left time: 116900.9136s
	iters: 3300, epoch: 1 | loss: 0.6916530
	speed: 0.1603s/iter; left time: 116095.8504s
	iters: 3400, epoch: 1 | loss: 0.6394862
	speed: 0.1609s/iter; left time: 116524.6815s
	iters: 3500, epoch: 1 | loss: 0.7415394
	speed: 0.1598s/iter; left time: 115660.8712s
	iters: 3600, epoch: 1 | loss: 0.7160352
	speed: 0.1599s/iter; left time: 115753.7563s
Epoch: 1 cost time: 584.9087677001953
Epoch: 1, Steps: 3637 | Train Loss: 0.7700338 Vali Loss: 1.1302807 Test Loss: 1.0572926
Validation loss decreased (inf --> 1.130281).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7090989
	speed: 4.2600s/iter; left time: 3082817.0908s
	iters: 200, epoch: 2 | loss: 0.6707857
	speed: 0.1525s/iter; left time: 110361.2079s
	iters: 300, epoch: 2 | loss: 0.5856081
	speed: 0.1527s/iter; left time: 110489.6460s
	iters: 400, epoch: 2 | loss: 0.7828485
	speed: 0.1527s/iter; left time: 110477.5332s
	iters: 500, epoch: 2 | loss: 0.5716115
	speed: 0.1522s/iter; left time: 110096.7765s
	iters: 600, epoch: 2 | loss: 0.5702332
	speed: 0.1522s/iter; left time: 110100.1614s
	iters: 700, epoch: 2 | loss: 0.6992260
	speed: 0.1523s/iter; left time: 110133.6632s
	iters: 800, epoch: 2 | loss: 0.8643221
	speed: 0.1525s/iter; left time: 110271.1032s
	iters: 900, epoch: 2 | loss: 0.6203932
	speed: 0.1525s/iter; left time: 110214.1898s
	iters: 1000, epoch: 2 | loss: 0.6056039
	speed: 0.1527s/iter; left time: 110340.8849s
	iters: 1100, epoch: 2 | loss: 0.6683068
	speed: 0.1564s/iter; left time: 113046.1633s
	iters: 1200, epoch: 2 | loss: 0.6803882
	speed: 0.1568s/iter; left time: 113321.3201s
	iters: 1300, epoch: 2 | loss: 0.8003067
	speed: 0.1565s/iter; left time: 113041.7516s
	iters: 1400, epoch: 2 | loss: 0.6536856
	speed: 0.1576s/iter; left time: 113835.5710s
	iters: 1500, epoch: 2 | loss: 0.5514574
	speed: 0.1574s/iter; left time: 113693.6577s
	iters: 1600, epoch: 2 | loss: 0.6389174
	speed: 0.1570s/iter; left time: 113347.2946s
	iters: 1700, epoch: 2 | loss: 0.6434948
	speed: 0.1575s/iter; left time: 113708.0523s
	iters: 1800, epoch: 2 | loss: 0.5579507
	speed: 0.1570s/iter; left time: 113357.4316s
	iters: 1900, epoch: 2 | loss: 0.6050254
	speed: 0.1584s/iter; left time: 114335.7669s
	iters: 2000, epoch: 2 | loss: 0.5388390
	speed: 0.1613s/iter; left time: 116445.6115s
	iters: 2100, epoch: 2 | loss: 0.5553342
	speed: 0.1623s/iter; left time: 117096.0122s
	iters: 2200, epoch: 2 | loss: 0.6615513
	speed: 0.1618s/iter; left time: 116778.5957s
	iters: 2300, epoch: 2 | loss: 0.6232991
	speed: 0.1620s/iter; left time: 116882.7552s
	iters: 2400, epoch: 2 | loss: 0.6777707
	speed: 0.1616s/iter; left time: 116600.7337s
	iters: 2500, epoch: 2 | loss: 0.5675774
	speed: 0.1622s/iter; left time: 116991.3373s
	iters: 2600, epoch: 2 | loss: 0.6265513
	speed: 0.1624s/iter; left time: 117113.5829s
	iters: 2700, epoch: 2 | loss: 0.6742676
	speed: 0.1592s/iter; left time: 114815.1280s
	iters: 2800, epoch: 2 | loss: 0.6927513
	speed: 0.1559s/iter; left time: 112422.3724s
	iters: 2900, epoch: 2 | loss: 0.6654913
	speed: 0.1557s/iter; left time: 112237.8437s
	iters: 3000, epoch: 2 | loss: 0.5496380
	speed: 0.1551s/iter; left time: 111781.2752s
	iters: 3100, epoch: 2 | loss: 0.5981460
	speed: 0.1520s/iter; left time: 109520.5729s
	iters: 3200, epoch: 2 | loss: 0.5746483
	speed: 0.1526s/iter; left time: 109990.7900s
	iters: 3300, epoch: 2 | loss: 0.6154185
	speed: 0.1523s/iter; left time: 109710.5706s
	iters: 3400, epoch: 2 | loss: 0.5686462
	speed: 0.1523s/iter; left time: 109714.4326s
	iters: 3500, epoch: 2 | loss: 0.5456311
	speed: 0.1530s/iter; left time: 110181.2719s
	iters: 3600, epoch: 2 | loss: 0.5999326
	speed: 0.1525s/iter; left time: 109827.9684s
Epoch: 2 cost time: 567.7634060382843
Epoch: 2, Steps: 3637 | Train Loss: 0.6380405 Vali Loss: 1.0533174 Test Loss: 1.0026047
Validation loss decreased (1.130281 --> 1.053317).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5329701
	speed: 4.2553s/iter; left time: 3063943.8435s
	iters: 200, epoch: 3 | loss: 0.5650440
	speed: 0.1526s/iter; left time: 109834.7085s
	iters: 300, epoch: 3 | loss: 0.5159449
	speed: 0.1559s/iter; left time: 112196.2021s
	iters: 400, epoch: 3 | loss: 0.5626869
	speed: 0.1523s/iter; left time: 109586.6820s
	iters: 500, epoch: 3 | loss: 0.6026800
	speed: 0.1527s/iter; left time: 109885.7989s
	iters: 600, epoch: 3 | loss: 0.6780553
	speed: 0.1534s/iter; left time: 110396.2449s
	iters: 700, epoch: 3 | loss: 0.5810410
	speed: 0.1520s/iter; left time: 109373.3364s
	iters: 800, epoch: 3 | loss: 0.5443116
	speed: 0.1520s/iter; left time: 109360.2018s
	iters: 900, epoch: 3 | loss: 0.6510954
	speed: 0.1525s/iter; left time: 109673.9981s
	iters: 1000, epoch: 3 | loss: 0.6380870
	speed: 0.1529s/iter; left time: 109922.8283s
	iters: 1100, epoch: 3 | loss: 0.6093797
	speed: 0.1522s/iter; left time: 109452.5468s
	iters: 1200, epoch: 3 | loss: 0.6638425
	speed: 0.1525s/iter; left time: 109668.0364s
	iters: 1300, epoch: 3 | loss: 0.6846719
	speed: 0.1525s/iter; left time: 109586.0185s
	iters: 1400, epoch: 3 | loss: 0.6040789
	speed: 0.1523s/iter; left time: 109465.5991s
	iters: 1500, epoch: 3 | loss: 0.5398832
	speed: 0.1527s/iter; left time: 109701.5340s
	iters: 1600, epoch: 3 | loss: 0.5827332
	speed: 0.1529s/iter; left time: 109849.0304s
	iters: 1700, epoch: 3 | loss: 0.5284942
	speed: 0.1522s/iter; left time: 109336.3867s
	iters: 1800, epoch: 3 | loss: 0.5300345
	speed: 0.1527s/iter; left time: 109674.2204s
	iters: 1900, epoch: 3 | loss: 0.5277767
	speed: 0.1533s/iter; left time: 110122.3481s
	iters: 2000, epoch: 3 | loss: 0.6291304
	speed: 0.1525s/iter; left time: 109546.2083s
	iters: 2100, epoch: 3 | loss: 0.5255432
	speed: 0.1527s/iter; left time: 109627.6237s
	iters: 2200, epoch: 3 | loss: 0.5354361
	speed: 0.1528s/iter; left time: 109702.7954s
	iters: 2300, epoch: 3 | loss: 0.4824164
	speed: 0.1521s/iter; left time: 109160.7649s
	iters: 2400, epoch: 3 | loss: 0.5263427
	speed: 0.1524s/iter; left time: 109346.6814s
	iters: 2500, epoch: 3 | loss: 0.4759336
	speed: 0.1530s/iter; left time: 109828.3353s
	iters: 2600, epoch: 3 | loss: 0.5156005
	speed: 0.1525s/iter; left time: 109414.1394s
	iters: 2700, epoch: 3 | loss: 0.5103648
	speed: 0.1521s/iter; left time: 109111.0204s
	iters: 2800, epoch: 3 | loss: 0.5251549
	speed: 0.1525s/iter; left time: 109422.4438s
	iters: 2900, epoch: 3 | loss: 0.4936566
	speed: 0.1525s/iter; left time: 109381.8525s
	iters: 3000, epoch: 3 | loss: 0.4987418
	speed: 0.1523s/iter; left time: 109235.2543s
	iters: 3100, epoch: 3 | loss: 0.5652834
	speed: 0.1526s/iter; left time: 109427.3105s
	iters: 3200, epoch: 3 | loss: 0.5201715
	speed: 0.1524s/iter; left time: 109239.6608s
	iters: 3300, epoch: 3 | loss: 0.5283684
	speed: 0.1522s/iter; left time: 109080.1526s
	iters: 3400, epoch: 3 | loss: 0.5170228
	speed: 0.1523s/iter; left time: 109157.6008s
	iters: 3500, epoch: 3 | loss: 0.4510283
	speed: 0.1529s/iter; left time: 109568.3161s
	iters: 3600, epoch: 3 | loss: 0.5013939
	speed: 0.1522s/iter; left time: 109030.4884s
Epoch: 3 cost time: 555.7661516666412
Epoch: 3, Steps: 3637 | Train Loss: 0.5565608 Vali Loss: 0.9594772 Test Loss: 0.8948714
Validation loss decreased (1.053317 --> 0.959477).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4970183
	speed: 4.2643s/iter; left time: 3054888.9735s
	iters: 200, epoch: 4 | loss: 0.5043334
	speed: 0.1592s/iter; left time: 113999.7084s
	iters: 300, epoch: 4 | loss: 0.5105207
	speed: 0.1595s/iter; left time: 114215.3496s
	iters: 400, epoch: 4 | loss: 0.5314810
	speed: 0.1585s/iter; left time: 113535.5626s
	iters: 500, epoch: 4 | loss: 0.4683135
	speed: 0.1588s/iter; left time: 113704.0489s
	iters: 600, epoch: 4 | loss: 0.5848503
	speed: 0.1583s/iter; left time: 113312.4386s
	iters: 700, epoch: 4 | loss: 0.5155246
	speed: 0.1579s/iter; left time: 113053.6690s
	iters: 800, epoch: 4 | loss: 0.4862911
	speed: 0.1592s/iter; left time: 113952.0129s
	iters: 900, epoch: 4 | loss: 0.6057407
	speed: 0.1609s/iter; left time: 115161.7835s
	iters: 1000, epoch: 4 | loss: 0.4628353
	speed: 0.1588s/iter; left time: 113627.1702s
	iters: 1100, epoch: 4 | loss: 0.5367327
	speed: 0.1601s/iter; left time: 114540.0741s
	iters: 1200, epoch: 4 | loss: 0.4653442
	speed: 0.1585s/iter; left time: 113382.0543s
	iters: 1300, epoch: 4 | loss: 0.4442987
	speed: 0.1591s/iter; left time: 113801.7451s
	iters: 1400, epoch: 4 | loss: 0.4893243
	speed: 0.1594s/iter; left time: 114018.9604s
	iters: 1500, epoch: 4 | loss: 0.5746583
	speed: 0.1588s/iter; left time: 113571.0202s
	iters: 1600, epoch: 4 | loss: 0.5597245
	speed: 0.1588s/iter; left time: 113554.3399s
	iters: 1700, epoch: 4 | loss: 0.3950670
	speed: 0.1593s/iter; left time: 113895.9680s
	iters: 1800, epoch: 4 | loss: 0.4666128
	speed: 0.1579s/iter; left time: 112838.6693s
	iters: 1900, epoch: 4 | loss: 0.4581435
	speed: 0.1584s/iter; left time: 113164.9732s
	iters: 2000, epoch: 4 | loss: 0.6126928
	speed: 0.1581s/iter; left time: 112962.0678s
	iters: 2100, epoch: 4 | loss: 0.4713854
	speed: 0.1590s/iter; left time: 113564.2709s
	iters: 2200, epoch: 4 | loss: 0.5410046
	speed: 0.1581s/iter; left time: 112908.6695s
	iters: 2300, epoch: 4 | loss: 0.3993558
	speed: 0.1589s/iter; left time: 113506.4424s
	iters: 2400, epoch: 4 | loss: 0.4525319
	speed: 0.1583s/iter; left time: 113058.7281s
	iters: 2500, epoch: 4 | loss: 0.4094032
	speed: 0.1598s/iter; left time: 114117.0339s
	iters: 2600, epoch: 4 | loss: 0.6230682
	speed: 0.1598s/iter; left time: 114104.6541s
	iters: 2700, epoch: 4 | loss: 0.4418610
	speed: 0.1593s/iter; left time: 113714.2576s
	iters: 2800, epoch: 4 | loss: 0.4556340
	speed: 0.1595s/iter; left time: 113859.4941s
	iters: 2900, epoch: 4 | loss: 0.5591810
	speed: 0.1599s/iter; left time: 114108.4054s
	iters: 3000, epoch: 4 | loss: 0.4282051
	speed: 0.1594s/iter; left time: 113716.3166s
	iters: 3100, epoch: 4 | loss: 0.4149122
	speed: 0.1599s/iter; left time: 114077.4291s
	iters: 3200, epoch: 4 | loss: 0.4731523
	speed: 0.1596s/iter; left time: 113809.1314s
	iters: 3300, epoch: 4 | loss: 0.4541876
	speed: 0.1593s/iter; left time: 113641.4546s
	iters: 3400, epoch: 4 | loss: 0.4578931
	speed: 0.1591s/iter; left time: 113481.9793s
	iters: 3500, epoch: 4 | loss: 0.4614576
	speed: 0.1589s/iter; left time: 113285.7261s
	iters: 3600, epoch: 4 | loss: 0.5549039
	speed: 0.1597s/iter; left time: 113854.8950s
Epoch: 4 cost time: 579.4951355457306
Epoch: 4, Steps: 3637 | Train Loss: 0.4951826 Vali Loss: 0.9460439 Test Loss: 0.9087898
Validation loss decreased (0.959477 --> 0.946044).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5069835
	speed: 4.2725s/iter; left time: 3045268.2258s
	iters: 200, epoch: 5 | loss: 0.4900282
	speed: 0.1601s/iter; left time: 114078.9938s
	iters: 300, epoch: 5 | loss: 0.4670024
	speed: 0.1594s/iter; left time: 113609.1836s
	iters: 400, epoch: 5 | loss: 0.4052123
	speed: 0.1596s/iter; left time: 113736.8852s
	iters: 500, epoch: 5 | loss: 0.3865434
	speed: 0.1575s/iter; left time: 112189.3424s
	iters: 600, epoch: 5 | loss: 0.4036286
	speed: 0.1588s/iter; left time: 113134.9836s
	iters: 700, epoch: 5 | loss: 0.4903860
	speed: 0.1594s/iter; left time: 113543.9510s
	iters: 800, epoch: 5 | loss: 0.4129976
	speed: 0.1604s/iter; left time: 114193.9119s
	iters: 900, epoch: 5 | loss: 0.3905894
	speed: 0.1602s/iter; left time: 114056.0807s
	iters: 1000, epoch: 5 | loss: 0.5499268
	speed: 0.1605s/iter; left time: 114221.8143s
	iters: 1100, epoch: 5 | loss: 0.5892469
	speed: 0.1603s/iter; left time: 114111.1500s
	iters: 1200, epoch: 5 | loss: 0.5409223
	speed: 0.1576s/iter; left time: 112143.2818s
	iters: 1300, epoch: 5 | loss: 0.4920411
	speed: 0.1581s/iter; left time: 112521.7894s
	iters: 1400, epoch: 5 | loss: 0.4943427
	speed: 0.1602s/iter; left time: 113991.0781s
	iters: 1500, epoch: 5 | loss: 0.4511116
	speed: 0.1601s/iter; left time: 113891.7569s
	iters: 1600, epoch: 5 | loss: 0.4922017
	speed: 0.1602s/iter; left time: 113975.6621s
	iters: 1700, epoch: 5 | loss: 0.3914719
	speed: 0.1598s/iter; left time: 113616.8981s
	iters: 1800, epoch: 5 | loss: 0.4625513
	speed: 0.1605s/iter; left time: 114144.2275s
	iters: 1900, epoch: 5 | loss: 0.4012653
	speed: 0.1609s/iter; left time: 114360.6720s
	iters: 2000, epoch: 5 | loss: 0.4452406
	speed: 0.1599s/iter; left time: 113683.0885s
	iters: 2100, epoch: 5 | loss: 0.3676552
	speed: 0.1602s/iter; left time: 113858.9871s
	iters: 2200, epoch: 5 | loss: 0.4478331
	speed: 0.1577s/iter; left time: 112086.2927s
	iters: 2300, epoch: 5 | loss: 0.4246091
	speed: 0.1581s/iter; left time: 112322.2351s
	iters: 2400, epoch: 5 | loss: 0.4724618
	speed: 0.1577s/iter; left time: 112020.8355s
	iters: 2500, epoch: 5 | loss: 0.4629323
	speed: 0.1591s/iter; left time: 112981.7274s
	iters: 2600, epoch: 5 | loss: 0.3945470
	speed: 0.1589s/iter; left time: 112831.1686s
	iters: 2700, epoch: 5 | loss: 0.4334500
	speed: 0.1582s/iter; left time: 112336.6853s
	iters: 2800, epoch: 5 | loss: 0.4267993
	speed: 0.1586s/iter; left time: 112590.7062s
	iters: 2900, epoch: 5 | loss: 0.4687189
	speed: 0.1593s/iter; left time: 113104.6436s
	iters: 3000, epoch: 5 | loss: 0.4232296
	speed: 0.1586s/iter; left time: 112605.7934s
	iters: 3100, epoch: 5 | loss: 0.4325268
	speed: 0.1579s/iter; left time: 112082.8083s
	iters: 3200, epoch: 5 | loss: 0.4251620
	speed: 0.1580s/iter; left time: 112130.2901s
	iters: 3300, epoch: 5 | loss: 0.4243135
	speed: 0.1586s/iter; left time: 112500.0241s
	iters: 3400, epoch: 5 | loss: 0.4064614
	speed: 0.1603s/iter; left time: 113703.1642s
	iters: 3500, epoch: 5 | loss: 0.4877442
	speed: 0.1598s/iter; left time: 113337.9712s
	iters: 3600, epoch: 5 | loss: 0.4204186
	speed: 0.1599s/iter; left time: 113422.5686s
Epoch: 5 cost time: 579.9990065097809
Epoch: 5, Steps: 3637 | Train Loss: 0.4624034 Vali Loss: 1.0419165 Test Loss: 0.9344366
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.4400291
	speed: 4.2586s/iter; left time: 3019857.1724s
	iters: 200, epoch: 6 | loss: 0.4330971
	speed: 0.1527s/iter; left time: 108300.4333s
	iters: 300, epoch: 6 | loss: 0.6759672
	speed: 0.1526s/iter; left time: 108183.7861s
	iters: 400, epoch: 6 | loss: 0.4942685
	speed: 0.1522s/iter; left time: 107909.8790s
	iters: 500, epoch: 6 | loss: 0.4510719
	speed: 0.1523s/iter; left time: 107963.2927s
	iters: 600, epoch: 6 | loss: 0.3713154
	speed: 0.1525s/iter; left time: 108030.6608s
	iters: 700, epoch: 6 | loss: 0.3903991
	speed: 0.1542s/iter; left time: 109236.5828s
	iters: 800, epoch: 6 | loss: 0.4614408
	speed: 0.1688s/iter; left time: 119553.0133s
	iters: 900, epoch: 6 | loss: 0.4482854
	speed: 0.1688s/iter; left time: 119563.8429s
	iters: 1000, epoch: 6 | loss: 0.3915648
	speed: 0.1682s/iter; left time: 119137.2743s
	iters: 1100, epoch: 6 | loss: 0.4424005
	speed: 0.1688s/iter; left time: 119526.0513s
	iters: 1200, epoch: 6 | loss: 0.4368684
	speed: 0.1586s/iter; left time: 112260.4119s
	iters: 1300, epoch: 6 | loss: 0.3951957
	speed: 0.1536s/iter; left time: 108713.8305s
	iters: 1400, epoch: 6 | loss: 0.4838649
	speed: 0.1522s/iter; left time: 107748.2227s
	iters: 1500, epoch: 6 | loss: 0.4141327
	speed: 0.1524s/iter; left time: 107842.3827s
	iters: 1600, epoch: 6 | loss: 0.4641200
	speed: 0.1520s/iter; left time: 107570.6837s
	iters: 1700, epoch: 6 | loss: 0.4185800
	speed: 0.1525s/iter; left time: 107885.3166s
	iters: 1800, epoch: 6 | loss: 0.3822247
	speed: 0.1526s/iter; left time: 107922.6448s
	iters: 1900, epoch: 6 | loss: 0.4443094
	speed: 0.1523s/iter; left time: 107722.8829s
	iters: 2000, epoch: 6 | loss: 0.3938760
	speed: 0.1523s/iter; left time: 107702.6537s
	iters: 2100, epoch: 6 | loss: 0.4907726
	speed: 0.1525s/iter; left time: 107846.0876s
	iters: 2200, epoch: 6 | loss: 0.4279156
	speed: 0.1520s/iter; left time: 107491.1441s
	iters: 2300, epoch: 6 | loss: 0.4113264
	speed: 0.1525s/iter; left time: 107771.4569s
	iters: 2400, epoch: 6 | loss: 0.3663602
	speed: 0.1525s/iter; left time: 107792.0756s
	iters: 2500, epoch: 6 | loss: 0.3769580
	speed: 0.1524s/iter; left time: 107703.0703s
	iters: 2600, epoch: 6 | loss: 0.4471400
	speed: 0.1523s/iter; left time: 107641.9373s
	iters: 2700, epoch: 6 | loss: 0.4632637
	speed: 0.1525s/iter; left time: 107763.7756s
	iters: 2800, epoch: 6 | loss: 0.4338884
	speed: 0.1526s/iter; left time: 107831.3564s
	iters: 2900, epoch: 6 | loss: 0.4399589
	speed: 0.1519s/iter; left time: 107286.8075s
	iters: 3000, epoch: 6 | loss: 0.4627620
	speed: 0.1522s/iter; left time: 107517.9219s
	iters: 3100, epoch: 6 | loss: 0.4696625
	speed: 0.1521s/iter; left time: 107419.0739s
	iters: 3200, epoch: 6 | loss: 0.3838513
	speed: 0.1521s/iter; left time: 107351.1041s
	iters: 3300, epoch: 6 | loss: 0.4407531
	speed: 0.1523s/iter; left time: 107532.6962s
	iters: 3400, epoch: 6 | loss: 0.4817547
	speed: 0.1523s/iter; left time: 107485.5725s
	iters: 3500, epoch: 6 | loss: 0.4385767
	speed: 0.1520s/iter; left time: 107247.2165s
	iters: 3600, epoch: 6 | loss: 0.4520507
	speed: 0.1522s/iter; left time: 107376.6907s
Epoch: 6 cost time: 562.2256944179535
Epoch: 6, Steps: 3637 | Train Loss: 0.4381913 Vali Loss: 0.9920846 Test Loss: 0.9020425
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 0.3790994
	speed: 4.2740s/iter; left time: 3015183.9045s
	iters: 200, epoch: 7 | loss: 0.3771764
	speed: 0.1590s/iter; left time: 112181.6131s
	iters: 300, epoch: 7 | loss: 0.4789810
	speed: 0.1601s/iter; left time: 112928.9579s
	iters: 400, epoch: 7 | loss: 0.4165860
	speed: 0.1593s/iter; left time: 112359.1045s
	iters: 500, epoch: 7 | loss: 0.3874066
	speed: 0.1579s/iter; left time: 111350.0063s
	iters: 600, epoch: 7 | loss: 0.3763869
	speed: 0.1585s/iter; left time: 111711.3099s
	iters: 700, epoch: 7 | loss: 0.4921730
	speed: 0.1596s/iter; left time: 112517.0051s
	iters: 800, epoch: 7 | loss: 0.3805347
	speed: 0.1595s/iter; left time: 112419.8661s
	iters: 900, epoch: 7 | loss: 0.3871298
	speed: 0.1576s/iter; left time: 111091.9495s
	iters: 1000, epoch: 7 | loss: 0.4245397
	speed: 0.1581s/iter; left time: 111377.7995s
	iters: 1100, epoch: 7 | loss: 0.4240580
	speed: 0.1589s/iter; left time: 111918.2984s
	iters: 1200, epoch: 7 | loss: 0.4080450
	speed: 0.1592s/iter; left time: 112166.1837s
	iters: 1300, epoch: 7 | loss: 0.4374061
	speed: 0.1581s/iter; left time: 111374.4687s
	iters: 1400, epoch: 7 | loss: 0.3340906
	speed: 0.1590s/iter; left time: 111989.7979s
	iters: 1500, epoch: 7 | loss: 0.4032379
	speed: 0.1586s/iter; left time: 111684.6704s
	iters: 1600, epoch: 7 | loss: 0.4542057
	speed: 0.1588s/iter; left time: 111814.3551s
	iters: 1700, epoch: 7 | loss: 0.4801435
	speed: 0.1590s/iter; left time: 111951.1173s
	iters: 1800, epoch: 7 | loss: 0.3973061
	speed: 0.1590s/iter; left time: 111889.0725s
	iters: 1900, epoch: 7 | loss: 0.4594075
	speed: 0.1585s/iter; left time: 111505.6787s
	iters: 2000, epoch: 7 | loss: 0.3927369
	speed: 0.1596s/iter; left time: 112290.5310s
	iters: 2100, epoch: 7 | loss: 0.3747317
	speed: 0.1603s/iter; left time: 112786.1430s
	iters: 2200, epoch: 7 | loss: 0.4153420
	speed: 0.1605s/iter; left time: 112885.5759s
	iters: 2300, epoch: 7 | loss: 0.4822880
	speed: 0.1591s/iter; left time: 111908.9667s
	iters: 2400, epoch: 7 | loss: 0.3788248
	speed: 0.1553s/iter; left time: 109195.3864s
	iters: 2500, epoch: 7 | loss: 0.4398344
	speed: 0.1590s/iter; left time: 111757.2281s
	iters: 2600, epoch: 7 | loss: 0.4078468
	speed: 0.1590s/iter; left time: 111739.4371s
	iters: 2700, epoch: 7 | loss: 0.3427136
	speed: 0.1596s/iter; left time: 112151.4694s
	iters: 2800, epoch: 7 | loss: 0.4544362
	speed: 0.1603s/iter; left time: 112632.5720s
	iters: 2900, epoch: 7 | loss: 0.3539383
	speed: 0.1595s/iter; left time: 112111.8191s
	iters: 3000, epoch: 7 | loss: 0.4558005
	speed: 0.1588s/iter; left time: 111601.4630s
	iters: 3100, epoch: 7 | loss: 0.4511401
	speed: 0.1590s/iter; left time: 111661.3867s
	iters: 3200, epoch: 7 | loss: 0.3826677
	speed: 0.1585s/iter; left time: 111344.5771s
	iters: 3300, epoch: 7 | loss: 0.3872734
	speed: 0.1594s/iter; left time: 111947.4489s
	iters: 3400, epoch: 7 | loss: 0.3341879
	speed: 0.1600s/iter; left time: 112343.1288s
	iters: 3500, epoch: 7 | loss: 0.4108633
	speed: 0.1594s/iter; left time: 111908.5089s
	iters: 3600, epoch: 7 | loss: 0.3776934
	speed: 0.1595s/iter; left time: 111957.0516s
Epoch: 7 cost time: 579.1307582855225
Epoch: 7, Steps: 3637 | Train Loss: 0.4223251 Vali Loss: 1.0287935 Test Loss: 0.8830709
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 8 | loss: 0.3769262
	speed: 4.2726s/iter; left time: 2998673.0462s
	iters: 200, epoch: 8 | loss: 0.3538863
	speed: 0.1521s/iter; left time: 106703.7187s
	iters: 300, epoch: 8 | loss: 0.4535620
	speed: 0.1530s/iter; left time: 107325.2648s
	iters: 400, epoch: 8 | loss: 0.3603454
	speed: 0.1556s/iter; left time: 109141.9292s
	iters: 500, epoch: 8 | loss: 0.4249278
	speed: 0.1553s/iter; left time: 108950.0038s
	iters: 600, epoch: 8 | loss: 0.4215499
	speed: 0.1592s/iter; left time: 111664.4288s
	iters: 700, epoch: 8 | loss: 0.4175980
	speed: 0.1590s/iter; left time: 111463.8603s
	iters: 800, epoch: 8 | loss: 0.3471532
	speed: 0.1585s/iter; left time: 111165.3638s
	iters: 900, epoch: 8 | loss: 0.4861273
	speed: 0.1594s/iter; left time: 111745.8796s
	iters: 1000, epoch: 8 | loss: 0.5600775
	speed: 0.1596s/iter; left time: 111836.5339s
	iters: 1100, epoch: 8 | loss: 0.5116049
	speed: 0.1601s/iter; left time: 112171.8649s
	iters: 1200, epoch: 8 | loss: 0.3719975
	speed: 0.1594s/iter; left time: 111717.7422s
	iters: 1300, epoch: 8 | loss: 0.4199739
	speed: 0.1596s/iter; left time: 111790.0632s
	iters: 1400, epoch: 8 | loss: 0.4379927
	speed: 0.1584s/iter; left time: 110955.5469s
	iters: 1500, epoch: 8 | loss: 0.3583297
	speed: 0.1589s/iter; left time: 111296.0462s
	iters: 1600, epoch: 8 | loss: 0.3787133
	speed: 0.1593s/iter; left time: 111563.4442s
	iters: 1700, epoch: 8 | loss: 0.3361860
	speed: 0.1607s/iter; left time: 112530.3531s
	iters: 1800, epoch: 8 | loss: 0.4405662
	speed: 0.1600s/iter; left time: 112039.4477s
	iters: 1900, epoch: 8 | loss: 0.4298309
	speed: 0.1600s/iter; left time: 111990.1866s
	iters: 2000, epoch: 8 | loss: 0.3583025
	speed: 0.1591s/iter; left time: 111347.1454s
	iters: 2100, epoch: 8 | loss: 0.4008896
	speed: 0.1591s/iter; left time: 111330.8970s
	iters: 2200, epoch: 8 | loss: 0.4683226
	speed: 0.1605s/iter; left time: 112343.0731s
	iters: 2300, epoch: 8 | loss: 0.3798323
	speed: 0.1589s/iter; left time: 111155.8066s
	iters: 2400, epoch: 8 | loss: 0.3917741
	speed: 0.1598s/iter; left time: 111771.1958s
	iters: 2500, epoch: 8 | loss: 0.4791163
	speed: 0.1594s/iter; left time: 111506.2170s
	iters: 2600, epoch: 8 | loss: 0.4603379
	speed: 0.1591s/iter; left time: 111274.5283s
	iters: 2700, epoch: 8 | loss: 0.3899559
	speed: 0.1600s/iter; left time: 111860.4417s
	iters: 2800, epoch: 8 | loss: 0.4230933
	speed: 0.1592s/iter; left time: 111271.1527s
	iters: 2900, epoch: 8 | loss: 0.3831285
	speed: 0.1590s/iter; left time: 111178.3900s
	iters: 3000, epoch: 8 | loss: 0.3909163
	speed: 0.1583s/iter; left time: 110614.7207s
	iters: 3100, epoch: 8 | loss: 0.3524751
	speed: 0.1580s/iter; left time: 110382.8959s
	iters: 3200, epoch: 8 | loss: 0.3868916
	speed: 0.1584s/iter; left time: 110659.0401s
	iters: 3300, epoch: 8 | loss: 0.4332175
	speed: 0.1580s/iter; left time: 110390.0563s
	iters: 3400, epoch: 8 | loss: 0.4273333
	speed: 0.1587s/iter; left time: 110871.5385s
	iters: 3500, epoch: 8 | loss: 0.4185365
	speed: 0.1574s/iter; left time: 109928.0151s
	iters: 3600, epoch: 8 | loss: 0.3806898
	speed: 0.1589s/iter; left time: 110965.2392s
Epoch: 8 cost time: 576.8696336746216
Epoch: 8, Steps: 3637 | Train Loss: 0.4075284 Vali Loss: 1.0184860 Test Loss: 0.8994539
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 9 | loss: 0.3495223
	speed: 4.2469s/iter; left time: 2965197.2082s
	iters: 200, epoch: 9 | loss: 0.3703929
	speed: 0.1521s/iter; left time: 106203.1635s
	iters: 300, epoch: 9 | loss: 0.4092550
	speed: 0.1523s/iter; left time: 106295.6324s
	iters: 400, epoch: 9 | loss: 0.4842276
	speed: 0.1524s/iter; left time: 106361.6223s
	iters: 500, epoch: 9 | loss: 0.3856249
	speed: 0.1524s/iter; left time: 106321.6130s
	iters: 600, epoch: 9 | loss: 0.3566049
	speed: 0.1584s/iter; left time: 110511.5060s
	iters: 700, epoch: 9 | loss: 0.3862556
	speed: 0.1600s/iter; left time: 111600.5553s
	iters: 800, epoch: 9 | loss: 0.4599227
	speed: 0.1595s/iter; left time: 111258.1127s
	iters: 900, epoch: 9 | loss: 0.3601335
	speed: 0.1602s/iter; left time: 111699.9948s
	iters: 1000, epoch: 9 | loss: 0.4281904
	speed: 0.1578s/iter; left time: 110063.6597s
	iters: 1100, epoch: 9 | loss: 0.3344641
	speed: 0.1579s/iter; left time: 110121.5156s
	iters: 1200, epoch: 9 | loss: 0.3834359
	speed: 0.1606s/iter; left time: 111985.7586s
	iters: 1300, epoch: 9 | loss: 0.4025103
	speed: 0.1602s/iter; left time: 111650.2866s
	iters: 1400, epoch: 9 | loss: 0.3650259
	speed: 0.1559s/iter; left time: 108666.7878s
	iters: 1500, epoch: 9 | loss: 0.3777592
	speed: 0.1533s/iter; left time: 106825.6351s
	iters: 1600, epoch: 9 | loss: 0.4254134
	speed: 0.1556s/iter; left time: 108411.5915s
	iters: 1700, epoch: 9 | loss: 0.3802301
	speed: 0.1632s/iter; left time: 113660.5463s
	iters: 1800, epoch: 9 | loss: 0.3883496
	speed: 0.1674s/iter; left time: 116587.9742s
	iters: 1900, epoch: 9 | loss: 0.3796012
	speed: 0.1673s/iter; left time: 116481.2886s
	iters: 2000, epoch: 9 | loss: 0.3969381
	speed: 0.1671s/iter; left time: 116326.2213s
	iters: 2100, epoch: 9 | loss: 0.4415090
	speed: 0.1672s/iter; left time: 116381.1805s
	iters: 2200, epoch: 9 | loss: 0.4252011
	speed: 0.1674s/iter; left time: 116512.8511s
	iters: 2300, epoch: 9 | loss: 0.4252042
	speed: 0.1669s/iter; left time: 116158.5089s
	iters: 2400, epoch: 9 | loss: 0.4945188
	speed: 0.1670s/iter; left time: 116235.2406s
	iters: 2500, epoch: 9 | loss: 0.5181528
	speed: 0.1673s/iter; left time: 116385.4261s
	iters: 2600, epoch: 9 | loss: 0.3864418
	speed: 0.1668s/iter; left time: 116063.1969s
	iters: 2700, epoch: 9 | loss: 0.4114835
	speed: 0.1673s/iter; left time: 116382.6424s
	iters: 2800, epoch: 9 | loss: 0.3744862
	speed: 0.1649s/iter; left time: 114674.3332s
	iters: 2900, epoch: 9 | loss: 0.3530814
	speed: 0.1655s/iter; left time: 115057.7985s
	iters: 3000, epoch: 9 | loss: 0.3841522
	speed: 0.1672s/iter; left time: 116271.0845s
	iters: 3100, epoch: 9 | loss: 0.4491251
	speed: 0.1671s/iter; left time: 116148.0917s
	iters: 3200, epoch: 9 | loss: 0.4070127
	speed: 0.1671s/iter; left time: 116177.7283s
	iters: 3300, epoch: 9 | loss: 0.4967802
	speed: 0.1674s/iter; left time: 116346.5082s
	iters: 3400, epoch: 9 | loss: 0.4145974
	speed: 0.1651s/iter; left time: 114725.3826s
	iters: 3500, epoch: 9 | loss: 0.5463196
	speed: 0.1579s/iter; left time: 109708.3741s
	iters: 3600, epoch: 9 | loss: 0.4450140
	speed: 0.1627s/iter; left time: 113028.5630s
Epoch: 9 cost time: 588.9941565990448
Epoch: 9, Steps: 3637 | Train Loss: 0.4022874 Vali Loss: 1.0022272 Test Loss: 0.8959448
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247787
test shape: (24778, 1, 192, 822) (24778, 1, 192, 822)
test shape: (24778, 192, 822) (24778, 192, 822)
mse:0.9087994694709778, mae:0.7474759817123413
>>>>>>>Overall time: 9931 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
