Traceback (most recent call last):
  File "run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 2, in <module>
    from exp.exp_basic import Exp_Basic
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_basic.py", line 3, in <module>
    from models import Autoformer, Transformer, TimesNet, Nonstationary_Transformer, DLinear, FEDformer, \
  File "/g/data/hn98/du/exlts/ddd2/models/Mamba.py", line 7, in <module>
    from mamba_ssm import Mamba
ModuleNotFoundError: No module named 'mamba_ssm'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems07_all_filter10.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems07_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164337
val 247921
test 247921
	iters: 100, epoch: 1 | loss: 1.0447061
	speed: 0.1535s/iter; left time: 111653.7578s
	iters: 200, epoch: 1 | loss: 0.8519292
	speed: 0.1413s/iter; left time: 102777.3658s
	iters: 300, epoch: 1 | loss: 0.7354000
	speed: 0.1410s/iter; left time: 102538.3911s
	iters: 400, epoch: 1 | loss: 0.8638661
	speed: 0.1406s/iter; left time: 102217.2155s
	iters: 500, epoch: 1 | loss: 0.7057589
	speed: 0.1413s/iter; left time: 102731.9491s
	iters: 600, epoch: 1 | loss: 1.3613323
	speed: 0.1414s/iter; left time: 102764.8551s
	iters: 700, epoch: 1 | loss: 1.0088625
	speed: 0.1415s/iter; left time: 102876.6114s
	iters: 800, epoch: 1 | loss: 1.1366873
	speed: 0.1414s/iter; left time: 102798.7737s
	iters: 900, epoch: 1 | loss: 0.9766739
	speed: 0.1405s/iter; left time: 102067.5799s
	iters: 1000, epoch: 1 | loss: 0.9848394
	speed: 0.1413s/iter; left time: 102652.7516s
	iters: 1100, epoch: 1 | loss: 0.8335413
	speed: 0.1426s/iter; left time: 103630.2864s
	iters: 1200, epoch: 1 | loss: 0.8611324
	speed: 0.1464s/iter; left time: 106375.1569s
	iters: 1300, epoch: 1 | loss: 0.7973900
	speed: 0.1455s/iter; left time: 105697.7757s
	iters: 1400, epoch: 1 | loss: 0.9272977
	speed: 0.1461s/iter; left time: 106109.7302s
	iters: 1500, epoch: 1 | loss: 0.6197832
	speed: 0.1462s/iter; left time: 106133.6525s
	iters: 1600, epoch: 1 | loss: 0.7697026
	speed: 0.1458s/iter; left time: 105881.0685s
	iters: 1700, epoch: 1 | loss: 0.7900254
	speed: 0.1461s/iter; left time: 106042.2802s
	iters: 1800, epoch: 1 | loss: 0.7738985
	speed: 0.1457s/iter; left time: 105755.4694s
	iters: 1900, epoch: 1 | loss: 0.7330979
	speed: 0.1457s/iter; left time: 105699.8892s
	iters: 2000, epoch: 1 | loss: 0.6967121
	speed: 0.1460s/iter; left time: 105902.8951s
	iters: 2100, epoch: 1 | loss: 0.7452401
	speed: 0.1459s/iter; left time: 105886.7899s
	iters: 2200, epoch: 1 | loss: 0.6882440
	speed: 0.1457s/iter; left time: 105712.8327s
	iters: 2300, epoch: 1 | loss: 0.6771665
	speed: 0.1459s/iter; left time: 105835.1369s
	iters: 2400, epoch: 1 | loss: 0.6208928
	speed: 0.1497s/iter; left time: 108541.5720s
	iters: 2500, epoch: 1 | loss: 0.7690682
	speed: 0.1540s/iter; left time: 111701.4337s
	iters: 2600, epoch: 1 | loss: 0.7789468
	speed: 0.1534s/iter; left time: 111218.1172s
	iters: 2700, epoch: 1 | loss: 0.6257211
	speed: 0.1529s/iter; left time: 110806.5108s
	iters: 2800, epoch: 1 | loss: 0.6068736
	speed: 0.1532s/iter; left time: 111016.7179s
	iters: 2900, epoch: 1 | loss: 0.6296610
	speed: 0.1529s/iter; left time: 110775.9134s
	iters: 3000, epoch: 1 | loss: 0.5460111
	speed: 0.1535s/iter; left time: 111250.1038s
	iters: 3100, epoch: 1 | loss: 0.5879706
	speed: 0.1533s/iter; left time: 111075.3494s
	iters: 3200, epoch: 1 | loss: 0.6233484
	speed: 0.1535s/iter; left time: 111192.3542s
	iters: 3300, epoch: 1 | loss: 0.5636717
	speed: 0.1537s/iter; left time: 111346.3655s
	iters: 3400, epoch: 1 | loss: 0.6046042
	speed: 0.1538s/iter; left time: 111354.2002s
	iters: 3500, epoch: 1 | loss: 0.5949641
	speed: 0.1536s/iter; left time: 111246.2653s
	iters: 3600, epoch: 1 | loss: 0.6505559
	speed: 0.1531s/iter; left time: 110875.1487s
Epoch: 1 cost time: 537.0135419368744
Epoch: 1, Steps: 3638 | Train Loss: 0.7996446 Vali Loss: 0.9680374 Test Loss: 1.1828767
Validation loss decreased (inf --> 0.968037).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6046435
	speed: 4.4018s/iter; left time: 3186327.8361s
	iters: 200, epoch: 2 | loss: 0.5346952
	speed: 0.1388s/iter; left time: 100459.5994s
	iters: 300, epoch: 2 | loss: 0.5758153
	speed: 0.1374s/iter; left time: 99444.3761s
	iters: 400, epoch: 2 | loss: 0.6486496
	speed: 0.1368s/iter; left time: 98981.7145s
	iters: 500, epoch: 2 | loss: 0.6347871
	speed: 0.1370s/iter; left time: 99087.0904s
	iters: 600, epoch: 2 | loss: 0.4993126
	speed: 0.1376s/iter; left time: 99552.2675s
	iters: 700, epoch: 2 | loss: 0.5614095
	speed: 0.1421s/iter; left time: 102792.2681s
	iters: 800, epoch: 2 | loss: 0.5826714
	speed: 0.1402s/iter; left time: 101351.5504s
	iters: 900, epoch: 2 | loss: 0.6909283
	speed: 0.1420s/iter; left time: 102659.2156s
	iters: 1000, epoch: 2 | loss: 0.6614873
	speed: 0.1439s/iter; left time: 104007.5457s
	iters: 1100, epoch: 2 | loss: 0.5072456
	speed: 0.1451s/iter; left time: 104921.8159s
	iters: 1200, epoch: 2 | loss: 0.6294956
	speed: 0.1449s/iter; left time: 104732.5772s
	iters: 1300, epoch: 2 | loss: 0.5817333
	speed: 0.1468s/iter; left time: 106076.5377s
	iters: 1400, epoch: 2 | loss: 0.5692124
	speed: 0.1475s/iter; left time: 106560.2864s
	iters: 1500, epoch: 2 | loss: 0.5847942
	speed: 0.1477s/iter; left time: 106710.7149s
	iters: 1600, epoch: 2 | loss: 0.5161236
	speed: 0.1473s/iter; left time: 106383.7045s
	iters: 1700, epoch: 2 | loss: 0.5260754
	speed: 0.1475s/iter; left time: 106506.4194s
	iters: 1800, epoch: 2 | loss: 0.5046976
	speed: 0.1475s/iter; left time: 106507.2828s
	iters: 1900, epoch: 2 | loss: 0.5262332
	speed: 0.1475s/iter; left time: 106475.1194s
	iters: 2000, epoch: 2 | loss: 0.5701182
	speed: 0.1475s/iter; left time: 106470.5773s
	iters: 2100, epoch: 2 | loss: 0.5060205
	speed: 0.1476s/iter; left time: 106560.0174s
	iters: 2200, epoch: 2 | loss: 0.5322825
	speed: 0.1477s/iter; left time: 106607.3530s
	iters: 2300, epoch: 2 | loss: 0.6391634
	speed: 0.1477s/iter; left time: 106571.6191s
	iters: 2400, epoch: 2 | loss: 0.5946599
	speed: 0.1477s/iter; left time: 106602.2634s
	iters: 2500, epoch: 2 | loss: 0.5798373
	speed: 0.1478s/iter; left time: 106602.4390s
	iters: 2600, epoch: 2 | loss: 0.4993595
	speed: 0.1447s/iter; left time: 104408.1250s
	iters: 2700, epoch: 2 | loss: 0.5760734
	speed: 0.1446s/iter; left time: 104275.0401s
	iters: 2800, epoch: 2 | loss: 0.5731087
	speed: 0.1445s/iter; left time: 104238.6108s
	iters: 2900, epoch: 2 | loss: 0.5020737
	speed: 0.1447s/iter; left time: 104337.5206s
	iters: 3000, epoch: 2 | loss: 0.4934392
	speed: 0.1456s/iter; left time: 104999.2869s
	iters: 3100, epoch: 2 | loss: 0.5683725
	speed: 0.1474s/iter; left time: 106257.4526s
	iters: 3200, epoch: 2 | loss: 0.4938362
	speed: 0.1477s/iter; left time: 106451.9607s
	iters: 3300, epoch: 2 | loss: 0.5305578
	speed: 0.1477s/iter; left time: 106470.8233s
	iters: 3400, epoch: 2 | loss: 0.4908211
	speed: 0.1474s/iter; left time: 106211.0945s
	iters: 3500, epoch: 2 | loss: 0.5339601
	speed: 0.1473s/iter; left time: 106109.9567s
	iters: 3600, epoch: 2 | loss: 0.4986709
	speed: 0.1470s/iter; left time: 105875.9135s
Epoch: 2 cost time: 527.4363505840302
Epoch: 2, Steps: 3638 | Train Loss: 0.5706716 Vali Loss: 0.9499895 Test Loss: 1.1129749
Validation loss decreased (0.968037 --> 0.949989).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5969095
	speed: 4.4108s/iter; left time: 3176780.9063s
	iters: 200, epoch: 3 | loss: 0.5252456
	speed: 0.1462s/iter; left time: 105303.3510s
	iters: 300, epoch: 3 | loss: 0.6425263
	speed: 0.1470s/iter; left time: 105827.3172s
	iters: 400, epoch: 3 | loss: 0.5750740
	speed: 0.1453s/iter; left time: 104624.7469s
	iters: 500, epoch: 3 | loss: 0.5573270
	speed: 0.1452s/iter; left time: 104528.0701s
	iters: 600, epoch: 3 | loss: 0.5252799
	speed: 0.1453s/iter; left time: 104560.1560s
	iters: 700, epoch: 3 | loss: 0.5701586
	speed: 0.1444s/iter; left time: 103910.6626s
	iters: 800, epoch: 3 | loss: 0.4926187
	speed: 0.1448s/iter; left time: 104216.4434s
	iters: 900, epoch: 3 | loss: 0.4474362
	speed: 0.1481s/iter; left time: 106554.2554s
	iters: 1000, epoch: 3 | loss: 0.5755851
	speed: 0.1477s/iter; left time: 106278.4584s
	iters: 1100, epoch: 3 | loss: 0.4592630
	speed: 0.1478s/iter; left time: 106330.7173s
	iters: 1200, epoch: 3 | loss: 0.5238293
	speed: 0.1471s/iter; left time: 105795.7301s
	iters: 1300, epoch: 3 | loss: 0.5957733
	speed: 0.1475s/iter; left time: 106064.3355s
	iters: 1400, epoch: 3 | loss: 0.5156337
	speed: 0.1475s/iter; left time: 106010.7286s
	iters: 1500, epoch: 3 | loss: 0.4985749
	speed: 0.1478s/iter; left time: 106260.9622s
	iters: 1600, epoch: 3 | loss: 0.4885861
	speed: 0.1474s/iter; left time: 105948.2697s
	iters: 1700, epoch: 3 | loss: 0.5214286
	speed: 0.1481s/iter; left time: 106441.0168s
	iters: 1800, epoch: 3 | loss: 0.4866185
	speed: 0.1480s/iter; left time: 106317.6478s
	iters: 1900, epoch: 3 | loss: 0.6755106
	speed: 0.1478s/iter; left time: 106181.2073s
	iters: 2000, epoch: 3 | loss: 0.6930431
	speed: 0.1478s/iter; left time: 106201.8480s
	iters: 2100, epoch: 3 | loss: 0.7041104
	speed: 0.1476s/iter; left time: 106037.8567s
	iters: 2200, epoch: 3 | loss: 0.6990390
	speed: 0.1463s/iter; left time: 105054.5144s
	iters: 2300, epoch: 3 | loss: 0.5933880
	speed: 0.1476s/iter; left time: 105978.0761s
	iters: 2400, epoch: 3 | loss: 0.4903767
	speed: 0.1477s/iter; left time: 106056.8128s
	iters: 2500, epoch: 3 | loss: 0.6134381
	speed: 0.1468s/iter; left time: 105386.4314s
	iters: 2600, epoch: 3 | loss: 0.6271401
	speed: 0.1480s/iter; left time: 106253.5860s
	iters: 2700, epoch: 3 | loss: 0.5615162
	speed: 0.1480s/iter; left time: 106184.9809s
	iters: 2800, epoch: 3 | loss: 0.5528068
	speed: 0.1481s/iter; left time: 106233.9955s
	iters: 2900, epoch: 3 | loss: 0.5048189
	speed: 0.1473s/iter; left time: 105666.2277s
	iters: 3000, epoch: 3 | loss: 0.4862237
	speed: 0.1479s/iter; left time: 106070.4848s
	iters: 3100, epoch: 3 | loss: 0.5116019
	speed: 0.1481s/iter; left time: 106214.7139s
	iters: 3200, epoch: 3 | loss: 0.4460296
	speed: 0.1480s/iter; left time: 106160.8915s
	iters: 3300, epoch: 3 | loss: 0.4579794
	speed: 0.1453s/iter; left time: 104218.8869s
	iters: 3400, epoch: 3 | loss: 0.4644269
	speed: 0.1454s/iter; left time: 104233.7892s
	iters: 3500, epoch: 3 | loss: 0.5007529
	speed: 0.1450s/iter; left time: 103912.3452s
	iters: 3600, epoch: 3 | loss: 0.5026140
	speed: 0.1449s/iter; left time: 103863.7977s
Epoch: 3 cost time: 535.2680695056915
Epoch: 3, Steps: 3638 | Train Loss: 0.5263062 Vali Loss: 0.8956223 Test Loss: 1.0974025
Validation loss decreased (0.949989 --> 0.895622).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.4281629
	speed: 4.3766s/iter; left time: 3136239.3779s
	iters: 200, epoch: 4 | loss: 0.4643419
	speed: 0.1391s/iter; left time: 99674.6201s
	iters: 300, epoch: 4 | loss: 0.4351003
	speed: 0.1397s/iter; left time: 100068.3022s
	iters: 400, epoch: 4 | loss: 0.4717042
	speed: 0.1367s/iter; left time: 97946.1246s
	iters: 500, epoch: 4 | loss: 0.5035816
	speed: 0.1367s/iter; left time: 97917.9075s
	iters: 600, epoch: 4 | loss: 0.4346005
	speed: 0.1364s/iter; left time: 97647.8473s
	iters: 700, epoch: 4 | loss: 0.4761347
	speed: 0.1366s/iter; left time: 97808.8572s
	iters: 800, epoch: 4 | loss: 0.5074973
	speed: 0.1369s/iter; left time: 98021.2239s
	iters: 900, epoch: 4 | loss: 0.4574135
	speed: 0.1400s/iter; left time: 100221.7045s
	iters: 1000, epoch: 4 | loss: 0.4508460
	speed: 0.1407s/iter; left time: 100732.2443s
	iters: 1100, epoch: 4 | loss: 0.4963240
	speed: 0.1409s/iter; left time: 100835.7823s
	iters: 1200, epoch: 4 | loss: 0.5434418
	speed: 0.1409s/iter; left time: 100835.9041s
	iters: 1300, epoch: 4 | loss: 0.4920126
	speed: 0.1406s/iter; left time: 100560.3041s
	iters: 1400, epoch: 4 | loss: 0.4686348
	speed: 0.1411s/iter; left time: 100946.0696s
	iters: 1500, epoch: 4 | loss: 0.4540523
	speed: 0.1408s/iter; left time: 100700.8612s
	iters: 1600, epoch: 4 | loss: 0.4283681
	speed: 0.1413s/iter; left time: 101025.9810s
	iters: 1700, epoch: 4 | loss: 0.4671200
	speed: 0.1408s/iter; left time: 100662.8595s
	iters: 1800, epoch: 4 | loss: 0.4051882
	speed: 0.1405s/iter; left time: 100462.5978s
	iters: 1900, epoch: 4 | loss: 0.4296715
	speed: 0.1364s/iter; left time: 97516.3207s
	iters: 2000, epoch: 4 | loss: 0.4266724
	speed: 0.1385s/iter; left time: 98959.2627s
	iters: 2100, epoch: 4 | loss: 0.4658367
	speed: 0.1389s/iter; left time: 99276.0105s
	iters: 2200, epoch: 4 | loss: 0.4874337
	speed: 0.1372s/iter; left time: 98062.0659s
	iters: 2300, epoch: 4 | loss: 0.4424809
	speed: 0.1369s/iter; left time: 97793.6024s
	iters: 2400, epoch: 4 | loss: 0.4569860
	speed: 0.1363s/iter; left time: 97362.4160s
	iters: 2500, epoch: 4 | loss: 0.4213628
	speed: 0.1367s/iter; left time: 97625.8541s
	iters: 2600, epoch: 4 | loss: 0.4361631
	speed: 0.1403s/iter; left time: 100208.5914s
	iters: 2700, epoch: 4 | loss: 0.4670746
	speed: 0.1408s/iter; left time: 100511.5888s
	iters: 2800, epoch: 4 | loss: 0.4508859
	speed: 0.1412s/iter; left time: 100781.4505s
	iters: 2900, epoch: 4 | loss: 0.4544570
	speed: 0.1410s/iter; left time: 100626.4173s
	iters: 3000, epoch: 4 | loss: 0.4264027
	speed: 0.1403s/iter; left time: 100164.3716s
	iters: 3100, epoch: 4 | loss: 0.4067281
	speed: 0.1411s/iter; left time: 100715.0250s
	iters: 3200, epoch: 4 | loss: 0.4707395
	speed: 0.1405s/iter; left time: 100239.2551s
	iters: 3300, epoch: 4 | loss: 0.3846145
	speed: 0.1431s/iter; left time: 102096.3453s
	iters: 3400, epoch: 4 | loss: 0.4300329
	speed: 0.1476s/iter; left time: 105283.3804s
	iters: 3500, epoch: 4 | loss: 0.4260505
	speed: 0.1476s/iter; left time: 105244.9765s
	iters: 3600, epoch: 4 | loss: 0.4206476
	speed: 0.1475s/iter; left time: 105158.4858s
Epoch: 4 cost time: 510.4264175891876
Epoch: 4, Steps: 3638 | Train Loss: 0.4568291 Vali Loss: 0.8941150 Test Loss: 1.0985756
Validation loss decreased (0.895622 --> 0.894115).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4217181
	speed: 4.3678s/iter; left time: 3113992.6486s
	iters: 200, epoch: 5 | loss: 0.4049733
	speed: 0.1539s/iter; left time: 109673.5844s
	iters: 300, epoch: 5 | loss: 0.3987361
	speed: 0.1535s/iter; left time: 109406.4134s
	iters: 400, epoch: 5 | loss: 0.4126085
	speed: 0.1536s/iter; left time: 109454.8626s
	iters: 500, epoch: 5 | loss: 0.4270979
	speed: 0.1523s/iter; left time: 108490.3210s
	iters: 600, epoch: 5 | loss: 0.3620895
	speed: 0.1532s/iter; left time: 109128.9466s
	iters: 700, epoch: 5 | loss: 0.4031124
	speed: 0.1527s/iter; left time: 108766.6076s
	iters: 800, epoch: 5 | loss: 0.3994356
	speed: 0.1531s/iter; left time: 109031.5259s
	iters: 900, epoch: 5 | loss: 0.4314933
	speed: 0.1534s/iter; left time: 109226.9198s
	iters: 1000, epoch: 5 | loss: 0.4756366
	speed: 0.1544s/iter; left time: 109975.5330s
	iters: 1100, epoch: 5 | loss: 0.4099793
	speed: 0.1533s/iter; left time: 109154.2300s
	iters: 1200, epoch: 5 | loss: 0.4283010
	speed: 0.1527s/iter; left time: 108731.6123s
	iters: 1300, epoch: 5 | loss: 0.3994832
	speed: 0.1534s/iter; left time: 109163.0391s
	iters: 1400, epoch: 5 | loss: 0.4178351
	speed: 0.1527s/iter; left time: 108645.3792s
	iters: 1500, epoch: 5 | loss: 0.8620059
	speed: 0.1531s/iter; left time: 108905.6557s
	iters: 1600, epoch: 5 | loss: 0.7835560
	speed: 0.1530s/iter; left time: 108865.4853s
	iters: 1700, epoch: 5 | loss: 0.8860384
	speed: 0.1538s/iter; left time: 109390.9254s
	iters: 1800, epoch: 5 | loss: 0.8075884
	speed: 0.1547s/iter; left time: 110000.7569s
	iters: 1900, epoch: 5 | loss: 0.6645550
	speed: 0.1547s/iter; left time: 110037.6518s
	iters: 2000, epoch: 5 | loss: 0.8421292
	speed: 0.1544s/iter; left time: 109816.6860s
	iters: 2100, epoch: 5 | loss: 0.6330771
	speed: 0.1542s/iter; left time: 109650.6972s
	iters: 2200, epoch: 5 | loss: 0.6489331
	speed: 0.1546s/iter; left time: 109902.1604s
	iters: 2300, epoch: 5 | loss: 0.6722822
	speed: 0.1543s/iter; left time: 109697.5735s
	iters: 2400, epoch: 5 | loss: 0.7700737
	speed: 0.1547s/iter; left time: 109930.7605s
	iters: 2500, epoch: 5 | loss: 0.7670742
	speed: 0.1542s/iter; left time: 109583.7428s
	iters: 2600, epoch: 5 | loss: 0.7065588
	speed: 0.1540s/iter; left time: 109391.8780s
	iters: 2700, epoch: 5 | loss: 0.9169707
	speed: 0.1542s/iter; left time: 109536.1771s
	iters: 2800, epoch: 5 | loss: 0.6214195
	speed: 0.1542s/iter; left time: 109497.0093s
	iters: 2900, epoch: 5 | loss: 0.6517659
	speed: 0.1553s/iter; left time: 110277.3166s
	iters: 3000, epoch: 5 | loss: 0.6508875
	speed: 0.1543s/iter; left time: 109538.7618s
	iters: 3100, epoch: 5 | loss: 0.6233544
	speed: 0.1551s/iter; left time: 110103.3300s
	iters: 3200, epoch: 5 | loss: 0.5851997
	speed: 0.1545s/iter; left time: 109683.3112s
	iters: 3300, epoch: 5 | loss: 0.7583320
	speed: 0.1546s/iter; left time: 109701.6794s
	iters: 3400, epoch: 5 | loss: 0.5939948
	speed: 0.1551s/iter; left time: 110077.0228s
	iters: 3500, epoch: 5 | loss: 0.5499175
	speed: 0.1551s/iter; left time: 110061.3861s
	iters: 3600, epoch: 5 | loss: 0.6177861
	speed: 0.1553s/iter; left time: 110148.8929s
Epoch: 5 cost time: 560.8452286720276
Epoch: 5, Steps: 3638 | Train Loss: 0.5878925 Vali Loss: 1.0442997 Test Loss: 1.2345049
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.6616049
	speed: 4.4574s/iter; left time: 3161655.4044s
	iters: 200, epoch: 6 | loss: 0.6187519
	speed: 0.1461s/iter; left time: 103631.6748s
	iters: 300, epoch: 6 | loss: 0.7304209
	speed: 0.1454s/iter; left time: 103070.4781s
	iters: 400, epoch: 6 | loss: 0.8272372
	speed: 0.1413s/iter; left time: 100196.8832s
	iters: 500, epoch: 6 | loss: 0.6271763
	speed: 0.1451s/iter; left time: 102880.0416s
	iters: 600, epoch: 6 | loss: 0.6982332
	speed: 0.1446s/iter; left time: 102473.7274s
	iters: 700, epoch: 6 | loss: 0.6007569
	speed: 0.1448s/iter; left time: 102641.8507s
	iters: 800, epoch: 6 | loss: 0.6378008
	speed: 0.1448s/iter; left time: 102628.3696s
	iters: 900, epoch: 6 | loss: 0.6002159
	speed: 0.1452s/iter; left time: 102888.0270s
	iters: 1000, epoch: 6 | loss: 0.6092621
	speed: 0.1454s/iter; left time: 103019.0940s
	iters: 1100, epoch: 6 | loss: 0.5276536
	speed: 0.1474s/iter; left time: 104387.8129s
	iters: 1200, epoch: 6 | loss: 0.5296953
	speed: 0.1481s/iter; left time: 104893.3802s
	iters: 1300, epoch: 6 | loss: 0.6113923
	speed: 0.1472s/iter; left time: 104225.3309s
	iters: 1400, epoch: 6 | loss: 0.5274953
	speed: 0.1470s/iter; left time: 104083.1659s
	iters: 1500, epoch: 6 | loss: 0.5185490
	speed: 0.1480s/iter; left time: 104801.8037s
	iters: 1600, epoch: 6 | loss: 0.5649899
	speed: 0.1479s/iter; left time: 104717.4958s
	iters: 1700, epoch: 6 | loss: 0.5649037
	speed: 0.1479s/iter; left time: 104684.4343s
	iters: 1800, epoch: 6 | loss: 0.6097519
	speed: 0.1474s/iter; left time: 104317.1936s
	iters: 1900, epoch: 6 | loss: 0.6420654
	speed: 0.1476s/iter; left time: 104438.9571s
	iters: 2000, epoch: 6 | loss: 0.6623965
	speed: 0.1479s/iter; left time: 104626.4594s
	iters: 2100, epoch: 6 | loss: 0.5259343
	speed: 0.1478s/iter; left time: 104554.0632s
	iters: 2200, epoch: 6 | loss: 0.5860491
	speed: 0.1481s/iter; left time: 104726.4831s
	iters: 2300, epoch: 6 | loss: 0.6161207
	speed: 0.1478s/iter; left time: 104505.4506s
	iters: 2400, epoch: 6 | loss: 0.5789968
	speed: 0.1482s/iter; left time: 104799.1968s
	iters: 2500, epoch: 6 | loss: 0.6440229
	speed: 0.1474s/iter; left time: 104221.5069s
	iters: 2600, epoch: 6 | loss: 0.6366711
	speed: 0.1461s/iter; left time: 103255.7455s
	iters: 2700, epoch: 6 | loss: 0.6470145
	speed: 0.1450s/iter; left time: 102448.5506s
	iters: 2800, epoch: 6 | loss: 0.6816189
	speed: 0.1453s/iter; left time: 102641.0488s
	iters: 2900, epoch: 6 | loss: 0.5714336
	speed: 0.1449s/iter; left time: 102360.1300s
	iters: 3000, epoch: 6 | loss: 0.7818699
	speed: 0.1449s/iter; left time: 102324.1833s
	iters: 3100, epoch: 6 | loss: 0.7597513
	speed: 0.1447s/iter; left time: 102188.7147s
	iters: 3200, epoch: 6 | loss: 0.7194845
	speed: 0.1447s/iter; left time: 102218.0845s
	iters: 3300, epoch: 6 | loss: 0.5616363
	speed: 0.1480s/iter; left time: 104489.3334s
	iters: 3400, epoch: 6 | loss: 0.7017979
	speed: 0.1545s/iter; left time: 109092.7248s
	iters: 3500, epoch: 6 | loss: 0.7843993
	speed: 0.1547s/iter; left time: 109186.4808s
	iters: 3600, epoch: 6 | loss: 0.9737446
	speed: 0.1546s/iter; left time: 109136.2571s
Epoch: 6 cost time: 535.9908583164215
Epoch: 6, Steps: 3638 | Train Loss: 0.6580245 Vali Loss: 1.2320362 Test Loss: 1.4155390
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 0.6562644
	speed: 4.3759s/iter; left time: 3087953.3848s
	iters: 200, epoch: 7 | loss: 0.6458493
	speed: 0.1458s/iter; left time: 102856.6358s
	iters: 300, epoch: 7 | loss: 0.7121688
	speed: 0.1464s/iter; left time: 103287.7875s
	iters: 400, epoch: 7 | loss: 0.7176614
	speed: 0.1422s/iter; left time: 100336.0864s
	iters: 500, epoch: 7 | loss: 0.6801441
	speed: 0.1426s/iter; left time: 100546.9527s
	iters: 600, epoch: 7 | loss: 0.6633775
	speed: 0.1420s/iter; left time: 100168.9751s
	iters: 700, epoch: 7 | loss: 0.5983114
	speed: 0.1426s/iter; left time: 100523.1702s
	iters: 800, epoch: 7 | loss: 0.6746053
	speed: 0.1448s/iter; left time: 102113.7315s
	iters: 900, epoch: 7 | loss: 0.7240848
	speed: 0.1445s/iter; left time: 101852.3506s
	iters: 1000, epoch: 7 | loss: 0.8749132
	speed: 0.1450s/iter; left time: 102172.8219s
	iters: 1100, epoch: 7 | loss: 0.7104005
	speed: 0.1450s/iter; left time: 102185.4797s
	iters: 1200, epoch: 7 | loss: 0.6580324
	speed: 0.1461s/iter; left time: 102914.0997s
	iters: 1300, epoch: 7 | loss: 0.6180313
	speed: 0.1475s/iter; left time: 103903.6689s
	iters: 1400, epoch: 7 | loss: 0.6794357
	speed: 0.1475s/iter; left time: 103895.1518s
	iters: 1500, epoch: 7 | loss: 0.6457343
	speed: 0.1480s/iter; left time: 104244.4748s
	iters: 1600, epoch: 7 | loss: 0.6201964
	speed: 0.1478s/iter; left time: 104102.5450s
	iters: 1700, epoch: 7 | loss: 0.5749887
	speed: 0.1449s/iter; left time: 102034.9834s
	iters: 1800, epoch: 7 | loss: 0.5574461
	speed: 0.1446s/iter; left time: 101776.8124s
	iters: 1900, epoch: 7 | loss: 0.5645837
	speed: 0.1445s/iter; left time: 101736.6253s
	iters: 2000, epoch: 7 | loss: 0.5368985
	speed: 0.1448s/iter; left time: 101909.2971s
	iters: 2100, epoch: 7 | loss: 0.5462689
	speed: 0.1443s/iter; left time: 101564.5371s
	iters: 2200, epoch: 7 | loss: 0.5389531
	speed: 0.1445s/iter; left time: 101666.3626s
	iters: 2300, epoch: 7 | loss: 0.5662108
	speed: 0.1451s/iter; left time: 102066.9014s
	iters: 2400, epoch: 7 | loss: 0.6061917
	speed: 0.1462s/iter; left time: 102816.2095s
	iters: 2500, epoch: 7 | loss: 0.6273985
	speed: 0.1453s/iter; left time: 102212.5554s
	iters: 2600, epoch: 7 | loss: 0.6302306
	speed: 0.1448s/iter; left time: 101820.6526s
	iters: 2700, epoch: 7 | loss: 0.5909754
	speed: 0.1445s/iter; left time: 101571.4060s
	iters: 2800, epoch: 7 | loss: 0.6311247
	speed: 0.1447s/iter; left time: 101711.6372s
	iters: 2900, epoch: 7 | loss: 0.5680821
	speed: 0.1441s/iter; left time: 101308.7260s
	iters: 3000, epoch: 7 | loss: 0.6449717
	speed: 0.1449s/iter; left time: 101838.2586s
	iters: 3100, epoch: 7 | loss: 0.5906882
	speed: 0.1449s/iter; left time: 101843.8060s
	iters: 3200, epoch: 7 | loss: 0.6344416
	speed: 0.1478s/iter; left time: 103829.0093s
	iters: 3300, epoch: 7 | loss: 0.6032273
	speed: 0.1482s/iter; left time: 104087.6379s
	iters: 3400, epoch: 7 | loss: 0.5660660
	speed: 0.1475s/iter; left time: 103590.3735s
	iters: 3500, epoch: 7 | loss: 0.6771283
	speed: 0.1474s/iter; left time: 103494.7103s
	iters: 3600, epoch: 7 | loss: 0.6685980
	speed: 0.1466s/iter; left time: 102908.0099s
Epoch: 7 cost time: 529.7298378944397
Epoch: 7, Steps: 3638 | Train Loss: 0.6334089 Vali Loss: 0.9956548 Test Loss: 1.2513509
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 8 | loss: 0.5280993
	speed: 4.3997s/iter; left time: 3088737.2904s
	iters: 200, epoch: 8 | loss: 0.5155877
	speed: 0.1478s/iter; left time: 103731.9451s
	iters: 300, epoch: 8 | loss: 0.5908476
	speed: 0.1465s/iter; left time: 102806.4340s
	iters: 400, epoch: 8 | loss: 0.5893201
	speed: 0.1444s/iter; left time: 101343.6094s
	iters: 500, epoch: 8 | loss: 0.6364377
	speed: 0.1445s/iter; left time: 101390.9903s
	iters: 600, epoch: 8 | loss: 0.6438785
	speed: 0.1444s/iter; left time: 101309.7481s
	iters: 700, epoch: 8 | loss: 0.6038976
	speed: 0.1472s/iter; left time: 103273.9896s
	iters: 800, epoch: 8 | loss: 0.5522818
	speed: 0.1475s/iter; left time: 103427.6581s
	iters: 900, epoch: 8 | loss: 0.4445820
	speed: 0.1477s/iter; left time: 103597.4156s
	iters: 1000, epoch: 8 | loss: 0.6931618
	speed: 0.1477s/iter; left time: 103553.5606s
	iters: 1100, epoch: 8 | loss: 0.6066301
	speed: 0.1473s/iter; left time: 103232.9789s
	iters: 1200, epoch: 8 | loss: 0.7002087
	speed: 0.1472s/iter; left time: 103201.8941s
	iters: 1300, epoch: 8 | loss: 0.6545220
	speed: 0.1463s/iter; left time: 102509.4468s
	iters: 1400, epoch: 8 | loss: 0.5903549
	speed: 0.1470s/iter; left time: 103033.7755s
	iters: 1500, epoch: 8 | loss: 0.6036832
	speed: 0.1474s/iter; left time: 103305.2323s
	iters: 1600, epoch: 8 | loss: 0.6073225
	speed: 0.1476s/iter; left time: 103401.3159s
	iters: 1700, epoch: 8 | loss: 0.6017076
	speed: 0.1475s/iter; left time: 103284.4154s
	iters: 1800, epoch: 8 | loss: 0.4952036
	speed: 0.1477s/iter; left time: 103448.4709s
	iters: 1900, epoch: 8 | loss: 0.6092995
	speed: 0.1475s/iter; left time: 103289.0750s
	iters: 2000, epoch: 8 | loss: 0.5452549
	speed: 0.1475s/iter; left time: 103268.6372s
	iters: 2100, epoch: 8 | loss: 0.5741385
	speed: 0.1476s/iter; left time: 103319.6231s
	iters: 2200, epoch: 8 | loss: 0.6011708
	speed: 0.1477s/iter; left time: 103394.8460s
	iters: 2300, epoch: 8 | loss: 0.5558612
	speed: 0.1477s/iter; left time: 103400.2665s
	iters: 2400, epoch: 8 | loss: 0.6035128
	speed: 0.1479s/iter; left time: 103468.1341s
	iters: 2500, epoch: 8 | loss: 0.5888295
	speed: 0.1478s/iter; left time: 103434.6400s
	iters: 2600, epoch: 8 | loss: 0.5798181
	speed: 0.1469s/iter; left time: 102728.0486s
	iters: 2700, epoch: 8 | loss: 0.6328304
	speed: 0.1475s/iter; left time: 103160.6142s
	iters: 2800, epoch: 8 | loss: 0.5545473
	speed: 0.1477s/iter; left time: 103280.5048s
	iters: 2900, epoch: 8 | loss: 0.5322438
	speed: 0.1475s/iter; left time: 103126.7564s
	iters: 3000, epoch: 8 | loss: 0.5803984
	speed: 0.1482s/iter; left time: 103609.0779s
	iters: 3100, epoch: 8 | loss: 0.5866010
	speed: 0.1480s/iter; left time: 103451.9498s
	iters: 3200, epoch: 8 | loss: 0.5722564
	speed: 0.1480s/iter; left time: 103458.2120s
	iters: 3300, epoch: 8 | loss: 0.5318243
	speed: 0.1474s/iter; left time: 103024.8340s
	iters: 3400, epoch: 8 | loss: 0.5748745
	speed: 0.1473s/iter; left time: 102923.6673s
	iters: 3500, epoch: 8 | loss: 0.5141022
	speed: 0.1474s/iter; left time: 103008.4847s
	iters: 3600, epoch: 8 | loss: 0.5805695
	speed: 0.1478s/iter; left time: 103244.6136s
Epoch: 8 cost time: 536.4556646347046
Epoch: 8, Steps: 3638 | Train Loss: 0.5998738 Vali Loss: 0.9743000 Test Loss: 1.1835806
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 9 | loss: 0.6562987
	speed: 4.4391s/iter; left time: 3100238.4580s
	iters: 200, epoch: 9 | loss: 0.6111110
	speed: 0.1459s/iter; left time: 101890.7018s
	iters: 300, epoch: 9 | loss: 0.6849626
	speed: 0.1438s/iter; left time: 100367.0040s
	iters: 400, epoch: 9 | loss: 0.5349192
	speed: 0.1490s/iter; left time: 104043.3353s
	iters: 500, epoch: 9 | loss: 0.5187797
	speed: 0.1535s/iter; left time: 107114.8090s
	iters: 600, epoch: 9 | loss: 0.5330686
	speed: 0.1547s/iter; left time: 107971.3833s
	iters: 700, epoch: 9 | loss: 0.4970543
	speed: 0.1541s/iter; left time: 107564.8217s
	iters: 800, epoch: 9 | loss: 0.5809835
	speed: 0.1541s/iter; left time: 107489.4398s
	iters: 900, epoch: 9 | loss: 0.7458484
	speed: 0.1540s/iter; left time: 107404.2439s
	iters: 1000, epoch: 9 | loss: 0.6736006
	speed: 0.1541s/iter; left time: 107514.4345s
	iters: 1100, epoch: 9 | loss: 0.5684275
	speed: 0.1549s/iter; left time: 108005.9215s
	iters: 1200, epoch: 9 | loss: 0.5879647
	speed: 0.1546s/iter; left time: 107818.0913s
	iters: 1300, epoch: 9 | loss: 0.6901151
	speed: 0.1538s/iter; left time: 107241.1302s
	iters: 1400, epoch: 9 | loss: 0.6247602
	speed: 0.1545s/iter; left time: 107700.4730s
	iters: 1500, epoch: 9 | loss: 0.5766029
	speed: 0.1542s/iter; left time: 107498.0590s
	iters: 1600, epoch: 9 | loss: 0.6005394
	speed: 0.1542s/iter; left time: 107452.0655s
	iters: 1700, epoch: 9 | loss: 0.5799553
	speed: 0.1544s/iter; left time: 107609.4961s
	iters: 1800, epoch: 9 | loss: 0.4968188
	speed: 0.1552s/iter; left time: 108113.7769s
	iters: 1900, epoch: 9 | loss: 0.5716459
	speed: 0.1540s/iter; left time: 107297.8764s
	iters: 2000, epoch: 9 | loss: 0.5765914
	speed: 0.1523s/iter; left time: 106092.4813s
	iters: 2100, epoch: 9 | loss: 0.5390774
	speed: 0.1476s/iter; left time: 102766.9149s
	iters: 2200, epoch: 9 | loss: 0.5207565
	speed: 0.1447s/iter; left time: 100783.4022s
	iters: 2300, epoch: 9 | loss: 0.7422202
	speed: 0.1444s/iter; left time: 100503.6088s
	iters: 2400, epoch: 9 | loss: 0.6602682
	speed: 0.1449s/iter; left time: 100833.2080s
	iters: 2500, epoch: 9 | loss: 0.6701613
	speed: 0.1462s/iter; left time: 101730.8256s
	iters: 2600, epoch: 9 | loss: 0.6401016
	speed: 0.1448s/iter; left time: 100761.7196s
	iters: 2700, epoch: 9 | loss: 0.6035360
	speed: 0.1444s/iter; left time: 100444.4279s
	iters: 2800, epoch: 9 | loss: 0.6169615
	speed: 0.1440s/iter; left time: 100176.8755s
	iters: 2900, epoch: 9 | loss: 0.6123044
	speed: 0.1447s/iter; left time: 100663.2679s
	iters: 3000, epoch: 9 | loss: 0.6595074
	speed: 0.1442s/iter; left time: 100268.7549s
	iters: 3100, epoch: 9 | loss: 0.6583456
	speed: 0.1440s/iter; left time: 100114.5890s
	iters: 3200, epoch: 9 | loss: 0.5942736
	speed: 0.1440s/iter; left time: 100132.0867s
	iters: 3300, epoch: 9 | loss: 0.5274447
	speed: 0.1450s/iter; left time: 100781.2968s
	iters: 3400, epoch: 9 | loss: 0.5469200
	speed: 0.1476s/iter; left time: 102573.6179s
	iters: 3500, epoch: 9 | loss: 0.5358748
	speed: 0.1477s/iter; left time: 102676.0709s
	iters: 3600, epoch: 9 | loss: 0.4873949
	speed: 0.1474s/iter; left time: 102443.2639s
Epoch: 9 cost time: 544.0558331012726
Epoch: 9, Steps: 3638 | Train Loss: 0.5955504 Vali Loss: 1.0351981 Test Loss: 1.2141953
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems07_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247921
test shape: (24792, 1, 96, 1613) (24792, 1, 96, 1613)
test shape: (24792, 96, 1613) (24792, 96, 1613)
mse:1.0985679626464844, mae:0.8023906350135803
>>>>>>>Overall time: 11334 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
