Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=822, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems04_all_common_flow.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems04_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1216016
val 299677
test 299675
	iters: 100, epoch: 1 | loss: 1.1390486
	speed: 0.1416s/iter; left time: 10748.2530s
	iters: 200, epoch: 1 | loss: 1.4973886
	speed: 0.1346s/iter; left time: 10206.0151s
	iters: 300, epoch: 1 | loss: 1.4743354
	speed: 0.1346s/iter; left time: 10186.3896s
	iters: 400, epoch: 1 | loss: 1.7710613
	speed: 0.1345s/iter; left time: 10165.2779s
	iters: 500, epoch: 1 | loss: 1.5380225
	speed: 0.1344s/iter; left time: 10149.3801s
	iters: 600, epoch: 1 | loss: 1.7000711
	speed: 0.1344s/iter; left time: 10136.9602s
	iters: 700, epoch: 1 | loss: 1.5789552
	speed: 0.1344s/iter; left time: 10124.1585s
	iters: 800, epoch: 1 | loss: 1.5140169
	speed: 0.1344s/iter; left time: 10108.3660s
	iters: 900, epoch: 1 | loss: 1.6578664
	speed: 0.1345s/iter; left time: 10104.0418s
	iters: 1000, epoch: 1 | loss: 1.4142910
	speed: 0.1346s/iter; left time: 10091.4297s
	iters: 1100, epoch: 1 | loss: 1.5800977
	speed: 0.1346s/iter; left time: 10084.3829s
	iters: 1200, epoch: 1 | loss: 1.5894402
	speed: 0.1345s/iter; left time: 10063.3916s
	iters: 1300, epoch: 1 | loss: 1.9626880
	speed: 0.1344s/iter; left time: 10043.4509s
	iters: 1400, epoch: 1 | loss: 1.5752568
	speed: 0.1345s/iter; left time: 10031.4478s
	iters: 1500, epoch: 1 | loss: 1.6403905
	speed: 0.1345s/iter; left time: 10023.2047s
	iters: 1600, epoch: 1 | loss: 2.0539665
	speed: 0.1345s/iter; left time: 10007.0465s
	iters: 1700, epoch: 1 | loss: 1.6388084
	speed: 0.1344s/iter; left time: 9988.5023s
	iters: 1800, epoch: 1 | loss: 1.7255160
	speed: 0.1345s/iter; left time: 9976.9623s
	iters: 1900, epoch: 1 | loss: 1.6315336
	speed: 0.1345s/iter; left time: 9964.3670s
	iters: 2000, epoch: 1 | loss: 1.5153530
	speed: 0.1345s/iter; left time: 9954.9536s
	iters: 2100, epoch: 1 | loss: 1.6169400
	speed: 0.1344s/iter; left time: 9935.5452s
	iters: 2200, epoch: 1 | loss: 1.4668719
	speed: 0.1345s/iter; left time: 9926.9113s
	iters: 2300, epoch: 1 | loss: 1.6898451
	speed: 0.1344s/iter; left time: 9906.8662s
	iters: 2400, epoch: 1 | loss: 1.6056560
	speed: 0.1345s/iter; left time: 9898.6796s
	iters: 2500, epoch: 1 | loss: 1.6345018
	speed: 0.1344s/iter; left time: 9881.9981s
	iters: 2600, epoch: 1 | loss: 1.6174171
	speed: 0.1345s/iter; left time: 9870.8151s
	iters: 2700, epoch: 1 | loss: 1.4390360
	speed: 0.1346s/iter; left time: 9862.7164s
	iters: 2800, epoch: 1 | loss: 1.5127395
	speed: 0.1344s/iter; left time: 9839.3483s
	iters: 2900, epoch: 1 | loss: 1.8159792
	speed: 0.1344s/iter; left time: 9826.3791s
	iters: 3000, epoch: 1 | loss: 1.7155426
	speed: 0.1345s/iter; left time: 9816.4904s
	iters: 3100, epoch: 1 | loss: 1.8043694
	speed: 0.1345s/iter; left time: 9808.1588s
	iters: 3200, epoch: 1 | loss: 1.5973631
	speed: 0.1344s/iter; left time: 9783.6966s
	iters: 3300, epoch: 1 | loss: 1.3045316
	speed: 0.1344s/iter; left time: 9773.2348s
	iters: 3400, epoch: 1 | loss: 1.6001921
	speed: 0.1344s/iter; left time: 9758.0119s
	iters: 3500, epoch: 1 | loss: 1.5159323
	speed: 0.1344s/iter; left time: 9747.2652s
	iters: 3600, epoch: 1 | loss: 1.5473819
	speed: 0.1344s/iter; left time: 9729.1222s
	iters: 3700, epoch: 1 | loss: 1.5650493
	speed: 0.1344s/iter; left time: 9719.8155s
	iters: 3800, epoch: 1 | loss: 1.4343386
	speed: 0.1345s/iter; left time: 9709.8972s
	iters: 3900, epoch: 1 | loss: 1.6112406
	speed: 0.1345s/iter; left time: 9696.6200s
	iters: 4000, epoch: 1 | loss: 1.5403129
	speed: 0.1344s/iter; left time: 9675.5302s
	iters: 4100, epoch: 1 | loss: 1.5474410
	speed: 0.1344s/iter; left time: 9666.2549s
	iters: 4200, epoch: 1 | loss: 1.6415045
	speed: 0.1344s/iter; left time: 9647.8739s
	iters: 4300, epoch: 1 | loss: 1.5838172
	speed: 0.1344s/iter; left time: 9636.0452s
	iters: 4400, epoch: 1 | loss: 1.5094637
	speed: 0.1343s/iter; left time: 9619.3864s
	iters: 4500, epoch: 1 | loss: 1.7716503
	speed: 0.1344s/iter; left time: 9606.9493s
	iters: 4600, epoch: 1 | loss: 1.7986975
	speed: 0.1344s/iter; left time: 9596.6346s
	iters: 4700, epoch: 1 | loss: 1.6799245
	speed: 0.1343s/iter; left time: 9575.5351s
	iters: 4800, epoch: 1 | loss: 1.6251740
	speed: 0.1343s/iter; left time: 9563.4066s
	iters: 4900, epoch: 1 | loss: 1.6695799
	speed: 0.1344s/iter; left time: 9554.1528s
	iters: 5000, epoch: 1 | loss: 1.6157991
	speed: 0.1344s/iter; left time: 9541.9315s
	iters: 5100, epoch: 1 | loss: 2.0025337
	speed: 0.1343s/iter; left time: 9523.3242s
	iters: 5200, epoch: 1 | loss: 1.6175719
	speed: 0.1344s/iter; left time: 9513.4180s
	iters: 5300, epoch: 1 | loss: 1.6475861
	speed: 0.1343s/iter; left time: 9495.9860s
	iters: 5400, epoch: 1 | loss: 1.4480747
	speed: 0.1344s/iter; left time: 9488.7426s
	iters: 5500, epoch: 1 | loss: 1.7040716
	speed: 0.1343s/iter; left time: 9468.6758s
	iters: 5600, epoch: 1 | loss: 1.3906653
	speed: 0.1344s/iter; left time: 9458.7424s
	iters: 5700, epoch: 1 | loss: 1.7191948
	speed: 0.1344s/iter; left time: 9446.5036s
	iters: 5800, epoch: 1 | loss: 1.6045165
	speed: 0.1343s/iter; left time: 9428.6173s
	iters: 5900, epoch: 1 | loss: 1.4795790
	speed: 0.1343s/iter; left time: 9414.5750s
	iters: 6000, epoch: 1 | loss: 1.4651673
	speed: 0.1343s/iter; left time: 9403.4968s
	iters: 6100, epoch: 1 | loss: 1.5769271
	speed: 0.1343s/iter; left time: 9390.0232s
	iters: 6200, epoch: 1 | loss: 1.6452857
	speed: 0.1343s/iter; left time: 9372.2319s
	iters: 6300, epoch: 1 | loss: 1.7702370
	speed: 0.1343s/iter; left time: 9360.0583s
	iters: 6400, epoch: 1 | loss: 1.7099712
	speed: 0.1343s/iter; left time: 9346.8256s
	iters: 6500, epoch: 1 | loss: 1.6417856
	speed: 0.1344s/iter; left time: 9338.7926s
	iters: 6600, epoch: 1 | loss: 1.7119856
	speed: 0.1343s/iter; left time: 9318.1808s
	iters: 6700, epoch: 1 | loss: 1.5096867
	speed: 0.1342s/iter; left time: 9302.6555s
	iters: 6800, epoch: 1 | loss: 1.6512702
	speed: 0.1343s/iter; left time: 9290.3924s
	iters: 6900, epoch: 1 | loss: 1.7907407
	speed: 0.1343s/iter; left time: 9282.5186s
	iters: 7000, epoch: 1 | loss: 1.5785375
	speed: 0.1343s/iter; left time: 9263.8379s
	iters: 7100, epoch: 1 | loss: 1.6682692
	speed: 0.1343s/iter; left time: 9251.0158s
	iters: 7200, epoch: 1 | loss: 1.8170274
	speed: 0.1343s/iter; left time: 9237.8070s
	iters: 7300, epoch: 1 | loss: 1.5997007
	speed: 0.1343s/iter; left time: 9229.2776s
	iters: 7400, epoch: 1 | loss: 1.6994342
	speed: 0.1342s/iter; left time: 9209.3869s
	iters: 7500, epoch: 1 | loss: 1.6596141
	speed: 0.1343s/iter; left time: 9198.8705s
	iters: 7600, epoch: 1 | loss: 1.6422963
	speed: 0.1342s/iter; left time: 9181.1705s
Epoch: 1 cost time: 1022.3939323425293
Epoch: 1, Steps: 7600 | Train Loss: 1.6186428 Vali Loss: 1.7340690 Test Loss: 1.6133540
Validation loss decreased (inf --> 1.734069).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6712412
	speed: 5.5903s/iter; left time: 381823.8149s
	iters: 200, epoch: 2 | loss: 1.7731853
	speed: 0.1334s/iter; left time: 9099.7475s
	iters: 300, epoch: 2 | loss: 1.9726185
	speed: 0.1335s/iter; left time: 9092.6046s
	iters: 400, epoch: 2 | loss: 1.6080488
	speed: 0.1335s/iter; left time: 9079.9686s
	iters: 500, epoch: 2 | loss: 1.5843685
	speed: 0.1334s/iter; left time: 9060.2284s
	iters: 600, epoch: 2 | loss: 1.5284299
	speed: 0.1335s/iter; left time: 9050.7155s
	iters: 700, epoch: 2 | loss: 1.5828743
	speed: 0.1334s/iter; left time: 9033.7879s
	iters: 800, epoch: 2 | loss: 1.6809872
	speed: 0.1336s/iter; left time: 9028.3234s
	iters: 900, epoch: 2 | loss: 1.4842061
	speed: 0.1334s/iter; left time: 9007.3951s
	iters: 1000, epoch: 2 | loss: 1.7781615
	speed: 0.1335s/iter; left time: 8995.7924s
	iters: 1100, epoch: 2 | loss: 1.9414288
	speed: 0.1336s/iter; left time: 8990.9288s
	iters: 1200, epoch: 2 | loss: 1.7241098
	speed: 0.1335s/iter; left time: 8968.6433s
	iters: 1300, epoch: 2 | loss: 1.7020622
	speed: 0.1334s/iter; left time: 8954.5669s
	iters: 1400, epoch: 2 | loss: 1.4438341
	speed: 0.1335s/iter; left time: 8944.3231s
	iters: 1500, epoch: 2 | loss: 1.4486988
	speed: 0.1336s/iter; left time: 8935.5098s
	iters: 1600, epoch: 2 | loss: 1.8169905
	speed: 0.1335s/iter; left time: 8916.1471s
	iters: 1700, epoch: 2 | loss: 1.6595161
	speed: 0.1334s/iter; left time: 8899.9479s
	iters: 1800, epoch: 2 | loss: 1.4931046
	speed: 0.1335s/iter; left time: 8891.9027s
	iters: 1900, epoch: 2 | loss: 1.6619850
	speed: 0.1336s/iter; left time: 8882.8137s
	iters: 2000, epoch: 2 | loss: 1.5010320
	speed: 0.1335s/iter; left time: 8861.3145s
	iters: 2100, epoch: 2 | loss: 1.8254117
	speed: 0.1335s/iter; left time: 8852.1852s
	iters: 2200, epoch: 2 | loss: 1.6012223
	speed: 0.1336s/iter; left time: 8841.5601s
	iters: 2300, epoch: 2 | loss: 1.5404296
	speed: 0.1334s/iter; left time: 8819.7866s
	iters: 2400, epoch: 2 | loss: 1.5459371
	speed: 0.1335s/iter; left time: 8809.4299s
	iters: 2500, epoch: 2 | loss: 1.4542725
	speed: 0.1335s/iter; left time: 8795.3473s
	iters: 2600, epoch: 2 | loss: 1.8499854
	speed: 0.1336s/iter; left time: 8788.4840s
	iters: 2700, epoch: 2 | loss: 1.6273648
	speed: 0.1334s/iter; left time: 8766.8805s
	iters: 2800, epoch: 2 | loss: 1.7792138
	speed: 0.1335s/iter; left time: 8755.1521s
	iters: 2900, epoch: 2 | loss: 1.8270576
	speed: 0.1335s/iter; left time: 8744.0733s
	iters: 3000, epoch: 2 | loss: 1.6181328
	speed: 0.1335s/iter; left time: 8733.6498s
	iters: 3100, epoch: 2 | loss: 1.7747662
	speed: 0.1335s/iter; left time: 8715.0814s
	iters: 3200, epoch: 2 | loss: 1.8478144
	speed: 0.1334s/iter; left time: 8699.2822s
	iters: 3300, epoch: 2 | loss: 1.7558080
	speed: 0.1336s/iter; left time: 8697.9655s
	iters: 3400, epoch: 2 | loss: 1.5311606
	speed: 0.1336s/iter; left time: 8684.5087s
	iters: 3500, epoch: 2 | loss: 1.6373446
	speed: 0.1335s/iter; left time: 8665.2711s
	iters: 3600, epoch: 2 | loss: 1.5292181
	speed: 0.1336s/iter; left time: 8657.4052s
	iters: 3700, epoch: 2 | loss: 1.5895925
	speed: 0.1336s/iter; left time: 8645.4861s
	iters: 3800, epoch: 2 | loss: 1.5061923
	speed: 0.1335s/iter; left time: 8624.7554s
	iters: 3900, epoch: 2 | loss: 1.6632109
	speed: 0.1335s/iter; left time: 8613.8321s
	iters: 4000, epoch: 2 | loss: 1.6909002
	speed: 0.1335s/iter; left time: 8599.7683s
	iters: 4100, epoch: 2 | loss: 1.6460354
	speed: 0.1336s/iter; left time: 8593.8187s
	iters: 4200, epoch: 2 | loss: 1.6318114
	speed: 0.1335s/iter; left time: 8569.7089s
	iters: 4300, epoch: 2 | loss: 1.7255312
	speed: 0.1335s/iter; left time: 8558.2800s
	iters: 4400, epoch: 2 | loss: 1.4995074
	speed: 0.1335s/iter; left time: 8546.8746s
	iters: 4500, epoch: 2 | loss: 1.6434132
	speed: 0.1336s/iter; left time: 8538.0320s
	iters: 4600, epoch: 2 | loss: 1.5899583
	speed: 0.1335s/iter; left time: 8516.7640s
	iters: 4700, epoch: 2 | loss: 1.7012875
	speed: 0.1335s/iter; left time: 8503.4208s
	iters: 4800, epoch: 2 | loss: 1.4792628
	speed: 0.1335s/iter; left time: 8492.8203s
	iters: 4900, epoch: 2 | loss: 1.7617543
	speed: 0.1336s/iter; left time: 8485.0222s
	iters: 5000, epoch: 2 | loss: 1.6868927
	speed: 0.1335s/iter; left time: 8465.9571s
	iters: 5100, epoch: 2 | loss: 1.6866170
	speed: 0.1336s/iter; left time: 8457.8640s
	iters: 5200, epoch: 2 | loss: 1.7077202
	speed: 0.1336s/iter; left time: 8445.3826s
	iters: 5300, epoch: 2 | loss: 1.7343504
	speed: 0.1335s/iter; left time: 8424.6358s
	iters: 5400, epoch: 2 | loss: 1.5059052
	speed: 0.1335s/iter; left time: 8410.9220s
	iters: 5500, epoch: 2 | loss: 1.6608026
	speed: 0.1335s/iter; left time: 8399.5875s
	iters: 5600, epoch: 2 | loss: 1.5515931
	speed: 0.1335s/iter; left time: 8385.9082s
	iters: 5700, epoch: 2 | loss: 1.4693764
	speed: 0.1335s/iter; left time: 8370.2866s
	iters: 5800, epoch: 2 | loss: 1.8497541
	speed: 0.1335s/iter; left time: 8356.0345s
	iters: 5900, epoch: 2 | loss: 1.5093956
	speed: 0.1336s/iter; left time: 8350.8527s
	iters: 6000, epoch: 2 | loss: 1.7116716
	speed: 0.1335s/iter; left time: 8332.0931s
	iters: 6100, epoch: 2 | loss: 1.6637307
	speed: 0.1335s/iter; left time: 8314.3244s
	iters: 6200, epoch: 2 | loss: 1.5427680
	speed: 0.1335s/iter; left time: 8303.7938s
	iters: 6300, epoch: 2 | loss: 1.6410438
	speed: 0.1335s/iter; left time: 8289.7958s
	iters: 6400, epoch: 2 | loss: 1.7362694
	speed: 0.1336s/iter; left time: 8281.8074s
	iters: 6500, epoch: 2 | loss: 1.6395798
	speed: 0.1335s/iter; left time: 8261.9341s
	iters: 6600, epoch: 2 | loss: 1.6492057
	speed: 0.1336s/iter; left time: 8253.7338s
	iters: 6700, epoch: 2 | loss: 1.9016275
	speed: 0.1335s/iter; left time: 8237.7267s
	iters: 6800, epoch: 2 | loss: 1.7317940
	speed: 0.1334s/iter; left time: 8220.2070s
	iters: 6900, epoch: 2 | loss: 1.7782340
	speed: 0.1335s/iter; left time: 8207.9368s
	iters: 7000, epoch: 2 | loss: 1.7245054
	speed: 0.1335s/iter; left time: 8197.2091s
	iters: 7100, epoch: 2 | loss: 1.7813619
	speed: 0.1335s/iter; left time: 8185.7955s
	iters: 7200, epoch: 2 | loss: 1.7515891
	speed: 0.1334s/iter; left time: 8166.6586s
	iters: 7300, epoch: 2 | loss: 1.5266538
	speed: 0.1335s/iter; left time: 8154.6059s
	iters: 7400, epoch: 2 | loss: 1.5650160
	speed: 0.1334s/iter; left time: 8139.5654s
	iters: 7500, epoch: 2 | loss: 1.7286409
	speed: 0.1335s/iter; left time: 8131.9543s
	iters: 7600, epoch: 2 | loss: 1.5488603
	speed: 0.1334s/iter; left time: 8113.5770s
Epoch: 2 cost time: 1015.1300730705261
Epoch: 2, Steps: 7600 | Train Loss: 1.6521436 Vali Loss: 1.7372950 Test Loss: 1.6133348
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.8112125
	speed: 5.5589s/iter; left time: 337433.7739s
	iters: 200, epoch: 3 | loss: 1.5533645
	speed: 0.1337s/iter; left time: 8104.7116s
	iters: 300, epoch: 3 | loss: 1.7342416
	speed: 0.1337s/iter; left time: 8087.3782s
	iters: 400, epoch: 3 | loss: 1.9198421
	speed: 0.1337s/iter; left time: 8074.3950s
	iters: 500, epoch: 3 | loss: 1.5560277
	speed: 0.1337s/iter; left time: 8064.3888s
	iters: 600, epoch: 3 | loss: 1.6437554
	speed: 0.1337s/iter; left time: 8047.0435s
	iters: 700, epoch: 3 | loss: 1.6429279
	speed: 0.1337s/iter; left time: 8033.5106s
	iters: 800, epoch: 3 | loss: 1.9669138
	speed: 0.1337s/iter; left time: 8023.4883s
	iters: 900, epoch: 3 | loss: 1.8814307
	speed: 0.1338s/iter; left time: 8014.4857s
	iters: 1000, epoch: 3 | loss: 1.5831400
	speed: 0.1337s/iter; left time: 7993.0170s
	iters: 1100, epoch: 3 | loss: 1.5713297
	speed: 0.1337s/iter; left time: 7981.4652s
	iters: 1200, epoch: 3 | loss: 1.5226625
	speed: 0.1337s/iter; left time: 7971.0513s
	iters: 1300, epoch: 3 | loss: 1.4063061
	speed: 0.1338s/iter; left time: 7958.5043s
	iters: 1400, epoch: 3 | loss: 1.6759301
	speed: 0.1337s/iter; left time: 7940.9631s
	iters: 1500, epoch: 3 | loss: 1.7320793
	speed: 0.1337s/iter; left time: 7930.4427s
	iters: 1600, epoch: 3 | loss: 1.7450212
	speed: 0.1338s/iter; left time: 7920.9725s
	iters: 1700, epoch: 3 | loss: 1.6430786
	speed: 0.1337s/iter; left time: 7900.0610s
	iters: 1800, epoch: 3 | loss: 1.5916287
	speed: 0.1337s/iter; left time: 7886.9027s
	iters: 1900, epoch: 3 | loss: 1.6135790
	speed: 0.1337s/iter; left time: 7874.2102s
	iters: 2000, epoch: 3 | loss: 1.6863686
	speed: 0.1338s/iter; left time: 7867.8056s
	iters: 2100, epoch: 3 | loss: 1.6960365
	speed: 0.1336s/iter; left time: 7845.2693s
	iters: 2200, epoch: 3 | loss: 1.6984965
	speed: 0.1336s/iter; left time: 7831.7184s
	iters: 2300, epoch: 3 | loss: 1.5016451
	speed: 0.1337s/iter; left time: 7821.8850s
	iters: 2400, epoch: 3 | loss: 1.6000097
	speed: 0.1337s/iter; left time: 7810.2059s
	iters: 2500, epoch: 3 | loss: 1.8333912
	speed: 0.1336s/iter; left time: 7791.3287s
	iters: 2600, epoch: 3 | loss: 1.6842206
	speed: 0.1336s/iter; left time: 7778.5111s
	iters: 2700, epoch: 3 | loss: 1.5089754
	speed: 0.1337s/iter; left time: 7767.4779s
	iters: 2800, epoch: 3 | loss: 1.5889710
	speed: 0.1337s/iter; left time: 7757.2648s
	iters: 2900, epoch: 3 | loss: 1.7695502
	speed: 0.1336s/iter; left time: 7738.0335s
	iters: 3000, epoch: 3 | loss: 1.6009890
	speed: 0.1337s/iter; left time: 7725.6899s
	iters: 3100, epoch: 3 | loss: 1.4817975
	speed: 0.1337s/iter; left time: 7713.6956s
	iters: 3200, epoch: 3 | loss: 1.6188107
	speed: 0.1336s/iter; left time: 7697.5668s
	iters: 3300, epoch: 3 | loss: 1.6164937
	speed: 0.1336s/iter; left time: 7683.4152s
	iters: 3400, epoch: 3 | loss: 1.6459738
	speed: 0.1337s/iter; left time: 7671.7197s
	iters: 3500, epoch: 3 | loss: 1.5160388
	speed: 0.1337s/iter; left time: 7662.4418s
	iters: 3600, epoch: 3 | loss: 1.4903909
	speed: 0.1336s/iter; left time: 7642.8943s
	iters: 3700, epoch: 3 | loss: 1.6628072
	speed: 0.1336s/iter; left time: 7629.5861s
	iters: 3800, epoch: 3 | loss: 1.6146383
	speed: 0.1337s/iter; left time: 7618.4228s
	iters: 3900, epoch: 3 | loss: 1.5633285
	speed: 0.1337s/iter; left time: 7605.6272s
	iters: 4000, epoch: 3 | loss: 1.6573485
	speed: 0.1336s/iter; left time: 7588.4884s
	iters: 4100, epoch: 3 | loss: 1.6155558
	speed: 0.1336s/iter; left time: 7577.9904s
	iters: 4200, epoch: 3 | loss: 1.5155883
	speed: 0.1336s/iter; left time: 7562.9374s
	iters: 4300, epoch: 3 | loss: 1.7229879
	speed: 0.1337s/iter; left time: 7553.4739s
	iters: 4400, epoch: 3 | loss: 1.7629369
	speed: 0.1336s/iter; left time: 7534.2695s
	iters: 4500, epoch: 3 | loss: 1.7675223
	speed: 0.1336s/iter; left time: 7524.2265s
	iters: 4600, epoch: 3 | loss: 1.6273242
	speed: 0.1337s/iter; left time: 7514.1011s
	iters: 4700, epoch: 3 | loss: 1.7375773
	speed: 0.1336s/iter; left time: 7494.1245s
	iters: 4800, epoch: 3 | loss: 1.6647590
	speed: 0.1336s/iter; left time: 7481.4018s
	iters: 4900, epoch: 3 | loss: 1.5567104
	speed: 0.1336s/iter; left time: 7471.1107s
	iters: 5000, epoch: 3 | loss: 1.4523315
	speed: 0.1337s/iter; left time: 7459.2863s
	iters: 5100, epoch: 3 | loss: 1.7543905
	speed: 0.1336s/iter; left time: 7441.7570s
	iters: 5200, epoch: 3 | loss: 1.5816714
	speed: 0.1336s/iter; left time: 7426.7394s
	iters: 5300, epoch: 3 | loss: 1.7235917
	speed: 0.1336s/iter; left time: 7415.5901s
	iters: 5400, epoch: 3 | loss: 1.6675514
	speed: 0.1336s/iter; left time: 7402.8554s
	iters: 5500, epoch: 3 | loss: 1.6623217
	speed: 0.1335s/iter; left time: 7383.0973s
	iters: 5600, epoch: 3 | loss: 1.5777340
	speed: 0.1336s/iter; left time: 7372.8918s
	iters: 5700, epoch: 3 | loss: 1.6484009
	speed: 0.1336s/iter; left time: 7362.3149s
	iters: 5800, epoch: 3 | loss: 1.5912808
	speed: 0.1335s/iter; left time: 7342.3144s
	iters: 5900, epoch: 3 | loss: 1.2619532
	speed: 0.1335s/iter; left time: 7328.7418s
	iters: 6000, epoch: 3 | loss: 1.6416453
	speed: 0.1335s/iter; left time: 7318.6278s
	iters: 6100, epoch: 3 | loss: 1.7158178
	speed: 0.1336s/iter; left time: 7305.3548s
	iters: 6200, epoch: 3 | loss: 1.4314289
	speed: 0.1335s/iter; left time: 7288.4991s
	iters: 6300, epoch: 3 | loss: 1.7751719
	speed: 0.1335s/iter; left time: 7276.6133s
	iters: 6400, epoch: 3 | loss: 1.6615800
	speed: 0.1336s/iter; left time: 7265.3913s
	iters: 6500, epoch: 3 | loss: 1.9016075
	speed: 0.1336s/iter; left time: 7253.8254s
	iters: 6600, epoch: 3 | loss: 1.7730472
	speed: 0.1335s/iter; left time: 7235.2671s
	iters: 6700, epoch: 3 | loss: 1.5232955
	speed: 0.1336s/iter; left time: 7225.3114s
	iters: 6800, epoch: 3 | loss: 1.5954665
	speed: 0.1335s/iter; left time: 7208.8060s
	iters: 6900, epoch: 3 | loss: 1.7288264
	speed: 0.1335s/iter; left time: 7197.1280s
	iters: 7000, epoch: 3 | loss: 1.7593153
	speed: 0.1335s/iter; left time: 7181.3085s
	iters: 7100, epoch: 3 | loss: 1.5403355
	speed: 0.1336s/iter; left time: 7174.2516s
	iters: 7200, epoch: 3 | loss: 1.5302554
	speed: 0.1336s/iter; left time: 7161.9590s
	iters: 7300, epoch: 3 | loss: 1.6204029
	speed: 0.1335s/iter; left time: 7143.9144s
	iters: 7400, epoch: 3 | loss: 1.7205601
	speed: 0.1335s/iter; left time: 7131.3832s
	iters: 7500, epoch: 3 | loss: 1.6501255
	speed: 0.1336s/iter; left time: 7118.7921s
	iters: 7600, epoch: 3 | loss: 1.7447175
	speed: 0.1336s/iter; left time: 7108.3793s
Epoch: 3 cost time: 1016.0700557231903
Epoch: 3, Steps: 7600 | Train Loss: 1.6517974 Vali Loss: 1.7399150 Test Loss: 1.6146991
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6633826
	speed: 5.5904s/iter; left time: 296855.9934s
	iters: 200, epoch: 4 | loss: 1.5395987
	speed: 0.1333s/iter; left time: 7066.6716s
	iters: 300, epoch: 4 | loss: 1.5245379
	speed: 0.1334s/iter; left time: 7054.9216s
	iters: 400, epoch: 4 | loss: 1.6234570
	speed: 0.1333s/iter; left time: 7036.7372s
	iters: 500, epoch: 4 | loss: 1.5114337
	speed: 0.1334s/iter; left time: 7028.9476s
	iters: 600, epoch: 4 | loss: 1.5961418
	speed: 0.1333s/iter; left time: 7013.4398s
	iters: 700, epoch: 4 | loss: 1.6834831
	speed: 0.1334s/iter; left time: 7002.5482s
	iters: 800, epoch: 4 | loss: 1.5568410
	speed: 0.1333s/iter; left time: 6985.5170s
	iters: 900, epoch: 4 | loss: 1.6801724
	speed: 0.1334s/iter; left time: 6975.1745s
	iters: 1000, epoch: 4 | loss: 1.6520957
	speed: 0.1334s/iter; left time: 6963.0553s
	iters: 1100, epoch: 4 | loss: 1.6930609
	speed: 0.1333s/iter; left time: 6946.7923s
	iters: 1200, epoch: 4 | loss: 1.7506570
	speed: 0.1333s/iter; left time: 6933.1518s
	iters: 1300, epoch: 4 | loss: 1.6865696
	speed: 0.1334s/iter; left time: 6921.7355s
	iters: 1400, epoch: 4 | loss: 1.6178592
	speed: 0.1334s/iter; left time: 6909.8384s
	iters: 1500, epoch: 4 | loss: 1.5899670
	speed: 0.1333s/iter; left time: 6892.7919s
	iters: 1600, epoch: 4 | loss: 1.9100994
	speed: 0.1333s/iter; left time: 6879.4756s
	iters: 1700, epoch: 4 | loss: 1.5741594
	speed: 0.1334s/iter; left time: 6871.4717s
	iters: 1800, epoch: 4 | loss: 1.7816293
	speed: 0.1334s/iter; left time: 6855.4957s
	iters: 1900, epoch: 4 | loss: 1.6335163
	speed: 0.1333s/iter; left time: 6839.2372s
	iters: 2000, epoch: 4 | loss: 1.6320537
	speed: 0.1334s/iter; left time: 6828.1186s
	iters: 2100, epoch: 4 | loss: 1.7723397
	speed: 0.1333s/iter; left time: 6812.4804s
	iters: 2200, epoch: 4 | loss: 1.5808635
	speed: 0.1333s/iter; left time: 6800.9779s
	iters: 2300, epoch: 4 | loss: 1.6460128
	speed: 0.1333s/iter; left time: 6786.0842s
	iters: 2400, epoch: 4 | loss: 1.5888689
	speed: 0.1333s/iter; left time: 6773.5644s
	iters: 2500, epoch: 4 | loss: 1.6034753
	speed: 0.1334s/iter; left time: 6761.4126s
	iters: 2600, epoch: 4 | loss: 1.3890473
	speed: 0.1333s/iter; left time: 6745.2760s
	iters: 2700, epoch: 4 | loss: 1.6661258
	speed: 0.1333s/iter; left time: 6731.7163s
	iters: 2800, epoch: 4 | loss: 1.6331059
	speed: 0.1334s/iter; left time: 6721.7305s
	iters: 2900, epoch: 4 | loss: 1.6055884
	speed: 0.1334s/iter; left time: 6710.4244s
	iters: 3000, epoch: 4 | loss: 1.7592868
	speed: 0.1333s/iter; left time: 6691.0274s
	iters: 3100, epoch: 4 | loss: 1.6392382
	speed: 0.1333s/iter; left time: 6678.5016s
	iters: 3200, epoch: 4 | loss: 1.5677216
	speed: 0.1333s/iter; left time: 6665.1501s
	iters: 3300, epoch: 4 | loss: 1.7763544
	speed: 0.1334s/iter; left time: 6655.7387s
	iters: 3400, epoch: 4 | loss: 1.5879885
	speed: 0.1333s/iter; left time: 6637.7205s
	iters: 3500, epoch: 4 | loss: 1.4699446
	speed: 0.1334s/iter; left time: 6628.7293s
	iters: 3600, epoch: 4 | loss: 1.7410915
	speed: 0.1334s/iter; left time: 6616.6447s
	iters: 3700, epoch: 4 | loss: 1.7394383
	speed: 0.1333s/iter; left time: 6597.2581s
	iters: 3800, epoch: 4 | loss: 1.5402695
	speed: 0.1333s/iter; left time: 6584.5135s
	iters: 3900, epoch: 4 | loss: 1.6720790
	speed: 0.1334s/iter; left time: 6574.2958s
	iters: 4000, epoch: 4 | loss: 1.3387144
	speed: 0.1334s/iter; left time: 6562.6077s
	iters: 4100, epoch: 4 | loss: 1.7776487
	speed: 0.1333s/iter; left time: 6543.7105s
	iters: 4200, epoch: 4 | loss: 1.6453862
	speed: 0.1333s/iter; left time: 6531.2344s
	iters: 4300, epoch: 4 | loss: 1.6556199
	speed: 0.1333s/iter; left time: 6519.9814s
	iters: 4400, epoch: 4 | loss: 1.6041633
	speed: 0.1334s/iter; left time: 6509.8126s
	iters: 4500, epoch: 4 | loss: 1.4504704
	speed: 0.1333s/iter; left time: 6490.8262s
	iters: 4600, epoch: 4 | loss: 1.6634759
	speed: 0.1333s/iter; left time: 6477.5663s
	iters: 4700, epoch: 4 | loss: 1.4922861
	speed: 0.1333s/iter; left time: 6465.4964s
	iters: 4800, epoch: 4 | loss: 1.6923305
	speed: 0.1333s/iter; left time: 6453.5066s
	iters: 4900, epoch: 4 | loss: 1.5774232
	speed: 0.1332s/iter; left time: 6435.7335s
	iters: 5000, epoch: 4 | loss: 1.6491423
	speed: 0.1333s/iter; left time: 6424.8795s
	iters: 5100, epoch: 4 | loss: 1.5006956
	speed: 0.1333s/iter; left time: 6414.0163s
	iters: 5200, epoch: 4 | loss: 1.5423284
	speed: 0.1332s/iter; left time: 6395.9785s
	iters: 5300, epoch: 4 | loss: 1.6606777
	speed: 0.1333s/iter; left time: 6382.8982s
	iters: 5400, epoch: 4 | loss: 1.5120823
	speed: 0.1333s/iter; left time: 6369.6775s
	iters: 5500, epoch: 4 | loss: 1.6231710
	speed: 0.1334s/iter; left time: 6360.9349s
	iters: 5600, epoch: 4 | loss: 1.5472661
	speed: 0.1332s/iter; left time: 6342.7982s
	iters: 5700, epoch: 4 | loss: 1.6066780
	speed: 0.1332s/iter; left time: 6329.4909s
	iters: 5800, epoch: 4 | loss: 1.6332167
	speed: 0.1333s/iter; left time: 6317.5340s
	iters: 5900, epoch: 4 | loss: 1.6029377
	speed: 0.1333s/iter; left time: 6304.2192s
	iters: 6000, epoch: 4 | loss: 1.8720832
	speed: 0.1332s/iter; left time: 6289.0440s
	iters: 6100, epoch: 4 | loss: 1.5917418
	speed: 0.1332s/iter; left time: 6274.6046s
	iters: 6200, epoch: 4 | loss: 1.6029797
	speed: 0.1333s/iter; left time: 6263.2044s
	iters: 6300, epoch: 4 | loss: 1.5752832
	speed: 0.1333s/iter; left time: 6252.1128s
	iters: 6400, epoch: 4 | loss: 1.8418964
	speed: 0.1332s/iter; left time: 6234.8296s
	iters: 6500, epoch: 4 | loss: 1.4763181
	speed: 0.1332s/iter; left time: 6222.1213s
	iters: 6600, epoch: 4 | loss: 1.4315504
	speed: 0.1333s/iter; left time: 6213.7543s
	iters: 6700, epoch: 4 | loss: 1.6342924
	speed: 0.1332s/iter; left time: 6194.8118s
	iters: 6800, epoch: 4 | loss: 1.5634034
	speed: 0.1332s/iter; left time: 6181.9053s
	iters: 6900, epoch: 4 | loss: 1.9515054
	speed: 0.1332s/iter; left time: 6168.9435s
	iters: 7000, epoch: 4 | loss: 1.7400968
	speed: 0.1333s/iter; left time: 6157.9854s
	iters: 7100, epoch: 4 | loss: 1.4986432
	speed: 0.1332s/iter; left time: 6141.1215s
	iters: 7200, epoch: 4 | loss: 1.8102399
	speed: 0.1332s/iter; left time: 6127.4197s
	iters: 7300, epoch: 4 | loss: 1.6799399
	speed: 0.1332s/iter; left time: 6116.1405s
	iters: 7400, epoch: 4 | loss: 1.5123122
	speed: 0.1333s/iter; left time: 6104.6892s
	iters: 7500, epoch: 4 | loss: 1.7957560
	speed: 0.1332s/iter; left time: 6086.6581s
	iters: 7600, epoch: 4 | loss: 1.4746424
	speed: 0.1333s/iter; left time: 6077.6207s
Epoch: 4 cost time: 1013.5864858627319
Epoch: 4, Steps: 7600 | Train Loss: 1.6516829 Vali Loss: 1.7358412 Test Loss: 1.6132179
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 299675
test shape: (29967, 1, 720, 822) (29967, 1, 720, 822)
test shape: (29967, 720, 822) (29967, 720, 822)
