Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690438
val 89796
test 89794
	iters: 100, epoch: 1 | loss: 1.7023711
	speed: 0.0335s/iter; left time: 1441.2119s
	iters: 200, epoch: 1 | loss: 1.4766917
	speed: 0.0304s/iter; left time: 1305.7925s
	iters: 300, epoch: 1 | loss: 2.0086904
	speed: 0.0304s/iter; left time: 1301.8656s
	iters: 400, epoch: 1 | loss: 1.5600170
	speed: 0.0303s/iter; left time: 1296.1690s
	iters: 500, epoch: 1 | loss: 1.5878788
	speed: 0.0305s/iter; left time: 1302.8556s
	iters: 600, epoch: 1 | loss: 1.5655797
	speed: 0.0303s/iter; left time: 1288.6794s
	iters: 700, epoch: 1 | loss: 1.5793800
	speed: 0.0304s/iter; left time: 1289.1134s
	iters: 800, epoch: 1 | loss: 2.0540607
	speed: 0.0304s/iter; left time: 1288.6908s
	iters: 900, epoch: 1 | loss: 1.9181525
	speed: 0.0303s/iter; left time: 1281.6460s
	iters: 1000, epoch: 1 | loss: 1.3362617
	speed: 0.0305s/iter; left time: 1285.2225s
	iters: 1100, epoch: 1 | loss: 2.0666909
	speed: 0.0305s/iter; left time: 1281.8153s
	iters: 1200, epoch: 1 | loss: 1.6278095
	speed: 0.0304s/iter; left time: 1273.8879s
	iters: 1300, epoch: 1 | loss: 1.5113897
	speed: 0.0304s/iter; left time: 1273.5981s
	iters: 1400, epoch: 1 | loss: 1.4072155
	speed: 0.0304s/iter; left time: 1268.8242s
	iters: 1500, epoch: 1 | loss: 1.8461174
	speed: 0.0304s/iter; left time: 1264.3073s
	iters: 1600, epoch: 1 | loss: 1.4082561
	speed: 0.0304s/iter; left time: 1262.3133s
	iters: 1700, epoch: 1 | loss: 1.6623445
	speed: 0.0304s/iter; left time: 1260.6842s
	iters: 1800, epoch: 1 | loss: 1.7620229
	speed: 0.0304s/iter; left time: 1255.4122s
	iters: 1900, epoch: 1 | loss: 1.3777263
	speed: 0.0306s/iter; left time: 1262.1607s
	iters: 2000, epoch: 1 | loss: 1.4673073
	speed: 0.0303s/iter; left time: 1248.6921s
	iters: 2100, epoch: 1 | loss: 1.6276132
	speed: 0.0303s/iter; left time: 1245.7937s
	iters: 2200, epoch: 1 | loss: 1.4899619
	speed: 0.0304s/iter; left time: 1244.3658s
	iters: 2300, epoch: 1 | loss: 1.7772751
	speed: 0.0304s/iter; left time: 1241.4717s
	iters: 2400, epoch: 1 | loss: 1.6675023
	speed: 0.0304s/iter; left time: 1237.1279s
	iters: 2500, epoch: 1 | loss: 1.5838993
	speed: 0.0304s/iter; left time: 1235.0735s
	iters: 2600, epoch: 1 | loss: 1.6780159
	speed: 0.0304s/iter; left time: 1233.4715s
	iters: 2700, epoch: 1 | loss: 1.4109806
	speed: 0.0303s/iter; left time: 1227.0476s
	iters: 2800, epoch: 1 | loss: 1.8517468
	speed: 0.0304s/iter; left time: 1225.8307s
	iters: 2900, epoch: 1 | loss: 1.7705563
	speed: 0.0304s/iter; left time: 1222.7831s
	iters: 3000, epoch: 1 | loss: 1.6777893
	speed: 0.0304s/iter; left time: 1219.9329s
	iters: 3100, epoch: 1 | loss: 1.6219084
	speed: 0.0304s/iter; left time: 1217.0168s
	iters: 3200, epoch: 1 | loss: 1.4841168
	speed: 0.0304s/iter; left time: 1215.3277s
	iters: 3300, epoch: 1 | loss: 1.6737026
	speed: 0.0304s/iter; left time: 1210.6514s
	iters: 3400, epoch: 1 | loss: 1.5285405
	speed: 0.0304s/iter; left time: 1209.0312s
	iters: 3500, epoch: 1 | loss: 1.4706792
	speed: 0.0304s/iter; left time: 1206.0698s
	iters: 3600, epoch: 1 | loss: 1.8820299
	speed: 0.0303s/iter; left time: 1200.0688s
	iters: 3700, epoch: 1 | loss: 1.5298009
	speed: 0.0305s/iter; left time: 1203.0345s
	iters: 3800, epoch: 1 | loss: 1.7644662
	speed: 0.0304s/iter; left time: 1195.0725s
	iters: 3900, epoch: 1 | loss: 2.0684340
	speed: 0.0304s/iter; left time: 1192.4534s
	iters: 4000, epoch: 1 | loss: 1.3774951
	speed: 0.0304s/iter; left time: 1190.9437s
	iters: 4100, epoch: 1 | loss: 1.6375669
	speed: 0.0304s/iter; left time: 1185.9275s
	iters: 4200, epoch: 1 | loss: 1.3804805
	speed: 0.0304s/iter; left time: 1184.4811s
	iters: 4300, epoch: 1 | loss: 1.4779564
	speed: 0.0304s/iter; left time: 1179.8551s
Epoch: 1 cost time: 131.5385241508484
Epoch: 1, Steps: 4315 | Train Loss: 1.6309172 Vali Loss: 1.2778674 Test Loss: 1.5495008
Validation loss decreased (inf --> 1.277867).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 2.1945810
	speed: 0.4853s/iter; left time: 18796.8285s
	iters: 200, epoch: 2 | loss: 1.6119233
	speed: 0.0305s/iter; left time: 1178.9964s
	iters: 300, epoch: 2 | loss: 1.5571986
	speed: 0.0304s/iter; left time: 1170.8535s
	iters: 400, epoch: 2 | loss: 1.6725123
	speed: 0.0304s/iter; left time: 1166.9075s
	iters: 500, epoch: 2 | loss: 1.7220099
	speed: 0.0304s/iter; left time: 1165.8703s
	iters: 600, epoch: 2 | loss: 1.5805453
	speed: 0.0304s/iter; left time: 1160.6822s
	iters: 700, epoch: 2 | loss: 1.5294031
	speed: 0.0304s/iter; left time: 1159.3834s
	iters: 800, epoch: 2 | loss: 1.5810629
	speed: 0.0304s/iter; left time: 1156.4416s
	iters: 900, epoch: 2 | loss: 1.5273212
	speed: 0.0303s/iter; left time: 1151.1940s
	iters: 1000, epoch: 2 | loss: 1.8682309
	speed: 0.0304s/iter; left time: 1149.4738s
	iters: 1100, epoch: 2 | loss: 1.5176427
	speed: 0.0304s/iter; left time: 1146.3214s
	iters: 1200, epoch: 2 | loss: 1.3684611
	speed: 0.0304s/iter; left time: 1143.4119s
	iters: 1300, epoch: 2 | loss: 1.9075782
	speed: 0.0304s/iter; left time: 1140.1066s
	iters: 1400, epoch: 2 | loss: 1.6288239
	speed: 0.0305s/iter; left time: 1140.7311s
	iters: 1500, epoch: 2 | loss: 1.4360958
	speed: 0.0304s/iter; left time: 1135.5303s
	iters: 1600, epoch: 2 | loss: 1.3017291
	speed: 0.0304s/iter; left time: 1130.9898s
	iters: 1700, epoch: 2 | loss: 1.4743685
	speed: 0.0304s/iter; left time: 1128.6768s
	iters: 1800, epoch: 2 | loss: 1.7527419
	speed: 0.0304s/iter; left time: 1125.6446s
	iters: 1900, epoch: 2 | loss: 1.3979638
	speed: 0.0304s/iter; left time: 1122.0415s
	iters: 2000, epoch: 2 | loss: 1.7188340
	speed: 0.0304s/iter; left time: 1119.0083s
	iters: 2100, epoch: 2 | loss: 1.6648960
	speed: 0.0304s/iter; left time: 1116.7511s
	iters: 2200, epoch: 2 | loss: 1.6549805
	speed: 0.0304s/iter; left time: 1112.2548s
	iters: 2300, epoch: 2 | loss: 1.7497350
	speed: 0.0304s/iter; left time: 1110.4583s
	iters: 2400, epoch: 2 | loss: 1.7675270
	speed: 0.0303s/iter; left time: 1105.2424s
	iters: 2500, epoch: 2 | loss: 1.5791014
	speed: 0.0304s/iter; left time: 1104.0152s
	iters: 2600, epoch: 2 | loss: 1.5870748
	speed: 0.0304s/iter; left time: 1101.3558s
	iters: 2700, epoch: 2 | loss: 1.6218280
	speed: 0.0305s/iter; left time: 1102.0400s
	iters: 2800, epoch: 2 | loss: 1.5580297
	speed: 0.0303s/iter; left time: 1093.2436s
	iters: 2900, epoch: 2 | loss: 1.4507743
	speed: 0.0304s/iter; left time: 1090.7611s
	iters: 3000, epoch: 2 | loss: 1.5739363
	speed: 0.0304s/iter; left time: 1088.3580s
	iters: 3100, epoch: 2 | loss: 1.3624834
	speed: 0.0304s/iter; left time: 1085.4713s
	iters: 3200, epoch: 2 | loss: 1.8831652
	speed: 0.0304s/iter; left time: 1082.2483s
	iters: 3300, epoch: 2 | loss: 1.6830407
	speed: 0.0304s/iter; left time: 1079.8949s
	iters: 3400, epoch: 2 | loss: 1.5682904
	speed: 0.0304s/iter; left time: 1076.1504s
	iters: 3500, epoch: 2 | loss: 1.4946786
	speed: 0.0304s/iter; left time: 1073.1718s
	iters: 3600, epoch: 2 | loss: 1.8138322
	speed: 0.0304s/iter; left time: 1070.7953s
	iters: 3700, epoch: 2 | loss: 1.8675896
	speed: 0.0304s/iter; left time: 1066.5955s
	iters: 3800, epoch: 2 | loss: 1.6351330
	speed: 0.0304s/iter; left time: 1065.0915s
	iters: 3900, epoch: 2 | loss: 2.0106356
	speed: 0.0304s/iter; left time: 1061.0454s
	iters: 4000, epoch: 2 | loss: 1.4636325
	speed: 0.0304s/iter; left time: 1057.3516s
	iters: 4100, epoch: 2 | loss: 1.6823118
	speed: 0.0304s/iter; left time: 1054.2886s
	iters: 4200, epoch: 2 | loss: 1.4278301
	speed: 0.0305s/iter; left time: 1058.1110s
	iters: 4300, epoch: 2 | loss: 1.6582371
	speed: 0.0304s/iter; left time: 1048.3677s
Epoch: 2 cost time: 131.25085377693176
Epoch: 2, Steps: 4315 | Train Loss: 1.6402785 Vali Loss: 1.2757751 Test Loss: 1.5476059
Validation loss decreased (1.277867 --> 1.275775).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.5247210
	speed: 0.4836s/iter; left time: 16646.1912s
	iters: 200, epoch: 3 | loss: 1.2448364
	speed: 0.0304s/iter; left time: 1042.5129s
	iters: 300, epoch: 3 | loss: 1.5412049
	speed: 0.0304s/iter; left time: 1039.1649s
	iters: 400, epoch: 3 | loss: 1.6344699
	speed: 0.0304s/iter; left time: 1036.5672s
	iters: 500, epoch: 3 | loss: 1.4440421
	speed: 0.0305s/iter; left time: 1036.4549s
	iters: 600, epoch: 3 | loss: 1.5698850
	speed: 0.0303s/iter; left time: 1029.3546s
	iters: 700, epoch: 3 | loss: 1.9975339
	speed: 0.0304s/iter; left time: 1028.4838s
	iters: 800, epoch: 3 | loss: 1.4204537
	speed: 0.0304s/iter; left time: 1024.2852s
	iters: 900, epoch: 3 | loss: 1.8895364
	speed: 0.0304s/iter; left time: 1021.7785s
	iters: 1000, epoch: 3 | loss: 1.7423822
	speed: 0.0304s/iter; left time: 1018.2936s
	iters: 1100, epoch: 3 | loss: 1.7205286
	speed: 0.0304s/iter; left time: 1015.1524s
	iters: 1200, epoch: 3 | loss: 1.6378601
	speed: 0.0304s/iter; left time: 1011.6755s
	iters: 1300, epoch: 3 | loss: 1.4304861
	speed: 0.0304s/iter; left time: 1008.4793s
	iters: 1400, epoch: 3 | loss: 1.4548672
	speed: 0.0304s/iter; left time: 1005.9972s
	iters: 1500, epoch: 3 | loss: 1.5931655
	speed: 0.0304s/iter; left time: 1003.8552s
	iters: 1600, epoch: 3 | loss: 1.9997368
	speed: 0.0306s/iter; left time: 1007.6969s
	iters: 1700, epoch: 3 | loss: 1.5460728
	speed: 0.0304s/iter; left time: 996.2283s
	iters: 1800, epoch: 3 | loss: 1.3370013
	speed: 0.0304s/iter; left time: 993.7312s
	iters: 1900, epoch: 3 | loss: 1.2094884
	speed: 0.0305s/iter; left time: 994.0511s
	iters: 2000, epoch: 3 | loss: 1.5161154
	speed: 0.0304s/iter; left time: 988.6996s
	iters: 2100, epoch: 3 | loss: 1.5221792
	speed: 0.0304s/iter; left time: 984.8086s
	iters: 2200, epoch: 3 | loss: 1.6892269
	speed: 0.0304s/iter; left time: 983.0868s
	iters: 2300, epoch: 3 | loss: 1.5790193
	speed: 0.0304s/iter; left time: 978.3757s
	iters: 2400, epoch: 3 | loss: 1.7667956
	speed: 0.0304s/iter; left time: 976.1728s
	iters: 2500, epoch: 3 | loss: 1.5858010
	speed: 0.0304s/iter; left time: 973.8909s
	iters: 2600, epoch: 3 | loss: 1.5574210
	speed: 0.0304s/iter; left time: 969.8045s
	iters: 2700, epoch: 3 | loss: 1.4666421
	speed: 0.0304s/iter; left time: 966.4959s
	iters: 2800, epoch: 3 | loss: 1.6040864
	speed: 0.0304s/iter; left time: 963.6495s
	iters: 2900, epoch: 3 | loss: 2.0124128
	speed: 0.0304s/iter; left time: 960.1080s
	iters: 3000, epoch: 3 | loss: 1.6170038
	speed: 0.0304s/iter; left time: 957.4766s
	iters: 3100, epoch: 3 | loss: 1.7758882
	speed: 0.0304s/iter; left time: 954.6816s
	iters: 3200, epoch: 3 | loss: 1.7165730
	speed: 0.0304s/iter; left time: 950.8602s
	iters: 3300, epoch: 3 | loss: 1.3890742
	speed: 0.0304s/iter; left time: 948.5984s
	iters: 3400, epoch: 3 | loss: 2.0599174
	speed: 0.0307s/iter; left time: 956.1268s
	iters: 3500, epoch: 3 | loss: 1.8133514
	speed: 0.0304s/iter; left time: 942.8311s
	iters: 3600, epoch: 3 | loss: 2.3612123
	speed: 0.0305s/iter; left time: 942.3567s
	iters: 3700, epoch: 3 | loss: 1.3239495
	speed: 0.0304s/iter; left time: 936.7811s
	iters: 3800, epoch: 3 | loss: 1.7651900
	speed: 0.0304s/iter; left time: 932.5483s
	iters: 3900, epoch: 3 | loss: 1.7168609
	speed: 0.0306s/iter; left time: 935.9657s
	iters: 4000, epoch: 3 | loss: 1.3906921
	speed: 0.0304s/iter; left time: 927.7466s
	iters: 4100, epoch: 3 | loss: 1.7167146
	speed: 0.0304s/iter; left time: 924.1312s
	iters: 4200, epoch: 3 | loss: 1.4077449
	speed: 0.0305s/iter; left time: 923.9709s
	iters: 4300, epoch: 3 | loss: 1.5986854
	speed: 0.0304s/iter; left time: 918.0648s
Epoch: 3 cost time: 131.32962608337402
Epoch: 3, Steps: 4315 | Train Loss: 1.6397320 Vali Loss: 1.2758728 Test Loss: 1.5485599
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.4583453
	speed: 0.4838s/iter; left time: 14564.8451s
	iters: 200, epoch: 4 | loss: 1.6473765
	speed: 0.0304s/iter; left time: 911.1740s
	iters: 300, epoch: 4 | loss: 1.5672126
	speed: 0.0304s/iter; left time: 909.0563s
	iters: 400, epoch: 4 | loss: 1.8237280
	speed: 0.0304s/iter; left time: 905.9730s
	iters: 500, epoch: 4 | loss: 1.4235924
	speed: 0.0304s/iter; left time: 902.5118s
	iters: 600, epoch: 4 | loss: 2.2806184
	speed: 0.0304s/iter; left time: 900.0097s
	iters: 700, epoch: 4 | loss: 1.5448414
	speed: 0.0305s/iter; left time: 898.9749s
	iters: 800, epoch: 4 | loss: 1.4474529
	speed: 0.0304s/iter; left time: 893.6287s
	iters: 900, epoch: 4 | loss: 1.6100731
	speed: 0.0304s/iter; left time: 890.2079s
	iters: 1000, epoch: 4 | loss: 1.8306297
	speed: 0.0305s/iter; left time: 891.2313s
	iters: 1100, epoch: 4 | loss: 1.8000927
	speed: 0.0304s/iter; left time: 884.4300s
	iters: 1200, epoch: 4 | loss: 1.4189198
	speed: 0.0304s/iter; left time: 881.0461s
	iters: 1300, epoch: 4 | loss: 1.4229003
	speed: 0.0304s/iter; left time: 878.1030s
	iters: 1400, epoch: 4 | loss: 1.4605390
	speed: 0.0304s/iter; left time: 877.0088s
	iters: 1500, epoch: 4 | loss: 1.8160579
	speed: 0.0304s/iter; left time: 871.8681s
	iters: 1600, epoch: 4 | loss: 1.7460861
	speed: 0.0304s/iter; left time: 869.0098s
	iters: 1700, epoch: 4 | loss: 2.0232458
	speed: 0.0304s/iter; left time: 867.8642s
	iters: 1800, epoch: 4 | loss: 1.3434663
	speed: 0.0304s/iter; left time: 863.4810s
	iters: 1900, epoch: 4 | loss: 1.8344997
	speed: 0.0304s/iter; left time: 860.3528s
	iters: 2000, epoch: 4 | loss: 1.3624384
	speed: 0.0304s/iter; left time: 857.1065s
	iters: 2100, epoch: 4 | loss: 1.9117543
	speed: 0.0303s/iter; left time: 852.8718s
	iters: 2200, epoch: 4 | loss: 1.5952488
	speed: 0.0305s/iter; left time: 854.0054s
	iters: 2300, epoch: 4 | loss: 1.8252966
	speed: 0.0304s/iter; left time: 848.0342s
	iters: 2400, epoch: 4 | loss: 2.0273459
	speed: 0.0304s/iter; left time: 845.5416s
	iters: 2500, epoch: 4 | loss: 1.5342641
	speed: 0.0304s/iter; left time: 841.5574s
	iters: 2600, epoch: 4 | loss: 1.5833503
	speed: 0.0305s/iter; left time: 841.9483s
	iters: 2700, epoch: 4 | loss: 1.2937995
	speed: 0.0304s/iter; left time: 836.8311s
	iters: 2800, epoch: 4 | loss: 1.9035462
	speed: 0.0304s/iter; left time: 833.1347s
	iters: 2900, epoch: 4 | loss: 1.5431067
	speed: 0.0304s/iter; left time: 828.9326s
	iters: 3000, epoch: 4 | loss: 1.8805944
	speed: 0.0305s/iter; left time: 829.0921s
	iters: 3100, epoch: 4 | loss: 1.8571619
	speed: 0.0304s/iter; left time: 823.9207s
	iters: 3200, epoch: 4 | loss: 1.6868840
	speed: 0.0304s/iter; left time: 820.0964s
	iters: 3300, epoch: 4 | loss: 1.4586711
	speed: 0.0304s/iter; left time: 817.0476s
	iters: 3400, epoch: 4 | loss: 1.4440480
	speed: 0.0304s/iter; left time: 814.9944s
	iters: 3500, epoch: 4 | loss: 1.4923711
	speed: 0.0303s/iter; left time: 810.4517s
	iters: 3600, epoch: 4 | loss: 1.7245271
	speed: 0.0304s/iter; left time: 808.4220s
	iters: 3700, epoch: 4 | loss: 1.4133630
	speed: 0.0303s/iter; left time: 804.3009s
	iters: 3800, epoch: 4 | loss: 1.5308549
	speed: 0.0305s/iter; left time: 805.1833s
	iters: 3900, epoch: 4 | loss: 1.4487450
	speed: 0.0304s/iter; left time: 799.8894s
	iters: 4000, epoch: 4 | loss: 1.7355732
	speed: 0.0304s/iter; left time: 795.9962s
	iters: 4100, epoch: 4 | loss: 1.6350369
	speed: 0.0304s/iter; left time: 793.4139s
	iters: 4200, epoch: 4 | loss: 1.5663937
	speed: 0.0304s/iter; left time: 789.9177s
	iters: 4300, epoch: 4 | loss: 1.5088981
	speed: 0.0304s/iter; left time: 786.6897s
Epoch: 4 cost time: 131.3012969493866
Epoch: 4, Steps: 4315 | Train Loss: 1.6395257 Vali Loss: 1.2756361 Test Loss: 1.5499569
Validation loss decreased (1.275775 --> 1.275636).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.6286734
	speed: 0.4847s/iter; left time: 12501.0193s
	iters: 200, epoch: 5 | loss: 1.4835531
	speed: 0.0305s/iter; left time: 782.4752s
	iters: 300, epoch: 5 | loss: 1.4430200
	speed: 0.0304s/iter; left time: 776.7832s
	iters: 400, epoch: 5 | loss: 1.7811179
	speed: 0.0305s/iter; left time: 776.5083s
	iters: 500, epoch: 5 | loss: 1.6992762
	speed: 0.0304s/iter; left time: 771.9262s
	iters: 600, epoch: 5 | loss: 1.5086285
	speed: 0.0304s/iter; left time: 767.6787s
	iters: 700, epoch: 5 | loss: 1.7399375
	speed: 0.0304s/iter; left time: 765.3149s
	iters: 800, epoch: 5 | loss: 1.5706805
	speed: 0.0304s/iter; left time: 762.7300s
	iters: 900, epoch: 5 | loss: 1.6176654
	speed: 0.0304s/iter; left time: 759.5480s
	iters: 1000, epoch: 5 | loss: 1.6895723
	speed: 0.0304s/iter; left time: 755.5755s
	iters: 1100, epoch: 5 | loss: 1.6348889
	speed: 0.0305s/iter; left time: 756.1239s
	iters: 1200, epoch: 5 | loss: 1.7445756
	speed: 0.0304s/iter; left time: 750.0166s
	iters: 1300, epoch: 5 | loss: 1.6257435
	speed: 0.0304s/iter; left time: 746.9091s
	iters: 1400, epoch: 5 | loss: 1.4712193
	speed: 0.0305s/iter; left time: 746.6605s
	iters: 1500, epoch: 5 | loss: 1.4397486
	speed: 0.0304s/iter; left time: 741.5261s
	iters: 1600, epoch: 5 | loss: 1.8009237
	speed: 0.0305s/iter; left time: 741.3467s
	iters: 1700, epoch: 5 | loss: 1.5730917
	speed: 0.0304s/iter; left time: 734.3463s
	iters: 1800, epoch: 5 | loss: 1.6322026
	speed: 0.0305s/iter; left time: 734.5604s
	iters: 1900, epoch: 5 | loss: 1.7996831
	speed: 0.0305s/iter; left time: 731.5486s
	iters: 2000, epoch: 5 | loss: 1.4003705
	speed: 0.0304s/iter; left time: 725.8514s
	iters: 2100, epoch: 5 | loss: 1.4156535
	speed: 0.0304s/iter; left time: 722.9157s
	iters: 2200, epoch: 5 | loss: 1.5004332
	speed: 0.0304s/iter; left time: 720.0564s
	iters: 2300, epoch: 5 | loss: 1.6881869
	speed: 0.0304s/iter; left time: 716.7807s
	iters: 2400, epoch: 5 | loss: 1.3520939
	speed: 0.0304s/iter; left time: 714.0812s
	iters: 2500, epoch: 5 | loss: 1.8362427
	speed: 0.0304s/iter; left time: 710.5305s
	iters: 2600, epoch: 5 | loss: 1.5701891
	speed: 0.0305s/iter; left time: 710.1494s
	iters: 2700, epoch: 5 | loss: 1.5494161
	speed: 0.0303s/iter; left time: 703.6134s
	iters: 2800, epoch: 5 | loss: 1.9288384
	speed: 0.0305s/iter; left time: 705.1910s
	iters: 2900, epoch: 5 | loss: 1.6222107
	speed: 0.0304s/iter; left time: 698.8347s
	iters: 3000, epoch: 5 | loss: 1.6898082
	speed: 0.0304s/iter; left time: 696.5279s
	iters: 3100, epoch: 5 | loss: 1.4146702
	speed: 0.0304s/iter; left time: 691.8855s
	iters: 3200, epoch: 5 | loss: 1.6727042
	speed: 0.0304s/iter; left time: 690.0171s
	iters: 3300, epoch: 5 | loss: 1.3499494
	speed: 0.0305s/iter; left time: 688.3871s
	iters: 3400, epoch: 5 | loss: 1.5759892
	speed: 0.0304s/iter; left time: 683.2914s
	iters: 3500, epoch: 5 | loss: 1.5026350
	speed: 0.0303s/iter; left time: 679.4908s
	iters: 3600, epoch: 5 | loss: 1.6529046
	speed: 0.0304s/iter; left time: 677.1126s
	iters: 3700, epoch: 5 | loss: 1.6345632
	speed: 0.0305s/iter; left time: 676.0361s
	iters: 3800, epoch: 5 | loss: 1.5609826
	speed: 0.0304s/iter; left time: 671.2768s
	iters: 3900, epoch: 5 | loss: 1.8711656
	speed: 0.0304s/iter; left time: 667.4839s
	iters: 4000, epoch: 5 | loss: 1.6103333
	speed: 0.0304s/iter; left time: 665.3560s
	iters: 4100, epoch: 5 | loss: 1.8605405
	speed: 0.0304s/iter; left time: 661.6476s
	iters: 4200, epoch: 5 | loss: 1.6877520
	speed: 0.0304s/iter; left time: 659.0466s
	iters: 4300, epoch: 5 | loss: 1.7526028
	speed: 0.0304s/iter; left time: 655.7077s
Epoch: 5 cost time: 131.33075141906738
Epoch: 5, Steps: 4315 | Train Loss: 1.6395078 Vali Loss: 1.2761531 Test Loss: 1.5466136
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.7120659
	speed: 0.4854s/iter; left time: 10424.4135s
	iters: 200, epoch: 6 | loss: 1.7831498
	speed: 0.0304s/iter; left time: 649.6918s
	iters: 300, epoch: 6 | loss: 1.4622076
	speed: 0.0304s/iter; left time: 646.3401s
	iters: 400, epoch: 6 | loss: 1.5423034
	speed: 0.0304s/iter; left time: 643.9101s
	iters: 500, epoch: 6 | loss: 1.5969423
	speed: 0.0304s/iter; left time: 639.9459s
	iters: 600, epoch: 6 | loss: 1.5259732
	speed: 0.0304s/iter; left time: 637.6394s
	iters: 700, epoch: 6 | loss: 1.6960866
	speed: 0.0304s/iter; left time: 634.0877s
	iters: 800, epoch: 6 | loss: 1.4615098
	speed: 0.0304s/iter; left time: 630.9668s
	iters: 900, epoch: 6 | loss: 1.3559226
	speed: 0.0304s/iter; left time: 627.7170s
	iters: 1000, epoch: 6 | loss: 1.7891237
	speed: 0.0304s/iter; left time: 625.5121s
	iters: 1100, epoch: 6 | loss: 1.5597283
	speed: 0.0304s/iter; left time: 622.3964s
	iters: 1200, epoch: 6 | loss: 1.7769510
	speed: 0.0304s/iter; left time: 618.9624s
	iters: 1300, epoch: 6 | loss: 1.5502378
	speed: 0.0304s/iter; left time: 615.5636s
	iters: 1400, epoch: 6 | loss: 1.7385160
	speed: 0.0303s/iter; left time: 611.8554s
	iters: 1500, epoch: 6 | loss: 1.8430146
	speed: 0.0304s/iter; left time: 609.8112s
	iters: 1600, epoch: 6 | loss: 1.7737566
	speed: 0.0303s/iter; left time: 605.8539s
	iters: 1700, epoch: 6 | loss: 1.4303817
	speed: 0.0304s/iter; left time: 603.6362s
	iters: 1800, epoch: 6 | loss: 1.4669149
	speed: 0.0304s/iter; left time: 600.6320s
	iters: 1900, epoch: 6 | loss: 1.7322170
	speed: 0.0304s/iter; left time: 597.6980s
	iters: 2000, epoch: 6 | loss: 1.6407973
	speed: 0.0306s/iter; left time: 598.0588s
	iters: 2100, epoch: 6 | loss: 1.5514853
	speed: 0.0304s/iter; left time: 591.4151s
	iters: 2200, epoch: 6 | loss: 1.4697664
	speed: 0.0304s/iter; left time: 588.1901s
	iters: 2300, epoch: 6 | loss: 1.6015142
	speed: 0.0304s/iter; left time: 585.3754s
	iters: 2400, epoch: 6 | loss: 1.6824419
	speed: 0.0305s/iter; left time: 584.6423s
	iters: 2500, epoch: 6 | loss: 1.5382571
	speed: 0.0306s/iter; left time: 583.6513s
	iters: 2600, epoch: 6 | loss: 1.4757000
	speed: 0.0306s/iter; left time: 580.1342s
	iters: 2700, epoch: 6 | loss: 1.4822884
	speed: 0.0304s/iter; left time: 573.2670s
	iters: 2800, epoch: 6 | loss: 1.2878536
	speed: 0.0304s/iter; left time: 570.4277s
	iters: 2900, epoch: 6 | loss: 1.4663318
	speed: 0.0304s/iter; left time: 567.7403s
	iters: 3000, epoch: 6 | loss: 1.7316589
	speed: 0.0304s/iter; left time: 563.7835s
	iters: 3100, epoch: 6 | loss: 1.6744018
	speed: 0.0303s/iter; left time: 560.5260s
	iters: 3200, epoch: 6 | loss: 1.6745429
	speed: 0.0304s/iter; left time: 558.2487s
	iters: 3300, epoch: 6 | loss: 1.5167637
	speed: 0.0304s/iter; left time: 555.0064s
	iters: 3400, epoch: 6 | loss: 1.8394127
	speed: 0.0304s/iter; left time: 553.3328s
	iters: 3500, epoch: 6 | loss: 1.3768839
	speed: 0.0303s/iter; left time: 548.3370s
	iters: 3600, epoch: 6 | loss: 1.8066285
	speed: 0.0304s/iter; left time: 545.7151s
	iters: 3700, epoch: 6 | loss: 1.4291234
	speed: 0.0305s/iter; left time: 544.5942s
	iters: 3800, epoch: 6 | loss: 1.6896410
	speed: 0.0304s/iter; left time: 540.4082s
	iters: 3900, epoch: 6 | loss: 1.6248995
	speed: 0.0304s/iter; left time: 536.8301s
	iters: 4000, epoch: 6 | loss: 1.7015257
	speed: 0.0304s/iter; left time: 534.4403s
	iters: 4100, epoch: 6 | loss: 1.5187813
	speed: 0.0304s/iter; left time: 530.4206s
	iters: 4200, epoch: 6 | loss: 1.5407971
	speed: 0.0304s/iter; left time: 528.1449s
	iters: 4300, epoch: 6 | loss: 1.7818460
	speed: 0.0304s/iter; left time: 525.0088s
Epoch: 6 cost time: 131.270516872406
Epoch: 6, Steps: 4315 | Train Loss: 1.6394394 Vali Loss: 1.2762268 Test Loss: 1.5481193
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 1.3671060
	speed: 0.4857s/iter; left time: 8334.7655s
	iters: 200, epoch: 7 | loss: 1.6588761
	speed: 0.0304s/iter; left time: 518.6842s
	iters: 300, epoch: 7 | loss: 1.6026387
	speed: 0.0304s/iter; left time: 515.5977s
	iters: 400, epoch: 7 | loss: 1.6019814
	speed: 0.0304s/iter; left time: 512.1954s
	iters: 500, epoch: 7 | loss: 1.9544082
	speed: 0.0304s/iter; left time: 509.1463s
	iters: 600, epoch: 7 | loss: 1.5640602
	speed: 0.0304s/iter; left time: 506.2452s
	iters: 700, epoch: 7 | loss: 1.7022989
	speed: 0.0304s/iter; left time: 503.3219s
	iters: 800, epoch: 7 | loss: 1.6098046
	speed: 0.0303s/iter; left time: 499.2237s
	iters: 900, epoch: 7 | loss: 1.6051115
	speed: 0.0305s/iter; left time: 498.8909s
	iters: 1000, epoch: 7 | loss: 1.7084367
	speed: 0.0304s/iter; left time: 494.3503s
	iters: 1100, epoch: 7 | loss: 1.4330822
	speed: 0.0304s/iter; left time: 490.8339s
	iters: 1200, epoch: 7 | loss: 1.7377293
	speed: 0.0304s/iter; left time: 488.1854s
	iters: 1300, epoch: 7 | loss: 1.6697696
	speed: 0.0304s/iter; left time: 485.4158s
	iters: 1400, epoch: 7 | loss: 1.6077085
	speed: 0.0304s/iter; left time: 482.4638s
	iters: 1500, epoch: 7 | loss: 1.4310997
	speed: 0.0304s/iter; left time: 479.0272s
	iters: 1600, epoch: 7 | loss: 1.3882780
	speed: 0.0304s/iter; left time: 476.0566s
	iters: 1700, epoch: 7 | loss: 1.6392577
	speed: 0.0304s/iter; left time: 473.0992s
	iters: 1800, epoch: 7 | loss: 1.3520066
	speed: 0.0304s/iter; left time: 470.2148s
	iters: 1900, epoch: 7 | loss: 1.5584661
	speed: 0.0304s/iter; left time: 466.6431s
	iters: 2000, epoch: 7 | loss: 1.4704398
	speed: 0.0304s/iter; left time: 463.8803s
	iters: 2100, epoch: 7 | loss: 1.3482249
	speed: 0.0304s/iter; left time: 460.8636s
	iters: 2200, epoch: 7 | loss: 1.8555124
	speed: 0.0304s/iter; left time: 457.3881s
	iters: 2300, epoch: 7 | loss: 1.4522731
	speed: 0.0304s/iter; left time: 454.9536s
	iters: 2400, epoch: 7 | loss: 1.6212860
	speed: 0.0304s/iter; left time: 451.6655s
	iters: 2500, epoch: 7 | loss: 1.6147549
	speed: 0.0304s/iter; left time: 448.8572s
	iters: 2600, epoch: 7 | loss: 1.4653165
	speed: 0.0304s/iter; left time: 445.4005s
	iters: 2700, epoch: 7 | loss: 1.4553217
	speed: 0.0304s/iter; left time: 442.8047s
	iters: 2800, epoch: 7 | loss: 1.8705751
	speed: 0.0304s/iter; left time: 439.3882s
	iters: 2900, epoch: 7 | loss: 1.5197024
	speed: 0.0303s/iter; left time: 434.9587s
	iters: 3000, epoch: 7 | loss: 1.8716228
	speed: 0.0304s/iter; left time: 433.5316s
	iters: 3100, epoch: 7 | loss: 1.6448550
	speed: 0.0304s/iter; left time: 430.1742s
	iters: 3200, epoch: 7 | loss: 1.4233491
	speed: 0.0304s/iter; left time: 427.1797s
	iters: 3300, epoch: 7 | loss: 1.6593168
	speed: 0.0304s/iter; left time: 424.0212s
	iters: 3400, epoch: 7 | loss: 1.6276337
	speed: 0.0304s/iter; left time: 420.8162s
	iters: 3500, epoch: 7 | loss: 1.7168638
	speed: 0.0304s/iter; left time: 417.7343s
	iters: 3600, epoch: 7 | loss: 1.5153157
	speed: 0.0304s/iter; left time: 415.5594s
	iters: 3700, epoch: 7 | loss: 1.6159467
	speed: 0.0304s/iter; left time: 412.1500s
	iters: 3800, epoch: 7 | loss: 1.7168745
	speed: 0.0304s/iter; left time: 409.1750s
	iters: 3900, epoch: 7 | loss: 1.4722409
	speed: 0.0305s/iter; left time: 407.4316s
	iters: 4000, epoch: 7 | loss: 1.5874642
	speed: 0.0304s/iter; left time: 402.8389s
	iters: 4100, epoch: 7 | loss: 2.0558164
	speed: 0.0304s/iter; left time: 399.8087s
	iters: 4200, epoch: 7 | loss: 1.6763812
	speed: 0.0304s/iter; left time: 397.3771s
	iters: 4300, epoch: 7 | loss: 1.5510585
	speed: 0.0304s/iter; left time: 393.8663s
Epoch: 7 cost time: 131.25320100784302
Epoch: 7, Steps: 4315 | Train Loss: 1.6394408 Vali Loss: 1.2757964 Test Loss: 1.5485563
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 89794
test shape: (8979, 1, 336, 130) (8979, 1, 336, 130)
test shape: (8979, 336, 130) (8979, 336, 130)
mse:1.5499544143676758, mae:0.9704790115356445
>>>>>>>Overall time: 1345 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
