Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 945359
val 44347
test 194530
	iters: 100, epoch: 1 | loss: 1.5405458
	speed: 0.0354s/iter; left time: 2086.1757s
	iters: 200, epoch: 1 | loss: 1.4698012
	speed: 0.0315s/iter; left time: 1855.8909s
	iters: 300, epoch: 1 | loss: 1.4492202
	speed: 0.0315s/iter; left time: 1851.1375s
	iters: 400, epoch: 1 | loss: 1.6119499
	speed: 0.0315s/iter; left time: 1849.5369s
	iters: 500, epoch: 1 | loss: 1.6718247
	speed: 0.0312s/iter; left time: 1829.4498s
	iters: 600, epoch: 1 | loss: 1.3248290
	speed: 0.0316s/iter; left time: 1846.7520s
	iters: 700, epoch: 1 | loss: 1.3780501
	speed: 0.0312s/iter; left time: 1823.3304s
	iters: 800, epoch: 1 | loss: 1.9609741
	speed: 0.0314s/iter; left time: 1832.3416s
	iters: 900, epoch: 1 | loss: 2.3946817
	speed: 0.0310s/iter; left time: 1805.8010s
	iters: 1000, epoch: 1 | loss: 1.5040985
	speed: 0.0310s/iter; left time: 1803.0485s
	iters: 1100, epoch: 1 | loss: 1.3531674
	speed: 0.0312s/iter; left time: 1810.6871s
	iters: 1200, epoch: 1 | loss: 1.4902424
	speed: 0.0308s/iter; left time: 1781.5306s
	iters: 1300, epoch: 1 | loss: 1.6440796
	speed: 0.0313s/iter; left time: 1809.6921s
	iters: 1400, epoch: 1 | loss: 1.9671060
	speed: 0.0314s/iter; left time: 1813.8159s
	iters: 1500, epoch: 1 | loss: 1.6245397
	speed: 0.0312s/iter; left time: 1799.2090s
	iters: 1600, epoch: 1 | loss: 1.7369982
	speed: 0.0314s/iter; left time: 1806.1439s
	iters: 1700, epoch: 1 | loss: 1.8789823
	speed: 0.0313s/iter; left time: 1796.5566s
	iters: 1800, epoch: 1 | loss: 1.7083974
	speed: 0.0312s/iter; left time: 1788.4374s
	iters: 1900, epoch: 1 | loss: 1.9436197
	speed: 0.0310s/iter; left time: 1771.9616s
	iters: 2000, epoch: 1 | loss: 1.8976692
	speed: 0.0311s/iter; left time: 1777.9896s
	iters: 2100, epoch: 1 | loss: 1.8751910
	speed: 0.0317s/iter; left time: 1806.7018s
	iters: 2200, epoch: 1 | loss: 1.4946355
	speed: 0.0313s/iter; left time: 1780.4447s
	iters: 2300, epoch: 1 | loss: 1.9191884
	speed: 0.0314s/iter; left time: 1783.3552s
	iters: 2400, epoch: 1 | loss: 1.7178055
	speed: 0.0314s/iter; left time: 1779.9655s
	iters: 2500, epoch: 1 | loss: 1.3167733
	speed: 0.0310s/iter; left time: 1753.7043s
	iters: 2600, epoch: 1 | loss: 1.3409358
	speed: 0.0312s/iter; left time: 1763.5989s
	iters: 2700, epoch: 1 | loss: 1.4150748
	speed: 0.0314s/iter; left time: 1769.1174s
	iters: 2800, epoch: 1 | loss: 2.1463175
	speed: 0.0315s/iter; left time: 1773.4952s
	iters: 2900, epoch: 1 | loss: 1.5174009
	speed: 0.0312s/iter; left time: 1751.4891s
	iters: 3000, epoch: 1 | loss: 1.2575816
	speed: 0.0310s/iter; left time: 1738.0537s
	iters: 3100, epoch: 1 | loss: 1.5126806
	speed: 0.0309s/iter; left time: 1728.6547s
	iters: 3200, epoch: 1 | loss: 1.6799920
	speed: 0.0319s/iter; left time: 1781.8052s
	iters: 3300, epoch: 1 | loss: 2.3022747
	speed: 0.0317s/iter; left time: 1765.9555s
	iters: 3400, epoch: 1 | loss: 1.4109119
	speed: 0.0321s/iter; left time: 1784.9376s
	iters: 3500, epoch: 1 | loss: 1.7369441
	speed: 0.0319s/iter; left time: 1770.3502s
	iters: 3600, epoch: 1 | loss: 1.3981698
	speed: 0.0320s/iter; left time: 1774.3936s
	iters: 3700, epoch: 1 | loss: 1.5924829
	speed: 0.0320s/iter; left time: 1772.6478s
	iters: 3800, epoch: 1 | loss: 1.6245463
	speed: 0.0318s/iter; left time: 1759.0884s
	iters: 3900, epoch: 1 | loss: 1.5044037
	speed: 0.0318s/iter; left time: 1755.0355s
	iters: 4000, epoch: 1 | loss: 1.6647890
	speed: 0.0318s/iter; left time: 1752.2242s
	iters: 4100, epoch: 1 | loss: 1.5825908
	speed: 0.0317s/iter; left time: 1744.1786s
	iters: 4200, epoch: 1 | loss: 1.6293676
	speed: 0.0317s/iter; left time: 1739.9612s
	iters: 4300, epoch: 1 | loss: 1.7095262
	speed: 0.0318s/iter; left time: 1740.5351s
	iters: 4400, epoch: 1 | loss: 1.4356183
	speed: 0.0318s/iter; left time: 1736.9522s
	iters: 4500, epoch: 1 | loss: 1.5619354
	speed: 0.0317s/iter; left time: 1731.9632s
	iters: 4600, epoch: 1 | loss: 1.6765639
	speed: 0.0317s/iter; left time: 1727.2773s
	iters: 4700, epoch: 1 | loss: 1.4808940
	speed: 0.0317s/iter; left time: 1723.7808s
	iters: 4800, epoch: 1 | loss: 1.8823421
	speed: 0.0317s/iter; left time: 1720.7939s
	iters: 4900, epoch: 1 | loss: 1.6497128
	speed: 0.0318s/iter; left time: 1720.3958s
	iters: 5000, epoch: 1 | loss: 1.5868149
	speed: 0.0317s/iter; left time: 1716.6591s
	iters: 5100, epoch: 1 | loss: 1.4709762
	speed: 0.0318s/iter; left time: 1714.3739s
	iters: 5200, epoch: 1 | loss: 2.0367243
	speed: 0.0317s/iter; left time: 1707.6710s
	iters: 5300, epoch: 1 | loss: 1.4578619
	speed: 0.0318s/iter; left time: 1709.3322s
	iters: 5400, epoch: 1 | loss: 1.9174936
	speed: 0.0318s/iter; left time: 1705.6421s
	iters: 5500, epoch: 1 | loss: 1.6888757
	speed: 0.0320s/iter; left time: 1714.2166s
	iters: 5600, epoch: 1 | loss: 1.8416017
	speed: 0.0319s/iter; left time: 1703.8366s
	iters: 5700, epoch: 1 | loss: 1.5504590
	speed: 0.0318s/iter; left time: 1698.6031s
	iters: 5800, epoch: 1 | loss: 1.8793353
	speed: 0.0326s/iter; left time: 1738.1894s
	iters: 5900, epoch: 1 | loss: 1.3463842
	speed: 0.0318s/iter; left time: 1692.8443s
Epoch: 1 cost time: 186.84136271476746
Epoch: 1, Steps: 5908 | Train Loss: 1.6188736 Vali Loss: 1.3415245 Test Loss: 1.3128108
Validation loss decreased (inf --> 1.341524).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.4859204
	speed: 0.9977s/iter; left time: 52952.9135s
	iters: 200, epoch: 2 | loss: 1.8747523
	speed: 0.0312s/iter; left time: 1652.1354s
	iters: 300, epoch: 2 | loss: 1.4923173
	speed: 0.0311s/iter; left time: 1642.8012s
	iters: 400, epoch: 2 | loss: 1.4865555
	speed: 0.0313s/iter; left time: 1650.9406s
	iters: 500, epoch: 2 | loss: 1.8358924
	speed: 0.0316s/iter; left time: 1663.2938s
	iters: 600, epoch: 2 | loss: 1.2930176
	speed: 0.0314s/iter; left time: 1650.2632s
	iters: 700, epoch: 2 | loss: 1.3325814
	speed: 0.0314s/iter; left time: 1646.8058s
	iters: 800, epoch: 2 | loss: 1.7722759
	speed: 0.0314s/iter; left time: 1644.2435s
	iters: 900, epoch: 2 | loss: 1.6715922
	speed: 0.0313s/iter; left time: 1636.9825s
	iters: 1000, epoch: 2 | loss: 1.5849552
	speed: 0.0314s/iter; left time: 1640.7172s
	iters: 1100, epoch: 2 | loss: 1.7375821
	speed: 0.0322s/iter; left time: 1678.3242s
	iters: 1200, epoch: 2 | loss: 1.3995562
	speed: 0.0308s/iter; left time: 1600.1846s
	iters: 1300, epoch: 2 | loss: 1.4011774
	speed: 0.0308s/iter; left time: 1600.2640s
	iters: 1400, epoch: 2 | loss: 1.3474891
	speed: 0.0312s/iter; left time: 1615.8370s
	iters: 1500, epoch: 2 | loss: 1.3691535
	speed: 0.0315s/iter; left time: 1630.2688s
	iters: 1600, epoch: 2 | loss: 1.5078789
	speed: 0.0310s/iter; left time: 1596.4777s
	iters: 1700, epoch: 2 | loss: 1.4271312
	speed: 0.0308s/iter; left time: 1583.5203s
	iters: 1800, epoch: 2 | loss: 1.7517354
	speed: 0.0307s/iter; left time: 1578.5133s
	iters: 1900, epoch: 2 | loss: 2.0141699
	speed: 0.0309s/iter; left time: 1586.0895s
	iters: 2000, epoch: 2 | loss: 1.6802213
	speed: 0.0308s/iter; left time: 1575.1191s
	iters: 2100, epoch: 2 | loss: 1.4259685
	speed: 0.0307s/iter; left time: 1566.7807s
	iters: 2200, epoch: 2 | loss: 1.8884676
	speed: 0.0308s/iter; left time: 1570.8533s
	iters: 2300, epoch: 2 | loss: 1.3148739
	speed: 0.0308s/iter; left time: 1569.2953s
	iters: 2400, epoch: 2 | loss: 1.9824245
	speed: 0.0309s/iter; left time: 1566.8770s
	iters: 2500, epoch: 2 | loss: 1.3561556
	speed: 0.0308s/iter; left time: 1563.0225s
	iters: 2600, epoch: 2 | loss: 1.5742700
	speed: 0.0308s/iter; left time: 1556.9776s
	iters: 2700, epoch: 2 | loss: 1.6431986
	speed: 0.0309s/iter; left time: 1558.0305s
	iters: 2800, epoch: 2 | loss: 1.9010755
	speed: 0.0308s/iter; left time: 1549.4458s
	iters: 2900, epoch: 2 | loss: 1.8932655
	speed: 0.0307s/iter; left time: 1545.7018s
	iters: 3000, epoch: 2 | loss: 1.5633894
	speed: 0.0310s/iter; left time: 1552.9342s
	iters: 3100, epoch: 2 | loss: 1.7938865
	speed: 0.0310s/iter; left time: 1550.2059s
	iters: 3200, epoch: 2 | loss: 1.4330068
	speed: 0.0312s/iter; left time: 1557.2448s
	iters: 3300, epoch: 2 | loss: 1.1705799
	speed: 0.0311s/iter; left time: 1550.7380s
	iters: 3400, epoch: 2 | loss: 1.8289415
	speed: 0.0311s/iter; left time: 1545.8583s
	iters: 3500, epoch: 2 | loss: 1.2539300
	speed: 0.0308s/iter; left time: 1528.0653s
	iters: 3600, epoch: 2 | loss: 1.7529693
	speed: 0.0311s/iter; left time: 1539.3197s
	iters: 3700, epoch: 2 | loss: 1.8592899
	speed: 0.0307s/iter; left time: 1521.1898s
	iters: 3800, epoch: 2 | loss: 1.4750972
	speed: 0.0310s/iter; left time: 1528.9949s
	iters: 3900, epoch: 2 | loss: 1.3853494
	speed: 0.0314s/iter; left time: 1545.8015s
	iters: 4000, epoch: 2 | loss: 1.3590246
	speed: 0.0309s/iter; left time: 1517.6533s
	iters: 4100, epoch: 2 | loss: 1.7451949
	speed: 0.0310s/iter; left time: 1521.3891s
	iters: 4200, epoch: 2 | loss: 1.5558934
	speed: 0.0311s/iter; left time: 1525.3790s
	iters: 4300, epoch: 2 | loss: 1.6174306
	speed: 0.0312s/iter; left time: 1523.4771s
	iters: 4400, epoch: 2 | loss: 1.6977785
	speed: 0.0311s/iter; left time: 1514.8749s
	iters: 4500, epoch: 2 | loss: 1.6905502
	speed: 0.0312s/iter; left time: 1518.7499s
	iters: 4600, epoch: 2 | loss: 1.4715939
	speed: 0.0310s/iter; left time: 1506.7386s
	iters: 4700, epoch: 2 | loss: 1.5600628
	speed: 0.0310s/iter; left time: 1501.6179s
	iters: 4800, epoch: 2 | loss: 1.4823161
	speed: 0.0310s/iter; left time: 1499.2001s
	iters: 4900, epoch: 2 | loss: 1.7332343
	speed: 0.0309s/iter; left time: 1490.1177s
	iters: 5000, epoch: 2 | loss: 1.8585770
	speed: 0.0309s/iter; left time: 1486.5523s
	iters: 5100, epoch: 2 | loss: 1.5299757
	speed: 0.0310s/iter; left time: 1488.7659s
	iters: 5200, epoch: 2 | loss: 1.5048102
	speed: 0.0311s/iter; left time: 1490.9004s
	iters: 5300, epoch: 2 | loss: 1.3340012
	speed: 0.0315s/iter; left time: 1508.9752s
	iters: 5400, epoch: 2 | loss: 1.5498956
	speed: 0.0316s/iter; left time: 1509.9212s
	iters: 5500, epoch: 2 | loss: 1.5053456
	speed: 0.0315s/iter; left time: 1499.6037s
	iters: 5600, epoch: 2 | loss: 1.5091093
	speed: 0.0314s/iter; left time: 1494.6076s
	iters: 5700, epoch: 2 | loss: 1.3370997
	speed: 0.0313s/iter; left time: 1487.9200s
	iters: 5800, epoch: 2 | loss: 1.3982341
	speed: 0.0312s/iter; left time: 1477.8986s
	iters: 5900, epoch: 2 | loss: 1.6009862
	speed: 0.0312s/iter; left time: 1474.7031s
Epoch: 2 cost time: 183.95313572883606
Epoch: 2, Steps: 5908 | Train Loss: 1.6306296 Vali Loss: 1.3515303 Test Loss: 1.3184183
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.5827955
	speed: 1.0715s/iter; left time: 50538.3799s
	iters: 200, epoch: 3 | loss: 1.7209504
	speed: 0.0311s/iter; left time: 1463.3445s
	iters: 300, epoch: 3 | loss: 1.6173018
	speed: 0.0311s/iter; left time: 1460.5975s
	iters: 400, epoch: 3 | loss: 1.5509626
	speed: 0.0312s/iter; left time: 1462.8997s
	iters: 500, epoch: 3 | loss: 1.4113301
	speed: 0.0310s/iter; left time: 1451.9388s
	iters: 600, epoch: 3 | loss: 1.4581869
	speed: 0.0311s/iter; left time: 1449.0251s
	iters: 700, epoch: 3 | loss: 1.3934853
	speed: 0.0314s/iter; left time: 1463.8940s
	iters: 800, epoch: 3 | loss: 1.3545069
	speed: 0.0311s/iter; left time: 1443.0683s
	iters: 900, epoch: 3 | loss: 1.4599439
	speed: 0.0311s/iter; left time: 1444.2147s
	iters: 1000, epoch: 3 | loss: 1.8130050
	speed: 0.0313s/iter; left time: 1449.8059s
	iters: 1100, epoch: 3 | loss: 1.7263390
	speed: 0.0317s/iter; left time: 1462.4508s
	iters: 1200, epoch: 3 | loss: 1.7052045
	speed: 0.0313s/iter; left time: 1440.1503s
	iters: 1300, epoch: 3 | loss: 1.8499104
	speed: 0.0309s/iter; left time: 1421.2893s
	iters: 1400, epoch: 3 | loss: 1.7137687
	speed: 0.0311s/iter; left time: 1428.3384s
	iters: 1500, epoch: 3 | loss: 1.5158864
	speed: 0.0310s/iter; left time: 1416.8728s
	iters: 1600, epoch: 3 | loss: 1.4978265
	speed: 0.0308s/iter; left time: 1408.1575s
	iters: 1700, epoch: 3 | loss: 1.2297281
	speed: 0.0309s/iter; left time: 1408.8109s
	iters: 1800, epoch: 3 | loss: 1.7922616
	speed: 0.0310s/iter; left time: 1408.8049s
	iters: 1900, epoch: 3 | loss: 1.5084922
	speed: 0.0311s/iter; left time: 1409.8643s
	iters: 2000, epoch: 3 | loss: 2.2298293
	speed: 0.0312s/iter; left time: 1411.0460s
	iters: 2100, epoch: 3 | loss: 1.7233557
	speed: 0.0309s/iter; left time: 1395.3413s
	iters: 2200, epoch: 3 | loss: 1.6348320
	speed: 0.0309s/iter; left time: 1394.1289s
	iters: 2300, epoch: 3 | loss: 1.4345306
	speed: 0.0311s/iter; left time: 1400.3599s
	iters: 2400, epoch: 3 | loss: 1.4318613
	speed: 0.0311s/iter; left time: 1394.8670s
	iters: 2500, epoch: 3 | loss: 1.7614226
	speed: 0.0308s/iter; left time: 1380.2379s
	iters: 2600, epoch: 3 | loss: 1.7385623
	speed: 0.0311s/iter; left time: 1390.2511s
	iters: 2700, epoch: 3 | loss: 1.3351967
	speed: 0.0311s/iter; left time: 1385.2538s
	iters: 2800, epoch: 3 | loss: 1.5232606
	speed: 0.0310s/iter; left time: 1376.2986s
	iters: 2900, epoch: 3 | loss: 1.9033375
	speed: 0.0311s/iter; left time: 1381.4007s
	iters: 3000, epoch: 3 | loss: 1.3748583
	speed: 0.0309s/iter; left time: 1366.1538s
	iters: 3100, epoch: 3 | loss: 1.6446642
	speed: 0.0312s/iter; left time: 1380.1402s
	iters: 3200, epoch: 3 | loss: 1.8491877
	speed: 0.0309s/iter; left time: 1361.7464s
	iters: 3300, epoch: 3 | loss: 1.5966263
	speed: 0.0310s/iter; left time: 1361.4892s
	iters: 3400, epoch: 3 | loss: 1.5548480
	speed: 0.0311s/iter; left time: 1363.7030s
	iters: 3500, epoch: 3 | loss: 1.8456497
	speed: 0.0310s/iter; left time: 1357.9532s
	iters: 3600, epoch: 3 | loss: 1.6156540
	speed: 0.0308s/iter; left time: 1345.4670s
	iters: 3700, epoch: 3 | loss: 1.6656358
	speed: 0.0308s/iter; left time: 1342.5238s
	iters: 3800, epoch: 3 | loss: 1.3238313
	speed: 0.0312s/iter; left time: 1356.9758s
	iters: 3900, epoch: 3 | loss: 1.6501911
	speed: 0.0310s/iter; left time: 1342.9367s
	iters: 4000, epoch: 3 | loss: 1.4289565
	speed: 0.0308s/iter; left time: 1333.5501s
	iters: 4100, epoch: 3 | loss: 1.7063249
	speed: 0.0311s/iter; left time: 1340.6180s
	iters: 4200, epoch: 3 | loss: 1.4671775
	speed: 0.0311s/iter; left time: 1338.2858s
	iters: 4300, epoch: 3 | loss: 1.4349935
	speed: 0.0309s/iter; left time: 1326.1169s
	iters: 4400, epoch: 3 | loss: 1.7854264
	speed: 0.0307s/iter; left time: 1317.8364s
	iters: 4500, epoch: 3 | loss: 1.6876669
	speed: 0.0311s/iter; left time: 1331.6577s
	iters: 4600, epoch: 3 | loss: 1.6061269
	speed: 0.0316s/iter; left time: 1347.9138s
	iters: 4700, epoch: 3 | loss: 1.3867781
	speed: 0.0316s/iter; left time: 1343.0918s
	iters: 4800, epoch: 3 | loss: 1.4554368
	speed: 0.0312s/iter; left time: 1325.7118s
	iters: 4900, epoch: 3 | loss: 1.4623414
	speed: 0.0310s/iter; left time: 1314.6582s
	iters: 5000, epoch: 3 | loss: 1.7417998
	speed: 0.0313s/iter; left time: 1321.4956s
	iters: 5100, epoch: 3 | loss: 1.4207981
	speed: 0.0313s/iter; left time: 1320.4491s
	iters: 5200, epoch: 3 | loss: 1.6675521
	speed: 0.0314s/iter; left time: 1319.3430s
	iters: 5300, epoch: 3 | loss: 1.6041917
	speed: 0.0312s/iter; left time: 1310.2929s
	iters: 5400, epoch: 3 | loss: 1.4574221
	speed: 0.0311s/iter; left time: 1303.6684s
	iters: 5500, epoch: 3 | loss: 1.7538258
	speed: 0.0311s/iter; left time: 1298.4015s
	iters: 5600, epoch: 3 | loss: 1.7099060
	speed: 0.0315s/iter; left time: 1312.0383s
	iters: 5700, epoch: 3 | loss: 1.4665542
	speed: 0.0314s/iter; left time: 1303.3512s
	iters: 5800, epoch: 3 | loss: 1.6367671
	speed: 0.0309s/iter; left time: 1281.6230s
	iters: 5900, epoch: 3 | loss: 1.4137223
	speed: 0.0313s/iter; left time: 1293.3647s
Epoch: 3 cost time: 184.0444312095642
Epoch: 3, Steps: 5908 | Train Loss: 1.6299626 Vali Loss: 1.3570948 Test Loss: 1.3222494
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.8830829
	speed: 1.0186s/iter; left time: 42024.2922s
	iters: 200, epoch: 4 | loss: 1.8572427
	speed: 0.0355s/iter; left time: 1459.6949s
	iters: 300, epoch: 4 | loss: 2.0657089
	speed: 0.0355s/iter; left time: 1459.4105s
	iters: 400, epoch: 4 | loss: 1.8561635
	speed: 0.0354s/iter; left time: 1449.5170s
	iters: 500, epoch: 4 | loss: 1.4487576
	speed: 0.0355s/iter; left time: 1451.7925s
	iters: 600, epoch: 4 | loss: 1.6825793
	speed: 0.0355s/iter; left time: 1444.8497s
	iters: 700, epoch: 4 | loss: 1.9369433
	speed: 0.0355s/iter; left time: 1443.3752s
	iters: 800, epoch: 4 | loss: 1.5558162
	speed: 0.0355s/iter; left time: 1439.7210s
	iters: 900, epoch: 4 | loss: 1.6393440
	speed: 0.0355s/iter; left time: 1435.6291s
	iters: 1000, epoch: 4 | loss: 1.6465446
	speed: 0.0355s/iter; left time: 1434.2692s
	iters: 1100, epoch: 4 | loss: 1.3506166
	speed: 0.0355s/iter; left time: 1427.3507s
	iters: 1200, epoch: 4 | loss: 1.5081512
	speed: 0.0355s/iter; left time: 1425.4488s
	iters: 1300, epoch: 4 | loss: 1.3326120
	speed: 0.0355s/iter; left time: 1420.6319s
	iters: 1400, epoch: 4 | loss: 1.3932217
	speed: 0.0355s/iter; left time: 1419.1780s
	iters: 1500, epoch: 4 | loss: 1.6585790
	speed: 0.0355s/iter; left time: 1414.8595s
	iters: 1600, epoch: 4 | loss: 1.5078491
	speed: 0.0355s/iter; left time: 1412.1393s
	iters: 1700, epoch: 4 | loss: 2.1269243
	speed: 0.0356s/iter; left time: 1411.7294s
	iters: 1800, epoch: 4 | loss: 1.6743422
	speed: 0.0355s/iter; left time: 1405.2950s
	iters: 1900, epoch: 4 | loss: 1.7223418
	speed: 0.0355s/iter; left time: 1400.7329s
	iters: 2000, epoch: 4 | loss: 1.4838746
	speed: 0.0355s/iter; left time: 1396.4921s
	iters: 2100, epoch: 4 | loss: 1.6239939
	speed: 0.0355s/iter; left time: 1394.0288s
	iters: 2200, epoch: 4 | loss: 1.6600324
	speed: 0.0354s/iter; left time: 1386.7062s
	iters: 2300, epoch: 4 | loss: 1.4290096
	speed: 0.0355s/iter; left time: 1387.4691s
	iters: 2400, epoch: 4 | loss: 1.7254574
	speed: 0.0355s/iter; left time: 1381.6283s
	iters: 2500, epoch: 4 | loss: 1.7472138
	speed: 0.0355s/iter; left time: 1380.2310s
	iters: 2600, epoch: 4 | loss: 1.5482736
	speed: 0.0355s/iter; left time: 1375.3951s
	iters: 2700, epoch: 4 | loss: 1.7721783
	speed: 0.0354s/iter; left time: 1369.2619s
	iters: 2800, epoch: 4 | loss: 1.9045067
	speed: 0.0355s/iter; left time: 1367.7888s
	iters: 2900, epoch: 4 | loss: 1.5001843
	speed: 0.0355s/iter; left time: 1366.7874s
	iters: 3000, epoch: 4 | loss: 1.6183891
	speed: 0.0355s/iter; left time: 1360.0963s
	iters: 3100, epoch: 4 | loss: 1.4423617
	speed: 0.0354s/iter; left time: 1356.1303s
	iters: 3200, epoch: 4 | loss: 1.4396092
	speed: 0.0356s/iter; left time: 1357.2902s
	iters: 3300, epoch: 4 | loss: 1.7529002
	speed: 0.0356s/iter; left time: 1354.2192s
	iters: 3400, epoch: 4 | loss: 1.6296557
	speed: 0.0354s/iter; left time: 1344.8862s
	iters: 3500, epoch: 4 | loss: 1.7205440
	speed: 0.0355s/iter; left time: 1343.5580s
	iters: 3600, epoch: 4 | loss: 1.4615464
	speed: 0.0356s/iter; left time: 1345.0913s
	iters: 3700, epoch: 4 | loss: 1.7873424
	speed: 0.0357s/iter; left time: 1343.9866s
	iters: 3800, epoch: 4 | loss: 1.2383325
	speed: 0.0350s/iter; left time: 1315.6409s
	iters: 3900, epoch: 4 | loss: 1.4306006
	speed: 0.0319s/iter; left time: 1194.1338s
	iters: 4000, epoch: 4 | loss: 1.5115318
	speed: 0.0319s/iter; left time: 1191.7803s
	iters: 4100, epoch: 4 | loss: 1.7883911
	speed: 0.0319s/iter; left time: 1187.5647s
	iters: 4200, epoch: 4 | loss: 1.4772676
	speed: 0.0318s/iter; left time: 1180.4637s
	iters: 4300, epoch: 4 | loss: 2.0937414
	speed: 0.0320s/iter; left time: 1184.8813s
	iters: 4400, epoch: 4 | loss: 1.7784289
	speed: 0.0319s/iter; left time: 1180.1619s
	iters: 4500, epoch: 4 | loss: 1.8536615
	speed: 0.0318s/iter; left time: 1171.2247s
	iters: 4600, epoch: 4 | loss: 1.8340732
	speed: 0.0317s/iter; left time: 1165.3205s
	iters: 4700, epoch: 4 | loss: 1.8655488
	speed: 0.0317s/iter; left time: 1163.5483s
	iters: 4800, epoch: 4 | loss: 1.4066958
	speed: 0.0317s/iter; left time: 1157.7828s
	iters: 4900, epoch: 4 | loss: 1.3789117
	speed: 0.0317s/iter; left time: 1154.0736s
	iters: 5000, epoch: 4 | loss: 1.5397633
	speed: 0.0317s/iter; left time: 1151.8831s
	iters: 5100, epoch: 4 | loss: 1.7300190
	speed: 0.0318s/iter; left time: 1152.6441s
	iters: 5200, epoch: 4 | loss: 1.5444212
	speed: 0.0315s/iter; left time: 1139.7243s
	iters: 5300, epoch: 4 | loss: 1.4236314
	speed: 0.0317s/iter; left time: 1144.4690s
	iters: 5400, epoch: 4 | loss: 2.1698756
	speed: 0.0320s/iter; left time: 1149.9257s
	iters: 5500, epoch: 4 | loss: 1.7416018
	speed: 0.0318s/iter; left time: 1141.0095s
	iters: 5600, epoch: 4 | loss: 1.9773895
	speed: 0.0318s/iter; left time: 1135.5379s
	iters: 5700, epoch: 4 | loss: 1.7587343
	speed: 0.0318s/iter; left time: 1133.9667s
	iters: 5800, epoch: 4 | loss: 2.0949645
	speed: 0.0319s/iter; left time: 1133.2570s
	iters: 5900, epoch: 4 | loss: 1.7465132
	speed: 0.0319s/iter; left time: 1131.7604s
Epoch: 4 cost time: 201.84710502624512
Epoch: 4, Steps: 5908 | Train Loss: 1.6297966 Vali Loss: 1.3494201 Test Loss: 1.3177978
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 194530
test shape: (19453, 1, 720, 130) (19453, 1, 720, 130)
test shape: (19453, 720, 130) (19453, 720, 130)
mse:1.3128178119659424, mae:0.8851616978645325
>>>>>>>Overall time: 1355 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
