Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690438
val 89796
test 89794
	iters: 100, epoch: 1 | loss: 1.3512299
	speed: 0.1744s/iter; left time: 75223.2917s
	iters: 200, epoch: 1 | loss: 1.1686962
	speed: 0.1721s/iter; left time: 74228.4369s
	iters: 300, epoch: 1 | loss: 1.1561426
	speed: 0.1724s/iter; left time: 74329.1778s
	iters: 400, epoch: 1 | loss: 1.4031615
	speed: 0.1727s/iter; left time: 74423.8434s
	iters: 500, epoch: 1 | loss: 1.3850631
	speed: 0.1723s/iter; left time: 74229.7188s
	iters: 600, epoch: 1 | loss: 1.3791958
	speed: 0.1721s/iter; left time: 74145.6057s
	iters: 700, epoch: 1 | loss: 1.0861361
	speed: 0.1751s/iter; left time: 75405.9271s
	iters: 800, epoch: 1 | loss: 1.1425469
	speed: 0.1723s/iter; left time: 74173.0813s
	iters: 900, epoch: 1 | loss: 1.1886734
	speed: 0.1725s/iter; left time: 74265.4439s
	iters: 1000, epoch: 1 | loss: 1.1267570
	speed: 0.1720s/iter; left time: 74040.5195s
	iters: 1100, epoch: 1 | loss: 1.2942549
	speed: 0.1721s/iter; left time: 74054.9541s
	iters: 1200, epoch: 1 | loss: 1.1932334
	speed: 0.1721s/iter; left time: 74051.2471s
	iters: 1300, epoch: 1 | loss: 0.9953681
	speed: 0.1721s/iter; left time: 74030.7474s
	iters: 1400, epoch: 1 | loss: 1.1368332
	speed: 0.1724s/iter; left time: 74131.4107s
	iters: 1500, epoch: 1 | loss: 0.9597934
	speed: 0.1722s/iter; left time: 74041.0151s
	iters: 1600, epoch: 1 | loss: 1.2436316
	speed: 0.1722s/iter; left time: 74007.5976s
	iters: 1700, epoch: 1 | loss: 1.0396988
	speed: 0.1719s/iter; left time: 73880.2216s
	iters: 1800, epoch: 1 | loss: 0.9861520
	speed: 0.1721s/iter; left time: 73925.1017s
	iters: 1900, epoch: 1 | loss: 1.2174964
	speed: 0.1721s/iter; left time: 73899.3188s
	iters: 2000, epoch: 1 | loss: 0.9135390
	speed: 0.1720s/iter; left time: 73859.9872s
	iters: 2100, epoch: 1 | loss: 0.8297015
	speed: 0.1722s/iter; left time: 73919.2844s
Epoch: 1 cost time: 372.1512219905853
Epoch: 1, Steps: 2157 | Train Loss: 1.1551547 Vali Loss: 0.9799248 Test Loss: 0.9866579
Validation loss decreased (inf --> 0.979925).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0071969
	speed: 1.4998s/iter; left time: 643646.8181s
	iters: 200, epoch: 2 | loss: 0.9683809
	speed: 0.1776s/iter; left time: 76192.2620s
	iters: 300, epoch: 2 | loss: 0.8429431
	speed: 0.1738s/iter; left time: 74554.8243s
	iters: 400, epoch: 2 | loss: 0.9628167
	speed: 0.1720s/iter; left time: 73781.8400s
	iters: 500, epoch: 2 | loss: 1.0283681
	speed: 0.1722s/iter; left time: 73817.5414s
	iters: 600, epoch: 2 | loss: 0.8362949
	speed: 0.1728s/iter; left time: 74090.8582s
	iters: 700, epoch: 2 | loss: 0.8542209
	speed: 0.1725s/iter; left time: 73905.2527s
	iters: 800, epoch: 2 | loss: 0.8018979
	speed: 0.1722s/iter; left time: 73772.4326s
	iters: 900, epoch: 2 | loss: 0.9129771
	speed: 0.1728s/iter; left time: 74017.2334s
	iters: 1000, epoch: 2 | loss: 0.8565959
	speed: 0.1727s/iter; left time: 73950.1771s
	iters: 1100, epoch: 2 | loss: 0.8438132
	speed: 0.1726s/iter; left time: 73895.7874s
	iters: 1200, epoch: 2 | loss: 0.9036713
	speed: 0.1728s/iter; left time: 73953.1484s
	iters: 1300, epoch: 2 | loss: 1.0043283
	speed: 0.1723s/iter; left time: 73726.5256s
	iters: 1400, epoch: 2 | loss: 0.8614019
	speed: 0.1724s/iter; left time: 73761.2594s
	iters: 1500, epoch: 2 | loss: 0.8627611
	speed: 0.1722s/iter; left time: 73637.0613s
	iters: 1600, epoch: 2 | loss: 1.1889523
	speed: 0.1725s/iter; left time: 73777.4257s
	iters: 1700, epoch: 2 | loss: 0.9676893
	speed: 0.1725s/iter; left time: 73735.5656s
	iters: 1800, epoch: 2 | loss: 1.1165923
	speed: 0.1724s/iter; left time: 73706.2358s
	iters: 1900, epoch: 2 | loss: 0.7400531
	speed: 0.1727s/iter; left time: 73822.5526s
	iters: 2000, epoch: 2 | loss: 0.7945299
	speed: 0.1728s/iter; left time: 73810.4994s
	iters: 2100, epoch: 2 | loss: 0.8842607
	speed: 0.1723s/iter; left time: 73613.1312s
Epoch: 2 cost time: 373.3450243473053
Epoch: 2, Steps: 2157 | Train Loss: 0.9501143 Vali Loss: 1.0186865 Test Loss: 0.9919925
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.7556182
	speed: 1.4956s/iter; left time: 638608.5329s
	iters: 200, epoch: 3 | loss: 0.9220237
	speed: 0.1722s/iter; left time: 73496.6402s
	iters: 300, epoch: 3 | loss: 0.9260247
	speed: 0.1721s/iter; left time: 73439.3272s
	iters: 400, epoch: 3 | loss: 0.8010406
	speed: 0.1722s/iter; left time: 73494.9686s
	iters: 500, epoch: 3 | loss: 1.0531441
	speed: 0.1723s/iter; left time: 73479.9470s
	iters: 600, epoch: 3 | loss: 1.0523448
	speed: 0.1720s/iter; left time: 73368.8884s
	iters: 700, epoch: 3 | loss: 0.9890885
	speed: 0.1720s/iter; left time: 73334.4257s
	iters: 800, epoch: 3 | loss: 1.0001202
	speed: 0.1722s/iter; left time: 73399.2256s
	iters: 900, epoch: 3 | loss: 0.7572199
	speed: 0.1721s/iter; left time: 73346.0228s
	iters: 1000, epoch: 3 | loss: 0.9171857
	speed: 0.1721s/iter; left time: 73326.8168s
	iters: 1100, epoch: 3 | loss: 0.7637537
	speed: 0.1721s/iter; left time: 73303.3898s
	iters: 1200, epoch: 3 | loss: 0.8723348
	speed: 0.1722s/iter; left time: 73354.7778s
	iters: 1300, epoch: 3 | loss: 0.9268748
	speed: 0.1721s/iter; left time: 73270.6997s
	iters: 1400, epoch: 3 | loss: 0.7996845
	speed: 0.1723s/iter; left time: 73342.0145s
	iters: 1500, epoch: 3 | loss: 0.9000841
	speed: 0.1722s/iter; left time: 73291.7018s
	iters: 1600, epoch: 3 | loss: 0.8874487
	speed: 0.1721s/iter; left time: 73236.5293s
	iters: 1700, epoch: 3 | loss: 0.9471020
	speed: 0.1723s/iter; left time: 73280.7025s
	iters: 1800, epoch: 3 | loss: 0.9427382
	speed: 0.1724s/iter; left time: 73307.9866s
	iters: 1900, epoch: 3 | loss: 0.7406951
	speed: 0.1723s/iter; left time: 73263.2996s
	iters: 2000, epoch: 3 | loss: 0.7602307
	speed: 0.1723s/iter; left time: 73253.6679s
	iters: 2100, epoch: 3 | loss: 0.7435324
	speed: 0.1720s/iter; left time: 73101.6581s
Epoch: 3 cost time: 371.54109930992126
Epoch: 3, Steps: 2157 | Train Loss: 0.9185926 Vali Loss: 0.9846139 Test Loss: 1.0146837
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.8444970
	speed: 1.4963s/iter; left time: 635673.6288s
	iters: 200, epoch: 4 | loss: 0.9045711
	speed: 0.1721s/iter; left time: 73094.6296s
	iters: 300, epoch: 4 | loss: 0.9335483
	speed: 0.1721s/iter; left time: 73086.5589s
	iters: 400, epoch: 4 | loss: 0.7825457
	speed: 0.1721s/iter; left time: 73045.1190s
	iters: 500, epoch: 4 | loss: 0.7970810
	speed: 0.1721s/iter; left time: 73024.5442s
	iters: 600, epoch: 4 | loss: 0.7214639
	speed: 0.1720s/iter; left time: 72992.7059s
	iters: 700, epoch: 4 | loss: 0.8343604
	speed: 0.1720s/iter; left time: 72958.1578s
	iters: 800, epoch: 4 | loss: 0.7545909
	speed: 0.1723s/iter; left time: 73097.9071s
	iters: 900, epoch: 4 | loss: 0.7895871
	speed: 0.1722s/iter; left time: 73005.6910s
	iters: 1000, epoch: 4 | loss: 0.6835040
	speed: 0.1723s/iter; left time: 73044.0386s
	iters: 1100, epoch: 4 | loss: 0.8035249
	speed: 0.1721s/iter; left time: 72940.2954s
	iters: 1200, epoch: 4 | loss: 0.8397113
	speed: 0.1723s/iter; left time: 73007.0182s
	iters: 1300, epoch: 4 | loss: 0.8631906
	speed: 0.1724s/iter; left time: 73021.9848s
	iters: 1400, epoch: 4 | loss: 1.0316813
	speed: 0.1725s/iter; left time: 73048.6223s
	iters: 1500, epoch: 4 | loss: 0.9626738
	speed: 0.1723s/iter; left time: 72974.0957s
	iters: 1600, epoch: 4 | loss: 0.9695576
	speed: 0.1724s/iter; left time: 72970.9484s
	iters: 1700, epoch: 4 | loss: 0.7106553
	speed: 0.1724s/iter; left time: 72969.7914s
	iters: 1800, epoch: 4 | loss: 0.8855868
	speed: 0.1724s/iter; left time: 72936.0711s
	iters: 1900, epoch: 4 | loss: 0.9397210
	speed: 0.1723s/iter; left time: 72889.8391s
	iters: 2000, epoch: 4 | loss: 0.8619039
	speed: 0.1725s/iter; left time: 72975.7895s
	iters: 2100, epoch: 4 | loss: 0.9113167
	speed: 0.1724s/iter; left time: 72905.4015s
Epoch: 4 cost time: 371.6947355270386
Epoch: 4, Steps: 2157 | Train Loss: 0.8634195 Vali Loss: 0.9232402 Test Loss: 0.9807965
Validation loss decreased (0.979925 --> 0.923240).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7734341
	speed: 1.4869s/iter; left time: 628488.6026s
	iters: 200, epoch: 5 | loss: 0.8736307
	speed: 0.1726s/iter; left time: 72944.3894s
	iters: 300, epoch: 5 | loss: 0.7781994
	speed: 0.1724s/iter; left time: 72823.8708s
	iters: 400, epoch: 5 | loss: 0.9337671
	speed: 0.1724s/iter; left time: 72832.7543s
	iters: 500, epoch: 5 | loss: 1.1737831
	speed: 0.1724s/iter; left time: 72784.7847s
	iters: 600, epoch: 5 | loss: 1.0092143
	speed: 0.1726s/iter; left time: 72862.9752s
	iters: 700, epoch: 5 | loss: 0.8931990
	speed: 0.1727s/iter; left time: 72886.6394s
	iters: 800, epoch: 5 | loss: 1.2286594
	speed: 0.1726s/iter; left time: 72846.8148s
	iters: 900, epoch: 5 | loss: 1.0613203
	speed: 0.1723s/iter; left time: 72672.6902s
	iters: 1000, epoch: 5 | loss: 1.0946790
	speed: 0.1727s/iter; left time: 72846.0063s
	iters: 1100, epoch: 5 | loss: 0.8834055
	speed: 0.1724s/iter; left time: 72684.2947s
	iters: 1200, epoch: 5 | loss: 0.9229586
	speed: 0.1722s/iter; left time: 72611.0871s
	iters: 1300, epoch: 5 | loss: 1.0397080
	speed: 0.1722s/iter; left time: 72590.3483s
	iters: 1400, epoch: 5 | loss: 1.1607257
	speed: 0.1726s/iter; left time: 72718.5185s
	iters: 1500, epoch: 5 | loss: 0.9908980
	speed: 0.1726s/iter; left time: 72722.0429s
	iters: 1600, epoch: 5 | loss: 1.0198060
	speed: 0.1725s/iter; left time: 72665.7972s
	iters: 1700, epoch: 5 | loss: 1.0028439
	speed: 0.1726s/iter; left time: 72666.2450s
	iters: 1800, epoch: 5 | loss: 0.9039621
	speed: 0.1725s/iter; left time: 72613.1985s
	iters: 1900, epoch: 5 | loss: 0.9802509
	speed: 0.1726s/iter; left time: 72636.6320s
	iters: 2000, epoch: 5 | loss: 1.3599855
	speed: 0.1724s/iter; left time: 72536.6104s
	iters: 2100, epoch: 5 | loss: 0.9819704
	speed: 0.1726s/iter; left time: 72602.7267s
Epoch: 5 cost time: 372.25128626823425
Epoch: 5, Steps: 2157 | Train Loss: 0.9937336 Vali Loss: 0.8893137 Test Loss: 0.9972886
Validation loss decreased (0.923240 --> 0.889314).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9755074
	speed: 1.4943s/iter; left time: 628368.5301s
	iters: 200, epoch: 6 | loss: 1.0898312
	speed: 0.1724s/iter; left time: 72469.9896s
	iters: 300, epoch: 6 | loss: 0.8832909
	speed: 0.1723s/iter; left time: 72436.2311s
	iters: 400, epoch: 6 | loss: 0.9294793
	speed: 0.1725s/iter; left time: 72497.4420s
	iters: 500, epoch: 6 | loss: 0.9928107
	speed: 0.1722s/iter; left time: 72353.3356s
	iters: 600, epoch: 6 | loss: 1.0158250
	speed: 0.1724s/iter; left time: 72413.9619s
	iters: 700, epoch: 6 | loss: 0.9265333
	speed: 0.1725s/iter; left time: 72454.6912s
	iters: 800, epoch: 6 | loss: 1.0303732
	speed: 0.1726s/iter; left time: 72441.0229s
	iters: 900, epoch: 6 | loss: 0.8790148
	speed: 0.1732s/iter; left time: 72707.0162s
	iters: 1000, epoch: 6 | loss: 0.8204710
	speed: 0.1729s/iter; left time: 72570.2595s
	iters: 1100, epoch: 6 | loss: 0.8499069
	speed: 0.1727s/iter; left time: 72453.4457s
	iters: 1200, epoch: 6 | loss: 0.9816058
	speed: 0.1727s/iter; left time: 72443.7528s
	iters: 1300, epoch: 6 | loss: 0.7633807
	speed: 0.1722s/iter; left time: 72195.4762s
	iters: 1400, epoch: 6 | loss: 0.8749430
	speed: 0.1722s/iter; left time: 72192.3296s
	iters: 1500, epoch: 6 | loss: 0.9409848
	speed: 0.1725s/iter; left time: 72295.1318s
	iters: 1600, epoch: 6 | loss: 0.8504181
	speed: 0.1723s/iter; left time: 72199.9344s
	iters: 1700, epoch: 6 | loss: 0.9230478
	speed: 0.1726s/iter; left time: 72315.5784s
	iters: 1800, epoch: 6 | loss: 1.1068220
	speed: 0.1730s/iter; left time: 72449.2195s
	iters: 1900, epoch: 6 | loss: 1.1624631
	speed: 0.1731s/iter; left time: 72497.8255s
	iters: 2000, epoch: 6 | loss: 0.9815191
	speed: 0.1731s/iter; left time: 72456.2055s
	iters: 2100, epoch: 6 | loss: 0.8760116
	speed: 0.1728s/iter; left time: 72315.2651s
Epoch: 6 cost time: 372.51333713531494
Epoch: 6, Steps: 2157 | Train Loss: 0.9828090 Vali Loss: 0.9429685 Test Loss: 1.0323795
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.9794446
	speed: 1.4940s/iter; left time: 625045.5603s
	iters: 200, epoch: 7 | loss: 0.9096202
	speed: 0.1725s/iter; left time: 72138.3053s
	iters: 300, epoch: 7 | loss: 0.9719331
	speed: 0.1725s/iter; left time: 72146.1099s
	iters: 400, epoch: 7 | loss: 0.9548918
	speed: 0.1726s/iter; left time: 72148.4813s
	iters: 500, epoch: 7 | loss: 0.9016874
	speed: 0.1726s/iter; left time: 72141.2430s
	iters: 600, epoch: 7 | loss: 1.2177197
	speed: 0.1729s/iter; left time: 72234.9055s
	iters: 700, epoch: 7 | loss: 0.9837744
	speed: 0.1728s/iter; left time: 72200.1236s
	iters: 800, epoch: 7 | loss: 0.7503390
	speed: 0.1730s/iter; left time: 72264.0445s
	iters: 900, epoch: 7 | loss: 0.9396620
	speed: 0.1727s/iter; left time: 72099.0950s
	iters: 1000, epoch: 7 | loss: 0.9100261
	speed: 0.1733s/iter; left time: 72325.8578s
	iters: 1100, epoch: 7 | loss: 1.0631658
	speed: 0.1726s/iter; left time: 72050.0196s
	iters: 1200, epoch: 7 | loss: 0.9554228
	speed: 0.1728s/iter; left time: 72091.6607s
	iters: 1300, epoch: 7 | loss: 0.7956600
	speed: 0.1726s/iter; left time: 72004.5406s
	iters: 1400, epoch: 7 | loss: 1.0369111
	speed: 0.1730s/iter; left time: 72170.5339s
	iters: 1500, epoch: 7 | loss: 1.0068681
	speed: 0.1728s/iter; left time: 72063.9157s
	iters: 1600, epoch: 7 | loss: 0.7802632
	speed: 0.1728s/iter; left time: 72053.1353s
	iters: 1700, epoch: 7 | loss: 1.2088182
	speed: 0.1732s/iter; left time: 72198.5983s
	iters: 1800, epoch: 7 | loss: 0.8276741
	speed: 0.1725s/iter; left time: 71885.2227s
	iters: 1900, epoch: 7 | loss: 0.9803688
	speed: 0.1725s/iter; left time: 71871.5642s
	iters: 2000, epoch: 7 | loss: 0.9157387
	speed: 0.1724s/iter; left time: 71807.7041s
	iters: 2100, epoch: 7 | loss: 0.9801103
	speed: 0.1726s/iter; left time: 71862.7762s
Epoch: 7 cost time: 372.750860452652
Epoch: 7, Steps: 2157 | Train Loss: 0.9382646 Vali Loss: 0.8717945 Test Loss: 0.9545693
Validation loss decreased (0.889314 --> 0.871794).  Saving model ...
	iters: 100, epoch: 8 | loss: 1.0421548
	speed: 1.4909s/iter; left time: 620512.4595s
	iters: 200, epoch: 8 | loss: 0.8334019
	speed: 0.1730s/iter; left time: 71990.5406s
	iters: 300, epoch: 8 | loss: 0.9243291
	speed: 0.1729s/iter; left time: 71923.6918s
	iters: 400, epoch: 8 | loss: 0.7017397
	speed: 0.1725s/iter; left time: 71752.0292s
	iters: 500, epoch: 8 | loss: 0.9264899
	speed: 0.1730s/iter; left time: 71933.4504s
	iters: 600, epoch: 8 | loss: 0.9005264
	speed: 0.1740s/iter; left time: 72342.3013s
	iters: 700, epoch: 8 | loss: 0.8874072
	speed: 0.1727s/iter; left time: 71776.9762s
	iters: 800, epoch: 8 | loss: 0.8959771
	speed: 0.1733s/iter; left time: 71986.6678s
	iters: 900, epoch: 8 | loss: 1.1867682
	speed: 0.1727s/iter; left time: 71748.2070s
	iters: 1000, epoch: 8 | loss: 1.1258060
	speed: 0.1722s/iter; left time: 71508.9091s
	iters: 1100, epoch: 8 | loss: 1.0285168
	speed: 0.1725s/iter; left time: 71621.1284s
	iters: 1200, epoch: 8 | loss: 0.9799550
	speed: 0.1726s/iter; left time: 71628.1328s
	iters: 1300, epoch: 8 | loss: 1.0270352
	speed: 0.1732s/iter; left time: 71894.5433s
	iters: 1400, epoch: 8 | loss: 1.0098516
	speed: 0.1724s/iter; left time: 71532.5839s
	iters: 1500, epoch: 8 | loss: 0.9950862
	speed: 0.1727s/iter; left time: 71647.6646s
	iters: 1600, epoch: 8 | loss: 1.0464306
	speed: 0.1725s/iter; left time: 71524.8927s
	iters: 1700, epoch: 8 | loss: 1.2187438
	speed: 0.1724s/iter; left time: 71493.0702s
	iters: 1800, epoch: 8 | loss: 1.0355740
	speed: 0.1723s/iter; left time: 71427.5395s
	iters: 1900, epoch: 8 | loss: 0.9326495
	speed: 0.1726s/iter; left time: 71519.6476s
	iters: 2000, epoch: 8 | loss: 0.9668063
	speed: 0.1732s/iter; left time: 71765.3669s
	iters: 2100, epoch: 8 | loss: 0.9161701
	speed: 0.1726s/iter; left time: 71494.6277s
Epoch: 8 cost time: 372.787629365921
Epoch: 8, Steps: 2157 | Train Loss: 0.9912790 Vali Loss: 0.9846310 Test Loss: 1.0523099
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 9 | loss: 0.7768306
	speed: 1.4887s/iter; left time: 616403.7129s
	iters: 200, epoch: 9 | loss: 0.7878933
	speed: 0.1723s/iter; left time: 71343.3927s
	iters: 300, epoch: 9 | loss: 0.8028403
	speed: 0.1728s/iter; left time: 71527.6700s
	iters: 400, epoch: 9 | loss: 0.8709434
	speed: 0.1721s/iter; left time: 71223.2578s
	iters: 500, epoch: 9 | loss: 1.0121545
	speed: 0.1728s/iter; left time: 71467.8577s
	iters: 600, epoch: 9 | loss: 0.7929325
	speed: 0.1725s/iter; left time: 71349.3045s
	iters: 700, epoch: 9 | loss: 0.9284825
	speed: 0.1723s/iter; left time: 71229.3245s
	iters: 800, epoch: 9 | loss: 0.9815048
	speed: 0.1722s/iter; left time: 71195.8465s
	iters: 900, epoch: 9 | loss: 0.8527787
	speed: 0.1722s/iter; left time: 71167.5095s
	iters: 1000, epoch: 9 | loss: 0.8521158
	speed: 0.1725s/iter; left time: 71261.0873s
	iters: 1100, epoch: 9 | loss: 1.0578308
	speed: 0.1728s/iter; left time: 71370.5627s
	iters: 1200, epoch: 9 | loss: 0.7208459
	speed: 0.1725s/iter; left time: 71247.7619s
	iters: 1300, epoch: 9 | loss: 0.8535740
	speed: 0.1724s/iter; left time: 71184.1389s
	iters: 1400, epoch: 9 | loss: 0.8298275
	speed: 0.1722s/iter; left time: 71089.3743s
	iters: 1500, epoch: 9 | loss: 0.7518167
	speed: 0.1724s/iter; left time: 71133.5806s
	iters: 1600, epoch: 9 | loss: 0.9525977
	speed: 0.1723s/iter; left time: 71076.8355s
	iters: 1700, epoch: 9 | loss: 0.8848034
	speed: 0.1725s/iter; left time: 71134.7686s
	iters: 1800, epoch: 9 | loss: 0.9455886
	speed: 0.1723s/iter; left time: 71061.4431s
	iters: 1900, epoch: 9 | loss: 0.9605665
	speed: 0.1723s/iter; left time: 71031.9376s
	iters: 2000, epoch: 9 | loss: 1.0457855
	speed: 0.1726s/iter; left time: 71149.2674s
	iters: 2100, epoch: 9 | loss: 0.9581436
	speed: 0.1719s/iter; left time: 70846.4691s
Epoch: 9 cost time: 372.0295865535736
Epoch: 9, Steps: 2157 | Train Loss: 0.9171869 Vali Loss: 0.9856923 Test Loss: 1.0741423
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 10 | loss: 1.0740139
	speed: 1.4879s/iter; left time: 612854.6855s
	iters: 200, epoch: 10 | loss: 0.8533094
	speed: 0.1726s/iter; left time: 71069.4927s
	iters: 300, epoch: 10 | loss: 0.8033237
	speed: 0.1738s/iter; left time: 71540.5288s
	iters: 400, epoch: 10 | loss: 0.8492059
	speed: 0.1790s/iter; left time: 73664.4610s
	iters: 500, epoch: 10 | loss: 0.8837960
	speed: 0.1790s/iter; left time: 73655.2202s
	iters: 600, epoch: 10 | loss: 0.8231779
	speed: 0.1742s/iter; left time: 71658.5052s
	iters: 700, epoch: 10 | loss: 0.9609712
	speed: 0.1724s/iter; left time: 70920.5982s
	iters: 800, epoch: 10 | loss: 0.9991426
	speed: 0.1722s/iter; left time: 70808.7050s
	iters: 900, epoch: 10 | loss: 0.9104975
	speed: 0.1723s/iter; left time: 70814.2622s
	iters: 1000, epoch: 10 | loss: 1.0002047
	speed: 0.1721s/iter; left time: 70735.6247s
	iters: 1100, epoch: 10 | loss: 1.5141469
	speed: 0.1723s/iter; left time: 70812.5534s
	iters: 1200, epoch: 10 | loss: 0.9058362
	speed: 0.1724s/iter; left time: 70821.7826s
	iters: 1300, epoch: 10 | loss: 0.7899687
	speed: 0.1722s/iter; left time: 70738.5734s
	iters: 1400, epoch: 10 | loss: 0.9563819
	speed: 0.1722s/iter; left time: 70687.0722s
	iters: 1500, epoch: 10 | loss: 0.8522955
	speed: 0.1720s/iter; left time: 70612.5916s
	iters: 1600, epoch: 10 | loss: 0.8997185
	speed: 0.1722s/iter; left time: 70656.3914s
	iters: 1700, epoch: 10 | loss: 0.8613107
	speed: 0.1722s/iter; left time: 70637.4362s
	iters: 1800, epoch: 10 | loss: 0.9440494
	speed: 0.1721s/iter; left time: 70613.0727s
	iters: 1900, epoch: 10 | loss: 0.8424546
	speed: 0.1727s/iter; left time: 70815.8853s
	iters: 2000, epoch: 10 | loss: 0.8256764
	speed: 0.1723s/iter; left time: 70635.3266s
	iters: 2100, epoch: 10 | loss: 0.7004813
	speed: 0.1723s/iter; left time: 70616.6770s
Epoch: 10 cost time: 373.47762870788574
Epoch: 10, Steps: 2157 | Train Loss: 0.9103504 Vali Loss: 0.9918793 Test Loss: 1.0414045
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 11 | loss: 0.8390164
	speed: 1.4893s/iter; left time: 610204.8342s
	iters: 200, epoch: 11 | loss: 0.7632338
	speed: 0.1725s/iter; left time: 70680.4993s
	iters: 300, epoch: 11 | loss: 0.7989635
	speed: 0.1726s/iter; left time: 70695.3799s
	iters: 400, epoch: 11 | loss: 0.8787953
	speed: 0.1727s/iter; left time: 70702.5360s
	iters: 500, epoch: 11 | loss: 1.0594316
	speed: 0.1743s/iter; left time: 71349.0120s
	iters: 600, epoch: 11 | loss: 0.9504559
	speed: 0.1728s/iter; left time: 70724.8764s
	iters: 700, epoch: 11 | loss: 1.0057207
	speed: 0.1722s/iter; left time: 70467.2982s
	iters: 800, epoch: 11 | loss: 0.8615008
	speed: 0.1728s/iter; left time: 70673.7390s
	iters: 900, epoch: 11 | loss: 0.9492460
	speed: 0.1728s/iter; left time: 70663.6667s
	iters: 1000, epoch: 11 | loss: 0.9249532
	speed: 0.1732s/iter; left time: 70825.2445s
	iters: 1100, epoch: 11 | loss: 0.8521494
	speed: 0.1735s/iter; left time: 70921.5326s
	iters: 1200, epoch: 11 | loss: 0.7927139
	speed: 0.1731s/iter; left time: 70723.9161s
	iters: 1300, epoch: 11 | loss: 0.8887408
	speed: 0.1727s/iter; left time: 70543.0190s
	iters: 1400, epoch: 11 | loss: 1.0094788
	speed: 0.1721s/iter; left time: 70304.6062s
	iters: 1500, epoch: 11 | loss: 0.9090039
	speed: 0.1723s/iter; left time: 70343.5844s
	iters: 1600, epoch: 11 | loss: 1.0069817
	speed: 0.1731s/iter; left time: 70680.0813s
	iters: 1700, epoch: 11 | loss: 1.0175176
	speed: 0.1727s/iter; left time: 70468.4922s
	iters: 1800, epoch: 11 | loss: 0.9282413
	speed: 0.1723s/iter; left time: 70308.4907s
	iters: 1900, epoch: 11 | loss: 0.8486676
	speed: 0.1735s/iter; left time: 70789.8884s
	iters: 2000, epoch: 11 | loss: 1.1184003
	speed: 0.1728s/iter; left time: 70472.5481s
	iters: 2100, epoch: 11 | loss: 0.7798051
	speed: 0.1729s/iter; left time: 70484.3838s
Epoch: 11 cost time: 372.89775562286377
Epoch: 11, Steps: 2157 | Train Loss: 0.9277907 Vali Loss: 0.9785658 Test Loss: 1.0910455
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 12 | loss: 0.7879028
	speed: 1.4924s/iter; left time: 608270.2679s
	iters: 200, epoch: 12 | loss: 1.0533161
	speed: 0.1724s/iter; left time: 70228.2562s
	iters: 300, epoch: 12 | loss: 1.0155748
	speed: 0.1723s/iter; left time: 70201.5970s
	iters: 400, epoch: 12 | loss: 0.8269929
	speed: 0.1725s/iter; left time: 70267.9621s
	iters: 500, epoch: 12 | loss: 0.9059688
	speed: 0.1726s/iter; left time: 70259.1022s
	iters: 600, epoch: 12 | loss: 1.0286237
	speed: 0.1681s/iter; left time: 68424.7698s
	iters: 700, epoch: 12 | loss: 0.8514171
	speed: 0.1683s/iter; left time: 68491.8939s
	iters: 800, epoch: 12 | loss: 0.9140679
	speed: 0.1693s/iter; left time: 68871.5719s
	iters: 900, epoch: 12 | loss: 0.8275071
	speed: 0.1723s/iter; left time: 70082.7815s
	iters: 1000, epoch: 12 | loss: 0.7880546
	speed: 0.1729s/iter; left time: 70304.2890s
	iters: 1100, epoch: 12 | loss: 0.7659785
	speed: 0.1727s/iter; left time: 70232.3893s
	iters: 1200, epoch: 12 | loss: 1.0491887
	speed: 0.1735s/iter; left time: 70504.6085s
	iters: 1300, epoch: 12 | loss: 0.9667228
	speed: 0.1728s/iter; left time: 70211.6444s
	iters: 1400, epoch: 12 | loss: 0.8072131
	speed: 0.1725s/iter; left time: 70082.4093s
	iters: 1500, epoch: 12 | loss: 0.9172945
	speed: 0.1723s/iter; left time: 69997.4308s
	iters: 1600, epoch: 12 | loss: 0.7904831
	speed: 0.1723s/iter; left time: 69967.1379s
	iters: 1700, epoch: 12 | loss: 0.7969320
	speed: 0.1724s/iter; left time: 70009.7009s
	iters: 1800, epoch: 12 | loss: 0.8226553
	speed: 0.1724s/iter; left time: 69975.6591s
	iters: 1900, epoch: 12 | loss: 0.7807647
	speed: 0.1725s/iter; left time: 70000.0125s
	iters: 2000, epoch: 12 | loss: 0.8424205
	speed: 0.1725s/iter; left time: 69976.0849s
	iters: 2100, epoch: 12 | loss: 0.8571929
	speed: 0.1727s/iter; left time: 70039.9802s
Epoch: 12 cost time: 371.1850779056549
Epoch: 12, Steps: 2157 | Train Loss: 0.8968626 Vali Loss: 0.9699851 Test Loss: 1.0671777
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 89794
test shape: (8979, 1, 336, 130) (8979, 1, 336, 130)
test shape: (8979, 336, 130) (8979, 336, 130)
mse:0.9545745253562927, mae:0.7394523620605469
>>>>>>>Overall time: 6115 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
