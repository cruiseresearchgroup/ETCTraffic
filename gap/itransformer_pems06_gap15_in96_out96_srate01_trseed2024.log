Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 743094
val 142452
test 142450
	iters: 100, epoch: 1 | loss: 1.3108453
	speed: 0.0318s/iter; left time: 1474.5452s
	iters: 200, epoch: 1 | loss: 1.4508710
	speed: 0.0302s/iter; left time: 1394.6748s
	iters: 300, epoch: 1 | loss: 1.8025216
	speed: 0.0294s/iter; left time: 1355.7644s
	iters: 400, epoch: 1 | loss: 2.0299463
	speed: 0.0303s/iter; left time: 1397.1887s
	iters: 500, epoch: 1 | loss: 1.7678055
	speed: 0.0298s/iter; left time: 1368.0378s
	iters: 600, epoch: 1 | loss: 1.5733117
	speed: 0.0300s/iter; left time: 1377.4749s
	iters: 700, epoch: 1 | loss: 1.8182806
	speed: 0.0301s/iter; left time: 1376.2909s
	iters: 800, epoch: 1 | loss: 1.8618376
	speed: 0.0297s/iter; left time: 1357.7317s
	iters: 900, epoch: 1 | loss: 1.0444707
	speed: 0.0297s/iter; left time: 1351.6220s
	iters: 1000, epoch: 1 | loss: 1.6031902
	speed: 0.0303s/iter; left time: 1378.5767s
	iters: 1100, epoch: 1 | loss: 1.4974480
	speed: 0.0294s/iter; left time: 1331.6410s
	iters: 1200, epoch: 1 | loss: 1.8462993
	speed: 0.0303s/iter; left time: 1368.6899s
	iters: 1300, epoch: 1 | loss: 2.0027716
	speed: 0.0301s/iter; left time: 1359.6608s
	iters: 1400, epoch: 1 | loss: 1.7919945
	speed: 0.0294s/iter; left time: 1323.5304s
	iters: 1500, epoch: 1 | loss: 1.8091879
	speed: 0.0295s/iter; left time: 1323.6143s
	iters: 1600, epoch: 1 | loss: 2.0294020
	speed: 0.0301s/iter; left time: 1350.5708s
	iters: 1700, epoch: 1 | loss: 1.6868426
	speed: 0.0298s/iter; left time: 1334.5055s
	iters: 1800, epoch: 1 | loss: 1.4691821
	speed: 0.0304s/iter; left time: 1357.9463s
	iters: 1900, epoch: 1 | loss: 2.0178888
	speed: 0.0297s/iter; left time: 1324.4694s
	iters: 2000, epoch: 1 | loss: 1.6717051
	speed: 0.0297s/iter; left time: 1317.7470s
	iters: 2100, epoch: 1 | loss: 1.5719869
	speed: 0.0305s/iter; left time: 1351.7869s
	iters: 2200, epoch: 1 | loss: 2.0570292
	speed: 0.0298s/iter; left time: 1317.7266s
	iters: 2300, epoch: 1 | loss: 1.5141405
	speed: 0.0300s/iter; left time: 1325.7012s
	iters: 2400, epoch: 1 | loss: 1.7014666
	speed: 0.0302s/iter; left time: 1328.4794s
	iters: 2500, epoch: 1 | loss: 1.5299277
	speed: 0.0304s/iter; left time: 1333.7807s
	iters: 2600, epoch: 1 | loss: 2.0025063
	speed: 0.0302s/iter; left time: 1322.4028s
	iters: 2700, epoch: 1 | loss: 1.8573163
	speed: 0.0304s/iter; left time: 1328.3416s
	iters: 2800, epoch: 1 | loss: 1.7232095
	speed: 0.0300s/iter; left time: 1310.9719s
	iters: 2900, epoch: 1 | loss: 1.5348803
	speed: 0.0299s/iter; left time: 1300.5656s
	iters: 3000, epoch: 1 | loss: 2.2380011
	speed: 0.0303s/iter; left time: 1316.6793s
	iters: 3100, epoch: 1 | loss: 2.0835180
	speed: 0.0294s/iter; left time: 1273.8629s
	iters: 3200, epoch: 1 | loss: 1.6741850
	speed: 0.0296s/iter; left time: 1281.5745s
	iters: 3300, epoch: 1 | loss: 1.9490044
	speed: 0.0297s/iter; left time: 1281.9513s
	iters: 3400, epoch: 1 | loss: 1.8157030
	speed: 0.0302s/iter; left time: 1298.7016s
	iters: 3500, epoch: 1 | loss: 1.6827822
	speed: 0.0301s/iter; left time: 1290.6809s
	iters: 3600, epoch: 1 | loss: 1.9462447
	speed: 0.0299s/iter; left time: 1281.8390s
	iters: 3700, epoch: 1 | loss: 1.6816814
	speed: 0.0300s/iter; left time: 1280.3814s
	iters: 3800, epoch: 1 | loss: 1.9520998
	speed: 0.0303s/iter; left time: 1293.9636s
	iters: 3900, epoch: 1 | loss: 1.9273269
	speed: 0.0303s/iter; left time: 1288.2009s
	iters: 4000, epoch: 1 | loss: 1.4521593
	speed: 0.0303s/iter; left time: 1286.8719s
	iters: 4100, epoch: 1 | loss: 2.1632125
	speed: 0.0302s/iter; left time: 1279.9336s
	iters: 4200, epoch: 1 | loss: 1.2763119
	speed: 0.0302s/iter; left time: 1276.9855s
	iters: 4300, epoch: 1 | loss: 2.0559862
	speed: 0.0301s/iter; left time: 1267.3718s
	iters: 4400, epoch: 1 | loss: 1.5622121
	speed: 0.0302s/iter; left time: 1267.8232s
	iters: 4500, epoch: 1 | loss: 1.3720428
	speed: 0.0303s/iter; left time: 1271.4438s
	iters: 4600, epoch: 1 | loss: 1.6044234
	speed: 0.0294s/iter; left time: 1231.6331s
Epoch: 1 cost time: 139.53417372703552
Epoch: 1, Steps: 4644 | Train Loss: 1.7390917 Vali Loss: 0.9811887 Test Loss: 1.3319802
Validation loss decreased (inf --> 0.981189).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.5468142
	speed: 0.6625s/iter; left time: 27623.7572s
	iters: 200, epoch: 2 | loss: 1.7128780
	speed: 0.0299s/iter; left time: 1242.3061s
	iters: 300, epoch: 2 | loss: 2.0505400
	speed: 0.0302s/iter; left time: 1253.5198s
	iters: 400, epoch: 2 | loss: 1.6590760
	speed: 0.0297s/iter; left time: 1229.1339s
	iters: 500, epoch: 2 | loss: 1.5760577
	speed: 0.0297s/iter; left time: 1227.6726s
	iters: 600, epoch: 2 | loss: 1.3500919
	speed: 0.0300s/iter; left time: 1236.9612s
	iters: 700, epoch: 2 | loss: 1.5855401
	speed: 0.0292s/iter; left time: 1199.5493s
	iters: 800, epoch: 2 | loss: 1.8482243
	speed: 0.0298s/iter; left time: 1220.9921s
	iters: 900, epoch: 2 | loss: 1.9843214
	speed: 0.0302s/iter; left time: 1234.0177s
	iters: 1000, epoch: 2 | loss: 1.7074797
	speed: 0.0302s/iter; left time: 1233.6021s
	iters: 1100, epoch: 2 | loss: 2.1564612
	speed: 0.0301s/iter; left time: 1224.3837s
	iters: 1200, epoch: 2 | loss: 1.3855234
	speed: 0.0303s/iter; left time: 1231.2681s
	iters: 1300, epoch: 2 | loss: 1.8095686
	speed: 0.0301s/iter; left time: 1220.7962s
	iters: 1400, epoch: 2 | loss: 1.6755888
	speed: 0.0304s/iter; left time: 1227.8209s
	iters: 1500, epoch: 2 | loss: 1.8962284
	speed: 0.0303s/iter; left time: 1222.0666s
	iters: 1600, epoch: 2 | loss: 2.0077043
	speed: 0.0297s/iter; left time: 1192.6172s
	iters: 1700, epoch: 2 | loss: 1.4711689
	speed: 0.0297s/iter; left time: 1188.9249s
	iters: 1800, epoch: 2 | loss: 1.5877488
	speed: 0.0301s/iter; left time: 1202.2698s
	iters: 1900, epoch: 2 | loss: 1.6156036
	speed: 0.0303s/iter; left time: 1210.8312s
	iters: 2000, epoch: 2 | loss: 1.9219799
	speed: 0.0296s/iter; left time: 1179.9753s
	iters: 2100, epoch: 2 | loss: 1.6427611
	speed: 0.0295s/iter; left time: 1172.5495s
	iters: 2200, epoch: 2 | loss: 1.7425071
	speed: 0.0290s/iter; left time: 1147.0815s
	iters: 2300, epoch: 2 | loss: 1.6924678
	speed: 0.0299s/iter; left time: 1181.8465s
	iters: 2400, epoch: 2 | loss: 1.5976841
	speed: 0.0304s/iter; left time: 1196.8620s
	iters: 2500, epoch: 2 | loss: 1.2548147
	speed: 0.0298s/iter; left time: 1173.0128s
	iters: 2600, epoch: 2 | loss: 2.0380158
	speed: 0.0300s/iter; left time: 1175.0015s
	iters: 2700, epoch: 2 | loss: 1.8485559
	speed: 0.0294s/iter; left time: 1150.2531s
	iters: 2800, epoch: 2 | loss: 1.5391349
	speed: 0.0290s/iter; left time: 1129.6916s
	iters: 2900, epoch: 2 | loss: 1.8077976
	speed: 0.0294s/iter; left time: 1143.8586s
	iters: 3000, epoch: 2 | loss: 2.2039263
	speed: 0.0304s/iter; left time: 1177.8619s
	iters: 3100, epoch: 2 | loss: 2.2592273
	speed: 0.0302s/iter; left time: 1167.1938s
	iters: 3200, epoch: 2 | loss: 1.5430936
	speed: 0.0299s/iter; left time: 1152.5012s
	iters: 3300, epoch: 2 | loss: 1.8988174
	speed: 0.0293s/iter; left time: 1129.2924s
	iters: 3400, epoch: 2 | loss: 1.5535165
	speed: 0.0289s/iter; left time: 1108.3030s
	iters: 3500, epoch: 2 | loss: 1.9677798
	speed: 0.0304s/iter; left time: 1163.1671s
	iters: 3600, epoch: 2 | loss: 1.3808937
	speed: 0.0298s/iter; left time: 1137.8615s
	iters: 3700, epoch: 2 | loss: 1.9986110
	speed: 0.0296s/iter; left time: 1127.8750s
	iters: 3800, epoch: 2 | loss: 1.6925102
	speed: 0.0294s/iter; left time: 1117.9948s
	iters: 3900, epoch: 2 | loss: 1.6647276
	speed: 0.0298s/iter; left time: 1127.9475s
	iters: 4000, epoch: 2 | loss: 1.8022368
	speed: 0.0299s/iter; left time: 1131.2259s
	iters: 4100, epoch: 2 | loss: 1.6394578
	speed: 0.0304s/iter; left time: 1145.8314s
	iters: 4200, epoch: 2 | loss: 1.7702465
	speed: 0.0303s/iter; left time: 1140.4254s
	iters: 4300, epoch: 2 | loss: 1.9647598
	speed: 0.0302s/iter; left time: 1133.7487s
	iters: 4400, epoch: 2 | loss: 1.2758814
	speed: 0.0293s/iter; left time: 1094.6526s
	iters: 4500, epoch: 2 | loss: 1.8154268
	speed: 0.0304s/iter; left time: 1132.4114s
	iters: 4600, epoch: 2 | loss: 1.7382956
	speed: 0.0302s/iter; left time: 1122.9132s
Epoch: 2 cost time: 138.8553831577301
Epoch: 2, Steps: 4644 | Train Loss: 1.7504910 Vali Loss: 0.9790030 Test Loss: 1.3307158
Validation loss decreased (0.981189 --> 0.979003).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6673867
	speed: 0.6637s/iter; left time: 24591.5421s
	iters: 200, epoch: 3 | loss: 1.7758539
	speed: 0.0296s/iter; left time: 1094.8878s
	iters: 300, epoch: 3 | loss: 1.9084092
	speed: 0.0304s/iter; left time: 1120.0289s
	iters: 400, epoch: 3 | loss: 2.0121691
	speed: 0.0303s/iter; left time: 1113.4511s
	iters: 500, epoch: 3 | loss: 1.3878508
	speed: 0.0302s/iter; left time: 1105.1190s
	iters: 600, epoch: 3 | loss: 1.8152900
	speed: 0.0293s/iter; left time: 1072.3062s
	iters: 700, epoch: 3 | loss: 2.3464186
	speed: 0.0302s/iter; left time: 1099.5390s
	iters: 800, epoch: 3 | loss: 1.5248628
	speed: 0.0303s/iter; left time: 1101.7059s
	iters: 900, epoch: 3 | loss: 1.5658573
	speed: 0.0298s/iter; left time: 1080.3553s
	iters: 1000, epoch: 3 | loss: 1.6585988
	speed: 0.0297s/iter; left time: 1073.0555s
	iters: 1100, epoch: 3 | loss: 1.4329053
	speed: 0.0297s/iter; left time: 1069.4242s
	iters: 1200, epoch: 3 | loss: 1.7044202
	speed: 0.0303s/iter; left time: 1089.2025s
	iters: 1300, epoch: 3 | loss: 1.6465743
	speed: 0.0305s/iter; left time: 1092.9967s
	iters: 1400, epoch: 3 | loss: 1.9198197
	speed: 0.0304s/iter; left time: 1086.0844s
	iters: 1500, epoch: 3 | loss: 1.7726568
	speed: 0.0295s/iter; left time: 1050.6217s
	iters: 1600, epoch: 3 | loss: 1.3670938
	speed: 0.0296s/iter; left time: 1054.0355s
	iters: 1700, epoch: 3 | loss: 1.8524119
	speed: 0.0300s/iter; left time: 1065.2132s
	iters: 1800, epoch: 3 | loss: 1.4838767
	speed: 0.0302s/iter; left time: 1066.3767s
	iters: 1900, epoch: 3 | loss: 1.6973164
	speed: 0.0292s/iter; left time: 1028.1202s
	iters: 2000, epoch: 3 | loss: 1.8733137
	speed: 0.0294s/iter; left time: 1033.8904s
	iters: 2100, epoch: 3 | loss: 1.7339503
	speed: 0.0300s/iter; left time: 1050.2150s
	iters: 2200, epoch: 3 | loss: 1.7916983
	speed: 0.0304s/iter; left time: 1061.7186s
	iters: 2300, epoch: 3 | loss: 1.9267212
	speed: 0.0304s/iter; left time: 1058.4310s
	iters: 2400, epoch: 3 | loss: 1.3292705
	speed: 0.0296s/iter; left time: 1030.2697s
	iters: 2500, epoch: 3 | loss: 1.9080735
	speed: 0.0299s/iter; left time: 1035.6068s
	iters: 2600, epoch: 3 | loss: 1.8231199
	speed: 0.0298s/iter; left time: 1028.3642s
	iters: 2700, epoch: 3 | loss: 1.7970325
	speed: 0.0297s/iter; left time: 1023.1647s
	iters: 2800, epoch: 3 | loss: 1.8000942
	speed: 0.0304s/iter; left time: 1042.7146s
	iters: 2900, epoch: 3 | loss: 2.0808399
	speed: 0.0303s/iter; left time: 1036.8381s
	iters: 3000, epoch: 3 | loss: 1.2440112
	speed: 0.0302s/iter; left time: 1031.0766s
	iters: 3100, epoch: 3 | loss: 1.6907766
	speed: 0.0304s/iter; left time: 1034.7284s
	iters: 3200, epoch: 3 | loss: 1.4856067
	speed: 0.0303s/iter; left time: 1028.1447s
	iters: 3300, epoch: 3 | loss: 1.6761262
	speed: 0.0295s/iter; left time: 999.8784s
	iters: 3400, epoch: 3 | loss: 1.9135715
	speed: 0.0300s/iter; left time: 1012.4569s
	iters: 3500, epoch: 3 | loss: 1.6261475
	speed: 0.0299s/iter; left time: 1004.6949s
	iters: 3600, epoch: 3 | loss: 1.9554139
	speed: 0.0298s/iter; left time: 1000.2508s
	iters: 3700, epoch: 3 | loss: 1.9675436
	speed: 0.0291s/iter; left time: 973.5784s
	iters: 3800, epoch: 3 | loss: 1.7951633
	speed: 0.0294s/iter; left time: 981.5146s
	iters: 3900, epoch: 3 | loss: 1.7538612
	speed: 0.0299s/iter; left time: 993.2218s
	iters: 4000, epoch: 3 | loss: 1.7180055
	speed: 0.0300s/iter; left time: 994.2988s
	iters: 4100, epoch: 3 | loss: 1.6385835
	speed: 0.0303s/iter; left time: 1001.0822s
	iters: 4200, epoch: 3 | loss: 2.1531589
	speed: 0.0303s/iter; left time: 997.8393s
	iters: 4300, epoch: 3 | loss: 2.0073445
	speed: 0.0293s/iter; left time: 964.0761s
	iters: 4400, epoch: 3 | loss: 1.6034715
	speed: 0.0303s/iter; left time: 993.7194s
	iters: 4500, epoch: 3 | loss: 1.7810827
	speed: 0.0299s/iter; left time: 975.2067s
	iters: 4600, epoch: 3 | loss: 1.8616717
	speed: 0.0301s/iter; left time: 980.2928s
Epoch: 3 cost time: 139.08477640151978
Epoch: 3, Steps: 4644 | Train Loss: 1.7504890 Vali Loss: 0.9913583 Test Loss: 1.3322240
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.8670361
	speed: 0.6642s/iter; left time: 21527.2142s
	iters: 200, epoch: 4 | loss: 1.6128205
	speed: 0.0297s/iter; left time: 960.8728s
	iters: 300, epoch: 4 | loss: 1.3383417
	speed: 0.0301s/iter; left time: 969.0154s
	iters: 400, epoch: 4 | loss: 1.4807787
	speed: 0.0302s/iter; left time: 969.0456s
	iters: 500, epoch: 4 | loss: 1.6624053
	speed: 0.0296s/iter; left time: 948.6108s
	iters: 600, epoch: 4 | loss: 1.7863791
	speed: 0.0299s/iter; left time: 954.4911s
	iters: 700, epoch: 4 | loss: 2.1563609
	speed: 0.0302s/iter; left time: 960.7432s
	iters: 800, epoch: 4 | loss: 2.2761831
	speed: 0.0300s/iter; left time: 950.8038s
	iters: 900, epoch: 4 | loss: 1.6928859
	speed: 0.0299s/iter; left time: 944.3274s
	iters: 1000, epoch: 4 | loss: 1.6477523
	speed: 0.0305s/iter; left time: 960.3353s
	iters: 1100, epoch: 4 | loss: 1.4133364
	speed: 0.0304s/iter; left time: 953.6314s
	iters: 1200, epoch: 4 | loss: 1.2935115
	speed: 0.0301s/iter; left time: 941.1612s
	iters: 1300, epoch: 4 | loss: 1.7344060
	speed: 0.0305s/iter; left time: 951.5222s
	iters: 1400, epoch: 4 | loss: 2.3682671
	speed: 0.0293s/iter; left time: 912.5334s
	iters: 1500, epoch: 4 | loss: 2.1082399
	speed: 0.0301s/iter; left time: 933.8687s
	iters: 1600, epoch: 4 | loss: 1.8116397
	speed: 0.0297s/iter; left time: 916.8118s
	iters: 1700, epoch: 4 | loss: 1.9536036
	speed: 0.0304s/iter; left time: 935.7752s
	iters: 1800, epoch: 4 | loss: 1.5910382
	speed: 0.0300s/iter; left time: 921.1641s
	iters: 1900, epoch: 4 | loss: 2.1427612
	speed: 0.0298s/iter; left time: 912.7827s
	iters: 2000, epoch: 4 | loss: 1.8190470
	speed: 0.0297s/iter; left time: 905.4126s
	iters: 2100, epoch: 4 | loss: 1.6306496
	speed: 0.0299s/iter; left time: 908.3074s
	iters: 2200, epoch: 4 | loss: 1.2402986
	speed: 0.0301s/iter; left time: 911.0708s
	iters: 2300, epoch: 4 | loss: 1.8883078
	speed: 0.0304s/iter; left time: 917.1411s
	iters: 2400, epoch: 4 | loss: 1.7936083
	speed: 0.0301s/iter; left time: 905.4511s
	iters: 2500, epoch: 4 | loss: 1.9003090
	speed: 0.0301s/iter; left time: 902.6489s
	iters: 2600, epoch: 4 | loss: 1.7802136
	speed: 0.0304s/iter; left time: 908.0984s
	iters: 2700, epoch: 4 | loss: 1.8705449
	speed: 0.0302s/iter; left time: 900.3047s
	iters: 2800, epoch: 4 | loss: 1.7958786
	speed: 0.0302s/iter; left time: 896.1631s
	iters: 2900, epoch: 4 | loss: 1.9054145
	speed: 0.0296s/iter; left time: 877.5853s
	iters: 3000, epoch: 4 | loss: 1.1782755
	speed: 0.0299s/iter; left time: 881.7683s
	iters: 3100, epoch: 4 | loss: 1.7106845
	speed: 0.0245s/iter; left time: 720.8320s
	iters: 3200, epoch: 4 | loss: 1.5058726
	speed: 0.0208s/iter; left time: 609.3067s
	iters: 3300, epoch: 4 | loss: 1.3289142
	speed: 0.0234s/iter; left time: 684.3311s
	iters: 3400, epoch: 4 | loss: 2.3746235
	speed: 0.0294s/iter; left time: 856.1876s
	iters: 3500, epoch: 4 | loss: 1.5041344
	speed: 0.0301s/iter; left time: 873.5534s
	iters: 3600, epoch: 4 | loss: 1.6880995
	speed: 0.0292s/iter; left time: 842.8417s
	iters: 3700, epoch: 4 | loss: 1.5821956
	speed: 0.0301s/iter; left time: 868.5579s
	iters: 3800, epoch: 4 | loss: 1.2591687
	speed: 0.0304s/iter; left time: 871.8224s
	iters: 3900, epoch: 4 | loss: 2.0381558
	speed: 0.0303s/iter; left time: 867.7295s
	iters: 4000, epoch: 4 | loss: 1.7727203
	speed: 0.0299s/iter; left time: 851.6073s
	iters: 4100, epoch: 4 | loss: 1.6929616
	speed: 0.0297s/iter; left time: 844.5866s
	iters: 4200, epoch: 4 | loss: 1.8638110
	speed: 0.0296s/iter; left time: 837.3226s
	iters: 4300, epoch: 4 | loss: 1.5619560
	speed: 0.0300s/iter; left time: 846.5136s
	iters: 4400, epoch: 4 | loss: 1.8289589
	speed: 0.0300s/iter; left time: 843.6823s
	iters: 4500, epoch: 4 | loss: 1.5046111
	speed: 0.0303s/iter; left time: 848.3904s
	iters: 4600, epoch: 4 | loss: 1.5619389
	speed: 0.0290s/iter; left time: 809.8153s
Epoch: 4 cost time: 137.15639925003052
Epoch: 4, Steps: 4644 | Train Loss: 1.7498071 Vali Loss: 0.9933600 Test Loss: 1.3309950
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.9124584
	speed: 0.6640s/iter; left time: 18436.5287s
	iters: 200, epoch: 5 | loss: 1.5222288
	speed: 0.0298s/iter; left time: 825.0900s
	iters: 300, epoch: 5 | loss: 1.5726172
	speed: 0.0298s/iter; left time: 820.7237s
	iters: 400, epoch: 5 | loss: 1.3899623
	speed: 0.0295s/iter; left time: 809.9041s
	iters: 500, epoch: 5 | loss: 1.9496332
	speed: 0.0304s/iter; left time: 831.6068s
	iters: 600, epoch: 5 | loss: 1.7748311
	speed: 0.0299s/iter; left time: 815.2063s
	iters: 700, epoch: 5 | loss: 1.6414465
	speed: 0.0292s/iter; left time: 794.5444s
	iters: 800, epoch: 5 | loss: 1.8268521
	speed: 0.0297s/iter; left time: 802.5602s
	iters: 900, epoch: 5 | loss: 1.4137781
	speed: 0.0301s/iter; left time: 810.4671s
	iters: 1000, epoch: 5 | loss: 1.4474859
	speed: 0.0301s/iter; left time: 807.7253s
	iters: 1100, epoch: 5 | loss: 2.1890910
	speed: 0.0298s/iter; left time: 796.9225s
	iters: 1200, epoch: 5 | loss: 1.6074598
	speed: 0.0299s/iter; left time: 795.9967s
	iters: 1300, epoch: 5 | loss: 1.9384040
	speed: 0.0295s/iter; left time: 783.6686s
	iters: 1400, epoch: 5 | loss: 1.7300625
	speed: 0.0301s/iter; left time: 795.9716s
	iters: 1500, epoch: 5 | loss: 2.1094377
	speed: 0.0295s/iter; left time: 777.1964s
	iters: 1600, epoch: 5 | loss: 1.6176753
	speed: 0.0301s/iter; left time: 790.7333s
	iters: 1700, epoch: 5 | loss: 1.8151337
	speed: 0.0302s/iter; left time: 788.9203s
	iters: 1800, epoch: 5 | loss: 1.4628900
	speed: 0.0296s/iter; left time: 770.7044s
	iters: 1900, epoch: 5 | loss: 1.4189487
	speed: 0.0305s/iter; left time: 792.1581s
	iters: 2000, epoch: 5 | loss: 1.5975900
	speed: 0.0305s/iter; left time: 789.2086s
	iters: 2100, epoch: 5 | loss: 1.6601337
	speed: 0.0301s/iter; left time: 775.0746s
	iters: 2200, epoch: 5 | loss: 1.3509922
	speed: 0.0296s/iter; left time: 760.9167s
	iters: 2300, epoch: 5 | loss: 1.8007959
	speed: 0.0291s/iter; left time: 744.7860s
	iters: 2400, epoch: 5 | loss: 1.8046449
	speed: 0.0297s/iter; left time: 755.9272s
	iters: 2500, epoch: 5 | loss: 1.9220374
	speed: 0.0302s/iter; left time: 764.9828s
	iters: 2600, epoch: 5 | loss: 1.2785401
	speed: 0.0298s/iter; left time: 752.6365s
	iters: 2700, epoch: 5 | loss: 1.9406923
	speed: 0.0300s/iter; left time: 756.0277s
	iters: 2800, epoch: 5 | loss: 1.5505939
	speed: 0.0293s/iter; left time: 734.9152s
	iters: 2900, epoch: 5 | loss: 1.8922541
	speed: 0.0302s/iter; left time: 753.5358s
	iters: 3000, epoch: 5 | loss: 1.9577734
	speed: 0.0304s/iter; left time: 754.9677s
	iters: 3100, epoch: 5 | loss: 1.7544980
	speed: 0.0303s/iter; left time: 751.4777s
	iters: 3200, epoch: 5 | loss: 2.0454104
	speed: 0.0302s/iter; left time: 744.3102s
	iters: 3300, epoch: 5 | loss: 1.6828513
	speed: 0.0303s/iter; left time: 745.2416s
	iters: 3400, epoch: 5 | loss: 1.8415935
	speed: 0.0304s/iter; left time: 742.8870s
	iters: 3500, epoch: 5 | loss: 1.5367746
	speed: 0.0302s/iter; left time: 734.9527s
	iters: 3600, epoch: 5 | loss: 2.0537839
	speed: 0.0303s/iter; left time: 735.3221s
	iters: 3700, epoch: 5 | loss: 2.0542569
	speed: 0.0300s/iter; left time: 724.6853s
	iters: 3800, epoch: 5 | loss: 1.6761214
	speed: 0.0296s/iter; left time: 711.3972s
	iters: 3900, epoch: 5 | loss: 1.9655430
	speed: 0.0297s/iter; left time: 710.5678s
	iters: 4000, epoch: 5 | loss: 1.5908701
	speed: 0.0300s/iter; left time: 715.0338s
	iters: 4100, epoch: 5 | loss: 1.7126667
	speed: 0.0304s/iter; left time: 722.1334s
	iters: 4200, epoch: 5 | loss: 2.0154250
	speed: 0.0298s/iter; left time: 704.2327s
	iters: 4300, epoch: 5 | loss: 1.8522412
	speed: 0.0299s/iter; left time: 705.0012s
	iters: 4400, epoch: 5 | loss: 1.7044486
	speed: 0.0302s/iter; left time: 709.2095s
	iters: 4500, epoch: 5 | loss: 2.3543172
	speed: 0.0294s/iter; left time: 686.7664s
	iters: 4600, epoch: 5 | loss: 1.6511832
	speed: 0.0290s/iter; left time: 673.7122s
Epoch: 5 cost time: 138.99152755737305
Epoch: 5, Steps: 4644 | Train Loss: 1.7495817 Vali Loss: 0.9804226 Test Loss: 1.3303920
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 142450
test shape: (14245, 1, 96, 130) (14245, 1, 96, 130)
test shape: (14245, 96, 130) (14245, 96, 130)
mse:1.3307186365127563, mae:0.8912805318832397
>>>>>>>Overall time: 1127 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
