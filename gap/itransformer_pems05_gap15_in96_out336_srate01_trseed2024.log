Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=103, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems05_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 600535
val 94772
test 94771
	iters: 100, epoch: 1 | loss: 1.4789826
	speed: 0.0333s/iter; left time: 1247.7058s
	iters: 200, epoch: 1 | loss: 1.4571241
	speed: 0.0306s/iter; left time: 1141.1208s
	iters: 300, epoch: 1 | loss: 1.5002118
	speed: 0.0304s/iter; left time: 1130.8536s
	iters: 400, epoch: 1 | loss: 1.5211813
	speed: 0.0304s/iter; left time: 1128.9103s
	iters: 500, epoch: 1 | loss: 1.7690277
	speed: 0.0304s/iter; left time: 1125.7560s
	iters: 600, epoch: 1 | loss: 1.5687681
	speed: 0.0304s/iter; left time: 1121.5231s
	iters: 700, epoch: 1 | loss: 1.8479797
	speed: 0.0304s/iter; left time: 1119.0254s
	iters: 800, epoch: 1 | loss: 1.3867006
	speed: 0.0304s/iter; left time: 1116.0555s
	iters: 900, epoch: 1 | loss: 1.4458164
	speed: 0.0305s/iter; left time: 1117.0954s
	iters: 1000, epoch: 1 | loss: 1.4007804
	speed: 0.0304s/iter; left time: 1110.5491s
	iters: 1100, epoch: 1 | loss: 1.5050313
	speed: 0.0304s/iter; left time: 1107.0404s
	iters: 1200, epoch: 1 | loss: 1.4973502
	speed: 0.0304s/iter; left time: 1104.9665s
	iters: 1300, epoch: 1 | loss: 1.5171015
	speed: 0.0304s/iter; left time: 1101.4810s
	iters: 1400, epoch: 1 | loss: 1.6495192
	speed: 0.0304s/iter; left time: 1098.3403s
	iters: 1500, epoch: 1 | loss: 1.6755825
	speed: 0.0305s/iter; left time: 1098.9706s
	iters: 1600, epoch: 1 | loss: 1.4790499
	speed: 0.0304s/iter; left time: 1091.7779s
	iters: 1700, epoch: 1 | loss: 1.5677178
	speed: 0.0304s/iter; left time: 1089.3653s
	iters: 1800, epoch: 1 | loss: 1.7603573
	speed: 0.0304s/iter; left time: 1086.4630s
	iters: 1900, epoch: 1 | loss: 1.6228486
	speed: 0.0304s/iter; left time: 1083.0874s
	iters: 2000, epoch: 1 | loss: 1.6131767
	speed: 0.0304s/iter; left time: 1080.7345s
	iters: 2100, epoch: 1 | loss: 1.5626609
	speed: 0.0304s/iter; left time: 1077.5972s
	iters: 2200, epoch: 1 | loss: 1.6722876
	speed: 0.0304s/iter; left time: 1075.2777s
	iters: 2300, epoch: 1 | loss: 1.8483849
	speed: 0.0304s/iter; left time: 1069.4446s
	iters: 2400, epoch: 1 | loss: 1.5515666
	speed: 0.0304s/iter; left time: 1067.2890s
	iters: 2500, epoch: 1 | loss: 1.7827518
	speed: 0.0305s/iter; left time: 1069.1213s
	iters: 2600, epoch: 1 | loss: 1.5737470
	speed: 0.0304s/iter; left time: 1062.1995s
	iters: 2700, epoch: 1 | loss: 1.7940272
	speed: 0.0303s/iter; left time: 1056.4190s
	iters: 2800, epoch: 1 | loss: 1.4449815
	speed: 0.0303s/iter; left time: 1054.0203s
	iters: 2900, epoch: 1 | loss: 1.4782187
	speed: 0.0304s/iter; left time: 1052.1722s
	iters: 3000, epoch: 1 | loss: 1.5133952
	speed: 0.0304s/iter; left time: 1049.8408s
	iters: 3100, epoch: 1 | loss: 1.5854095
	speed: 0.0304s/iter; left time: 1046.3977s
	iters: 3200, epoch: 1 | loss: 1.9117653
	speed: 0.0304s/iter; left time: 1044.5256s
	iters: 3300, epoch: 1 | loss: 1.5038989
	speed: 0.0304s/iter; left time: 1041.4987s
	iters: 3400, epoch: 1 | loss: 1.4302862
	speed: 0.0304s/iter; left time: 1036.7307s
	iters: 3500, epoch: 1 | loss: 1.4380579
	speed: 0.0304s/iter; left time: 1036.2013s
	iters: 3600, epoch: 1 | loss: 1.4685519
	speed: 0.0304s/iter; left time: 1031.2022s
	iters: 3700, epoch: 1 | loss: 1.4933490
	speed: 0.0303s/iter; left time: 1024.5840s
Epoch: 1 cost time: 114.49265360832214
Epoch: 1, Steps: 3753 | Train Loss: 1.5942706 Vali Loss: 1.7599978 Test Loss: 2.2144356
Validation loss decreased (inf --> 1.759998).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.8064150
	speed: 0.5016s/iter; left time: 16891.6345s
	iters: 200, epoch: 2 | loss: 1.2346607
	speed: 0.0304s/iter; left time: 1020.1375s
	iters: 300, epoch: 2 | loss: 1.5587009
	speed: 0.0304s/iter; left time: 1016.8652s
	iters: 400, epoch: 2 | loss: 1.6400112
	speed: 0.0304s/iter; left time: 1014.1775s
	iters: 500, epoch: 2 | loss: 1.7395606
	speed: 0.0304s/iter; left time: 1011.4244s
	iters: 600, epoch: 2 | loss: 1.8182778
	speed: 0.0304s/iter; left time: 1008.1278s
	iters: 700, epoch: 2 | loss: 1.6488503
	speed: 0.0304s/iter; left time: 1005.2507s
	iters: 800, epoch: 2 | loss: 1.5103714
	speed: 0.0304s/iter; left time: 1001.7198s
	iters: 900, epoch: 2 | loss: 1.6695879
	speed: 0.0304s/iter; left time: 999.1116s
	iters: 1000, epoch: 2 | loss: 1.6523367
	speed: 0.0304s/iter; left time: 996.3244s
	iters: 1100, epoch: 2 | loss: 1.5091069
	speed: 0.0304s/iter; left time: 993.8748s
	iters: 1200, epoch: 2 | loss: 1.6337579
	speed: 0.0305s/iter; left time: 992.9611s
	iters: 1300, epoch: 2 | loss: 1.6625128
	speed: 0.0304s/iter; left time: 987.3847s
	iters: 1400, epoch: 2 | loss: 1.5237710
	speed: 0.0304s/iter; left time: 984.3181s
	iters: 1500, epoch: 2 | loss: 1.7834258
	speed: 0.0304s/iter; left time: 980.3448s
	iters: 1600, epoch: 2 | loss: 1.7343730
	speed: 0.0304s/iter; left time: 977.4297s
	iters: 1700, epoch: 2 | loss: 1.4083880
	speed: 0.0304s/iter; left time: 974.9974s
	iters: 1800, epoch: 2 | loss: 1.7382121
	speed: 0.0304s/iter; left time: 971.8054s
	iters: 1900, epoch: 2 | loss: 1.7478848
	speed: 0.0304s/iter; left time: 970.5898s
	iters: 2000, epoch: 2 | loss: 1.5772649
	speed: 0.0304s/iter; left time: 965.3237s
	iters: 2100, epoch: 2 | loss: 1.6218432
	speed: 0.0304s/iter; left time: 963.1292s
	iters: 2200, epoch: 2 | loss: 1.4150810
	speed: 0.0304s/iter; left time: 960.7225s
	iters: 2300, epoch: 2 | loss: 1.5810204
	speed: 0.0304s/iter; left time: 956.3729s
	iters: 2400, epoch: 2 | loss: 1.6938574
	speed: 0.0304s/iter; left time: 953.8523s
	iters: 2500, epoch: 2 | loss: 1.7056460
	speed: 0.0304s/iter; left time: 950.0745s
	iters: 2600, epoch: 2 | loss: 1.5212379
	speed: 0.0304s/iter; left time: 947.7007s
	iters: 2700, epoch: 2 | loss: 1.5795599
	speed: 0.0304s/iter; left time: 944.8840s
	iters: 2800, epoch: 2 | loss: 1.8301026
	speed: 0.0304s/iter; left time: 942.7547s
	iters: 2900, epoch: 2 | loss: 1.5695641
	speed: 0.0305s/iter; left time: 940.9051s
	iters: 3000, epoch: 2 | loss: 1.6745496
	speed: 0.0304s/iter; left time: 934.2705s
	iters: 3100, epoch: 2 | loss: 1.6350393
	speed: 0.0304s/iter; left time: 931.9354s
	iters: 3200, epoch: 2 | loss: 1.5087506
	speed: 0.0304s/iter; left time: 929.9029s
	iters: 3300, epoch: 2 | loss: 1.5889504
	speed: 0.0304s/iter; left time: 925.8159s
	iters: 3400, epoch: 2 | loss: 1.5107913
	speed: 0.0304s/iter; left time: 923.6292s
	iters: 3500, epoch: 2 | loss: 1.6567731
	speed: 0.0304s/iter; left time: 919.5516s
	iters: 3600, epoch: 2 | loss: 1.5534526
	speed: 0.0304s/iter; left time: 918.3650s
	iters: 3700, epoch: 2 | loss: 1.5529842
	speed: 0.0307s/iter; left time: 923.7623s
Epoch: 2 cost time: 114.26202368736267
Epoch: 2, Steps: 3753 | Train Loss: 1.6078199 Vali Loss: 1.8694233 Test Loss: 2.2364638
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.5757458
	speed: 0.5014s/iter; left time: 15004.7724s
	iters: 200, epoch: 3 | loss: 1.8968790
	speed: 0.0305s/iter; left time: 908.8664s
	iters: 300, epoch: 3 | loss: 1.5935084
	speed: 0.0304s/iter; left time: 903.1681s
	iters: 400, epoch: 3 | loss: 1.5177747
	speed: 0.0304s/iter; left time: 901.1995s
	iters: 500, epoch: 3 | loss: 1.8275681
	speed: 0.0304s/iter; left time: 897.5684s
	iters: 600, epoch: 3 | loss: 1.8139889
	speed: 0.0304s/iter; left time: 895.5214s
	iters: 700, epoch: 3 | loss: 1.7036736
	speed: 0.0304s/iter; left time: 890.8073s
	iters: 800, epoch: 3 | loss: 1.7003380
	speed: 0.0304s/iter; left time: 889.2384s
	iters: 900, epoch: 3 | loss: 1.5422385
	speed: 0.0304s/iter; left time: 884.4787s
	iters: 1000, epoch: 3 | loss: 1.7736200
	speed: 0.0304s/iter; left time: 882.4638s
	iters: 1100, epoch: 3 | loss: 1.5514600
	speed: 0.0305s/iter; left time: 882.5030s
	iters: 1200, epoch: 3 | loss: 1.7118924
	speed: 0.0304s/iter; left time: 876.2482s
	iters: 1300, epoch: 3 | loss: 1.5233251
	speed: 0.0304s/iter; left time: 873.3307s
	iters: 1400, epoch: 3 | loss: 1.5433296
	speed: 0.0304s/iter; left time: 870.0743s
	iters: 1500, epoch: 3 | loss: 1.5913357
	speed: 0.0304s/iter; left time: 865.8619s
	iters: 1600, epoch: 3 | loss: 1.6181338
	speed: 0.0304s/iter; left time: 863.5075s
	iters: 1700, epoch: 3 | loss: 1.6940066
	speed: 0.0303s/iter; left time: 858.6282s
	iters: 1800, epoch: 3 | loss: 1.7027649
	speed: 0.0305s/iter; left time: 860.8768s
	iters: 1900, epoch: 3 | loss: 1.5995157
	speed: 0.0304s/iter; left time: 855.3978s
	iters: 2000, epoch: 3 | loss: 1.5314639
	speed: 0.0304s/iter; left time: 852.3048s
	iters: 2100, epoch: 3 | loss: 1.9191010
	speed: 0.0304s/iter; left time: 849.1656s
	iters: 2200, epoch: 3 | loss: 1.6794466
	speed: 0.0304s/iter; left time: 847.0198s
	iters: 2300, epoch: 3 | loss: 1.4727694
	speed: 0.0304s/iter; left time: 843.3755s
	iters: 2400, epoch: 3 | loss: 1.6303316
	speed: 0.0304s/iter; left time: 839.7656s
	iters: 2500, epoch: 3 | loss: 1.5579835
	speed: 0.0306s/iter; left time: 841.1367s
	iters: 2600, epoch: 3 | loss: 1.4880878
	speed: 0.0305s/iter; left time: 835.6639s
	iters: 2700, epoch: 3 | loss: 1.6337770
	speed: 0.0304s/iter; left time: 830.0320s
	iters: 2800, epoch: 3 | loss: 1.6438451
	speed: 0.0305s/iter; left time: 829.3968s
	iters: 2900, epoch: 3 | loss: 1.6869345
	speed: 0.0306s/iter; left time: 830.8966s
	iters: 3000, epoch: 3 | loss: 1.6332194
	speed: 0.0304s/iter; left time: 822.2039s
	iters: 3100, epoch: 3 | loss: 1.7693822
	speed: 0.0304s/iter; left time: 818.1819s
	iters: 3200, epoch: 3 | loss: 1.7490131
	speed: 0.0307s/iter; left time: 823.3739s
	iters: 3300, epoch: 3 | loss: 1.6115360
	speed: 0.0305s/iter; left time: 815.6641s
	iters: 3400, epoch: 3 | loss: 1.4941877
	speed: 0.0304s/iter; left time: 808.7455s
	iters: 3500, epoch: 3 | loss: 1.6811906
	speed: 0.0304s/iter; left time: 806.5056s
	iters: 3600, epoch: 3 | loss: 1.4302003
	speed: 0.0305s/iter; left time: 804.7213s
	iters: 3700, epoch: 3 | loss: 1.6272037
	speed: 0.0304s/iter; left time: 800.1934s
Epoch: 3 cost time: 114.3479425907135
Epoch: 3, Steps: 3753 | Train Loss: 1.6143725 Vali Loss: 1.8636738 Test Loss: 2.2413862
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.7628270
	speed: 0.4995s/iter; left time: 13071.6248s
	iters: 200, epoch: 4 | loss: 1.5057364
	speed: 0.0304s/iter; left time: 793.6297s
	iters: 300, epoch: 4 | loss: 1.7497247
	speed: 0.0304s/iter; left time: 790.8046s
	iters: 400, epoch: 4 | loss: 1.7081640
	speed: 0.0304s/iter; left time: 786.6198s
	iters: 500, epoch: 4 | loss: 1.6096741
	speed: 0.0304s/iter; left time: 784.2589s
	iters: 600, epoch: 4 | loss: 1.6205113
	speed: 0.0304s/iter; left time: 780.4762s
	iters: 700, epoch: 4 | loss: 1.6844748
	speed: 0.0304s/iter; left time: 777.6130s
	iters: 800, epoch: 4 | loss: 1.6182263
	speed: 0.0304s/iter; left time: 775.4298s
	iters: 900, epoch: 4 | loss: 1.5996473
	speed: 0.0304s/iter; left time: 771.6934s
	iters: 1000, epoch: 4 | loss: 1.5972184
	speed: 0.0305s/iter; left time: 769.7328s
	iters: 1100, epoch: 4 | loss: 1.5434825
	speed: 0.0305s/iter; left time: 766.5370s
	iters: 1200, epoch: 4 | loss: 1.5982981
	speed: 0.0304s/iter; left time: 761.1309s
	iters: 1300, epoch: 4 | loss: 1.5202886
	speed: 0.0304s/iter; left time: 759.9709s
	iters: 1400, epoch: 4 | loss: 1.6490474
	speed: 0.0304s/iter; left time: 757.2700s
	iters: 1500, epoch: 4 | loss: 1.6082964
	speed: 0.0304s/iter; left time: 753.0198s
	iters: 1600, epoch: 4 | loss: 1.6097355
	speed: 0.0304s/iter; left time: 750.8964s
	iters: 1700, epoch: 4 | loss: 1.6813893
	speed: 0.0304s/iter; left time: 746.6786s
	iters: 1800, epoch: 4 | loss: 1.4856025
	speed: 0.0303s/iter; left time: 741.7810s
	iters: 1900, epoch: 4 | loss: 1.5593644
	speed: 0.0304s/iter; left time: 741.3922s
	iters: 2000, epoch: 4 | loss: 1.6908432
	speed: 0.0304s/iter; left time: 737.7432s
	iters: 2100, epoch: 4 | loss: 1.6095301
	speed: 0.0305s/iter; left time: 736.0760s
	iters: 2200, epoch: 4 | loss: 1.4846301
	speed: 0.0304s/iter; left time: 731.1874s
	iters: 2300, epoch: 4 | loss: 1.4992671
	speed: 0.0304s/iter; left time: 728.9715s
	iters: 2400, epoch: 4 | loss: 1.7320443
	speed: 0.0305s/iter; left time: 728.9618s
	iters: 2500, epoch: 4 | loss: 1.6783915
	speed: 0.0305s/iter; left time: 723.9662s
	iters: 2600, epoch: 4 | loss: 1.7874312
	speed: 0.0304s/iter; left time: 720.3614s
	iters: 2700, epoch: 4 | loss: 1.6879897
	speed: 0.0305s/iter; left time: 719.2550s
	iters: 2800, epoch: 4 | loss: 1.7365512
	speed: 0.0304s/iter; left time: 714.5665s
	iters: 2900, epoch: 4 | loss: 1.5969689
	speed: 0.0305s/iter; left time: 712.7431s
	iters: 3000, epoch: 4 | loss: 1.5653688
	speed: 0.0305s/iter; left time: 708.8169s
	iters: 3100, epoch: 4 | loss: 1.5213619
	speed: 0.0305s/iter; left time: 705.9941s
	iters: 3200, epoch: 4 | loss: 1.6071227
	speed: 0.0304s/iter; left time: 702.2589s
	iters: 3300, epoch: 4 | loss: 1.6040826
	speed: 0.0305s/iter; left time: 699.7775s
	iters: 3400, epoch: 4 | loss: 1.6614113
	speed: 0.0304s/iter; left time: 695.7657s
	iters: 3500, epoch: 4 | loss: 1.6893837
	speed: 0.0305s/iter; left time: 695.2962s
	iters: 3600, epoch: 4 | loss: 1.4678470
	speed: 0.0304s/iter; left time: 689.9917s
	iters: 3700, epoch: 4 | loss: 1.6105714
	speed: 0.0304s/iter; left time: 686.2733s
Epoch: 4 cost time: 114.36692118644714
Epoch: 4, Steps: 3753 | Train Loss: 1.6142570 Vali Loss: 1.8636090 Test Loss: 2.2396095
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 94771
test shape: (9477, 1, 336, 103) (9477, 1, 336, 103)
test shape: (9477, 336, 103) (9477, 336, 103)
mse:2.2144365310668945, mae:1.2021839618682861
>>>>>>>Overall time: 736 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
