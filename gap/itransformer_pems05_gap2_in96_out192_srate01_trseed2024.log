Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=103, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems05_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 548263
val 42500
test 42499
	iters: 100, epoch: 1 | loss: 1.9027008
	speed: 0.0327s/iter; left time: 1116.7807s
	iters: 200, epoch: 1 | loss: 1.6673851
	speed: 0.0299s/iter; left time: 1019.2355s
	iters: 300, epoch: 1 | loss: 1.8453358
	speed: 0.0300s/iter; left time: 1017.2151s
	iters: 400, epoch: 1 | loss: 1.8045043
	speed: 0.0300s/iter; left time: 1016.6755s
	iters: 500, epoch: 1 | loss: 1.4555595
	speed: 0.0304s/iter; left time: 1025.7156s
	iters: 600, epoch: 1 | loss: 1.4934592
	speed: 0.0303s/iter; left time: 1020.5119s
	iters: 700, epoch: 1 | loss: 1.5313623
	speed: 0.0302s/iter; left time: 1014.8998s
	iters: 800, epoch: 1 | loss: 1.4151175
	speed: 0.0299s/iter; left time: 1001.7220s
	iters: 900, epoch: 1 | loss: 1.6411840
	speed: 0.0302s/iter; left time: 1008.3300s
	iters: 1000, epoch: 1 | loss: 1.6948539
	speed: 0.0303s/iter; left time: 1007.9816s
	iters: 1100, epoch: 1 | loss: 1.3203220
	speed: 0.0304s/iter; left time: 1006.8791s
	iters: 1200, epoch: 1 | loss: 1.5289021
	speed: 0.0303s/iter; left time: 1003.0345s
	iters: 1300, epoch: 1 | loss: 1.6384084
	speed: 0.0302s/iter; left time: 995.2535s
	iters: 1400, epoch: 1 | loss: 1.5565912
	speed: 0.0303s/iter; left time: 997.1445s
	iters: 1500, epoch: 1 | loss: 1.4445578
	speed: 0.0303s/iter; left time: 994.1826s
	iters: 1600, epoch: 1 | loss: 1.8043225
	speed: 0.0303s/iter; left time: 991.0395s
	iters: 1700, epoch: 1 | loss: 1.6341461
	speed: 0.0302s/iter; left time: 984.4849s
	iters: 1800, epoch: 1 | loss: 1.6163082
	speed: 0.0303s/iter; left time: 983.6374s
	iters: 1900, epoch: 1 | loss: 1.6330835
	speed: 0.0303s/iter; left time: 981.4807s
	iters: 2000, epoch: 1 | loss: 1.2032828
	speed: 0.0304s/iter; left time: 979.7159s
	iters: 2100, epoch: 1 | loss: 1.6763226
	speed: 0.0304s/iter; left time: 976.5600s
	iters: 2200, epoch: 1 | loss: 1.6499610
	speed: 0.0302s/iter; left time: 969.2722s
	iters: 2300, epoch: 1 | loss: 1.4625553
	speed: 0.0303s/iter; left time: 969.6635s
	iters: 2400, epoch: 1 | loss: 1.3639382
	speed: 0.0304s/iter; left time: 968.2136s
	iters: 2500, epoch: 1 | loss: 1.4910895
	speed: 0.0302s/iter; left time: 959.1869s
	iters: 2600, epoch: 1 | loss: 1.3516163
	speed: 0.0302s/iter; left time: 957.5714s
	iters: 2700, epoch: 1 | loss: 1.5578862
	speed: 0.0303s/iter; left time: 957.0393s
	iters: 2800, epoch: 1 | loss: 1.3371979
	speed: 0.0301s/iter; left time: 947.4649s
	iters: 2900, epoch: 1 | loss: 1.4027911
	speed: 0.0303s/iter; left time: 949.0990s
	iters: 3000, epoch: 1 | loss: 1.3218017
	speed: 0.0303s/iter; left time: 945.8915s
	iters: 3100, epoch: 1 | loss: 1.3463601
	speed: 0.0304s/iter; left time: 945.7790s
	iters: 3200, epoch: 1 | loss: 1.5206378
	speed: 0.0307s/iter; left time: 953.2559s
	iters: 3300, epoch: 1 | loss: 1.3873481
	speed: 0.0302s/iter; left time: 934.6131s
	iters: 3400, epoch: 1 | loss: 1.5454601
	speed: 0.0303s/iter; left time: 935.7306s
Epoch: 1 cost time: 103.99604892730713
Epoch: 1, Steps: 3426 | Train Loss: 1.5410548 Vali Loss: 1.4211813 Test Loss: 1.4809754
Validation loss decreased (inf --> 1.421181).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.1971912
	speed: 0.2299s/iter; left time: 7064.7640s
	iters: 200, epoch: 2 | loss: 1.4528072
	speed: 0.0303s/iter; left time: 929.0390s
	iters: 300, epoch: 2 | loss: 1.4734056
	speed: 0.0302s/iter; left time: 923.4630s
	iters: 400, epoch: 2 | loss: 1.6667078
	speed: 0.0302s/iter; left time: 919.8916s
	iters: 500, epoch: 2 | loss: 1.2448200
	speed: 0.0301s/iter; left time: 913.0713s
	iters: 600, epoch: 2 | loss: 1.4150407
	speed: 0.0303s/iter; left time: 916.8607s
	iters: 700, epoch: 2 | loss: 1.5172951
	speed: 0.0303s/iter; left time: 913.2733s
	iters: 800, epoch: 2 | loss: 1.5870252
	speed: 0.0303s/iter; left time: 910.2112s
	iters: 900, epoch: 2 | loss: 1.4578338
	speed: 0.0303s/iter; left time: 906.7698s
	iters: 1000, epoch: 2 | loss: 1.5917313
	speed: 0.0303s/iter; left time: 904.5737s
	iters: 1100, epoch: 2 | loss: 1.7548248
	speed: 0.0303s/iter; left time: 900.9763s
	iters: 1200, epoch: 2 | loss: 1.4797537
	speed: 0.0301s/iter; left time: 890.7100s
	iters: 1300, epoch: 2 | loss: 1.6187111
	speed: 0.0303s/iter; left time: 895.3495s
	iters: 1400, epoch: 2 | loss: 1.4014690
	speed: 0.0303s/iter; left time: 892.4974s
	iters: 1500, epoch: 2 | loss: 1.5743194
	speed: 0.0303s/iter; left time: 888.9992s
	iters: 1600, epoch: 2 | loss: 1.6712116
	speed: 0.0302s/iter; left time: 883.7965s
	iters: 1700, epoch: 2 | loss: 1.5603416
	speed: 0.0302s/iter; left time: 881.2130s
	iters: 1800, epoch: 2 | loss: 1.6708881
	speed: 0.0304s/iter; left time: 881.3673s
	iters: 1900, epoch: 2 | loss: 1.5991982
	speed: 0.0298s/iter; left time: 862.5856s
	iters: 2000, epoch: 2 | loss: 1.5082427
	speed: 0.0303s/iter; left time: 874.6580s
	iters: 2100, epoch: 2 | loss: 1.5352774
	speed: 0.0303s/iter; left time: 869.4413s
	iters: 2200, epoch: 2 | loss: 1.6635470
	speed: 0.0295s/iter; left time: 845.0560s
	iters: 2300, epoch: 2 | loss: 1.4515283
	speed: 0.0304s/iter; left time: 866.2314s
	iters: 2400, epoch: 2 | loss: 1.2721201
	speed: 0.0303s/iter; left time: 862.1239s
	iters: 2500, epoch: 2 | loss: 1.4473985
	speed: 0.0303s/iter; left time: 859.6934s
	iters: 2600, epoch: 2 | loss: 1.1055050
	speed: 0.0303s/iter; left time: 856.4353s
	iters: 2700, epoch: 2 | loss: 1.5266516
	speed: 0.0301s/iter; left time: 848.1102s
	iters: 2800, epoch: 2 | loss: 1.6457309
	speed: 0.0303s/iter; left time: 850.4226s
	iters: 2900, epoch: 2 | loss: 1.5480846
	speed: 0.0304s/iter; left time: 848.1955s
	iters: 3000, epoch: 2 | loss: 1.4894744
	speed: 0.0302s/iter; left time: 841.9768s
	iters: 3100, epoch: 2 | loss: 1.6828176
	speed: 0.0305s/iter; left time: 844.7059s
	iters: 3200, epoch: 2 | loss: 1.5070926
	speed: 0.0302s/iter; left time: 833.3748s
	iters: 3300, epoch: 2 | loss: 1.5012019
	speed: 0.0302s/iter; left time: 832.4636s
	iters: 3400, epoch: 2 | loss: 1.7275673
	speed: 0.0303s/iter; left time: 831.7136s
Epoch: 2 cost time: 103.7073347568512
Epoch: 2, Steps: 3426 | Train Loss: 1.5287368 Vali Loss: 1.4564308 Test Loss: 1.4857959
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6678352
	speed: 0.2289s/iter; left time: 6252.2979s
	iters: 200, epoch: 3 | loss: 1.5938267
	speed: 0.0303s/iter; left time: 824.8470s
	iters: 300, epoch: 3 | loss: 1.2753472
	speed: 0.0304s/iter; left time: 822.9119s
	iters: 400, epoch: 3 | loss: 1.4017866
	speed: 0.0303s/iter; left time: 818.9683s
	iters: 500, epoch: 3 | loss: 1.4547156
	speed: 0.0303s/iter; left time: 815.6929s
	iters: 600, epoch: 3 | loss: 1.6140488
	speed: 0.0300s/iter; left time: 805.5964s
	iters: 700, epoch: 3 | loss: 1.6178994
	speed: 0.0300s/iter; left time: 801.9733s
	iters: 800, epoch: 3 | loss: 1.3402890
	speed: 0.0303s/iter; left time: 806.3093s
	iters: 900, epoch: 3 | loss: 1.8286871
	speed: 0.0300s/iter; left time: 795.9794s
	iters: 1000, epoch: 3 | loss: 1.7440293
	speed: 0.0303s/iter; left time: 800.8150s
	iters: 1100, epoch: 3 | loss: 1.5700027
	speed: 0.0304s/iter; left time: 798.7740s
	iters: 1200, epoch: 3 | loss: 1.7820528
	speed: 0.0301s/iter; left time: 789.0947s
	iters: 1300, epoch: 3 | loss: 1.4682457
	speed: 0.0300s/iter; left time: 784.1099s
	iters: 1400, epoch: 3 | loss: 1.6403400
	speed: 0.0303s/iter; left time: 788.6014s
	iters: 1500, epoch: 3 | loss: 1.4661891
	speed: 0.0304s/iter; left time: 786.4218s
	iters: 1600, epoch: 3 | loss: 1.5734904
	speed: 0.0301s/iter; left time: 777.0405s
	iters: 1700, epoch: 3 | loss: 1.7125589
	speed: 0.0302s/iter; left time: 777.1330s
	iters: 1800, epoch: 3 | loss: 1.7126975
	speed: 0.0301s/iter; left time: 771.2714s
	iters: 1900, epoch: 3 | loss: 1.9430631
	speed: 0.0300s/iter; left time: 765.1939s
	iters: 2000, epoch: 3 | loss: 1.4696974
	speed: 0.0304s/iter; left time: 771.2494s
	iters: 2100, epoch: 3 | loss: 1.7635463
	speed: 0.0299s/iter; left time: 755.9199s
	iters: 2200, epoch: 3 | loss: 1.3706107
	speed: 0.0302s/iter; left time: 762.3135s
	iters: 2300, epoch: 3 | loss: 1.6111586
	speed: 0.0304s/iter; left time: 762.0898s
	iters: 2400, epoch: 3 | loss: 1.8916174
	speed: 0.0303s/iter; left time: 758.5414s
	iters: 2500, epoch: 3 | loss: 1.6526628
	speed: 0.0301s/iter; left time: 750.9254s
	iters: 2600, epoch: 3 | loss: 1.5840851
	speed: 0.0304s/iter; left time: 753.0437s
	iters: 2700, epoch: 3 | loss: 1.6145816
	speed: 0.0305s/iter; left time: 752.8946s
	iters: 2800, epoch: 3 | loss: 1.6100560
	speed: 0.0302s/iter; left time: 743.9424s
	iters: 2900, epoch: 3 | loss: 1.6711521
	speed: 0.0303s/iter; left time: 741.8597s
	iters: 3000, epoch: 3 | loss: 1.8221754
	speed: 0.0301s/iter; left time: 735.2161s
	iters: 3100, epoch: 3 | loss: 1.5441980
	speed: 0.0307s/iter; left time: 745.1117s
	iters: 3200, epoch: 3 | loss: 1.7704293
	speed: 0.0300s/iter; left time: 727.1247s
	iters: 3300, epoch: 3 | loss: 1.5384479
	speed: 0.0303s/iter; left time: 729.5884s
	iters: 3400, epoch: 3 | loss: 1.5890845
	speed: 0.0304s/iter; left time: 729.2580s
Epoch: 3 cost time: 103.6802031993866
Epoch: 3, Steps: 3426 | Train Loss: 1.5703789 Vali Loss: 1.6195556 Test Loss: 1.5383428
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6129385
	speed: 0.2285s/iter; left time: 5456.3411s
	iters: 200, epoch: 4 | loss: 1.6136798
	speed: 0.0304s/iter; left time: 721.9049s
	iters: 300, epoch: 4 | loss: 1.6278353
	speed: 0.0303s/iter; left time: 717.0110s
	iters: 400, epoch: 4 | loss: 1.6812091
	speed: 0.0304s/iter; left time: 715.8123s
	iters: 500, epoch: 4 | loss: 1.5503855
	speed: 0.0299s/iter; left time: 702.3213s
	iters: 600, epoch: 4 | loss: 1.5512394
	speed: 0.0301s/iter; left time: 703.1201s
	iters: 700, epoch: 4 | loss: 1.6101004
	speed: 0.0304s/iter; left time: 708.5081s
	iters: 800, epoch: 4 | loss: 1.3641876
	speed: 0.0302s/iter; left time: 699.1581s
	iters: 900, epoch: 4 | loss: 1.7105899
	speed: 0.0303s/iter; left time: 698.6879s
	iters: 1000, epoch: 4 | loss: 1.3396952
	speed: 0.0303s/iter; left time: 695.2929s
	iters: 1100, epoch: 4 | loss: 1.2994322
	speed: 0.0299s/iter; left time: 684.7563s
	iters: 1200, epoch: 4 | loss: 1.6916347
	speed: 0.0304s/iter; left time: 692.1645s
	iters: 1300, epoch: 4 | loss: 1.3741239
	speed: 0.0303s/iter; left time: 686.6639s
	iters: 1400, epoch: 4 | loss: 1.8321009
	speed: 0.0301s/iter; left time: 678.7343s
	iters: 1500, epoch: 4 | loss: 1.6201552
	speed: 0.0301s/iter; left time: 677.7057s
	iters: 1600, epoch: 4 | loss: 1.6432098
	speed: 0.0302s/iter; left time: 675.6255s
	iters: 1700, epoch: 4 | loss: 1.8576112
	speed: 0.0305s/iter; left time: 679.0640s
	iters: 1800, epoch: 4 | loss: 1.4056625
	speed: 0.0302s/iter; left time: 669.8922s
	iters: 1900, epoch: 4 | loss: 1.6528471
	speed: 0.0302s/iter; left time: 667.6230s
	iters: 2000, epoch: 4 | loss: 1.6011491
	speed: 0.0299s/iter; left time: 657.9378s
	iters: 2100, epoch: 4 | loss: 1.6066641
	speed: 0.0304s/iter; left time: 665.3585s
	iters: 2200, epoch: 4 | loss: 1.6320256
	speed: 0.0302s/iter; left time: 658.7764s
	iters: 2300, epoch: 4 | loss: 1.6107708
	speed: 0.0302s/iter; left time: 655.7787s
	iters: 2400, epoch: 4 | loss: 1.5867912
	speed: 0.0302s/iter; left time: 651.4592s
	iters: 2500, epoch: 4 | loss: 1.7934693
	speed: 0.0304s/iter; left time: 653.4031s
	iters: 2600, epoch: 4 | loss: 1.4223106
	speed: 0.0304s/iter; left time: 650.1459s
	iters: 2700, epoch: 4 | loss: 1.7437508
	speed: 0.0300s/iter; left time: 638.0808s
	iters: 2800, epoch: 4 | loss: 1.5617678
	speed: 0.0297s/iter; left time: 629.6355s
	iters: 2900, epoch: 4 | loss: 1.7849094
	speed: 0.0302s/iter; left time: 635.8016s
	iters: 3000, epoch: 4 | loss: 1.2751988
	speed: 0.0304s/iter; left time: 637.1420s
	iters: 3100, epoch: 4 | loss: 1.4433657
	speed: 0.0306s/iter; left time: 639.1417s
	iters: 3200, epoch: 4 | loss: 1.8017370
	speed: 0.0302s/iter; left time: 627.5234s
	iters: 3300, epoch: 4 | loss: 1.5449442
	speed: 0.0304s/iter; left time: 627.9511s
	iters: 3400, epoch: 4 | loss: 1.7769113
	speed: 0.0302s/iter; left time: 622.5623s
Epoch: 4 cost time: 103.58003568649292
Epoch: 4, Steps: 3426 | Train Loss: 1.6018542 Vali Loss: 1.6141714 Test Loss: 1.5359278
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 42499
test shape: (4249, 1, 192, 103) (4249, 1, 192, 103)
test shape: (4249, 192, 103) (4249, 192, 103)
mse:1.4809777736663818, mae:0.9575968384742737
>>>>>>>Overall time: 561 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
