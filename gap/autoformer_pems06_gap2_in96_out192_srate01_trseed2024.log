Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690582
val 89940
test 89938
	iters: 100, epoch: 1 | loss: 1.5490133
	speed: 0.1327s/iter; left time: 57248.2508s
	iters: 200, epoch: 1 | loss: 1.4644914
	speed: 0.1300s/iter; left time: 56091.0186s
	iters: 300, epoch: 1 | loss: 1.3378680
	speed: 0.1298s/iter; left time: 55978.4513s
	iters: 400, epoch: 1 | loss: 1.1226435
	speed: 0.1299s/iter; left time: 56003.2906s
	iters: 500, epoch: 1 | loss: 1.1599971
	speed: 0.1299s/iter; left time: 55999.5441s
	iters: 600, epoch: 1 | loss: 1.1981421
	speed: 0.1304s/iter; left time: 56193.6036s
	iters: 700, epoch: 1 | loss: 1.0581203
	speed: 0.1299s/iter; left time: 55965.3188s
	iters: 800, epoch: 1 | loss: 0.9648789
	speed: 0.1297s/iter; left time: 55893.4312s
	iters: 900, epoch: 1 | loss: 0.9537028
	speed: 0.1299s/iter; left time: 55960.0949s
	iters: 1000, epoch: 1 | loss: 0.8722007
	speed: 0.1300s/iter; left time: 55987.2948s
	iters: 1100, epoch: 1 | loss: 0.8513336
	speed: 0.1299s/iter; left time: 55913.3443s
	iters: 1200, epoch: 1 | loss: 1.0669793
	speed: 0.1298s/iter; left time: 55854.8453s
	iters: 1300, epoch: 1 | loss: 1.0712590
	speed: 0.1298s/iter; left time: 55864.0287s
	iters: 1400, epoch: 1 | loss: 1.0634342
	speed: 0.1298s/iter; left time: 55820.3199s
	iters: 1500, epoch: 1 | loss: 0.9492274
	speed: 0.1297s/iter; left time: 55799.9931s
	iters: 1600, epoch: 1 | loss: 0.7520303
	speed: 0.1298s/iter; left time: 55813.7095s
	iters: 1700, epoch: 1 | loss: 0.9015728
	speed: 0.1299s/iter; left time: 55857.5383s
	iters: 1800, epoch: 1 | loss: 0.7372391
	speed: 0.1301s/iter; left time: 55928.0777s
	iters: 1900, epoch: 1 | loss: 0.8209914
	speed: 0.1301s/iter; left time: 55915.6327s
	iters: 2000, epoch: 1 | loss: 0.8332208
	speed: 0.1300s/iter; left time: 55859.6876s
	iters: 2100, epoch: 1 | loss: 0.8367059
	speed: 0.1294s/iter; left time: 55580.9666s
Epoch: 1 cost time: 280.76074624061584
Epoch: 1, Steps: 2158 | Train Loss: 1.0298065 Vali Loss: 1.0980679 Test Loss: 0.8818826
Validation loss decreased (inf --> 1.098068).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9584978
	speed: 1.3765s/iter; left time: 590994.9607s
	iters: 200, epoch: 2 | loss: 0.7104367
	speed: 0.1299s/iter; left time: 55775.3430s
	iters: 300, epoch: 2 | loss: 0.8835238
	speed: 0.1295s/iter; left time: 55591.1290s
	iters: 400, epoch: 2 | loss: 0.8834783
	speed: 0.1304s/iter; left time: 55928.4477s
	iters: 500, epoch: 2 | loss: 0.7226539
	speed: 0.1297s/iter; left time: 55638.8018s
	iters: 600, epoch: 2 | loss: 0.7753668
	speed: 0.1296s/iter; left time: 55596.8086s
	iters: 700, epoch: 2 | loss: 0.8301473
	speed: 0.1300s/iter; left time: 55731.7080s
	iters: 800, epoch: 2 | loss: 0.8269306
	speed: 0.1298s/iter; left time: 55639.5109s
	iters: 900, epoch: 2 | loss: 0.7835607
	speed: 0.1301s/iter; left time: 55736.5674s
	iters: 1000, epoch: 2 | loss: 0.8063804
	speed: 0.1296s/iter; left time: 55524.3406s
	iters: 1100, epoch: 2 | loss: 0.7077806
	speed: 0.1306s/iter; left time: 55946.2484s
	iters: 1200, epoch: 2 | loss: 0.8108203
	speed: 0.1301s/iter; left time: 55717.5386s
	iters: 1300, epoch: 2 | loss: 0.6552086
	speed: 0.1301s/iter; left time: 55719.3331s
	iters: 1400, epoch: 2 | loss: 0.7700356
	speed: 0.1304s/iter; left time: 55807.7447s
	iters: 1500, epoch: 2 | loss: 0.7659851
	speed: 0.1298s/iter; left time: 55551.6938s
	iters: 1600, epoch: 2 | loss: 0.7654580
	speed: 0.1298s/iter; left time: 55535.4628s
	iters: 1700, epoch: 2 | loss: 0.7043677
	speed: 0.1301s/iter; left time: 55632.8830s
	iters: 1800, epoch: 2 | loss: 0.7205703
	speed: 0.1303s/iter; left time: 55725.2066s
	iters: 1900, epoch: 2 | loss: 0.6593238
	speed: 0.1300s/iter; left time: 55568.9287s
	iters: 2000, epoch: 2 | loss: 0.6782408
	speed: 0.1296s/iter; left time: 55395.1098s
	iters: 2100, epoch: 2 | loss: 0.8268265
	speed: 0.1298s/iter; left time: 55450.0881s
Epoch: 2 cost time: 280.5449240207672
Epoch: 2, Steps: 2158 | Train Loss: 0.7950242 Vali Loss: 1.0153962 Test Loss: 0.8883639
Validation loss decreased (1.098068 --> 1.015396).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9058707
	speed: 1.3764s/iter; left time: 587985.7524s
	iters: 200, epoch: 3 | loss: 0.7954656
	speed: 0.1296s/iter; left time: 55355.8430s
	iters: 300, epoch: 3 | loss: 0.7822115
	speed: 0.1299s/iter; left time: 55452.1937s
	iters: 400, epoch: 3 | loss: 0.7537398
	speed: 0.1297s/iter; left time: 55371.8567s
	iters: 500, epoch: 3 | loss: 0.6920817
	speed: 0.1298s/iter; left time: 55414.1285s
	iters: 600, epoch: 3 | loss: 0.7111216
	speed: 0.1302s/iter; left time: 55573.0574s
	iters: 700, epoch: 3 | loss: 0.6763338
	speed: 0.1299s/iter; left time: 55406.9393s
	iters: 800, epoch: 3 | loss: 0.6913851
	speed: 0.1297s/iter; left time: 55318.6299s
	iters: 900, epoch: 3 | loss: 0.6487731
	speed: 0.1295s/iter; left time: 55229.1604s
	iters: 1000, epoch: 3 | loss: 0.7382044
	speed: 0.1302s/iter; left time: 55494.2555s
	iters: 1100, epoch: 3 | loss: 0.6260957
	speed: 0.1299s/iter; left time: 55361.6490s
	iters: 1200, epoch: 3 | loss: 0.7555306
	speed: 0.1297s/iter; left time: 55248.0070s
	iters: 1300, epoch: 3 | loss: 0.6678520
	speed: 0.1298s/iter; left time: 55278.9745s
	iters: 1400, epoch: 3 | loss: 0.8754138
	speed: 0.1299s/iter; left time: 55325.8347s
	iters: 1500, epoch: 3 | loss: 0.7521987
	speed: 0.1296s/iter; left time: 55178.7445s
	iters: 1600, epoch: 3 | loss: 0.7193494
	speed: 0.1299s/iter; left time: 55295.7295s
	iters: 1700, epoch: 3 | loss: 0.6527599
	speed: 0.1300s/iter; left time: 55336.8421s
	iters: 1800, epoch: 3 | loss: 0.6879187
	speed: 0.1300s/iter; left time: 55315.7443s
	iters: 1900, epoch: 3 | loss: 0.6298717
	speed: 0.1301s/iter; left time: 55345.9363s
	iters: 2000, epoch: 3 | loss: 0.7194460
	speed: 0.1302s/iter; left time: 55378.9329s
	iters: 2100, epoch: 3 | loss: 0.6742931
	speed: 0.1301s/iter; left time: 55324.9418s
Epoch: 3 cost time: 280.50710892677307
Epoch: 3, Steps: 2158 | Train Loss: 0.7026603 Vali Loss: 0.9587381 Test Loss: 0.8527159
Validation loss decreased (1.015396 --> 0.958738).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5737031
	speed: 1.3773s/iter; left time: 585371.7713s
	iters: 200, epoch: 4 | loss: 0.6010654
	speed: 0.1298s/iter; left time: 55172.9450s
	iters: 300, epoch: 4 | loss: 0.6435162
	speed: 0.1304s/iter; left time: 55388.9609s
	iters: 400, epoch: 4 | loss: 0.7380698
	speed: 0.1297s/iter; left time: 55088.0084s
	iters: 500, epoch: 4 | loss: 0.6872153
	speed: 0.1295s/iter; left time: 54988.0608s
	iters: 600, epoch: 4 | loss: 0.7278755
	speed: 0.1300s/iter; left time: 55171.4380s
	iters: 700, epoch: 4 | loss: 0.6613256
	speed: 0.1300s/iter; left time: 55161.2066s
	iters: 800, epoch: 4 | loss: 0.6654398
	speed: 0.1299s/iter; left time: 55107.3272s
	iters: 900, epoch: 4 | loss: 0.6353537
	speed: 0.1299s/iter; left time: 55126.3289s
	iters: 1000, epoch: 4 | loss: 0.6462342
	speed: 0.1298s/iter; left time: 55067.9943s
	iters: 1100, epoch: 4 | loss: 0.7664039
	speed: 0.1299s/iter; left time: 55101.3245s
	iters: 1200, epoch: 4 | loss: 0.6006885
	speed: 0.1301s/iter; left time: 55155.9328s
	iters: 1300, epoch: 4 | loss: 0.5885056
	speed: 0.1298s/iter; left time: 55009.9093s
	iters: 1400, epoch: 4 | loss: 0.6321203
	speed: 0.1300s/iter; left time: 55096.3248s
	iters: 1500, epoch: 4 | loss: 0.7018645
	speed: 0.1301s/iter; left time: 55117.4127s
	iters: 1600, epoch: 4 | loss: 0.6698017
	speed: 0.1299s/iter; left time: 55031.5987s
	iters: 1700, epoch: 4 | loss: 0.6729894
	speed: 0.1302s/iter; left time: 55140.9751s
	iters: 1800, epoch: 4 | loss: 0.5913444
	speed: 0.1303s/iter; left time: 55162.9820s
	iters: 1900, epoch: 4 | loss: 0.8063634
	speed: 0.1301s/iter; left time: 55045.6212s
	iters: 2000, epoch: 4 | loss: 0.5479403
	speed: 0.1297s/iter; left time: 54873.0278s
	iters: 2100, epoch: 4 | loss: 0.6696807
	speed: 0.1294s/iter; left time: 54733.0233s
Epoch: 4 cost time: 280.55117774009705
Epoch: 4, Steps: 2158 | Train Loss: 0.6503478 Vali Loss: 1.1054363 Test Loss: 0.9735124
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.6721281
	speed: 1.3784s/iter; left time: 582895.0623s
	iters: 200, epoch: 5 | loss: 0.7283930
	speed: 0.1316s/iter; left time: 55641.7611s
	iters: 300, epoch: 5 | loss: 0.5725942
	speed: 0.1313s/iter; left time: 55507.7508s
	iters: 400, epoch: 5 | loss: 0.5481887
	speed: 0.1316s/iter; left time: 55627.0599s
	iters: 500, epoch: 5 | loss: 0.6413763
	speed: 0.1313s/iter; left time: 55453.2917s
	iters: 600, epoch: 5 | loss: 0.6095586
	speed: 0.1315s/iter; left time: 55532.5112s
	iters: 700, epoch: 5 | loss: 0.5227940
	speed: 0.1314s/iter; left time: 55495.1979s
	iters: 800, epoch: 5 | loss: 0.6546526
	speed: 0.1313s/iter; left time: 55420.0757s
	iters: 900, epoch: 5 | loss: 0.6485350
	speed: 0.1319s/iter; left time: 55669.0679s
	iters: 1000, epoch: 5 | loss: 0.6468219
	speed: 0.1316s/iter; left time: 55525.9748s
	iters: 1100, epoch: 5 | loss: 0.6312280
	speed: 0.1313s/iter; left time: 55374.5699s
	iters: 1200, epoch: 5 | loss: 0.6284041
	speed: 0.1314s/iter; left time: 55410.0142s
	iters: 1300, epoch: 5 | loss: 0.5765179
	speed: 0.1314s/iter; left time: 55405.7729s
	iters: 1400, epoch: 5 | loss: 0.6494458
	speed: 0.1313s/iter; left time: 55356.6035s
	iters: 1500, epoch: 5 | loss: 0.5540584
	speed: 0.1315s/iter; left time: 55431.6680s
	iters: 1600, epoch: 5 | loss: 0.5072669
	speed: 0.1313s/iter; left time: 55330.8255s
	iters: 1700, epoch: 5 | loss: 0.6018692
	speed: 0.1311s/iter; left time: 55226.5063s
	iters: 1800, epoch: 5 | loss: 0.6995088
	speed: 0.1312s/iter; left time: 55275.9992s
	iters: 1900, epoch: 5 | loss: 0.6305252
	speed: 0.1315s/iter; left time: 55391.1078s
	iters: 2000, epoch: 5 | loss: 0.5603148
	speed: 0.1315s/iter; left time: 55348.7121s
	iters: 2100, epoch: 5 | loss: 0.6614839
	speed: 0.1312s/iter; left time: 55229.0802s
Epoch: 5 cost time: 283.7556211948395
Epoch: 5, Steps: 2158 | Train Loss: 0.6175328 Vali Loss: 0.9643235 Test Loss: 0.9091618
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.5427191
	speed: 1.3673s/iter; left time: 575219.2067s
	iters: 200, epoch: 6 | loss: 0.5717702
	speed: 0.1266s/iter; left time: 53239.3659s
	iters: 300, epoch: 6 | loss: 0.6633038
	speed: 0.1260s/iter; left time: 52992.8123s
	iters: 400, epoch: 6 | loss: 0.5599598
	speed: 0.1269s/iter; left time: 53329.9851s
	iters: 500, epoch: 6 | loss: 0.5992559
	speed: 0.1264s/iter; left time: 53138.1195s
	iters: 600, epoch: 6 | loss: 0.6809021
	speed: 0.1296s/iter; left time: 54448.0117s
	iters: 700, epoch: 6 | loss: 0.6238338
	speed: 0.1304s/iter; left time: 54767.4008s
	iters: 800, epoch: 6 | loss: 0.6423605
	speed: 0.1303s/iter; left time: 54746.3203s
	iters: 900, epoch: 6 | loss: 0.5678869
	speed: 0.1308s/iter; left time: 54940.5941s
	iters: 1000, epoch: 6 | loss: 0.6202424
	speed: 0.1305s/iter; left time: 54778.9275s
	iters: 1100, epoch: 6 | loss: 0.6159533
	speed: 0.1298s/iter; left time: 54491.0072s
	iters: 1200, epoch: 6 | loss: 0.5330338
	speed: 0.1304s/iter; left time: 54728.5531s
	iters: 1300, epoch: 6 | loss: 0.6259496
	speed: 0.1305s/iter; left time: 54747.0285s
	iters: 1400, epoch: 6 | loss: 0.6448500
	speed: 0.1304s/iter; left time: 54687.1434s
	iters: 1500, epoch: 6 | loss: 0.5885989
	speed: 0.1296s/iter; left time: 54332.4297s
	iters: 1600, epoch: 6 | loss: 0.5496597
	speed: 0.1266s/iter; left time: 53068.6748s
	iters: 1700, epoch: 6 | loss: 0.5784343
	speed: 0.1265s/iter; left time: 53019.1247s
	iters: 1800, epoch: 6 | loss: 0.5440989
	speed: 0.1311s/iter; left time: 54923.5035s
	iters: 1900, epoch: 6 | loss: 0.5794289
	speed: 0.1315s/iter; left time: 55066.4751s
	iters: 2000, epoch: 6 | loss: 0.5471242
	speed: 0.1310s/iter; left time: 54873.1434s
	iters: 2100, epoch: 6 | loss: 0.5813387
	speed: 0.1313s/iter; left time: 54959.0542s
Epoch: 6 cost time: 279.02087688446045
Epoch: 6, Steps: 2158 | Train Loss: 0.5917380 Vali Loss: 1.1431882 Test Loss: 0.9636191
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.6452172
	speed: 1.3710s/iter; left time: 573843.8385s
	iters: 200, epoch: 7 | loss: 0.5604691
	speed: 0.1313s/iter; left time: 54960.3845s
	iters: 300, epoch: 7 | loss: 0.6238858
	speed: 0.1314s/iter; left time: 54977.0536s
	iters: 400, epoch: 7 | loss: 0.5777953
	speed: 0.1314s/iter; left time: 54969.6202s
	iters: 500, epoch: 7 | loss: 0.6378802
	speed: 0.1313s/iter; left time: 54923.2281s
	iters: 600, epoch: 7 | loss: 0.5065109
	speed: 0.1314s/iter; left time: 54947.3307s
	iters: 700, epoch: 7 | loss: 0.5111921
	speed: 0.1316s/iter; left time: 55008.1257s
	iters: 800, epoch: 7 | loss: 0.5457022
	speed: 0.1315s/iter; left time: 54960.7117s
	iters: 900, epoch: 7 | loss: 0.5085916
	speed: 0.1316s/iter; left time: 54959.0265s
	iters: 1000, epoch: 7 | loss: 0.5565076
	speed: 0.1314s/iter; left time: 54868.4959s
	iters: 1100, epoch: 7 | loss: 0.6344087
	speed: 0.1312s/iter; left time: 54770.9401s
	iters: 1200, epoch: 7 | loss: 0.5359684
	speed: 0.1310s/iter; left time: 54688.7114s
	iters: 1300, epoch: 7 | loss: 0.5951289
	speed: 0.1312s/iter; left time: 54741.2998s
	iters: 1400, epoch: 7 | loss: 0.6498937
	speed: 0.1312s/iter; left time: 54732.1827s
	iters: 1500, epoch: 7 | loss: 0.5437062
	speed: 0.1314s/iter; left time: 54819.1480s
	iters: 1600, epoch: 7 | loss: 0.5656306
	speed: 0.1315s/iter; left time: 54840.1829s
	iters: 1700, epoch: 7 | loss: 0.6053284
	speed: 0.1316s/iter; left time: 54850.9872s
	iters: 1800, epoch: 7 | loss: 0.5966578
	speed: 0.1309s/iter; left time: 54559.2385s
	iters: 1900, epoch: 7 | loss: 0.5313731
	speed: 0.1311s/iter; left time: 54624.6240s
	iters: 2000, epoch: 7 | loss: 0.5643971
	speed: 0.1312s/iter; left time: 54677.6619s
	iters: 2100, epoch: 7 | loss: 0.6041004
	speed: 0.1312s/iter; left time: 54656.0038s
Epoch: 7 cost time: 283.5129699707031
Epoch: 7, Steps: 2158 | Train Loss: 0.5709946 Vali Loss: 1.1810954 Test Loss: 0.9785724
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.5559234
	speed: 1.3685s/iter; left time: 569837.0584s
	iters: 200, epoch: 8 | loss: 0.6402678
	speed: 0.1314s/iter; left time: 54692.8451s
	iters: 300, epoch: 8 | loss: 0.6226388
	speed: 0.1313s/iter; left time: 54629.1451s
	iters: 400, epoch: 8 | loss: 0.5187684
	speed: 0.1313s/iter; left time: 54628.6530s
	iters: 500, epoch: 8 | loss: 0.5822282
	speed: 0.1313s/iter; left time: 54626.3626s
	iters: 600, epoch: 8 | loss: 0.5568017
	speed: 0.1315s/iter; left time: 54706.3684s
	iters: 700, epoch: 8 | loss: 0.5223684
	speed: 0.1313s/iter; left time: 54601.4141s
	iters: 800, epoch: 8 | loss: 0.5668263
	speed: 0.1316s/iter; left time: 54721.2317s
	iters: 900, epoch: 8 | loss: 0.5182400
	speed: 0.1313s/iter; left time: 54577.5137s
	iters: 1000, epoch: 8 | loss: 0.5791656
	speed: 0.1315s/iter; left time: 54637.0798s
	iters: 1100, epoch: 8 | loss: 0.6028176
	speed: 0.1314s/iter; left time: 54580.7305s
	iters: 1200, epoch: 8 | loss: 0.4874831
	speed: 0.1319s/iter; left time: 54794.9243s
	iters: 1300, epoch: 8 | loss: 0.5972687
	speed: 0.1313s/iter; left time: 54520.2158s
	iters: 1400, epoch: 8 | loss: 0.5752613
	speed: 0.1312s/iter; left time: 54442.5130s
	iters: 1500, epoch: 8 | loss: 0.4610572
	speed: 0.1315s/iter; left time: 54574.6687s
	iters: 1600, epoch: 8 | loss: 0.5789613
	speed: 0.1314s/iter; left time: 54517.5091s
	iters: 1700, epoch: 8 | loss: 0.4234633
	speed: 0.1318s/iter; left time: 54655.4210s
	iters: 1800, epoch: 8 | loss: 0.6177061
	speed: 0.1312s/iter; left time: 54404.9848s
	iters: 1900, epoch: 8 | loss: 0.5244758
	speed: 0.1314s/iter; left time: 54460.7501s
	iters: 2000, epoch: 8 | loss: 0.5838866
	speed: 0.1313s/iter; left time: 54439.9663s
	iters: 2100, epoch: 8 | loss: 0.5635761
	speed: 0.1309s/iter; left time: 54263.6135s
Epoch: 8 cost time: 283.69373393058777
Epoch: 8, Steps: 2158 | Train Loss: 0.5523136 Vali Loss: 1.1253277 Test Loss: 0.9866710
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 89938
test shape: (8993, 1, 192, 130) (8993, 1, 192, 130)
test shape: (8993, 192, 130) (8993, 192, 130)
mse:0.8527145981788635, mae:0.6911007761955261
>>>>>>>Overall time: 3362 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
