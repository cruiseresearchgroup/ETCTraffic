Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690678
val 90036
test 90034
	iters: 100, epoch: 1 | loss: 1.4692053
	speed: 0.1045s/iter; left time: 45093.7003s
	iters: 200, epoch: 1 | loss: 1.4969152
	speed: 0.1017s/iter; left time: 43893.1580s
	iters: 300, epoch: 1 | loss: 1.0687221
	speed: 0.1021s/iter; left time: 44033.7325s
	iters: 400, epoch: 1 | loss: 1.2580928
	speed: 0.1021s/iter; left time: 44005.8434s
	iters: 500, epoch: 1 | loss: 1.1196909
	speed: 0.1027s/iter; left time: 44282.2346s
	iters: 600, epoch: 1 | loss: 0.9972530
	speed: 0.1018s/iter; left time: 43892.1482s
	iters: 700, epoch: 1 | loss: 0.8836564
	speed: 0.1022s/iter; left time: 44024.2142s
	iters: 800, epoch: 1 | loss: 0.9273912
	speed: 0.1016s/iter; left time: 43786.5388s
	iters: 900, epoch: 1 | loss: 1.0127749
	speed: 0.1020s/iter; left time: 43915.2972s
	iters: 1000, epoch: 1 | loss: 1.0010842
	speed: 0.1017s/iter; left time: 43793.4310s
	iters: 1100, epoch: 1 | loss: 1.2545397
	speed: 0.1017s/iter; left time: 43792.4284s
	iters: 1200, epoch: 1 | loss: 1.1483392
	speed: 0.1024s/iter; left time: 44057.9728s
	iters: 1300, epoch: 1 | loss: 1.0085884
	speed: 0.1013s/iter; left time: 43584.5561s
	iters: 1400, epoch: 1 | loss: 0.9779227
	speed: 0.1020s/iter; left time: 43898.6034s
	iters: 1500, epoch: 1 | loss: 1.1813439
	speed: 0.1023s/iter; left time: 43978.9948s
	iters: 1600, epoch: 1 | loss: 0.8672298
	speed: 0.1020s/iter; left time: 43853.4466s
	iters: 1700, epoch: 1 | loss: 1.0534666
	speed: 0.1017s/iter; left time: 43701.7468s
	iters: 1800, epoch: 1 | loss: 0.9448263
	speed: 0.1018s/iter; left time: 43741.7969s
	iters: 1900, epoch: 1 | loss: 1.2026415
	speed: 0.1023s/iter; left time: 43973.3668s
	iters: 2000, epoch: 1 | loss: 1.0534000
	speed: 0.1015s/iter; left time: 43613.3483s
	iters: 2100, epoch: 1 | loss: 1.0084913
	speed: 0.1018s/iter; left time: 43724.5906s
Epoch: 1 cost time: 220.34362816810608
Epoch: 1, Steps: 2158 | Train Loss: 1.1229936 Vali Loss: 0.9140481 Test Loss: 1.0484430
Validation loss decreased (inf --> 0.914048).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8524236
	speed: 1.2548s/iter; left time: 538733.8672s
	iters: 200, epoch: 2 | loss: 0.7257899
	speed: 0.1009s/iter; left time: 43315.3086s
	iters: 300, epoch: 2 | loss: 0.9366680
	speed: 0.1008s/iter; left time: 43276.5404s
	iters: 400, epoch: 2 | loss: 0.8734109
	speed: 0.1009s/iter; left time: 43298.3250s
	iters: 500, epoch: 2 | loss: 0.9510725
	speed: 0.1011s/iter; left time: 43357.1598s
	iters: 600, epoch: 2 | loss: 1.1113521
	speed: 0.1006s/iter; left time: 43134.3472s
	iters: 700, epoch: 2 | loss: 1.1271025
	speed: 0.1004s/iter; left time: 43050.3387s
	iters: 800, epoch: 2 | loss: 0.9855508
	speed: 0.1005s/iter; left time: 43089.4991s
	iters: 900, epoch: 2 | loss: 0.9802705
	speed: 0.1009s/iter; left time: 43251.6258s
	iters: 1000, epoch: 2 | loss: 0.8886126
	speed: 0.1005s/iter; left time: 43073.5923s
	iters: 1100, epoch: 2 | loss: 0.8394923
	speed: 0.1004s/iter; left time: 43010.4553s
	iters: 1200, epoch: 2 | loss: 0.9188524
	speed: 0.1005s/iter; left time: 43044.5310s
	iters: 1300, epoch: 2 | loss: 0.9505406
	speed: 0.1000s/iter; left time: 42810.1363s
	iters: 1400, epoch: 2 | loss: 0.8623492
	speed: 0.1004s/iter; left time: 42973.3474s
	iters: 1500, epoch: 2 | loss: 0.8953091
	speed: 0.1004s/iter; left time: 42971.6988s
	iters: 1600, epoch: 2 | loss: 0.9190629
	speed: 0.1009s/iter; left time: 43148.3615s
	iters: 1700, epoch: 2 | loss: 0.9105517
	speed: 0.1000s/iter; left time: 42787.2925s
	iters: 1800, epoch: 2 | loss: 0.8201799
	speed: 0.1005s/iter; left time: 42988.3171s
	iters: 1900, epoch: 2 | loss: 0.7215216
	speed: 0.1006s/iter; left time: 42991.6691s
	iters: 2000, epoch: 2 | loss: 0.9203417
	speed: 0.1005s/iter; left time: 42953.3446s
	iters: 2100, epoch: 2 | loss: 0.6582653
	speed: 0.1004s/iter; left time: 42908.6166s
Epoch: 2 cost time: 217.23472046852112
Epoch: 2, Steps: 2158 | Train Loss: 0.8789894 Vali Loss: 0.8999222 Test Loss: 1.1154023
Validation loss decreased (0.914048 --> 0.899922).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6934983
	speed: 1.2523s/iter; left time: 534964.2828s
	iters: 200, epoch: 3 | loss: 0.7137159
	speed: 0.1024s/iter; left time: 43747.5498s
	iters: 300, epoch: 3 | loss: 0.6987998
	speed: 0.1020s/iter; left time: 43533.9811s
	iters: 400, epoch: 3 | loss: 0.8713658
	speed: 0.1015s/iter; left time: 43311.7527s
	iters: 500, epoch: 3 | loss: 0.6793230
	speed: 0.1024s/iter; left time: 43701.0217s
	iters: 600, epoch: 3 | loss: 0.7373987
	speed: 0.1017s/iter; left time: 43391.7794s
	iters: 700, epoch: 3 | loss: 0.8670275
	speed: 0.1019s/iter; left time: 43473.6434s
	iters: 800, epoch: 3 | loss: 0.7660281
	speed: 0.1015s/iter; left time: 43289.3515s
	iters: 900, epoch: 3 | loss: 0.7233838
	speed: 0.1014s/iter; left time: 43230.7957s
	iters: 1000, epoch: 3 | loss: 0.8991529
	speed: 0.1020s/iter; left time: 43470.2573s
	iters: 1100, epoch: 3 | loss: 0.9110562
	speed: 0.1022s/iter; left time: 43541.0850s
	iters: 1200, epoch: 3 | loss: 0.6456339
	speed: 0.1017s/iter; left time: 43346.9186s
	iters: 1300, epoch: 3 | loss: 0.7425293
	speed: 0.1020s/iter; left time: 43432.4337s
	iters: 1400, epoch: 3 | loss: 0.8642632
	speed: 0.1028s/iter; left time: 43765.8273s
	iters: 1500, epoch: 3 | loss: 0.9222580
	speed: 0.1021s/iter; left time: 43456.1210s
	iters: 1600, epoch: 3 | loss: 0.7650684
	speed: 0.1016s/iter; left time: 43267.1442s
	iters: 1700, epoch: 3 | loss: 0.6841351
	speed: 0.1020s/iter; left time: 43413.4174s
	iters: 1800, epoch: 3 | loss: 0.6874296
	speed: 0.1015s/iter; left time: 43178.9594s
	iters: 1900, epoch: 3 | loss: 0.7894128
	speed: 0.1021s/iter; left time: 43421.1920s
	iters: 2000, epoch: 3 | loss: 0.8680964
	speed: 0.1016s/iter; left time: 43219.8118s
	iters: 2100, epoch: 3 | loss: 0.6659737
	speed: 0.1015s/iter; left time: 43175.7697s
Epoch: 3 cost time: 220.01928806304932
Epoch: 3, Steps: 2158 | Train Loss: 0.7868298 Vali Loss: 0.8742046 Test Loss: 1.0134386
Validation loss decreased (0.899922 --> 0.874205).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7129999
	speed: 1.2559s/iter; left time: 533805.8795s
	iters: 200, epoch: 4 | loss: 0.7785767
	speed: 0.1020s/iter; left time: 43331.6998s
	iters: 300, epoch: 4 | loss: 0.8140142
	speed: 0.1017s/iter; left time: 43184.1779s
	iters: 400, epoch: 4 | loss: 0.7041708
	speed: 0.1016s/iter; left time: 43147.9913s
	iters: 500, epoch: 4 | loss: 0.7163061
	speed: 0.1018s/iter; left time: 43247.4488s
	iters: 600, epoch: 4 | loss: 0.7103154
	speed: 0.1026s/iter; left time: 43573.8771s
	iters: 700, epoch: 4 | loss: 0.6335256
	speed: 0.1019s/iter; left time: 43246.9127s
	iters: 800, epoch: 4 | loss: 0.9145261
	speed: 0.1020s/iter; left time: 43298.2714s
	iters: 900, epoch: 4 | loss: 0.7717371
	speed: 0.1027s/iter; left time: 43576.7980s
	iters: 1000, epoch: 4 | loss: 0.7052307
	speed: 0.1021s/iter; left time: 43303.0766s
	iters: 1100, epoch: 4 | loss: 0.6858098
	speed: 0.1018s/iter; left time: 43171.3777s
	iters: 1200, epoch: 4 | loss: 0.6584635
	speed: 0.1022s/iter; left time: 43315.1828s
	iters: 1300, epoch: 4 | loss: 0.5861456
	speed: 0.1021s/iter; left time: 43262.7280s
	iters: 1400, epoch: 4 | loss: 0.7296119
	speed: 0.1014s/iter; left time: 42972.2707s
	iters: 1500, epoch: 4 | loss: 0.7844477
	speed: 0.1015s/iter; left time: 42981.9121s
	iters: 1600, epoch: 4 | loss: 0.7288663
	speed: 0.1018s/iter; left time: 43118.2387s
	iters: 1700, epoch: 4 | loss: 0.6650377
	speed: 0.1022s/iter; left time: 43270.5033s
	iters: 1800, epoch: 4 | loss: 0.6454235
	speed: 0.1024s/iter; left time: 43357.2981s
	iters: 1900, epoch: 4 | loss: 0.7343718
	speed: 0.1021s/iter; left time: 43199.2996s
	iters: 2000, epoch: 4 | loss: 0.6456497
	speed: 0.1018s/iter; left time: 43061.0741s
	iters: 2100, epoch: 4 | loss: 0.7099779
	speed: 0.1018s/iter; left time: 43061.4449s
Epoch: 4 cost time: 220.1989870071411
Epoch: 4, Steps: 2158 | Train Loss: 0.7335020 Vali Loss: 0.8993661 Test Loss: 1.0429095
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.7891519
	speed: 1.2537s/iter; left time: 530169.3834s
	iters: 200, epoch: 5 | loss: 0.6353959
	speed: 0.1019s/iter; left time: 43065.8544s
	iters: 300, epoch: 5 | loss: 0.8142098
	speed: 0.1021s/iter; left time: 43159.0852s
	iters: 400, epoch: 5 | loss: 0.9032966
	speed: 0.1016s/iter; left time: 42952.0512s
	iters: 500, epoch: 5 | loss: 0.7011290
	speed: 0.1023s/iter; left time: 43231.8976s
	iters: 600, epoch: 5 | loss: 0.8993927
	speed: 0.1018s/iter; left time: 42984.0251s
	iters: 700, epoch: 5 | loss: 0.6636680
	speed: 0.1015s/iter; left time: 42845.5880s
	iters: 800, epoch: 5 | loss: 0.7556087
	speed: 0.1020s/iter; left time: 43065.6025s
	iters: 900, epoch: 5 | loss: 0.7955384
	speed: 0.1025s/iter; left time: 43253.0300s
	iters: 1000, epoch: 5 | loss: 0.7163412
	speed: 0.1016s/iter; left time: 42878.8084s
	iters: 1100, epoch: 5 | loss: 0.5804449
	speed: 0.1017s/iter; left time: 42888.9260s
	iters: 1200, epoch: 5 | loss: 0.7215343
	speed: 0.1020s/iter; left time: 43018.6825s
	iters: 1300, epoch: 5 | loss: 0.8143820
	speed: 0.1016s/iter; left time: 42857.5074s
	iters: 1400, epoch: 5 | loss: 0.7072355
	speed: 0.1018s/iter; left time: 42897.7402s
	iters: 1500, epoch: 5 | loss: 0.7575808
	speed: 0.1021s/iter; left time: 43050.1951s
	iters: 1600, epoch: 5 | loss: 0.6970715
	speed: 0.1018s/iter; left time: 42908.2066s
	iters: 1700, epoch: 5 | loss: 0.6399620
	speed: 0.1022s/iter; left time: 43035.4242s
	iters: 1800, epoch: 5 | loss: 0.7129449
	speed: 0.1020s/iter; left time: 42949.5171s
	iters: 1900, epoch: 5 | loss: 0.7425837
	speed: 0.1015s/iter; left time: 42740.8279s
	iters: 2000, epoch: 5 | loss: 0.6673944
	speed: 0.1020s/iter; left time: 42919.6732s
	iters: 2100, epoch: 5 | loss: 0.8362921
	speed: 0.1019s/iter; left time: 42881.7409s
Epoch: 5 cost time: 219.97625541687012
Epoch: 5, Steps: 2158 | Train Loss: 0.7248729 Vali Loss: 0.9645415 Test Loss: 1.0201973
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.6262502
	speed: 1.2536s/iter; left time: 527383.5901s
	iters: 200, epoch: 6 | loss: 0.7493533
	speed: 0.1015s/iter; left time: 42688.2784s
	iters: 300, epoch: 6 | loss: 0.8098688
	speed: 0.1017s/iter; left time: 42753.1972s
	iters: 400, epoch: 6 | loss: 0.5886290
	speed: 0.1014s/iter; left time: 42624.4567s
	iters: 500, epoch: 6 | loss: 0.6616758
	speed: 0.1019s/iter; left time: 42823.6074s
	iters: 600, epoch: 6 | loss: 0.6184206
	speed: 0.1017s/iter; left time: 42738.6560s
	iters: 700, epoch: 6 | loss: 0.7946997
	speed: 0.1014s/iter; left time: 42613.4108s
	iters: 800, epoch: 6 | loss: 0.6342046
	speed: 0.1015s/iter; left time: 42627.0293s
	iters: 900, epoch: 6 | loss: 0.6938205
	speed: 0.1014s/iter; left time: 42587.9441s
	iters: 1000, epoch: 6 | loss: 0.5875825
	speed: 0.1016s/iter; left time: 42642.6888s
	iters: 1100, epoch: 6 | loss: 0.6688964
	speed: 0.1020s/iter; left time: 42815.7527s
	iters: 1200, epoch: 6 | loss: 0.6609401
	speed: 0.1018s/iter; left time: 42706.6289s
	iters: 1300, epoch: 6 | loss: 0.6848570
	speed: 0.1015s/iter; left time: 42571.6702s
	iters: 1400, epoch: 6 | loss: 0.7255853
	speed: 0.1017s/iter; left time: 42671.0022s
	iters: 1500, epoch: 6 | loss: 0.7231539
	speed: 0.1019s/iter; left time: 42711.3348s
	iters: 1600, epoch: 6 | loss: 0.7470090
	speed: 0.1013s/iter; left time: 42472.2475s
	iters: 1700, epoch: 6 | loss: 0.8587780
	speed: 0.1015s/iter; left time: 42542.7246s
	iters: 1800, epoch: 6 | loss: 0.6683992
	speed: 0.1014s/iter; left time: 42483.9696s
	iters: 1900, epoch: 6 | loss: 0.7101808
	speed: 0.1017s/iter; left time: 42585.0106s
	iters: 2000, epoch: 6 | loss: 0.7084550
	speed: 0.1014s/iter; left time: 42460.4342s
	iters: 2100, epoch: 6 | loss: 0.7252238
	speed: 0.1016s/iter; left time: 42534.7647s
Epoch: 6 cost time: 219.36647820472717
Epoch: 6, Steps: 2158 | Train Loss: 0.6899002 Vali Loss: 1.0161338 Test Loss: 1.0481869
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.6687616
	speed: 1.2516s/iter; left time: 523846.4845s
	iters: 200, epoch: 7 | loss: 0.6568047
	speed: 0.1008s/iter; left time: 42196.4877s
	iters: 300, epoch: 7 | loss: 0.7093419
	speed: 0.1009s/iter; left time: 42231.2094s
	iters: 400, epoch: 7 | loss: 0.7641807
	speed: 0.1007s/iter; left time: 42126.4592s
	iters: 500, epoch: 7 | loss: 0.6421091
	speed: 0.1011s/iter; left time: 42288.6171s
	iters: 600, epoch: 7 | loss: 0.7462213
	speed: 0.1004s/iter; left time: 41962.0864s
	iters: 700, epoch: 7 | loss: 0.6723182
	speed: 0.1007s/iter; left time: 42095.4191s
	iters: 800, epoch: 7 | loss: 0.6366958
	speed: 0.1007s/iter; left time: 42073.6216s
	iters: 900, epoch: 7 | loss: 0.7594042
	speed: 0.1007s/iter; left time: 42069.5017s
	iters: 1000, epoch: 7 | loss: 0.6673360
	speed: 0.1007s/iter; left time: 42050.7233s
	iters: 1100, epoch: 7 | loss: 0.6105192
	speed: 0.1008s/iter; left time: 42108.3765s
	iters: 1200, epoch: 7 | loss: 0.6553787
	speed: 0.1003s/iter; left time: 41861.7424s
	iters: 1300, epoch: 7 | loss: 0.5713914
	speed: 0.1009s/iter; left time: 42107.7650s
	iters: 1400, epoch: 7 | loss: 0.7267988
	speed: 0.1009s/iter; left time: 42115.8440s
	iters: 1500, epoch: 7 | loss: 0.6604250
	speed: 0.1006s/iter; left time: 41964.8407s
	iters: 1600, epoch: 7 | loss: 0.5951741
	speed: 0.1004s/iter; left time: 41861.5652s
	iters: 1700, epoch: 7 | loss: 0.6443397
	speed: 0.1006s/iter; left time: 41945.9388s
	iters: 1800, epoch: 7 | loss: 0.6132770
	speed: 0.1003s/iter; left time: 41823.9945s
	iters: 1900, epoch: 7 | loss: 0.6142790
	speed: 0.1008s/iter; left time: 42027.6285s
	iters: 2000, epoch: 7 | loss: 0.6479874
	speed: 0.1007s/iter; left time: 41963.3115s
	iters: 2100, epoch: 7 | loss: 0.4782591
	speed: 0.1005s/iter; left time: 41855.7325s
Epoch: 7 cost time: 217.41863083839417
Epoch: 7, Steps: 2158 | Train Loss: 0.6603389 Vali Loss: 0.9894831 Test Loss: 1.0459547
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.7183484
	speed: 1.2542s/iter; left time: 522233.8214s
	iters: 200, epoch: 8 | loss: 0.5393244
	speed: 0.1009s/iter; left time: 42020.6043s
	iters: 300, epoch: 8 | loss: 0.5234088
	speed: 0.1002s/iter; left time: 41688.7874s
	iters: 400, epoch: 8 | loss: 0.6443450
	speed: 0.1012s/iter; left time: 42128.5325s
	iters: 500, epoch: 8 | loss: 0.5581772
	speed: 0.1011s/iter; left time: 42040.7203s
	iters: 600, epoch: 8 | loss: 0.6933050
	speed: 0.1007s/iter; left time: 41898.1651s
	iters: 700, epoch: 8 | loss: 0.6127695
	speed: 0.1012s/iter; left time: 42075.3447s
	iters: 800, epoch: 8 | loss: 0.6698793
	speed: 0.1005s/iter; left time: 41774.7576s
	iters: 900, epoch: 8 | loss: 0.7622017
	speed: 0.1010s/iter; left time: 41984.4136s
	iters: 1000, epoch: 8 | loss: 0.6611795
	speed: 0.1006s/iter; left time: 41791.6722s
	iters: 1100, epoch: 8 | loss: 0.7602744
	speed: 0.1008s/iter; left time: 41887.5290s
	iters: 1200, epoch: 8 | loss: 0.7737848
	speed: 0.1009s/iter; left time: 41901.5037s
	iters: 1300, epoch: 8 | loss: 0.5385920
	speed: 0.1007s/iter; left time: 41828.1376s
	iters: 1400, epoch: 8 | loss: 0.5737314
	speed: 0.1004s/iter; left time: 41657.8803s
	iters: 1500, epoch: 8 | loss: 0.6333807
	speed: 0.1011s/iter; left time: 41975.9468s
	iters: 1600, epoch: 8 | loss: 0.6544007
	speed: 0.1005s/iter; left time: 41697.8039s
	iters: 1700, epoch: 8 | loss: 0.5288017
	speed: 0.1010s/iter; left time: 41882.5686s
	iters: 1800, epoch: 8 | loss: 0.5916754
	speed: 0.1010s/iter; left time: 41885.2229s
	iters: 1900, epoch: 8 | loss: 0.6076499
	speed: 0.1007s/iter; left time: 41755.9446s
	iters: 2000, epoch: 8 | loss: 0.5586820
	speed: 0.1003s/iter; left time: 41567.9397s
	iters: 2100, epoch: 8 | loss: 0.7333438
	speed: 0.1005s/iter; left time: 41664.4051s
Epoch: 8 cost time: 217.53609418869019
Epoch: 8, Steps: 2158 | Train Loss: 0.6306840 Vali Loss: 0.8955162 Test Loss: 0.9774737
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 90034
test shape: (9003, 1, 96, 130) (9003, 1, 96, 130)
test shape: (9003, 96, 130) (9003, 96, 130)
mse:1.0134389400482178, mae:0.7682398557662964
>>>>>>>Overall time: 2797 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
