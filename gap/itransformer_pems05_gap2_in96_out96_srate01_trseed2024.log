Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=103, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 548359
val 42596
test 42595
	iters: 100, epoch: 1 | loss: 1.6640017
	speed: 0.0320s/iter; left time: 1092.2697s
	iters: 200, epoch: 1 | loss: 1.5231040
	speed: 0.0299s/iter; left time: 1017.9321s
	iters: 300, epoch: 1 | loss: 1.6233304
	speed: 0.0302s/iter; left time: 1024.8223s
	iters: 400, epoch: 1 | loss: 1.9512538
	speed: 0.0297s/iter; left time: 1006.2567s
	iters: 500, epoch: 1 | loss: 1.2152791
	speed: 0.0303s/iter; left time: 1024.6403s
	iters: 600, epoch: 1 | loss: 1.9824387
	speed: 0.0302s/iter; left time: 1018.1566s
	iters: 700, epoch: 1 | loss: 1.5854506
	speed: 0.0300s/iter; left time: 1007.3383s
	iters: 800, epoch: 1 | loss: 1.5116793
	speed: 0.0296s/iter; left time: 989.5790s
	iters: 900, epoch: 1 | loss: 1.7786834
	speed: 0.0296s/iter; left time: 989.1091s
	iters: 1000, epoch: 1 | loss: 2.0519142
	speed: 0.0302s/iter; left time: 1003.3828s
	iters: 1100, epoch: 1 | loss: 1.4287357
	speed: 0.0303s/iter; left time: 1006.5455s
	iters: 1200, epoch: 1 | loss: 2.1341507
	speed: 0.0299s/iter; left time: 990.3884s
	iters: 1300, epoch: 1 | loss: 1.5033799
	speed: 0.0302s/iter; left time: 994.4943s
	iters: 1400, epoch: 1 | loss: 1.5128965
	speed: 0.0302s/iter; left time: 991.4416s
	iters: 1500, epoch: 1 | loss: 1.6184300
	speed: 0.0303s/iter; left time: 993.4073s
	iters: 1600, epoch: 1 | loss: 1.5606599
	speed: 0.0304s/iter; left time: 991.8720s
	iters: 1700, epoch: 1 | loss: 1.4893765
	speed: 0.0304s/iter; left time: 990.5036s
	iters: 1800, epoch: 1 | loss: 1.6614121
	speed: 0.0301s/iter; left time: 977.0403s
	iters: 1900, epoch: 1 | loss: 1.7300411
	speed: 0.0302s/iter; left time: 978.3072s
	iters: 2000, epoch: 1 | loss: 2.1200547
	speed: 0.0301s/iter; left time: 970.0917s
	iters: 2100, epoch: 1 | loss: 1.8373736
	speed: 0.0304s/iter; left time: 977.6288s
	iters: 2200, epoch: 1 | loss: 1.8553776
	speed: 0.0302s/iter; left time: 970.0200s
	iters: 2300, epoch: 1 | loss: 1.4025805
	speed: 0.0304s/iter; left time: 970.8537s
	iters: 2400, epoch: 1 | loss: 1.5053322
	speed: 0.0302s/iter; left time: 961.1595s
	iters: 2500, epoch: 1 | loss: 1.5092471
	speed: 0.0304s/iter; left time: 965.5163s
	iters: 2600, epoch: 1 | loss: 1.8603088
	speed: 0.0302s/iter; left time: 956.4195s
	iters: 2700, epoch: 1 | loss: 1.6995585
	speed: 0.0305s/iter; left time: 964.0816s
	iters: 2800, epoch: 1 | loss: 2.3201952
	speed: 0.0301s/iter; left time: 948.6398s
	iters: 2900, epoch: 1 | loss: 1.6677697
	speed: 0.0302s/iter; left time: 948.3856s
	iters: 3000, epoch: 1 | loss: 2.3422935
	speed: 0.0304s/iter; left time: 949.1522s
	iters: 3100, epoch: 1 | loss: 1.7486000
	speed: 0.0300s/iter; left time: 936.0913s
	iters: 3200, epoch: 1 | loss: 1.9571646
	speed: 0.0303s/iter; left time: 942.8516s
	iters: 3300, epoch: 1 | loss: 1.7662040
	speed: 0.0298s/iter; left time: 923.6572s
	iters: 3400, epoch: 1 | loss: 1.6049792
	speed: 0.0300s/iter; left time: 927.4659s
Epoch: 1 cost time: 103.5821783542633
Epoch: 1, Steps: 3427 | Train Loss: 1.7590932 Vali Loss: 2.2191966 Test Loss: 1.5800922
Validation loss decreased (inf --> 2.219197).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 2.1099308
	speed: 0.2229s/iter; left time: 6852.5522s
	iters: 200, epoch: 2 | loss: 2.2192881
	speed: 0.0303s/iter; left time: 929.7839s
	iters: 300, epoch: 2 | loss: 1.7879910
	speed: 0.0302s/iter; left time: 923.4402s
	iters: 400, epoch: 2 | loss: 1.7077355
	speed: 0.0305s/iter; left time: 927.6199s
	iters: 500, epoch: 2 | loss: 2.0123675
	speed: 0.0303s/iter; left time: 920.6718s
	iters: 600, epoch: 2 | loss: 1.9262096
	speed: 0.0301s/iter; left time: 911.4543s
	iters: 700, epoch: 2 | loss: 1.7653844
	speed: 0.0300s/iter; left time: 902.8270s
	iters: 800, epoch: 2 | loss: 2.0550251
	speed: 0.0306s/iter; left time: 918.1355s
	iters: 900, epoch: 2 | loss: 1.3825684
	speed: 0.0303s/iter; left time: 906.6452s
	iters: 1000, epoch: 2 | loss: 1.6953614
	speed: 0.0302s/iter; left time: 901.2350s
	iters: 1100, epoch: 2 | loss: 1.7995960
	speed: 0.0303s/iter; left time: 901.9314s
	iters: 1200, epoch: 2 | loss: 2.0916402
	speed: 0.0300s/iter; left time: 890.5966s
	iters: 1300, epoch: 2 | loss: 1.8868507
	speed: 0.0306s/iter; left time: 902.8041s
	iters: 1400, epoch: 2 | loss: 1.9821039
	speed: 0.0302s/iter; left time: 888.2888s
	iters: 1500, epoch: 2 | loss: 1.8217833
	speed: 0.0302s/iter; left time: 887.0897s
	iters: 1600, epoch: 2 | loss: 1.8763158
	speed: 0.0300s/iter; left time: 875.9478s
	iters: 1700, epoch: 2 | loss: 1.9605564
	speed: 0.0301s/iter; left time: 876.5966s
	iters: 1800, epoch: 2 | loss: 2.0641379
	speed: 0.0305s/iter; left time: 886.9219s
	iters: 1900, epoch: 2 | loss: 1.9448421
	speed: 0.0302s/iter; left time: 873.3250s
	iters: 2000, epoch: 2 | loss: 2.3250973
	speed: 0.0303s/iter; left time: 872.8672s
	iters: 2100, epoch: 2 | loss: 1.7462485
	speed: 0.0302s/iter; left time: 869.0162s
	iters: 2200, epoch: 2 | loss: 1.9770131
	speed: 0.0303s/iter; left time: 868.5442s
	iters: 2300, epoch: 2 | loss: 1.8381218
	speed: 0.0301s/iter; left time: 860.1419s
	iters: 2400, epoch: 2 | loss: 1.5129930
	speed: 0.0303s/iter; left time: 862.8622s
	iters: 2500, epoch: 2 | loss: 1.6703751
	speed: 0.0303s/iter; left time: 859.2164s
	iters: 2600, epoch: 2 | loss: 2.2162142
	speed: 0.0304s/iter; left time: 858.5571s
	iters: 2700, epoch: 2 | loss: 1.7983626
	speed: 0.0303s/iter; left time: 853.9568s
	iters: 2800, epoch: 2 | loss: 1.6702000
	speed: 0.0304s/iter; left time: 852.1577s
	iters: 2900, epoch: 2 | loss: 1.4479082
	speed: 0.0302s/iter; left time: 843.8969s
	iters: 3000, epoch: 2 | loss: 1.9272126
	speed: 0.0301s/iter; left time: 837.0568s
	iters: 3100, epoch: 2 | loss: 2.3563704
	speed: 0.0301s/iter; left time: 833.7724s
	iters: 3200, epoch: 2 | loss: 1.5803015
	speed: 0.0305s/iter; left time: 844.4659s
	iters: 3300, epoch: 2 | loss: 1.8794377
	speed: 0.0306s/iter; left time: 841.5057s
	iters: 3400, epoch: 2 | loss: 2.1935060
	speed: 0.0308s/iter; left time: 846.3298s
Epoch: 2 cost time: 103.88157653808594
Epoch: 2, Steps: 3427 | Train Loss: 1.8461847 Vali Loss: 2.2206590 Test Loss: 1.5813287
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.8787780
	speed: 0.2195s/iter; left time: 5995.1032s
	iters: 200, epoch: 3 | loss: 1.7915028
	speed: 0.0256s/iter; left time: 697.9231s
	iters: 300, epoch: 3 | loss: 1.6885556
	speed: 0.0296s/iter; left time: 803.5584s
	iters: 400, epoch: 3 | loss: 1.8419634
	speed: 0.0304s/iter; left time: 820.3304s
	iters: 500, epoch: 3 | loss: 1.5452458
	speed: 0.0305s/iter; left time: 821.6550s
	iters: 600, epoch: 3 | loss: 1.4867343
	speed: 0.0303s/iter; left time: 811.7951s
	iters: 700, epoch: 3 | loss: 2.2495434
	speed: 0.0297s/iter; left time: 792.4858s
	iters: 800, epoch: 3 | loss: 1.9939234
	speed: 0.0305s/iter; left time: 812.7032s
	iters: 900, epoch: 3 | loss: 1.8588088
	speed: 0.0300s/iter; left time: 796.2453s
	iters: 1000, epoch: 3 | loss: 1.7372516
	speed: 0.0304s/iter; left time: 802.1689s
	iters: 1100, epoch: 3 | loss: 1.9292707
	speed: 0.0300s/iter; left time: 789.0495s
	iters: 1200, epoch: 3 | loss: 1.9875081
	speed: 0.0302s/iter; left time: 791.8805s
	iters: 1300, epoch: 3 | loss: 1.3784970
	speed: 0.0302s/iter; left time: 788.0029s
	iters: 1400, epoch: 3 | loss: 2.4258957
	speed: 0.0302s/iter; left time: 785.3277s
	iters: 1500, epoch: 3 | loss: 1.4503922
	speed: 0.0303s/iter; left time: 786.1706s
	iters: 1600, epoch: 3 | loss: 1.4810028
	speed: 0.0302s/iter; left time: 780.3184s
	iters: 1700, epoch: 3 | loss: 1.6710575
	speed: 0.0300s/iter; left time: 772.5062s
	iters: 1800, epoch: 3 | loss: 1.5600756
	speed: 0.0304s/iter; left time: 777.7126s
	iters: 1900, epoch: 3 | loss: 1.7298601
	speed: 0.0299s/iter; left time: 763.3429s
	iters: 2000, epoch: 3 | loss: 1.9346533
	speed: 0.0303s/iter; left time: 769.5802s
	iters: 2100, epoch: 3 | loss: 1.5500872
	speed: 0.0300s/iter; left time: 759.9897s
	iters: 2200, epoch: 3 | loss: 1.7362267
	speed: 0.0301s/iter; left time: 758.7755s
	iters: 2300, epoch: 3 | loss: 1.8205764
	speed: 0.0298s/iter; left time: 749.1799s
	iters: 2400, epoch: 3 | loss: 1.5508324
	speed: 0.0304s/iter; left time: 759.5230s
	iters: 2500, epoch: 3 | loss: 1.6875559
	speed: 0.0304s/iter; left time: 756.7837s
	iters: 2600, epoch: 3 | loss: 1.7775384
	speed: 0.0305s/iter; left time: 757.7983s
	iters: 2700, epoch: 3 | loss: 2.2381873
	speed: 0.0305s/iter; left time: 753.8920s
	iters: 2800, epoch: 3 | loss: 1.9521480
	speed: 0.0304s/iter; left time: 747.3903s
	iters: 2900, epoch: 3 | loss: 1.4001088
	speed: 0.0305s/iter; left time: 746.9591s
	iters: 3000, epoch: 3 | loss: 1.6310979
	speed: 0.0301s/iter; left time: 735.2097s
	iters: 3100, epoch: 3 | loss: 1.8070726
	speed: 0.0304s/iter; left time: 738.2609s
	iters: 3200, epoch: 3 | loss: 1.8097914
	speed: 0.0304s/iter; left time: 735.5046s
	iters: 3300, epoch: 3 | loss: 1.5616037
	speed: 0.0300s/iter; left time: 723.6062s
	iters: 3400, epoch: 3 | loss: 2.0264301
	speed: 0.0305s/iter; left time: 731.6417s
Epoch: 3 cost time: 103.026034116745
Epoch: 3, Steps: 3427 | Train Loss: 1.8450324 Vali Loss: 2.2184484 Test Loss: 1.5846326
Validation loss decreased (2.219197 --> 2.218448).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.4448959
	speed: 0.2207s/iter; left time: 5271.8450s
	iters: 200, epoch: 4 | loss: 1.7467395
	speed: 0.0300s/iter; left time: 713.6115s
	iters: 300, epoch: 4 | loss: 1.8081814
	speed: 0.0306s/iter; left time: 723.7862s
	iters: 400, epoch: 4 | loss: 1.7645367
	speed: 0.0304s/iter; left time: 716.9290s
	iters: 500, epoch: 4 | loss: 1.9154972
	speed: 0.0303s/iter; left time: 712.4521s
	iters: 600, epoch: 4 | loss: 1.4325500
	speed: 0.0301s/iter; left time: 704.0759s
	iters: 700, epoch: 4 | loss: 1.7323418
	speed: 0.0303s/iter; left time: 705.9037s
	iters: 800, epoch: 4 | loss: 1.7525665
	speed: 0.0299s/iter; left time: 694.4078s
	iters: 900, epoch: 4 | loss: 1.9101415
	speed: 0.0304s/iter; left time: 701.6074s
	iters: 1000, epoch: 4 | loss: 1.6072915
	speed: 0.0302s/iter; left time: 694.5750s
	iters: 1100, epoch: 4 | loss: 1.7972747
	speed: 0.0302s/iter; left time: 691.7455s
	iters: 1200, epoch: 4 | loss: 1.7290233
	speed: 0.0305s/iter; left time: 694.5179s
	iters: 1300, epoch: 4 | loss: 1.4801786
	speed: 0.0304s/iter; left time: 688.6596s
	iters: 1400, epoch: 4 | loss: 1.9045081
	speed: 0.0304s/iter; left time: 686.3400s
	iters: 1500, epoch: 4 | loss: 1.7594465
	speed: 0.0304s/iter; left time: 682.8496s
	iters: 1600, epoch: 4 | loss: 1.9872943
	speed: 0.0301s/iter; left time: 674.7268s
	iters: 1700, epoch: 4 | loss: 1.2042438
	speed: 0.0305s/iter; left time: 678.8252s
	iters: 1800, epoch: 4 | loss: 1.6029214
	speed: 0.0304s/iter; left time: 674.3569s
	iters: 1900, epoch: 4 | loss: 1.5866431
	speed: 0.0301s/iter; left time: 664.1361s
	iters: 2000, epoch: 4 | loss: 1.7966139
	speed: 0.0305s/iter; left time: 670.4473s
	iters: 2100, epoch: 4 | loss: 2.0334196
	speed: 0.0302s/iter; left time: 660.2516s
	iters: 2200, epoch: 4 | loss: 1.4125520
	speed: 0.0305s/iter; left time: 664.3591s
	iters: 2300, epoch: 4 | loss: 1.9589332
	speed: 0.0303s/iter; left time: 656.4028s
	iters: 2400, epoch: 4 | loss: 1.6789848
	speed: 0.0305s/iter; left time: 657.4268s
	iters: 2500, epoch: 4 | loss: 2.1035030
	speed: 0.0302s/iter; left time: 647.9890s
	iters: 2600, epoch: 4 | loss: 1.4405068
	speed: 0.0303s/iter; left time: 649.1077s
	iters: 2700, epoch: 4 | loss: 1.8483688
	speed: 0.0302s/iter; left time: 641.9036s
	iters: 2800, epoch: 4 | loss: 2.3401673
	speed: 0.0303s/iter; left time: 641.6928s
	iters: 2900, epoch: 4 | loss: 2.5712535
	speed: 0.0301s/iter; left time: 634.5319s
	iters: 3000, epoch: 4 | loss: 1.6117902
	speed: 0.0302s/iter; left time: 633.2629s
	iters: 3100, epoch: 4 | loss: 2.1493518
	speed: 0.0298s/iter; left time: 621.7815s
	iters: 3200, epoch: 4 | loss: 1.7658182
	speed: 0.0298s/iter; left time: 619.4152s
	iters: 3300, epoch: 4 | loss: 1.6180098
	speed: 0.0301s/iter; left time: 622.0497s
	iters: 3400, epoch: 4 | loss: 1.5431434
	speed: 0.0310s/iter; left time: 638.9426s
Epoch: 4 cost time: 103.75294709205627
Epoch: 4, Steps: 3427 | Train Loss: 1.8449291 Vali Loss: 2.2206576 Test Loss: 1.5808520
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.5153954
	speed: 0.2201s/iter; left time: 4504.7462s
	iters: 200, epoch: 5 | loss: 1.6871538
	speed: 0.0301s/iter; left time: 612.8794s
	iters: 300, epoch: 5 | loss: 1.8889021
	speed: 0.0301s/iter; left time: 609.7353s
	iters: 400, epoch: 5 | loss: 1.9347278
	speed: 0.0299s/iter; left time: 603.6043s
	iters: 500, epoch: 5 | loss: 2.0552232
	speed: 0.0302s/iter; left time: 605.6141s
	iters: 600, epoch: 5 | loss: 1.8190030
	speed: 0.0304s/iter; left time: 606.6845s
	iters: 700, epoch: 5 | loss: 2.2573185
	speed: 0.0302s/iter; left time: 600.6092s
	iters: 800, epoch: 5 | loss: 1.9844724
	speed: 0.0302s/iter; left time: 596.2227s
	iters: 900, epoch: 5 | loss: 2.0445523
	speed: 0.0299s/iter; left time: 587.5738s
	iters: 1000, epoch: 5 | loss: 1.6175263
	speed: 0.0298s/iter; left time: 583.6959s
	iters: 1100, epoch: 5 | loss: 1.6485152
	speed: 0.0304s/iter; left time: 591.3436s
	iters: 1200, epoch: 5 | loss: 1.8239079
	speed: 0.0301s/iter; left time: 582.6092s
	iters: 1300, epoch: 5 | loss: 1.7141608
	speed: 0.0300s/iter; left time: 578.2685s
	iters: 1400, epoch: 5 | loss: 2.1750562
	speed: 0.0302s/iter; left time: 579.2362s
	iters: 1500, epoch: 5 | loss: 1.7870569
	speed: 0.0304s/iter; left time: 579.9799s
	iters: 1600, epoch: 5 | loss: 1.5684488
	speed: 0.0302s/iter; left time: 571.7884s
	iters: 1700, epoch: 5 | loss: 1.3156739
	speed: 0.0303s/iter; left time: 571.6799s
	iters: 1800, epoch: 5 | loss: 2.0353024
	speed: 0.0305s/iter; left time: 572.8829s
	iters: 1900, epoch: 5 | loss: 1.7978307
	speed: 0.0302s/iter; left time: 564.4333s
	iters: 2000, epoch: 5 | loss: 1.8401055
	speed: 0.0306s/iter; left time: 567.9664s
	iters: 2100, epoch: 5 | loss: 1.6313943
	speed: 0.0304s/iter; left time: 560.8241s
	iters: 2200, epoch: 5 | loss: 1.4453362
	speed: 0.0297s/iter; left time: 544.7969s
	iters: 2300, epoch: 5 | loss: 1.4317489
	speed: 0.0301s/iter; left time: 549.7569s
	iters: 2400, epoch: 5 | loss: 1.8922112
	speed: 0.0305s/iter; left time: 554.1465s
	iters: 2500, epoch: 5 | loss: 1.6816707
	speed: 0.0302s/iter; left time: 544.8895s
	iters: 2600, epoch: 5 | loss: 1.5531191
	speed: 0.0304s/iter; left time: 545.3660s
	iters: 2700, epoch: 5 | loss: 1.7879726
	speed: 0.0305s/iter; left time: 545.0045s
	iters: 2800, epoch: 5 | loss: 1.8870953
	speed: 0.0304s/iter; left time: 540.8108s
	iters: 2900, epoch: 5 | loss: 1.7770641
	speed: 0.0302s/iter; left time: 533.4619s
	iters: 3000, epoch: 5 | loss: 1.4426545
	speed: 0.0303s/iter; left time: 531.8473s
	iters: 3100, epoch: 5 | loss: 1.7733629
	speed: 0.0302s/iter; left time: 527.4832s
	iters: 3200, epoch: 5 | loss: 1.7508099
	speed: 0.0302s/iter; left time: 524.9265s
	iters: 3300, epoch: 5 | loss: 1.7420489
	speed: 0.0303s/iter; left time: 523.0651s
	iters: 3400, epoch: 5 | loss: 1.8272239
	speed: 0.0306s/iter; left time: 525.0904s
Epoch: 5 cost time: 103.7384901046753
Epoch: 5, Steps: 3427 | Train Loss: 1.8446905 Vali Loss: 2.2187681 Test Loss: 1.5802562
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.6329566
	speed: 0.2203s/iter; left time: 3752.2938s
	iters: 200, epoch: 6 | loss: 2.3009293
	speed: 0.0304s/iter; left time: 514.8695s
	iters: 300, epoch: 6 | loss: 1.9001764
	speed: 0.0305s/iter; left time: 513.8369s
	iters: 400, epoch: 6 | loss: 2.0980210
	speed: 0.0300s/iter; left time: 501.2875s
	iters: 500, epoch: 6 | loss: 1.6777532
	speed: 0.0303s/iter; left time: 504.0060s
	iters: 600, epoch: 6 | loss: 1.6397196
	speed: 0.0304s/iter; left time: 502.4193s
	iters: 700, epoch: 6 | loss: 1.6740211
	speed: 0.0300s/iter; left time: 492.8477s
	iters: 800, epoch: 6 | loss: 2.4827702
	speed: 0.0302s/iter; left time: 492.9775s
	iters: 900, epoch: 6 | loss: 1.8326671
	speed: 0.0303s/iter; left time: 492.0011s
	iters: 1000, epoch: 6 | loss: 2.5140228
	speed: 0.0302s/iter; left time: 487.9307s
	iters: 1100, epoch: 6 | loss: 2.1321070
	speed: 0.0299s/iter; left time: 480.2598s
	iters: 1200, epoch: 6 | loss: 1.9403142
	speed: 0.0302s/iter; left time: 480.7648s
	iters: 1300, epoch: 6 | loss: 2.0451732
	speed: 0.0304s/iter; left time: 480.7778s
	iters: 1400, epoch: 6 | loss: 1.8113925
	speed: 0.0300s/iter; left time: 472.7591s
	iters: 1500, epoch: 6 | loss: 1.4664685
	speed: 0.0297s/iter; left time: 464.6007s
	iters: 1600, epoch: 6 | loss: 2.4952462
	speed: 0.0304s/iter; left time: 472.2126s
	iters: 1700, epoch: 6 | loss: 1.5286764
	speed: 0.0302s/iter; left time: 465.5335s
	iters: 1800, epoch: 6 | loss: 1.5402614
	speed: 0.0302s/iter; left time: 462.6879s
	iters: 1900, epoch: 6 | loss: 2.3063176
	speed: 0.0302s/iter; left time: 459.7337s
	iters: 2000, epoch: 6 | loss: 1.8525565
	speed: 0.0302s/iter; left time: 457.6916s
	iters: 2100, epoch: 6 | loss: 2.1907578
	speed: 0.0298s/iter; left time: 448.4291s
	iters: 2200, epoch: 6 | loss: 1.3751892
	speed: 0.0304s/iter; left time: 453.6947s
	iters: 2300, epoch: 6 | loss: 1.4490743
	speed: 0.0297s/iter; left time: 440.1301s
	iters: 2400, epoch: 6 | loss: 1.5783690
	speed: 0.0303s/iter; left time: 446.7375s
	iters: 2500, epoch: 6 | loss: 1.3615087
	speed: 0.0304s/iter; left time: 444.2997s
	iters: 2600, epoch: 6 | loss: 2.1426151
	speed: 0.0302s/iter; left time: 438.7401s
	iters: 2700, epoch: 6 | loss: 1.5570831
	speed: 0.0304s/iter; left time: 438.1884s
	iters: 2800, epoch: 6 | loss: 1.6934011
	speed: 0.0303s/iter; left time: 433.6990s
	iters: 2900, epoch: 6 | loss: 1.8272613
	speed: 0.0302s/iter; left time: 429.4041s
	iters: 3000, epoch: 6 | loss: 1.4683955
	speed: 0.0303s/iter; left time: 427.9979s
	iters: 3100, epoch: 6 | loss: 2.4889600
	speed: 0.0304s/iter; left time: 426.0655s
	iters: 3200, epoch: 6 | loss: 1.8527963
	speed: 0.0301s/iter; left time: 419.6566s
	iters: 3300, epoch: 6 | loss: 1.6677970
	speed: 0.0305s/iter; left time: 422.2992s
	iters: 3400, epoch: 6 | loss: 1.9244907
	speed: 0.0305s/iter; left time: 418.8221s
Epoch: 6 cost time: 103.55103278160095
Epoch: 6, Steps: 3427 | Train Loss: 1.8447353 Vali Loss: 2.2180977 Test Loss: 1.5802224
Validation loss decreased (2.218448 --> 2.218098).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 2.1332834
	speed: 0.2210s/iter; left time: 3007.4269s
	iters: 200, epoch: 7 | loss: 1.6486917
	speed: 0.0304s/iter; left time: 411.2196s
	iters: 300, epoch: 7 | loss: 1.8026946
	speed: 0.0304s/iter; left time: 407.3027s
	iters: 400, epoch: 7 | loss: 1.6964961
	speed: 0.0301s/iter; left time: 401.0092s
	iters: 500, epoch: 7 | loss: 1.6519630
	speed: 0.0304s/iter; left time: 402.2039s
	iters: 600, epoch: 7 | loss: 2.0306790
	speed: 0.0303s/iter; left time: 397.5416s
	iters: 700, epoch: 7 | loss: 1.2913969
	speed: 0.0301s/iter; left time: 391.7824s
	iters: 800, epoch: 7 | loss: 1.8238775
	speed: 0.0302s/iter; left time: 389.6392s
	iters: 900, epoch: 7 | loss: 2.0784769
	speed: 0.0304s/iter; left time: 389.4422s
	iters: 1000, epoch: 7 | loss: 2.3984158
	speed: 0.0302s/iter; left time: 383.3656s
	iters: 1100, epoch: 7 | loss: 2.1283801
	speed: 0.0299s/iter; left time: 376.7387s
	iters: 1200, epoch: 7 | loss: 2.0338466
	speed: 0.0302s/iter; left time: 378.2625s
	iters: 1300, epoch: 7 | loss: 1.7630509
	speed: 0.0303s/iter; left time: 376.2387s
	iters: 1400, epoch: 7 | loss: 1.6314858
	speed: 0.0297s/iter; left time: 364.9905s
	iters: 1500, epoch: 7 | loss: 1.8324568
	speed: 0.0302s/iter; left time: 369.2139s
	iters: 1600, epoch: 7 | loss: 1.4667159
	speed: 0.0302s/iter; left time: 366.0360s
	iters: 1700, epoch: 7 | loss: 1.8168548
	speed: 0.0303s/iter; left time: 364.3823s
	iters: 1800, epoch: 7 | loss: 2.0367274
	speed: 0.0307s/iter; left time: 365.0254s
	iters: 1900, epoch: 7 | loss: 2.0874605
	speed: 0.0300s/iter; left time: 353.8826s
	iters: 2000, epoch: 7 | loss: 2.3900323
	speed: 0.0303s/iter; left time: 354.9370s
	iters: 2100, epoch: 7 | loss: 1.2336563
	speed: 0.0303s/iter; left time: 352.0116s
	iters: 2200, epoch: 7 | loss: 1.4006681
	speed: 0.0301s/iter; left time: 346.9397s
	iters: 2300, epoch: 7 | loss: 1.9207615
	speed: 0.0302s/iter; left time: 344.9475s
	iters: 2400, epoch: 7 | loss: 2.1604040
	speed: 0.0302s/iter; left time: 341.9572s
	iters: 2500, epoch: 7 | loss: 1.9074095
	speed: 0.0305s/iter; left time: 341.4893s
	iters: 2600, epoch: 7 | loss: 1.9047228
	speed: 0.0302s/iter; left time: 334.9616s
	iters: 2700, epoch: 7 | loss: 1.7166555
	speed: 0.0303s/iter; left time: 333.1237s
	iters: 2800, epoch: 7 | loss: 1.5793947
	speed: 0.0304s/iter; left time: 331.3648s
	iters: 2900, epoch: 7 | loss: 2.2157140
	speed: 0.0300s/iter; left time: 323.9877s
	iters: 3000, epoch: 7 | loss: 1.7088463
	speed: 0.0303s/iter; left time: 324.2368s
	iters: 3100, epoch: 7 | loss: 1.8781599
	speed: 0.0303s/iter; left time: 321.1962s
	iters: 3200, epoch: 7 | loss: 1.8698330
	speed: 0.0302s/iter; left time: 317.8818s
	iters: 3300, epoch: 7 | loss: 1.9967227
	speed: 0.0304s/iter; left time: 316.0270s
	iters: 3400, epoch: 7 | loss: 2.2997918
	speed: 0.0307s/iter; left time: 316.2742s
Epoch: 7 cost time: 103.77163362503052
Epoch: 7, Steps: 3427 | Train Loss: 1.8446906 Vali Loss: 2.2185357 Test Loss: 1.5804486
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 1.9064223
	speed: 0.2204s/iter; left time: 2243.6419s
	iters: 200, epoch: 8 | loss: 2.0106807
	speed: 0.0304s/iter; left time: 306.2511s
	iters: 300, epoch: 8 | loss: 1.8341861
	speed: 0.0305s/iter; left time: 304.2812s
	iters: 400, epoch: 8 | loss: 1.7082428
	speed: 0.0301s/iter; left time: 297.7181s
	iters: 500, epoch: 8 | loss: 1.8527128
	speed: 0.0303s/iter; left time: 296.7704s
	iters: 600, epoch: 8 | loss: 2.0592718
	speed: 0.0304s/iter; left time: 293.9227s
	iters: 700, epoch: 8 | loss: 2.1375484
	speed: 0.0302s/iter; left time: 289.8001s
	iters: 800, epoch: 8 | loss: 2.0311322
	speed: 0.0303s/iter; left time: 286.9789s
	iters: 900, epoch: 8 | loss: 1.7578104
	speed: 0.0303s/iter; left time: 284.6143s
	iters: 1000, epoch: 8 | loss: 1.9110627
	speed: 0.0302s/iter; left time: 280.0361s
	iters: 1100, epoch: 8 | loss: 1.9766234
	speed: 0.0304s/iter; left time: 279.4124s
	iters: 1200, epoch: 8 | loss: 2.2085075
	speed: 0.0303s/iter; left time: 275.0375s
	iters: 1300, epoch: 8 | loss: 2.4016159
	speed: 0.0304s/iter; left time: 273.3735s
	iters: 1400, epoch: 8 | loss: 1.4033116
	speed: 0.0303s/iter; left time: 268.7838s
	iters: 1500, epoch: 8 | loss: 1.7088264
	speed: 0.0304s/iter; left time: 266.6004s
	iters: 1600, epoch: 8 | loss: 1.9053379
	speed: 0.0305s/iter; left time: 264.3868s
	iters: 1700, epoch: 8 | loss: 1.7350000
	speed: 0.0304s/iter; left time: 260.5545s
	iters: 1800, epoch: 8 | loss: 1.6942923
	speed: 0.0299s/iter; left time: 254.0153s
	iters: 1900, epoch: 8 | loss: 1.3021053
	speed: 0.0304s/iter; left time: 254.5940s
	iters: 2000, epoch: 8 | loss: 2.1066067
	speed: 0.0304s/iter; left time: 251.8016s
	iters: 2100, epoch: 8 | loss: 2.6985512
	speed: 0.0306s/iter; left time: 250.1389s
	iters: 2200, epoch: 8 | loss: 1.6308843
	speed: 0.0301s/iter; left time: 242.8809s
	iters: 2300, epoch: 8 | loss: 1.8342515
	speed: 0.0303s/iter; left time: 241.9751s
	iters: 2400, epoch: 8 | loss: 1.8999203
	speed: 0.0297s/iter; left time: 233.8373s
	iters: 2500, epoch: 8 | loss: 1.7648351
	speed: 0.0300s/iter; left time: 233.8184s
	iters: 2600, epoch: 8 | loss: 2.0830712
	speed: 0.0304s/iter; left time: 233.7871s
	iters: 2700, epoch: 8 | loss: 1.7347466
	speed: 0.0299s/iter; left time: 226.5514s
	iters: 2800, epoch: 8 | loss: 1.8182143
	speed: 0.0301s/iter; left time: 225.0784s
	iters: 2900, epoch: 8 | loss: 2.0036769
	speed: 0.0302s/iter; left time: 222.6397s
	iters: 3000, epoch: 8 | loss: 1.5663024
	speed: 0.0300s/iter; left time: 218.5190s
	iters: 3100, epoch: 8 | loss: 1.5743748
	speed: 0.0302s/iter; left time: 216.6487s
	iters: 3200, epoch: 8 | loss: 1.5665480
	speed: 0.0300s/iter; left time: 212.6787s
	iters: 3300, epoch: 8 | loss: 1.3336408
	speed: 0.0305s/iter; left time: 212.8085s
	iters: 3400, epoch: 8 | loss: 2.1507933
	speed: 0.0310s/iter; left time: 213.0470s
Epoch: 8 cost time: 103.8070924282074
Epoch: 8, Steps: 3427 | Train Loss: 1.8447601 Vali Loss: 2.2176168 Test Loss: 1.5802976
Validation loss decreased (2.218098 --> 2.217617).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 2.4032075
	speed: 0.2198s/iter; left time: 1484.6647s
	iters: 200, epoch: 9 | loss: 1.7268430
	speed: 0.0303s/iter; left time: 201.7504s
	iters: 300, epoch: 9 | loss: 1.7830070
	speed: 0.0303s/iter; left time: 198.8233s
	iters: 400, epoch: 9 | loss: 2.0609131
	speed: 0.0304s/iter; left time: 196.1343s
	iters: 500, epoch: 9 | loss: 1.9513549
	speed: 0.0300s/iter; left time: 190.9472s
	iters: 600, epoch: 9 | loss: 1.8477379
	speed: 0.0302s/iter; left time: 188.9785s
	iters: 700, epoch: 9 | loss: 1.7895048
	speed: 0.0300s/iter; left time: 184.8974s
	iters: 800, epoch: 9 | loss: 1.7764676
	speed: 0.0304s/iter; left time: 184.1872s
	iters: 900, epoch: 9 | loss: 2.0818131
	speed: 0.0303s/iter; left time: 180.1937s
	iters: 1000, epoch: 9 | loss: 1.8602504
	speed: 0.0297s/iter; left time: 173.6141s
	iters: 1100, epoch: 9 | loss: 2.0180862
	speed: 0.0304s/iter; left time: 175.2097s
	iters: 1200, epoch: 9 | loss: 1.9341899
	speed: 0.0304s/iter; left time: 171.6707s
	iters: 1300, epoch: 9 | loss: 2.0469282
	speed: 0.0300s/iter; left time: 166.5938s
	iters: 1400, epoch: 9 | loss: 2.0304949
	speed: 0.0303s/iter; left time: 165.5230s
	iters: 1500, epoch: 9 | loss: 1.4799930
	speed: 0.0304s/iter; left time: 162.5407s
	iters: 1600, epoch: 9 | loss: 1.9574190
	speed: 0.0301s/iter; left time: 158.3877s
	iters: 1700, epoch: 9 | loss: 2.2703779
	speed: 0.0304s/iter; left time: 156.8118s
	iters: 1800, epoch: 9 | loss: 2.2895210
	speed: 0.0299s/iter; left time: 151.2440s
	iters: 1900, epoch: 9 | loss: 1.8151990
	speed: 0.0301s/iter; left time: 149.3403s
	iters: 2000, epoch: 9 | loss: 1.7797198
	speed: 0.0302s/iter; left time: 146.5678s
	iters: 2100, epoch: 9 | loss: 1.6279631
	speed: 0.0305s/iter; left time: 144.8788s
	iters: 2200, epoch: 9 | loss: 1.4569460
	speed: 0.0306s/iter; left time: 142.2584s
	iters: 2300, epoch: 9 | loss: 1.3483449
	speed: 0.0301s/iter; left time: 137.1456s
	iters: 2400, epoch: 9 | loss: 1.6571852
	speed: 0.0302s/iter; left time: 134.6368s
	iters: 2500, epoch: 9 | loss: 2.2489622
	speed: 0.0302s/iter; left time: 131.5060s
	iters: 2600, epoch: 9 | loss: 2.0897524
	speed: 0.0302s/iter; left time: 128.5502s
	iters: 2700, epoch: 9 | loss: 1.7756463
	speed: 0.0297s/iter; left time: 123.5117s
	iters: 2800, epoch: 9 | loss: 1.9155874
	speed: 0.0299s/iter; left time: 121.2132s
	iters: 2900, epoch: 9 | loss: 1.6891226
	speed: 0.0305s/iter; left time: 120.4715s
	iters: 3000, epoch: 9 | loss: 1.9429245
	speed: 0.0304s/iter; left time: 117.2592s
	iters: 3100, epoch: 9 | loss: 1.8554779
	speed: 0.0302s/iter; left time: 113.5590s
	iters: 3200, epoch: 9 | loss: 1.7974613
	speed: 0.0304s/iter; left time: 111.1981s
	iters: 3300, epoch: 9 | loss: 1.5301630
	speed: 0.0302s/iter; left time: 107.5155s
	iters: 3400, epoch: 9 | loss: 1.7887957
	speed: 0.0306s/iter; left time: 105.6507s
Epoch: 9 cost time: 103.52560687065125
Epoch: 9, Steps: 3427 | Train Loss: 1.8447211 Vali Loss: 2.2182283 Test Loss: 1.5803238
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 1.8268708
	speed: 0.2217s/iter; left time: 737.6874s
	iters: 200, epoch: 10 | loss: 1.8128282
	speed: 0.0302s/iter; left time: 97.5894s
	iters: 300, epoch: 10 | loss: 1.8982890
	speed: 0.0305s/iter; left time: 95.3177s
	iters: 400, epoch: 10 | loss: 1.8146981
	speed: 0.0303s/iter; left time: 91.7489s
	iters: 500, epoch: 10 | loss: 1.6776068
	speed: 0.0303s/iter; left time: 88.8350s
	iters: 600, epoch: 10 | loss: 1.3649933
	speed: 0.0301s/iter; left time: 85.1634s
	iters: 700, epoch: 10 | loss: 1.5486852
	speed: 0.0303s/iter; left time: 82.7409s
	iters: 800, epoch: 10 | loss: 1.4196972
	speed: 0.0298s/iter; left time: 78.3417s
	iters: 900, epoch: 10 | loss: 1.7513015
	speed: 0.0304s/iter; left time: 76.9739s
	iters: 1000, epoch: 10 | loss: 2.0871053
	speed: 0.0302s/iter; left time: 73.3396s
	iters: 1100, epoch: 10 | loss: 2.0842803
	speed: 0.0301s/iter; left time: 70.0325s
	iters: 1200, epoch: 10 | loss: 1.6303881
	speed: 0.0301s/iter; left time: 67.0624s
	iters: 1300, epoch: 10 | loss: 1.7983668
	speed: 0.0300s/iter; left time: 63.8895s
	iters: 1400, epoch: 10 | loss: 1.5516880
	speed: 0.0303s/iter; left time: 61.4984s
	iters: 1500, epoch: 10 | loss: 1.4265057
	speed: 0.0302s/iter; left time: 58.2907s
	iters: 1600, epoch: 10 | loss: 2.1173546
	speed: 0.0304s/iter; left time: 55.5156s
	iters: 1700, epoch: 10 | loss: 1.8189952
	speed: 0.0301s/iter; left time: 51.9599s
	iters: 1800, epoch: 10 | loss: 1.4975519
	speed: 0.0301s/iter; left time: 48.9765s
	iters: 1900, epoch: 10 | loss: 1.9383827
	speed: 0.0297s/iter; left time: 45.3452s
	iters: 2000, epoch: 10 | loss: 1.8031712
	speed: 0.0299s/iter; left time: 42.7559s
	iters: 2100, epoch: 10 | loss: 1.5934992
	speed: 0.0306s/iter; left time: 40.5980s
	iters: 2200, epoch: 10 | loss: 2.0363295
	speed: 0.0304s/iter; left time: 37.2900s
	iters: 2300, epoch: 10 | loss: 1.9614618
	speed: 0.0298s/iter; left time: 33.6438s
	iters: 2400, epoch: 10 | loss: 1.7788460
	speed: 0.0299s/iter; left time: 30.7657s
	iters: 2500, epoch: 10 | loss: 1.5239605
	speed: 0.0303s/iter; left time: 28.1567s
	iters: 2600, epoch: 10 | loss: 1.7331734
	speed: 0.0302s/iter; left time: 25.0414s
	iters: 2700, epoch: 10 | loss: 1.2660388
	speed: 0.0302s/iter; left time: 22.0045s
	iters: 2800, epoch: 10 | loss: 1.8861908
	speed: 0.0303s/iter; left time: 19.0260s
	iters: 2900, epoch: 10 | loss: 1.8505993
	speed: 0.0305s/iter; left time: 16.0815s
	iters: 3000, epoch: 10 | loss: 2.1451046
	speed: 0.0304s/iter; left time: 12.9908s
	iters: 3100, epoch: 10 | loss: 1.7966365
	speed: 0.0305s/iter; left time: 10.0137s
	iters: 3200, epoch: 10 | loss: 1.4258131
	speed: 0.0300s/iter; left time: 6.8436s
	iters: 3300, epoch: 10 | loss: 1.4894772
	speed: 0.0299s/iter; left time: 3.8306s
	iters: 3400, epoch: 10 | loss: 1.9723898
	speed: 0.0306s/iter; left time: 0.8575s
Epoch: 10 cost time: 103.52626657485962
Epoch: 10, Steps: 3427 | Train Loss: 1.8446898 Vali Loss: 2.2181022 Test Loss: 1.5803229
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_pems05_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 42595
test shape: (4259, 1, 96, 103) (4259, 1, 96, 103)
test shape: (4259, 96, 103) (4259, 96, 103)
mse:1.5802981853485107, mae:0.9689014554023743
>>>>>>>Overall time: 1288 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
