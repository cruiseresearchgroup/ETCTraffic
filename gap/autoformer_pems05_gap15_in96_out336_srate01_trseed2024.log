Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 600535
val 94772
test 94771
	iters: 100, epoch: 1 | loss: 1.2498261
	speed: 0.1742s/iter; left time: 65324.0107s
	iters: 200, epoch: 1 | loss: 1.3570769
	speed: 0.1729s/iter; left time: 64828.9046s
	iters: 300, epoch: 1 | loss: 0.9908460
	speed: 0.1725s/iter; left time: 64658.7008s
	iters: 400, epoch: 1 | loss: 0.9850730
	speed: 0.1721s/iter; left time: 64491.6668s
	iters: 500, epoch: 1 | loss: 1.0381134
	speed: 0.1724s/iter; left time: 64583.5870s
	iters: 600, epoch: 1 | loss: 0.9494777
	speed: 0.1721s/iter; left time: 64477.4901s
	iters: 700, epoch: 1 | loss: 0.9826040
	speed: 0.1726s/iter; left time: 64632.2626s
	iters: 800, epoch: 1 | loss: 0.9431254
	speed: 0.1727s/iter; left time: 64657.5191s
	iters: 900, epoch: 1 | loss: 0.9984622
	speed: 0.1727s/iter; left time: 64637.0600s
	iters: 1000, epoch: 1 | loss: 0.9700767
	speed: 0.1725s/iter; left time: 64554.2163s
	iters: 1100, epoch: 1 | loss: 0.8931658
	speed: 0.1728s/iter; left time: 64628.5641s
	iters: 1200, epoch: 1 | loss: 0.9350228
	speed: 0.1724s/iter; left time: 64490.4941s
	iters: 1300, epoch: 1 | loss: 0.7686247
	speed: 0.1729s/iter; left time: 64639.2128s
	iters: 1400, epoch: 1 | loss: 0.9897792
	speed: 0.1727s/iter; left time: 64537.5068s
	iters: 1500, epoch: 1 | loss: 0.8207256
	speed: 0.1725s/iter; left time: 64472.7278s
	iters: 1600, epoch: 1 | loss: 0.9303336
	speed: 0.1722s/iter; left time: 64339.2808s
	iters: 1700, epoch: 1 | loss: 0.7902895
	speed: 0.1725s/iter; left time: 64436.2931s
	iters: 1800, epoch: 1 | loss: 0.8333449
	speed: 0.1723s/iter; left time: 64321.0666s
Epoch: 1 cost time: 323.9512052536011
Epoch: 1, Steps: 1876 | Train Loss: 0.9901799 Vali Loss: 1.1235498 Test Loss: 1.4657285
Validation loss decreased (inf --> 1.123550).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7105169
	speed: 1.5690s/iter; left time: 585587.6272s
	iters: 200, epoch: 2 | loss: 0.7678809
	speed: 0.1717s/iter; left time: 64072.1992s
	iters: 300, epoch: 2 | loss: 0.8908312
	speed: 0.1722s/iter; left time: 64229.9576s
	iters: 400, epoch: 2 | loss: 0.7162625
	speed: 0.1722s/iter; left time: 64224.4469s
	iters: 500, epoch: 2 | loss: 0.8397703
	speed: 0.1720s/iter; left time: 64107.3767s
	iters: 600, epoch: 2 | loss: 0.7795345
	speed: 0.1715s/iter; left time: 63938.1273s
	iters: 700, epoch: 2 | loss: 0.8242826
	speed: 0.1718s/iter; left time: 64033.9740s
	iters: 800, epoch: 2 | loss: 0.7525207
	speed: 0.1720s/iter; left time: 64080.6790s
	iters: 900, epoch: 2 | loss: 0.8603384
	speed: 0.1721s/iter; left time: 64095.5928s
	iters: 1000, epoch: 2 | loss: 0.7400368
	speed: 0.1723s/iter; left time: 64166.7354s
	iters: 1100, epoch: 2 | loss: 0.7420365
	speed: 0.1721s/iter; left time: 64061.7659s
	iters: 1200, epoch: 2 | loss: 0.7057347
	speed: 0.1718s/iter; left time: 63917.8034s
	iters: 1300, epoch: 2 | loss: 0.7025827
	speed: 0.1719s/iter; left time: 63938.3998s
	iters: 1400, epoch: 2 | loss: 0.7609206
	speed: 0.1718s/iter; left time: 63911.9707s
	iters: 1500, epoch: 2 | loss: 0.7850345
	speed: 0.1719s/iter; left time: 63927.1855s
	iters: 1600, epoch: 2 | loss: 0.7545770
	speed: 0.1707s/iter; left time: 63447.0132s
	iters: 1700, epoch: 2 | loss: 0.9063419
	speed: 0.1685s/iter; left time: 62602.4429s
	iters: 1800, epoch: 2 | loss: 0.7159262
	speed: 0.1685s/iter; left time: 62604.4990s
Epoch: 2 cost time: 321.56910705566406
Epoch: 2, Steps: 1876 | Train Loss: 0.7935195 Vali Loss: 1.0173213 Test Loss: 1.2212484
Validation loss decreased (1.123550 --> 1.017321).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7303328
	speed: 1.5646s/iter; left time: 581015.6505s
	iters: 200, epoch: 3 | loss: 0.6796946
	speed: 0.1686s/iter; left time: 62603.2335s
	iters: 300, epoch: 3 | loss: 0.6750970
	speed: 0.1685s/iter; left time: 62557.1030s
	iters: 400, epoch: 3 | loss: 0.6910225
	speed: 0.1684s/iter; left time: 62493.8968s
	iters: 500, epoch: 3 | loss: 0.6928222
	speed: 0.1694s/iter; left time: 62827.0167s
	iters: 600, epoch: 3 | loss: 0.6369037
	speed: 0.1686s/iter; left time: 62520.3559s
	iters: 700, epoch: 3 | loss: 0.6131198
	speed: 0.1688s/iter; left time: 62586.8363s
	iters: 800, epoch: 3 | loss: 0.7838767
	speed: 0.1688s/iter; left time: 62556.0616s
	iters: 900, epoch: 3 | loss: 0.6220140
	speed: 0.1685s/iter; left time: 62428.2758s
	iters: 1000, epoch: 3 | loss: 0.7773852
	speed: 0.1683s/iter; left time: 62363.0226s
	iters: 1100, epoch: 3 | loss: 0.6104832
	speed: 0.1693s/iter; left time: 62701.4687s
	iters: 1200, epoch: 3 | loss: 0.6359721
	speed: 0.1691s/iter; left time: 62614.9420s
	iters: 1300, epoch: 3 | loss: 0.6241165
	speed: 0.1725s/iter; left time: 63850.3398s
	iters: 1400, epoch: 3 | loss: 0.7081119
	speed: 0.1722s/iter; left time: 63739.7065s
	iters: 1500, epoch: 3 | loss: 0.6076456
	speed: 0.1721s/iter; left time: 63671.0464s
	iters: 1600, epoch: 3 | loss: 0.6742423
	speed: 0.1723s/iter; left time: 63728.4561s
	iters: 1700, epoch: 3 | loss: 0.6322565
	speed: 0.1721s/iter; left time: 63628.9087s
	iters: 1800, epoch: 3 | loss: 0.6246328
	speed: 0.1721s/iter; left time: 63611.4603s
Epoch: 3 cost time: 319.0747892856598
Epoch: 3, Steps: 1876 | Train Loss: 0.6756374 Vali Loss: 1.1288817 Test Loss: 1.3291970
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.5914378
	speed: 1.5663s/iter; left time: 578710.4158s
	iters: 200, epoch: 4 | loss: 0.6465638
	speed: 0.1692s/iter; left time: 62480.2900s
	iters: 300, epoch: 4 | loss: 0.6623034
	speed: 0.1693s/iter; left time: 62525.6131s
	iters: 400, epoch: 4 | loss: 0.6292549
	speed: 0.1692s/iter; left time: 62464.8077s
	iters: 500, epoch: 4 | loss: 0.6390339
	speed: 0.1693s/iter; left time: 62493.4736s
	iters: 600, epoch: 4 | loss: 0.6187129
	speed: 0.1683s/iter; left time: 62104.0206s
	iters: 700, epoch: 4 | loss: 0.6545377
	speed: 0.1694s/iter; left time: 62484.7083s
	iters: 800, epoch: 4 | loss: 0.6149644
	speed: 0.1690s/iter; left time: 62324.1786s
	iters: 900, epoch: 4 | loss: 0.5518178
	speed: 0.1718s/iter; left time: 63325.7712s
	iters: 1000, epoch: 4 | loss: 0.6259320
	speed: 0.1720s/iter; left time: 63388.6290s
	iters: 1100, epoch: 4 | loss: 0.6309059
	speed: 0.1720s/iter; left time: 63359.8422s
	iters: 1200, epoch: 4 | loss: 0.5707480
	speed: 0.1721s/iter; left time: 63398.1519s
	iters: 1300, epoch: 4 | loss: 0.6246210
	speed: 0.1721s/iter; left time: 63377.9633s
	iters: 1400, epoch: 4 | loss: 0.6846513
	speed: 0.1723s/iter; left time: 63442.8467s
	iters: 1500, epoch: 4 | loss: 0.6290073
	speed: 0.1725s/iter; left time: 63509.0036s
	iters: 1600, epoch: 4 | loss: 0.6018184
	speed: 0.1722s/iter; left time: 63382.1215s
	iters: 1700, epoch: 4 | loss: 0.5939539
	speed: 0.1720s/iter; left time: 63265.0161s
	iters: 1800, epoch: 4 | loss: 0.5710977
	speed: 0.1720s/iter; left time: 63256.0381s
Epoch: 4 cost time: 320.52186346054077
Epoch: 4, Steps: 1876 | Train Loss: 0.6281471 Vali Loss: 0.9905756 Test Loss: 1.1290616
Validation loss decreased (1.017321 --> 0.990576).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.6023086
	speed: 1.5751s/iter; left time: 578989.5974s
	iters: 200, epoch: 5 | loss: 0.5891955
	speed: 0.1720s/iter; left time: 63217.2068s
	iters: 300, epoch: 5 | loss: 0.6276001
	speed: 0.1721s/iter; left time: 63222.3316s
	iters: 400, epoch: 5 | loss: 0.6094167
	speed: 0.1721s/iter; left time: 63215.1319s
	iters: 500, epoch: 5 | loss: 0.5787969
	speed: 0.1721s/iter; left time: 63186.1320s
	iters: 600, epoch: 5 | loss: 0.6049081
	speed: 0.1723s/iter; left time: 63251.7768s
	iters: 700, epoch: 5 | loss: 0.6050828
	speed: 0.1720s/iter; left time: 63136.0464s
	iters: 800, epoch: 5 | loss: 0.6168269
	speed: 0.1724s/iter; left time: 63238.5141s
	iters: 900, epoch: 5 | loss: 0.5938219
	speed: 0.1721s/iter; left time: 63136.7582s
	iters: 1000, epoch: 5 | loss: 0.6106521
	speed: 0.1721s/iter; left time: 63121.4931s
	iters: 1100, epoch: 5 | loss: 0.6415141
	speed: 0.1722s/iter; left time: 63120.9430s
	iters: 1200, epoch: 5 | loss: 0.5935379
	speed: 0.1722s/iter; left time: 63106.1297s
	iters: 1300, epoch: 5 | loss: 0.6495664
	speed: 0.1720s/iter; left time: 63002.2155s
	iters: 1400, epoch: 5 | loss: 0.5813575
	speed: 0.1718s/iter; left time: 62927.9297s
	iters: 1500, epoch: 5 | loss: 0.5904394
	speed: 0.1724s/iter; left time: 63141.2578s
	iters: 1600, epoch: 5 | loss: 0.5817059
	speed: 0.1721s/iter; left time: 62990.1456s
	iters: 1700, epoch: 5 | loss: 0.6696458
	speed: 0.1723s/iter; left time: 63050.6959s
	iters: 1800, epoch: 5 | loss: 0.5682233
	speed: 0.1719s/iter; left time: 62912.4645s
Epoch: 5 cost time: 323.0847499370575
Epoch: 5, Steps: 1876 | Train Loss: 0.6061729 Vali Loss: 1.1419487 Test Loss: 1.4051197
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.5777874
	speed: 1.5707s/iter; left time: 574454.1726s
	iters: 200, epoch: 6 | loss: 0.6320454
	speed: 0.1723s/iter; left time: 62981.6174s
	iters: 300, epoch: 6 | loss: 0.5823906
	speed: 0.1720s/iter; left time: 62887.3588s
	iters: 400, epoch: 6 | loss: 0.6299523
	speed: 0.1725s/iter; left time: 63031.7395s
	iters: 500, epoch: 6 | loss: 0.5203354
	speed: 0.1721s/iter; left time: 62878.5223s
	iters: 600, epoch: 6 | loss: 0.6213266
	speed: 0.1724s/iter; left time: 62947.7302s
	iters: 700, epoch: 6 | loss: 0.5676632
	speed: 0.1721s/iter; left time: 62844.9970s
	iters: 800, epoch: 6 | loss: 0.5911176
	speed: 0.1726s/iter; left time: 63009.0324s
	iters: 900, epoch: 6 | loss: 0.5972636
	speed: 0.1723s/iter; left time: 62866.0917s
	iters: 1000, epoch: 6 | loss: 0.6170528
	speed: 0.1728s/iter; left time: 63032.5968s
	iters: 1100, epoch: 6 | loss: 0.5983095
	speed: 0.1724s/iter; left time: 62888.3482s
	iters: 1200, epoch: 6 | loss: 0.5749593
	speed: 0.1724s/iter; left time: 62844.4484s
	iters: 1300, epoch: 6 | loss: 0.5596616
	speed: 0.1724s/iter; left time: 62842.3741s
	iters: 1400, epoch: 6 | loss: 0.5662850
	speed: 0.1723s/iter; left time: 62803.2246s
	iters: 1500, epoch: 6 | loss: 0.5478670
	speed: 0.1722s/iter; left time: 62746.9739s
	iters: 1600, epoch: 6 | loss: 0.5846447
	speed: 0.1724s/iter; left time: 62795.5517s
	iters: 1700, epoch: 6 | loss: 0.5719401
	speed: 0.1721s/iter; left time: 62648.3504s
	iters: 1800, epoch: 6 | loss: 0.5759081
	speed: 0.1725s/iter; left time: 62803.0218s
Epoch: 6 cost time: 323.4279363155365
Epoch: 6, Steps: 1876 | Train Loss: 0.5950290 Vali Loss: 0.9569020 Test Loss: 1.0698507
Validation loss decreased (0.990576 --> 0.956902).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.5816863
	speed: 1.5746s/iter; left time: 572905.6805s
	iters: 200, epoch: 7 | loss: 0.5894026
	speed: 0.1722s/iter; left time: 62626.2655s
	iters: 300, epoch: 7 | loss: 0.5793008
	speed: 0.1720s/iter; left time: 62558.9741s
	iters: 400, epoch: 7 | loss: 0.5907966
	speed: 0.1720s/iter; left time: 62525.4107s
	iters: 500, epoch: 7 | loss: 0.5669616
	speed: 0.1720s/iter; left time: 62527.5838s
	iters: 600, epoch: 7 | loss: 0.5604436
	speed: 0.1720s/iter; left time: 62509.4840s
	iters: 700, epoch: 7 | loss: 0.6120567
	speed: 0.1722s/iter; left time: 62559.2096s
	iters: 800, epoch: 7 | loss: 0.5440857
	speed: 0.1727s/iter; left time: 62726.3112s
	iters: 900, epoch: 7 | loss: 0.6502392
	speed: 0.1721s/iter; left time: 62481.3075s
	iters: 1000, epoch: 7 | loss: 0.5633941
	speed: 0.1723s/iter; left time: 62521.1829s
	iters: 1100, epoch: 7 | loss: 0.6096736
	speed: 0.1721s/iter; left time: 62453.7669s
	iters: 1200, epoch: 7 | loss: 0.5605043
	speed: 0.1719s/iter; left time: 62371.5282s
	iters: 1300, epoch: 7 | loss: 0.6906322
	speed: 0.1722s/iter; left time: 62453.4297s
	iters: 1400, epoch: 7 | loss: 0.5800769
	speed: 0.1720s/iter; left time: 62375.1876s
	iters: 1500, epoch: 7 | loss: 0.5533928
	speed: 0.1725s/iter; left time: 62512.0859s
	iters: 1600, epoch: 7 | loss: 0.5400515
	speed: 0.1724s/iter; left time: 62484.6273s
	iters: 1700, epoch: 7 | loss: 0.5352960
	speed: 0.1723s/iter; left time: 62398.6485s
	iters: 1800, epoch: 7 | loss: 0.5767960
	speed: 0.1719s/iter; left time: 62260.8868s
Epoch: 7 cost time: 323.1100947856903
Epoch: 7, Steps: 1876 | Train Loss: 0.5786504 Vali Loss: 1.0251958 Test Loss: 1.1377956
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 8 | loss: 0.5422960
	speed: 1.5684s/iter; left time: 567712.3648s
	iters: 200, epoch: 8 | loss: 0.5892411
	speed: 0.1724s/iter; left time: 62389.9324s
	iters: 300, epoch: 8 | loss: 0.5702983
	speed: 0.1725s/iter; left time: 62407.7763s
	iters: 400, epoch: 8 | loss: 0.5414279
	speed: 0.1723s/iter; left time: 62322.8223s
	iters: 500, epoch: 8 | loss: 0.6002709
	speed: 0.1722s/iter; left time: 62273.9204s
	iters: 600, epoch: 8 | loss: 0.5164254
	speed: 0.1721s/iter; left time: 62192.9345s
	iters: 700, epoch: 8 | loss: 0.5871807
	speed: 0.1722s/iter; left time: 62240.0503s
	iters: 800, epoch: 8 | loss: 0.5918483
	speed: 0.1723s/iter; left time: 62262.9228s
	iters: 900, epoch: 8 | loss: 0.5347021
	speed: 0.1721s/iter; left time: 62169.3910s
	iters: 1000, epoch: 8 | loss: 0.5633580
	speed: 0.1725s/iter; left time: 62271.1789s
	iters: 1100, epoch: 8 | loss: 0.5222833
	speed: 0.1727s/iter; left time: 62323.6641s
	iters: 1200, epoch: 8 | loss: 0.5456889
	speed: 0.1721s/iter; left time: 62094.0853s
	iters: 1300, epoch: 8 | loss: 0.5809888
	speed: 0.1721s/iter; left time: 62092.5941s
	iters: 1400, epoch: 8 | loss: 0.5932999
	speed: 0.1723s/iter; left time: 62130.8974s
	iters: 1500, epoch: 8 | loss: 0.5574082
	speed: 0.1721s/iter; left time: 62065.2030s
	iters: 1600, epoch: 8 | loss: 0.6048028
	speed: 0.1721s/iter; left time: 62035.3795s
	iters: 1700, epoch: 8 | loss: 0.5727981
	speed: 0.1721s/iter; left time: 62016.3149s
	iters: 1800, epoch: 8 | loss: 0.5805050
	speed: 0.1721s/iter; left time: 62015.5701s
Epoch: 8 cost time: 323.26081371307373
Epoch: 8, Steps: 1876 | Train Loss: 0.5713521 Vali Loss: 0.9539392 Test Loss: 1.1007905
Validation loss decreased (0.956902 --> 0.953939).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5464176
	speed: 1.5674s/iter; left time: 564427.5818s
	iters: 200, epoch: 9 | loss: 0.5638426
	speed: 0.1689s/iter; left time: 60792.0749s
	iters: 300, epoch: 9 | loss: 0.5781558
	speed: 0.1692s/iter; left time: 60907.8186s
	iters: 400, epoch: 9 | loss: 0.5394298
	speed: 0.1704s/iter; left time: 61318.0807s
	iters: 500, epoch: 9 | loss: 0.6307551
	speed: 0.1724s/iter; left time: 61995.3384s
	iters: 600, epoch: 9 | loss: 0.5334829
	speed: 0.1722s/iter; left time: 61912.1702s
	iters: 700, epoch: 9 | loss: 0.5810704
	speed: 0.1722s/iter; left time: 61919.5062s
	iters: 800, epoch: 9 | loss: 0.5443005
	speed: 0.1720s/iter; left time: 61808.2340s
	iters: 900, epoch: 9 | loss: 0.5365034
	speed: 0.1723s/iter; left time: 61912.0672s
	iters: 1000, epoch: 9 | loss: 0.5272664
	speed: 0.1723s/iter; left time: 61878.7682s
	iters: 1100, epoch: 9 | loss: 0.5876683
	speed: 0.1725s/iter; left time: 61955.0868s
	iters: 1200, epoch: 9 | loss: 0.5700651
	speed: 0.1724s/iter; left time: 61884.9711s
	iters: 1300, epoch: 9 | loss: 0.5091272
	speed: 0.1721s/iter; left time: 61749.0464s
	iters: 1400, epoch: 9 | loss: 0.5546921
	speed: 0.1721s/iter; left time: 61763.4242s
	iters: 1500, epoch: 9 | loss: 0.5325744
	speed: 0.1720s/iter; left time: 61692.7110s
	iters: 1600, epoch: 9 | loss: 0.5143093
	speed: 0.1720s/iter; left time: 61695.6774s
	iters: 1700, epoch: 9 | loss: 0.6238504
	speed: 0.1721s/iter; left time: 61712.9158s
	iters: 1800, epoch: 9 | loss: 0.5429467
	speed: 0.1718s/iter; left time: 61572.4876s
Epoch: 9 cost time: 321.96012806892395
Epoch: 9, Steps: 1876 | Train Loss: 0.5605993 Vali Loss: 0.9254602 Test Loss: 1.0912514
Validation loss decreased (0.953939 --> 0.925460).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.5366457
	speed: 1.5728s/iter; left time: 563390.6262s
	iters: 200, epoch: 10 | loss: 0.5654500
	speed: 0.1719s/iter; left time: 61565.7001s
	iters: 300, epoch: 10 | loss: 0.5253268
	speed: 0.1720s/iter; left time: 61586.8889s
	iters: 400, epoch: 10 | loss: 0.5582529
	speed: 0.1722s/iter; left time: 61626.3801s
	iters: 500, epoch: 10 | loss: 0.5646958
	speed: 0.1721s/iter; left time: 61579.1422s
	iters: 600, epoch: 10 | loss: 0.5725618
	speed: 0.1721s/iter; left time: 61565.3952s
	iters: 700, epoch: 10 | loss: 0.5196452
	speed: 0.1722s/iter; left time: 61578.3777s
	iters: 800, epoch: 10 | loss: 0.5584596
	speed: 0.1721s/iter; left time: 61520.7529s
	iters: 900, epoch: 10 | loss: 0.5579384
	speed: 0.1721s/iter; left time: 61505.6320s
	iters: 1000, epoch: 10 | loss: 0.4896448
	speed: 0.1719s/iter; left time: 61410.4381s
	iters: 1100, epoch: 10 | loss: 0.5518277
	speed: 0.1720s/iter; left time: 61454.0797s
	iters: 1200, epoch: 10 | loss: 0.4964448
	speed: 0.1744s/iter; left time: 62277.6784s
	iters: 1300, epoch: 10 | loss: 0.4673173
	speed: 0.1737s/iter; left time: 62003.0423s
	iters: 1400, epoch: 10 | loss: 0.5115088
	speed: 0.1720s/iter; left time: 61383.2467s
	iters: 1500, epoch: 10 | loss: 0.5619053
	speed: 0.1724s/iter; left time: 61526.9193s
	iters: 1600, epoch: 10 | loss: 0.5325466
	speed: 0.1720s/iter; left time: 61354.8496s
	iters: 1700, epoch: 10 | loss: 0.6354229
	speed: 0.1725s/iter; left time: 61514.4829s
	iters: 1800, epoch: 10 | loss: 0.5845109
	speed: 0.1722s/iter; left time: 61407.5701s
Epoch: 10 cost time: 323.42581844329834
Epoch: 10, Steps: 1876 | Train Loss: 0.5518655 Vali Loss: 0.9441085 Test Loss: 1.0778960
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 11 | loss: 0.5196480
	speed: 1.5721s/iter; left time: 560214.6917s
	iters: 200, epoch: 11 | loss: 0.5186527
	speed: 0.1722s/iter; left time: 61334.7613s
	iters: 300, epoch: 11 | loss: 0.5306558
	speed: 0.1720s/iter; left time: 61258.9048s
	iters: 400, epoch: 11 | loss: 0.5162347
	speed: 0.1717s/iter; left time: 61142.0546s
	iters: 500, epoch: 11 | loss: 0.5890124
	speed: 0.1717s/iter; left time: 61110.1513s
	iters: 600, epoch: 11 | loss: 0.5280827
	speed: 0.1720s/iter; left time: 61189.2013s
	iters: 700, epoch: 11 | loss: 0.5775183
	speed: 0.1721s/iter; left time: 61239.5983s
	iters: 800, epoch: 11 | loss: 0.5520681
	speed: 0.1722s/iter; left time: 61232.7222s
	iters: 900, epoch: 11 | loss: 0.5296469
	speed: 0.1717s/iter; left time: 61037.0977s
	iters: 1000, epoch: 11 | loss: 0.5017708
	speed: 0.1722s/iter; left time: 61202.5599s
	iters: 1100, epoch: 11 | loss: 0.5424801
	speed: 0.1719s/iter; left time: 61100.3129s
	iters: 1200, epoch: 11 | loss: 0.5346517
	speed: 0.1719s/iter; left time: 61052.7486s
	iters: 1300, epoch: 11 | loss: 0.5178523
	speed: 0.1717s/iter; left time: 60969.2478s
	iters: 1400, epoch: 11 | loss: 0.5145835
	speed: 0.1719s/iter; left time: 61043.6003s
	iters: 1500, epoch: 11 | loss: 0.4889006
	speed: 0.1718s/iter; left time: 60994.4739s
	iters: 1600, epoch: 11 | loss: 0.4829346
	speed: 0.1720s/iter; left time: 61038.0116s
	iters: 1700, epoch: 11 | loss: 0.5689203
	speed: 0.1724s/iter; left time: 61153.9019s
	iters: 1800, epoch: 11 | loss: 0.5490808
	speed: 0.1719s/iter; left time: 60950.1500s
Epoch: 11 cost time: 322.7430229187012
Epoch: 11, Steps: 1876 | Train Loss: 0.5442882 Vali Loss: 1.1490970 Test Loss: 1.3654679
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 12 | loss: 0.5588199
	speed: 1.5687s/iter; left time: 556046.0565s
	iters: 200, epoch: 12 | loss: 0.9992774
	speed: 0.1685s/iter; left time: 59725.3964s
	iters: 300, epoch: 12 | loss: 0.5050782
	speed: 0.1683s/iter; left time: 59613.8478s
	iters: 400, epoch: 12 | loss: 0.5088980
	speed: 0.1696s/iter; left time: 60079.4739s
	iters: 500, epoch: 12 | loss: 0.5029733
	speed: 0.1685s/iter; left time: 59650.2005s
	iters: 600, epoch: 12 | loss: 0.5899779
	speed: 0.1688s/iter; left time: 59736.6395s
	iters: 700, epoch: 12 | loss: 0.5295214
	speed: 0.1683s/iter; left time: 59543.0088s
	iters: 800, epoch: 12 | loss: 0.5719686
	speed: 0.1687s/iter; left time: 59678.4918s
	iters: 900, epoch: 12 | loss: 0.5333965
	speed: 0.1687s/iter; left time: 59662.5431s
	iters: 1000, epoch: 12 | loss: 0.5264277
	speed: 0.1694s/iter; left time: 59889.6315s
	iters: 1100, epoch: 12 | loss: 0.5347299
	speed: 0.1686s/iter; left time: 59593.3011s
	iters: 1200, epoch: 12 | loss: 0.5109358
	speed: 0.1686s/iter; left time: 59586.1856s
	iters: 1300, epoch: 12 | loss: 0.5575959
	speed: 0.1687s/iter; left time: 59580.5831s
	iters: 1400, epoch: 12 | loss: 0.4702431
	speed: 0.1689s/iter; left time: 59666.7190s
	iters: 1500, epoch: 12 | loss: 0.5218133
	speed: 0.1680s/iter; left time: 59310.2126s
	iters: 1600, epoch: 12 | loss: 0.5698494
	speed: 0.1685s/iter; left time: 59467.5215s
	iters: 1700, epoch: 12 | loss: 0.5158314
	speed: 0.1684s/iter; left time: 59420.1917s
	iters: 1800, epoch: 12 | loss: 0.5241175
	speed: 0.1683s/iter; left time: 59361.8815s
Epoch: 12 cost time: 316.3708357810974
Epoch: 12, Steps: 1876 | Train Loss: 0.5342847 Vali Loss: 1.0264955 Test Loss: 1.2315878
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 13 | loss: 0.5457454
	speed: 1.5674s/iter; left time: 552640.2295s
	iters: 200, epoch: 13 | loss: 0.5182522
	speed: 0.1725s/iter; left time: 60806.0610s
	iters: 300, epoch: 13 | loss: 0.5234784
	speed: 0.1724s/iter; left time: 60744.3677s
	iters: 400, epoch: 13 | loss: 0.5032585
	speed: 0.1722s/iter; left time: 60676.8168s
	iters: 500, epoch: 13 | loss: 0.5216258
	speed: 0.1725s/iter; left time: 60761.5132s
	iters: 600, epoch: 13 | loss: 0.5115620
	speed: 0.1725s/iter; left time: 60723.6322s
	iters: 700, epoch: 13 | loss: 0.5456715
	speed: 0.1723s/iter; left time: 60640.0999s
	iters: 800, epoch: 13 | loss: 0.6897903
	speed: 0.1724s/iter; left time: 60651.7653s
	iters: 900, epoch: 13 | loss: 0.4957084
	speed: 0.1722s/iter; left time: 60589.7326s
	iters: 1000, epoch: 13 | loss: 0.5299843
	speed: 0.1723s/iter; left time: 60588.6813s
	iters: 1100, epoch: 13 | loss: 0.5249491
	speed: 0.1723s/iter; left time: 60570.1491s
	iters: 1200, epoch: 13 | loss: 0.5220431
	speed: 0.1724s/iter; left time: 60610.4010s
	iters: 1300, epoch: 13 | loss: 0.5520025
	speed: 0.1723s/iter; left time: 60551.3671s
	iters: 1400, epoch: 13 | loss: 0.5171966
	speed: 0.1720s/iter; left time: 60435.3994s
	iters: 1500, epoch: 13 | loss: 0.5342532
	speed: 0.1726s/iter; left time: 60614.4896s
	iters: 1600, epoch: 13 | loss: 0.5527829
	speed: 0.1733s/iter; left time: 60832.0272s
	iters: 1700, epoch: 13 | loss: 0.4983229
	speed: 0.1722s/iter; left time: 60440.3302s
	iters: 1800, epoch: 13 | loss: 0.6761581
	speed: 0.1728s/iter; left time: 60617.0397s
Epoch: 13 cost time: 323.5122561454773
Epoch: 13, Steps: 1876 | Train Loss: 0.5279883 Vali Loss: 0.9286362 Test Loss: 1.1066988
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 14 | loss: 0.5051103
	speed: 1.5734s/iter; left time: 551812.8942s
	iters: 200, epoch: 14 | loss: 0.5360250
	speed: 0.1721s/iter; left time: 60328.2026s
	iters: 300, epoch: 14 | loss: 0.5379677
	speed: 0.1723s/iter; left time: 60384.7899s
	iters: 400, epoch: 14 | loss: 0.6753883
	speed: 0.1724s/iter; left time: 60426.0480s
	iters: 500, epoch: 14 | loss: 0.5075839
	speed: 0.1721s/iter; left time: 60298.8925s
	iters: 600, epoch: 14 | loss: 0.5311334
	speed: 0.1722s/iter; left time: 60303.7087s
	iters: 700, epoch: 14 | loss: 0.5069530
	speed: 0.1720s/iter; left time: 60221.1323s
	iters: 800, epoch: 14 | loss: 0.5614613
	speed: 0.1724s/iter; left time: 60343.6232s
	iters: 900, epoch: 14 | loss: 0.5204881
	speed: 0.1722s/iter; left time: 60243.8280s
	iters: 1000, epoch: 14 | loss: 0.5247203
	speed: 0.1725s/iter; left time: 60340.4815s
	iters: 1100, epoch: 14 | loss: 0.5833775
	speed: 0.1722s/iter; left time: 60215.7236s
	iters: 1200, epoch: 14 | loss: 0.4729511
	speed: 0.1720s/iter; left time: 60119.3568s
	iters: 1300, epoch: 14 | loss: 0.4743677
	speed: 0.1721s/iter; left time: 60137.7929s
	iters: 1400, epoch: 14 | loss: 0.5081184
	speed: 0.1724s/iter; left time: 60255.3376s
	iters: 1500, epoch: 14 | loss: 0.4907647
	speed: 0.1724s/iter; left time: 60235.3695s
	iters: 1600, epoch: 14 | loss: 0.5728391
	speed: 0.1721s/iter; left time: 60095.0923s
	iters: 1700, epoch: 14 | loss: 0.5156938
	speed: 0.1728s/iter; left time: 60315.9773s
	iters: 1800, epoch: 14 | loss: 0.4889696
	speed: 0.1722s/iter; left time: 60105.8810s
Epoch: 14 cost time: 323.28036403656006
Epoch: 14, Steps: 1876 | Train Loss: 0.5188053 Vali Loss: 0.9197919 Test Loss: 1.0709031
Validation loss decreased (0.925460 --> 0.919792).  Saving model ...
	iters: 100, epoch: 15 | loss: 0.5021809
	speed: 1.5637s/iter; left time: 545473.7118s
	iters: 200, epoch: 15 | loss: 0.4722003
	speed: 0.1686s/iter; left time: 58793.5707s
	iters: 300, epoch: 15 | loss: 0.5083967
	speed: 0.1688s/iter; left time: 58862.2504s
	iters: 400, epoch: 15 | loss: 0.4659627
	speed: 0.1684s/iter; left time: 58694.4773s
	iters: 500, epoch: 15 | loss: 0.4616630
	speed: 0.1683s/iter; left time: 58655.4970s
	iters: 600, epoch: 15 | loss: 0.6912963
	speed: 0.1684s/iter; left time: 58669.3858s
	iters: 700, epoch: 15 | loss: 0.5120242
	speed: 0.1682s/iter; left time: 58582.2673s
	iters: 800, epoch: 15 | loss: 0.5435677
	speed: 0.1688s/iter; left time: 58764.4611s
	iters: 900, epoch: 15 | loss: 0.5071228
	speed: 0.1684s/iter; left time: 58603.4959s
	iters: 1000, epoch: 15 | loss: 0.5307890
	speed: 0.1686s/iter; left time: 58672.5497s
	iters: 1100, epoch: 15 | loss: 0.5634578
	speed: 0.1686s/iter; left time: 58640.0866s
	iters: 1200, epoch: 15 | loss: 0.4893062
	speed: 0.1686s/iter; left time: 58628.7629s
	iters: 1300, epoch: 15 | loss: 0.5089371
	speed: 0.1688s/iter; left time: 58690.0583s
	iters: 1400, epoch: 15 | loss: 0.5244365
	speed: 0.1684s/iter; left time: 58533.1552s
	iters: 1500, epoch: 15 | loss: 0.4875192
	speed: 0.1682s/iter; left time: 58448.0581s
	iters: 1600, epoch: 15 | loss: 0.4882404
	speed: 0.1681s/iter; left time: 58385.8465s
	iters: 1700, epoch: 15 | loss: 0.4850346
	speed: 0.1689s/iter; left time: 58663.8739s
	iters: 1800, epoch: 15 | loss: 0.4976308
	speed: 0.1683s/iter; left time: 58424.4182s
Epoch: 15 cost time: 316.39588689804077
Epoch: 15, Steps: 1876 | Train Loss: 0.5122436 Vali Loss: 0.9290192 Test Loss: 1.0572293
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 16 | loss: 0.4414907
	speed: 1.5615s/iter; left time: 541769.4295s
	iters: 200, epoch: 16 | loss: 0.5289671
	speed: 0.1721s/iter; left time: 59678.4164s
	iters: 300, epoch: 16 | loss: 0.4905424
	speed: 0.1718s/iter; left time: 59573.4044s
	iters: 400, epoch: 16 | loss: 0.4973488
	speed: 0.1722s/iter; left time: 59694.9838s
	iters: 500, epoch: 16 | loss: 0.5203859
	speed: 0.1722s/iter; left time: 59678.6744s
	iters: 600, epoch: 16 | loss: 0.4570676
	speed: 0.1721s/iter; left time: 59622.6069s
	iters: 700, epoch: 16 | loss: 0.5166047
	speed: 0.1723s/iter; left time: 59693.7985s
	iters: 800, epoch: 16 | loss: 0.5046674
	speed: 0.1721s/iter; left time: 59578.8171s
	iters: 900, epoch: 16 | loss: 0.5032485
	speed: 0.1720s/iter; left time: 59549.2121s
	iters: 1000, epoch: 16 | loss: 0.4841861
	speed: 0.1723s/iter; left time: 59642.0008s
	iters: 1100, epoch: 16 | loss: 0.5167842
	speed: 0.1719s/iter; left time: 59478.1501s
	iters: 1200, epoch: 16 | loss: 0.4886672
	speed: 0.1721s/iter; left time: 59511.6657s
	iters: 1300, epoch: 16 | loss: 0.4779107
	speed: 0.1722s/iter; left time: 59537.4105s
	iters: 1400, epoch: 16 | loss: 0.5040570
	speed: 0.1720s/iter; left time: 59462.6800s
	iters: 1500, epoch: 16 | loss: 0.5115172
	speed: 0.1723s/iter; left time: 59526.7426s
	iters: 1600, epoch: 16 | loss: 0.4684475
	speed: 0.1723s/iter; left time: 59537.2000s
	iters: 1700, epoch: 16 | loss: 0.4571407
	speed: 0.1721s/iter; left time: 59435.1848s
	iters: 1800, epoch: 16 | loss: 0.5763066
	speed: 0.1722s/iter; left time: 59441.6330s
Epoch: 16 cost time: 323.03641271591187
Epoch: 16, Steps: 1876 | Train Loss: 0.5046482 Vali Loss: 0.9736582 Test Loss: 1.0769585
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 17 | loss: 0.5188207
	speed: 1.5708s/iter; left time: 542043.3532s
	iters: 200, epoch: 17 | loss: 0.4572002
	speed: 0.1748s/iter; left time: 60309.0451s
	iters: 300, epoch: 17 | loss: 0.5676781
	speed: 0.1725s/iter; left time: 59482.7640s
	iters: 400, epoch: 17 | loss: 0.6195130
	speed: 0.1724s/iter; left time: 59431.4215s
	iters: 500, epoch: 17 | loss: 0.4744466
	speed: 0.1722s/iter; left time: 59344.4756s
	iters: 600, epoch: 17 | loss: 0.5059457
	speed: 0.1722s/iter; left time: 59349.2196s
	iters: 700, epoch: 17 | loss: 0.4771954
	speed: 0.1720s/iter; left time: 59235.6591s
	iters: 800, epoch: 17 | loss: 0.5220727
	speed: 0.1722s/iter; left time: 59298.1345s
	iters: 900, epoch: 17 | loss: 0.5385610
	speed: 0.1725s/iter; left time: 59395.9032s
	iters: 1000, epoch: 17 | loss: 0.4753241
	speed: 0.1727s/iter; left time: 59444.7942s
	iters: 1100, epoch: 17 | loss: 0.4572966
	speed: 0.1724s/iter; left time: 59303.5104s
	iters: 1200, epoch: 17 | loss: 0.4490549
	speed: 0.1722s/iter; left time: 59250.1234s
	iters: 1300, epoch: 17 | loss: 0.4998136
	speed: 0.1721s/iter; left time: 59184.3755s
	iters: 1400, epoch: 17 | loss: 0.4829702
	speed: 0.1721s/iter; left time: 59178.2351s
	iters: 1500, epoch: 17 | loss: 0.4398795
	speed: 0.1723s/iter; left time: 59201.9304s
	iters: 1600, epoch: 17 | loss: 0.4910581
	speed: 0.1725s/iter; left time: 59273.5274s
	iters: 1700, epoch: 17 | loss: 0.4853344
	speed: 0.1722s/iter; left time: 59155.7233s
	iters: 1800, epoch: 17 | loss: 0.5109099
	speed: 0.1722s/iter; left time: 59134.7900s
Epoch: 17 cost time: 324.0124890804291
Epoch: 17, Steps: 1876 | Train Loss: 0.5032682 Vali Loss: 0.9376892 Test Loss: 1.0217371
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 18 | loss: 0.4520783
	speed: 1.5653s/iter; left time: 537241.7641s
	iters: 200, epoch: 18 | loss: 0.4941047
	speed: 0.1721s/iter; left time: 59065.7363s
	iters: 300, epoch: 18 | loss: 0.4934738
	speed: 0.1721s/iter; left time: 59033.7545s
	iters: 400, epoch: 18 | loss: 0.5141585
	speed: 0.1720s/iter; left time: 58983.4704s
	iters: 500, epoch: 18 | loss: 0.5127919
	speed: 0.1717s/iter; left time: 58860.6284s
	iters: 600, epoch: 18 | loss: 0.4962569
	speed: 0.1720s/iter; left time: 58954.5128s
	iters: 700, epoch: 18 | loss: 0.5116627
	speed: 0.1718s/iter; left time: 58849.7324s
	iters: 800, epoch: 18 | loss: 0.4677911
	speed: 0.1720s/iter; left time: 58923.4175s
	iters: 900, epoch: 18 | loss: 0.5295287
	speed: 0.1715s/iter; left time: 58724.1651s
	iters: 1000, epoch: 18 | loss: 0.5066858
	speed: 0.1719s/iter; left time: 58831.0165s
	iters: 1100, epoch: 18 | loss: 0.4721945
	speed: 0.1719s/iter; left time: 58832.4780s
	iters: 1200, epoch: 18 | loss: 0.5037403
	speed: 0.1719s/iter; left time: 58823.3479s
	iters: 1300, epoch: 18 | loss: 0.4819063
	speed: 0.1718s/iter; left time: 58750.0752s
	iters: 1400, epoch: 18 | loss: 0.4836114
	speed: 0.1724s/iter; left time: 58929.3559s
	iters: 1500, epoch: 18 | loss: 0.4770432
	speed: 0.1717s/iter; left time: 58693.3884s
	iters: 1600, epoch: 18 | loss: 0.4661702
	speed: 0.1720s/iter; left time: 58766.8350s
	iters: 1700, epoch: 18 | loss: 0.5274695
	speed: 0.1717s/iter; left time: 58646.8597s
	iters: 1800, epoch: 18 | loss: 0.4730111
	speed: 0.1717s/iter; left time: 58649.5279s
Epoch: 18 cost time: 322.6866805553436
Epoch: 18, Steps: 1876 | Train Loss: 0.4952490 Vali Loss: 0.9608361 Test Loss: 1.0931112
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 19 | loss: 0.4630781
	speed: 1.5610s/iter; left time: 532829.0321s
	iters: 200, epoch: 19 | loss: 0.4746127
	speed: 0.1677s/iter; left time: 57216.6954s
	iters: 300, epoch: 19 | loss: 0.4844225
	speed: 0.1686s/iter; left time: 57521.3113s
	iters: 400, epoch: 19 | loss: 0.4672944
	speed: 0.1678s/iter; left time: 57238.0946s
	iters: 500, epoch: 19 | loss: 0.4358202
	speed: 0.1680s/iter; left time: 57284.3781s
	iters: 600, epoch: 19 | loss: 0.4796299
	speed: 0.1682s/iter; left time: 57317.5846s
	iters: 700, epoch: 19 | loss: 0.5001736
	speed: 0.1689s/iter; left time: 57548.7488s
	iters: 800, epoch: 19 | loss: 0.4719144
	speed: 0.1683s/iter; left time: 57332.6934s
	iters: 900, epoch: 19 | loss: 0.4626526
	speed: 0.1676s/iter; left time: 57068.7955s
	iters: 1000, epoch: 19 | loss: 0.5325069
	speed: 0.1683s/iter; left time: 57283.6257s
	iters: 1100, epoch: 19 | loss: 0.4808107
	speed: 0.1706s/iter; left time: 58057.2588s
	iters: 1200, epoch: 19 | loss: 0.4425365
	speed: 0.1720s/iter; left time: 58524.5214s
	iters: 1300, epoch: 19 | loss: 0.4675690
	speed: 0.1721s/iter; left time: 58552.1635s
	iters: 1400, epoch: 19 | loss: 0.5134591
	speed: 0.1719s/iter; left time: 58465.5205s
	iters: 1500, epoch: 19 | loss: 0.4773074
	speed: 0.1719s/iter; left time: 58445.4558s
	iters: 1600, epoch: 19 | loss: 0.4660817
	speed: 0.1721s/iter; left time: 58479.9395s
	iters: 1700, epoch: 19 | loss: 0.4643018
	speed: 0.1689s/iter; left time: 57395.2797s
	iters: 1800, epoch: 19 | loss: 0.4830353
	speed: 0.1680s/iter; left time: 57063.7416s
Epoch: 19 cost time: 317.83044385910034
Epoch: 19, Steps: 1876 | Train Loss: 0.4912485 Vali Loss: 0.9906729 Test Loss: 1.0885628
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 94771
test shape: (9477, 1, 336, 103) (9477, 1, 336, 103)
test shape: (9477, 336, 103) (9477, 336, 103)
mse:1.070905327796936, mae:0.7940738797187805
>>>>>>>Overall time: 8688 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
