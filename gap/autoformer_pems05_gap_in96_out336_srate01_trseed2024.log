Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 84, in train
    train_data, train_loader = self._get_data(flag='train')
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 31, in _get_data
    data_set, data_loader = data_provider(self.args, flag)
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_factory.py", line 104, in data_provider
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_loader.py", line 321, in __init__
    self.__read_data__()  
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_loader.py", line 325, in __read_data__
    df_raw = pd.read_csv(os.path.join(self.root_path,
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/util/_decorators.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/util/_decorators.py", line 331, in wrapper
    return func(*args, **kwargs)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 950, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 605, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1442, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1735, in _make_engine
    self.handles = get_handle(
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/common.py", line 856, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: '../../data/pems/pems05_all_common_flow.csv'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 779704
val 21011
test 147475
Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 146, in train
    outputs = self.model(batch_x, batch_x_mark, dec_inp, batch_y_mark)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/g/data/hn98/du/exlts/ddd2/models/Autoformer.py", line 147, in forward
    dec_out = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "/g/data/hn98/du/exlts/ddd2/models/Autoformer.py", line 102, in forecast
    enc_out = self.enc_embedding(x_enc, x_mark_enc)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/g/data/hn98/du/exlts/ddd2/layers/Embed.py", line 161, in forward
    x = self.value_embedding(x) + self.temporal_embedding(x_mark)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/g/data/hn98/du/exlts/ddd2/layers/Embed.py", line 41, in forward
    x = self.tokenConv(x.permute(0, 2, 1)).transpose(1, 2)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 255, in forward
    return F.conv1d(F.pad(input, self._reversed_padding_repeated_twice, mode=self.padding_mode),
RuntimeError: Given groups=1, weight of size [128, 103, 3], expected input[32, 104, 98] to have 103 channels, but got 104 channels instead
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 779704
val 21011
test 147475
	iters: 100, epoch: 1 | loss: 1.0846360
	speed: 0.1652s/iter; left time: 80466.7044s
	iters: 200, epoch: 1 | loss: 1.1076589
	speed: 0.1629s/iter; left time: 79328.5208s
	iters: 300, epoch: 1 | loss: 1.1339154
	speed: 0.1626s/iter; left time: 79178.7498s
	iters: 400, epoch: 1 | loss: 0.9674802
	speed: 0.1624s/iter; left time: 79058.1259s
	iters: 500, epoch: 1 | loss: 0.9767289
	speed: 0.1628s/iter; left time: 79235.7523s
	iters: 600, epoch: 1 | loss: 0.9922338
	speed: 0.1627s/iter; left time: 79171.5941s
	iters: 700, epoch: 1 | loss: 0.9483310
	speed: 0.1627s/iter; left time: 79146.7740s
	iters: 800, epoch: 1 | loss: 0.8806538
	speed: 0.1624s/iter; left time: 79014.4399s
	iters: 900, epoch: 1 | loss: 0.9867516
	speed: 0.1626s/iter; left time: 79092.8071s
	iters: 1000, epoch: 1 | loss: 0.8170150
	speed: 0.1624s/iter; left time: 78966.6931s
	iters: 1100, epoch: 1 | loss: 0.8474459
	speed: 0.1627s/iter; left time: 79088.3962s
	iters: 1200, epoch: 1 | loss: 0.8157870
	speed: 0.1631s/iter; left time: 79248.2709s
	iters: 1300, epoch: 1 | loss: 0.8012790
	speed: 0.1628s/iter; left time: 79104.0594s
	iters: 1400, epoch: 1 | loss: 0.8945957
	speed: 0.1623s/iter; left time: 78848.8949s
	iters: 1500, epoch: 1 | loss: 0.7725567
	speed: 0.1626s/iter; left time: 78994.0537s
	iters: 1600, epoch: 1 | loss: 0.7494217
	speed: 0.1628s/iter; left time: 79065.1985s
	iters: 1700, epoch: 1 | loss: 0.7817467
	speed: 0.1624s/iter; left time: 78847.0432s
	iters: 1800, epoch: 1 | loss: 0.8584893
	speed: 0.1627s/iter; left time: 78976.8130s
	iters: 1900, epoch: 1 | loss: 0.7382731
	speed: 0.1625s/iter; left time: 78855.1934s
	iters: 2000, epoch: 1 | loss: 0.7427177
	speed: 0.1627s/iter; left time: 78962.7429s
	iters: 2100, epoch: 1 | loss: 0.7507544
	speed: 0.1625s/iter; left time: 78841.2496s
	iters: 2200, epoch: 1 | loss: 0.7446727
	speed: 0.1624s/iter; left time: 78770.9177s
	iters: 2300, epoch: 1 | loss: 0.8150489
	speed: 0.1625s/iter; left time: 78800.5606s
	iters: 2400, epoch: 1 | loss: 0.7719498
	speed: 0.1625s/iter; left time: 78773.7186s
Epoch: 1 cost time: 396.65577840805054
Epoch: 1, Steps: 2436 | Train Loss: 0.9126374 Vali Loss: 1.1197312 Test Loss: 1.3950086
Validation loss decreased (inf --> 1.119731).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6908537
	speed: 2.0448s/iter; left time: 991025.1542s
	iters: 200, epoch: 2 | loss: 0.6752964
	speed: 0.1627s/iter; left time: 78860.0868s
	iters: 300, epoch: 2 | loss: 0.7142457
	speed: 0.1630s/iter; left time: 78953.4074s
	iters: 400, epoch: 2 | loss: 0.6767714
	speed: 0.1627s/iter; left time: 78783.3778s
	iters: 500, epoch: 2 | loss: 0.6819085
	speed: 0.1623s/iter; left time: 78608.5693s
	iters: 600, epoch: 2 | loss: 0.7116286
	speed: 0.1625s/iter; left time: 78694.4381s
	iters: 700, epoch: 2 | loss: 0.7038591
	speed: 0.1625s/iter; left time: 78639.0754s
	iters: 800, epoch: 2 | loss: 0.6059822
	speed: 0.1635s/iter; left time: 79114.3476s
	iters: 900, epoch: 2 | loss: 0.6003405
	speed: 0.1624s/iter; left time: 78574.2298s
	iters: 1000, epoch: 2 | loss: 0.6690403
	speed: 0.1625s/iter; left time: 78602.4505s
	iters: 1100, epoch: 2 | loss: 0.6658965
	speed: 0.1624s/iter; left time: 78547.1511s
	iters: 1200, epoch: 2 | loss: 0.7372804
	speed: 0.1622s/iter; left time: 78453.6431s
	iters: 1300, epoch: 2 | loss: 0.5945203
	speed: 0.1626s/iter; left time: 78606.1977s
	iters: 1400, epoch: 2 | loss: 0.7004580
	speed: 0.1636s/iter; left time: 79062.1155s
	iters: 1500, epoch: 2 | loss: 0.6725258
	speed: 0.1629s/iter; left time: 78717.2812s
	iters: 1600, epoch: 2 | loss: 0.6764547
	speed: 0.1627s/iter; left time: 78610.9005s
	iters: 1700, epoch: 2 | loss: 0.5990967
	speed: 0.1635s/iter; left time: 78970.6199s
	iters: 1800, epoch: 2 | loss: 0.6044906
	speed: 0.1628s/iter; left time: 78612.9820s
	iters: 1900, epoch: 2 | loss: 1.0018092
	speed: 0.1632s/iter; left time: 78786.6306s
	iters: 2000, epoch: 2 | loss: 0.5962777
	speed: 0.1628s/iter; left time: 78581.7410s
	iters: 2100, epoch: 2 | loss: 0.6622899
	speed: 0.1630s/iter; left time: 78672.1738s
	iters: 2200, epoch: 2 | loss: 0.6262168
	speed: 0.1626s/iter; left time: 78485.2112s
	iters: 2300, epoch: 2 | loss: 0.6420976
	speed: 0.1628s/iter; left time: 78554.4110s
	iters: 2400, epoch: 2 | loss: 0.6073838
	speed: 0.1629s/iter; left time: 78577.6930s
Epoch: 2 cost time: 396.69081377983093
Epoch: 2, Steps: 2436 | Train Loss: 0.6872699 Vali Loss: 0.8460731 Test Loss: 1.0698189
Validation loss decreased (1.119731 --> 0.846073).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6086576
	speed: 2.0470s/iter; left time: 987116.1178s
	iters: 200, epoch: 3 | loss: 0.6985449
	speed: 0.1625s/iter; left time: 78346.6177s
	iters: 300, epoch: 3 | loss: 0.6357360
	speed: 0.1627s/iter; left time: 78438.9392s
	iters: 400, epoch: 3 | loss: 0.6084222
	speed: 0.1630s/iter; left time: 78558.4069s
	iters: 500, epoch: 3 | loss: 0.5794737
	speed: 0.1626s/iter; left time: 78347.1461s
	iters: 600, epoch: 3 | loss: 0.6523558
	speed: 0.1625s/iter; left time: 78281.2898s
	iters: 700, epoch: 3 | loss: 0.5800645
	speed: 0.1625s/iter; left time: 78288.3995s
	iters: 800, epoch: 3 | loss: 0.6310857
	speed: 0.1628s/iter; left time: 78377.5234s
	iters: 900, epoch: 3 | loss: 0.6597769
	speed: 0.1630s/iter; left time: 78489.1397s
	iters: 1000, epoch: 3 | loss: 0.5784058
	speed: 0.1632s/iter; left time: 78529.5840s
	iters: 1100, epoch: 3 | loss: 0.6647365
	speed: 0.1627s/iter; left time: 78315.5628s
	iters: 1200, epoch: 3 | loss: 0.5829315
	speed: 0.1627s/iter; left time: 78259.0404s
	iters: 1300, epoch: 3 | loss: 0.5814041
	speed: 0.1626s/iter; left time: 78216.5826s
	iters: 1400, epoch: 3 | loss: 0.6399977
	speed: 0.1631s/iter; left time: 78417.8587s
	iters: 1500, epoch: 3 | loss: 0.7056738
	speed: 0.1624s/iter; left time: 78079.4647s
	iters: 1600, epoch: 3 | loss: 0.6253406
	speed: 0.1628s/iter; left time: 78277.7311s
	iters: 1700, epoch: 3 | loss: 0.5929552
	speed: 0.1629s/iter; left time: 78272.7799s
	iters: 1800, epoch: 3 | loss: 0.6276287
	speed: 0.1627s/iter; left time: 78185.6599s
	iters: 1900, epoch: 3 | loss: 0.6004798
	speed: 0.1630s/iter; left time: 78312.5956s
	iters: 2000, epoch: 3 | loss: 0.5804758
	speed: 0.1632s/iter; left time: 78374.5851s
	iters: 2100, epoch: 3 | loss: 0.5610444
	speed: 0.1626s/iter; left time: 78106.3105s
	iters: 2200, epoch: 3 | loss: 0.6183119
	speed: 0.1629s/iter; left time: 78217.0284s
	iters: 2300, epoch: 3 | loss: 0.5818008
	speed: 0.1627s/iter; left time: 78078.3231s
	iters: 2400, epoch: 3 | loss: 0.6137974
	speed: 0.1627s/iter; left time: 78101.7651s
Epoch: 3 cost time: 396.65049719810486
Epoch: 3, Steps: 2436 | Train Loss: 0.6392871 Vali Loss: 1.0220345 Test Loss: 1.4261285
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.7241546
	speed: 2.0476s/iter; left time: 982417.4125s
	iters: 200, epoch: 4 | loss: 0.6075119
	speed: 0.1635s/iter; left time: 78422.3185s
	iters: 300, epoch: 4 | loss: 0.6187917
	speed: 0.1630s/iter; left time: 78187.3823s
	iters: 400, epoch: 4 | loss: 0.6081212
	speed: 0.1626s/iter; left time: 77964.6083s
	iters: 500, epoch: 4 | loss: 0.6219844
	speed: 0.1627s/iter; left time: 78019.5756s
	iters: 600, epoch: 4 | loss: 0.6117297
	speed: 0.1626s/iter; left time: 77923.1001s
	iters: 700, epoch: 4 | loss: 0.5352477
	speed: 0.1630s/iter; left time: 78084.6551s
	iters: 800, epoch: 4 | loss: 0.6595801
	speed: 0.1625s/iter; left time: 77865.1452s
	iters: 900, epoch: 4 | loss: 0.5746330
	speed: 0.1627s/iter; left time: 77908.6573s
	iters: 1000, epoch: 4 | loss: 0.6267286
	speed: 0.1628s/iter; left time: 77983.6825s
	iters: 1100, epoch: 4 | loss: 0.5773658
	speed: 0.1630s/iter; left time: 78026.9372s
	iters: 1200, epoch: 4 | loss: 0.6465388
	speed: 0.1627s/iter; left time: 77876.3983s
	iters: 1300, epoch: 4 | loss: 0.6417646
	speed: 0.1624s/iter; left time: 77721.3786s
	iters: 1400, epoch: 4 | loss: 0.6145067
	speed: 0.1623s/iter; left time: 77656.7684s
	iters: 1500, epoch: 4 | loss: 0.6158826
	speed: 0.1629s/iter; left time: 77924.2030s
	iters: 1600, epoch: 4 | loss: 0.6036993
	speed: 0.1627s/iter; left time: 77824.0765s
	iters: 1700, epoch: 4 | loss: 0.5729761
	speed: 0.1636s/iter; left time: 78240.5021s
	iters: 1800, epoch: 4 | loss: 0.5960302
	speed: 0.1628s/iter; left time: 77827.8694s
	iters: 1900, epoch: 4 | loss: 0.5706057
	speed: 0.1628s/iter; left time: 77827.0462s
	iters: 2000, epoch: 4 | loss: 0.5907115
	speed: 0.1626s/iter; left time: 77688.7667s
	iters: 2100, epoch: 4 | loss: 0.5376587
	speed: 0.1628s/iter; left time: 77768.0391s
	iters: 2200, epoch: 4 | loss: 0.5721372
	speed: 0.1630s/iter; left time: 77868.9962s
	iters: 2300, epoch: 4 | loss: 0.6139777
	speed: 0.1629s/iter; left time: 77793.5104s
	iters: 2400, epoch: 4 | loss: 0.6169964
	speed: 0.1626s/iter; left time: 77661.6778s
Epoch: 4 cost time: 396.72323966026306
Epoch: 4, Steps: 2436 | Train Loss: 0.6153425 Vali Loss: 1.2526116 Test Loss: 1.3185431
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.5956864
	speed: 2.0466s/iter; left time: 976970.0162s
	iters: 200, epoch: 5 | loss: 0.6980320
	speed: 0.1631s/iter; left time: 77840.9578s
	iters: 300, epoch: 5 | loss: 0.6301068
	speed: 0.1630s/iter; left time: 77752.7836s
	iters: 400, epoch: 5 | loss: 0.5939364
	speed: 0.1627s/iter; left time: 77619.8922s
	iters: 500, epoch: 5 | loss: 0.5827762
	speed: 0.1630s/iter; left time: 77733.7120s
	iters: 600, epoch: 5 | loss: 0.5557299
	speed: 0.1630s/iter; left time: 77711.2896s
	iters: 700, epoch: 5 | loss: 0.6533591
	speed: 0.1628s/iter; left time: 77597.9129s
	iters: 800, epoch: 5 | loss: 0.5955349
	speed: 0.1626s/iter; left time: 77486.5986s
	iters: 900, epoch: 5 | loss: 0.6648678
	speed: 0.1631s/iter; left time: 77717.6886s
	iters: 1000, epoch: 5 | loss: 0.5985505
	speed: 0.1624s/iter; left time: 77391.4525s
	iters: 1100, epoch: 5 | loss: 0.6011676
	speed: 0.1627s/iter; left time: 77490.0470s
	iters: 1200, epoch: 5 | loss: 0.5710577
	speed: 0.1627s/iter; left time: 77482.4321s
	iters: 1300, epoch: 5 | loss: 0.6147591
	speed: 0.1636s/iter; left time: 77918.3228s
	iters: 1400, epoch: 5 | loss: 0.5896818
	speed: 0.1623s/iter; left time: 77278.4726s
	iters: 1500, epoch: 5 | loss: 0.5614139
	speed: 0.1627s/iter; left time: 77452.3340s
	iters: 1600, epoch: 5 | loss: 0.5686579
	speed: 0.1633s/iter; left time: 77717.1877s
	iters: 1700, epoch: 5 | loss: 0.5678741
	speed: 0.1631s/iter; left time: 77603.0932s
	iters: 1800, epoch: 5 | loss: 0.6163192
	speed: 0.1625s/iter; left time: 77284.7024s
	iters: 1900, epoch: 5 | loss: 0.5737343
	speed: 0.1626s/iter; left time: 77327.9208s
	iters: 2000, epoch: 5 | loss: 0.5945288
	speed: 0.1638s/iter; left time: 77859.1195s
	iters: 2100, epoch: 5 | loss: 0.5314994
	speed: 0.1629s/iter; left time: 77423.5579s
	iters: 2200, epoch: 5 | loss: 0.5634391
	speed: 0.1635s/iter; left time: 77724.9908s
	iters: 2300, epoch: 5 | loss: 0.5601178
	speed: 0.1627s/iter; left time: 77324.4499s
	iters: 2400, epoch: 5 | loss: 0.6180030
	speed: 0.1628s/iter; left time: 77328.9828s
Epoch: 5 cost time: 397.01637530326843
Epoch: 5, Steps: 2436 | Train Loss: 0.6023113 Vali Loss: 1.4236639 Test Loss: 1.4285727
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.5416700
	speed: 2.0468s/iter; left time: 972045.4148s
	iters: 200, epoch: 6 | loss: 0.5880976
	speed: 0.1634s/iter; left time: 77600.3252s
	iters: 300, epoch: 6 | loss: 0.5682822
	speed: 0.1627s/iter; left time: 77238.6459s
	iters: 400, epoch: 6 | loss: 0.5786738
	speed: 0.1624s/iter; left time: 77055.6343s
	iters: 500, epoch: 6 | loss: 0.5736927
	speed: 0.1635s/iter; left time: 77590.4405s
	iters: 600, epoch: 6 | loss: 0.5767075
	speed: 0.1628s/iter; left time: 77248.8324s
	iters: 700, epoch: 6 | loss: 0.5856617
	speed: 0.1642s/iter; left time: 77883.2609s
	iters: 800, epoch: 6 | loss: 0.6187562
	speed: 0.1630s/iter; left time: 77306.0740s
	iters: 900, epoch: 6 | loss: 0.5703872
	speed: 0.1627s/iter; left time: 77126.2870s
	iters: 1000, epoch: 6 | loss: 0.5909139
	speed: 0.1625s/iter; left time: 77012.6864s
	iters: 1100, epoch: 6 | loss: 0.5598583
	speed: 0.1636s/iter; left time: 77522.9522s
	iters: 1200, epoch: 6 | loss: 0.5876484
	speed: 0.1631s/iter; left time: 77297.1489s
	iters: 1300, epoch: 6 | loss: 0.5576166
	speed: 0.1626s/iter; left time: 77037.7315s
	iters: 1400, epoch: 6 | loss: 0.5469565
	speed: 0.1632s/iter; left time: 77289.7356s
	iters: 1500, epoch: 6 | loss: 0.5370347
	speed: 0.1634s/iter; left time: 77393.5033s
	iters: 1600, epoch: 6 | loss: 0.5390520
	speed: 0.1635s/iter; left time: 77397.3067s
	iters: 1700, epoch: 6 | loss: 0.5600543
	speed: 0.1630s/iter; left time: 77167.1114s
	iters: 1800, epoch: 6 | loss: 0.5535148
	speed: 0.1633s/iter; left time: 77277.5136s
	iters: 1900, epoch: 6 | loss: 0.6107200
	speed: 0.1633s/iter; left time: 77272.1861s
	iters: 2000, epoch: 6 | loss: 0.5561144
	speed: 0.1631s/iter; left time: 77135.2217s
	iters: 2100, epoch: 6 | loss: 0.5330923
	speed: 0.1635s/iter; left time: 77319.4113s
	iters: 2200, epoch: 6 | loss: 0.5863259
	speed: 0.1639s/iter; left time: 77503.1362s
	iters: 2300, epoch: 6 | loss: 0.5788659
	speed: 0.1625s/iter; left time: 76829.3550s
	iters: 2400, epoch: 6 | loss: 0.5579796
	speed: 0.1627s/iter; left time: 76900.8352s
Epoch: 6 cost time: 397.5292236804962
Epoch: 6, Steps: 2436 | Train Loss: 0.5836547 Vali Loss: 1.1844630 Test Loss: 1.1727412
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.5306572
	speed: 2.0487s/iter; left time: 968000.6585s
	iters: 200, epoch: 7 | loss: 0.5914930
	speed: 0.1623s/iter; left time: 76644.4759s
	iters: 300, epoch: 7 | loss: 1.0246603
	speed: 0.1627s/iter; left time: 76860.2405s
	iters: 400, epoch: 7 | loss: 0.5832040
	speed: 0.1631s/iter; left time: 77036.0092s
	iters: 500, epoch: 7 | loss: 0.5989007
	speed: 0.1628s/iter; left time: 76859.1893s
	iters: 600, epoch: 7 | loss: 0.5580116
	speed: 0.1629s/iter; left time: 76909.4711s
	iters: 700, epoch: 7 | loss: 0.6133780
	speed: 0.1632s/iter; left time: 77001.4870s
	iters: 800, epoch: 7 | loss: 0.7862396
	speed: 0.1628s/iter; left time: 76793.2001s
	iters: 900, epoch: 7 | loss: 0.5928601
	speed: 0.1628s/iter; left time: 76781.0873s
	iters: 1000, epoch: 7 | loss: 0.6255041
	speed: 0.1632s/iter; left time: 76944.4933s
	iters: 1100, epoch: 7 | loss: 0.5673997
	speed: 0.1628s/iter; left time: 76765.0174s
	iters: 1200, epoch: 7 | loss: 0.5489585
	speed: 0.1631s/iter; left time: 76896.3538s
	iters: 1300, epoch: 7 | loss: 0.5827761
	speed: 0.1629s/iter; left time: 76763.7923s
	iters: 1400, epoch: 7 | loss: 0.6319821
	speed: 0.1630s/iter; left time: 76790.5458s
	iters: 1500, epoch: 7 | loss: 0.5061356
	speed: 0.1625s/iter; left time: 76558.9904s
	iters: 1600, epoch: 7 | loss: 0.5646011
	speed: 0.1624s/iter; left time: 76485.6969s
	iters: 1700, epoch: 7 | loss: 0.5453671
	speed: 0.1635s/iter; left time: 76992.6452s
	iters: 1800, epoch: 7 | loss: 0.5418785
	speed: 0.1637s/iter; left time: 77086.8604s
	iters: 1900, epoch: 7 | loss: 0.5609422
	speed: 0.1652s/iter; left time: 77740.6162s
	iters: 2000, epoch: 7 | loss: 0.5874244
	speed: 0.1652s/iter; left time: 77739.7859s
	iters: 2100, epoch: 7 | loss: 0.5308182
	speed: 0.1658s/iter; left time: 78028.9010s
	iters: 2200, epoch: 7 | loss: 0.5937794
	speed: 0.1656s/iter; left time: 77903.5220s
	iters: 2300, epoch: 7 | loss: 0.5859268
	speed: 0.1655s/iter; left time: 77854.1381s
	iters: 2400, epoch: 7 | loss: 0.5323326
	speed: 0.1653s/iter; left time: 77721.4739s
Epoch: 7 cost time: 398.7825539112091
Epoch: 7, Steps: 2436 | Train Loss: 0.5781860 Vali Loss: 1.1246896 Test Loss: 1.2819105
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 147475
test shape: (14747, 1, 336, 103) (14747, 1, 336, 103)
test shape: (14747, 336, 103) (14747, 336, 103)
mse:1.0698184967041016, mae:0.794123649597168
>>>>>>>Overall time: 4391 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 779704
val 21011
test 147475
	iters: 100, epoch: 1 | loss: 1.0846462
	speed: 0.1644s/iter; left time: 80073.0614s
	iters: 200, epoch: 1 | loss: 1.1283125
	speed: 0.1633s/iter; left time: 79508.7956s
	iters: 300, epoch: 1 | loss: 1.1492603
	speed: 0.1635s/iter; left time: 79585.5172s
	iters: 400, epoch: 1 | loss: 0.9753234
	speed: 0.1631s/iter; left time: 79384.9611s
	iters: 500, epoch: 1 | loss: 0.9554372
	speed: 0.1633s/iter; left time: 79501.1372s
	iters: 600, epoch: 1 | loss: 0.9734560
	speed: 0.1636s/iter; left time: 79603.9739s
	iters: 700, epoch: 1 | loss: 0.9005385
	speed: 0.1629s/iter; left time: 79262.5109s
	iters: 800, epoch: 1 | loss: 0.8929331
	speed: 0.1623s/iter; left time: 78948.4372s
	iters: 900, epoch: 1 | loss: 0.9434097
	speed: 0.1623s/iter; left time: 78932.0194s
	iters: 1000, epoch: 1 | loss: 0.8362803
	speed: 0.1621s/iter; left time: 78817.1293s
	iters: 1100, epoch: 1 | loss: 0.8130999
	speed: 0.1624s/iter; left time: 78953.9354s
	iters: 1200, epoch: 1 | loss: 0.8184222
	speed: 0.1624s/iter; left time: 78949.3880s
	iters: 1300, epoch: 1 | loss: 0.8298144
	speed: 0.1624s/iter; left time: 78886.5771s
	iters: 1400, epoch: 1 | loss: 0.8775945
	speed: 0.1625s/iter; left time: 78932.8649s
	iters: 1500, epoch: 1 | loss: 0.8174786
	speed: 0.1623s/iter; left time: 78819.9922s
	iters: 1600, epoch: 1 | loss: 0.8285297
	speed: 0.1621s/iter; left time: 78708.7777s
	iters: 1700, epoch: 1 | loss: 0.7794042
	speed: 0.1622s/iter; left time: 78750.6688s
	iters: 1800, epoch: 1 | loss: 0.8323132
	speed: 0.1626s/iter; left time: 78922.5120s
	iters: 1900, epoch: 1 | loss: 0.7477936
	speed: 0.1629s/iter; left time: 79058.3524s
	iters: 2000, epoch: 1 | loss: 0.7708051
	speed: 0.1624s/iter; left time: 78813.5619s
	iters: 2100, epoch: 1 | loss: 0.7828313
	speed: 0.1620s/iter; left time: 78578.3009s
	iters: 2200, epoch: 1 | loss: 0.7646013
	speed: 0.1627s/iter; left time: 78891.8343s
	iters: 2300, epoch: 1 | loss: 0.7553672
	speed: 0.1625s/iter; left time: 78774.4028s
	iters: 2400, epoch: 1 | loss: 0.8903037
	speed: 0.1623s/iter; left time: 78689.6197s
Epoch: 1 cost time: 396.48520851135254
Epoch: 1, Steps: 2436 | Train Loss: 0.9212821 Vali Loss: 0.9083712 Test Loss: 1.1345019
Validation loss decreased (inf --> 0.908371).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7600598
	speed: 2.0342s/iter; left time: 985883.2220s
	iters: 200, epoch: 2 | loss: 0.6987642
	speed: 0.1624s/iter; left time: 78670.8371s
	iters: 300, epoch: 2 | loss: 0.7326102
	speed: 0.1621s/iter; left time: 78530.5928s
	iters: 400, epoch: 2 | loss: 0.7204817
	speed: 0.1621s/iter; left time: 78508.4981s
	iters: 500, epoch: 2 | loss: 0.7025126
	speed: 0.1621s/iter; left time: 78493.0388s
	iters: 600, epoch: 2 | loss: 0.7825018
	speed: 0.1619s/iter; left time: 78397.1322s
	iters: 700, epoch: 2 | loss: 0.6924724
	speed: 0.1622s/iter; left time: 78522.0623s
	iters: 800, epoch: 2 | loss: 0.6759905
	speed: 0.1624s/iter; left time: 78596.7076s
	iters: 900, epoch: 2 | loss: 0.6777367
	speed: 0.1621s/iter; left time: 78452.0979s
	iters: 1000, epoch: 2 | loss: 0.8051058
	speed: 0.1617s/iter; left time: 78231.6174s
	iters: 1100, epoch: 2 | loss: 0.7647518
	speed: 0.1618s/iter; left time: 78264.4144s
	iters: 1200, epoch: 2 | loss: 0.7298033
	speed: 0.1624s/iter; left time: 78538.8442s
	iters: 1300, epoch: 2 | loss: 0.6899610
	speed: 0.1622s/iter; left time: 78410.4559s
	iters: 1400, epoch: 2 | loss: 0.7181602
	speed: 0.1624s/iter; left time: 78503.3278s
	iters: 1500, epoch: 2 | loss: 0.6669381
	speed: 0.1624s/iter; left time: 78497.6086s
	iters: 1600, epoch: 2 | loss: 0.6849654
	speed: 0.1626s/iter; left time: 78553.3891s
	iters: 1700, epoch: 2 | loss: 0.6303043
	speed: 0.1628s/iter; left time: 78636.3917s
	iters: 1800, epoch: 2 | loss: 0.6009315
	speed: 0.1626s/iter; left time: 78545.5008s
	iters: 1900, epoch: 2 | loss: 0.6717390
	speed: 0.1632s/iter; left time: 78784.1612s
	iters: 2000, epoch: 2 | loss: 0.6304659
	speed: 0.1633s/iter; left time: 78836.8938s
	iters: 2100, epoch: 2 | loss: 0.6935053
	speed: 0.1625s/iter; left time: 78417.4651s
	iters: 2200, epoch: 2 | loss: 0.7180167
	speed: 0.1629s/iter; left time: 78590.4784s
	iters: 2300, epoch: 2 | loss: 0.6315873
	speed: 0.1632s/iter; left time: 78751.7184s
	iters: 2400, epoch: 2 | loss: 0.6751509
	speed: 0.1619s/iter; left time: 78116.2490s
Epoch: 2 cost time: 395.79078340530396
Epoch: 2, Steps: 2436 | Train Loss: 0.7171952 Vali Loss: 0.9250984 Test Loss: 1.1494707
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.6457577
	speed: 2.0349s/iter; left time: 981274.9980s
	iters: 200, epoch: 3 | loss: 0.7153865
	speed: 0.1623s/iter; left time: 78225.7804s
	iters: 300, epoch: 3 | loss: 1.0162456
	speed: 0.1625s/iter; left time: 78349.6692s
	iters: 400, epoch: 3 | loss: 0.6014535
	speed: 0.1620s/iter; left time: 78088.6556s
	iters: 500, epoch: 3 | loss: 0.6359284
	speed: 0.1624s/iter; left time: 78268.2440s
	iters: 600, epoch: 3 | loss: 0.7047426
	speed: 0.1629s/iter; left time: 78453.3743s
	iters: 700, epoch: 3 | loss: 0.5874118
	speed: 0.1629s/iter; left time: 78442.5176s
	iters: 800, epoch: 3 | loss: 0.8716278
	speed: 0.1627s/iter; left time: 78336.6193s
	iters: 900, epoch: 3 | loss: 0.6222029
	speed: 0.1639s/iter; left time: 78920.1665s
	iters: 1000, epoch: 3 | loss: 0.6016058
	speed: 0.1627s/iter; left time: 78296.6693s
	iters: 1100, epoch: 3 | loss: 0.6274897
	speed: 0.1628s/iter; left time: 78351.2473s
	iters: 1200, epoch: 3 | loss: 0.6155716
	speed: 0.1631s/iter; left time: 78466.7265s
	iters: 1300, epoch: 3 | loss: 0.5956891
	speed: 0.1622s/iter; left time: 78004.7732s
	iters: 1400, epoch: 3 | loss: 0.5840893
	speed: 0.1622s/iter; left time: 78010.9448s
	iters: 1500, epoch: 3 | loss: 0.6715869
	speed: 0.1619s/iter; left time: 77863.9912s
	iters: 1600, epoch: 3 | loss: 0.6925356
	speed: 0.1624s/iter; left time: 78057.1528s
	iters: 1700, epoch: 3 | loss: 0.5790370
	speed: 0.1626s/iter; left time: 78163.7157s
	iters: 1800, epoch: 3 | loss: 0.8366606
	speed: 0.1625s/iter; left time: 78107.5653s
	iters: 1900, epoch: 3 | loss: 0.8336170
	speed: 0.1631s/iter; left time: 78347.2197s
	iters: 2000, epoch: 3 | loss: 0.5937907
	speed: 0.1627s/iter; left time: 78149.7172s
	iters: 2100, epoch: 3 | loss: 0.5907637
	speed: 0.1626s/iter; left time: 78063.8453s
	iters: 2200, epoch: 3 | loss: 0.7851603
	speed: 0.1631s/iter; left time: 78332.3896s
	iters: 2300, epoch: 3 | loss: 0.5910578
	speed: 0.1632s/iter; left time: 78363.8910s
	iters: 2400, epoch: 3 | loss: 0.6735876
	speed: 0.1632s/iter; left time: 78347.7206s
Epoch: 3 cost time: 396.44725608825684
Epoch: 3, Steps: 2436 | Train Loss: 0.6502837 Vali Loss: 1.1723390 Test Loss: 1.3351574
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.6844240
	speed: 2.0353s/iter; left time: 976535.0265s
	iters: 200, epoch: 4 | loss: 0.6074753
	speed: 0.1624s/iter; left time: 77906.3966s
	iters: 300, epoch: 4 | loss: 0.6369550
	speed: 0.1625s/iter; left time: 77927.1539s
	iters: 400, epoch: 4 | loss: 0.6320796
	speed: 0.1623s/iter; left time: 77809.1708s
	iters: 500, epoch: 4 | loss: 0.7215313
	speed: 0.1623s/iter; left time: 77786.8674s
	iters: 600, epoch: 4 | loss: 0.9496923
	speed: 0.1623s/iter; left time: 77806.7571s
	iters: 700, epoch: 4 | loss: 0.6448551
	speed: 0.1621s/iter; left time: 77678.7427s
	iters: 800, epoch: 4 | loss: 0.8819626
	speed: 0.1624s/iter; left time: 77789.7627s
	iters: 900, epoch: 4 | loss: 0.5734255
	speed: 0.1623s/iter; left time: 77731.2783s
	iters: 1000, epoch: 4 | loss: 0.6668544
	speed: 0.1620s/iter; left time: 77576.0261s
	iters: 1100, epoch: 4 | loss: 0.5965455
	speed: 0.1628s/iter; left time: 77960.5594s
	iters: 1200, epoch: 4 | loss: 0.6857174
	speed: 0.1622s/iter; left time: 77663.4501s
	iters: 1300, epoch: 4 | loss: 0.7092376
	speed: 0.1622s/iter; left time: 77642.0867s
	iters: 1400, epoch: 4 | loss: 0.6748623
	speed: 0.1622s/iter; left time: 77590.7015s
	iters: 1500, epoch: 4 | loss: 0.6650954
	speed: 0.1620s/iter; left time: 77500.7144s
	iters: 1600, epoch: 4 | loss: 0.5977870
	speed: 0.1625s/iter; left time: 77701.1525s
	iters: 1700, epoch: 4 | loss: 0.6335582
	speed: 0.1622s/iter; left time: 77582.0573s
	iters: 1800, epoch: 4 | loss: 0.6759961
	speed: 0.1626s/iter; left time: 77724.9558s
	iters: 1900, epoch: 4 | loss: 0.6296784
	speed: 0.1630s/iter; left time: 77895.3450s
	iters: 2000, epoch: 4 | loss: 0.6297899
	speed: 0.1629s/iter; left time: 77838.7577s
	iters: 2100, epoch: 4 | loss: 0.5625626
	speed: 0.1623s/iter; left time: 77550.0701s
	iters: 2200, epoch: 4 | loss: 0.5643886
	speed: 0.1621s/iter; left time: 77444.2390s
	iters: 2300, epoch: 4 | loss: 0.6038551
	speed: 0.1624s/iter; left time: 77559.3212s
	iters: 2400, epoch: 4 | loss: 0.6131364
	speed: 0.1622s/iter; left time: 77434.6835s
Epoch: 4 cost time: 395.6918635368347
Epoch: 4, Steps: 2436 | Train Loss: 0.6360441 Vali Loss: 1.1610804 Test Loss: 1.2287025
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.5938495
	speed: 2.0347s/iter; left time: 971278.7649s
	iters: 200, epoch: 5 | loss: 0.7377261
	speed: 0.1624s/iter; left time: 77515.8105s
	iters: 300, epoch: 5 | loss: 0.6389177
	speed: 0.1623s/iter; left time: 77456.7345s
	iters: 400, epoch: 5 | loss: 0.5923652
	speed: 0.1622s/iter; left time: 77395.1320s
	iters: 500, epoch: 5 | loss: 0.6481103
	speed: 0.1626s/iter; left time: 77532.8326s
	iters: 600, epoch: 5 | loss: 0.6236596
	speed: 0.1624s/iter; left time: 77442.9434s
	iters: 700, epoch: 5 | loss: 0.6606723
	speed: 0.1629s/iter; left time: 77646.1228s
	iters: 800, epoch: 5 | loss: 0.6050557
	speed: 0.1623s/iter; left time: 77351.0646s
	iters: 900, epoch: 5 | loss: 0.6860562
	speed: 0.1622s/iter; left time: 77282.1602s
	iters: 1000, epoch: 5 | loss: 0.5964726
	speed: 0.1621s/iter; left time: 77224.0606s
	iters: 1100, epoch: 5 | loss: 0.5611208
	speed: 0.1620s/iter; left time: 77175.5344s
	iters: 1200, epoch: 5 | loss: 0.6079857
	speed: 0.1626s/iter; left time: 77438.2493s
	iters: 1300, epoch: 5 | loss: 0.5923902
	speed: 0.1624s/iter; left time: 77335.3134s
	iters: 1400, epoch: 5 | loss: 0.5625457
	speed: 0.1624s/iter; left time: 77320.4032s
	iters: 1500, epoch: 5 | loss: 0.5896311
	speed: 0.1626s/iter; left time: 77408.4490s
	iters: 1600, epoch: 5 | loss: 0.5623827
	speed: 0.1623s/iter; left time: 77230.5315s
	iters: 1700, epoch: 5 | loss: 0.6633676
	speed: 0.1621s/iter; left time: 77134.8287s
	iters: 1800, epoch: 5 | loss: 0.6256177
	speed: 0.1619s/iter; left time: 77021.1867s
	iters: 1900, epoch: 5 | loss: 0.6196724
	speed: 0.1622s/iter; left time: 77124.6400s
	iters: 2000, epoch: 5 | loss: 0.6262398
	speed: 0.1620s/iter; left time: 77035.2374s
	iters: 2100, epoch: 5 | loss: 0.5949544
	speed: 0.1625s/iter; left time: 77252.7545s
	iters: 2200, epoch: 5 | loss: 0.5771722
	speed: 0.1626s/iter; left time: 77271.8626s
	iters: 2300, epoch: 5 | loss: 0.5491280
	speed: 0.1621s/iter; left time: 77008.6214s
	iters: 2400, epoch: 5 | loss: 0.6150044
	speed: 0.1626s/iter; left time: 77251.1942s
Epoch: 5 cost time: 395.5771698951721
Epoch: 5, Steps: 2436 | Train Loss: 0.6205161 Vali Loss: 1.0233477 Test Loss: 1.2824639
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.5696286
	speed: 2.0342s/iter; left time: 966068.8540s
	iters: 200, epoch: 6 | loss: 0.6206406
	speed: 0.1624s/iter; left time: 77093.2465s
	iters: 300, epoch: 6 | loss: 0.5710875
	speed: 0.1625s/iter; left time: 77138.7851s
	iters: 400, epoch: 6 | loss: 0.6135684
	speed: 0.1621s/iter; left time: 76920.1723s
	iters: 500, epoch: 6 | loss: 0.5852995
	speed: 0.1621s/iter; left time: 76925.9092s
	iters: 600, epoch: 6 | loss: 0.5759604
	speed: 0.1623s/iter; left time: 76976.7625s
	iters: 700, epoch: 6 | loss: 0.5952745
	speed: 0.1623s/iter; left time: 76965.1646s
	iters: 800, epoch: 6 | loss: 0.5948514
	speed: 0.1626s/iter; left time: 77085.4495s
	iters: 900, epoch: 6 | loss: 0.5987960
	speed: 0.1625s/iter; left time: 77023.6756s
	iters: 1000, epoch: 6 | loss: 0.7637557
	speed: 0.1620s/iter; left time: 76800.1835s
	iters: 1100, epoch: 6 | loss: 0.5307946
	speed: 0.1623s/iter; left time: 76906.8724s
	iters: 1200, epoch: 6 | loss: 0.6163381
	speed: 0.1619s/iter; left time: 76723.9235s
	iters: 1300, epoch: 6 | loss: 0.5934134
	speed: 0.1622s/iter; left time: 76817.4627s
	iters: 1400, epoch: 6 | loss: 0.5242971
	speed: 0.1622s/iter; left time: 76805.8066s
	iters: 1500, epoch: 6 | loss: 0.5548140
	speed: 0.1625s/iter; left time: 76968.1578s
	iters: 1600, epoch: 6 | loss: 0.5898669
	speed: 0.1621s/iter; left time: 76753.4162s
	iters: 1700, epoch: 6 | loss: 0.6154745
	speed: 0.1623s/iter; left time: 76811.6679s
	iters: 1800, epoch: 6 | loss: 0.5722837
	speed: 0.1622s/iter; left time: 76774.1372s
	iters: 1900, epoch: 6 | loss: 0.5625044
	speed: 0.1622s/iter; left time: 76762.7876s
	iters: 2000, epoch: 6 | loss: 0.6161950
	speed: 0.1626s/iter; left time: 76908.2569s
	iters: 2100, epoch: 6 | loss: 0.5965385
	speed: 0.1621s/iter; left time: 76681.6885s
	iters: 2200, epoch: 6 | loss: 0.5652844
	speed: 0.1622s/iter; left time: 76706.8242s
	iters: 2300, epoch: 6 | loss: 0.6066278
	speed: 0.1628s/iter; left time: 76943.4219s
	iters: 2400, epoch: 6 | loss: 0.5586330
	speed: 0.1621s/iter; left time: 76601.8762s
Epoch: 6 cost time: 395.48514795303345
Epoch: 6, Steps: 2436 | Train Loss: 0.6061408 Vali Loss: 1.2011167 Test Loss: 1.1897396
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 147475
test shape: (14747, 1, 336, 103) (14747, 1, 336, 103)
test shape: (14747, 336, 103) (14747, 336, 103)
mse:1.1345077753067017, mae:0.8265782594680786
>>>>>>>Overall time: 3794 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
