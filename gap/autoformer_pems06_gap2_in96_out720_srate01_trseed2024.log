Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690054
val 89412
test 89410
	iters: 100, epoch: 1 | loss: 1.4829651
	speed: 0.2868s/iter; left time: 123629.9000s
	iters: 200, epoch: 1 | loss: 1.2910366
	speed: 0.2854s/iter; left time: 122992.3413s
	iters: 300, epoch: 1 | loss: 1.3163375
	speed: 0.2855s/iter; left time: 123005.5358s
	iters: 400, epoch: 1 | loss: 1.3272151
	speed: 0.2852s/iter; left time: 122865.2339s
	iters: 500, epoch: 1 | loss: 1.6306531
	speed: 0.2855s/iter; left time: 122958.6948s
	iters: 600, epoch: 1 | loss: 1.3413965
	speed: 0.2857s/iter; left time: 123042.6888s
	iters: 700, epoch: 1 | loss: 1.2242440
	speed: 0.2851s/iter; left time: 122716.5050s
	iters: 800, epoch: 1 | loss: 1.2617105
	speed: 0.2857s/iter; left time: 122966.2160s
	iters: 900, epoch: 1 | loss: 1.4424629
	speed: 0.2856s/iter; left time: 122878.7900s
	iters: 1000, epoch: 1 | loss: 1.4806623
	speed: 0.2852s/iter; left time: 122672.5079s
	iters: 1100, epoch: 1 | loss: 1.1626369
	speed: 0.2855s/iter; left time: 122794.1511s
	iters: 1200, epoch: 1 | loss: 1.4826983
	speed: 0.2855s/iter; left time: 122783.4006s
	iters: 1300, epoch: 1 | loss: 1.4410959
	speed: 0.2854s/iter; left time: 122711.9793s
	iters: 1400, epoch: 1 | loss: 1.1527473
	speed: 0.2851s/iter; left time: 122532.2779s
	iters: 1500, epoch: 1 | loss: 1.1057835
	speed: 0.2859s/iter; left time: 122872.2061s
	iters: 1600, epoch: 1 | loss: 1.0724859
	speed: 0.2854s/iter; left time: 122616.8078s
	iters: 1700, epoch: 1 | loss: 1.0533569
	speed: 0.2853s/iter; left time: 122557.3192s
	iters: 1800, epoch: 1 | loss: 1.1183183
	speed: 0.2854s/iter; left time: 122547.8326s
	iters: 1900, epoch: 1 | loss: 1.0566803
	speed: 0.2856s/iter; left time: 122611.5547s
	iters: 2000, epoch: 1 | loss: 1.1317890
	speed: 0.2856s/iter; left time: 122566.4319s
	iters: 2100, epoch: 1 | loss: 1.1153381
	speed: 0.2862s/iter; left time: 122800.7607s
Epoch: 1 cost time: 615.9629013538361
Epoch: 1, Steps: 2156 | Train Loss: 1.2411664 Vali Loss: 0.8113998 Test Loss: 0.8766760
Validation loss decreased (inf --> 0.811400).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0189327
	speed: 1.8327s/iter; left time: 786122.3307s
	iters: 200, epoch: 2 | loss: 1.2780707
	speed: 0.2852s/iter; left time: 122316.1640s
	iters: 300, epoch: 2 | loss: 1.1375018
	speed: 0.2848s/iter; left time: 122099.1896s
	iters: 400, epoch: 2 | loss: 1.0812508
	speed: 0.2886s/iter; left time: 123716.4366s
	iters: 500, epoch: 2 | loss: 0.9863283
	speed: 0.2857s/iter; left time: 122430.8934s
	iters: 600, epoch: 2 | loss: 1.1447133
	speed: 0.2838s/iter; left time: 121580.0199s
	iters: 700, epoch: 2 | loss: 0.9129984
	speed: 0.2857s/iter; left time: 122395.3447s
	iters: 800, epoch: 2 | loss: 1.0523648
	speed: 0.2856s/iter; left time: 122297.2181s
	iters: 900, epoch: 2 | loss: 0.9007205
	speed: 0.2937s/iter; left time: 125732.4137s
	iters: 1000, epoch: 2 | loss: 0.9589127
	speed: 0.2937s/iter; left time: 125720.2869s
	iters: 1100, epoch: 2 | loss: 0.9734910
	speed: 0.2914s/iter; left time: 124707.7424s
	iters: 1200, epoch: 2 | loss: 1.0126307
	speed: 0.2914s/iter; left time: 124680.7740s
	iters: 1300, epoch: 2 | loss: 0.9456264
	speed: 0.2910s/iter; left time: 124475.6446s
	iters: 1400, epoch: 2 | loss: 0.9914461
	speed: 0.2911s/iter; left time: 124467.7372s
	iters: 1500, epoch: 2 | loss: 0.9577693
	speed: 0.2916s/iter; left time: 124675.2324s
	iters: 1600, epoch: 2 | loss: 0.9643013
	speed: 0.2911s/iter; left time: 124415.6747s
	iters: 1700, epoch: 2 | loss: 1.0833201
	speed: 0.2914s/iter; left time: 124507.4609s
	iters: 1800, epoch: 2 | loss: 1.0097307
	speed: 0.2906s/iter; left time: 124177.2397s
	iters: 1900, epoch: 2 | loss: 1.0097766
	speed: 0.2908s/iter; left time: 124222.4302s
	iters: 2000, epoch: 2 | loss: 1.2852521
	speed: 0.2911s/iter; left time: 124313.9944s
	iters: 2100, epoch: 2 | loss: 1.2548912
	speed: 0.2915s/iter; left time: 124455.0043s
Epoch: 2 cost time: 623.9498054981232
Epoch: 2, Steps: 2156 | Train Loss: 1.0650600 Vali Loss: 0.7581757 Test Loss: 0.8340719
Validation loss decreased (0.811400 --> 0.758176).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.1590867
	speed: 1.8384s/iter; left time: 784626.5160s
	iters: 200, epoch: 3 | loss: 1.0829185
	speed: 0.2884s/iter; left time: 123076.5174s
	iters: 300, epoch: 3 | loss: 1.1587445
	speed: 0.2889s/iter; left time: 123250.1903s
	iters: 400, epoch: 3 | loss: 0.9938419
	speed: 0.2884s/iter; left time: 123001.8656s
	iters: 500, epoch: 3 | loss: 1.0959747
	speed: 0.2883s/iter; left time: 122920.9207s
	iters: 600, epoch: 3 | loss: 1.0174012
	speed: 0.2885s/iter; left time: 122974.5317s
	iters: 700, epoch: 3 | loss: 1.0685117
	speed: 0.2882s/iter; left time: 122829.8491s
	iters: 800, epoch: 3 | loss: 1.0557934
	speed: 0.2880s/iter; left time: 122734.3750s
	iters: 900, epoch: 3 | loss: 1.0177015
	speed: 0.2887s/iter; left time: 122968.6668s
	iters: 1000, epoch: 3 | loss: 1.0513618
	speed: 0.2885s/iter; left time: 122876.5896s
	iters: 1100, epoch: 3 | loss: 1.3617276
	speed: 0.2883s/iter; left time: 122749.7038s
	iters: 1200, epoch: 3 | loss: 0.8560822
	speed: 0.2881s/iter; left time: 122648.2827s
	iters: 1300, epoch: 3 | loss: 1.0896361
	speed: 0.2886s/iter; left time: 122840.9429s
	iters: 1400, epoch: 3 | loss: 0.9604579
	speed: 0.2887s/iter; left time: 122844.7858s
	iters: 1500, epoch: 3 | loss: 1.1327178
	speed: 0.2883s/iter; left time: 122643.2174s
	iters: 1600, epoch: 3 | loss: 0.9780602
	speed: 0.2885s/iter; left time: 122710.2349s
	iters: 1700, epoch: 3 | loss: 0.9433630
	speed: 0.2883s/iter; left time: 122583.6357s
	iters: 1800, epoch: 3 | loss: 1.1063576
	speed: 0.2857s/iter; left time: 121458.2687s
	iters: 1900, epoch: 3 | loss: 1.0732563
	speed: 0.2877s/iter; left time: 122254.9207s
	iters: 2000, epoch: 3 | loss: 1.1527483
	speed: 0.2921s/iter; left time: 124112.6258s
	iters: 2100, epoch: 3 | loss: 1.1223853
	speed: 0.2924s/iter; left time: 124190.9406s
Epoch: 3 cost time: 622.6120345592499
Epoch: 3, Steps: 2156 | Train Loss: 1.0417294 Vali Loss: 0.7641714 Test Loss: 0.8470976
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.8816481
	speed: 1.8355s/iter; left time: 779420.2768s
	iters: 200, epoch: 4 | loss: 1.1651292
	speed: 0.2877s/iter; left time: 122138.0752s
	iters: 300, epoch: 4 | loss: 0.9857954
	speed: 0.2877s/iter; left time: 122102.1276s
	iters: 400, epoch: 4 | loss: 0.8982826
	speed: 0.2876s/iter; left time: 122024.0091s
	iters: 500, epoch: 4 | loss: 1.0366836
	speed: 0.2876s/iter; left time: 121996.1830s
	iters: 600, epoch: 4 | loss: 0.9979262
	speed: 0.2875s/iter; left time: 121952.3257s
	iters: 700, epoch: 4 | loss: 0.9021577
	speed: 0.2877s/iter; left time: 122008.3556s
	iters: 800, epoch: 4 | loss: 0.9898242
	speed: 0.2875s/iter; left time: 121879.3892s
	iters: 900, epoch: 4 | loss: 0.8730965
	speed: 0.2873s/iter; left time: 121780.8879s
	iters: 1000, epoch: 4 | loss: 1.2646315
	speed: 0.2874s/iter; left time: 121779.3761s
	iters: 1100, epoch: 4 | loss: 0.9012585
	speed: 0.2874s/iter; left time: 121743.2068s
	iters: 1200, epoch: 4 | loss: 0.8834935
	speed: 0.2876s/iter; left time: 121815.2006s
	iters: 1300, epoch: 4 | loss: 0.9258874
	speed: 0.2875s/iter; left time: 121729.2090s
	iters: 1400, epoch: 4 | loss: 0.9268607
	speed: 0.2880s/iter; left time: 121917.6742s
	iters: 1500, epoch: 4 | loss: 0.9231429
	speed: 0.2878s/iter; left time: 121785.5202s
	iters: 1600, epoch: 4 | loss: 1.0061446
	speed: 0.2876s/iter; left time: 121688.3708s
	iters: 1700, epoch: 4 | loss: 1.0096048
	speed: 0.2875s/iter; left time: 121615.3812s
	iters: 1800, epoch: 4 | loss: 1.0180112
	speed: 0.2874s/iter; left time: 121530.7177s
	iters: 1900, epoch: 4 | loss: 1.0274763
	speed: 0.2879s/iter; left time: 121727.6041s
	iters: 2000, epoch: 4 | loss: 1.1850262
	speed: 0.2876s/iter; left time: 121564.3329s
	iters: 2100, epoch: 4 | loss: 0.9011585
	speed: 0.2872s/iter; left time: 121398.4873s
Epoch: 4 cost time: 620.1919016838074
Epoch: 4, Steps: 2156 | Train Loss: 0.9935225 Vali Loss: 0.7760142 Test Loss: 0.9115237
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 1.0006173
	speed: 1.8374s/iter; left time: 776254.7464s
	iters: 200, epoch: 5 | loss: 1.1543274
	speed: 0.2920s/iter; left time: 123318.2024s
	iters: 300, epoch: 5 | loss: 0.9093428
	speed: 0.2928s/iter; left time: 123634.9281s
	iters: 400, epoch: 5 | loss: 1.0691092
	speed: 0.2923s/iter; left time: 123413.5250s
	iters: 500, epoch: 5 | loss: 0.9224784
	speed: 0.2925s/iter; left time: 123466.7393s
	iters: 600, epoch: 5 | loss: 0.9914280
	speed: 0.2927s/iter; left time: 123503.9794s
	iters: 700, epoch: 5 | loss: 0.9817925
	speed: 0.2923s/iter; left time: 123307.6486s
	iters: 800, epoch: 5 | loss: 1.0772176
	speed: 0.2920s/iter; left time: 123153.4047s
	iters: 900, epoch: 5 | loss: 1.0576930
	speed: 0.2927s/iter; left time: 123422.6249s
	iters: 1000, epoch: 5 | loss: 1.2218593
	speed: 0.2913s/iter; left time: 122805.0941s
	iters: 1100, epoch: 5 | loss: 0.9391179
	speed: 0.2917s/iter; left time: 122954.9332s
	iters: 1200, epoch: 5 | loss: 0.9980296
	speed: 0.2918s/iter; left time: 122940.0840s
	iters: 1300, epoch: 5 | loss: 1.1676584
	speed: 0.2923s/iter; left time: 123154.1544s
	iters: 1400, epoch: 5 | loss: 1.0374908
	speed: 0.2924s/iter; left time: 123154.1652s
	iters: 1500, epoch: 5 | loss: 1.0424731
	speed: 0.2917s/iter; left time: 122848.7608s
	iters: 1600, epoch: 5 | loss: 0.8503706
	speed: 0.2921s/iter; left time: 122981.2869s
	iters: 1700, epoch: 5 | loss: 0.9184172
	speed: 0.2925s/iter; left time: 123116.4215s
	iters: 1800, epoch: 5 | loss: 1.0148369
	speed: 0.2919s/iter; left time: 122821.2231s
	iters: 1900, epoch: 5 | loss: 0.9940214
	speed: 0.2922s/iter; left time: 122909.8982s
	iters: 2000, epoch: 5 | loss: 1.0488800
	speed: 0.2921s/iter; left time: 122861.2661s
	iters: 2100, epoch: 5 | loss: 0.8976603
	speed: 0.2926s/iter; left time: 123034.5215s
Epoch: 5 cost time: 630.0721881389618
Epoch: 5, Steps: 2156 | Train Loss: 0.9982804 Vali Loss: 0.7672775 Test Loss: 0.8657830
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.9557375
	speed: 1.8401s/iter; left time: 773435.0281s
	iters: 200, epoch: 6 | loss: 0.9835786
	speed: 0.2927s/iter; left time: 123016.8889s
	iters: 300, epoch: 6 | loss: 0.9604185
	speed: 0.2927s/iter; left time: 122980.3195s
	iters: 400, epoch: 6 | loss: 1.0149188
	speed: 0.2920s/iter; left time: 122665.6476s
	iters: 500, epoch: 6 | loss: 0.9149553
	speed: 0.2920s/iter; left time: 122618.1506s
	iters: 600, epoch: 6 | loss: 0.9807140
	speed: 0.2922s/iter; left time: 122685.2709s
	iters: 700, epoch: 6 | loss: 1.0154854
	speed: 0.2924s/iter; left time: 122717.5213s
	iters: 800, epoch: 6 | loss: 1.0408372
	speed: 0.2923s/iter; left time: 122649.7659s
	iters: 900, epoch: 6 | loss: 0.9156262
	speed: 0.2923s/iter; left time: 122610.4810s
	iters: 1000, epoch: 6 | loss: 0.8741976
	speed: 0.2914s/iter; left time: 122222.0238s
	iters: 1100, epoch: 6 | loss: 0.9510161
	speed: 0.2923s/iter; left time: 122585.2488s
	iters: 1200, epoch: 6 | loss: 1.0338007
	speed: 0.2918s/iter; left time: 122336.3313s
	iters: 1300, epoch: 6 | loss: 1.0333195
	speed: 0.2925s/iter; left time: 122596.7756s
	iters: 1400, epoch: 6 | loss: 0.7990623
	speed: 0.2928s/iter; left time: 122707.3311s
	iters: 1500, epoch: 6 | loss: 0.8410959
	speed: 0.2917s/iter; left time: 122188.4342s
	iters: 1600, epoch: 6 | loss: 0.8743937
	speed: 0.2915s/iter; left time: 122065.7998s
	iters: 1700, epoch: 6 | loss: 0.9587045
	speed: 0.2917s/iter; left time: 122138.3174s
	iters: 1800, epoch: 6 | loss: 1.1536484
	speed: 0.2921s/iter; left time: 122279.6404s
	iters: 1900, epoch: 6 | loss: 1.1043009
	speed: 0.2920s/iter; left time: 122219.0595s
	iters: 2000, epoch: 6 | loss: 1.1966939
	speed: 0.2918s/iter; left time: 122088.5842s
	iters: 2100, epoch: 6 | loss: 1.1449696
	speed: 0.2924s/iter; left time: 122336.2326s
Epoch: 6 cost time: 630.0089309215546
Epoch: 6, Steps: 2156 | Train Loss: 0.9612048 Vali Loss: 0.7823213 Test Loss: 0.8773818
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.9978149
	speed: 1.8276s/iter; left time: 764243.0458s
	iters: 200, epoch: 7 | loss: 0.9352139
	speed: 0.2878s/iter; left time: 120325.2648s
	iters: 300, epoch: 7 | loss: 0.9581428
	speed: 0.2889s/iter; left time: 120740.8453s
	iters: 400, epoch: 7 | loss: 0.8134418
	speed: 0.2886s/iter; left time: 120588.7571s
	iters: 500, epoch: 7 | loss: 0.9139621
	speed: 0.2883s/iter; left time: 120441.2129s
	iters: 600, epoch: 7 | loss: 1.0329779
	speed: 0.2878s/iter; left time: 120207.5976s
	iters: 700, epoch: 7 | loss: 0.9334716
	speed: 0.2881s/iter; left time: 120308.4158s
	iters: 800, epoch: 7 | loss: 1.1270713
	speed: 0.2884s/iter; left time: 120405.1040s
	iters: 900, epoch: 7 | loss: 0.9738618
	speed: 0.2880s/iter; left time: 120189.2615s
	iters: 1000, epoch: 7 | loss: 1.0828071
	speed: 0.2882s/iter; left time: 120268.7195s
	iters: 1100, epoch: 7 | loss: 0.7634111
	speed: 0.2877s/iter; left time: 120009.3216s
	iters: 1200, epoch: 7 | loss: 0.8786500
	speed: 0.2883s/iter; left time: 120250.5325s
	iters: 1300, epoch: 7 | loss: 1.0738878
	speed: 0.2882s/iter; left time: 120176.3730s
	iters: 1400, epoch: 7 | loss: 0.8541740
	speed: 0.2881s/iter; left time: 120078.8063s
	iters: 1500, epoch: 7 | loss: 0.9113529
	speed: 0.2881s/iter; left time: 120090.4405s
	iters: 1600, epoch: 7 | loss: 0.7455080
	speed: 0.2885s/iter; left time: 120188.5919s
	iters: 1700, epoch: 7 | loss: 0.9311966
	speed: 0.2878s/iter; left time: 119881.0844s
	iters: 1800, epoch: 7 | loss: 0.9842187
	speed: 0.2881s/iter; left time: 119984.5145s
	iters: 1900, epoch: 7 | loss: 0.8889528
	speed: 0.2881s/iter; left time: 119969.3746s
	iters: 2000, epoch: 7 | loss: 1.0997002
	speed: 0.2883s/iter; left time: 119989.4970s
	iters: 2100, epoch: 7 | loss: 0.9016309
	speed: 0.2882s/iter; left time: 119923.7207s
Epoch: 7 cost time: 621.5007557868958
Epoch: 7, Steps: 2156 | Train Loss: 0.9275008 Vali Loss: 0.8053606 Test Loss: 0.9107084
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 89410
test shape: (8941, 1, 720, 130) (8941, 1, 720, 130)
test shape: (8941, 720, 130) (8941, 720, 130)
mse:0.8340704441070557, mae:0.6933199763298035
>>>>>>>Overall time: 5528 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
