Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1217078
val 300382
test 300381
	iters: 100, epoch: 1 | loss: 1.4162973
	speed: 0.1349s/iter; left time: 102567.0618s
	iters: 200, epoch: 1 | loss: 1.1082939
	speed: 0.1316s/iter; left time: 100043.7066s
	iters: 300, epoch: 1 | loss: 1.0736538
	speed: 0.1321s/iter; left time: 100416.4862s
	iters: 400, epoch: 1 | loss: 1.1164033
	speed: 0.1323s/iter; left time: 100592.3419s
	iters: 500, epoch: 1 | loss: 1.0656005
	speed: 0.1320s/iter; left time: 100296.7472s
	iters: 600, epoch: 1 | loss: 1.1096829
	speed: 0.1321s/iter; left time: 100426.3218s
	iters: 700, epoch: 1 | loss: 1.0618327
	speed: 0.1322s/iter; left time: 100423.2826s
	iters: 800, epoch: 1 | loss: 1.0006646
	speed: 0.1317s/iter; left time: 100068.6454s
	iters: 900, epoch: 1 | loss: 1.0172646
	speed: 0.1318s/iter; left time: 100138.5796s
	iters: 1000, epoch: 1 | loss: 1.1145575
	speed: 0.1322s/iter; left time: 100433.1448s
	iters: 1100, epoch: 1 | loss: 1.0921187
	speed: 0.1321s/iter; left time: 100325.0086s
	iters: 1200, epoch: 1 | loss: 0.9943373
	speed: 0.1321s/iter; left time: 100289.4081s
	iters: 1300, epoch: 1 | loss: 0.9127021
	speed: 0.1319s/iter; left time: 100182.7171s
	iters: 1400, epoch: 1 | loss: 0.9534472
	speed: 0.1317s/iter; left time: 99984.2798s
	iters: 1500, epoch: 1 | loss: 0.9259338
	speed: 0.1320s/iter; left time: 100185.0782s
	iters: 1600, epoch: 1 | loss: 0.9770299
	speed: 0.1316s/iter; left time: 99908.1602s
	iters: 1700, epoch: 1 | loss: 0.9295743
	speed: 0.1318s/iter; left time: 100043.3882s
	iters: 1800, epoch: 1 | loss: 0.9193035
	speed: 0.1320s/iter; left time: 100166.7255s
	iters: 1900, epoch: 1 | loss: 0.9499839
	speed: 0.1318s/iter; left time: 100029.1026s
	iters: 2000, epoch: 1 | loss: 0.9331040
	speed: 0.1319s/iter; left time: 100046.0196s
	iters: 2100, epoch: 1 | loss: 0.8821255
	speed: 0.1320s/iter; left time: 100139.8511s
	iters: 2200, epoch: 1 | loss: 0.8764495
	speed: 0.1319s/iter; left time: 100001.3065s
	iters: 2300, epoch: 1 | loss: 1.0427570
	speed: 0.1318s/iter; left time: 99959.1324s
	iters: 2400, epoch: 1 | loss: 0.9627376
	speed: 0.1319s/iter; left time: 100039.2237s
	iters: 2500, epoch: 1 | loss: 0.8220329
	speed: 0.1322s/iter; left time: 100245.8302s
	iters: 2600, epoch: 1 | loss: 0.8785591
	speed: 0.1322s/iter; left time: 100243.7231s
	iters: 2700, epoch: 1 | loss: 0.9625514
	speed: 0.1320s/iter; left time: 100039.6075s
	iters: 2800, epoch: 1 | loss: 0.9600241
	speed: 0.1317s/iter; left time: 99810.7629s
	iters: 2900, epoch: 1 | loss: 0.9432820
	speed: 0.1318s/iter; left time: 99890.8795s
	iters: 3000, epoch: 1 | loss: 0.9839337
	speed: 0.1319s/iter; left time: 99904.6942s
	iters: 3100, epoch: 1 | loss: 0.9086789
	speed: 0.1321s/iter; left time: 100033.1356s
	iters: 3200, epoch: 1 | loss: 0.8621624
	speed: 0.1318s/iter; left time: 99794.3639s
	iters: 3300, epoch: 1 | loss: 0.8226311
	speed: 0.1319s/iter; left time: 99885.0846s
	iters: 3400, epoch: 1 | loss: 0.8338906
	speed: 0.1318s/iter; left time: 99815.9864s
	iters: 3500, epoch: 1 | loss: 0.8608322
	speed: 0.1319s/iter; left time: 99835.4831s
	iters: 3600, epoch: 1 | loss: 0.8995351
	speed: 0.1321s/iter; left time: 99976.1963s
	iters: 3700, epoch: 1 | loss: 0.9335623
	speed: 0.1317s/iter; left time: 99720.9178s
	iters: 3800, epoch: 1 | loss: 0.8337154
	speed: 0.1321s/iter; left time: 99957.3590s
Epoch: 1 cost time: 502.23967146873474
Epoch: 1, Steps: 3803 | Train Loss: 0.9832777 Vali Loss: 1.3774198 Test Loss: 1.4600847
Validation loss decreased (inf --> 1.377420).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8857839
	speed: 4.0996s/iter; left time: 3102128.6172s
	iters: 200, epoch: 2 | loss: 0.8914273
	speed: 0.1317s/iter; left time: 99628.3014s
	iters: 300, epoch: 2 | loss: 0.7662370
	speed: 0.1320s/iter; left time: 99869.2111s
	iters: 400, epoch: 2 | loss: 0.8473009
	speed: 0.1317s/iter; left time: 99643.1929s
	iters: 500, epoch: 2 | loss: 0.8080874
	speed: 0.1318s/iter; left time: 99688.3408s
	iters: 600, epoch: 2 | loss: 0.9071934
	speed: 0.1318s/iter; left time: 99695.3487s
	iters: 700, epoch: 2 | loss: 0.9117453
	speed: 0.1317s/iter; left time: 99576.0647s
	iters: 800, epoch: 2 | loss: 0.8718581
	speed: 0.1320s/iter; left time: 99801.5669s
	iters: 900, epoch: 2 | loss: 0.8788246
	speed: 0.1317s/iter; left time: 99576.9457s
	iters: 1000, epoch: 2 | loss: 0.8267404
	speed: 0.1317s/iter; left time: 99508.5386s
	iters: 1100, epoch: 2 | loss: 0.9056698
	speed: 0.1320s/iter; left time: 99774.3246s
	iters: 1200, epoch: 2 | loss: 0.8895401
	speed: 0.1319s/iter; left time: 99631.6164s
	iters: 1300, epoch: 2 | loss: 0.7613122
	speed: 0.1319s/iter; left time: 99654.1043s
	iters: 1400, epoch: 2 | loss: 1.0388546
	speed: 0.1317s/iter; left time: 99499.7705s
	iters: 1500, epoch: 2 | loss: 0.8920156
	speed: 0.1318s/iter; left time: 99521.5589s
	iters: 1600, epoch: 2 | loss: 0.9363440
	speed: 0.1319s/iter; left time: 99593.5152s
	iters: 1700, epoch: 2 | loss: 0.9333535
	speed: 0.1318s/iter; left time: 99502.2649s
	iters: 1800, epoch: 2 | loss: 0.7284412
	speed: 0.1316s/iter; left time: 99359.5087s
	iters: 1900, epoch: 2 | loss: 0.8601441
	speed: 0.1317s/iter; left time: 99420.3335s
	iters: 2000, epoch: 2 | loss: 0.8290091
	speed: 0.1316s/iter; left time: 99367.9597s
	iters: 2100, epoch: 2 | loss: 0.8532240
	speed: 0.1319s/iter; left time: 99575.1475s
	iters: 2200, epoch: 2 | loss: 0.8035910
	speed: 0.1317s/iter; left time: 99375.3830s
	iters: 2300, epoch: 2 | loss: 0.8019137
	speed: 0.1317s/iter; left time: 99378.0203s
	iters: 2400, epoch: 2 | loss: 0.7912789
	speed: 0.1317s/iter; left time: 99369.4839s
	iters: 2500, epoch: 2 | loss: 0.8027729
	speed: 0.1318s/iter; left time: 99406.6433s
	iters: 2600, epoch: 2 | loss: 0.8226127
	speed: 0.1317s/iter; left time: 99350.1113s
	iters: 2700, epoch: 2 | loss: 0.8438784
	speed: 0.1318s/iter; left time: 99417.4865s
	iters: 2800, epoch: 2 | loss: 0.8270025
	speed: 0.1322s/iter; left time: 99669.4881s
	iters: 2900, epoch: 2 | loss: 0.8706390
	speed: 0.1316s/iter; left time: 99218.6699s
	iters: 3000, epoch: 2 | loss: 0.7867063
	speed: 0.1318s/iter; left time: 99370.3622s
	iters: 3100, epoch: 2 | loss: 0.8509496
	speed: 0.1321s/iter; left time: 99578.3184s
	iters: 3200, epoch: 2 | loss: 0.7548848
	speed: 0.1319s/iter; left time: 99362.4672s
	iters: 3300, epoch: 2 | loss: 0.7507530
	speed: 0.1322s/iter; left time: 99592.7248s
	iters: 3400, epoch: 2 | loss: 0.7862678
	speed: 0.1319s/iter; left time: 99381.7360s
	iters: 3500, epoch: 2 | loss: 0.7834209
	speed: 0.1320s/iter; left time: 99439.5390s
	iters: 3600, epoch: 2 | loss: 0.8556306
	speed: 0.1316s/iter; left time: 99115.8616s
	iters: 3700, epoch: 2 | loss: 0.7348194
	speed: 0.1318s/iter; left time: 99268.7327s
	iters: 3800, epoch: 2 | loss: 0.7483340
	speed: 0.1321s/iter; left time: 99446.1714s
Epoch: 2 cost time: 501.53303050994873
Epoch: 2, Steps: 3803 | Train Loss: 0.8375078 Vali Loss: 1.4305619 Test Loss: 1.5449719
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.6819203
	speed: 4.1004s/iter; left time: 3087202.3061s
	iters: 200, epoch: 3 | loss: 0.8698046
	speed: 0.1318s/iter; left time: 99183.5318s
	iters: 300, epoch: 3 | loss: 0.7273161
	speed: 0.1316s/iter; left time: 99057.4299s
	iters: 400, epoch: 3 | loss: 0.7877902
	speed: 0.1319s/iter; left time: 99296.4656s
	iters: 500, epoch: 3 | loss: 0.7406002
	speed: 0.1321s/iter; left time: 99414.4698s
	iters: 600, epoch: 3 | loss: 0.7228351
	speed: 0.1316s/iter; left time: 99046.5625s
	iters: 700, epoch: 3 | loss: 0.8055879
	speed: 0.1317s/iter; left time: 99042.3287s
	iters: 800, epoch: 3 | loss: 0.7266501
	speed: 0.1319s/iter; left time: 99220.6130s
	iters: 900, epoch: 3 | loss: 0.7992718
	speed: 0.1320s/iter; left time: 99276.4830s
	iters: 1000, epoch: 3 | loss: 0.7125230
	speed: 0.1316s/iter; left time: 98978.9692s
	iters: 1100, epoch: 3 | loss: 0.7548060
	speed: 0.1321s/iter; left time: 99290.5522s
	iters: 1200, epoch: 3 | loss: 0.7551167
	speed: 0.1316s/iter; left time: 98949.1066s
	iters: 1300, epoch: 3 | loss: 0.8618790
	speed: 0.1321s/iter; left time: 99269.0180s
	iters: 1400, epoch: 3 | loss: 0.7092696
	speed: 0.1319s/iter; left time: 99170.7736s
	iters: 1500, epoch: 3 | loss: 0.7434785
	speed: 0.1319s/iter; left time: 99133.5181s
	iters: 1600, epoch: 3 | loss: 0.7020409
	speed: 0.1317s/iter; left time: 98980.8270s
	iters: 1700, epoch: 3 | loss: 0.7446929
	speed: 0.1323s/iter; left time: 99429.0830s
	iters: 1800, epoch: 3 | loss: 0.6948598
	speed: 0.1319s/iter; left time: 99097.2193s
	iters: 1900, epoch: 3 | loss: 0.7728264
	speed: 0.1321s/iter; left time: 99202.3798s
	iters: 2000, epoch: 3 | loss: 0.7373683
	speed: 0.1321s/iter; left time: 99195.2885s
	iters: 2100, epoch: 3 | loss: 0.7842031
	speed: 0.1321s/iter; left time: 99217.6258s
	iters: 2200, epoch: 3 | loss: 0.6880714
	speed: 0.1318s/iter; left time: 98975.1986s
	iters: 2300, epoch: 3 | loss: 0.7360572
	speed: 0.1323s/iter; left time: 99339.2746s
	iters: 2400, epoch: 3 | loss: 0.7395223
	speed: 0.1317s/iter; left time: 98883.7846s
	iters: 2500, epoch: 3 | loss: 0.6732667
	speed: 0.1319s/iter; left time: 98957.9597s
	iters: 2600, epoch: 3 | loss: 0.7012914
	speed: 0.1322s/iter; left time: 99196.2097s
	iters: 2700, epoch: 3 | loss: 0.7646781
	speed: 0.1325s/iter; left time: 99418.4523s
	iters: 2800, epoch: 3 | loss: 0.7312539
	speed: 0.1318s/iter; left time: 98901.8849s
	iters: 2900, epoch: 3 | loss: 0.6954430
	speed: 0.1322s/iter; left time: 99146.9307s
	iters: 3000, epoch: 3 | loss: 0.6877992
	speed: 0.1318s/iter; left time: 98865.5670s
	iters: 3100, epoch: 3 | loss: 0.7141042
	speed: 0.1325s/iter; left time: 99365.6484s
	iters: 3200, epoch: 3 | loss: 0.7472307
	speed: 0.1320s/iter; left time: 99001.3497s
	iters: 3300, epoch: 3 | loss: 0.6898555
	speed: 0.1320s/iter; left time: 98969.6873s
	iters: 3400, epoch: 3 | loss: 0.6269214
	speed: 0.1319s/iter; left time: 98873.5325s
	iters: 3500, epoch: 3 | loss: 0.7928811
	speed: 0.1321s/iter; left time: 99029.0039s
	iters: 3600, epoch: 3 | loss: 0.7179063
	speed: 0.1321s/iter; left time: 99027.2779s
	iters: 3700, epoch: 3 | loss: 0.7527047
	speed: 0.1321s/iter; left time: 98956.9969s
	iters: 3800, epoch: 3 | loss: 0.6628304
	speed: 0.1317s/iter; left time: 98657.8736s
Epoch: 3 cost time: 502.06831645965576
Epoch: 3, Steps: 3803 | Train Loss: 0.7283784 Vali Loss: 1.4115784 Test Loss: 1.4892633
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.6750166
	speed: 4.0985s/iter; left time: 3070188.8396s
	iters: 200, epoch: 4 | loss: 0.7397819
	speed: 0.1318s/iter; left time: 98684.6671s
	iters: 300, epoch: 4 | loss: 0.5992846
	speed: 0.1318s/iter; left time: 98715.5165s
	iters: 400, epoch: 4 | loss: 0.5928841
	speed: 0.1318s/iter; left time: 98666.9707s
	iters: 500, epoch: 4 | loss: 0.6734448
	speed: 0.1320s/iter; left time: 98801.8560s
	iters: 600, epoch: 4 | loss: 0.6927583
	speed: 0.1326s/iter; left time: 99272.3676s
	iters: 700, epoch: 4 | loss: 0.6649409
	speed: 0.1329s/iter; left time: 99502.8216s
	iters: 800, epoch: 4 | loss: 0.6630025
	speed: 0.1321s/iter; left time: 98829.0635s
	iters: 900, epoch: 4 | loss: 0.7383549
	speed: 0.1327s/iter; left time: 99334.6951s
	iters: 1000, epoch: 4 | loss: 0.6188244
	speed: 0.1322s/iter; left time: 98873.6917s
	iters: 1100, epoch: 4 | loss: 0.6395300
	speed: 0.1321s/iter; left time: 98825.3649s
	iters: 1200, epoch: 4 | loss: 0.6429579
	speed: 0.1318s/iter; left time: 98581.2087s
	iters: 1300, epoch: 4 | loss: 0.7272128
	speed: 0.1330s/iter; left time: 99485.5606s
	iters: 1400, epoch: 4 | loss: 0.6733446
	speed: 0.1320s/iter; left time: 98696.6276s
	iters: 1500, epoch: 4 | loss: 0.7014259
	speed: 0.1337s/iter; left time: 99940.5374s
	iters: 1600, epoch: 4 | loss: 0.6792330
	speed: 0.1320s/iter; left time: 98651.3730s
	iters: 1700, epoch: 4 | loss: 0.6845826
	speed: 0.1317s/iter; left time: 98460.8772s
	iters: 1800, epoch: 4 | loss: 0.6790768
	speed: 0.1322s/iter; left time: 98806.4379s
	iters: 1900, epoch: 4 | loss: 0.6430467
	speed: 0.1321s/iter; left time: 98749.0249s
	iters: 2000, epoch: 4 | loss: 0.6384709
	speed: 0.1322s/iter; left time: 98803.4307s
	iters: 2100, epoch: 4 | loss: 0.6918749
	speed: 0.1323s/iter; left time: 98842.9899s
	iters: 2200, epoch: 4 | loss: 0.6950791
	speed: 0.1322s/iter; left time: 98787.1552s
	iters: 2300, epoch: 4 | loss: 0.5972767
	speed: 0.1322s/iter; left time: 98720.1294s
	iters: 2400, epoch: 4 | loss: 0.6138900
	speed: 0.1324s/iter; left time: 98908.7181s
	iters: 2500, epoch: 4 | loss: 0.6560230
	speed: 0.1327s/iter; left time: 99093.3184s
	iters: 2600, epoch: 4 | loss: 0.6585904
	speed: 0.1324s/iter; left time: 98836.8334s
	iters: 2700, epoch: 4 | loss: 0.7279156
	speed: 0.1325s/iter; left time: 98900.7839s
	iters: 2800, epoch: 4 | loss: 0.6673673
	speed: 0.1320s/iter; left time: 98504.3954s
	iters: 2900, epoch: 4 | loss: 0.7647969
	speed: 0.1324s/iter; left time: 98832.5583s
	iters: 3000, epoch: 4 | loss: 0.6103180
	speed: 0.1323s/iter; left time: 98753.7746s
	iters: 3100, epoch: 4 | loss: 0.6500981
	speed: 0.1320s/iter; left time: 98487.7856s
	iters: 3200, epoch: 4 | loss: 0.6780632
	speed: 0.1320s/iter; left time: 98483.3944s
	iters: 3300, epoch: 4 | loss: 0.5938172
	speed: 0.1321s/iter; left time: 98544.0634s
	iters: 3400, epoch: 4 | loss: 0.6345484
	speed: 0.1328s/iter; left time: 99028.1474s
	iters: 3500, epoch: 4 | loss: 0.6746515
	speed: 0.1323s/iter; left time: 98642.4484s
	iters: 3600, epoch: 4 | loss: 0.6281707
	speed: 0.1325s/iter; left time: 98802.0075s
	iters: 3700, epoch: 4 | loss: 0.6012416
	speed: 0.1323s/iter; left time: 98662.5701s
	iters: 3800, epoch: 4 | loss: 0.6604876
	speed: 0.1322s/iter; left time: 98526.8275s
Epoch: 4 cost time: 503.31419944763184
Epoch: 4, Steps: 3803 | Train Loss: 0.6682307 Vali Loss: 1.4642485 Test Loss: 1.5363655
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.6812640
	speed: 4.1070s/iter; left time: 3060875.3088s
	iters: 200, epoch: 5 | loss: 0.6880310
	speed: 0.1329s/iter; left time: 99052.8799s
	iters: 300, epoch: 5 | loss: 0.6170307
	speed: 0.1321s/iter; left time: 98448.7770s
	iters: 400, epoch: 5 | loss: 0.6451159
	speed: 0.1322s/iter; left time: 98484.8338s
	iters: 500, epoch: 5 | loss: 0.6249736
	speed: 0.1317s/iter; left time: 98111.4898s
	iters: 600, epoch: 5 | loss: 0.6290044
	speed: 0.1323s/iter; left time: 98548.6790s
	iters: 700, epoch: 5 | loss: 0.7647241
	speed: 0.1319s/iter; left time: 98198.8576s
	iters: 800, epoch: 5 | loss: 0.7126215
	speed: 0.1319s/iter; left time: 98239.7075s
	iters: 900, epoch: 5 | loss: 0.6745166
	speed: 0.1320s/iter; left time: 98257.9046s
	iters: 1000, epoch: 5 | loss: 0.6654315
	speed: 0.1319s/iter; left time: 98168.0688s
	iters: 1100, epoch: 5 | loss: 0.6334280
	speed: 0.1321s/iter; left time: 98313.4454s
	iters: 1200, epoch: 5 | loss: 0.6894199
	speed: 0.1323s/iter; left time: 98447.7255s
	iters: 1300, epoch: 5 | loss: 0.6510185
	speed: 0.1322s/iter; left time: 98348.9983s
	iters: 1400, epoch: 5 | loss: 0.7911546
	speed: 0.1320s/iter; left time: 98219.7260s
	iters: 1500, epoch: 5 | loss: 0.6588212
	speed: 0.1320s/iter; left time: 98170.4693s
	iters: 1600, epoch: 5 | loss: 0.6838529
	speed: 0.1325s/iter; left time: 98588.9508s
	iters: 1700, epoch: 5 | loss: 0.6715720
	speed: 0.1318s/iter; left time: 98045.8231s
	iters: 1800, epoch: 5 | loss: 0.6572120
	speed: 0.1320s/iter; left time: 98130.6498s
	iters: 1900, epoch: 5 | loss: 0.6297555
	speed: 0.1320s/iter; left time: 98170.8335s
	iters: 2000, epoch: 5 | loss: 0.5967364
	speed: 0.1324s/iter; left time: 98403.0275s
	iters: 2100, epoch: 5 | loss: 0.6446158
	speed: 0.1321s/iter; left time: 98183.2405s
	iters: 2200, epoch: 5 | loss: 0.6080839
	speed: 0.1320s/iter; left time: 98104.6180s
	iters: 2300, epoch: 5 | loss: 0.5704437
	speed: 0.1316s/iter; left time: 97827.1546s
	iters: 2400, epoch: 5 | loss: 0.6817325
	speed: 0.1323s/iter; left time: 98284.8978s
	iters: 2500, epoch: 5 | loss: 0.6801383
	speed: 0.1319s/iter; left time: 97958.4779s
	iters: 2600, epoch: 5 | loss: 0.5688252
	speed: 0.1321s/iter; left time: 98120.0771s
	iters: 2700, epoch: 5 | loss: 0.6669858
	speed: 0.1318s/iter; left time: 97880.4647s
	iters: 2800, epoch: 5 | loss: 0.5848573
	speed: 0.1318s/iter; left time: 97854.2513s
	iters: 2900, epoch: 5 | loss: 0.5573513
	speed: 0.1317s/iter; left time: 97781.8436s
	iters: 3000, epoch: 5 | loss: 0.6466653
	speed: 0.1323s/iter; left time: 98232.7027s
	iters: 3100, epoch: 5 | loss: 0.6742646
	speed: 0.1319s/iter; left time: 97894.2942s
	iters: 3200, epoch: 5 | loss: 0.5797144
	speed: 0.1316s/iter; left time: 97699.3360s
	iters: 3300, epoch: 5 | loss: 0.6326615
	speed: 0.1319s/iter; left time: 97902.7868s
	iters: 3400, epoch: 5 | loss: 0.6828778
	speed: 0.1320s/iter; left time: 97972.5123s
	iters: 3500, epoch: 5 | loss: 0.6733600
	speed: 0.1317s/iter; left time: 97703.9960s
	iters: 3600, epoch: 5 | loss: 0.6554229
	speed: 0.1318s/iter; left time: 97797.4247s
	iters: 3700, epoch: 5 | loss: 0.6406848
	speed: 0.1322s/iter; left time: 98043.6026s
	iters: 3800, epoch: 5 | loss: 0.5997939
	speed: 0.1321s/iter; left time: 97991.6449s
Epoch: 5 cost time: 502.3234589099884
Epoch: 5, Steps: 3803 | Train Loss: 0.6396785 Vali Loss: 1.4160792 Test Loss: 1.4340219
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.7241230
	speed: 4.1033s/iter; left time: 3042542.3512s
	iters: 200, epoch: 6 | loss: 0.7288551
	speed: 0.1321s/iter; left time: 97951.1575s
	iters: 300, epoch: 6 | loss: 0.6209007
	speed: 0.1323s/iter; left time: 98075.4553s
	iters: 400, epoch: 6 | loss: 0.6942531
	speed: 0.1319s/iter; left time: 97766.5671s
	iters: 500, epoch: 6 | loss: 0.6258933
	speed: 0.1322s/iter; left time: 98002.4122s
	iters: 600, epoch: 6 | loss: 0.6039356
	speed: 0.1320s/iter; left time: 97823.8032s
	iters: 700, epoch: 6 | loss: 0.5765857
	speed: 0.1318s/iter; left time: 97677.8875s
	iters: 800, epoch: 6 | loss: 0.6130077
	speed: 0.1326s/iter; left time: 98236.6464s
	iters: 900, epoch: 6 | loss: 0.6092287
	speed: 0.1320s/iter; left time: 97762.3019s
	iters: 1000, epoch: 6 | loss: 0.5590479
	speed: 0.1321s/iter; left time: 97831.8117s
	iters: 1100, epoch: 6 | loss: 0.6606382
	speed: 0.1317s/iter; left time: 97538.1995s
	iters: 1200, epoch: 6 | loss: 0.6724001
	speed: 0.1318s/iter; left time: 97614.4974s
	iters: 1300, epoch: 6 | loss: 0.6032734
	speed: 0.1318s/iter; left time: 97545.6333s
	iters: 1400, epoch: 6 | loss: 0.6055326
	speed: 0.1319s/iter; left time: 97665.2304s
	iters: 1500, epoch: 6 | loss: 0.6127645
	speed: 0.1324s/iter; left time: 97980.4890s
	iters: 1600, epoch: 6 | loss: 0.6151738
	speed: 0.1316s/iter; left time: 97368.5416s
	iters: 1700, epoch: 6 | loss: 0.5648093
	speed: 0.1325s/iter; left time: 98016.8014s
	iters: 1800, epoch: 6 | loss: 0.5327590
	speed: 0.1326s/iter; left time: 98070.3890s
	iters: 1900, epoch: 6 | loss: 0.5698324
	speed: 0.1321s/iter; left time: 97734.8792s
	iters: 2000, epoch: 6 | loss: 0.6247512
	speed: 0.1321s/iter; left time: 97687.1229s
	iters: 2100, epoch: 6 | loss: 0.5734634
	speed: 0.1319s/iter; left time: 97507.8631s
	iters: 2200, epoch: 6 | loss: 0.5796443
	speed: 0.1321s/iter; left time: 97651.2080s
	iters: 2300, epoch: 6 | loss: 0.6140555
	speed: 0.1317s/iter; left time: 97355.3900s
	iters: 2400, epoch: 6 | loss: 0.5625050
	speed: 0.1319s/iter; left time: 97515.7727s
	iters: 2500, epoch: 6 | loss: 0.6346305
	speed: 0.1320s/iter; left time: 97551.8493s
	iters: 2600, epoch: 6 | loss: 0.6494082
	speed: 0.1320s/iter; left time: 97566.5620s
	iters: 2700, epoch: 6 | loss: 0.6461521
	speed: 0.1326s/iter; left time: 97994.6134s
	iters: 2800, epoch: 6 | loss: 0.6572364
	speed: 0.1321s/iter; left time: 97596.3522s
	iters: 2900, epoch: 6 | loss: 0.6239231
	speed: 0.1320s/iter; left time: 97526.1066s
	iters: 3000, epoch: 6 | loss: 0.7384109
	speed: 0.1318s/iter; left time: 97366.9196s
	iters: 3100, epoch: 6 | loss: 0.6133139
	speed: 0.1320s/iter; left time: 97479.8478s
	iters: 3200, epoch: 6 | loss: 0.6266074
	speed: 0.1317s/iter; left time: 97221.2605s
	iters: 3300, epoch: 6 | loss: 0.5940953
	speed: 0.1378s/iter; left time: 101701.7910s
	iters: 3400, epoch: 6 | loss: 0.6637150
	speed: 0.1379s/iter; left time: 101817.5777s
	iters: 3500, epoch: 6 | loss: 0.5922716
	speed: 0.1391s/iter; left time: 102660.2703s
	iters: 3600, epoch: 6 | loss: 0.5699689
	speed: 0.1348s/iter; left time: 99460.9949s
	iters: 3700, epoch: 6 | loss: 0.6439602
	speed: 0.1317s/iter; left time: 97181.4991s
	iters: 3800, epoch: 6 | loss: 0.6080722
	speed: 0.1323s/iter; left time: 97573.4995s
Epoch: 6 cost time: 504.447149515152
Epoch: 6, Steps: 3803 | Train Loss: 0.6165710 Vali Loss: 1.4328634 Test Loss: 1.5240166
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 300381
test shape: (30038, 1, 192, 151) (30038, 1, 192, 151)
test shape: (30038, 192, 151) (30038, 192, 151)
mse:1.4600887298583984, mae:0.9225136041641235
>>>>>>>Overall time: 5883 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
