Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164518
val 247822
test 247821
	iters: 100, epoch: 1 | loss: 1.4456594
	speed: 0.1755s/iter; left time: 127725.1048s
	iters: 200, epoch: 1 | loss: 1.3341236
	speed: 0.1717s/iter; left time: 124945.3641s
	iters: 300, epoch: 1 | loss: 1.2583482
	speed: 0.1725s/iter; left time: 125489.7823s
	iters: 400, epoch: 1 | loss: 1.2104597
	speed: 0.1698s/iter; left time: 123484.9782s
	iters: 500, epoch: 1 | loss: 1.2567517
	speed: 0.1696s/iter; left time: 123354.6907s
	iters: 600, epoch: 1 | loss: 1.2486941
	speed: 0.1694s/iter; left time: 123193.9250s
	iters: 700, epoch: 1 | loss: 1.1878096
	speed: 0.1692s/iter; left time: 123012.9753s
	iters: 800, epoch: 1 | loss: 1.2334377
	speed: 0.1694s/iter; left time: 123179.6158s
	iters: 900, epoch: 1 | loss: 1.1973400
	speed: 0.1695s/iter; left time: 123220.8427s
	iters: 1000, epoch: 1 | loss: 1.1769661
	speed: 0.1698s/iter; left time: 123400.3315s
	iters: 1100, epoch: 1 | loss: 1.1616440
	speed: 0.1700s/iter; left time: 123547.6077s
	iters: 1200, epoch: 1 | loss: 1.2396543
	speed: 0.1691s/iter; left time: 122832.4930s
	iters: 1300, epoch: 1 | loss: 1.1234639
	speed: 0.1695s/iter; left time: 123119.6189s
	iters: 1400, epoch: 1 | loss: 1.1293634
	speed: 0.1694s/iter; left time: 123051.4500s
	iters: 1500, epoch: 1 | loss: 1.2568971
	speed: 0.1694s/iter; left time: 123023.3099s
	iters: 1600, epoch: 1 | loss: 1.2014258
	speed: 0.1694s/iter; left time: 123005.1700s
	iters: 1700, epoch: 1 | loss: 1.1802628
	speed: 0.1697s/iter; left time: 123227.7274s
	iters: 1800, epoch: 1 | loss: 1.1439062
	speed: 0.1696s/iter; left time: 123114.4028s
	iters: 1900, epoch: 1 | loss: 1.1265810
	speed: 0.1699s/iter; left time: 123351.6908s
	iters: 2000, epoch: 1 | loss: 1.1077422
	speed: 0.1697s/iter; left time: 123162.1553s
	iters: 2100, epoch: 1 | loss: 1.1039808
	speed: 0.1703s/iter; left time: 123574.0004s
	iters: 2200, epoch: 1 | loss: 1.1257248
	speed: 0.1696s/iter; left time: 123080.5824s
	iters: 2300, epoch: 1 | loss: 1.2338848
	speed: 0.1700s/iter; left time: 123332.1361s
	iters: 2400, epoch: 1 | loss: 1.1309208
	speed: 0.1694s/iter; left time: 122848.5873s
	iters: 2500, epoch: 1 | loss: 1.1648576
	speed: 0.1693s/iter; left time: 122818.7034s
	iters: 2600, epoch: 1 | loss: 1.1222191
	speed: 0.1691s/iter; left time: 122664.3462s
	iters: 2700, epoch: 1 | loss: 1.0645781
	speed: 0.1695s/iter; left time: 122921.3751s
	iters: 2800, epoch: 1 | loss: 1.0842052
	speed: 0.1699s/iter; left time: 123182.1486s
	iters: 2900, epoch: 1 | loss: 1.0559659
	speed: 0.1699s/iter; left time: 123156.2469s
	iters: 3000, epoch: 1 | loss: 1.1560478
	speed: 0.1694s/iter; left time: 122769.7325s
	iters: 3100, epoch: 1 | loss: 0.9995459
	speed: 0.1695s/iter; left time: 122814.4290s
	iters: 3200, epoch: 1 | loss: 1.1097015
	speed: 0.1694s/iter; left time: 122737.4365s
	iters: 3300, epoch: 1 | loss: 1.0955296
	speed: 0.1692s/iter; left time: 122569.5573s
	iters: 3400, epoch: 1 | loss: 1.0421188
	speed: 0.1693s/iter; left time: 122627.8498s
	iters: 3500, epoch: 1 | loss: 1.0529088
	speed: 0.1693s/iter; left time: 122627.4253s
	iters: 3600, epoch: 1 | loss: 1.1108669
	speed: 0.1695s/iter; left time: 122759.4719s
Epoch: 1 cost time: 618.2813446521759
Epoch: 1, Steps: 3639 | Train Loss: 1.1494746 Vali Loss: 1.3678024 Test Loss: 1.2204089
Validation loss decreased (inf --> 1.367802).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0941297
	speed: 3.6603s/iter; left time: 2650314.3193s
	iters: 200, epoch: 2 | loss: 0.9633908
	speed: 0.1708s/iter; left time: 123639.2337s
	iters: 300, epoch: 2 | loss: 0.9881015
	speed: 0.1700s/iter; left time: 123051.2400s
	iters: 400, epoch: 2 | loss: 1.0349004
	speed: 0.1701s/iter; left time: 123089.6803s
	iters: 500, epoch: 2 | loss: 1.0187118
	speed: 0.1704s/iter; left time: 123324.9774s
	iters: 600, epoch: 2 | loss: 1.0316745
	speed: 0.1702s/iter; left time: 123125.4918s
	iters: 700, epoch: 2 | loss: 0.9805553
	speed: 0.1703s/iter; left time: 123230.7028s
	iters: 800, epoch: 2 | loss: 1.0227191
	speed: 0.1695s/iter; left time: 122631.5034s
	iters: 900, epoch: 2 | loss: 0.9357937
	speed: 0.1701s/iter; left time: 123038.2919s
	iters: 1000, epoch: 2 | loss: 1.0025492
	speed: 0.1705s/iter; left time: 123326.7830s
	iters: 1100, epoch: 2 | loss: 0.9735059
	speed: 0.1699s/iter; left time: 122839.7832s
	iters: 1200, epoch: 2 | loss: 1.1089464
	speed: 0.1696s/iter; left time: 122587.7126s
	iters: 1300, epoch: 2 | loss: 1.0380889
	speed: 0.1705s/iter; left time: 123276.9709s
	iters: 1400, epoch: 2 | loss: 0.9552858
	speed: 0.1698s/iter; left time: 122736.7917s
	iters: 1500, epoch: 2 | loss: 1.0103052
	speed: 0.1697s/iter; left time: 122646.0018s
	iters: 1600, epoch: 2 | loss: 1.1054943
	speed: 0.1695s/iter; left time: 122502.4396s
	iters: 1700, epoch: 2 | loss: 1.0419068
	speed: 0.1698s/iter; left time: 122707.9617s
	iters: 1800, epoch: 2 | loss: 0.9814200
	speed: 0.1698s/iter; left time: 122641.4659s
	iters: 1900, epoch: 2 | loss: 1.0362190
	speed: 0.1697s/iter; left time: 122561.7330s
	iters: 2000, epoch: 2 | loss: 1.0091486
	speed: 0.1701s/iter; left time: 122873.4150s
	iters: 2100, epoch: 2 | loss: 1.0431913
	speed: 0.1696s/iter; left time: 122461.4159s
	iters: 2200, epoch: 2 | loss: 0.9068717
	speed: 0.1695s/iter; left time: 122348.2633s
	iters: 2300, epoch: 2 | loss: 0.9803022
	speed: 0.1701s/iter; left time: 122764.3250s
	iters: 2400, epoch: 2 | loss: 0.9345058
	speed: 0.1697s/iter; left time: 122499.4574s
	iters: 2500, epoch: 2 | loss: 0.9863368
	speed: 0.1700s/iter; left time: 122692.5193s
	iters: 2600, epoch: 2 | loss: 1.0088340
	speed: 0.1699s/iter; left time: 122599.2605s
	iters: 2700, epoch: 2 | loss: 1.0726345
	speed: 0.1696s/iter; left time: 122328.7443s
	iters: 2800, epoch: 2 | loss: 1.0714778
	speed: 0.1704s/iter; left time: 122938.8878s
	iters: 2900, epoch: 2 | loss: 0.9627788
	speed: 0.1702s/iter; left time: 122761.8738s
	iters: 3000, epoch: 2 | loss: 1.0084955
	speed: 0.1693s/iter; left time: 122110.1152s
	iters: 3100, epoch: 2 | loss: 0.9905240
	speed: 0.1701s/iter; left time: 122680.7645s
	iters: 3200, epoch: 2 | loss: 0.9326041
	speed: 0.1697s/iter; left time: 122366.7887s
	iters: 3300, epoch: 2 | loss: 0.9562238
	speed: 0.1701s/iter; left time: 122646.2778s
	iters: 3400, epoch: 2 | loss: 1.0212071
	speed: 0.1701s/iter; left time: 122622.3748s
	iters: 3500, epoch: 2 | loss: 1.1007272
	speed: 0.1702s/iter; left time: 122643.9284s
	iters: 3600, epoch: 2 | loss: 1.0635458
	speed: 0.1699s/iter; left time: 122393.0727s
Epoch: 2 cost time: 618.8544406890869
Epoch: 2, Steps: 3639 | Train Loss: 1.0244894 Vali Loss: 1.4545434 Test Loss: 1.3109618
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 1.0099809
	speed: 3.6427s/iter; left time: 2624255.7191s
	iters: 200, epoch: 3 | loss: 1.0045767
	speed: 0.1704s/iter; left time: 122713.6425s
	iters: 300, epoch: 3 | loss: 0.9453536
	speed: 0.1699s/iter; left time: 122343.1905s
	iters: 400, epoch: 3 | loss: 0.9199331
	speed: 0.1698s/iter; left time: 122285.1696s
	iters: 500, epoch: 3 | loss: 1.0517242
	speed: 0.1700s/iter; left time: 122394.8443s
	iters: 600, epoch: 3 | loss: 0.9294356
	speed: 0.1696s/iter; left time: 122075.6285s
	iters: 700, epoch: 3 | loss: 0.9830153
	speed: 0.1701s/iter; left time: 122430.5585s
	iters: 800, epoch: 3 | loss: 1.0630854
	speed: 0.1706s/iter; left time: 122805.9526s
	iters: 900, epoch: 3 | loss: 1.1542325
	speed: 0.1700s/iter; left time: 122306.9642s
	iters: 1000, epoch: 3 | loss: 1.0088418
	speed: 0.1698s/iter; left time: 122166.6580s
	iters: 1100, epoch: 3 | loss: 0.9841897
	speed: 0.1693s/iter; left time: 121795.6060s
	iters: 1200, epoch: 3 | loss: 1.0633630
	speed: 0.1701s/iter; left time: 122333.9504s
	iters: 1300, epoch: 3 | loss: 0.9982699
	speed: 0.1704s/iter; left time: 122537.9729s
	iters: 1400, epoch: 3 | loss: 0.9416602
	speed: 0.1700s/iter; left time: 122252.7548s
	iters: 1500, epoch: 3 | loss: 1.0030491
	speed: 0.1701s/iter; left time: 122276.7294s
	iters: 1600, epoch: 3 | loss: 0.9877264
	speed: 0.1701s/iter; left time: 122256.7839s
	iters: 1700, epoch: 3 | loss: 1.0784957
	speed: 0.1700s/iter; left time: 122211.3702s
	iters: 1800, epoch: 3 | loss: 0.9837952
	speed: 0.1698s/iter; left time: 122030.5806s
	iters: 1900, epoch: 3 | loss: 0.9908169
	speed: 0.1697s/iter; left time: 121968.9952s
	iters: 2000, epoch: 3 | loss: 0.9635152
	speed: 0.1700s/iter; left time: 122117.7043s
	iters: 2100, epoch: 3 | loss: 0.9649881
	speed: 0.1696s/iter; left time: 121850.3305s
	iters: 2200, epoch: 3 | loss: 1.0171704
	speed: 0.1697s/iter; left time: 121890.3039s
	iters: 2300, epoch: 3 | loss: 1.0230632
	speed: 0.1701s/iter; left time: 122137.3957s
	iters: 2400, epoch: 3 | loss: 1.0250806
	speed: 0.1696s/iter; left time: 121810.0617s
	iters: 2500, epoch: 3 | loss: 0.8735476
	speed: 0.1703s/iter; left time: 122251.6010s
	iters: 2600, epoch: 3 | loss: 0.9914926
	speed: 0.1699s/iter; left time: 121967.5094s
	iters: 2700, epoch: 3 | loss: 1.0789038
	speed: 0.1700s/iter; left time: 121994.9319s
	iters: 2800, epoch: 3 | loss: 0.9698074
	speed: 0.1664s/iter; left time: 119424.9840s
	iters: 2900, epoch: 3 | loss: 1.0878617
	speed: 0.1655s/iter; left time: 118773.4260s
	iters: 3000, epoch: 3 | loss: 1.1008277
	speed: 0.1656s/iter; left time: 118797.6173s
	iters: 3100, epoch: 3 | loss: 1.0122986
	speed: 0.1664s/iter; left time: 119384.0645s
	iters: 3200, epoch: 3 | loss: 0.9423453
	speed: 0.1669s/iter; left time: 119747.0302s
	iters: 3300, epoch: 3 | loss: 1.1030264
	speed: 0.1690s/iter; left time: 121229.0274s
	iters: 3400, epoch: 3 | loss: 1.0931116
	speed: 0.1660s/iter; left time: 119014.6424s
	iters: 3500, epoch: 3 | loss: 0.9588361
	speed: 0.1650s/iter; left time: 118341.6639s
	iters: 3600, epoch: 3 | loss: 0.9806474
	speed: 0.1684s/iter; left time: 120738.1636s
Epoch: 3 cost time: 615.485148191452
Epoch: 3, Steps: 3639 | Train Loss: 1.0147504 Vali Loss: 1.4109956 Test Loss: 1.2427683
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.9677043
	speed: 3.6612s/iter; left time: 2624306.5447s
	iters: 200, epoch: 4 | loss: 0.9933459
	speed: 0.1684s/iter; left time: 120677.1832s
	iters: 300, epoch: 4 | loss: 0.9139631
	speed: 0.1666s/iter; left time: 119354.5532s
	iters: 400, epoch: 4 | loss: 0.9150361
	speed: 0.1684s/iter; left time: 120643.6706s
	iters: 500, epoch: 4 | loss: 0.9511829
	speed: 0.1698s/iter; left time: 121641.2450s
	iters: 600, epoch: 4 | loss: 1.0551115
	speed: 0.1699s/iter; left time: 121693.9380s
	iters: 700, epoch: 4 | loss: 1.0495894
	speed: 0.1692s/iter; left time: 121170.3080s
	iters: 800, epoch: 4 | loss: 1.0274177
	speed: 0.1700s/iter; left time: 121754.9363s
	iters: 900, epoch: 4 | loss: 1.0250081
	speed: 0.1695s/iter; left time: 121379.6294s
	iters: 1000, epoch: 4 | loss: 0.9972891
	speed: 0.1697s/iter; left time: 121519.6322s
	iters: 1100, epoch: 4 | loss: 0.8945138
	speed: 0.1698s/iter; left time: 121557.1429s
	iters: 1200, epoch: 4 | loss: 0.9821522
	speed: 0.1700s/iter; left time: 121690.1702s
	iters: 1300, epoch: 4 | loss: 0.9239501
	speed: 0.1698s/iter; left time: 121512.8990s
	iters: 1400, epoch: 4 | loss: 0.9468237
	speed: 0.1691s/iter; left time: 121007.3976s
	iters: 1500, epoch: 4 | loss: 0.9582477
	speed: 0.1699s/iter; left time: 121544.2346s
	iters: 1600, epoch: 4 | loss: 0.9555141
	speed: 0.1687s/iter; left time: 120646.8950s
	iters: 1700, epoch: 4 | loss: 0.9997429
	speed: 0.1694s/iter; left time: 121186.5250s
	iters: 1800, epoch: 4 | loss: 0.9422472
	speed: 0.1700s/iter; left time: 121545.2057s
	iters: 1900, epoch: 4 | loss: 0.9539071
	speed: 0.1698s/iter; left time: 121394.2924s
	iters: 2000, epoch: 4 | loss: 0.9793656
	speed: 0.1699s/iter; left time: 121476.0301s
	iters: 2100, epoch: 4 | loss: 0.8866605
	speed: 0.1696s/iter; left time: 121218.2118s
	iters: 2200, epoch: 4 | loss: 1.0062536
	speed: 0.1692s/iter; left time: 120898.6727s
	iters: 2300, epoch: 4 | loss: 0.9541082
	speed: 0.1694s/iter; left time: 121054.7399s
	iters: 2400, epoch: 4 | loss: 1.0815189
	speed: 0.1688s/iter; left time: 120614.9794s
	iters: 2500, epoch: 4 | loss: 1.0336293
	speed: 0.1694s/iter; left time: 121009.8473s
	iters: 2600, epoch: 4 | loss: 0.9893069
	speed: 0.1690s/iter; left time: 120727.9526s
	iters: 2700, epoch: 4 | loss: 0.9454779
	speed: 0.1693s/iter; left time: 120897.2240s
	iters: 2800, epoch: 4 | loss: 0.9490097
	speed: 0.1700s/iter; left time: 121364.7040s
	iters: 2900, epoch: 4 | loss: 1.0048969
	speed: 0.1699s/iter; left time: 121286.6018s
	iters: 3000, epoch: 4 | loss: 0.9050723
	speed: 0.1693s/iter; left time: 120871.1738s
	iters: 3100, epoch: 4 | loss: 0.8924485
	speed: 0.1696s/iter; left time: 121030.5431s
	iters: 3200, epoch: 4 | loss: 0.9482905
	speed: 0.1704s/iter; left time: 121606.5789s
	iters: 3300, epoch: 4 | loss: 0.9954727
	speed: 0.1699s/iter; left time: 121211.6669s
	iters: 3400, epoch: 4 | loss: 0.9370492
	speed: 0.1694s/iter; left time: 120889.4408s
	iters: 3500, epoch: 4 | loss: 0.9097469
	speed: 0.1697s/iter; left time: 121038.9772s
	iters: 3600, epoch: 4 | loss: 0.9517422
	speed: 0.1695s/iter; left time: 120922.7445s
Epoch: 4 cost time: 616.9486308097839
Epoch: 4, Steps: 3639 | Train Loss: 0.9717322 Vali Loss: 1.4012848 Test Loss: 1.2222476
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.9608443
	speed: 3.6674s/iter; left time: 2615385.0707s
	iters: 200, epoch: 5 | loss: 1.0116450
	speed: 0.1720s/iter; left time: 122614.9316s
	iters: 300, epoch: 5 | loss: 0.9158963
	speed: 0.1714s/iter; left time: 122190.6181s
	iters: 400, epoch: 5 | loss: 0.9617801
	speed: 0.1723s/iter; left time: 122826.8358s
	iters: 500, epoch: 5 | loss: 0.9767088
	speed: 0.1722s/iter; left time: 122739.7583s
	iters: 600, epoch: 5 | loss: 0.9735115
	speed: 0.1721s/iter; left time: 122644.6042s
	iters: 700, epoch: 5 | loss: 0.8673184
	speed: 0.1726s/iter; left time: 122999.1363s
	iters: 800, epoch: 5 | loss: 0.9295154
	speed: 0.1727s/iter; left time: 123057.1767s
	iters: 900, epoch: 5 | loss: 0.8918821
	speed: 0.1724s/iter; left time: 122780.5574s
	iters: 1000, epoch: 5 | loss: 1.1572130
	speed: 0.1721s/iter; left time: 122541.7619s
	iters: 1100, epoch: 5 | loss: 0.9447633
	speed: 0.1724s/iter; left time: 122774.5112s
	iters: 1200, epoch: 5 | loss: 0.9554386
	speed: 0.1727s/iter; left time: 122935.9060s
	iters: 1300, epoch: 5 | loss: 0.8615913
	speed: 0.1723s/iter; left time: 122640.5866s
	iters: 1400, epoch: 5 | loss: 0.8995579
	speed: 0.1719s/iter; left time: 122358.6680s
	iters: 1500, epoch: 5 | loss: 0.9730691
	speed: 0.1722s/iter; left time: 122529.1869s
	iters: 1600, epoch: 5 | loss: 0.8388659
	speed: 0.1723s/iter; left time: 122614.5724s
	iters: 1700, epoch: 5 | loss: 0.9792433
	speed: 0.1724s/iter; left time: 122690.1099s
	iters: 1800, epoch: 5 | loss: 0.9281831
	speed: 0.1719s/iter; left time: 122331.5289s
	iters: 1900, epoch: 5 | loss: 0.9352401
	speed: 0.1723s/iter; left time: 122536.9075s
	iters: 2000, epoch: 5 | loss: 0.9572100
	speed: 0.1722s/iter; left time: 122510.8416s
	iters: 2100, epoch: 5 | loss: 0.9355532
	speed: 0.1719s/iter; left time: 122243.7811s
	iters: 2200, epoch: 5 | loss: 0.9106629
	speed: 0.1722s/iter; left time: 122458.9307s
	iters: 2300, epoch: 5 | loss: 0.9486164
	speed: 0.1725s/iter; left time: 122613.6058s
	iters: 2400, epoch: 5 | loss: 0.9093439
	speed: 0.1721s/iter; left time: 122360.3263s
	iters: 2500, epoch: 5 | loss: 0.8972078
	speed: 0.1727s/iter; left time: 122773.6858s
	iters: 2600, epoch: 5 | loss: 0.8982074
	speed: 0.1724s/iter; left time: 122525.0285s
	iters: 2700, epoch: 5 | loss: 0.9037141
	speed: 0.1720s/iter; left time: 122240.8760s
	iters: 2800, epoch: 5 | loss: 0.8887895
	speed: 0.1721s/iter; left time: 122270.5236s
	iters: 2900, epoch: 5 | loss: 0.8770027
	speed: 0.1723s/iter; left time: 122404.1294s
	iters: 3000, epoch: 5 | loss: 0.9248858
	speed: 0.1718s/iter; left time: 122034.3055s
	iters: 3100, epoch: 5 | loss: 0.9044130
	speed: 0.1724s/iter; left time: 122458.1874s
	iters: 3200, epoch: 5 | loss: 0.8798220
	speed: 0.1720s/iter; left time: 122140.5199s
	iters: 3300, epoch: 5 | loss: 0.8575720
	speed: 0.1728s/iter; left time: 122685.3138s
	iters: 3400, epoch: 5 | loss: 0.8944108
	speed: 0.1721s/iter; left time: 122185.1633s
	iters: 3500, epoch: 5 | loss: 0.9510573
	speed: 0.1720s/iter; left time: 122087.6454s
	iters: 3600, epoch: 5 | loss: 0.9125317
	speed: 0.1722s/iter; left time: 122217.0575s
Epoch: 5 cost time: 627.0433423519135
Epoch: 5, Steps: 3639 | Train Loss: 0.9266819 Vali Loss: 1.4395534 Test Loss: 1.2490873
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.9406205
	speed: 3.6610s/iter; left time: 2597483.7780s
	iters: 200, epoch: 6 | loss: 0.8175811
	speed: 0.1703s/iter; left time: 120805.1963s
	iters: 300, epoch: 6 | loss: 0.8721015
	speed: 0.1698s/iter; left time: 120443.5073s
	iters: 400, epoch: 6 | loss: 0.8653308
	speed: 0.1703s/iter; left time: 120784.5941s
	iters: 500, epoch: 6 | loss: 0.9314848
	speed: 0.1698s/iter; left time: 120420.9616s
	iters: 600, epoch: 6 | loss: 0.8870532
	speed: 0.1694s/iter; left time: 120110.5038s
	iters: 700, epoch: 6 | loss: 0.9268183
	speed: 0.1696s/iter; left time: 120217.9422s
	iters: 800, epoch: 6 | loss: 0.9073279
	speed: 0.1695s/iter; left time: 120117.1214s
	iters: 900, epoch: 6 | loss: 0.8820544
	speed: 0.1692s/iter; left time: 119900.6112s
	iters: 1000, epoch: 6 | loss: 0.8485907
	speed: 0.1701s/iter; left time: 120566.1659s
	iters: 1100, epoch: 6 | loss: 0.8209422
	speed: 0.1692s/iter; left time: 119904.6873s
	iters: 1200, epoch: 6 | loss: 0.9628909
	speed: 0.1696s/iter; left time: 120140.8764s
	iters: 1300, epoch: 6 | loss: 0.8689224
	speed: 0.1695s/iter; left time: 120067.6096s
	iters: 1400, epoch: 6 | loss: 0.8914897
	speed: 0.1693s/iter; left time: 119884.9376s
	iters: 1500, epoch: 6 | loss: 0.9464229
	speed: 0.1700s/iter; left time: 120395.7602s
	iters: 1600, epoch: 6 | loss: 0.8888401
	speed: 0.1691s/iter; left time: 119724.2220s
	iters: 1700, epoch: 6 | loss: 0.8907408
	speed: 0.1688s/iter; left time: 119488.7445s
	iters: 1800, epoch: 6 | loss: 0.8772563
	speed: 0.1694s/iter; left time: 119910.2345s
	iters: 1900, epoch: 6 | loss: 0.9375678
	speed: 0.1699s/iter; left time: 120250.3604s
	iters: 2000, epoch: 6 | loss: 0.8799926
	speed: 0.1692s/iter; left time: 119723.2934s
	iters: 2100, epoch: 6 | loss: 0.8670700
	speed: 0.1690s/iter; left time: 119584.4029s
	iters: 2200, epoch: 6 | loss: 0.9194679
	speed: 0.1694s/iter; left time: 119832.6861s
	iters: 2300, epoch: 6 | loss: 0.9281408
	speed: 0.1693s/iter; left time: 119758.0851s
	iters: 2400, epoch: 6 | loss: 0.8352869
	speed: 0.1699s/iter; left time: 120182.3597s
	iters: 2500, epoch: 6 | loss: 0.8956205
	speed: 0.1686s/iter; left time: 119189.8005s
	iters: 2600, epoch: 6 | loss: 0.9934871
	speed: 0.1698s/iter; left time: 120040.4541s
	iters: 2700, epoch: 6 | loss: 0.9250655
	speed: 0.1694s/iter; left time: 119779.2364s
	iters: 2800, epoch: 6 | loss: 0.8996809
	speed: 0.1696s/iter; left time: 119873.8513s
	iters: 2900, epoch: 6 | loss: 0.8116597
	speed: 0.1696s/iter; left time: 119846.5224s
	iters: 3000, epoch: 6 | loss: 0.9063770
	speed: 0.1697s/iter; left time: 119889.7558s
	iters: 3100, epoch: 6 | loss: 0.8651444
	speed: 0.1698s/iter; left time: 119970.3433s
	iters: 3200, epoch: 6 | loss: 0.8745614
	speed: 0.1694s/iter; left time: 119674.6622s
	iters: 3300, epoch: 6 | loss: 0.8501288
	speed: 0.1698s/iter; left time: 119937.8703s
	iters: 3400, epoch: 6 | loss: 0.8392377
	speed: 0.1703s/iter; left time: 120278.3932s
	iters: 3500, epoch: 6 | loss: 0.8287268
	speed: 0.1692s/iter; left time: 119447.1023s
	iters: 3600, epoch: 6 | loss: 0.8938226
	speed: 0.1693s/iter; left time: 119532.8288s
Epoch: 6 cost time: 617.2219767570496
Epoch: 6, Steps: 3639 | Train Loss: 0.8787353 Vali Loss: 1.4030577 Test Loss: 1.2835232
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247821
test shape: (24782, 1, 336, 151) (24782, 1, 336, 151)
test shape: (24782, 336, 151) (24782, 336, 151)
mse:1.2204060554504395, mae:0.8381138443946838
>>>>>>>Overall time: 6218 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
