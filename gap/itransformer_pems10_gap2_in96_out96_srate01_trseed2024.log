nohup: ignoring input
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1020381
Traceback (most recent call last):
  File "run.py", line 159, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 85, in train
    vali_data, vali_loader = self._get_data(flag='val')
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 31, in _get_data
    data_set, data_loader = data_provider(self.args, flag)
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_factory.py", line 117, in data_provider
ValueError: __len__() should return >= 0
nohup: ignoring input
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Traceback (most recent call last):
  File "run.py", line 159, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 84, in train
    train_data, train_loader = self._get_data(flag='train')
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 31, in _get_data
    data_set, data_loader = data_provider(self.args, flag)
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_factory.py", line 104, in data_provider
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_loader.py", line 321, in __init__
    self.__read_data__()  
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_loader.py", line 334, in __read_data__
    if args.gap>1:
NameError: name 'args' is not defined
nohup: ignoring input
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 844551
val 141327
test 141325
	iters: 100, epoch: 1 | loss: 1.5910627
	speed: 0.0329s/iter; left time: 1732.3255s
	iters: 200, epoch: 1 | loss: 1.5515182
	speed: 0.0301s/iter; left time: 1583.4462s
	iters: 300, epoch: 1 | loss: 1.8545226
	speed: 0.0300s/iter; left time: 1572.5895s
	iters: 400, epoch: 1 | loss: 2.4638515
	speed: 0.0295s/iter; left time: 1546.5701s
	iters: 500, epoch: 1 | loss: 1.5549513
	speed: 0.0301s/iter; left time: 1572.4261s
	iters: 600, epoch: 1 | loss: 1.7807653
	speed: 0.0304s/iter; left time: 1586.7330s
	iters: 700, epoch: 1 | loss: 2.4023507
	speed: 0.0299s/iter; left time: 1555.0567s
	iters: 800, epoch: 1 | loss: 1.8010185
	speed: 0.0296s/iter; left time: 1540.8061s
	iters: 900, epoch: 1 | loss: 1.7984763
	speed: 0.0298s/iter; left time: 1544.9735s
	iters: 1000, epoch: 1 | loss: 1.9661840
	speed: 0.0304s/iter; left time: 1573.9742s
	iters: 1100, epoch: 1 | loss: 1.9596168
	speed: 0.0304s/iter; left time: 1570.4692s
	iters: 1200, epoch: 1 | loss: 1.6542624
	speed: 0.0303s/iter; left time: 1564.0666s
	iters: 1300, epoch: 1 | loss: 1.8201122
	speed: 0.0300s/iter; left time: 1546.8792s
	iters: 1400, epoch: 1 | loss: 2.5606239
	speed: 0.0303s/iter; left time: 1555.8966s
	iters: 1500, epoch: 1 | loss: 1.8451444
	speed: 0.0304s/iter; left time: 1557.3999s
	iters: 1600, epoch: 1 | loss: 1.4526908
	speed: 0.0305s/iter; left time: 1561.4051s
	iters: 1700, epoch: 1 | loss: 2.4204938
	speed: 0.0300s/iter; left time: 1532.1621s
	iters: 1800, epoch: 1 | loss: 1.7881705
	speed: 0.0306s/iter; left time: 1558.6239s
	iters: 1900, epoch: 1 | loss: 1.9591269
	speed: 0.0304s/iter; left time: 1544.8782s
	iters: 2000, epoch: 1 | loss: 1.4897517
	speed: 0.0294s/iter; left time: 1493.2235s
	iters: 2100, epoch: 1 | loss: 2.1628540
	speed: 0.0302s/iter; left time: 1532.2559s
	iters: 2200, epoch: 1 | loss: 1.7611171
	speed: 0.0300s/iter; left time: 1516.0559s
	iters: 2300, epoch: 1 | loss: 1.9199176
	speed: 0.0305s/iter; left time: 1538.8805s
	iters: 2400, epoch: 1 | loss: 1.9666213
	speed: 0.0302s/iter; left time: 1520.4417s
	iters: 2500, epoch: 1 | loss: 2.1631095
	speed: 0.0299s/iter; left time: 1501.7164s
	iters: 2600, epoch: 1 | loss: 2.1688526
	speed: 0.0302s/iter; left time: 1514.0888s
	iters: 2700, epoch: 1 | loss: 2.0758631
	speed: 0.0305s/iter; left time: 1526.2261s
	iters: 2800, epoch: 1 | loss: 1.7561318
	speed: 0.0304s/iter; left time: 1517.5992s
	iters: 2900, epoch: 1 | loss: 1.3046083
	speed: 0.0296s/iter; left time: 1474.7874s
	iters: 3000, epoch: 1 | loss: 1.9872077
	speed: 0.0304s/iter; left time: 1511.1467s
	iters: 3100, epoch: 1 | loss: 1.7530321
	speed: 0.0302s/iter; left time: 1501.1944s
	iters: 3200, epoch: 1 | loss: 1.8737155
	speed: 0.0301s/iter; left time: 1491.1528s
	iters: 3300, epoch: 1 | loss: 2.0694253
	speed: 0.0300s/iter; left time: 1483.1939s
	iters: 3400, epoch: 1 | loss: 2.4147828
	speed: 0.0303s/iter; left time: 1495.1563s
	iters: 3500, epoch: 1 | loss: 2.1713006
	speed: 0.0301s/iter; left time: 1482.5167s
	iters: 3600, epoch: 1 | loss: 2.2628474
	speed: 0.0296s/iter; left time: 1458.1499s
	iters: 3700, epoch: 1 | loss: 2.1643846
	speed: 0.0299s/iter; left time: 1469.9523s
	iters: 3800, epoch: 1 | loss: 2.0011580
	speed: 0.0297s/iter; left time: 1454.4953s
	iters: 3900, epoch: 1 | loss: 2.2003007
	speed: 0.0303s/iter; left time: 1483.2000s
	iters: 4000, epoch: 1 | loss: 1.7518493
	speed: 0.0303s/iter; left time: 1479.0203s
	iters: 4100, epoch: 1 | loss: 2.5517650
	speed: 0.0304s/iter; left time: 1481.4762s
	iters: 4200, epoch: 1 | loss: 1.9614135
	speed: 0.0302s/iter; left time: 1468.2633s
	iters: 4300, epoch: 1 | loss: 2.2061396
	speed: 0.0295s/iter; left time: 1429.5034s
	iters: 4400, epoch: 1 | loss: 2.3204069
	speed: 0.0304s/iter; left time: 1469.5440s
	iters: 4500, epoch: 1 | loss: 2.1909897
	speed: 0.0305s/iter; left time: 1470.5012s
	iters: 4600, epoch: 1 | loss: 1.7683634
	speed: 0.0305s/iter; left time: 1468.5549s
	iters: 4700, epoch: 1 | loss: 2.0703082
	speed: 0.0302s/iter; left time: 1450.4269s
	iters: 4800, epoch: 1 | loss: 2.0133641
	speed: 0.0298s/iter; left time: 1427.8945s
	iters: 4900, epoch: 1 | loss: 2.2066267
	speed: 0.0305s/iter; left time: 1461.1720s
	iters: 5000, epoch: 1 | loss: 2.4233234
	speed: 0.0301s/iter; left time: 1438.6969s
	iters: 5100, epoch: 1 | loss: 1.8573056
	speed: 0.0304s/iter; left time: 1448.6601s
	iters: 5200, epoch: 1 | loss: 2.3299637
	speed: 0.0303s/iter; left time: 1442.7138s
Epoch: 1 cost time: 159.44761610031128
Epoch: 1, Steps: 5278 | Train Loss: 1.9099448 Vali Loss: 2.2254949 Test Loss: 2.7821982
Validation loss decreased (inf --> 2.225495).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6352847
	speed: 0.6666s/iter; left time: 31596.8931s
	iters: 200, epoch: 2 | loss: 1.8908159
	speed: 0.0302s/iter; left time: 1428.2348s
	iters: 300, epoch: 2 | loss: 1.8227620
	speed: 0.0305s/iter; left time: 1437.4433s
	iters: 400, epoch: 2 | loss: 1.9562140
	speed: 0.0303s/iter; left time: 1426.1825s
	iters: 500, epoch: 2 | loss: 2.1405914
	speed: 0.0303s/iter; left time: 1423.5433s
	iters: 600, epoch: 2 | loss: 2.1378803
	speed: 0.0304s/iter; left time: 1425.7339s
	iters: 700, epoch: 2 | loss: 2.0885732
	speed: 0.0301s/iter; left time: 1406.9774s
	iters: 800, epoch: 2 | loss: 2.1378446
	speed: 0.0296s/iter; left time: 1381.6558s
	iters: 900, epoch: 2 | loss: 2.5326595
	speed: 0.0300s/iter; left time: 1398.4360s
	iters: 1000, epoch: 2 | loss: 1.5917780
	speed: 0.0302s/iter; left time: 1402.1270s
	iters: 1100, epoch: 2 | loss: 2.2312891
	speed: 0.0303s/iter; left time: 1405.4391s
	iters: 1200, epoch: 2 | loss: 1.8608567
	speed: 0.0298s/iter; left time: 1379.5834s
	iters: 1300, epoch: 2 | loss: 1.9851477
	speed: 0.0306s/iter; left time: 1415.7352s
	iters: 1400, epoch: 2 | loss: 1.3267064
	speed: 0.0302s/iter; left time: 1391.2170s
	iters: 1500, epoch: 2 | loss: 1.7105745
	speed: 0.0306s/iter; left time: 1405.6480s
	iters: 1600, epoch: 2 | loss: 1.7955122
	speed: 0.0300s/iter; left time: 1378.0102s
	iters: 1700, epoch: 2 | loss: 2.2348359
	speed: 0.0304s/iter; left time: 1392.7112s
	iters: 1800, epoch: 2 | loss: 1.6529940
	speed: 0.0302s/iter; left time: 1379.8526s
	iters: 1900, epoch: 2 | loss: 2.0777030
	speed: 0.0303s/iter; left time: 1380.0207s
	iters: 2000, epoch: 2 | loss: 1.9713058
	speed: 0.0305s/iter; left time: 1388.2979s
	iters: 2100, epoch: 2 | loss: 1.5998896
	speed: 0.0304s/iter; left time: 1379.6715s
	iters: 2200, epoch: 2 | loss: 1.6480595
	speed: 0.0303s/iter; left time: 1370.7167s
	iters: 2300, epoch: 2 | loss: 1.8703173
	speed: 0.0299s/iter; left time: 1352.0019s
	iters: 2400, epoch: 2 | loss: 1.5512305
	speed: 0.0304s/iter; left time: 1370.5505s
	iters: 2500, epoch: 2 | loss: 2.1076245
	speed: 0.0304s/iter; left time: 1366.4746s
	iters: 2600, epoch: 2 | loss: 2.0354304
	speed: 0.0300s/iter; left time: 1348.9329s
	iters: 2700, epoch: 2 | loss: 1.9648513
	speed: 0.0300s/iter; left time: 1343.7982s
	iters: 2800, epoch: 2 | loss: 1.9213302
	speed: 0.0296s/iter; left time: 1321.6797s
	iters: 2900, epoch: 2 | loss: 1.8592135
	speed: 0.0301s/iter; left time: 1343.4340s
	iters: 3000, epoch: 2 | loss: 2.0239937
	speed: 0.0297s/iter; left time: 1320.2250s
	iters: 3100, epoch: 2 | loss: 2.3660834
	speed: 0.0301s/iter; left time: 1337.7903s
	iters: 3200, epoch: 2 | loss: 2.3694739
	speed: 0.0306s/iter; left time: 1355.2289s
	iters: 3300, epoch: 2 | loss: 2.0535777
	speed: 0.0304s/iter; left time: 1345.6425s
	iters: 3400, epoch: 2 | loss: 1.8972591
	speed: 0.0300s/iter; left time: 1325.0610s
	iters: 3500, epoch: 2 | loss: 1.8091177
	speed: 0.0305s/iter; left time: 1340.2657s
	iters: 3600, epoch: 2 | loss: 1.6999513
	speed: 0.0304s/iter; left time: 1333.6155s
	iters: 3700, epoch: 2 | loss: 1.7515521
	speed: 0.0304s/iter; left time: 1329.5164s
	iters: 3800, epoch: 2 | loss: 1.6227897
	speed: 0.0305s/iter; left time: 1331.8392s
	iters: 3900, epoch: 2 | loss: 2.1159856
	speed: 0.0302s/iter; left time: 1318.6912s
	iters: 4000, epoch: 2 | loss: 1.9059752
	speed: 0.0303s/iter; left time: 1316.5466s
	iters: 4100, epoch: 2 | loss: 1.8260460
	speed: 0.0299s/iter; left time: 1298.2948s
	iters: 4200, epoch: 2 | loss: 1.8316104
	speed: 0.0300s/iter; left time: 1297.6694s
	iters: 4300, epoch: 2 | loss: 1.9633375
	speed: 0.0304s/iter; left time: 1314.5365s
	iters: 4400, epoch: 2 | loss: 1.9000887
	speed: 0.0305s/iter; left time: 1315.0226s
	iters: 4500, epoch: 2 | loss: 2.0724037
	speed: 0.0301s/iter; left time: 1293.0299s
	iters: 4600, epoch: 2 | loss: 1.9979900
	speed: 0.0299s/iter; left time: 1282.5368s
	iters: 4700, epoch: 2 | loss: 1.9099358
	speed: 0.0296s/iter; left time: 1266.7560s
	iters: 4800, epoch: 2 | loss: 2.3152528
	speed: 0.0301s/iter; left time: 1287.3449s
	iters: 4900, epoch: 2 | loss: 1.9835336
	speed: 0.0303s/iter; left time: 1290.0640s
	iters: 5000, epoch: 2 | loss: 1.6015846
	speed: 0.0301s/iter; left time: 1280.1233s
	iters: 5100, epoch: 2 | loss: 1.5010715
	speed: 0.0302s/iter; left time: 1280.2868s
	iters: 5200, epoch: 2 | loss: 1.4731041
	speed: 0.0301s/iter; left time: 1275.1758s
Epoch: 2 cost time: 159.47714185714722
Epoch: 2, Steps: 5278 | Train Loss: 1.9901630 Vali Loss: 2.2046621 Test Loss: 2.7728496
Validation loss decreased (2.225495 --> 2.204662).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 2.4268641
	speed: 0.6671s/iter; left time: 28101.3630s
	iters: 200, epoch: 3 | loss: 1.9661704
	speed: 0.0302s/iter; left time: 1269.1906s
	iters: 300, epoch: 3 | loss: 2.0120428
	speed: 0.0303s/iter; left time: 1269.5232s
	iters: 400, epoch: 3 | loss: 2.2520390
	speed: 0.0302s/iter; left time: 1262.8488s
	iters: 500, epoch: 3 | loss: 2.0754609
	speed: 0.0302s/iter; left time: 1258.2406s
	iters: 600, epoch: 3 | loss: 1.7002757
	speed: 0.0298s/iter; left time: 1238.5282s
	iters: 700, epoch: 3 | loss: 2.0760612
	speed: 0.0302s/iter; left time: 1255.1773s
	iters: 800, epoch: 3 | loss: 1.6100971
	speed: 0.0301s/iter; left time: 1246.1694s
	iters: 900, epoch: 3 | loss: 2.3595369
	speed: 0.0306s/iter; left time: 1263.5314s
	iters: 1000, epoch: 3 | loss: 2.0265892
	speed: 0.0298s/iter; left time: 1227.5552s
	iters: 1100, epoch: 3 | loss: 1.9315883
	speed: 0.0302s/iter; left time: 1242.3836s
	iters: 1200, epoch: 3 | loss: 1.7728618
	speed: 0.0299s/iter; left time: 1226.7646s
	iters: 1300, epoch: 3 | loss: 2.4706502
	speed: 0.0300s/iter; left time: 1227.4817s
	iters: 1400, epoch: 3 | loss: 2.0086267
	speed: 0.0303s/iter; left time: 1236.5160s
	iters: 1500, epoch: 3 | loss: 2.1621969
	speed: 0.0302s/iter; left time: 1229.5689s
	iters: 1600, epoch: 3 | loss: 1.7858565
	speed: 0.0298s/iter; left time: 1212.1214s
	iters: 1700, epoch: 3 | loss: 2.0337470
	speed: 0.0304s/iter; left time: 1233.2242s
	iters: 1800, epoch: 3 | loss: 2.0485866
	speed: 0.0304s/iter; left time: 1229.4351s
	iters: 1900, epoch: 3 | loss: 1.8802596
	speed: 0.0301s/iter; left time: 1214.9805s
	iters: 2000, epoch: 3 | loss: 2.1842105
	speed: 0.0304s/iter; left time: 1221.4331s
	iters: 2100, epoch: 3 | loss: 1.9629118
	speed: 0.0301s/iter; left time: 1207.9308s
	iters: 2200, epoch: 3 | loss: 1.6977451
	speed: 0.0303s/iter; left time: 1211.1488s
	iters: 2300, epoch: 3 | loss: 2.1321118
	speed: 0.0303s/iter; left time: 1211.6858s
	iters: 2400, epoch: 3 | loss: 2.1864080
	speed: 0.0302s/iter; left time: 1203.2742s
	iters: 2500, epoch: 3 | loss: 1.9650717
	speed: 0.0305s/iter; left time: 1210.3067s
	iters: 2600, epoch: 3 | loss: 2.1513765
	speed: 0.0303s/iter; left time: 1199.2325s
	iters: 2700, epoch: 3 | loss: 1.9969815
	speed: 0.0299s/iter; left time: 1180.6234s
	iters: 2800, epoch: 3 | loss: 1.9594296
	speed: 0.0304s/iter; left time: 1197.4867s
	iters: 2900, epoch: 3 | loss: 2.3484616
	speed: 0.0303s/iter; left time: 1190.8275s
	iters: 3000, epoch: 3 | loss: 1.9222250
	speed: 0.0297s/iter; left time: 1163.8750s
	iters: 3100, epoch: 3 | loss: 1.5583717
	speed: 0.0306s/iter; left time: 1196.0029s
	iters: 3200, epoch: 3 | loss: 2.0953021
	speed: 0.0298s/iter; left time: 1161.4665s
	iters: 3300, epoch: 3 | loss: 2.1457436
	speed: 0.0305s/iter; left time: 1185.7883s
	iters: 3400, epoch: 3 | loss: 2.2106171
	speed: 0.0305s/iter; left time: 1183.4590s
	iters: 3500, epoch: 3 | loss: 1.9627204
	speed: 0.0298s/iter; left time: 1153.5459s
	iters: 3600, epoch: 3 | loss: 2.0819652
	speed: 0.0304s/iter; left time: 1175.9407s
	iters: 3700, epoch: 3 | loss: 1.5026689
	speed: 0.0297s/iter; left time: 1146.0962s
	iters: 3800, epoch: 3 | loss: 1.8664495
	speed: 0.0297s/iter; left time: 1142.6957s
	iters: 3900, epoch: 3 | loss: 2.0995231
	speed: 0.0304s/iter; left time: 1164.5500s
	iters: 4000, epoch: 3 | loss: 2.0247419
	speed: 0.0306s/iter; left time: 1169.5550s
	iters: 4100, epoch: 3 | loss: 1.7810837
	speed: 0.0299s/iter; left time: 1140.5033s
	iters: 4200, epoch: 3 | loss: 1.8613406
	speed: 0.0298s/iter; left time: 1134.7273s
	iters: 4300, epoch: 3 | loss: 2.3790181
	speed: 0.0302s/iter; left time: 1146.2226s
	iters: 4400, epoch: 3 | loss: 2.2529001
	speed: 0.0299s/iter; left time: 1129.1719s
	iters: 4500, epoch: 3 | loss: 1.7601674
	speed: 0.0302s/iter; left time: 1140.8871s
	iters: 4600, epoch: 3 | loss: 2.2463706
	speed: 0.0303s/iter; left time: 1141.7236s
	iters: 4700, epoch: 3 | loss: 2.0257804
	speed: 0.0302s/iter; left time: 1132.9304s
	iters: 4800, epoch: 3 | loss: 1.8468754
	speed: 0.0300s/iter; left time: 1123.7493s
	iters: 4900, epoch: 3 | loss: 1.6795249
	speed: 0.0296s/iter; left time: 1105.0299s
	iters: 5000, epoch: 3 | loss: 2.2074192
	speed: 0.0305s/iter; left time: 1133.8581s
	iters: 5100, epoch: 3 | loss: 1.5791414
	speed: 0.0303s/iter; left time: 1124.2168s
	iters: 5200, epoch: 3 | loss: 2.6871498
	speed: 0.0296s/iter; left time: 1096.0863s
Epoch: 3 cost time: 159.28391933441162
Epoch: 3, Steps: 5278 | Train Loss: 1.9893495 Vali Loss: 2.2019114 Test Loss: 2.7724674
Validation loss decreased (2.204662 --> 2.201911).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 2.2135360
	speed: 0.6684s/iter; left time: 24627.6390s
	iters: 200, epoch: 4 | loss: 1.8175306
	speed: 0.0302s/iter; left time: 1110.6834s
	iters: 300, epoch: 4 | loss: 1.9279454
	speed: 0.0304s/iter; left time: 1114.3708s
	iters: 400, epoch: 4 | loss: 1.7233844
	speed: 0.0305s/iter; left time: 1114.2746s
	iters: 500, epoch: 4 | loss: 1.7917438
	speed: 0.0306s/iter; left time: 1113.9349s
	iters: 600, epoch: 4 | loss: 1.7337698
	speed: 0.0297s/iter; left time: 1079.3693s
	iters: 700, epoch: 4 | loss: 1.8982295
	speed: 0.0304s/iter; left time: 1101.8575s
	iters: 800, epoch: 4 | loss: 1.9396662
	speed: 0.0297s/iter; left time: 1073.9067s
	iters: 900, epoch: 4 | loss: 2.5135205
	speed: 0.0299s/iter; left time: 1078.8975s
	iters: 1000, epoch: 4 | loss: 1.4805466
	speed: 0.0300s/iter; left time: 1078.4692s
	iters: 1100, epoch: 4 | loss: 1.8784976
	speed: 0.0301s/iter; left time: 1079.8693s
	iters: 1200, epoch: 4 | loss: 2.5861497
	speed: 0.0304s/iter; left time: 1087.6431s
	iters: 1300, epoch: 4 | loss: 1.8472658
	speed: 0.0303s/iter; left time: 1079.4387s
	iters: 1400, epoch: 4 | loss: 2.0932515
	speed: 0.0294s/iter; left time: 1046.6061s
	iters: 1500, epoch: 4 | loss: 1.6319625
	speed: 0.0303s/iter; left time: 1075.3443s
	iters: 1600, epoch: 4 | loss: 1.5408748
	speed: 0.0301s/iter; left time: 1064.1368s
	iters: 1700, epoch: 4 | loss: 2.4229219
	speed: 0.0304s/iter; left time: 1071.4750s
	iters: 1800, epoch: 4 | loss: 2.2894275
	speed: 0.0302s/iter; left time: 1060.0417s
	iters: 1900, epoch: 4 | loss: 2.1765940
	speed: 0.0300s/iter; left time: 1051.4244s
	iters: 2000, epoch: 4 | loss: 2.1717799
	speed: 0.0304s/iter; left time: 1062.2891s
	iters: 2100, epoch: 4 | loss: 2.0100651
	speed: 0.0302s/iter; left time: 1052.2058s
	iters: 2200, epoch: 4 | loss: 1.8605578
	speed: 0.0306s/iter; left time: 1064.0942s
	iters: 2300, epoch: 4 | loss: 1.9150229
	speed: 0.0303s/iter; left time: 1048.7223s
	iters: 2400, epoch: 4 | loss: 2.2174885
	speed: 0.0304s/iter; left time: 1049.7760s
	iters: 2500, epoch: 4 | loss: 2.0580468
	speed: 0.0302s/iter; left time: 1041.1158s
	iters: 2600, epoch: 4 | loss: 1.6044127
	speed: 0.0305s/iter; left time: 1046.8732s
	iters: 2700, epoch: 4 | loss: 1.4763225
	speed: 0.0305s/iter; left time: 1043.0189s
	iters: 2800, epoch: 4 | loss: 1.9873061
	speed: 0.0303s/iter; left time: 1035.9878s
	iters: 2900, epoch: 4 | loss: 1.6040308
	speed: 0.0298s/iter; left time: 1013.3815s
	iters: 3000, epoch: 4 | loss: 1.9266047
	speed: 0.0299s/iter; left time: 1015.0649s
	iters: 3100, epoch: 4 | loss: 1.8736647
	speed: 0.0304s/iter; left time: 1029.0163s
	iters: 3200, epoch: 4 | loss: 1.7617731
	speed: 0.0301s/iter; left time: 1015.3740s
	iters: 3300, epoch: 4 | loss: 1.9306757
	speed: 0.0300s/iter; left time: 1009.5026s
	iters: 3400, epoch: 4 | loss: 1.9973750
	speed: 0.0303s/iter; left time: 1015.3634s
	iters: 3500, epoch: 4 | loss: 1.7792325
	speed: 0.0300s/iter; left time: 1004.8799s
	iters: 3600, epoch: 4 | loss: 2.0861733
	speed: 0.0304s/iter; left time: 1014.0623s
	iters: 3700, epoch: 4 | loss: 2.1852727
	speed: 0.0296s/iter; left time: 984.2060s
	iters: 3800, epoch: 4 | loss: 2.4388361
	speed: 0.0306s/iter; left time: 1014.7551s
	iters: 3900, epoch: 4 | loss: 1.6494009
	speed: 0.0299s/iter; left time: 989.6197s
	iters: 4000, epoch: 4 | loss: 2.1736329
	speed: 0.0302s/iter; left time: 994.7821s
	iters: 4100, epoch: 4 | loss: 2.0783029
	speed: 0.0305s/iter; left time: 1002.1492s
	iters: 4200, epoch: 4 | loss: 1.8687361
	speed: 0.0304s/iter; left time: 994.3345s
	iters: 4300, epoch: 4 | loss: 2.1014624
	speed: 0.0304s/iter; left time: 992.1855s
	iters: 4400, epoch: 4 | loss: 1.6775856
	speed: 0.0302s/iter; left time: 982.7685s
	iters: 4500, epoch: 4 | loss: 1.9942119
	speed: 0.0301s/iter; left time: 975.1707s
	iters: 4600, epoch: 4 | loss: 2.1005657
	speed: 0.0304s/iter; left time: 982.2757s
	iters: 4700, epoch: 4 | loss: 2.3281150
	speed: 0.0301s/iter; left time: 971.7708s
	iters: 4800, epoch: 4 | loss: 1.7535526
	speed: 0.0301s/iter; left time: 968.3353s
	iters: 4900, epoch: 4 | loss: 2.3158309
	speed: 0.0304s/iter; left time: 972.9673s
	iters: 5000, epoch: 4 | loss: 2.3213198
	speed: 0.0301s/iter; left time: 960.5123s
	iters: 5100, epoch: 4 | loss: 1.5885216
	speed: 0.0294s/iter; left time: 937.3983s
	iters: 5200, epoch: 4 | loss: 1.9287333
	speed: 0.0302s/iter; left time: 959.9309s
Epoch: 4 cost time: 159.46529173851013
Epoch: 4, Steps: 5278 | Train Loss: 1.9892742 Vali Loss: 2.2019179 Test Loss: 2.7718363
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 2.0617790
	speed: 0.6656s/iter; left time: 21011.6828s
	iters: 200, epoch: 5 | loss: 2.1394947
	speed: 0.0304s/iter; left time: 955.9460s
	iters: 300, epoch: 5 | loss: 2.2878091
	speed: 0.0304s/iter; left time: 953.9841s
	iters: 400, epoch: 5 | loss: 2.1621237
	speed: 0.0303s/iter; left time: 947.7423s
	iters: 500, epoch: 5 | loss: 1.9918981
	speed: 0.0299s/iter; left time: 931.8323s
	iters: 600, epoch: 5 | loss: 2.1235628
	speed: 0.0301s/iter; left time: 933.8319s
	iters: 700, epoch: 5 | loss: 1.6052681
	speed: 0.0303s/iter; left time: 938.2419s
	iters: 800, epoch: 5 | loss: 2.0952840
	speed: 0.0305s/iter; left time: 941.0660s
	iters: 900, epoch: 5 | loss: 2.0591881
	speed: 0.0298s/iter; left time: 918.0230s
	iters: 1000, epoch: 5 | loss: 2.3761263
	speed: 0.0299s/iter; left time: 916.7744s
	iters: 1100, epoch: 5 | loss: 1.9706744
	speed: 0.0300s/iter; left time: 918.5872s
	iters: 1200, epoch: 5 | loss: 1.9454256
	speed: 0.0302s/iter; left time: 918.7952s
	iters: 1300, epoch: 5 | loss: 2.5503185
	speed: 0.0295s/iter; left time: 894.6207s
	iters: 1400, epoch: 5 | loss: 2.0041907
	speed: 0.0304s/iter; left time: 921.0040s
	iters: 1500, epoch: 5 | loss: 2.0519872
	speed: 0.0302s/iter; left time: 911.4758s
	iters: 1600, epoch: 5 | loss: 1.8805760
	speed: 0.0298s/iter; left time: 897.0386s
	iters: 1700, epoch: 5 | loss: 1.9016747
	speed: 0.0302s/iter; left time: 905.4031s
	iters: 1800, epoch: 5 | loss: 1.7690037
	speed: 0.0301s/iter; left time: 899.1755s
	iters: 1900, epoch: 5 | loss: 1.7312880
	speed: 0.0301s/iter; left time: 896.0819s
	iters: 2000, epoch: 5 | loss: 2.0594897
	speed: 0.0303s/iter; left time: 898.7610s
	iters: 2100, epoch: 5 | loss: 1.9441644
	speed: 0.0305s/iter; left time: 902.4952s
	iters: 2200, epoch: 5 | loss: 1.8790041
	speed: 0.0303s/iter; left time: 891.7024s
	iters: 2300, epoch: 5 | loss: 2.3515532
	speed: 0.0298s/iter; left time: 874.3728s
	iters: 2400, epoch: 5 | loss: 1.6687448
	speed: 0.0296s/iter; left time: 867.4571s
	iters: 2500, epoch: 5 | loss: 1.7476599
	speed: 0.0296s/iter; left time: 863.7329s
	iters: 2600, epoch: 5 | loss: 1.8041220
	speed: 0.0299s/iter; left time: 868.8715s
	iters: 2700, epoch: 5 | loss: 1.9348782
	speed: 0.0305s/iter; left time: 884.3116s
	iters: 2800, epoch: 5 | loss: 2.0975821
	speed: 0.0302s/iter; left time: 872.3093s
	iters: 2900, epoch: 5 | loss: 2.2025576
	speed: 0.0301s/iter; left time: 865.2487s
	iters: 3000, epoch: 5 | loss: 1.9798725
	speed: 0.0302s/iter; left time: 864.8039s
	iters: 3100, epoch: 5 | loss: 2.1328242
	speed: 0.0304s/iter; left time: 868.5760s
	iters: 3200, epoch: 5 | loss: 1.6543337
	speed: 0.0301s/iter; left time: 856.1624s
	iters: 3300, epoch: 5 | loss: 2.4436450
	speed: 0.0298s/iter; left time: 844.6003s
	iters: 3400, epoch: 5 | loss: 2.2264552
	speed: 0.0304s/iter; left time: 858.8608s
	iters: 3500, epoch: 5 | loss: 2.4601498
	speed: 0.0302s/iter; left time: 851.5804s
	iters: 3600, epoch: 5 | loss: 2.1608357
	speed: 0.0303s/iter; left time: 849.5142s
	iters: 3700, epoch: 5 | loss: 1.9763472
	speed: 0.0303s/iter; left time: 846.4454s
	iters: 3800, epoch: 5 | loss: 1.9443753
	speed: 0.0298s/iter; left time: 830.1234s
	iters: 3900, epoch: 5 | loss: 1.9580756
	speed: 0.0300s/iter; left time: 831.7255s
	iters: 4000, epoch: 5 | loss: 2.3048446
	speed: 0.0302s/iter; left time: 834.4121s
	iters: 4100, epoch: 5 | loss: 2.3132184
	speed: 0.0304s/iter; left time: 838.7753s
	iters: 4200, epoch: 5 | loss: 1.8407834
	speed: 0.0305s/iter; left time: 837.2757s
	iters: 4300, epoch: 5 | loss: 2.0622904
	speed: 0.0303s/iter; left time: 828.6283s
	iters: 4400, epoch: 5 | loss: 2.1367750
	speed: 0.0304s/iter; left time: 829.8210s
	iters: 4500, epoch: 5 | loss: 2.2581739
	speed: 0.0303s/iter; left time: 823.9698s
	iters: 4600, epoch: 5 | loss: 1.8698488
	speed: 0.0305s/iter; left time: 824.4548s
	iters: 4700, epoch: 5 | loss: 1.5123683
	speed: 0.0304s/iter; left time: 820.7368s
	iters: 4800, epoch: 5 | loss: 2.0285161
	speed: 0.0302s/iter; left time: 812.6381s
	iters: 4900, epoch: 5 | loss: 2.3247583
	speed: 0.0304s/iter; left time: 813.7282s
	iters: 5000, epoch: 5 | loss: 2.0080900
	speed: 0.0303s/iter; left time: 808.4706s
	iters: 5100, epoch: 5 | loss: 1.9246396
	speed: 0.0295s/iter; left time: 782.8988s
	iters: 5200, epoch: 5 | loss: 2.2194736
	speed: 0.0301s/iter; left time: 795.4912s
Epoch: 5 cost time: 159.25063252449036
Epoch: 5, Steps: 5278 | Train Loss: 1.9891810 Vali Loss: 2.2096720 Test Loss: 2.7750721
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.8814795
	speed: 0.6671s/iter; left time: 17538.5388s
	iters: 200, epoch: 6 | loss: 1.8121920
	speed: 0.0298s/iter; left time: 781.7517s
	iters: 300, epoch: 6 | loss: 1.6993154
	speed: 0.0299s/iter; left time: 779.7115s
	iters: 400, epoch: 6 | loss: 2.4351108
	speed: 0.0302s/iter; left time: 785.4148s
	iters: 500, epoch: 6 | loss: 2.0505950
	speed: 0.0303s/iter; left time: 784.2214s
	iters: 600, epoch: 6 | loss: 1.7656238
	speed: 0.0295s/iter; left time: 760.2765s
	iters: 700, epoch: 6 | loss: 2.3424881
	speed: 0.0302s/iter; left time: 777.1439s
	iters: 800, epoch: 6 | loss: 1.9688702
	speed: 0.0303s/iter; left time: 774.9901s
	iters: 900, epoch: 6 | loss: 2.0480955
	speed: 0.0304s/iter; left time: 773.9492s
	iters: 1000, epoch: 6 | loss: 2.2286704
	speed: 0.0305s/iter; left time: 775.2060s
	iters: 1100, epoch: 6 | loss: 1.7165017
	speed: 0.0303s/iter; left time: 766.1589s
	iters: 1200, epoch: 6 | loss: 1.9239638
	speed: 0.0303s/iter; left time: 762.2695s
	iters: 1300, epoch: 6 | loss: 1.8593112
	speed: 0.0302s/iter; left time: 758.8620s
	iters: 1400, epoch: 6 | loss: 2.2096791
	speed: 0.0301s/iter; left time: 751.5533s
	iters: 1500, epoch: 6 | loss: 2.0494270
	speed: 0.0304s/iter; left time: 756.2693s
	iters: 1600, epoch: 6 | loss: 2.3197730
	speed: 0.0302s/iter; left time: 749.0282s
	iters: 1700, epoch: 6 | loss: 2.0649798
	speed: 0.0301s/iter; left time: 743.0509s
	iters: 1800, epoch: 6 | loss: 2.2193174
	speed: 0.0304s/iter; left time: 746.7589s
	iters: 1900, epoch: 6 | loss: 2.0583515
	speed: 0.0303s/iter; left time: 742.1391s
	iters: 2000, epoch: 6 | loss: 1.6689939
	speed: 0.0302s/iter; left time: 737.4067s
	iters: 2100, epoch: 6 | loss: 1.7297709
	speed: 0.0294s/iter; left time: 713.1090s
	iters: 2200, epoch: 6 | loss: 1.6457584
	speed: 0.0300s/iter; left time: 725.6351s
	iters: 2300, epoch: 6 | loss: 2.1797769
	speed: 0.0302s/iter; left time: 727.3412s
	iters: 2400, epoch: 6 | loss: 1.9566007
	speed: 0.0303s/iter; left time: 727.4496s
	iters: 2500, epoch: 6 | loss: 2.0450859
	speed: 0.0294s/iter; left time: 703.3313s
	iters: 2600, epoch: 6 | loss: 2.1764200
	speed: 0.0295s/iter; left time: 702.4668s
	iters: 2700, epoch: 6 | loss: 2.2301309
	speed: 0.0300s/iter; left time: 711.8051s
	iters: 2800, epoch: 6 | loss: 1.7816131
	speed: 0.0298s/iter; left time: 704.0145s
	iters: 2900, epoch: 6 | loss: 2.4994850
	speed: 0.0301s/iter; left time: 706.5335s
	iters: 3000, epoch: 6 | loss: 1.6259516
	speed: 0.0301s/iter; left time: 704.0156s
	iters: 3100, epoch: 6 | loss: 1.7474507
	speed: 0.0299s/iter; left time: 697.2680s
	iters: 3200, epoch: 6 | loss: 1.8730744
	speed: 0.0300s/iter; left time: 694.8986s
	iters: 3300, epoch: 6 | loss: 1.6764016
	speed: 0.0302s/iter; left time: 696.2431s
	iters: 3400, epoch: 6 | loss: 2.2475913
	speed: 0.0302s/iter; left time: 694.2599s
	iters: 3500, epoch: 6 | loss: 1.6787721
	speed: 0.0305s/iter; left time: 698.9229s
	iters: 3600, epoch: 6 | loss: 2.4753079
	speed: 0.0304s/iter; left time: 692.5168s
	iters: 3700, epoch: 6 | loss: 2.0008161
	speed: 0.0300s/iter; left time: 679.8455s
	iters: 3800, epoch: 6 | loss: 1.9657751
	speed: 0.0302s/iter; left time: 681.7390s
	iters: 3900, epoch: 6 | loss: 2.2671165
	speed: 0.0299s/iter; left time: 671.4719s
	iters: 4000, epoch: 6 | loss: 2.0174553
	speed: 0.0303s/iter; left time: 678.6007s
	iters: 4100, epoch: 6 | loss: 1.9300877
	speed: 0.0302s/iter; left time: 673.2161s
	iters: 4200, epoch: 6 | loss: 2.4435995
	speed: 0.0298s/iter; left time: 662.3883s
	iters: 4300, epoch: 6 | loss: 2.0360649
	speed: 0.0305s/iter; left time: 673.8070s
	iters: 4400, epoch: 6 | loss: 1.9084771
	speed: 0.0304s/iter; left time: 667.7806s
	iters: 4500, epoch: 6 | loss: 1.7035654
	speed: 0.0302s/iter; left time: 661.1724s
	iters: 4600, epoch: 6 | loss: 2.1310642
	speed: 0.0303s/iter; left time: 660.7731s
	iters: 4700, epoch: 6 | loss: 2.2479963
	speed: 0.0292s/iter; left time: 633.6013s
	iters: 4800, epoch: 6 | loss: 1.9407260
	speed: 0.0304s/iter; left time: 656.1477s
	iters: 4900, epoch: 6 | loss: 2.5443010
	speed: 0.0304s/iter; left time: 653.3588s
	iters: 5000, epoch: 6 | loss: 2.0524464
	speed: 0.0302s/iter; left time: 645.6829s
	iters: 5100, epoch: 6 | loss: 1.8443422
	speed: 0.0298s/iter; left time: 635.3918s
	iters: 5200, epoch: 6 | loss: 1.7976778
	speed: 0.0297s/iter; left time: 629.3050s
Epoch: 6 cost time: 159.02591228485107
Epoch: 6, Steps: 5278 | Train Loss: 1.9891559 Vali Loss: 2.2036152 Test Loss: 2.7726452
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141325
test shape: (14132, 1, 96, 107) (14132, 1, 96, 107)
test shape: (14132, 96, 107) (14132, 96, 107)
mse:2.7724697589874268, mae:1.3832496404647827
>>>>>>>Overall time: 1452 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 844551
val 141327
test 141325
	iters: 100, epoch: 1 | loss: 1.5910627
	speed: 0.0324s/iter; left time: 1705.7434s
	iters: 200, epoch: 1 | loss: 1.5515182
	speed: 0.0304s/iter; left time: 1596.3465s
	iters: 300, epoch: 1 | loss: 1.8545226
	speed: 0.0298s/iter; left time: 1564.4657s
	iters: 400, epoch: 1 | loss: 2.4638515
	speed: 0.0302s/iter; left time: 1580.3576s
	iters: 500, epoch: 1 | loss: 1.5549513
	speed: 0.0305s/iter; left time: 1592.0765s
	iters: 600, epoch: 1 | loss: 1.7807653
	speed: 0.0300s/iter; left time: 1564.5304s
	iters: 700, epoch: 1 | loss: 2.4023507
	speed: 0.0301s/iter; left time: 1570.1499s
	iters: 800, epoch: 1 | loss: 1.8010185
	speed: 0.0303s/iter; left time: 1573.4722s
	iters: 900, epoch: 1 | loss: 1.7984763
	speed: 0.0304s/iter; left time: 1575.4517s
	iters: 1000, epoch: 1 | loss: 1.9661840
	speed: 0.0300s/iter; left time: 1552.0442s
	iters: 1100, epoch: 1 | loss: 1.9596168
	speed: 0.0300s/iter; left time: 1552.2064s
	iters: 1200, epoch: 1 | loss: 1.6542624
	speed: 0.0296s/iter; left time: 1528.9483s
	iters: 1300, epoch: 1 | loss: 1.8201122
	speed: 0.0301s/iter; left time: 1551.5418s
	iters: 1400, epoch: 1 | loss: 2.5606239
	speed: 0.0297s/iter; left time: 1525.7229s
	iters: 1500, epoch: 1 | loss: 1.8451444
	speed: 0.0301s/iter; left time: 1543.1083s
	iters: 1600, epoch: 1 | loss: 1.4526908
	speed: 0.0301s/iter; left time: 1541.1232s
	iters: 1700, epoch: 1 | loss: 2.4204938
	speed: 0.0302s/iter; left time: 1545.0873s
	iters: 1800, epoch: 1 | loss: 1.7881705
	speed: 0.0303s/iter; left time: 1545.5596s
	iters: 1900, epoch: 1 | loss: 1.9591269
	speed: 0.0304s/iter; left time: 1546.3032s
	iters: 2000, epoch: 1 | loss: 1.4897517
	speed: 0.0303s/iter; left time: 1538.3899s
	iters: 2100, epoch: 1 | loss: 2.1628540
	speed: 0.0305s/iter; left time: 1544.2039s
	iters: 2200, epoch: 1 | loss: 1.7611171
	speed: 0.0303s/iter; left time: 1533.1537s
	iters: 2300, epoch: 1 | loss: 1.9199176
	speed: 0.0303s/iter; left time: 1528.1148s
	iters: 2400, epoch: 1 | loss: 1.9666213
	speed: 0.0300s/iter; left time: 1509.6532s
	iters: 2500, epoch: 1 | loss: 2.1631095
	speed: 0.0296s/iter; left time: 1490.4861s
	iters: 2600, epoch: 1 | loss: 2.1688526
	speed: 0.0300s/iter; left time: 1503.3299s
	iters: 2700, epoch: 1 | loss: 2.0758631
	speed: 0.0300s/iter; left time: 1503.5090s
	iters: 2800, epoch: 1 | loss: 1.7561318
	speed: 0.0296s/iter; left time: 1476.9445s
	iters: 2900, epoch: 1 | loss: 1.3046083
	speed: 0.0301s/iter; left time: 1500.0533s
	iters: 3000, epoch: 1 | loss: 1.9872077
	speed: 0.0302s/iter; left time: 1501.3595s
	iters: 3100, epoch: 1 | loss: 1.7530321
	speed: 0.0299s/iter; left time: 1487.6733s
	iters: 3200, epoch: 1 | loss: 1.8737155
	speed: 0.0301s/iter; left time: 1490.7285s
	iters: 3300, epoch: 1 | loss: 2.0694253
	speed: 0.0300s/iter; left time: 1485.9029s
	iters: 3400, epoch: 1 | loss: 2.4147828
	speed: 0.0301s/iter; left time: 1486.2864s
	iters: 3500, epoch: 1 | loss: 2.1713006
	speed: 0.0304s/iter; left time: 1498.4144s
	iters: 3600, epoch: 1 | loss: 2.2628474
	speed: 0.0300s/iter; left time: 1474.7084s
	iters: 3700, epoch: 1 | loss: 2.1643846
	speed: 0.0304s/iter; left time: 1490.0687s
	iters: 3800, epoch: 1 | loss: 2.0011580
	speed: 0.0304s/iter; left time: 1489.2605s
	iters: 3900, epoch: 1 | loss: 2.2003007
	speed: 0.0298s/iter; left time: 1458.4027s
	iters: 4000, epoch: 1 | loss: 1.7518493
	speed: 0.0304s/iter; left time: 1482.6005s
	iters: 4100, epoch: 1 | loss: 2.5517650
	speed: 0.0304s/iter; left time: 1477.6898s
	iters: 4200, epoch: 1 | loss: 1.9614135
	speed: 0.0305s/iter; left time: 1481.4342s
	iters: 4300, epoch: 1 | loss: 2.2061396
	speed: 0.0306s/iter; left time: 1482.1365s
	iters: 4400, epoch: 1 | loss: 2.3204069
	speed: 0.0303s/iter; left time: 1465.2071s
	iters: 4500, epoch: 1 | loss: 2.1909897
	speed: 0.0302s/iter; left time: 1457.9238s
	iters: 4600, epoch: 1 | loss: 1.7683634
	speed: 0.0299s/iter; left time: 1439.4303s
	iters: 4700, epoch: 1 | loss: 2.0703082
	speed: 0.0302s/iter; left time: 1452.7143s
	iters: 4800, epoch: 1 | loss: 2.0133641
	speed: 0.0300s/iter; left time: 1441.2256s
	iters: 4900, epoch: 1 | loss: 2.2066267
	speed: 0.0301s/iter; left time: 1440.4882s
	iters: 5000, epoch: 1 | loss: 2.4233234
	speed: 0.0300s/iter; left time: 1432.2949s
	iters: 5100, epoch: 1 | loss: 1.8573056
	speed: 0.0300s/iter; left time: 1428.5207s
	iters: 5200, epoch: 1 | loss: 2.3299637
	speed: 0.0304s/iter; left time: 1446.5986s
Epoch: 1 cost time: 159.39809560775757
Epoch: 1, Steps: 5278 | Train Loss: 1.9099448 Vali Loss: 2.2254949 Test Loss: 2.7821982
Validation loss decreased (inf --> 2.225495).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6352847
	speed: 0.6608s/iter; left time: 31325.0044s
	iters: 200, epoch: 2 | loss: 1.8908159
	speed: 0.0300s/iter; left time: 1417.4177s
	iters: 300, epoch: 2 | loss: 1.8227620
	speed: 0.0297s/iter; left time: 1402.8434s
	iters: 400, epoch: 2 | loss: 1.9562140
	speed: 0.0299s/iter; left time: 1406.1933s
	iters: 500, epoch: 2 | loss: 2.1405914
	speed: 0.0300s/iter; left time: 1408.0437s
	iters: 600, epoch: 2 | loss: 2.1378803
	speed: 0.0298s/iter; left time: 1399.9778s
	iters: 700, epoch: 2 | loss: 2.0885732
	speed: 0.0295s/iter; left time: 1380.1978s
	iters: 800, epoch: 2 | loss: 2.1378446
	speed: 0.0299s/iter; left time: 1396.2446s
	iters: 900, epoch: 2 | loss: 2.5326595
	speed: 0.0299s/iter; left time: 1395.3908s
	iters: 1000, epoch: 2 | loss: 1.5917780
	speed: 0.0304s/iter; left time: 1413.4268s
	iters: 1100, epoch: 2 | loss: 2.2312891
	speed: 0.0302s/iter; left time: 1399.8964s
	iters: 1200, epoch: 2 | loss: 1.8608567
	speed: 0.0304s/iter; left time: 1406.8011s
	iters: 1300, epoch: 2 | loss: 1.9851477
	speed: 0.0303s/iter; left time: 1399.3359s
	iters: 1400, epoch: 2 | loss: 1.3267064
	speed: 0.0299s/iter; left time: 1379.7533s
	iters: 1500, epoch: 2 | loss: 1.7105745
	speed: 0.0304s/iter; left time: 1398.7720s
	iters: 1600, epoch: 2 | loss: 1.7955122
	speed: 0.0299s/iter; left time: 1370.4582s
	iters: 1700, epoch: 2 | loss: 2.2348359
	speed: 0.0302s/iter; left time: 1382.3204s
	iters: 1800, epoch: 2 | loss: 1.6529940
	speed: 0.0307s/iter; left time: 1402.3476s
	iters: 1900, epoch: 2 | loss: 2.0777030
	speed: 0.0297s/iter; left time: 1354.8036s
	iters: 2000, epoch: 2 | loss: 1.9713058
	speed: 0.0303s/iter; left time: 1377.9517s
	iters: 2100, epoch: 2 | loss: 1.5998896
	speed: 0.0304s/iter; left time: 1379.0188s
	iters: 2200, epoch: 2 | loss: 1.6480595
	speed: 0.0300s/iter; left time: 1358.5362s
	iters: 2300, epoch: 2 | loss: 1.8703173
	speed: 0.0305s/iter; left time: 1377.3744s
	iters: 2400, epoch: 2 | loss: 1.5512305
	speed: 0.0300s/iter; left time: 1352.6163s
	iters: 2500, epoch: 2 | loss: 2.1076245
	speed: 0.0301s/iter; left time: 1356.0705s
	iters: 2600, epoch: 2 | loss: 2.0354304
	speed: 0.0298s/iter; left time: 1337.0822s
	iters: 2700, epoch: 2 | loss: 1.9648513
	speed: 0.0298s/iter; left time: 1335.2962s
	iters: 2800, epoch: 2 | loss: 1.9213302
	speed: 0.0301s/iter; left time: 1346.4855s
	iters: 2900, epoch: 2 | loss: 1.8592135
	speed: 0.0304s/iter; left time: 1356.7129s
	iters: 3000, epoch: 2 | loss: 2.0239937
	speed: 0.0302s/iter; left time: 1344.7741s
	iters: 3100, epoch: 2 | loss: 2.3660834
	speed: 0.0304s/iter; left time: 1348.7446s
	iters: 3200, epoch: 2 | loss: 2.3694739
	speed: 0.0304s/iter; left time: 1346.8343s
	iters: 3300, epoch: 2 | loss: 2.0535777
	speed: 0.0303s/iter; left time: 1340.6980s
	iters: 3400, epoch: 2 | loss: 1.8972591
	speed: 0.0300s/iter; left time: 1321.3287s
	iters: 3500, epoch: 2 | loss: 1.8091177
	speed: 0.0303s/iter; left time: 1332.2043s
	iters: 3600, epoch: 2 | loss: 1.6999513
	speed: 0.0305s/iter; left time: 1338.5166s
	iters: 3700, epoch: 2 | loss: 1.7515521
	speed: 0.0302s/iter; left time: 1322.8948s
	iters: 3800, epoch: 2 | loss: 1.6227897
	speed: 0.0303s/iter; left time: 1323.8089s
	iters: 3900, epoch: 2 | loss: 2.1159856
	speed: 0.0304s/iter; left time: 1324.4143s
	iters: 4000, epoch: 2 | loss: 1.9059752
	speed: 0.0305s/iter; left time: 1324.9412s
	iters: 4100, epoch: 2 | loss: 1.8260460
	speed: 0.0305s/iter; left time: 1324.3216s
	iters: 4200, epoch: 2 | loss: 1.8316104
	speed: 0.0301s/iter; left time: 1303.5273s
	iters: 4300, epoch: 2 | loss: 1.9633375
	speed: 0.0304s/iter; left time: 1314.7808s
	iters: 4400, epoch: 2 | loss: 1.9000887
	speed: 0.0303s/iter; left time: 1304.6594s
	iters: 4500, epoch: 2 | loss: 2.0724037
	speed: 0.0302s/iter; left time: 1298.9965s
	iters: 4600, epoch: 2 | loss: 1.9979900
	speed: 0.0302s/iter; left time: 1294.3041s
	iters: 4700, epoch: 2 | loss: 1.9099358
	speed: 0.0304s/iter; left time: 1302.9698s
	iters: 4800, epoch: 2 | loss: 2.3152528
	speed: 0.0299s/iter; left time: 1276.6929s
	iters: 4900, epoch: 2 | loss: 1.9835336
	speed: 0.0301s/iter; left time: 1281.6218s
	iters: 5000, epoch: 2 | loss: 1.6015846
	speed: 0.0295s/iter; left time: 1252.9487s
	iters: 5100, epoch: 2 | loss: 1.5010715
	speed: 0.0304s/iter; left time: 1289.8396s
	iters: 5200, epoch: 2 | loss: 1.4731041
	speed: 0.0303s/iter; left time: 1283.7725s
Epoch: 2 cost time: 159.03119611740112
Epoch: 2, Steps: 5278 | Train Loss: 1.9901630 Vali Loss: 2.2046621 Test Loss: 2.7728496
Validation loss decreased (2.225495 --> 2.204662).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 2.4268641
	speed: 0.6585s/iter; left time: 27738.6562s
	iters: 200, epoch: 3 | loss: 1.9661704
	speed: 0.0301s/iter; left time: 1265.2904s
	iters: 300, epoch: 3 | loss: 2.0120428
	speed: 0.0301s/iter; left time: 1261.0257s
	iters: 400, epoch: 3 | loss: 2.2520390
	speed: 0.0302s/iter; left time: 1263.6198s
	iters: 500, epoch: 3 | loss: 2.0754609
	speed: 0.0299s/iter; left time: 1246.9172s
	iters: 600, epoch: 3 | loss: 1.7002757
	speed: 0.0300s/iter; left time: 1247.2738s
	iters: 700, epoch: 3 | loss: 2.0760612
	speed: 0.0303s/iter; left time: 1257.5618s
	iters: 800, epoch: 3 | loss: 1.6100971
	speed: 0.0301s/iter; left time: 1245.1298s
	iters: 900, epoch: 3 | loss: 2.3595369
	speed: 0.0304s/iter; left time: 1254.2331s
	iters: 1000, epoch: 3 | loss: 2.0265892
	speed: 0.0302s/iter; left time: 1243.0136s
	iters: 1100, epoch: 3 | loss: 1.9315883
	speed: 0.0298s/iter; left time: 1224.0401s
	iters: 1200, epoch: 3 | loss: 1.7728618
	speed: 0.0304s/iter; left time: 1247.0816s
	iters: 1300, epoch: 3 | loss: 2.4706502
	speed: 0.0300s/iter; left time: 1226.7863s
	iters: 1400, epoch: 3 | loss: 2.0086267
	speed: 0.0300s/iter; left time: 1224.0874s
	iters: 1500, epoch: 3 | loss: 2.1621969
	speed: 0.0305s/iter; left time: 1240.6768s
	iters: 1600, epoch: 3 | loss: 1.7858565
	speed: 0.0303s/iter; left time: 1232.6302s
	iters: 1700, epoch: 3 | loss: 2.0337470
	speed: 0.0299s/iter; left time: 1213.2304s
	iters: 1800, epoch: 3 | loss: 2.0485866
	speed: 0.0307s/iter; left time: 1240.8702s
	iters: 1900, epoch: 3 | loss: 1.8802596
	speed: 0.0300s/iter; left time: 1209.6308s
	iters: 2000, epoch: 3 | loss: 2.1842105
	speed: 0.0301s/iter; left time: 1210.5317s
	iters: 2100, epoch: 3 | loss: 1.9629118
	speed: 0.0303s/iter; left time: 1215.8317s
	iters: 2200, epoch: 3 | loss: 1.6977451
	speed: 0.0303s/iter; left time: 1211.3657s
	iters: 2300, epoch: 3 | loss: 2.1321118
	speed: 0.0302s/iter; left time: 1204.7207s
	iters: 2400, epoch: 3 | loss: 2.1864080
	speed: 0.0301s/iter; left time: 1197.1467s
	iters: 2500, epoch: 3 | loss: 1.9650717
	speed: 0.0299s/iter; left time: 1189.6364s
	iters: 2600, epoch: 3 | loss: 2.1513765
	speed: 0.0300s/iter; left time: 1188.2475s
	iters: 2700, epoch: 3 | loss: 1.9969815
	speed: 0.0305s/iter; left time: 1205.3974s
	iters: 2800, epoch: 3 | loss: 1.9594296
	speed: 0.0303s/iter; left time: 1194.9956s
	iters: 2900, epoch: 3 | loss: 2.3484616
	speed: 0.0298s/iter; left time: 1169.9492s
	iters: 3000, epoch: 3 | loss: 1.9222250
	speed: 0.0303s/iter; left time: 1188.1199s
	iters: 3100, epoch: 3 | loss: 1.5583717
	speed: 0.0300s/iter; left time: 1173.3073s
	iters: 3200, epoch: 3 | loss: 2.0953021
	speed: 0.0303s/iter; left time: 1180.9138s
	iters: 3300, epoch: 3 | loss: 2.1457436
	speed: 0.0297s/iter; left time: 1157.4560s
	iters: 3400, epoch: 3 | loss: 2.2106171
	speed: 0.0303s/iter; left time: 1175.6346s
	iters: 3500, epoch: 3 | loss: 1.9627204
	speed: 0.0298s/iter; left time: 1152.7841s
	iters: 3600, epoch: 3 | loss: 2.0819652
	speed: 0.0303s/iter; left time: 1171.7690s
	iters: 3700, epoch: 3 | loss: 1.5026689
	speed: 0.0304s/iter; left time: 1170.8441s
	iters: 3800, epoch: 3 | loss: 1.8664495
	speed: 0.0300s/iter; left time: 1152.2405s
	iters: 3900, epoch: 3 | loss: 2.0995231
	speed: 0.0302s/iter; left time: 1158.9643s
	iters: 4000, epoch: 3 | loss: 2.0247419
	speed: 0.0305s/iter; left time: 1164.5755s
	iters: 4100, epoch: 3 | loss: 1.7810837
	speed: 0.0301s/iter; left time: 1148.9272s
	iters: 4200, epoch: 3 | loss: 1.8613406
	speed: 0.0305s/iter; left time: 1160.1672s
	iters: 4300, epoch: 3 | loss: 2.3790181
	speed: 0.0298s/iter; left time: 1130.2365s
	iters: 4400, epoch: 3 | loss: 2.2529001
	speed: 0.0301s/iter; left time: 1137.9375s
	iters: 4500, epoch: 3 | loss: 1.7601674
	speed: 0.0304s/iter; left time: 1145.3065s
	iters: 4600, epoch: 3 | loss: 2.2463706
	speed: 0.0302s/iter; left time: 1136.8758s
	iters: 4700, epoch: 3 | loss: 2.0257804
	speed: 0.0299s/iter; left time: 1122.4939s
	iters: 4800, epoch: 3 | loss: 1.8468754
	speed: 0.0303s/iter; left time: 1133.8314s
	iters: 4900, epoch: 3 | loss: 1.6795249
	speed: 0.0299s/iter; left time: 1115.8976s
	iters: 5000, epoch: 3 | loss: 2.2074192
	speed: 0.0299s/iter; left time: 1111.8922s
	iters: 5100, epoch: 3 | loss: 1.5791414
	speed: 0.0302s/iter; left time: 1119.6376s
	iters: 5200, epoch: 3 | loss: 2.6871498
	speed: 0.0301s/iter; left time: 1116.1441s
Epoch: 3 cost time: 159.22406435012817
Epoch: 3, Steps: 5278 | Train Loss: 1.9893495 Vali Loss: 2.2019114 Test Loss: 2.7724674
Validation loss decreased (2.204662 --> 2.201911).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 2.2135360
	speed: 0.6617s/iter; left time: 24381.4233s
	iters: 200, epoch: 4 | loss: 1.8175306
	speed: 0.0302s/iter; left time: 1110.8028s
	iters: 300, epoch: 4 | loss: 1.9279454
	speed: 0.0299s/iter; left time: 1095.2938s
	iters: 400, epoch: 4 | loss: 1.7233844
	speed: 0.0302s/iter; left time: 1103.8004s
	iters: 500, epoch: 4 | loss: 1.7917438
	speed: 0.0303s/iter; left time: 1103.5250s
	iters: 600, epoch: 4 | loss: 1.7337698
	speed: 0.0299s/iter; left time: 1086.8333s
	iters: 700, epoch: 4 | loss: 1.8982295
	speed: 0.0302s/iter; left time: 1093.2915s
	iters: 800, epoch: 4 | loss: 1.9396662
	speed: 0.0303s/iter; left time: 1094.6892s
	iters: 900, epoch: 4 | loss: 2.5135205
	speed: 0.0299s/iter; left time: 1077.5805s
	iters: 1000, epoch: 4 | loss: 1.4805466
	speed: 0.0302s/iter; left time: 1084.3951s
	iters: 1100, epoch: 4 | loss: 1.8784976
	speed: 0.0304s/iter; left time: 1089.3838s
	iters: 1200, epoch: 4 | loss: 2.5861497
	speed: 0.0301s/iter; left time: 1076.0691s
	iters: 1300, epoch: 4 | loss: 1.8472658
	speed: 0.0299s/iter; left time: 1066.3760s
	iters: 1400, epoch: 4 | loss: 2.0932515
	speed: 0.0301s/iter; left time: 1070.5934s
	iters: 1500, epoch: 4 | loss: 1.6319625
	speed: 0.0297s/iter; left time: 1054.0579s
	iters: 1600, epoch: 4 | loss: 1.5408748
	speed: 0.0297s/iter; left time: 1051.4129s
	iters: 1700, epoch: 4 | loss: 2.4229219
	speed: 0.0297s/iter; left time: 1046.3314s
	iters: 1800, epoch: 4 | loss: 2.2894275
	speed: 0.0300s/iter; left time: 1055.7905s
	iters: 1900, epoch: 4 | loss: 2.1765940
	speed: 0.0303s/iter; left time: 1061.0798s
	iters: 2000, epoch: 4 | loss: 2.1717799
	speed: 0.0300s/iter; left time: 1047.1946s
	iters: 2100, epoch: 4 | loss: 2.0100651
	speed: 0.0302s/iter; left time: 1052.9805s
	iters: 2200, epoch: 4 | loss: 1.8605578
	speed: 0.0302s/iter; left time: 1049.7915s
	iters: 2300, epoch: 4 | loss: 1.9150229
	speed: 0.0303s/iter; left time: 1051.5064s
	iters: 2400, epoch: 4 | loss: 2.2174885
	speed: 0.0305s/iter; left time: 1052.5444s
	iters: 2500, epoch: 4 | loss: 2.0580468
	speed: 0.0302s/iter; left time: 1038.8389s
	iters: 2600, epoch: 4 | loss: 1.6044127
	speed: 0.0304s/iter; left time: 1044.2630s
	iters: 2700, epoch: 4 | loss: 1.4763225
	speed: 0.0298s/iter; left time: 1021.9618s
	iters: 2800, epoch: 4 | loss: 1.9873061
	speed: 0.0304s/iter; left time: 1036.8032s
	iters: 2900, epoch: 4 | loss: 1.6040308
	speed: 0.0304s/iter; left time: 1033.4797s
	iters: 3000, epoch: 4 | loss: 1.9266047
	speed: 0.0304s/iter; left time: 1033.6053s
	iters: 3100, epoch: 4 | loss: 1.8736647
	speed: 0.0299s/iter; left time: 1012.9692s
	iters: 3200, epoch: 4 | loss: 1.7617731
	speed: 0.0303s/iter; left time: 1021.6806s
	iters: 3300, epoch: 4 | loss: 1.9306757
	speed: 0.0303s/iter; left time: 1019.7975s
	iters: 3400, epoch: 4 | loss: 1.9973750
	speed: 0.0301s/iter; left time: 1010.0355s
	iters: 3500, epoch: 4 | loss: 1.7792325
	speed: 0.0299s/iter; left time: 1000.5206s
	iters: 3600, epoch: 4 | loss: 2.0861733
	speed: 0.0303s/iter; left time: 1010.3991s
	iters: 3700, epoch: 4 | loss: 2.1852727
	speed: 0.0293s/iter; left time: 975.2117s
	iters: 3800, epoch: 4 | loss: 2.4388361
	speed: 0.0301s/iter; left time: 998.7812s
	iters: 3900, epoch: 4 | loss: 1.6494009
	speed: 0.0298s/iter; left time: 986.1736s
	iters: 4000, epoch: 4 | loss: 2.1736329
	speed: 0.0302s/iter; left time: 993.8162s
	iters: 4100, epoch: 4 | loss: 2.0783029
	speed: 0.0300s/iter; left time: 986.2012s
	iters: 4200, epoch: 4 | loss: 1.8687361
	speed: 0.0302s/iter; left time: 988.0848s
	iters: 4300, epoch: 4 | loss: 2.1014624
	speed: 0.0303s/iter; left time: 988.3957s
	iters: 4400, epoch: 4 | loss: 1.6775856
	speed: 0.0300s/iter; left time: 976.9943s
	iters: 4500, epoch: 4 | loss: 1.9942119
	speed: 0.0299s/iter; left time: 970.6889s
	iters: 4600, epoch: 4 | loss: 2.1005657
	speed: 0.0299s/iter; left time: 965.6284s
	iters: 4700, epoch: 4 | loss: 2.3281150
	speed: 0.0300s/iter; left time: 968.6971s
	iters: 4800, epoch: 4 | loss: 1.7535526
	speed: 0.0300s/iter; left time: 963.8008s
	iters: 4900, epoch: 4 | loss: 2.3158309
	speed: 0.0304s/iter; left time: 972.7566s
	iters: 5000, epoch: 4 | loss: 2.3213198
	speed: 0.0303s/iter; left time: 968.3956s
	iters: 5100, epoch: 4 | loss: 1.5885216
	speed: 0.0301s/iter; left time: 957.4911s
	iters: 5200, epoch: 4 | loss: 1.9287333
	speed: 0.0303s/iter; left time: 961.6853s
Epoch: 4 cost time: 159.0065793991089
Epoch: 4, Steps: 5278 | Train Loss: 1.9892742 Vali Loss: 2.2019179 Test Loss: 2.7718363
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 2.0617790
	speed: 0.6625s/iter; left time: 20915.3238s
	iters: 200, epoch: 5 | loss: 2.1394947
	speed: 0.0302s/iter; left time: 949.5440s
	iters: 300, epoch: 5 | loss: 2.2878091
	speed: 0.0303s/iter; left time: 949.2467s
	iters: 400, epoch: 5 | loss: 2.1621237
	speed: 0.0304s/iter; left time: 949.3470s
	iters: 500, epoch: 5 | loss: 1.9918981
	speed: 0.0300s/iter; left time: 933.7366s
	iters: 600, epoch: 5 | loss: 2.1235628
	speed: 0.0304s/iter; left time: 943.3954s
	iters: 700, epoch: 5 | loss: 1.6052681
	speed: 0.0302s/iter; left time: 935.8771s
	iters: 800, epoch: 5 | loss: 2.0952840
	speed: 0.0297s/iter; left time: 916.0647s
	iters: 900, epoch: 5 | loss: 2.0591881
	speed: 0.0301s/iter; left time: 925.7806s
	iters: 1000, epoch: 5 | loss: 2.3761263
	speed: 0.0299s/iter; left time: 918.1175s
	iters: 1100, epoch: 5 | loss: 1.9706744
	speed: 0.0296s/iter; left time: 906.1770s
	iters: 1200, epoch: 5 | loss: 1.9454256
	speed: 0.0300s/iter; left time: 912.6149s
	iters: 1300, epoch: 5 | loss: 2.5503185
	speed: 0.0297s/iter; left time: 900.9492s
	iters: 1400, epoch: 5 | loss: 2.0041907
	speed: 0.0304s/iter; left time: 921.6188s
	iters: 1500, epoch: 5 | loss: 2.0519872
	speed: 0.0299s/iter; left time: 903.4523s
	iters: 1600, epoch: 5 | loss: 1.8805760
	speed: 0.0305s/iter; left time: 916.7818s
	iters: 1700, epoch: 5 | loss: 1.9016747
	speed: 0.0297s/iter; left time: 890.6577s
	iters: 1800, epoch: 5 | loss: 1.7690037
	speed: 0.0304s/iter; left time: 907.3386s
	iters: 1900, epoch: 5 | loss: 1.7312880
	speed: 0.0303s/iter; left time: 902.1397s
	iters: 2000, epoch: 5 | loss: 2.0594897
	speed: 0.0302s/iter; left time: 896.3955s
	iters: 2100, epoch: 5 | loss: 1.9441644
	speed: 0.0302s/iter; left time: 892.4510s
	iters: 2200, epoch: 5 | loss: 1.8790041
	speed: 0.0302s/iter; left time: 890.6915s
	iters: 2300, epoch: 5 | loss: 2.3515532
	speed: 0.0306s/iter; left time: 898.1897s
	iters: 2400, epoch: 5 | loss: 1.6687448
	speed: 0.0304s/iter; left time: 888.3167s
	iters: 2500, epoch: 5 | loss: 1.7476599
	speed: 0.0297s/iter; left time: 864.9370s
	iters: 2600, epoch: 5 | loss: 1.8041220
	speed: 0.0303s/iter; left time: 880.3381s
	iters: 2700, epoch: 5 | loss: 1.9348782
	speed: 0.0304s/iter; left time: 879.7925s
	iters: 2800, epoch: 5 | loss: 2.0975821
	speed: 0.0298s/iter; left time: 860.0440s
	iters: 2900, epoch: 5 | loss: 2.2025576
	speed: 0.0304s/iter; left time: 874.8599s
	iters: 3000, epoch: 5 | loss: 1.9798725
	speed: 0.0302s/iter; left time: 865.9703s
	iters: 3100, epoch: 5 | loss: 2.1328242
	speed: 0.0295s/iter; left time: 842.3644s
	iters: 3200, epoch: 5 | loss: 1.6543337
	speed: 0.0303s/iter; left time: 861.2064s
	iters: 3300, epoch: 5 | loss: 2.4436450
	speed: 0.0302s/iter; left time: 857.1641s
	iters: 3400, epoch: 5 | loss: 2.2264552
	speed: 0.0300s/iter; left time: 849.3019s
	iters: 3500, epoch: 5 | loss: 2.4601498
	speed: 0.0299s/iter; left time: 843.3117s
	iters: 3600, epoch: 5 | loss: 2.1608357
	speed: 0.0299s/iter; left time: 840.2879s
	iters: 3700, epoch: 5 | loss: 1.9763472
	speed: 0.0303s/iter; left time: 846.4014s
	iters: 3800, epoch: 5 | loss: 1.9443753
	speed: 0.0303s/iter; left time: 845.1429s
	iters: 3900, epoch: 5 | loss: 1.9580756
	speed: 0.0301s/iter; left time: 834.8813s
	iters: 4000, epoch: 5 | loss: 2.3048446
	speed: 0.0304s/iter; left time: 842.3691s
	iters: 4100, epoch: 5 | loss: 2.3132184
	speed: 0.0304s/iter; left time: 837.5855s
	iters: 4200, epoch: 5 | loss: 1.8407834
	speed: 0.0304s/iter; left time: 835.9747s
	iters: 4300, epoch: 5 | loss: 2.0622904
	speed: 0.0301s/iter; left time: 822.5287s
	iters: 4400, epoch: 5 | loss: 2.1367750
	speed: 0.0298s/iter; left time: 813.6843s
	iters: 4500, epoch: 5 | loss: 2.2581739
	speed: 0.0302s/iter; left time: 819.6688s
	iters: 4600, epoch: 5 | loss: 1.8698488
	speed: 0.0302s/iter; left time: 818.4582s
	iters: 4700, epoch: 5 | loss: 1.5123683
	speed: 0.0295s/iter; left time: 794.9295s
	iters: 4800, epoch: 5 | loss: 2.0285161
	speed: 0.0304s/iter; left time: 816.4840s
	iters: 4900, epoch: 5 | loss: 2.3247583
	speed: 0.0300s/iter; left time: 802.1058s
	iters: 5000, epoch: 5 | loss: 2.0080900
	speed: 0.0300s/iter; left time: 800.7831s
	iters: 5100, epoch: 5 | loss: 1.9246396
	speed: 0.0302s/iter; left time: 801.1727s
	iters: 5200, epoch: 5 | loss: 2.2194736
	speed: 0.0301s/iter; left time: 797.7519s
Epoch: 5 cost time: 159.07028913497925
Epoch: 5, Steps: 5278 | Train Loss: 1.9891810 Vali Loss: 2.2096720 Test Loss: 2.7750721
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.8814795
	speed: 0.6614s/iter; left time: 17389.6387s
	iters: 200, epoch: 6 | loss: 1.8121920
	speed: 0.0297s/iter; left time: 776.7755s
	iters: 300, epoch: 6 | loss: 1.6993154
	speed: 0.0301s/iter; left time: 785.2336s
	iters: 400, epoch: 6 | loss: 2.4351108
	speed: 0.0301s/iter; left time: 782.7967s
	iters: 500, epoch: 6 | loss: 2.0505950
	speed: 0.0303s/iter; left time: 784.9341s
	iters: 600, epoch: 6 | loss: 1.7656238
	speed: 0.0302s/iter; left time: 777.8875s
	iters: 700, epoch: 6 | loss: 2.3424881
	speed: 0.0301s/iter; left time: 773.4204s
	iters: 800, epoch: 6 | loss: 1.9688702
	speed: 0.0304s/iter; left time: 777.5289s
	iters: 900, epoch: 6 | loss: 2.0480955
	speed: 0.0305s/iter; left time: 777.2452s
	iters: 1000, epoch: 6 | loss: 2.2286704
	speed: 0.0302s/iter; left time: 766.0127s
	iters: 1100, epoch: 6 | loss: 1.7165017
	speed: 0.0302s/iter; left time: 763.1599s
	iters: 1200, epoch: 6 | loss: 1.9239638
	speed: 0.0303s/iter; left time: 764.0867s
	iters: 1300, epoch: 6 | loss: 1.8593112
	speed: 0.0305s/iter; left time: 766.3646s
	iters: 1400, epoch: 6 | loss: 2.2096791
	speed: 0.0301s/iter; left time: 752.2470s
	iters: 1500, epoch: 6 | loss: 2.0494270
	speed: 0.0302s/iter; left time: 752.1971s
	iters: 1600, epoch: 6 | loss: 2.3197730
	speed: 0.0298s/iter; left time: 737.5956s
	iters: 1700, epoch: 6 | loss: 2.0649798
	speed: 0.0301s/iter; left time: 742.2275s
	iters: 1800, epoch: 6 | loss: 2.2193174
	speed: 0.0294s/iter; left time: 723.2121s
	iters: 1900, epoch: 6 | loss: 2.0583515
	speed: 0.0305s/iter; left time: 748.0599s
	iters: 2000, epoch: 6 | loss: 1.6689939
	speed: 0.0300s/iter; left time: 731.3741s
	iters: 2100, epoch: 6 | loss: 1.7297709
	speed: 0.0295s/iter; left time: 717.5529s
	iters: 2200, epoch: 6 | loss: 1.6457584
	speed: 0.0302s/iter; left time: 730.2787s
	iters: 2300, epoch: 6 | loss: 2.1797769
	speed: 0.0297s/iter; left time: 714.9054s
	iters: 2400, epoch: 6 | loss: 1.9566007
	speed: 0.0303s/iter; left time: 726.1776s
	iters: 2500, epoch: 6 | loss: 2.0450859
	speed: 0.0303s/iter; left time: 724.1587s
	iters: 2600, epoch: 6 | loss: 2.1764200
	speed: 0.0298s/iter; left time: 709.4894s
	iters: 2700, epoch: 6 | loss: 2.2301309
	speed: 0.0303s/iter; left time: 717.4272s
	iters: 2800, epoch: 6 | loss: 1.7816131
	speed: 0.0305s/iter; left time: 719.2195s
	iters: 2900, epoch: 6 | loss: 2.4994850
	speed: 0.0293s/iter; left time: 688.3003s
	iters: 3000, epoch: 6 | loss: 1.6259516
	speed: 0.0299s/iter; left time: 700.4956s
	iters: 3100, epoch: 6 | loss: 1.7474507
	speed: 0.0299s/iter; left time: 696.5061s
	iters: 3200, epoch: 6 | loss: 1.8730744
	speed: 0.0302s/iter; left time: 701.1453s
	iters: 3300, epoch: 6 | loss: 1.6764016
	speed: 0.0303s/iter; left time: 699.6236s
	iters: 3400, epoch: 6 | loss: 2.2475913
	speed: 0.0303s/iter; left time: 696.3364s
	iters: 3500, epoch: 6 | loss: 1.6787721
	speed: 0.0299s/iter; left time: 685.4063s
	iters: 3600, epoch: 6 | loss: 2.4753079
	speed: 0.0304s/iter; left time: 693.0133s
	iters: 3700, epoch: 6 | loss: 2.0008161
	speed: 0.0302s/iter; left time: 684.8095s
	iters: 3800, epoch: 6 | loss: 1.9657751
	speed: 0.0295s/iter; left time: 665.6116s
	iters: 3900, epoch: 6 | loss: 2.2671165
	speed: 0.0303s/iter; left time: 682.4536s
	iters: 4000, epoch: 6 | loss: 2.0174553
	speed: 0.0307s/iter; left time: 688.3879s
	iters: 4100, epoch: 6 | loss: 1.9300877
	speed: 0.0303s/iter; left time: 674.8026s
	iters: 4200, epoch: 6 | loss: 2.4435995
	speed: 0.0301s/iter; left time: 669.0397s
	iters: 4300, epoch: 6 | loss: 2.0360649
	speed: 0.0305s/iter; left time: 674.0760s
	iters: 4400, epoch: 6 | loss: 1.9084771
	speed: 0.0301s/iter; left time: 662.5303s
	iters: 4500, epoch: 6 | loss: 1.7035654
	speed: 0.0304s/iter; left time: 666.4758s
	iters: 4600, epoch: 6 | loss: 2.1310642
	speed: 0.0302s/iter; left time: 657.2881s
	iters: 4700, epoch: 6 | loss: 2.2479963
	speed: 0.0305s/iter; left time: 661.6892s
	iters: 4800, epoch: 6 | loss: 1.9407260
	speed: 0.0300s/iter; left time: 648.2434s
	iters: 4900, epoch: 6 | loss: 2.5443010
	speed: 0.0299s/iter; left time: 641.6649s
	iters: 5000, epoch: 6 | loss: 2.0524464
	speed: 0.0299s/iter; left time: 638.8154s
	iters: 5100, epoch: 6 | loss: 1.8443422
	speed: 0.0297s/iter; left time: 631.3937s
	iters: 5200, epoch: 6 | loss: 1.7976778
	speed: 0.0301s/iter; left time: 638.6237s
Epoch: 6 cost time: 159.0318522453308
Epoch: 6, Steps: 5278 | Train Loss: 1.9891559 Vali Loss: 2.2036152 Test Loss: 2.7726452
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141325
test shape: (14132, 1, 96, 107) (14132, 1, 96, 107)
test shape: (14132, 96, 107) (14132, 96, 107)
mse:2.7724697589874268, mae:1.3832496404647827
>>>>>>>Overall time: 1450 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
