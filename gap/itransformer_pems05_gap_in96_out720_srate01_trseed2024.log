Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=103, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems05_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 779320
val 20627
test 147091
	iters: 100, epoch: 1 | loss: 1.4651990
	speed: 0.0340s/iter; left time: 1653.7868s
	iters: 200, epoch: 1 | loss: 1.1641871
	speed: 0.0306s/iter; left time: 1484.4856s
	iters: 300, epoch: 1 | loss: 1.6553706
	speed: 0.0319s/iter; left time: 1544.8798s
	iters: 400, epoch: 1 | loss: 1.2626573
	speed: 0.0304s/iter; left time: 1469.4758s
	iters: 500, epoch: 1 | loss: 1.4612479
	speed: 0.0304s/iter; left time: 1465.6943s
	iters: 600, epoch: 1 | loss: 1.7030530
	speed: 0.0306s/iter; left time: 1470.0234s
	iters: 700, epoch: 1 | loss: 1.6468990
	speed: 0.0304s/iter; left time: 1460.9418s
	iters: 800, epoch: 1 | loss: 1.4844002
	speed: 0.0307s/iter; left time: 1468.4476s
	iters: 900, epoch: 1 | loss: 1.5339093
	speed: 0.0305s/iter; left time: 1460.3137s
	iters: 1000, epoch: 1 | loss: 1.7598273
	speed: 0.0303s/iter; left time: 1445.4222s
	iters: 1100, epoch: 1 | loss: 1.6392610
	speed: 0.0304s/iter; left time: 1446.5693s
	iters: 1200, epoch: 1 | loss: 1.4969561
	speed: 0.0304s/iter; left time: 1442.8272s
	iters: 1300, epoch: 1 | loss: 1.8394986
	speed: 0.0304s/iter; left time: 1441.8625s
	iters: 1400, epoch: 1 | loss: 1.5921614
	speed: 0.0304s/iter; left time: 1436.5024s
	iters: 1500, epoch: 1 | loss: 1.6563555
	speed: 0.0304s/iter; left time: 1435.1678s
	iters: 1600, epoch: 1 | loss: 1.5476133
	speed: 0.0304s/iter; left time: 1432.4447s
	iters: 1700, epoch: 1 | loss: 1.6232568
	speed: 0.0304s/iter; left time: 1428.8789s
	iters: 1800, epoch: 1 | loss: 1.5736095
	speed: 0.0304s/iter; left time: 1426.1652s
	iters: 1900, epoch: 1 | loss: 1.6401968
	speed: 0.0304s/iter; left time: 1424.1429s
	iters: 2000, epoch: 1 | loss: 1.4355962
	speed: 0.0304s/iter; left time: 1420.1357s
	iters: 2100, epoch: 1 | loss: 1.6167626
	speed: 0.0304s/iter; left time: 1417.0378s
	iters: 2200, epoch: 1 | loss: 1.7657634
	speed: 0.0304s/iter; left time: 1414.0490s
	iters: 2300, epoch: 1 | loss: 1.6606210
	speed: 0.0304s/iter; left time: 1411.8065s
	iters: 2400, epoch: 1 | loss: 1.6791422
	speed: 0.0304s/iter; left time: 1406.8589s
	iters: 2500, epoch: 1 | loss: 1.4345996
	speed: 0.0304s/iter; left time: 1403.0814s
	iters: 2600, epoch: 1 | loss: 1.6580093
	speed: 0.0304s/iter; left time: 1400.9686s
	iters: 2700, epoch: 1 | loss: 1.5742487
	speed: 0.0304s/iter; left time: 1398.5928s
	iters: 2800, epoch: 1 | loss: 1.4497712
	speed: 0.0304s/iter; left time: 1397.0896s
	iters: 2900, epoch: 1 | loss: 1.6903299
	speed: 0.0304s/iter; left time: 1391.8455s
	iters: 3000, epoch: 1 | loss: 1.7774416
	speed: 0.0304s/iter; left time: 1389.0052s
	iters: 3100, epoch: 1 | loss: 1.7420765
	speed: 0.0304s/iter; left time: 1387.2678s
	iters: 3200, epoch: 1 | loss: 1.8000152
	speed: 0.0304s/iter; left time: 1384.6450s
	iters: 3300, epoch: 1 | loss: 1.6689849
	speed: 0.0304s/iter; left time: 1381.9510s
	iters: 3400, epoch: 1 | loss: 1.5494573
	speed: 0.0305s/iter; left time: 1379.8365s
	iters: 3500, epoch: 1 | loss: 1.5729605
	speed: 0.0304s/iter; left time: 1375.7900s
	iters: 3600, epoch: 1 | loss: 1.6934071
	speed: 0.0311s/iter; left time: 1402.3480s
	iters: 3700, epoch: 1 | loss: 1.7089595
	speed: 0.0304s/iter; left time: 1367.0846s
	iters: 3800, epoch: 1 | loss: 1.4832081
	speed: 0.0304s/iter; left time: 1366.7132s
	iters: 3900, epoch: 1 | loss: 1.6575218
	speed: 0.0304s/iter; left time: 1362.2644s
	iters: 4000, epoch: 1 | loss: 1.7329410
	speed: 0.0304s/iter; left time: 1359.6931s
	iters: 4100, epoch: 1 | loss: 1.6006359
	speed: 0.0304s/iter; left time: 1357.3698s
	iters: 4200, epoch: 1 | loss: 1.8538709
	speed: 0.0304s/iter; left time: 1353.2130s
	iters: 4300, epoch: 1 | loss: 1.5518097
	speed: 0.0304s/iter; left time: 1350.4691s
	iters: 4400, epoch: 1 | loss: 1.5303552
	speed: 0.0304s/iter; left time: 1347.1644s
	iters: 4500, epoch: 1 | loss: 1.6192553
	speed: 0.0304s/iter; left time: 1345.2088s
	iters: 4600, epoch: 1 | loss: 1.6577129
	speed: 0.0304s/iter; left time: 1341.9619s
	iters: 4700, epoch: 1 | loss: 1.5221610
	speed: 0.0304s/iter; left time: 1339.2071s
	iters: 4800, epoch: 1 | loss: 1.7957116
	speed: 0.0304s/iter; left time: 1335.2369s
Epoch: 1 cost time: 148.83892369270325
Epoch: 1, Steps: 4870 | Train Loss: 1.6004205 Vali Loss: 1.8848482 Test Loss: 1.8254043
Validation loss decreased (inf --> 1.884848).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6904709
	speed: 0.8656s/iter; left time: 37853.2500s
	iters: 200, epoch: 2 | loss: 1.7839446
	speed: 0.0304s/iter; left time: 1327.7488s
	iters: 300, epoch: 2 | loss: 1.5825627
	speed: 0.0312s/iter; left time: 1357.3357s
	iters: 400, epoch: 2 | loss: 1.5542784
	speed: 0.0347s/iter; left time: 1507.8563s
	iters: 500, epoch: 2 | loss: 1.6221420
	speed: 0.0329s/iter; left time: 1424.2533s
	iters: 600, epoch: 2 | loss: 1.6367791
	speed: 0.0309s/iter; left time: 1334.0948s
	iters: 700, epoch: 2 | loss: 1.4882287
	speed: 0.0304s/iter; left time: 1309.9671s
	iters: 800, epoch: 2 | loss: 1.7035867
	speed: 0.0305s/iter; left time: 1310.5998s
	iters: 900, epoch: 2 | loss: 1.6796353
	speed: 0.0304s/iter; left time: 1304.4907s
	iters: 1000, epoch: 2 | loss: 1.8889018
	speed: 0.0304s/iter; left time: 1300.9837s
	iters: 1100, epoch: 2 | loss: 1.6162988
	speed: 0.0303s/iter; left time: 1296.7546s
	iters: 1200, epoch: 2 | loss: 1.5194670
	speed: 0.0304s/iter; left time: 1294.6693s
	iters: 1300, epoch: 2 | loss: 1.8775768
	speed: 0.0304s/iter; left time: 1291.9896s
	iters: 1400, epoch: 2 | loss: 1.8564216
	speed: 0.0304s/iter; left time: 1288.5496s
	iters: 1500, epoch: 2 | loss: 1.5952668
	speed: 0.0304s/iter; left time: 1286.6808s
	iters: 1600, epoch: 2 | loss: 1.5833348
	speed: 0.0304s/iter; left time: 1283.1505s
	iters: 1700, epoch: 2 | loss: 1.6271995
	speed: 0.0304s/iter; left time: 1279.7275s
	iters: 1800, epoch: 2 | loss: 1.5907154
	speed: 0.0303s/iter; left time: 1275.5323s
	iters: 1900, epoch: 2 | loss: 1.7168031
	speed: 0.0304s/iter; left time: 1273.3132s
	iters: 2000, epoch: 2 | loss: 1.6947789
	speed: 0.0304s/iter; left time: 1270.9225s
	iters: 2100, epoch: 2 | loss: 1.7580246
	speed: 0.0304s/iter; left time: 1267.7605s
	iters: 2200, epoch: 2 | loss: 1.7447242
	speed: 0.0304s/iter; left time: 1264.3915s
	iters: 2300, epoch: 2 | loss: 1.6996613
	speed: 0.0304s/iter; left time: 1261.2755s
	iters: 2400, epoch: 2 | loss: 1.6044859
	speed: 0.0304s/iter; left time: 1260.8033s
	iters: 2500, epoch: 2 | loss: 1.7275257
	speed: 0.0304s/iter; left time: 1255.8621s
	iters: 2600, epoch: 2 | loss: 1.6435606
	speed: 0.0304s/iter; left time: 1251.6799s
	iters: 2700, epoch: 2 | loss: 1.7948587
	speed: 0.0304s/iter; left time: 1250.8041s
	iters: 2800, epoch: 2 | loss: 1.6072475
	speed: 0.0304s/iter; left time: 1247.1126s
	iters: 2900, epoch: 2 | loss: 1.5062995
	speed: 0.0304s/iter; left time: 1245.0604s
	iters: 3000, epoch: 2 | loss: 1.5388285
	speed: 0.0304s/iter; left time: 1241.4357s
	iters: 3100, epoch: 2 | loss: 1.7419053
	speed: 0.0304s/iter; left time: 1237.8561s
	iters: 3200, epoch: 2 | loss: 1.4422791
	speed: 0.0303s/iter; left time: 1229.5734s
	iters: 3300, epoch: 2 | loss: 1.4852743
	speed: 0.0303s/iter; left time: 1228.4053s
	iters: 3400, epoch: 2 | loss: 1.5041566
	speed: 0.0304s/iter; left time: 1229.3485s
	iters: 3500, epoch: 2 | loss: 1.7609634
	speed: 0.0304s/iter; left time: 1225.9056s
	iters: 3600, epoch: 2 | loss: 1.6460541
	speed: 0.0310s/iter; left time: 1247.8108s
	iters: 3700, epoch: 2 | loss: 1.7544235
	speed: 0.0304s/iter; left time: 1219.6284s
	iters: 3800, epoch: 2 | loss: 1.5200568
	speed: 0.0304s/iter; left time: 1215.9077s
	iters: 3900, epoch: 2 | loss: 1.4587904
	speed: 0.0304s/iter; left time: 1213.9622s
	iters: 4000, epoch: 2 | loss: 1.5969417
	speed: 0.0304s/iter; left time: 1210.4180s
	iters: 4100, epoch: 2 | loss: 1.5674914
	speed: 0.0304s/iter; left time: 1206.7430s
	iters: 4200, epoch: 2 | loss: 1.5693891
	speed: 0.0304s/iter; left time: 1206.5476s
	iters: 4300, epoch: 2 | loss: 1.7755377
	speed: 0.0305s/iter; left time: 1204.5820s
	iters: 4400, epoch: 2 | loss: 1.5430708
	speed: 0.0307s/iter; left time: 1208.7179s
	iters: 4500, epoch: 2 | loss: 1.5560344
	speed: 0.0311s/iter; left time: 1221.6913s
	iters: 4600, epoch: 2 | loss: 1.4975362
	speed: 0.0305s/iter; left time: 1197.4835s
	iters: 4700, epoch: 2 | loss: 1.5336372
	speed: 0.0312s/iter; left time: 1222.6158s
	iters: 4800, epoch: 2 | loss: 1.6616958
	speed: 0.0305s/iter; left time: 1191.2518s
Epoch: 2 cost time: 149.2448387145996
Epoch: 2, Steps: 4870 | Train Loss: 1.6103574 Vali Loss: 1.8868184 Test Loss: 1.8257835
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6910008
	speed: 0.8223s/iter; left time: 31955.6279s
	iters: 200, epoch: 3 | loss: 1.7257299
	speed: 0.0304s/iter; left time: 1177.0413s
	iters: 300, epoch: 3 | loss: 1.5312099
	speed: 0.0304s/iter; left time: 1175.3824s
	iters: 400, epoch: 3 | loss: 1.5974357
	speed: 0.0304s/iter; left time: 1172.5307s
	iters: 500, epoch: 3 | loss: 1.4750704
	speed: 0.0304s/iter; left time: 1170.1276s
	iters: 600, epoch: 3 | loss: 1.6151975
	speed: 0.0304s/iter; left time: 1166.4431s
	iters: 700, epoch: 3 | loss: 1.5824356
	speed: 0.0304s/iter; left time: 1163.0351s
	iters: 800, epoch: 3 | loss: 1.7563213
	speed: 0.0304s/iter; left time: 1158.4874s
	iters: 900, epoch: 3 | loss: 1.7509623
	speed: 0.0304s/iter; left time: 1157.2600s
	iters: 1000, epoch: 3 | loss: 1.5700991
	speed: 0.0307s/iter; left time: 1165.6817s
	iters: 1100, epoch: 3 | loss: 1.7385304
	speed: 0.0307s/iter; left time: 1162.2620s
	iters: 1200, epoch: 3 | loss: 1.3778327
	speed: 0.0304s/iter; left time: 1147.2130s
	iters: 1300, epoch: 3 | loss: 1.6338450
	speed: 0.0304s/iter; left time: 1144.3021s
	iters: 1400, epoch: 3 | loss: 1.6167504
	speed: 0.0304s/iter; left time: 1142.0791s
	iters: 1500, epoch: 3 | loss: 1.5709999
	speed: 0.0304s/iter; left time: 1138.9633s
	iters: 1600, epoch: 3 | loss: 1.5331093
	speed: 0.0304s/iter; left time: 1136.0217s
	iters: 1700, epoch: 3 | loss: 1.6706038
	speed: 0.0304s/iter; left time: 1132.2266s
	iters: 1800, epoch: 3 | loss: 1.5309227
	speed: 0.0304s/iter; left time: 1129.4102s
	iters: 1900, epoch: 3 | loss: 1.5760350
	speed: 0.0304s/iter; left time: 1127.5899s
	iters: 2000, epoch: 3 | loss: 1.5129638
	speed: 0.0304s/iter; left time: 1123.3295s
	iters: 2100, epoch: 3 | loss: 1.5224608
	speed: 0.0304s/iter; left time: 1121.2866s
	iters: 2200, epoch: 3 | loss: 1.6322129
	speed: 0.0304s/iter; left time: 1117.6133s
	iters: 2300, epoch: 3 | loss: 1.7696046
	speed: 0.0304s/iter; left time: 1115.7205s
	iters: 2400, epoch: 3 | loss: 1.4801059
	speed: 0.0305s/iter; left time: 1115.7552s
	iters: 2500, epoch: 3 | loss: 1.6925278
	speed: 0.0304s/iter; left time: 1109.0582s
	iters: 2600, epoch: 3 | loss: 1.8615119
	speed: 0.0304s/iter; left time: 1105.7681s
	iters: 2700, epoch: 3 | loss: 1.6241684
	speed: 0.0304s/iter; left time: 1103.3072s
	iters: 2800, epoch: 3 | loss: 1.6572893
	speed: 0.0304s/iter; left time: 1100.3802s
	iters: 2900, epoch: 3 | loss: 1.7596158
	speed: 0.0304s/iter; left time: 1096.7769s
	iters: 3000, epoch: 3 | loss: 1.6279534
	speed: 0.0304s/iter; left time: 1093.0968s
	iters: 3100, epoch: 3 | loss: 1.7449204
	speed: 0.0304s/iter; left time: 1091.4541s
	iters: 3200, epoch: 3 | loss: 1.4206288
	speed: 0.0304s/iter; left time: 1088.7905s
	iters: 3300, epoch: 3 | loss: 1.7967980
	speed: 0.0304s/iter; left time: 1084.4302s
	iters: 3400, epoch: 3 | loss: 1.5255114
	speed: 0.0305s/iter; left time: 1082.8370s
	iters: 3500, epoch: 3 | loss: 1.7236044
	speed: 0.0304s/iter; left time: 1079.1652s
	iters: 3600, epoch: 3 | loss: 1.4701731
	speed: 0.0311s/iter; left time: 1098.4561s
	iters: 3700, epoch: 3 | loss: 1.7376277
	speed: 0.0304s/iter; left time: 1072.4677s
	iters: 3800, epoch: 3 | loss: 1.5976685
	speed: 0.0304s/iter; left time: 1068.1381s
	iters: 3900, epoch: 3 | loss: 1.7531666
	speed: 0.0305s/iter; left time: 1067.7047s
	iters: 4000, epoch: 3 | loss: 1.5936713
	speed: 0.0305s/iter; left time: 1067.7656s
	iters: 4100, epoch: 3 | loss: 1.5584117
	speed: 0.0305s/iter; left time: 1062.0146s
	iters: 4200, epoch: 3 | loss: 1.8436168
	speed: 0.0304s/iter; left time: 1057.1705s
	iters: 4300, epoch: 3 | loss: 1.5850507
	speed: 0.0304s/iter; left time: 1054.3952s
	iters: 4400, epoch: 3 | loss: 1.4944181
	speed: 0.0306s/iter; left time: 1056.0732s
	iters: 4500, epoch: 3 | loss: 1.6807704
	speed: 0.0306s/iter; left time: 1055.0603s
	iters: 4600, epoch: 3 | loss: 1.4129796
	speed: 0.0305s/iter; left time: 1049.3736s
	iters: 4700, epoch: 3 | loss: 1.5814264
	speed: 0.0307s/iter; left time: 1052.1591s
	iters: 4800, epoch: 3 | loss: 1.6981498
	speed: 0.0305s/iter; left time: 1040.8491s
Epoch: 3 cost time: 148.49849390983582
Epoch: 3, Steps: 4870 | Train Loss: 1.6100581 Vali Loss: 1.8865772 Test Loss: 1.8257978
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.5903980
	speed: 0.7551s/iter; left time: 25666.5858s
	iters: 200, epoch: 4 | loss: 1.5409571
	speed: 0.0324s/iter; left time: 1097.9445s
	iters: 300, epoch: 4 | loss: 1.5607604
	speed: 0.0312s/iter; left time: 1055.2931s
	iters: 400, epoch: 4 | loss: 1.8080068
	speed: 0.0309s/iter; left time: 1040.0203s
	iters: 500, epoch: 4 | loss: 1.8948663
	speed: 0.0304s/iter; left time: 1020.7779s
	iters: 600, epoch: 4 | loss: 1.6282797
	speed: 0.0307s/iter; left time: 1026.9400s
	iters: 700, epoch: 4 | loss: 1.6699542
	speed: 0.0304s/iter; left time: 1014.9779s
	iters: 800, epoch: 4 | loss: 1.6872786
	speed: 0.0311s/iter; left time: 1035.8437s
	iters: 900, epoch: 4 | loss: 1.5716558
	speed: 0.0314s/iter; left time: 1041.1485s
	iters: 1000, epoch: 4 | loss: 1.5976834
	speed: 0.0308s/iter; left time: 1020.0148s
	iters: 1100, epoch: 4 | loss: 1.7981957
	speed: 0.0307s/iter; left time: 1013.1755s
	iters: 1200, epoch: 4 | loss: 1.6332654
	speed: 0.0304s/iter; left time: 999.5620s
	iters: 1300, epoch: 4 | loss: 1.5961715
	speed: 0.0317s/iter; left time: 1040.6111s
	iters: 1400, epoch: 4 | loss: 1.6599067
	speed: 0.0335s/iter; left time: 1096.7416s
	iters: 1500, epoch: 4 | loss: 1.5529580
	speed: 0.0304s/iter; left time: 990.7261s
	iters: 1600, epoch: 4 | loss: 1.6081781
	speed: 0.0304s/iter; left time: 988.3157s
	iters: 1700, epoch: 4 | loss: 1.6405374
	speed: 0.0304s/iter; left time: 984.4660s
	iters: 1800, epoch: 4 | loss: 1.5566043
	speed: 0.0304s/iter; left time: 983.0879s
	iters: 1900, epoch: 4 | loss: 1.7303742
	speed: 0.0304s/iter; left time: 979.4449s
	iters: 2000, epoch: 4 | loss: 1.5178541
	speed: 0.0304s/iter; left time: 975.2388s
	iters: 2100, epoch: 4 | loss: 1.6552480
	speed: 0.0304s/iter; left time: 972.2444s
	iters: 2200, epoch: 4 | loss: 1.6133324
	speed: 0.0304s/iter; left time: 970.0220s
	iters: 2300, epoch: 4 | loss: 1.7551682
	speed: 0.0304s/iter; left time: 966.4740s
	iters: 2400, epoch: 4 | loss: 1.6669595
	speed: 0.0304s/iter; left time: 963.5219s
	iters: 2500, epoch: 4 | loss: 1.7593074
	speed: 0.0304s/iter; left time: 960.5423s
	iters: 2600, epoch: 4 | loss: 1.4459915
	speed: 0.0304s/iter; left time: 958.1249s
	iters: 2700, epoch: 4 | loss: 1.4956788
	speed: 0.0304s/iter; left time: 955.0142s
	iters: 2800, epoch: 4 | loss: 1.5944533
	speed: 0.0304s/iter; left time: 952.0062s
	iters: 2900, epoch: 4 | loss: 1.2977554
	speed: 0.0304s/iter; left time: 949.0165s
	iters: 3000, epoch: 4 | loss: 1.4667569
	speed: 0.0305s/iter; left time: 946.9014s
	iters: 3100, epoch: 4 | loss: 1.6863166
	speed: 0.0304s/iter; left time: 942.1266s
	iters: 3200, epoch: 4 | loss: 1.7627707
	speed: 0.0304s/iter; left time: 939.5559s
	iters: 3300, epoch: 4 | loss: 1.6166308
	speed: 0.0304s/iter; left time: 937.4295s
	iters: 3400, epoch: 4 | loss: 1.6427402
	speed: 0.0304s/iter; left time: 934.0609s
	iters: 3500, epoch: 4 | loss: 1.5563334
	speed: 0.0305s/iter; left time: 931.6213s
	iters: 3600, epoch: 4 | loss: 1.7064750
	speed: 0.0337s/iter; left time: 1027.7893s
	iters: 3700, epoch: 4 | loss: 1.5352761
	speed: 0.0355s/iter; left time: 1078.7711s
	iters: 3800, epoch: 4 | loss: 1.5614144
	speed: 0.0344s/iter; left time: 1042.2685s
	iters: 3900, epoch: 4 | loss: 1.6214814
	speed: 0.0308s/iter; left time: 928.8414s
	iters: 4000, epoch: 4 | loss: 1.5584691
	speed: 0.0309s/iter; left time: 930.9041s
	iters: 4100, epoch: 4 | loss: 1.6521508
	speed: 0.0308s/iter; left time: 922.8862s
	iters: 4200, epoch: 4 | loss: 1.5612307
	speed: 0.0308s/iter; left time: 919.1528s
	iters: 4300, epoch: 4 | loss: 1.7912226
	speed: 0.0308s/iter; left time: 918.0073s
	iters: 4400, epoch: 4 | loss: 1.9015343
	speed: 0.0306s/iter; left time: 908.3956s
	iters: 4500, epoch: 4 | loss: 1.5781746
	speed: 0.0305s/iter; left time: 902.7590s
	iters: 4600, epoch: 4 | loss: 1.5075660
	speed: 0.0305s/iter; left time: 898.6869s
	iters: 4700, epoch: 4 | loss: 1.4591298
	speed: 0.0305s/iter; left time: 896.5513s
	iters: 4800, epoch: 4 | loss: 1.7170583
	speed: 0.0305s/iter; left time: 893.4836s
Epoch: 4 cost time: 150.91012406349182
Epoch: 4, Steps: 4870 | Train Loss: 1.6099070 Vali Loss: 1.8871002 Test Loss: 1.8259481
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 147091
test shape: (14709, 1, 720, 103) (14709, 1, 720, 103)
test shape: (14709, 720, 103) (14709, 720, 103)
mse:1.8254051208496094, mae:1.057895302772522
>>>>>>>Overall time: 1039 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
