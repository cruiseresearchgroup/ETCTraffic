Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 84, in train
    train_data, train_loader = self._get_data(flag='train')
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 31, in _get_data
    data_set, data_loader = data_provider(self.args, flag)
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_factory.py", line 104, in data_provider
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_loader.py", line 321, in __init__
    self.__read_data__()  
  File "/g/data/hn98/du/exlts/ddd2/data_provider/data_loader.py", line 325, in __read_data__
    df_raw = pd.read_csv(os.path.join(self.root_path,
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/util/_decorators.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/util/_decorators.py", line 331, in wrapper
    return func(*args, **kwargs)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 950, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 605, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1442, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1735, in _make_engine
    self.handles = get_handle(
  File "/jobfs/116407912.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/common.py", line 856, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: '../../data/pems/pems05_all_common_flow.csv'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 779944
val 21251
test 147715
Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 146, in train
    outputs = self.model(batch_x, batch_x_mark, dec_inp, batch_y_mark)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/g/data/hn98/du/exlts/ddd2/models/Autoformer.py", line 147, in forward
    dec_out = self.forecast(x_enc, x_mark_enc, x_dec, x_mark_dec)
  File "/g/data/hn98/du/exlts/ddd2/models/Autoformer.py", line 102, in forecast
    enc_out = self.enc_embedding(x_enc, x_mark_enc)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/g/data/hn98/du/exlts/ddd2/layers/Embed.py", line 161, in forward
    x = self.value_embedding(x) + self.temporal_embedding(x_mark)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/g/data/hn98/du/exlts/ddd2/layers/Embed.py", line 41, in forward
    x = self.tokenConv(x.permute(0, 2, 1)).transpose(1, 2)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/module.py", line 727, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/jobfs/116415750.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 255, in forward
    return F.conv1d(F.pad(input, self._reversed_padding_repeated_twice, mode=self.padding_mode),
RuntimeError: Given groups=1, weight of size [128, 103, 3], expected input[32, 104, 98] to have 103 channels, but got 104 channels instead
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 779944
val 21251
test 147715
	iters: 100, epoch: 1 | loss: 1.3128003
	speed: 0.1042s/iter; left time: 50776.8354s
	iters: 200, epoch: 1 | loss: 1.0653428
	speed: 0.1017s/iter; left time: 49540.1123s
	iters: 300, epoch: 1 | loss: 0.8436004
	speed: 0.1019s/iter; left time: 49633.3949s
	iters: 400, epoch: 1 | loss: 0.8093189
	speed: 0.1017s/iter; left time: 49521.0552s
	iters: 500, epoch: 1 | loss: 0.9158982
	speed: 0.1017s/iter; left time: 49516.2440s
	iters: 600, epoch: 1 | loss: 0.8770464
	speed: 0.1017s/iter; left time: 49523.2272s
	iters: 700, epoch: 1 | loss: 1.0505928
	speed: 0.1037s/iter; left time: 50456.9871s
	iters: 800, epoch: 1 | loss: 0.8319921
	speed: 0.1033s/iter; left time: 50253.2222s
	iters: 900, epoch: 1 | loss: 0.8628604
	speed: 0.1046s/iter; left time: 50872.2625s
	iters: 1000, epoch: 1 | loss: 0.7750639
	speed: 0.1048s/iter; left time: 50955.3772s
	iters: 1100, epoch: 1 | loss: 0.9548196
	speed: 0.1035s/iter; left time: 50353.5851s
	iters: 1200, epoch: 1 | loss: 0.8842047
	speed: 0.1028s/iter; left time: 49970.1049s
	iters: 1300, epoch: 1 | loss: 0.8500710
	speed: 0.1034s/iter; left time: 50264.9604s
	iters: 1400, epoch: 1 | loss: 0.7837784
	speed: 0.1030s/iter; left time: 50076.4476s
	iters: 1500, epoch: 1 | loss: 0.6921108
	speed: 0.1043s/iter; left time: 50699.8998s
	iters: 1600, epoch: 1 | loss: 0.7962171
	speed: 0.1029s/iter; left time: 50007.0851s
	iters: 1700, epoch: 1 | loss: 0.7100776
	speed: 0.1032s/iter; left time: 50112.0078s
	iters: 1800, epoch: 1 | loss: 0.6850775
	speed: 0.1040s/iter; left time: 50510.0948s
	iters: 1900, epoch: 1 | loss: 0.6996725
	speed: 0.1042s/iter; left time: 50574.7019s
	iters: 2000, epoch: 1 | loss: 0.7007502
	speed: 0.1031s/iter; left time: 50061.3006s
	iters: 2100, epoch: 1 | loss: 0.8186155
	speed: 0.1024s/iter; left time: 49711.6691s
	iters: 2200, epoch: 1 | loss: 0.7412464
	speed: 0.1031s/iter; left time: 50012.5229s
	iters: 2300, epoch: 1 | loss: 0.6763651
	speed: 0.1042s/iter; left time: 50535.1284s
	iters: 2400, epoch: 1 | loss: 0.8124171
	speed: 0.1046s/iter; left time: 50707.7688s
Epoch: 1 cost time: 251.79771304130554
Epoch: 1, Steps: 2437 | Train Loss: 0.8836160 Vali Loss: 1.2533413 Test Loss: 0.8732364
Validation loss decreased (inf --> 1.253341).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6872833
	speed: 2.3030s/iter; left time: 1116658.4463s
	iters: 200, epoch: 2 | loss: 0.7093209
	speed: 0.1031s/iter; left time: 49977.3305s
	iters: 300, epoch: 2 | loss: 0.9133967
	speed: 0.1037s/iter; left time: 50271.9996s
	iters: 400, epoch: 2 | loss: 0.7177144
	speed: 0.1031s/iter; left time: 49979.1504s
	iters: 500, epoch: 2 | loss: 0.9394318
	speed: 0.1032s/iter; left time: 49999.5259s
	iters: 600, epoch: 2 | loss: 0.6752014
	speed: 0.1030s/iter; left time: 49896.0858s
	iters: 700, epoch: 2 | loss: 0.7577026
	speed: 0.1028s/iter; left time: 49788.7054s
	iters: 800, epoch: 2 | loss: 0.7278036
	speed: 0.1031s/iter; left time: 49936.7645s
	iters: 900, epoch: 2 | loss: 0.6506651
	speed: 0.1033s/iter; left time: 50009.8283s
	iters: 1000, epoch: 2 | loss: 0.7887081
	speed: 0.1037s/iter; left time: 50187.0651s
	iters: 1100, epoch: 2 | loss: 0.7433510
	speed: 0.1027s/iter; left time: 49709.2337s
	iters: 1200, epoch: 2 | loss: 0.6244888
	speed: 0.1045s/iter; left time: 50555.9726s
	iters: 1300, epoch: 2 | loss: 0.7229373
	speed: 0.1043s/iter; left time: 50436.8439s
	iters: 1400, epoch: 2 | loss: 0.7188125
	speed: 0.1030s/iter; left time: 49797.6425s
	iters: 1500, epoch: 2 | loss: 0.7240341
	speed: 0.1029s/iter; left time: 49769.4413s
	iters: 1600, epoch: 2 | loss: 0.7598768
	speed: 0.1033s/iter; left time: 49919.6930s
	iters: 1700, epoch: 2 | loss: 0.6222934
	speed: 0.1029s/iter; left time: 49739.3620s
	iters: 1800, epoch: 2 | loss: 0.7269861
	speed: 0.1034s/iter; left time: 49965.3409s
	iters: 1900, epoch: 2 | loss: 0.7045684
	speed: 0.1026s/iter; left time: 49584.4528s
	iters: 2000, epoch: 2 | loss: 0.7526634
	speed: 0.1037s/iter; left time: 50075.6214s
	iters: 2100, epoch: 2 | loss: 0.6749376
	speed: 0.1031s/iter; left time: 49801.9500s
	iters: 2200, epoch: 2 | loss: 0.8269745
	speed: 0.1035s/iter; left time: 49963.1189s
	iters: 2300, epoch: 2 | loss: 0.8781192
	speed: 0.1032s/iter; left time: 49817.1835s
	iters: 2400, epoch: 2 | loss: 0.7410448
	speed: 0.1034s/iter; left time: 49917.4653s
Epoch: 2 cost time: 252.01334738731384
Epoch: 2, Steps: 2437 | Train Loss: 0.7530387 Vali Loss: 1.1920632 Test Loss: 1.1896855
Validation loss decreased (1.253341 --> 1.192063).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7464097
	speed: 2.3023s/iter; left time: 1110705.0383s
	iters: 200, epoch: 3 | loss: 0.8777452
	speed: 0.1035s/iter; left time: 49900.5530s
	iters: 300, epoch: 3 | loss: 0.6633283
	speed: 0.1038s/iter; left time: 50065.0266s
	iters: 400, epoch: 3 | loss: 0.6715655
	speed: 0.1027s/iter; left time: 49512.3427s
	iters: 500, epoch: 3 | loss: 0.6369404
	speed: 0.1036s/iter; left time: 49934.0720s
	iters: 600, epoch: 3 | loss: 0.7739270
	speed: 0.1034s/iter; left time: 49820.6001s
	iters: 700, epoch: 3 | loss: 0.6145457
	speed: 0.1040s/iter; left time: 50106.0142s
	iters: 800, epoch: 3 | loss: 0.5970159
	speed: 0.1033s/iter; left time: 49778.9972s
	iters: 900, epoch: 3 | loss: 0.7283731
	speed: 0.1028s/iter; left time: 49500.6407s
	iters: 1000, epoch: 3 | loss: 0.6774404
	speed: 0.1036s/iter; left time: 49908.4103s
	iters: 1100, epoch: 3 | loss: 0.6428936
	speed: 0.1028s/iter; left time: 49468.6988s
	iters: 1200, epoch: 3 | loss: 0.6392621
	speed: 0.1034s/iter; left time: 49746.4734s
	iters: 1300, epoch: 3 | loss: 0.7340927
	speed: 0.1037s/iter; left time: 49890.2274s
	iters: 1400, epoch: 3 | loss: 0.6631707
	speed: 0.1032s/iter; left time: 49664.9884s
	iters: 1500, epoch: 3 | loss: 0.7130269
	speed: 0.1025s/iter; left time: 49313.1762s
	iters: 1600, epoch: 3 | loss: 0.6695166
	speed: 0.1035s/iter; left time: 49775.3432s
	iters: 1700, epoch: 3 | loss: 0.6438913
	speed: 0.1030s/iter; left time: 49520.9885s
	iters: 1800, epoch: 3 | loss: 0.5689414
	speed: 0.1033s/iter; left time: 49657.7497s
	iters: 1900, epoch: 3 | loss: 0.7635598
	speed: 0.1030s/iter; left time: 49518.1815s
	iters: 2000, epoch: 3 | loss: 0.7825849
	speed: 0.1041s/iter; left time: 50001.4028s
	iters: 2100, epoch: 3 | loss: 0.6290639
	speed: 0.1028s/iter; left time: 49398.1837s
	iters: 2200, epoch: 3 | loss: 0.6421271
	speed: 0.1025s/iter; left time: 49237.1718s
	iters: 2300, epoch: 3 | loss: 0.6366732
	speed: 0.1019s/iter; left time: 48917.3768s
	iters: 2400, epoch: 3 | loss: 0.6503696
	speed: 0.1022s/iter; left time: 49048.6174s
Epoch: 3 cost time: 251.48786520957947
Epoch: 3, Steps: 2437 | Train Loss: 0.6956513 Vali Loss: 0.9606201 Test Loss: 1.1084067
Validation loss decreased (1.192063 --> 0.960620).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5772565
	speed: 2.3030s/iter; left time: 1105414.1992s
	iters: 200, epoch: 4 | loss: 0.7196244
	speed: 0.1034s/iter; left time: 49640.4937s
	iters: 300, epoch: 4 | loss: 0.6902321
	speed: 0.1037s/iter; left time: 49775.7474s
	iters: 400, epoch: 4 | loss: 0.6276264
	speed: 0.1035s/iter; left time: 49626.9282s
	iters: 500, epoch: 4 | loss: 0.6455673
	speed: 0.1039s/iter; left time: 49811.3181s
	iters: 600, epoch: 4 | loss: 0.6183107
	speed: 0.1037s/iter; left time: 49729.3772s
	iters: 700, epoch: 4 | loss: 0.7734614
	speed: 0.1036s/iter; left time: 49641.5066s
	iters: 800, epoch: 4 | loss: 0.6158904
	speed: 0.1032s/iter; left time: 49439.2997s
	iters: 900, epoch: 4 | loss: 0.6436695
	speed: 0.1039s/iter; left time: 49807.0820s
	iters: 1000, epoch: 4 | loss: 0.6941308
	speed: 0.1037s/iter; left time: 49684.8364s
	iters: 1100, epoch: 4 | loss: 0.5843974
	speed: 0.1034s/iter; left time: 49514.5913s
	iters: 1200, epoch: 4 | loss: 0.6138647
	speed: 0.1044s/iter; left time: 49990.8539s
	iters: 1300, epoch: 4 | loss: 0.6551709
	speed: 0.1033s/iter; left time: 49471.1776s
	iters: 1400, epoch: 4 | loss: 0.6211914
	speed: 0.1037s/iter; left time: 49635.1981s
	iters: 1500, epoch: 4 | loss: 0.6390163
	speed: 0.1039s/iter; left time: 49707.5642s
	iters: 1600, epoch: 4 | loss: 0.7062846
	speed: 0.1032s/iter; left time: 49360.0050s
	iters: 1700, epoch: 4 | loss: 0.7592539
	speed: 0.1031s/iter; left time: 49344.4631s
	iters: 1800, epoch: 4 | loss: 0.7599031
	speed: 0.1033s/iter; left time: 49402.4954s
	iters: 1900, epoch: 4 | loss: 0.5179619
	speed: 0.1034s/iter; left time: 49448.5292s
	iters: 2000, epoch: 4 | loss: 0.6966732
	speed: 0.1038s/iter; left time: 49628.6378s
	iters: 2100, epoch: 4 | loss: 0.6551404
	speed: 0.1037s/iter; left time: 49545.2168s
	iters: 2200, epoch: 4 | loss: 0.6869059
	speed: 0.1034s/iter; left time: 49430.6018s
	iters: 2300, epoch: 4 | loss: 0.6164240
	speed: 0.1035s/iter; left time: 49469.1422s
	iters: 2400, epoch: 4 | loss: 0.6702872
	speed: 0.1039s/iter; left time: 49645.6185s
Epoch: 4 cost time: 252.67650318145752
Epoch: 4, Steps: 2437 | Train Loss: 0.6519755 Vali Loss: 1.0573090 Test Loss: 1.0746678
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.5909213
	speed: 2.3039s/iter; left time: 1100246.4842s
	iters: 200, epoch: 5 | loss: 0.7566263
	speed: 0.1041s/iter; left time: 49710.8170s
	iters: 300, epoch: 5 | loss: 0.8586744
	speed: 0.1043s/iter; left time: 49788.8048s
	iters: 400, epoch: 5 | loss: 0.5865207
	speed: 0.1035s/iter; left time: 49400.1705s
	iters: 500, epoch: 5 | loss: 0.5655198
	speed: 0.1042s/iter; left time: 49699.1923s
	iters: 600, epoch: 5 | loss: 0.6160659
	speed: 0.1047s/iter; left time: 49957.3297s
	iters: 700, epoch: 5 | loss: 0.5372869
	speed: 0.1040s/iter; left time: 49615.6017s
	iters: 800, epoch: 5 | loss: 0.6603681
	speed: 0.1042s/iter; left time: 49677.5507s
	iters: 900, epoch: 5 | loss: 0.5759596
	speed: 0.1036s/iter; left time: 49383.5559s
	iters: 1000, epoch: 5 | loss: 0.6874260
	speed: 0.1039s/iter; left time: 49538.6094s
	iters: 1100, epoch: 5 | loss: 0.6060589
	speed: 0.1039s/iter; left time: 49507.4434s
	iters: 1200, epoch: 5 | loss: 0.6414845
	speed: 0.1035s/iter; left time: 49324.8364s
	iters: 1300, epoch: 5 | loss: 0.5906913
	speed: 0.1043s/iter; left time: 49675.4695s
	iters: 1400, epoch: 5 | loss: 0.6231990
	speed: 0.1032s/iter; left time: 49159.3344s
	iters: 1500, epoch: 5 | loss: 0.6833698
	speed: 0.1033s/iter; left time: 49186.1493s
	iters: 1600, epoch: 5 | loss: 0.5733959
	speed: 0.1050s/iter; left time: 49979.8582s
	iters: 1700, epoch: 5 | loss: 0.6168454
	speed: 0.1034s/iter; left time: 49197.5851s
	iters: 1800, epoch: 5 | loss: 0.6426399
	speed: 0.1045s/iter; left time: 49712.1237s
	iters: 1900, epoch: 5 | loss: 0.5506049
	speed: 0.1034s/iter; left time: 49208.7511s
	iters: 2000, epoch: 5 | loss: 0.5203100
	speed: 0.1030s/iter; left time: 49008.2885s
	iters: 2100, epoch: 5 | loss: 0.6271080
	speed: 0.1035s/iter; left time: 49196.8548s
	iters: 2200, epoch: 5 | loss: 0.6102779
	speed: 0.1046s/iter; left time: 49745.6898s
	iters: 2300, epoch: 5 | loss: 0.5428455
	speed: 0.1051s/iter; left time: 49976.0313s
	iters: 2400, epoch: 5 | loss: 0.6414702
	speed: 0.1045s/iter; left time: 49658.3594s
Epoch: 5 cost time: 253.6627161502838
Epoch: 5, Steps: 2437 | Train Loss: 0.6164192 Vali Loss: 1.1153129 Test Loss: 0.9941838
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.6724669
	speed: 2.3012s/iter; left time: 1093320.5895s
	iters: 200, epoch: 6 | loss: 0.5726904
	speed: 0.1045s/iter; left time: 49618.0744s
	iters: 300, epoch: 6 | loss: 0.5923539
	speed: 0.1051s/iter; left time: 49903.3847s
	iters: 400, epoch: 6 | loss: 0.6071537
	speed: 0.1046s/iter; left time: 49669.9627s
	iters: 500, epoch: 6 | loss: 0.5567669
	speed: 0.1036s/iter; left time: 49188.5541s
	iters: 600, epoch: 6 | loss: 0.6007325
	speed: 0.1034s/iter; left time: 49096.6026s
	iters: 700, epoch: 6 | loss: 0.4859293
	speed: 0.1040s/iter; left time: 49357.1686s
	iters: 800, epoch: 6 | loss: 0.4855334
	speed: 0.1046s/iter; left time: 49630.3384s
	iters: 900, epoch: 6 | loss: 0.4900414
	speed: 0.1034s/iter; left time: 49037.9525s
	iters: 1000, epoch: 6 | loss: 0.6480258
	speed: 0.1050s/iter; left time: 49781.9402s
	iters: 1100, epoch: 6 | loss: 0.5567086
	speed: 0.1033s/iter; left time: 48955.2014s
	iters: 1200, epoch: 6 | loss: 0.5123559
	speed: 0.1037s/iter; left time: 49170.7416s
	iters: 1300, epoch: 6 | loss: 0.6678280
	speed: 0.1055s/iter; left time: 49999.5615s
	iters: 1400, epoch: 6 | loss: 0.5768110
	speed: 0.1036s/iter; left time: 49101.2749s
	iters: 1500, epoch: 6 | loss: 0.6041661
	speed: 0.1055s/iter; left time: 49959.2933s
	iters: 1600, epoch: 6 | loss: 0.5657478
	speed: 0.1052s/iter; left time: 49846.0869s
	iters: 1700, epoch: 6 | loss: 0.4916039
	speed: 0.1041s/iter; left time: 49297.5284s
	iters: 1800, epoch: 6 | loss: 0.5789456
	speed: 0.1036s/iter; left time: 49065.7647s
	iters: 1900, epoch: 6 | loss: 0.6435900
	speed: 0.1041s/iter; left time: 49283.2968s
	iters: 2000, epoch: 6 | loss: 0.5571772
	speed: 0.1046s/iter; left time: 49496.5164s
	iters: 2100, epoch: 6 | loss: 0.5956085
	speed: 0.1056s/iter; left time: 49946.6719s
	iters: 2200, epoch: 6 | loss: 0.7051631
	speed: 0.1037s/iter; left time: 49044.7902s
	iters: 2300, epoch: 6 | loss: 0.5698835
	speed: 0.1034s/iter; left time: 48889.3246s
	iters: 2400, epoch: 6 | loss: 0.6083153
	speed: 0.1049s/iter; left time: 49617.4878s
Epoch: 6 cost time: 254.31069684028625
Epoch: 6, Steps: 2437 | Train Loss: 0.5885502 Vali Loss: 1.0280523 Test Loss: 1.0544578
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.5870415
	speed: 2.2933s/iter; left time: 1083978.0432s
	iters: 200, epoch: 7 | loss: 0.7337129
	speed: 0.0995s/iter; left time: 47032.8610s
	iters: 300, epoch: 7 | loss: 0.6307290
	speed: 0.0969s/iter; left time: 45761.8405s
	iters: 400, epoch: 7 | loss: 0.5912434
	speed: 0.0978s/iter; left time: 46183.3853s
	iters: 500, epoch: 7 | loss: 0.6500435
	speed: 0.0974s/iter; left time: 46013.5936s
	iters: 600, epoch: 7 | loss: 0.5835925
	speed: 0.0980s/iter; left time: 46286.0512s
	iters: 700, epoch: 7 | loss: 0.6237836
	speed: 0.0989s/iter; left time: 46665.9264s
	iters: 800, epoch: 7 | loss: 0.5748341
	speed: 0.0986s/iter; left time: 46526.7752s
	iters: 900, epoch: 7 | loss: 0.5426328
	speed: 0.0981s/iter; left time: 46310.4599s
	iters: 1000, epoch: 7 | loss: 0.6317922
	speed: 0.0967s/iter; left time: 45606.4139s
	iters: 1100, epoch: 7 | loss: 0.6103358
	speed: 0.0971s/iter; left time: 45795.3652s
	iters: 1200, epoch: 7 | loss: 0.5244161
	speed: 0.0971s/iter; left time: 45784.7388s
	iters: 1300, epoch: 7 | loss: 0.7421356
	speed: 0.0965s/iter; left time: 45496.8561s
	iters: 1400, epoch: 7 | loss: 0.5319355
	speed: 0.0964s/iter; left time: 45426.2720s
	iters: 1500, epoch: 7 | loss: 0.7148334
	speed: 0.0965s/iter; left time: 45461.0854s
	iters: 1600, epoch: 7 | loss: 0.6639042
	speed: 0.0961s/iter; left time: 45278.4040s
	iters: 1700, epoch: 7 | loss: 0.5640155
	speed: 0.0965s/iter; left time: 45475.8273s
	iters: 1800, epoch: 7 | loss: 0.5419694
	speed: 0.0964s/iter; left time: 45407.3898s
	iters: 1900, epoch: 7 | loss: 0.6489511
	speed: 0.0965s/iter; left time: 45449.5608s
	iters: 2000, epoch: 7 | loss: 0.5080268
	speed: 0.0967s/iter; left time: 45531.6872s
	iters: 2100, epoch: 7 | loss: 0.5577357
	speed: 0.0970s/iter; left time: 45632.8820s
	iters: 2200, epoch: 7 | loss: 0.5673175
	speed: 0.0968s/iter; left time: 45553.1190s
	iters: 2300, epoch: 7 | loss: 0.5598239
	speed: 0.0969s/iter; left time: 45587.4356s
	iters: 2400, epoch: 7 | loss: 0.5356088
	speed: 0.0965s/iter; left time: 45403.3393s
Epoch: 7 cost time: 236.8949556350708
Epoch: 7, Steps: 2437 | Train Loss: 0.5970547 Vali Loss: 0.9918911 Test Loss: 0.9766579
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.5780895
	speed: 1.8148s/iter; left time: 853418.6540s
	iters: 200, epoch: 8 | loss: 0.6046470
	speed: 0.0968s/iter; left time: 45491.8394s
	iters: 300, epoch: 8 | loss: 0.4934720
	speed: 0.0968s/iter; left time: 45513.4601s
	iters: 400, epoch: 8 | loss: 0.5498700
	speed: 0.0966s/iter; left time: 45373.3560s
	iters: 500, epoch: 8 | loss: 0.5837221
	speed: 0.0969s/iter; left time: 45505.9998s
	iters: 600, epoch: 8 | loss: 0.4796684
	speed: 0.0964s/iter; left time: 45292.7217s
	iters: 700, epoch: 8 | loss: 0.5570582
	speed: 0.0963s/iter; left time: 45240.2002s
	iters: 800, epoch: 8 | loss: 0.6131351
	speed: 0.0969s/iter; left time: 45499.8896s
	iters: 900, epoch: 8 | loss: 0.5542681
	speed: 0.0963s/iter; left time: 45190.6198s
	iters: 1000, epoch: 8 | loss: 0.5786514
	speed: 0.0972s/iter; left time: 45607.8835s
	iters: 1100, epoch: 8 | loss: 0.6107086
	speed: 0.0968s/iter; left time: 45400.4901s
	iters: 1200, epoch: 8 | loss: 0.5387771
	speed: 0.0967s/iter; left time: 45378.2214s
	iters: 1300, epoch: 8 | loss: 0.5592012
	speed: 0.0960s/iter; left time: 45037.9507s
	iters: 1400, epoch: 8 | loss: 0.5381694
	speed: 0.0964s/iter; left time: 45224.7075s
	iters: 1500, epoch: 8 | loss: 0.5433920
	speed: 0.0966s/iter; left time: 45309.6433s
	iters: 1600, epoch: 8 | loss: 0.5652195
	speed: 0.0965s/iter; left time: 45248.4693s
	iters: 1700, epoch: 8 | loss: 0.5935761
	speed: 0.0964s/iter; left time: 45167.2814s
	iters: 1800, epoch: 8 | loss: 0.5105017
	speed: 0.0964s/iter; left time: 45188.2752s
	iters: 1900, epoch: 8 | loss: 0.5957306
	speed: 0.0968s/iter; left time: 45347.5827s
	iters: 2000, epoch: 8 | loss: 0.5518594
	speed: 0.0968s/iter; left time: 45314.6777s
	iters: 2100, epoch: 8 | loss: 0.5133448
	speed: 0.0972s/iter; left time: 45531.7839s
	iters: 2200, epoch: 8 | loss: 0.6274776
	speed: 0.0971s/iter; left time: 45442.7047s
	iters: 2300, epoch: 8 | loss: 0.6111122
	speed: 0.0967s/iter; left time: 45254.0733s
	iters: 2400, epoch: 8 | loss: 0.5533997
	speed: 0.0961s/iter; left time: 44958.4797s
Epoch: 8 cost time: 235.64344549179077
Epoch: 8, Steps: 2437 | Train Loss: 0.5623003 Vali Loss: 0.9616152 Test Loss: 1.0295290
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 147715
test shape: (14771, 1, 96, 103) (14771, 1, 96, 103)
test shape: (14771, 96, 103) (14771, 96, 103)
mse:1.1084071397781372, mae:0.8139874339103699
>>>>>>>Overall time: 3941 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 779944
val 21251
test 147715
	iters: 100, epoch: 1 | loss: 1.3128120
	speed: 0.1321s/iter; left time: 64351.1918s
	iters: 200, epoch: 1 | loss: 1.3127545
	speed: 0.1051s/iter; left time: 51213.4080s
	iters: 300, epoch: 1 | loss: 1.0116968
	speed: 0.1071s/iter; left time: 52172.0129s
	iters: 400, epoch: 1 | loss: 0.9836150
	speed: 0.1040s/iter; left time: 50653.5349s
	iters: 500, epoch: 1 | loss: 0.9585431
	speed: 0.1036s/iter; left time: 50458.9537s
	iters: 600, epoch: 1 | loss: 0.9153394
	speed: 0.1031s/iter; left time: 50212.5090s
	iters: 700, epoch: 1 | loss: 0.9670805
	speed: 0.1042s/iter; left time: 50724.1554s
	iters: 800, epoch: 1 | loss: 0.9970309
	speed: 0.1046s/iter; left time: 50876.5113s
	iters: 900, epoch: 1 | loss: 0.7977967
	speed: 0.1036s/iter; left time: 50377.6008s
	iters: 1000, epoch: 1 | loss: 0.7395697
	speed: 0.1037s/iter; left time: 50420.1963s
	iters: 1100, epoch: 1 | loss: 0.9687176
	speed: 0.1042s/iter; left time: 50684.1960s
	iters: 1200, epoch: 1 | loss: 0.7752340
	speed: 0.1040s/iter; left time: 50574.2487s
	iters: 1300, epoch: 1 | loss: 0.8120118
	speed: 0.1038s/iter; left time: 50465.4747s
	iters: 1400, epoch: 1 | loss: 0.7979267
	speed: 0.1044s/iter; left time: 50750.8728s
	iters: 1500, epoch: 1 | loss: 0.7388805
	speed: 0.1042s/iter; left time: 50633.3151s
	iters: 1600, epoch: 1 | loss: 0.7970529
	speed: 0.1029s/iter; left time: 49967.4350s
	iters: 1700, epoch: 1 | loss: 0.7866687
	speed: 0.1033s/iter; left time: 50196.9959s
	iters: 1800, epoch: 1 | loss: 0.6835718
	speed: 0.1035s/iter; left time: 50237.6812s
	iters: 1900, epoch: 1 | loss: 0.7563431
	speed: 0.1035s/iter; left time: 50238.0764s
	iters: 2000, epoch: 1 | loss: 0.6946114
	speed: 0.1039s/iter; left time: 50453.8926s
	iters: 2100, epoch: 1 | loss: 0.7819070
	speed: 0.1035s/iter; left time: 50233.4941s
	iters: 2200, epoch: 1 | loss: 0.7174114
	speed: 0.1033s/iter; left time: 50128.3229s
	iters: 2300, epoch: 1 | loss: 0.8273414
	speed: 0.1031s/iter; left time: 50017.8220s
	iters: 2400, epoch: 1 | loss: 0.6965647
	speed: 0.1033s/iter; left time: 50115.4630s
Epoch: 1 cost time: 256.15536284446716
Epoch: 1, Steps: 2437 | Train Loss: 0.8861344 Vali Loss: 1.2339168 Test Loss: 1.0655346
Validation loss decreased (inf --> 1.233917).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7067922
	speed: 2.2824s/iter; left time: 1106636.5171s
	iters: 200, epoch: 2 | loss: 0.7245745
	speed: 0.1020s/iter; left time: 49428.8760s
	iters: 300, epoch: 2 | loss: 0.7618861
	speed: 0.1029s/iter; left time: 49853.4878s
	iters: 400, epoch: 2 | loss: 0.7078027
	speed: 0.1020s/iter; left time: 49405.8710s
	iters: 500, epoch: 2 | loss: 0.6153921
	speed: 0.1024s/iter; left time: 49595.4297s
	iters: 600, epoch: 2 | loss: 0.7882169
	speed: 0.1016s/iter; left time: 49232.8092s
	iters: 700, epoch: 2 | loss: 0.7463654
	speed: 0.1036s/iter; left time: 50151.5007s
	iters: 800, epoch: 2 | loss: 0.7160906
	speed: 0.1035s/iter; left time: 50090.9850s
	iters: 900, epoch: 2 | loss: 0.6723963
	speed: 0.1022s/iter; left time: 49475.8869s
	iters: 1000, epoch: 2 | loss: 0.6813498
	speed: 0.1043s/iter; left time: 50498.6535s
	iters: 1100, epoch: 2 | loss: 0.7777300
	speed: 0.1041s/iter; left time: 50366.8696s
	iters: 1200, epoch: 2 | loss: 0.7059464
	speed: 0.1041s/iter; left time: 50366.2329s
	iters: 1300, epoch: 2 | loss: 0.8121030
	speed: 0.1045s/iter; left time: 50562.1215s
	iters: 1400, epoch: 2 | loss: 0.8642787
	speed: 0.1027s/iter; left time: 49683.5129s
	iters: 1500, epoch: 2 | loss: 0.7394587
	speed: 0.1030s/iter; left time: 49774.2387s
	iters: 1600, epoch: 2 | loss: 0.7818534
	speed: 0.1021s/iter; left time: 49366.3286s
	iters: 1700, epoch: 2 | loss: 0.7527171
	speed: 0.1023s/iter; left time: 49429.4721s
	iters: 1800, epoch: 2 | loss: 0.7725589
	speed: 0.1025s/iter; left time: 49526.7936s
	iters: 1900, epoch: 2 | loss: 0.6244625
	speed: 0.1039s/iter; left time: 50199.3438s
	iters: 2000, epoch: 2 | loss: 0.8411050
	speed: 0.1038s/iter; left time: 50137.4280s
	iters: 2100, epoch: 2 | loss: 0.6890796
	speed: 0.1028s/iter; left time: 49659.0400s
	iters: 2200, epoch: 2 | loss: 0.9511812
	speed: 0.1025s/iter; left time: 49479.8639s
	iters: 2300, epoch: 2 | loss: 0.6133788
	speed: 0.1029s/iter; left time: 49664.9125s
	iters: 2400, epoch: 2 | loss: 0.6444679
	speed: 0.1041s/iter; left time: 50226.8177s
Epoch: 2 cost time: 251.43125987052917
Epoch: 2, Steps: 2437 | Train Loss: 0.7211908 Vali Loss: 1.1581752 Test Loss: 1.0817766
Validation loss decreased (1.233917 --> 1.158175).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6178177
	speed: 2.2874s/iter; left time: 1103514.6744s
	iters: 200, epoch: 3 | loss: 0.6509669
	speed: 0.1026s/iter; left time: 49491.7709s
	iters: 300, epoch: 3 | loss: 0.5975049
	speed: 0.1026s/iter; left time: 49473.3917s
	iters: 400, epoch: 3 | loss: 0.5870173
	speed: 0.1030s/iter; left time: 49651.6678s
	iters: 500, epoch: 3 | loss: 0.5486442
	speed: 0.1038s/iter; left time: 50028.3260s
	iters: 600, epoch: 3 | loss: 0.7018874
	speed: 0.1029s/iter; left time: 49577.3251s
	iters: 700, epoch: 3 | loss: 0.6215364
	speed: 0.1031s/iter; left time: 49696.3967s
	iters: 800, epoch: 3 | loss: 0.5503647
	speed: 0.1029s/iter; left time: 49575.2096s
	iters: 900, epoch: 3 | loss: 0.6734561
	speed: 0.1029s/iter; left time: 49545.5135s
	iters: 1000, epoch: 3 | loss: 0.5696943
	speed: 0.1034s/iter; left time: 49766.0326s
	iters: 1100, epoch: 3 | loss: 0.5286790
	speed: 0.1037s/iter; left time: 49901.9712s
	iters: 1200, epoch: 3 | loss: 0.5466018
	speed: 0.1031s/iter; left time: 49629.1719s
	iters: 1300, epoch: 3 | loss: 0.6460706
	speed: 0.1028s/iter; left time: 49468.0829s
	iters: 1400, epoch: 3 | loss: 0.5513300
	speed: 0.1035s/iter; left time: 49789.5275s
	iters: 1500, epoch: 3 | loss: 0.6588056
	speed: 0.1034s/iter; left time: 49726.2159s
	iters: 1600, epoch: 3 | loss: 0.5624089
	speed: 0.1034s/iter; left time: 49735.8181s
	iters: 1700, epoch: 3 | loss: 0.5464216
	speed: 0.1033s/iter; left time: 49691.4897s
	iters: 1800, epoch: 3 | loss: 0.5427890
	speed: 0.1028s/iter; left time: 49424.7584s
	iters: 1900, epoch: 3 | loss: 0.6076991
	speed: 0.1035s/iter; left time: 49722.7460s
	iters: 2000, epoch: 3 | loss: 0.5079904
	speed: 0.1034s/iter; left time: 49700.4364s
	iters: 2100, epoch: 3 | loss: 0.5044048
	speed: 0.1028s/iter; left time: 49394.1644s
	iters: 2200, epoch: 3 | loss: 0.4963706
	speed: 0.1038s/iter; left time: 49864.5234s
	iters: 2300, epoch: 3 | loss: 0.5705045
	speed: 0.1037s/iter; left time: 49799.2016s
	iters: 2400, epoch: 3 | loss: 0.5201877
	speed: 0.1028s/iter; left time: 49345.7159s
Epoch: 3 cost time: 251.68590688705444
Epoch: 3, Steps: 2437 | Train Loss: 0.5914632 Vali Loss: 1.1188364 Test Loss: 1.0648253
Validation loss decreased (1.158175 --> 1.118836).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5341741
	speed: 2.2840s/iter; left time: 1096297.0277s
	iters: 200, epoch: 4 | loss: 0.5806329
	speed: 0.1014s/iter; left time: 48656.9278s
	iters: 300, epoch: 4 | loss: 0.4813008
	speed: 0.1018s/iter; left time: 48855.1172s
	iters: 400, epoch: 4 | loss: 0.4801554
	speed: 0.1018s/iter; left time: 48846.6353s
	iters: 500, epoch: 4 | loss: 0.5229986
	speed: 0.1019s/iter; left time: 48853.2642s
	iters: 600, epoch: 4 | loss: 0.4634405
	speed: 0.1019s/iter; left time: 48845.7631s
	iters: 700, epoch: 4 | loss: 0.7280133
	speed: 0.1022s/iter; left time: 49008.4445s
	iters: 800, epoch: 4 | loss: 0.4893784
	speed: 0.1021s/iter; left time: 48955.9067s
	iters: 900, epoch: 4 | loss: 0.4510487
	speed: 0.1023s/iter; left time: 49018.9435s
	iters: 1000, epoch: 4 | loss: 0.4789219
	speed: 0.1017s/iter; left time: 48709.3467s
	iters: 1100, epoch: 4 | loss: 0.5496005
	speed: 0.1022s/iter; left time: 48938.2827s
	iters: 1200, epoch: 4 | loss: 0.5048134
	speed: 0.1021s/iter; left time: 48895.2618s
	iters: 1300, epoch: 4 | loss: 0.5679169
	speed: 0.1016s/iter; left time: 48626.0147s
	iters: 1400, epoch: 4 | loss: 0.5346621
	speed: 0.1019s/iter; left time: 48762.8426s
	iters: 1500, epoch: 4 | loss: 0.4665771
	speed: 0.1017s/iter; left time: 48659.6399s
	iters: 1600, epoch: 4 | loss: 0.4961530
	speed: 0.1015s/iter; left time: 48552.1685s
	iters: 1700, epoch: 4 | loss: 0.4672742
	speed: 0.1021s/iter; left time: 48831.6683s
	iters: 1800, epoch: 4 | loss: 0.5026307
	speed: 0.1015s/iter; left time: 48530.3465s
	iters: 1900, epoch: 4 | loss: 0.4222479
	speed: 0.1017s/iter; left time: 48615.6611s
	iters: 2000, epoch: 4 | loss: 0.4929461
	speed: 0.1018s/iter; left time: 48692.7424s
	iters: 2100, epoch: 4 | loss: 0.5410031
	speed: 0.1013s/iter; left time: 48441.5377s
	iters: 2200, epoch: 4 | loss: 0.6122518
	speed: 0.1015s/iter; left time: 48501.0147s
	iters: 2300, epoch: 4 | loss: 0.4707774
	speed: 0.1012s/iter; left time: 48345.9922s
	iters: 2400, epoch: 4 | loss: 0.5633835
	speed: 0.1017s/iter; left time: 48566.2301s
Epoch: 4 cost time: 248.17278409004211
Epoch: 4, Steps: 2437 | Train Loss: 0.5178576 Vali Loss: 1.1247536 Test Loss: 1.0199341
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.5013821
	speed: 2.2817s/iter; left time: 1089614.3061s
	iters: 200, epoch: 5 | loss: 0.5115730
	speed: 0.1017s/iter; left time: 48548.5502s
	iters: 300, epoch: 5 | loss: 0.5891992
	speed: 0.1017s/iter; left time: 48558.4125s
	iters: 400, epoch: 5 | loss: 0.4972873
	speed: 0.1025s/iter; left time: 48898.7157s
	iters: 500, epoch: 5 | loss: 0.4533592
	speed: 0.1025s/iter; left time: 48913.0299s
	iters: 600, epoch: 5 | loss: 0.4437236
	speed: 0.1023s/iter; left time: 48820.7201s
	iters: 700, epoch: 5 | loss: 0.3936111
	speed: 0.1018s/iter; left time: 48543.1186s
	iters: 800, epoch: 5 | loss: 0.5157211
	speed: 0.1016s/iter; left time: 48427.0460s
	iters: 900, epoch: 5 | loss: 0.4910029
	speed: 0.1013s/iter; left time: 48310.6336s
	iters: 1000, epoch: 5 | loss: 0.5277901
	speed: 0.1016s/iter; left time: 48420.3289s
	iters: 1100, epoch: 5 | loss: 0.4552218
	speed: 0.1017s/iter; left time: 48448.5885s
	iters: 1200, epoch: 5 | loss: 0.4959764
	speed: 0.1018s/iter; left time: 48522.4814s
	iters: 1300, epoch: 5 | loss: 0.4324103
	speed: 0.1020s/iter; left time: 48578.0097s
	iters: 1400, epoch: 5 | loss: 0.4120772
	speed: 0.1020s/iter; left time: 48570.5119s
	iters: 1500, epoch: 5 | loss: 0.4708591
	speed: 0.1021s/iter; left time: 48633.6237s
	iters: 1600, epoch: 5 | loss: 0.4119472
	speed: 0.1021s/iter; left time: 48589.4030s
	iters: 1700, epoch: 5 | loss: 0.4387843
	speed: 0.1020s/iter; left time: 48543.1404s
	iters: 1800, epoch: 5 | loss: 0.4705507
	speed: 0.1015s/iter; left time: 48302.8500s
	iters: 1900, epoch: 5 | loss: 0.3883241
	speed: 0.1015s/iter; left time: 48284.1195s
	iters: 2000, epoch: 5 | loss: 0.4188584
	speed: 0.1026s/iter; left time: 48819.6877s
	iters: 2100, epoch: 5 | loss: 0.5050187
	speed: 0.1017s/iter; left time: 48380.9585s
	iters: 2200, epoch: 5 | loss: 0.4295608
	speed: 0.1027s/iter; left time: 48826.9146s
	iters: 2300, epoch: 5 | loss: 0.4300362
	speed: 0.1018s/iter; left time: 48397.2246s
	iters: 2400, epoch: 5 | loss: 0.4923731
	speed: 0.1029s/iter; left time: 48908.8353s
Epoch: 5 cost time: 248.64540123939514
Epoch: 5, Steps: 2437 | Train Loss: 0.4728529 Vali Loss: 1.2369509 Test Loss: 1.0845044
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.5277946
	speed: 2.2842s/iter; left time: 1085243.0214s
	iters: 200, epoch: 6 | loss: 0.4238372
	speed: 0.1033s/iter; left time: 49048.2924s
	iters: 300, epoch: 6 | loss: 0.4211276
	speed: 0.1037s/iter; left time: 49245.8832s
	iters: 400, epoch: 6 | loss: 0.4724451
	speed: 0.1033s/iter; left time: 49066.0222s
	iters: 500, epoch: 6 | loss: 0.4413998
	speed: 0.1028s/iter; left time: 48785.1064s
	iters: 600, epoch: 6 | loss: 0.3928946
	speed: 0.1029s/iter; left time: 48838.9854s
	iters: 700, epoch: 6 | loss: 0.4071983
	speed: 0.1032s/iter; left time: 48982.3474s
	iters: 800, epoch: 6 | loss: 0.3596015
	speed: 0.1032s/iter; left time: 48982.8041s
	iters: 900, epoch: 6 | loss: 0.4164209
	speed: 0.1029s/iter; left time: 48806.2975s
	iters: 1000, epoch: 6 | loss: 0.4448235
	speed: 0.1034s/iter; left time: 49028.9706s
	iters: 1100, epoch: 6 | loss: 0.4043922
	speed: 0.1030s/iter; left time: 48835.7982s
	iters: 1200, epoch: 6 | loss: 0.4553835
	speed: 0.1036s/iter; left time: 49100.1958s
	iters: 1300, epoch: 6 | loss: 0.5037382
	speed: 0.1020s/iter; left time: 48349.4816s
	iters: 1400, epoch: 6 | loss: 0.4237795
	speed: 0.1038s/iter; left time: 49188.0863s
	iters: 1500, epoch: 6 | loss: 0.4261314
	speed: 0.1024s/iter; left time: 48517.7504s
	iters: 1600, epoch: 6 | loss: 0.4528968
	speed: 0.1031s/iter; left time: 48831.0526s
	iters: 1700, epoch: 6 | loss: 0.3828809
	speed: 0.1032s/iter; left time: 48880.3904s
	iters: 1800, epoch: 6 | loss: 0.4259782
	speed: 0.1032s/iter; left time: 48872.2177s
	iters: 1900, epoch: 6 | loss: 0.5417680
	speed: 0.1036s/iter; left time: 49039.6741s
	iters: 2000, epoch: 6 | loss: 0.4217662
	speed: 0.1035s/iter; left time: 48993.4105s
	iters: 2100, epoch: 6 | loss: 0.4244279
	speed: 0.1033s/iter; left time: 48877.1451s
	iters: 2200, epoch: 6 | loss: 0.4097841
	speed: 0.1038s/iter; left time: 49086.6515s
	iters: 2300, epoch: 6 | loss: 0.4272949
	speed: 0.1036s/iter; left time: 49000.3447s
	iters: 2400, epoch: 6 | loss: 0.3886144
	speed: 0.1040s/iter; left time: 49150.4947s
Epoch: 6 cost time: 251.77592587471008
Epoch: 6, Steps: 2437 | Train Loss: 0.4390872 Vali Loss: 1.2945890 Test Loss: 1.0721266
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.4123991
	speed: 2.2842s/iter; left time: 1079682.7179s
	iters: 200, epoch: 7 | loss: 0.4673887
	speed: 0.1018s/iter; left time: 48125.2258s
	iters: 300, epoch: 7 | loss: 0.4545529
	speed: 0.1015s/iter; left time: 47961.0190s
	iters: 400, epoch: 7 | loss: 0.3999660
	speed: 0.1015s/iter; left time: 47969.7539s
	iters: 500, epoch: 7 | loss: 0.4689472
	speed: 0.1021s/iter; left time: 48227.5546s
	iters: 600, epoch: 7 | loss: 0.3951550
	speed: 0.1026s/iter; left time: 48427.4462s
	iters: 700, epoch: 7 | loss: 0.4523365
	speed: 0.1021s/iter; left time: 48182.1727s
	iters: 800, epoch: 7 | loss: 0.4417051
	speed: 0.1020s/iter; left time: 48161.4269s
	iters: 900, epoch: 7 | loss: 0.4419428
	speed: 0.1023s/iter; left time: 48283.9919s
	iters: 1000, epoch: 7 | loss: 0.4613204
	speed: 0.1022s/iter; left time: 48231.6636s
	iters: 1100, epoch: 7 | loss: 0.3932115
	speed: 0.1019s/iter; left time: 48075.0797s
	iters: 1200, epoch: 7 | loss: 0.4099394
	speed: 0.1025s/iter; left time: 48325.7312s
	iters: 1300, epoch: 7 | loss: 0.4364686
	speed: 0.1034s/iter; left time: 48751.9556s
	iters: 1400, epoch: 7 | loss: 0.3987322
	speed: 0.1022s/iter; left time: 48187.1176s
	iters: 1500, epoch: 7 | loss: 0.4061482
	speed: 0.1020s/iter; left time: 48075.8347s
	iters: 1600, epoch: 7 | loss: 0.4275988
	speed: 0.1024s/iter; left time: 48270.7333s
	iters: 1700, epoch: 7 | loss: 0.4051190
	speed: 0.1020s/iter; left time: 48057.0329s
	iters: 1800, epoch: 7 | loss: 0.3603257
	speed: 0.1020s/iter; left time: 48058.4007s
	iters: 1900, epoch: 7 | loss: 0.4219680
	speed: 0.1017s/iter; left time: 47876.7874s
	iters: 2000, epoch: 7 | loss: 0.3830779
	speed: 0.1021s/iter; left time: 48083.7754s
	iters: 2100, epoch: 7 | loss: 0.3639456
	speed: 0.1027s/iter; left time: 48317.5508s
	iters: 2200, epoch: 7 | loss: 0.4408907
	speed: 0.1017s/iter; left time: 47867.4347s
	iters: 2300, epoch: 7 | loss: 0.4234752
	speed: 0.1018s/iter; left time: 47892.9173s
	iters: 2400, epoch: 7 | loss: 0.3687105
	speed: 0.1021s/iter; left time: 48019.5964s
Epoch: 7 cost time: 248.9821696281433
Epoch: 7, Steps: 2437 | Train Loss: 0.4145944 Vali Loss: 1.1598921 Test Loss: 1.0214766
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.4385465
	speed: 2.2818s/iter; left time: 1073017.1915s
	iters: 200, epoch: 8 | loss: 0.4118017
	speed: 0.1011s/iter; left time: 47552.4994s
	iters: 300, epoch: 8 | loss: 0.3661478
	speed: 0.1015s/iter; left time: 47715.1458s
	iters: 400, epoch: 8 | loss: 0.3907852
	speed: 0.1021s/iter; left time: 47986.5584s
	iters: 500, epoch: 8 | loss: 0.4032666
	speed: 0.1013s/iter; left time: 47573.5580s
	iters: 600, epoch: 8 | loss: 0.3693741
	speed: 0.1018s/iter; left time: 47798.8813s
	iters: 700, epoch: 8 | loss: 0.4078021
	speed: 0.1016s/iter; left time: 47714.1832s
	iters: 800, epoch: 8 | loss: 0.4254197
	speed: 0.1013s/iter; left time: 47581.1946s
	iters: 900, epoch: 8 | loss: 0.3608442
	speed: 0.1015s/iter; left time: 47652.4554s
	iters: 1000, epoch: 8 | loss: 0.4306335
	speed: 0.1013s/iter; left time: 47557.3009s
	iters: 1100, epoch: 8 | loss: 0.4112630
	speed: 0.1016s/iter; left time: 47664.6077s
	iters: 1200, epoch: 8 | loss: 0.3647121
	speed: 0.1017s/iter; left time: 47697.4817s
	iters: 1300, epoch: 8 | loss: 0.4209769
	speed: 0.1014s/iter; left time: 47553.1051s
	iters: 1400, epoch: 8 | loss: 0.4067714
	speed: 0.1017s/iter; left time: 47694.0962s
	iters: 1500, epoch: 8 | loss: 0.3821186
	speed: 0.1015s/iter; left time: 47603.6649s
	iters: 1600, epoch: 8 | loss: 0.3533697
	speed: 0.1017s/iter; left time: 47667.1536s
	iters: 1700, epoch: 8 | loss: 0.4331947
	speed: 0.1015s/iter; left time: 47581.4988s
	iters: 1800, epoch: 8 | loss: 0.3800364
	speed: 0.1017s/iter; left time: 47645.8635s
	iters: 1900, epoch: 8 | loss: 0.4197139
	speed: 0.1016s/iter; left time: 47601.0643s
	iters: 2000, epoch: 8 | loss: 0.4095857
	speed: 0.1015s/iter; left time: 47552.8820s
	iters: 2100, epoch: 8 | loss: 0.3577054
	speed: 0.1020s/iter; left time: 47762.5430s
	iters: 2200, epoch: 8 | loss: 0.3831193
	speed: 0.1014s/iter; left time: 47477.0696s
	iters: 2300, epoch: 8 | loss: 0.4498308
	speed: 0.1017s/iter; left time: 47585.4822s
	iters: 2400, epoch: 8 | loss: 0.4923670
	speed: 0.1015s/iter; left time: 47482.1219s
Epoch: 8 cost time: 247.68572425842285
Epoch: 8, Steps: 2437 | Train Loss: 0.3931055 Vali Loss: 1.1501709 Test Loss: 1.0362579
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 147715
test shape: (14771, 1, 96, 103) (14771, 1, 96, 103)
test shape: (14771, 96, 103) (14771, 96, 103)
mse:1.0648279190063477, mae:0.7963545918464661
>>>>>>>Overall time: 4116 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
