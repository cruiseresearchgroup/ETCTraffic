Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 896871
val 193647
test 193645
	iters: 100, epoch: 1 | loss: 1.5445478
	speed: 0.0322s/iter; left time: 1802.9747s
	iters: 200, epoch: 1 | loss: 1.5763440
	speed: 0.0303s/iter; left time: 1692.3082s
	iters: 300, epoch: 1 | loss: 1.7668570
	speed: 0.0303s/iter; left time: 1690.8288s
	iters: 400, epoch: 1 | loss: 1.3281159
	speed: 0.0298s/iter; left time: 1658.2034s
	iters: 500, epoch: 1 | loss: 1.5534292
	speed: 0.0303s/iter; left time: 1684.7662s
	iters: 600, epoch: 1 | loss: 1.6567246
	speed: 0.0302s/iter; left time: 1675.0816s
	iters: 700, epoch: 1 | loss: 1.8691168
	speed: 0.0297s/iter; left time: 1644.1832s
	iters: 800, epoch: 1 | loss: 1.7787070
	speed: 0.0299s/iter; left time: 1651.6050s
	iters: 900, epoch: 1 | loss: 1.4684440
	speed: 0.0299s/iter; left time: 1647.1326s
	iters: 1000, epoch: 1 | loss: 1.6560724
	speed: 0.0298s/iter; left time: 1642.9967s
	iters: 1100, epoch: 1 | loss: 1.5030944
	speed: 0.0303s/iter; left time: 1665.2083s
	iters: 1200, epoch: 1 | loss: 1.7133560
	speed: 0.0302s/iter; left time: 1654.2090s
	iters: 1300, epoch: 1 | loss: 1.5150557
	speed: 0.0298s/iter; left time: 1633.2957s
	iters: 1400, epoch: 1 | loss: 1.6304722
	speed: 0.0303s/iter; left time: 1654.3495s
	iters: 1500, epoch: 1 | loss: 1.3540304
	speed: 0.0297s/iter; left time: 1622.3612s
	iters: 1600, epoch: 1 | loss: 1.7909076
	speed: 0.0304s/iter; left time: 1653.5618s
	iters: 1700, epoch: 1 | loss: 1.5624892
	speed: 0.0300s/iter; left time: 1632.2029s
	iters: 1800, epoch: 1 | loss: 1.5977877
	speed: 0.0299s/iter; left time: 1623.0212s
	iters: 1900, epoch: 1 | loss: 1.5742191
	speed: 0.0303s/iter; left time: 1640.7941s
	iters: 2000, epoch: 1 | loss: 1.4034439
	speed: 0.0303s/iter; left time: 1636.0143s
	iters: 2100, epoch: 1 | loss: 1.6839162
	speed: 0.0300s/iter; left time: 1620.2409s
	iters: 2200, epoch: 1 | loss: 1.7985530
	speed: 0.0302s/iter; left time: 1627.9830s
	iters: 2300, epoch: 1 | loss: 1.6759932
	speed: 0.0297s/iter; left time: 1598.2727s
	iters: 2400, epoch: 1 | loss: 1.4959912
	speed: 0.0301s/iter; left time: 1615.3225s
	iters: 2500, epoch: 1 | loss: 1.7708991
	speed: 0.0301s/iter; left time: 1610.3886s
	iters: 2600, epoch: 1 | loss: 1.5448797
	speed: 0.0300s/iter; left time: 1605.5294s
	iters: 2700, epoch: 1 | loss: 1.5317492
	speed: 0.0301s/iter; left time: 1608.1259s
	iters: 2800, epoch: 1 | loss: 1.7307999
	speed: 0.0304s/iter; left time: 1616.6630s
	iters: 2900, epoch: 1 | loss: 1.6373302
	speed: 0.0301s/iter; left time: 1597.7604s
	iters: 3000, epoch: 1 | loss: 1.4441309
	speed: 0.0299s/iter; left time: 1588.7348s
	iters: 3100, epoch: 1 | loss: 1.5510587
	speed: 0.0301s/iter; left time: 1596.3144s
	iters: 3200, epoch: 1 | loss: 1.8260292
	speed: 0.0304s/iter; left time: 1605.3469s
	iters: 3300, epoch: 1 | loss: 1.6106223
	speed: 0.0301s/iter; left time: 1587.8774s
	iters: 3400, epoch: 1 | loss: 1.5165793
	speed: 0.0301s/iter; left time: 1584.4572s
	iters: 3500, epoch: 1 | loss: 1.5484244
	speed: 0.0299s/iter; left time: 1569.5549s
	iters: 3600, epoch: 1 | loss: 1.6073465
	speed: 0.0301s/iter; left time: 1580.5734s
	iters: 3700, epoch: 1 | loss: 1.6850382
	speed: 0.0302s/iter; left time: 1582.6134s
	iters: 3800, epoch: 1 | loss: 1.9376017
	speed: 0.0303s/iter; left time: 1584.0427s
	iters: 3900, epoch: 1 | loss: 1.5906824
	speed: 0.0302s/iter; left time: 1575.3095s
	iters: 4000, epoch: 1 | loss: 2.0425670
	speed: 0.0298s/iter; left time: 1548.6664s
	iters: 4100, epoch: 1 | loss: 1.4059474
	speed: 0.0302s/iter; left time: 1570.3488s
	iters: 4200, epoch: 1 | loss: 1.6193509
	speed: 0.0301s/iter; left time: 1560.8387s
	iters: 4300, epoch: 1 | loss: 1.8354743
	speed: 0.0299s/iter; left time: 1545.5312s
	iters: 4400, epoch: 1 | loss: 1.6973954
	speed: 0.0301s/iter; left time: 1555.4843s
	iters: 4500, epoch: 1 | loss: 1.9136175
	speed: 0.0295s/iter; left time: 1518.1821s
	iters: 4600, epoch: 1 | loss: 1.5911219
	speed: 0.0303s/iter; left time: 1559.8887s
	iters: 4700, epoch: 1 | loss: 1.4764024
	speed: 0.0295s/iter; left time: 1513.8448s
	iters: 4800, epoch: 1 | loss: 1.8056967
	speed: 0.0299s/iter; left time: 1532.9141s
	iters: 4900, epoch: 1 | loss: 1.5305674
	speed: 0.0300s/iter; left time: 1536.7643s
	iters: 5000, epoch: 1 | loss: 1.7086697
	speed: 0.0299s/iter; left time: 1525.9486s
	iters: 5100, epoch: 1 | loss: 1.7811331
	speed: 0.0302s/iter; left time: 1536.2255s
	iters: 5200, epoch: 1 | loss: 1.3277602
	speed: 0.0301s/iter; left time: 1530.3792s
	iters: 5300, epoch: 1 | loss: 1.5573521
	speed: 0.0301s/iter; left time: 1527.8842s
	iters: 5400, epoch: 1 | loss: 1.6293921
	speed: 0.0301s/iter; left time: 1525.3738s
	iters: 5500, epoch: 1 | loss: 1.5534599
	speed: 0.0304s/iter; left time: 1534.4137s
	iters: 5600, epoch: 1 | loss: 1.5491928
	speed: 0.0303s/iter; left time: 1530.9821s
Epoch: 1 cost time: 168.84528708457947
Epoch: 1, Steps: 5605 | Train Loss: 1.6268190 Vali Loss: 2.4848993 Test Loss: 1.8930506
Validation loss decreased (inf --> 2.484899).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.7665745
	speed: 0.8932s/iter; left time: 44967.0326s
	iters: 200, epoch: 2 | loss: 1.7752746
	speed: 0.0299s/iter; left time: 1503.8670s
	iters: 300, epoch: 2 | loss: 1.4774644
	speed: 0.0299s/iter; left time: 1499.7599s
	iters: 400, epoch: 2 | loss: 1.6659653
	speed: 0.0300s/iter; left time: 1498.9729s
	iters: 500, epoch: 2 | loss: 1.6585895
	speed: 0.0303s/iter; left time: 1513.9226s
	iters: 600, epoch: 2 | loss: 1.7474034
	speed: 0.0300s/iter; left time: 1495.6046s
	iters: 700, epoch: 2 | loss: 1.8056725
	speed: 0.0298s/iter; left time: 1482.9316s
	iters: 800, epoch: 2 | loss: 1.5993024
	speed: 0.0301s/iter; left time: 1496.3533s
	iters: 900, epoch: 2 | loss: 1.8805274
	speed: 0.0298s/iter; left time: 1477.5799s
	iters: 1000, epoch: 2 | loss: 1.4232287
	speed: 0.0300s/iter; left time: 1482.2334s
	iters: 1100, epoch: 2 | loss: 1.4937298
	speed: 0.0299s/iter; left time: 1476.5365s
	iters: 1200, epoch: 2 | loss: 1.8148634
	speed: 0.0302s/iter; left time: 1487.0186s
	iters: 1300, epoch: 2 | loss: 1.6856183
	speed: 0.0295s/iter; left time: 1449.0591s
	iters: 1400, epoch: 2 | loss: 1.6732712
	speed: 0.0302s/iter; left time: 1481.1753s
	iters: 1500, epoch: 2 | loss: 1.6155241
	speed: 0.0303s/iter; left time: 1482.1069s
	iters: 1600, epoch: 2 | loss: 1.8760892
	speed: 0.0299s/iter; left time: 1462.5446s
	iters: 1700, epoch: 2 | loss: 1.6512517
	speed: 0.0293s/iter; left time: 1430.3120s
	iters: 1800, epoch: 2 | loss: 1.7483407
	speed: 0.0302s/iter; left time: 1468.8286s
	iters: 1900, epoch: 2 | loss: 1.6204602
	speed: 0.0294s/iter; left time: 1429.0169s
	iters: 2000, epoch: 2 | loss: 1.7473440
	speed: 0.0303s/iter; left time: 1468.3883s
	iters: 2100, epoch: 2 | loss: 1.6490009
	speed: 0.0296s/iter; left time: 1430.7520s
	iters: 2200, epoch: 2 | loss: 1.9877849
	speed: 0.0301s/iter; left time: 1451.7658s
	iters: 2300, epoch: 2 | loss: 1.4796373
	speed: 0.0303s/iter; left time: 1461.1079s
	iters: 2400, epoch: 2 | loss: 1.6676949
	speed: 0.0300s/iter; left time: 1440.6921s
	iters: 2500, epoch: 2 | loss: 1.5433922
	speed: 0.0296s/iter; left time: 1418.9707s
	iters: 2600, epoch: 2 | loss: 1.9235957
	speed: 0.0303s/iter; left time: 1449.0065s
	iters: 2700, epoch: 2 | loss: 1.7113115
	speed: 0.0300s/iter; left time: 1434.2673s
	iters: 2800, epoch: 2 | loss: 1.5764214
	speed: 0.0301s/iter; left time: 1435.8007s
	iters: 2900, epoch: 2 | loss: 1.6455817
	speed: 0.0299s/iter; left time: 1419.9703s
	iters: 3000, epoch: 2 | loss: 1.7207544
	speed: 0.0302s/iter; left time: 1432.7241s
	iters: 3100, epoch: 2 | loss: 1.8591745
	speed: 0.0304s/iter; left time: 1437.6487s
	iters: 3200, epoch: 2 | loss: 1.5424738
	speed: 0.0297s/iter; left time: 1404.4623s
	iters: 3300, epoch: 2 | loss: 1.4332191
	speed: 0.0303s/iter; left time: 1426.7709s
	iters: 3400, epoch: 2 | loss: 1.9534025
	speed: 0.0301s/iter; left time: 1414.6964s
	iters: 3500, epoch: 2 | loss: 1.6845497
	speed: 0.0302s/iter; left time: 1419.1779s
	iters: 3600, epoch: 2 | loss: 1.5724796
	speed: 0.0303s/iter; left time: 1417.6016s
	iters: 3700, epoch: 2 | loss: 1.6722045
	speed: 0.0303s/iter; left time: 1415.7962s
	iters: 3800, epoch: 2 | loss: 1.4951406
	speed: 0.0295s/iter; left time: 1374.2558s
	iters: 3900, epoch: 2 | loss: 1.6747479
	speed: 0.0298s/iter; left time: 1387.9049s
	iters: 4000, epoch: 2 | loss: 1.6093863
	speed: 0.0298s/iter; left time: 1384.9601s
	iters: 4100, epoch: 2 | loss: 1.6362414
	speed: 0.0304s/iter; left time: 1407.6993s
	iters: 4200, epoch: 2 | loss: 1.9875610
	speed: 0.0297s/iter; left time: 1372.2056s
	iters: 4300, epoch: 2 | loss: 1.7711170
	speed: 0.0302s/iter; left time: 1394.1372s
	iters: 4400, epoch: 2 | loss: 1.5972480
	speed: 0.0303s/iter; left time: 1394.3890s
	iters: 4500, epoch: 2 | loss: 1.6533996
	speed: 0.0299s/iter; left time: 1375.8420s
	iters: 4600, epoch: 2 | loss: 1.7013429
	speed: 0.0300s/iter; left time: 1373.3053s
	iters: 4700, epoch: 2 | loss: 1.8769165
	speed: 0.0304s/iter; left time: 1389.6655s
	iters: 4800, epoch: 2 | loss: 1.7532982
	speed: 0.0299s/iter; left time: 1366.9158s
	iters: 4900, epoch: 2 | loss: 1.6243428
	speed: 0.0301s/iter; left time: 1373.0970s
	iters: 5000, epoch: 2 | loss: 2.0340810
	speed: 0.0301s/iter; left time: 1368.9065s
	iters: 5100, epoch: 2 | loss: 1.8069865
	speed: 0.0305s/iter; left time: 1382.1337s
	iters: 5200, epoch: 2 | loss: 2.0331531
	speed: 0.0299s/iter; left time: 1354.0084s
	iters: 5300, epoch: 2 | loss: 1.6944846
	speed: 0.0295s/iter; left time: 1332.6013s
	iters: 5400, epoch: 2 | loss: 1.7954704
	speed: 0.0302s/iter; left time: 1358.4165s
	iters: 5500, epoch: 2 | loss: 2.1569297
	speed: 0.0295s/iter; left time: 1328.1431s
	iters: 5600, epoch: 2 | loss: 1.7854056
	speed: 0.0300s/iter; left time: 1346.5133s
Epoch: 2 cost time: 168.28822302818298
Epoch: 2, Steps: 5605 | Train Loss: 1.7378288 Vali Loss: 2.3341796 Test Loss: 1.6445659
Validation loss decreased (2.484899 --> 2.334180).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6802381
	speed: 0.8966s/iter; left time: 40116.6819s
	iters: 200, epoch: 3 | loss: 1.8434621
	speed: 0.0304s/iter; left time: 1355.9708s
	iters: 300, epoch: 3 | loss: 1.7292970
	speed: 0.0297s/iter; left time: 1324.5019s
	iters: 400, epoch: 3 | loss: 2.0338275
	speed: 0.0303s/iter; left time: 1345.9439s
	iters: 500, epoch: 3 | loss: 1.6761550
	speed: 0.0302s/iter; left time: 1337.2514s
	iters: 600, epoch: 3 | loss: 1.7552478
	speed: 0.0304s/iter; left time: 1343.6003s
	iters: 700, epoch: 3 | loss: 2.0281277
	speed: 0.0299s/iter; left time: 1319.7292s
	iters: 800, epoch: 3 | loss: 1.6597841
	speed: 0.0303s/iter; left time: 1333.8363s
	iters: 900, epoch: 3 | loss: 1.6458457
	speed: 0.0300s/iter; left time: 1317.7021s
	iters: 1000, epoch: 3 | loss: 1.5770123
	speed: 0.0301s/iter; left time: 1317.5962s
	iters: 1100, epoch: 3 | loss: 1.7923068
	speed: 0.0301s/iter; left time: 1314.4902s
	iters: 1200, epoch: 3 | loss: 1.7588327
	speed: 0.0298s/iter; left time: 1300.3109s
	iters: 1300, epoch: 3 | loss: 1.7888029
	speed: 0.0302s/iter; left time: 1314.3525s
	iters: 1400, epoch: 3 | loss: 1.6808325
	speed: 0.0303s/iter; left time: 1317.9312s
	iters: 1500, epoch: 3 | loss: 1.8843745
	speed: 0.0304s/iter; left time: 1316.4350s
	iters: 1600, epoch: 3 | loss: 1.9583291
	speed: 0.0303s/iter; left time: 1311.3542s
	iters: 1700, epoch: 3 | loss: 1.6343416
	speed: 0.0294s/iter; left time: 1269.6743s
	iters: 1800, epoch: 3 | loss: 2.0639970
	speed: 0.0303s/iter; left time: 1302.8060s
	iters: 1900, epoch: 3 | loss: 1.7143390
	speed: 0.0303s/iter; left time: 1299.8718s
	iters: 2000, epoch: 3 | loss: 1.6094339
	speed: 0.0295s/iter; left time: 1265.4155s
	iters: 2100, epoch: 3 | loss: 1.9638450
	speed: 0.0304s/iter; left time: 1297.2157s
	iters: 2200, epoch: 3 | loss: 1.8928827
	speed: 0.0298s/iter; left time: 1269.7334s
	iters: 2300, epoch: 3 | loss: 1.7342464
	speed: 0.0300s/iter; left time: 1275.9043s
	iters: 2400, epoch: 3 | loss: 2.0558214
	speed: 0.0303s/iter; left time: 1285.9025s
	iters: 2500, epoch: 3 | loss: 1.8969829
	speed: 0.0298s/iter; left time: 1260.8488s
	iters: 2600, epoch: 3 | loss: 1.6263127
	speed: 0.0295s/iter; left time: 1245.0621s
	iters: 2700, epoch: 3 | loss: 1.6303306
	speed: 0.0298s/iter; left time: 1253.8939s
	iters: 2800, epoch: 3 | loss: 1.5683588
	speed: 0.0302s/iter; left time: 1267.6163s
	iters: 2900, epoch: 3 | loss: 1.8294199
	speed: 0.0300s/iter; left time: 1259.7024s
	iters: 3000, epoch: 3 | loss: 1.6798208
	speed: 0.0297s/iter; left time: 1244.1223s
	iters: 3100, epoch: 3 | loss: 1.6629174
	speed: 0.0301s/iter; left time: 1256.5709s
	iters: 3200, epoch: 3 | loss: 1.9680678
	speed: 0.0298s/iter; left time: 1242.5952s
	iters: 3300, epoch: 3 | loss: 1.7574124
	speed: 0.0302s/iter; left time: 1254.1900s
	iters: 3400, epoch: 3 | loss: 1.7445977
	speed: 0.0297s/iter; left time: 1230.0733s
	iters: 3500, epoch: 3 | loss: 1.7293330
	speed: 0.0303s/iter; left time: 1252.3315s
	iters: 3600, epoch: 3 | loss: 1.5476761
	speed: 0.0301s/iter; left time: 1241.4416s
	iters: 3700, epoch: 3 | loss: 1.8297832
	speed: 0.0304s/iter; left time: 1248.7174s
	iters: 3800, epoch: 3 | loss: 1.8996302
	speed: 0.0301s/iter; left time: 1235.3994s
	iters: 3900, epoch: 3 | loss: 1.9150414
	speed: 0.0303s/iter; left time: 1241.5732s
	iters: 4000, epoch: 3 | loss: 1.8977176
	speed: 0.0293s/iter; left time: 1197.5755s
	iters: 4100, epoch: 3 | loss: 1.8244033
	speed: 0.0303s/iter; left time: 1233.4726s
	iters: 4200, epoch: 3 | loss: 1.5062491
	speed: 0.0296s/iter; left time: 1203.8598s
	iters: 4300, epoch: 3 | loss: 1.8028709
	speed: 0.0292s/iter; left time: 1185.0730s
	iters: 4400, epoch: 3 | loss: 1.6083235
	speed: 0.0304s/iter; left time: 1227.8451s
	iters: 4500, epoch: 3 | loss: 1.6803095
	speed: 0.0300s/iter; left time: 1212.0154s
	iters: 4600, epoch: 3 | loss: 2.0534682
	speed: 0.0301s/iter; left time: 1212.0992s
	iters: 4700, epoch: 3 | loss: 2.0709164
	speed: 0.0302s/iter; left time: 1213.7729s
	iters: 4800, epoch: 3 | loss: 1.7878927
	speed: 0.0300s/iter; left time: 1201.3478s
	iters: 4900, epoch: 3 | loss: 1.8004669
	speed: 0.0302s/iter; left time: 1204.4052s
	iters: 5000, epoch: 3 | loss: 1.8861614
	speed: 0.0302s/iter; left time: 1204.0614s
	iters: 5100, epoch: 3 | loss: 1.9665490
	speed: 0.0299s/iter; left time: 1189.5041s
	iters: 5200, epoch: 3 | loss: 1.8292602
	speed: 0.0303s/iter; left time: 1199.6629s
	iters: 5300, epoch: 3 | loss: 1.6931485
	speed: 0.0301s/iter; left time: 1191.7067s
	iters: 5400, epoch: 3 | loss: 1.4803327
	speed: 0.0302s/iter; left time: 1189.3000s
	iters: 5500, epoch: 3 | loss: 1.8810099
	speed: 0.0299s/iter; left time: 1178.1785s
	iters: 5600, epoch: 3 | loss: 1.8323966
	speed: 0.0301s/iter; left time: 1179.5619s
Epoch: 3 cost time: 168.52125239372253
Epoch: 3, Steps: 5605 | Train Loss: 1.7466155 Vali Loss: 2.3404293 Test Loss: 1.6497022
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 2.1048775
	speed: 0.8944s/iter; left time: 35004.7895s
	iters: 200, epoch: 4 | loss: 1.8125720
	speed: 0.0297s/iter; left time: 1158.3952s
	iters: 300, epoch: 4 | loss: 1.5310326
	speed: 0.0300s/iter; left time: 1169.7386s
	iters: 400, epoch: 4 | loss: 1.3639736
	speed: 0.0299s/iter; left time: 1160.7454s
	iters: 500, epoch: 4 | loss: 1.4849082
	speed: 0.0296s/iter; left time: 1146.6731s
	iters: 600, epoch: 4 | loss: 2.0408590
	speed: 0.0303s/iter; left time: 1172.3875s
	iters: 700, epoch: 4 | loss: 1.6734380
	speed: 0.0304s/iter; left time: 1170.6777s
	iters: 800, epoch: 4 | loss: 1.7117176
	speed: 0.0303s/iter; left time: 1164.1435s
	iters: 900, epoch: 4 | loss: 1.9715110
	speed: 0.0302s/iter; left time: 1158.6327s
	iters: 1000, epoch: 4 | loss: 1.8106012
	speed: 0.0296s/iter; left time: 1132.8487s
	iters: 1100, epoch: 4 | loss: 1.5878077
	speed: 0.0299s/iter; left time: 1141.9869s
	iters: 1200, epoch: 4 | loss: 1.7579561
	speed: 0.0304s/iter; left time: 1154.7305s
	iters: 1300, epoch: 4 | loss: 1.8637990
	speed: 0.0303s/iter; left time: 1151.0045s
	iters: 1400, epoch: 4 | loss: 1.8288389
	speed: 0.0301s/iter; left time: 1137.4425s
	iters: 1500, epoch: 4 | loss: 1.7998620
	speed: 0.0303s/iter; left time: 1144.3410s
	iters: 1600, epoch: 4 | loss: 1.8108140
	speed: 0.0304s/iter; left time: 1143.0483s
	iters: 1700, epoch: 4 | loss: 1.7867882
	speed: 0.0297s/iter; left time: 1116.6299s
	iters: 1800, epoch: 4 | loss: 2.0785439
	speed: 0.0304s/iter; left time: 1136.2959s
	iters: 1900, epoch: 4 | loss: 1.7289554
	speed: 0.0298s/iter; left time: 1113.6836s
	iters: 2000, epoch: 4 | loss: 1.8523691
	speed: 0.0302s/iter; left time: 1123.0426s
	iters: 2100, epoch: 4 | loss: 2.2434006
	speed: 0.0300s/iter; left time: 1113.1867s
	iters: 2200, epoch: 4 | loss: 1.7118815
	speed: 0.0299s/iter; left time: 1108.5387s
	iters: 2300, epoch: 4 | loss: 1.8408790
	speed: 0.0301s/iter; left time: 1110.3563s
	iters: 2400, epoch: 4 | loss: 1.6230959
	speed: 0.0296s/iter; left time: 1088.7941s
	iters: 2500, epoch: 4 | loss: 1.6299696
	speed: 0.0298s/iter; left time: 1094.6813s
	iters: 2600, epoch: 4 | loss: 1.7522775
	speed: 0.0297s/iter; left time: 1086.8301s
	iters: 2700, epoch: 4 | loss: 1.6445831
	speed: 0.0295s/iter; left time: 1077.0863s
	iters: 2800, epoch: 4 | loss: 1.8247547
	speed: 0.0296s/iter; left time: 1079.0135s
	iters: 2900, epoch: 4 | loss: 1.9241399
	speed: 0.0301s/iter; left time: 1095.4501s
	iters: 3000, epoch: 4 | loss: 1.5291195
	speed: 0.0299s/iter; left time: 1084.9744s
	iters: 3100, epoch: 4 | loss: 1.7177914
	speed: 0.0303s/iter; left time: 1093.1586s
	iters: 3200, epoch: 4 | loss: 1.8774258
	speed: 0.0297s/iter; left time: 1071.2806s
	iters: 3300, epoch: 4 | loss: 1.8967266
	speed: 0.0297s/iter; left time: 1067.6725s
	iters: 3400, epoch: 4 | loss: 1.6870406
	speed: 0.0304s/iter; left time: 1089.7561s
	iters: 3500, epoch: 4 | loss: 1.6624395
	speed: 0.0300s/iter; left time: 1073.2794s
	iters: 3600, epoch: 4 | loss: 1.8631839
	speed: 0.0302s/iter; left time: 1074.9435s
	iters: 3700, epoch: 4 | loss: 1.6154013
	speed: 0.0302s/iter; left time: 1071.4787s
	iters: 3800, epoch: 4 | loss: 1.8322154
	speed: 0.0302s/iter; left time: 1068.7841s
	iters: 3900, epoch: 4 | loss: 1.7924953
	speed: 0.0302s/iter; left time: 1066.8319s
	iters: 4000, epoch: 4 | loss: 1.6576965
	speed: 0.0300s/iter; left time: 1058.4545s
	iters: 4100, epoch: 4 | loss: 1.6444772
	speed: 0.0299s/iter; left time: 1052.2957s
	iters: 4200, epoch: 4 | loss: 1.9127626
	speed: 0.0304s/iter; left time: 1063.4651s
	iters: 4300, epoch: 4 | loss: 1.7404416
	speed: 0.0303s/iter; left time: 1059.9139s
	iters: 4400, epoch: 4 | loss: 1.9076197
	speed: 0.0302s/iter; left time: 1053.7346s
	iters: 4500, epoch: 4 | loss: 1.6608076
	speed: 0.0299s/iter; left time: 1037.0465s
	iters: 4600, epoch: 4 | loss: 1.8274796
	speed: 0.0302s/iter; left time: 1047.3942s
	iters: 4700, epoch: 4 | loss: 1.8376230
	speed: 0.0299s/iter; left time: 1033.3429s
	iters: 4800, epoch: 4 | loss: 1.7443995
	speed: 0.0301s/iter; left time: 1035.3580s
	iters: 4900, epoch: 4 | loss: 2.1844532
	speed: 0.0297s/iter; left time: 1020.5536s
	iters: 5000, epoch: 4 | loss: 1.7205431
	speed: 0.0302s/iter; left time: 1034.6161s
	iters: 5100, epoch: 4 | loss: 1.8132236
	speed: 0.0301s/iter; left time: 1027.3192s
	iters: 5200, epoch: 4 | loss: 1.7966092
	speed: 0.0304s/iter; left time: 1033.0007s
	iters: 5300, epoch: 4 | loss: 1.5390639
	speed: 0.0301s/iter; left time: 1019.8261s
	iters: 5400, epoch: 4 | loss: 1.6047403
	speed: 0.0302s/iter; left time: 1020.2546s
	iters: 5500, epoch: 4 | loss: 1.9932878
	speed: 0.0301s/iter; left time: 1017.1005s
	iters: 5600, epoch: 4 | loss: 1.7840356
	speed: 0.0303s/iter; left time: 1020.2376s
Epoch: 4 cost time: 168.4685332775116
Epoch: 4, Steps: 5605 | Train Loss: 1.7464910 Vali Loss: 2.3472881 Test Loss: 1.6555264
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.8920506
	speed: 0.8960s/iter; left time: 30042.8372s
	iters: 200, epoch: 5 | loss: 1.8387443
	speed: 0.0301s/iter; left time: 1007.2768s
	iters: 300, epoch: 5 | loss: 1.6602982
	speed: 0.0303s/iter; left time: 1008.3074s
	iters: 400, epoch: 5 | loss: 1.6872535
	speed: 0.0301s/iter; left time: 1001.9027s
	iters: 500, epoch: 5 | loss: 1.6477358
	speed: 0.0298s/iter; left time: 986.9544s
	iters: 600, epoch: 5 | loss: 1.7547832
	speed: 0.0301s/iter; left time: 993.5856s
	iters: 700, epoch: 5 | loss: 1.7254333
	speed: 0.0301s/iter; left time: 992.4789s
	iters: 800, epoch: 5 | loss: 1.6872045
	speed: 0.0298s/iter; left time: 977.3636s
	iters: 900, epoch: 5 | loss: 1.4961895
	speed: 0.0301s/iter; left time: 986.2416s
	iters: 1000, epoch: 5 | loss: 1.4452752
	speed: 0.0302s/iter; left time: 984.9538s
	iters: 1100, epoch: 5 | loss: 2.0653965
	speed: 0.0297s/iter; left time: 966.7471s
	iters: 1200, epoch: 5 | loss: 1.5126894
	speed: 0.0298s/iter; left time: 966.6963s
	iters: 1300, epoch: 5 | loss: 1.8519275
	speed: 0.0298s/iter; left time: 961.8661s
	iters: 1400, epoch: 5 | loss: 1.7641404
	speed: 0.0300s/iter; left time: 965.3430s
	iters: 1500, epoch: 5 | loss: 1.6488684
	speed: 0.0303s/iter; left time: 974.3657s
	iters: 1600, epoch: 5 | loss: 1.8061084
	speed: 0.0304s/iter; left time: 972.8813s
	iters: 1700, epoch: 5 | loss: 1.7318231
	speed: 0.0303s/iter; left time: 966.9711s
	iters: 1800, epoch: 5 | loss: 1.8331987
	speed: 0.0297s/iter; left time: 946.8079s
	iters: 1900, epoch: 5 | loss: 1.7274832
	speed: 0.0304s/iter; left time: 963.1432s
	iters: 2000, epoch: 5 | loss: 1.8321209
	speed: 0.0302s/iter; left time: 953.9717s
	iters: 2100, epoch: 5 | loss: 1.7827182
	speed: 0.0302s/iter; left time: 952.4617s
	iters: 2200, epoch: 5 | loss: 1.8629097
	speed: 0.0304s/iter; left time: 955.8590s
	iters: 2300, epoch: 5 | loss: 1.9354620
	speed: 0.0295s/iter; left time: 924.3489s
	iters: 2400, epoch: 5 | loss: 1.4356067
	speed: 0.0298s/iter; left time: 929.2469s
	iters: 2500, epoch: 5 | loss: 1.6516641
	speed: 0.0302s/iter; left time: 940.9467s
	iters: 2600, epoch: 5 | loss: 1.6436012
	speed: 0.0303s/iter; left time: 938.8677s
	iters: 2700, epoch: 5 | loss: 1.7402235
	speed: 0.0303s/iter; left time: 938.6339s
	iters: 2800, epoch: 5 | loss: 1.5005494
	speed: 0.0304s/iter; left time: 936.1880s
	iters: 2900, epoch: 5 | loss: 1.4820694
	speed: 0.0297s/iter; left time: 913.3791s
	iters: 3000, epoch: 5 | loss: 1.5303646
	speed: 0.0297s/iter; left time: 910.4703s
	iters: 3100, epoch: 5 | loss: 1.5141503
	speed: 0.0303s/iter; left time: 924.4873s
	iters: 3200, epoch: 5 | loss: 1.5282078
	speed: 0.0302s/iter; left time: 920.1810s
	iters: 3300, epoch: 5 | loss: 1.8623365
	speed: 0.0301s/iter; left time: 911.8883s
	iters: 3400, epoch: 5 | loss: 1.4213455
	speed: 0.0301s/iter; left time: 910.1312s
	iters: 3500, epoch: 5 | loss: 2.1448357
	speed: 0.0299s/iter; left time: 900.3632s
	iters: 3600, epoch: 5 | loss: 1.5257648
	speed: 0.0302s/iter; left time: 907.6535s
	iters: 3700, epoch: 5 | loss: 1.6265106
	speed: 0.0303s/iter; left time: 908.1166s
	iters: 3800, epoch: 5 | loss: 1.7336612
	speed: 0.0303s/iter; left time: 903.9617s
	iters: 3900, epoch: 5 | loss: 1.7449144
	speed: 0.0303s/iter; left time: 900.5334s
	iters: 4000, epoch: 5 | loss: 1.4462719
	speed: 0.0301s/iter; left time: 892.0742s
	iters: 4100, epoch: 5 | loss: 1.5282789
	speed: 0.0301s/iter; left time: 888.2064s
	iters: 4200, epoch: 5 | loss: 1.7120634
	speed: 0.0298s/iter; left time: 878.3426s
	iters: 4300, epoch: 5 | loss: 1.7260897
	speed: 0.0304s/iter; left time: 891.1937s
	iters: 4400, epoch: 5 | loss: 1.5556884
	speed: 0.0301s/iter; left time: 880.8079s
	iters: 4500, epoch: 5 | loss: 1.8079896
	speed: 0.0295s/iter; left time: 858.8392s
	iters: 4600, epoch: 5 | loss: 1.7082601
	speed: 0.0299s/iter; left time: 867.4554s
	iters: 4700, epoch: 5 | loss: 1.5002038
	speed: 0.0297s/iter; left time: 859.1639s
	iters: 4800, epoch: 5 | loss: 1.5467590
	speed: 0.0303s/iter; left time: 874.9800s
	iters: 4900, epoch: 5 | loss: 1.3955323
	speed: 0.0304s/iter; left time: 872.9238s
	iters: 5000, epoch: 5 | loss: 1.6702898
	speed: 0.0302s/iter; left time: 863.8480s
	iters: 5100, epoch: 5 | loss: 1.4923621
	speed: 0.0297s/iter; left time: 848.6006s
	iters: 5200, epoch: 5 | loss: 1.2836868
	speed: 0.0301s/iter; left time: 856.5071s
	iters: 5300, epoch: 5 | loss: 1.6468453
	speed: 0.0304s/iter; left time: 861.3041s
	iters: 5400, epoch: 5 | loss: 1.1445942
	speed: 0.0303s/iter; left time: 854.0161s
	iters: 5500, epoch: 5 | loss: 1.4685146
	speed: 0.0303s/iter; left time: 853.4419s
	iters: 5600, epoch: 5 | loss: 1.4327041
	speed: 0.0303s/iter; left time: 849.9306s
Epoch: 5 cost time: 168.78588128089905
Epoch: 5, Steps: 5605 | Train Loss: 1.6606427 Vali Loss: 2.4250841 Test Loss: 1.8174661
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 193645
test shape: (19364, 1, 192, 107) (19364, 1, 192, 107)
test shape: (19364, 192, 107) (19364, 192, 107)
mse:1.6445646286010742, mae:0.9860512018203735
>>>>>>>Overall time: 1428 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
