Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 690678
val 90036
test 90034
	iters: 100, epoch: 1 | loss: 1.7559347
	speed: 0.0324s/iter; left time: 1393.4875s
	iters: 200, epoch: 1 | loss: 1.7888457
	speed: 0.0295s/iter; left time: 1269.4400s
	iters: 300, epoch: 1 | loss: 1.5452569
	speed: 0.0294s/iter; left time: 1259.3121s
	iters: 400, epoch: 1 | loss: 2.0364165
	speed: 0.0294s/iter; left time: 1255.4330s
	iters: 500, epoch: 1 | loss: 1.9230857
	speed: 0.0293s/iter; left time: 1249.6425s
	iters: 600, epoch: 1 | loss: 1.6778659
	speed: 0.0304s/iter; left time: 1291.8948s
	iters: 700, epoch: 1 | loss: 1.4770045
	speed: 0.0295s/iter; left time: 1253.1685s
	iters: 800, epoch: 1 | loss: 1.6188152
	speed: 0.0301s/iter; left time: 1273.4329s
	iters: 900, epoch: 1 | loss: 1.9017826
	speed: 0.0302s/iter; left time: 1278.1312s
	iters: 1000, epoch: 1 | loss: 1.8830476
	speed: 0.0304s/iter; left time: 1280.4390s
	iters: 1100, epoch: 1 | loss: 1.8190652
	speed: 0.0291s/iter; left time: 1225.9630s
	iters: 1200, epoch: 1 | loss: 1.3838030
	speed: 0.0300s/iter; left time: 1258.6239s
	iters: 1300, epoch: 1 | loss: 1.1538225
	speed: 0.0298s/iter; left time: 1249.3867s
	iters: 1400, epoch: 1 | loss: 1.2980976
	speed: 0.0304s/iter; left time: 1268.3797s
	iters: 1500, epoch: 1 | loss: 1.9107754
	speed: 0.0299s/iter; left time: 1244.4762s
	iters: 1600, epoch: 1 | loss: 1.4507746
	speed: 0.0304s/iter; left time: 1261.9918s
	iters: 1700, epoch: 1 | loss: 1.6558959
	speed: 0.0301s/iter; left time: 1249.8796s
	iters: 1800, epoch: 1 | loss: 1.4946761
	speed: 0.0288s/iter; left time: 1191.2622s
	iters: 1900, epoch: 1 | loss: 1.7941508
	speed: 0.0300s/iter; left time: 1239.2042s
	iters: 2000, epoch: 1 | loss: 1.2642311
	speed: 0.0299s/iter; left time: 1229.8294s
	iters: 2100, epoch: 1 | loss: 2.0825636
	speed: 0.0301s/iter; left time: 1237.5896s
	iters: 2200, epoch: 1 | loss: 1.8068517
	speed: 0.0298s/iter; left time: 1221.7290s
	iters: 2300, epoch: 1 | loss: 1.8921152
	speed: 0.0300s/iter; left time: 1226.7978s
	iters: 2400, epoch: 1 | loss: 1.9515505
	speed: 0.0293s/iter; left time: 1194.6466s
	iters: 2500, epoch: 1 | loss: 1.6267397
	speed: 0.0299s/iter; left time: 1214.0886s
	iters: 2600, epoch: 1 | loss: 1.1255707
	speed: 0.0300s/iter; left time: 1218.2184s
	iters: 2700, epoch: 1 | loss: 2.4260552
	speed: 0.0300s/iter; left time: 1211.8557s
	iters: 2800, epoch: 1 | loss: 1.8342464
	speed: 0.0298s/iter; left time: 1203.7938s
	iters: 2900, epoch: 1 | loss: 1.9020180
	speed: 0.0302s/iter; left time: 1215.6304s
	iters: 3000, epoch: 1 | loss: 1.9627880
	speed: 0.0296s/iter; left time: 1187.6219s
	iters: 3100, epoch: 1 | loss: 1.6616521
	speed: 0.0298s/iter; left time: 1194.4245s
	iters: 3200, epoch: 1 | loss: 1.1882699
	speed: 0.0304s/iter; left time: 1212.8656s
	iters: 3300, epoch: 1 | loss: 1.5306534
	speed: 0.0304s/iter; left time: 1209.8940s
	iters: 3400, epoch: 1 | loss: 1.7114115
	speed: 0.0298s/iter; left time: 1186.7942s
	iters: 3500, epoch: 1 | loss: 1.9808328
	speed: 0.0303s/iter; left time: 1202.8569s
	iters: 3600, epoch: 1 | loss: 1.5828720
	speed: 0.0302s/iter; left time: 1193.9102s
	iters: 3700, epoch: 1 | loss: 1.4935170
	speed: 0.0301s/iter; left time: 1188.8419s
	iters: 3800, epoch: 1 | loss: 1.8715390
	speed: 0.0288s/iter; left time: 1135.1920s
	iters: 3900, epoch: 1 | loss: 1.7510098
	speed: 0.0294s/iter; left time: 1154.6549s
	iters: 4000, epoch: 1 | loss: 1.8662817
	speed: 0.0293s/iter; left time: 1147.3823s
	iters: 4100, epoch: 1 | loss: 2.4829891
	speed: 0.0302s/iter; left time: 1178.0107s
	iters: 4200, epoch: 1 | loss: 1.6743603
	speed: 0.0303s/iter; left time: 1180.8287s
	iters: 4300, epoch: 1 | loss: 1.7738992
	speed: 0.0302s/iter; left time: 1174.8599s
Epoch: 1 cost time: 129.22781109809875
Epoch: 1, Steps: 4316 | Train Loss: 1.7329983 Vali Loss: 0.8636369 Test Loss: 1.9776564
Validation loss decreased (inf --> 0.863637).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6589167
	speed: 0.4335s/iter; left time: 16795.7337s
	iters: 200, epoch: 2 | loss: 1.3786931
	speed: 0.0304s/iter; left time: 1174.7713s
	iters: 300, epoch: 2 | loss: 1.9922757
	speed: 0.0303s/iter; left time: 1167.4308s
	iters: 400, epoch: 2 | loss: 1.9701645
	speed: 0.0293s/iter; left time: 1126.3665s
	iters: 500, epoch: 2 | loss: 1.7966682
	speed: 0.0298s/iter; left time: 1143.0186s
	iters: 600, epoch: 2 | loss: 1.5343262
	speed: 0.0304s/iter; left time: 1162.4052s
	iters: 700, epoch: 2 | loss: 1.5532135
	speed: 0.0302s/iter; left time: 1153.5934s
	iters: 800, epoch: 2 | loss: 1.2004087
	speed: 0.0301s/iter; left time: 1146.3116s
	iters: 900, epoch: 2 | loss: 1.8470062
	speed: 0.0299s/iter; left time: 1133.5210s
	iters: 1000, epoch: 2 | loss: 1.6978979
	speed: 0.0304s/iter; left time: 1150.4393s
	iters: 1100, epoch: 2 | loss: 2.0937927
	speed: 0.0299s/iter; left time: 1127.6394s
	iters: 1200, epoch: 2 | loss: 2.0826502
	speed: 0.0301s/iter; left time: 1131.4388s
	iters: 1300, epoch: 2 | loss: 1.7947878
	speed: 0.0297s/iter; left time: 1115.2818s
	iters: 1400, epoch: 2 | loss: 2.5999537
	speed: 0.0304s/iter; left time: 1136.5211s
	iters: 1500, epoch: 2 | loss: 1.6955246
	speed: 0.0300s/iter; left time: 1120.3983s
	iters: 1600, epoch: 2 | loss: 1.5765665
	speed: 0.0297s/iter; left time: 1107.9197s
	iters: 1700, epoch: 2 | loss: 1.6983325
	speed: 0.0301s/iter; left time: 1117.4377s
	iters: 1800, epoch: 2 | loss: 1.1474819
	speed: 0.0302s/iter; left time: 1118.8017s
	iters: 1900, epoch: 2 | loss: 1.8887179
	speed: 0.0301s/iter; left time: 1112.8187s
	iters: 2000, epoch: 2 | loss: 2.0840936
	speed: 0.0298s/iter; left time: 1098.5415s
	iters: 2100, epoch: 2 | loss: 2.0665729
	speed: 0.0303s/iter; left time: 1111.5373s
	iters: 2200, epoch: 2 | loss: 1.5053279
	speed: 0.0302s/iter; left time: 1105.2888s
	iters: 2300, epoch: 2 | loss: 1.2604004
	speed: 0.0303s/iter; left time: 1108.6513s
	iters: 2400, epoch: 2 | loss: 2.3738410
	speed: 0.0302s/iter; left time: 1100.3494s
	iters: 2500, epoch: 2 | loss: 2.2344360
	speed: 0.0294s/iter; left time: 1068.8458s
	iters: 2600, epoch: 2 | loss: 1.9344161
	speed: 0.0303s/iter; left time: 1098.7504s
	iters: 2700, epoch: 2 | loss: 1.6210312
	speed: 0.0304s/iter; left time: 1099.1822s
	iters: 2800, epoch: 2 | loss: 2.0149307
	speed: 0.0301s/iter; left time: 1083.6884s
	iters: 2900, epoch: 2 | loss: 1.7395293
	speed: 0.0304s/iter; left time: 1091.4821s
	iters: 3000, epoch: 2 | loss: 1.9019022
	speed: 0.0295s/iter; left time: 1058.4554s
	iters: 3100, epoch: 2 | loss: 1.6773524
	speed: 0.0303s/iter; left time: 1081.6110s
	iters: 3200, epoch: 2 | loss: 1.9654458
	speed: 0.0303s/iter; left time: 1078.8457s
	iters: 3300, epoch: 2 | loss: 1.5855880
	speed: 0.0300s/iter; left time: 1065.9221s
	iters: 3400, epoch: 2 | loss: 1.9350848
	speed: 0.0300s/iter; left time: 1064.4693s
	iters: 3500, epoch: 2 | loss: 2.3279009
	speed: 0.0303s/iter; left time: 1070.5078s
	iters: 3600, epoch: 2 | loss: 1.8861616
	speed: 0.0301s/iter; left time: 1060.3200s
	iters: 3700, epoch: 2 | loss: 1.6345387
	speed: 0.0302s/iter; left time: 1062.4058s
	iters: 3800, epoch: 2 | loss: 1.5150036
	speed: 0.0299s/iter; left time: 1047.6873s
	iters: 3900, epoch: 2 | loss: 1.5575894
	speed: 0.0304s/iter; left time: 1062.2973s
	iters: 4000, epoch: 2 | loss: 1.7700565
	speed: 0.0295s/iter; left time: 1026.6887s
	iters: 4100, epoch: 2 | loss: 1.7297363
	speed: 0.0301s/iter; left time: 1044.5919s
	iters: 4200, epoch: 2 | loss: 1.4629656
	speed: 0.0301s/iter; left time: 1044.5297s
	iters: 4300, epoch: 2 | loss: 1.7919153
	speed: 0.0296s/iter; left time: 1023.0543s
Epoch: 2 cost time: 129.85077214241028
Epoch: 2, Steps: 4316 | Train Loss: 1.7493653 Vali Loss: 0.8253519 Test Loss: 1.5787584
Validation loss decreased (0.863637 --> 0.825352).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.7129148
	speed: 0.4302s/iter; left time: 14810.1720s
	iters: 200, epoch: 3 | loss: 1.3223889
	speed: 0.0301s/iter; left time: 1032.2487s
	iters: 300, epoch: 3 | loss: 2.1457164
	speed: 0.0302s/iter; left time: 1034.9907s
	iters: 400, epoch: 3 | loss: 1.4268934
	speed: 0.0288s/iter; left time: 983.5716s
	iters: 500, epoch: 3 | loss: 1.3727877
	speed: 0.0299s/iter; left time: 1017.6583s
	iters: 600, epoch: 3 | loss: 1.6780188
	speed: 0.0302s/iter; left time: 1025.6845s
	iters: 700, epoch: 3 | loss: 1.4965174
	speed: 0.0299s/iter; left time: 1010.9133s
	iters: 800, epoch: 3 | loss: 1.7207099
	speed: 0.0302s/iter; left time: 1017.6813s
	iters: 900, epoch: 3 | loss: 1.7520599
	speed: 0.0298s/iter; left time: 1001.8223s
	iters: 1000, epoch: 3 | loss: 1.4880419
	speed: 0.0304s/iter; left time: 1017.8433s
	iters: 1100, epoch: 3 | loss: 1.5233083
	speed: 0.0301s/iter; left time: 1005.0954s
	iters: 1200, epoch: 3 | loss: 1.3275187
	speed: 0.0304s/iter; left time: 1011.9428s
	iters: 1300, epoch: 3 | loss: 1.6504211
	speed: 0.0302s/iter; left time: 1002.8438s
	iters: 1400, epoch: 3 | loss: 1.6180758
	speed: 0.0294s/iter; left time: 972.9304s
	iters: 1500, epoch: 3 | loss: 1.6989888
	speed: 0.0300s/iter; left time: 989.6665s
	iters: 1600, epoch: 3 | loss: 1.5609143
	speed: 0.0299s/iter; left time: 983.8743s
	iters: 1700, epoch: 3 | loss: 1.5248042
	speed: 0.0301s/iter; left time: 988.0230s
	iters: 1800, epoch: 3 | loss: 1.6410551
	speed: 0.0297s/iter; left time: 973.1193s
	iters: 1900, epoch: 3 | loss: 1.4649040
	speed: 0.0296s/iter; left time: 966.7424s
	iters: 2000, epoch: 3 | loss: 1.6719104
	speed: 0.0299s/iter; left time: 973.1527s
	iters: 2100, epoch: 3 | loss: 2.2012534
	speed: 0.0295s/iter; left time: 955.1315s
	iters: 2200, epoch: 3 | loss: 1.6658125
	speed: 0.0296s/iter; left time: 956.2028s
	iters: 2300, epoch: 3 | loss: 2.2178266
	speed: 0.0303s/iter; left time: 978.0131s
	iters: 2400, epoch: 3 | loss: 1.5399070
	speed: 0.0303s/iter; left time: 972.7802s
	iters: 2500, epoch: 3 | loss: 1.7688357
	speed: 0.0293s/iter; left time: 937.4806s
	iters: 2600, epoch: 3 | loss: 1.9234526
	speed: 0.0300s/iter; left time: 958.6113s
	iters: 2700, epoch: 3 | loss: 1.7523197
	speed: 0.0299s/iter; left time: 953.2194s
	iters: 2800, epoch: 3 | loss: 1.6074533
	speed: 0.0305s/iter; left time: 969.0293s
	iters: 2900, epoch: 3 | loss: 1.3556336
	speed: 0.0297s/iter; left time: 939.3942s
	iters: 3000, epoch: 3 | loss: 1.8588173
	speed: 0.0301s/iter; left time: 948.7881s
	iters: 3100, epoch: 3 | loss: 2.0768650
	speed: 0.0297s/iter; left time: 933.8497s
	iters: 3200, epoch: 3 | loss: 1.8147436
	speed: 0.0297s/iter; left time: 928.9296s
	iters: 3300, epoch: 3 | loss: 2.4823425
	speed: 0.0297s/iter; left time: 926.3907s
	iters: 3400, epoch: 3 | loss: 1.5145861
	speed: 0.0302s/iter; left time: 940.1777s
	iters: 3500, epoch: 3 | loss: 1.4594897
	speed: 0.0303s/iter; left time: 939.6139s
	iters: 3600, epoch: 3 | loss: 1.9196000
	speed: 0.0304s/iter; left time: 940.1633s
	iters: 3700, epoch: 3 | loss: 1.8241211
	speed: 0.0302s/iter; left time: 932.2912s
	iters: 3800, epoch: 3 | loss: 1.6729076
	speed: 0.0303s/iter; left time: 932.5086s
	iters: 3900, epoch: 3 | loss: 1.8905073
	speed: 0.0302s/iter; left time: 925.2927s
	iters: 4000, epoch: 3 | loss: 1.7336830
	speed: 0.0303s/iter; left time: 924.3775s
	iters: 4100, epoch: 3 | loss: 1.5649678
	speed: 0.0302s/iter; left time: 920.1619s
	iters: 4200, epoch: 3 | loss: 1.7206904
	speed: 0.0301s/iter; left time: 912.2370s
	iters: 4300, epoch: 3 | loss: 1.8654513
	speed: 0.0303s/iter; left time: 916.8608s
Epoch: 3 cost time: 129.49314856529236
Epoch: 3, Steps: 4316 | Train Loss: 1.7046177 Vali Loss: 0.8071612 Test Loss: 1.8643310
Validation loss decreased (0.825352 --> 0.807161).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.7188158
	speed: 0.4324s/iter; left time: 13022.3555s
	iters: 200, epoch: 4 | loss: 1.6164323
	speed: 0.0299s/iter; left time: 896.1518s
	iters: 300, epoch: 4 | loss: 1.7489743
	speed: 0.0303s/iter; left time: 905.8005s
	iters: 400, epoch: 4 | loss: 2.2157569
	speed: 0.0299s/iter; left time: 890.3355s
	iters: 500, epoch: 4 | loss: 1.5349631
	speed: 0.0290s/iter; left time: 861.1980s
	iters: 600, epoch: 4 | loss: 2.5407562
	speed: 0.0291s/iter; left time: 861.5752s
	iters: 700, epoch: 4 | loss: 1.6604221
	speed: 0.0300s/iter; left time: 884.2927s
	iters: 800, epoch: 4 | loss: 1.5782202
	speed: 0.0302s/iter; left time: 888.2898s
	iters: 900, epoch: 4 | loss: 1.6692291
	speed: 0.0301s/iter; left time: 881.7174s
	iters: 1000, epoch: 4 | loss: 1.5562651
	speed: 0.0297s/iter; left time: 868.7996s
	iters: 1100, epoch: 4 | loss: 1.9376829
	speed: 0.0303s/iter; left time: 881.6551s
	iters: 1200, epoch: 4 | loss: 1.7682520
	speed: 0.0295s/iter; left time: 856.7047s
	iters: 1300, epoch: 4 | loss: 1.6620522
	speed: 0.0302s/iter; left time: 873.4936s
	iters: 1400, epoch: 4 | loss: 1.2927766
	speed: 0.0298s/iter; left time: 859.8957s
	iters: 1500, epoch: 4 | loss: 1.4650023
	speed: 0.0303s/iter; left time: 869.5940s
	iters: 1600, epoch: 4 | loss: 2.0021715
	speed: 0.0300s/iter; left time: 857.1697s
	iters: 1700, epoch: 4 | loss: 1.6068510
	speed: 0.0299s/iter; left time: 852.7218s
	iters: 1800, epoch: 4 | loss: 1.9530894
	speed: 0.0292s/iter; left time: 830.8671s
	iters: 1900, epoch: 4 | loss: 1.5462415
	speed: 0.0294s/iter; left time: 833.7286s
	iters: 2000, epoch: 4 | loss: 1.7077606
	speed: 0.0302s/iter; left time: 850.9999s
	iters: 2100, epoch: 4 | loss: 1.3058337
	speed: 0.0293s/iter; left time: 822.3653s
	iters: 2200, epoch: 4 | loss: 1.1063052
	speed: 0.0301s/iter; left time: 842.3518s
	iters: 2300, epoch: 4 | loss: 1.6134256
	speed: 0.0287s/iter; left time: 802.2297s
	iters: 2400, epoch: 4 | loss: 1.6731046
	speed: 0.0298s/iter; left time: 827.7708s
	iters: 2500, epoch: 4 | loss: 1.7329954
	speed: 0.0302s/iter; left time: 835.8569s
	iters: 2600, epoch: 4 | loss: 1.6587608
	speed: 0.0297s/iter; left time: 819.5397s
	iters: 2700, epoch: 4 | loss: 1.2523327
	speed: 0.0304s/iter; left time: 836.1072s
	iters: 2800, epoch: 4 | loss: 1.5498430
	speed: 0.0303s/iter; left time: 831.8288s
	iters: 2900, epoch: 4 | loss: 1.7486526
	speed: 0.0297s/iter; left time: 810.4235s
	iters: 3000, epoch: 4 | loss: 1.7149725
	speed: 0.0301s/iter; left time: 818.5350s
	iters: 3100, epoch: 4 | loss: 1.6905227
	speed: 0.0298s/iter; left time: 807.3128s
	iters: 3200, epoch: 4 | loss: 1.7565089
	speed: 0.0303s/iter; left time: 819.7148s
	iters: 3300, epoch: 4 | loss: 1.3883880
	speed: 0.0304s/iter; left time: 817.6293s
	iters: 3400, epoch: 4 | loss: 1.6392204
	speed: 0.0303s/iter; left time: 813.5822s
	iters: 3500, epoch: 4 | loss: 1.8631110
	speed: 0.0299s/iter; left time: 797.8064s
	iters: 3600, epoch: 4 | loss: 1.7590066
	speed: 0.0300s/iter; left time: 799.0451s
	iters: 3700, epoch: 4 | loss: 1.8137779
	speed: 0.0297s/iter; left time: 786.8547s
	iters: 3800, epoch: 4 | loss: 1.2189921
	speed: 0.0301s/iter; left time: 794.5732s
	iters: 3900, epoch: 4 | loss: 1.7015991
	speed: 0.0295s/iter; left time: 775.5030s
	iters: 4000, epoch: 4 | loss: 1.8867085
	speed: 0.0303s/iter; left time: 793.1781s
	iters: 4100, epoch: 4 | loss: 1.4509951
	speed: 0.0299s/iter; left time: 781.8673s
	iters: 4200, epoch: 4 | loss: 1.6648349
	speed: 0.0299s/iter; left time: 778.4861s
	iters: 4300, epoch: 4 | loss: 1.8115239
	speed: 0.0299s/iter; left time: 773.7210s
Epoch: 4 cost time: 129.0768039226532
Epoch: 4, Steps: 4316 | Train Loss: 1.7362142 Vali Loss: 0.8546352 Test Loss: 1.7332681
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 2.0551114
	speed: 0.4302s/iter; left time: 11097.2022s
	iters: 200, epoch: 5 | loss: 1.6385503
	speed: 0.0249s/iter; left time: 640.7284s
	iters: 300, epoch: 5 | loss: 1.5521284
	speed: 0.0203s/iter; left time: 518.6709s
	iters: 400, epoch: 5 | loss: 1.6057593
	speed: 0.0274s/iter; left time: 698.6578s
	iters: 500, epoch: 5 | loss: 2.0511010
	speed: 0.0251s/iter; left time: 637.2594s
	iters: 600, epoch: 5 | loss: 1.9564711
	speed: 0.0215s/iter; left time: 544.6136s
	iters: 700, epoch: 5 | loss: 1.9927925
	speed: 0.0293s/iter; left time: 738.3383s
	iters: 800, epoch: 5 | loss: 1.8611225
	speed: 0.0302s/iter; left time: 758.5880s
	iters: 900, epoch: 5 | loss: 1.7699873
	speed: 0.0295s/iter; left time: 736.6522s
	iters: 1000, epoch: 5 | loss: 1.7346389
	speed: 0.0301s/iter; left time: 748.1645s
	iters: 1100, epoch: 5 | loss: 1.7336067
	speed: 0.0299s/iter; left time: 741.9188s
	iters: 1200, epoch: 5 | loss: 2.2949684
	speed: 0.0299s/iter; left time: 738.2741s
	iters: 1300, epoch: 5 | loss: 1.4690702
	speed: 0.0293s/iter; left time: 720.1465s
	iters: 1400, epoch: 5 | loss: 1.6817418
	speed: 0.0304s/iter; left time: 744.7340s
	iters: 1500, epoch: 5 | loss: 1.8194208
	speed: 0.0304s/iter; left time: 741.1131s
	iters: 1600, epoch: 5 | loss: 1.6293864
	speed: 0.0304s/iter; left time: 739.3892s
	iters: 1700, epoch: 5 | loss: 1.6352201
	speed: 0.0300s/iter; left time: 725.2389s
	iters: 1800, epoch: 5 | loss: 2.1839485
	speed: 0.0303s/iter; left time: 731.2911s
	iters: 1900, epoch: 5 | loss: 1.5738328
	speed: 0.0304s/iter; left time: 728.8039s
	iters: 2000, epoch: 5 | loss: 1.7957436
	speed: 0.0294s/iter; left time: 701.4366s
	iters: 2100, epoch: 5 | loss: 1.5064212
	speed: 0.0293s/iter; left time: 696.4811s
	iters: 2200, epoch: 5 | loss: 1.4551960
	speed: 0.0298s/iter; left time: 706.5545s
	iters: 2300, epoch: 5 | loss: 1.8772227
	speed: 0.0289s/iter; left time: 682.1679s
	iters: 2400, epoch: 5 | loss: 2.0360467
	speed: 0.0304s/iter; left time: 713.3339s
	iters: 2500, epoch: 5 | loss: 1.7825810
	speed: 0.0297s/iter; left time: 695.7447s
	iters: 2600, epoch: 5 | loss: 2.0084283
	speed: 0.0300s/iter; left time: 697.8768s
	iters: 2700, epoch: 5 | loss: 2.0613742
	speed: 0.0298s/iter; left time: 690.1843s
	iters: 2800, epoch: 5 | loss: 1.8395700
	speed: 0.0300s/iter; left time: 691.7728s
	iters: 2900, epoch: 5 | loss: 1.6026124
	speed: 0.0296s/iter; left time: 679.6843s
	iters: 3000, epoch: 5 | loss: 1.5273262
	speed: 0.0302s/iter; left time: 690.7906s
	iters: 3100, epoch: 5 | loss: 1.6614702
	speed: 0.0300s/iter; left time: 682.8789s
	iters: 3200, epoch: 5 | loss: 1.8410228
	speed: 0.0304s/iter; left time: 688.8632s
	iters: 3300, epoch: 5 | loss: 1.7241999
	speed: 0.0302s/iter; left time: 683.1034s
	iters: 3400, epoch: 5 | loss: 1.6569608
	speed: 0.0298s/iter; left time: 670.4893s
	iters: 3500, epoch: 5 | loss: 1.5034900
	speed: 0.0300s/iter; left time: 671.4124s
	iters: 3600, epoch: 5 | loss: 1.7662072
	speed: 0.0300s/iter; left time: 668.6956s
	iters: 3700, epoch: 5 | loss: 1.8633219
	speed: 0.0302s/iter; left time: 670.7557s
	iters: 3800, epoch: 5 | loss: 1.9800910
	speed: 0.0296s/iter; left time: 655.1722s
	iters: 3900, epoch: 5 | loss: 1.7645432
	speed: 0.0302s/iter; left time: 664.7016s
	iters: 4000, epoch: 5 | loss: 1.6648762
	speed: 0.0298s/iter; left time: 652.9489s
	iters: 4100, epoch: 5 | loss: 1.6969453
	speed: 0.0296s/iter; left time: 645.1730s
	iters: 4200, epoch: 5 | loss: 1.5696536
	speed: 0.0294s/iter; left time: 637.4445s
	iters: 4300, epoch: 5 | loss: 1.2795776
	speed: 0.0302s/iter; left time: 651.9941s
Epoch: 5 cost time: 125.94785642623901
Epoch: 5, Steps: 4316 | Train Loss: 1.7327130 Vali Loss: 0.8599979 Test Loss: 1.7431263
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.6569674
	speed: 0.4330s/iter; left time: 9302.2855s
	iters: 200, epoch: 6 | loss: 2.0261672
	speed: 0.0295s/iter; left time: 630.2993s
	iters: 300, epoch: 6 | loss: 2.0192373
	speed: 0.0296s/iter; left time: 629.0235s
	iters: 400, epoch: 6 | loss: 1.7321130
	speed: 0.0303s/iter; left time: 641.5884s
	iters: 500, epoch: 6 | loss: 1.2288636
	speed: 0.0295s/iter; left time: 621.3384s
	iters: 600, epoch: 6 | loss: 2.0250244
	speed: 0.0290s/iter; left time: 608.6700s
	iters: 700, epoch: 6 | loss: 1.8007144
	speed: 0.0303s/iter; left time: 631.7126s
	iters: 800, epoch: 6 | loss: 1.6279175
	speed: 0.0302s/iter; left time: 628.5444s
	iters: 900, epoch: 6 | loss: 1.5130553
	speed: 0.0297s/iter; left time: 613.5452s
	iters: 1000, epoch: 6 | loss: 1.5776165
	speed: 0.0296s/iter; left time: 608.8042s
	iters: 1100, epoch: 6 | loss: 1.8614835
	speed: 0.0295s/iter; left time: 604.2444s
	iters: 1200, epoch: 6 | loss: 1.4938136
	speed: 0.0295s/iter; left time: 600.8024s
	iters: 1300, epoch: 6 | loss: 1.6143649
	speed: 0.0301s/iter; left time: 610.2241s
	iters: 1400, epoch: 6 | loss: 1.8495240
	speed: 0.0304s/iter; left time: 614.3317s
	iters: 1500, epoch: 6 | loss: 1.9430702
	speed: 0.0297s/iter; left time: 597.3316s
	iters: 1600, epoch: 6 | loss: 1.7500317
	speed: 0.0298s/iter; left time: 596.1124s
	iters: 1700, epoch: 6 | loss: 1.7288417
	speed: 0.0297s/iter; left time: 589.4882s
	iters: 1800, epoch: 6 | loss: 1.9979261
	speed: 0.0301s/iter; left time: 596.2959s
	iters: 1900, epoch: 6 | loss: 1.4097857
	speed: 0.0303s/iter; left time: 596.9746s
	iters: 2000, epoch: 6 | loss: 1.5284762
	speed: 0.0299s/iter; left time: 586.4000s
	iters: 2100, epoch: 6 | loss: 1.5141945
	speed: 0.0304s/iter; left time: 591.3301s
	iters: 2200, epoch: 6 | loss: 1.5582503
	speed: 0.0294s/iter; left time: 570.0278s
	iters: 2300, epoch: 6 | loss: 1.4359436
	speed: 0.0304s/iter; left time: 586.0115s
	iters: 2400, epoch: 6 | loss: 1.5846424
	speed: 0.0298s/iter; left time: 572.3516s
	iters: 2500, epoch: 6 | loss: 2.1894498
	speed: 0.0300s/iter; left time: 572.1182s
	iters: 2600, epoch: 6 | loss: 2.0015085
	speed: 0.0293s/iter; left time: 555.3056s
	iters: 2700, epoch: 6 | loss: 2.0444152
	speed: 0.0294s/iter; left time: 555.1022s
	iters: 2800, epoch: 6 | loss: 2.0083284
	speed: 0.0304s/iter; left time: 570.4274s
	iters: 2900, epoch: 6 | loss: 1.4305258
	speed: 0.0299s/iter; left time: 559.1412s
	iters: 3000, epoch: 6 | loss: 1.8929741
	speed: 0.0302s/iter; left time: 560.2177s
	iters: 3100, epoch: 6 | loss: 2.2208261
	speed: 0.0302s/iter; left time: 558.9997s
	iters: 3200, epoch: 6 | loss: 1.5040115
	speed: 0.0299s/iter; left time: 550.0584s
	iters: 3300, epoch: 6 | loss: 1.5041211
	speed: 0.0297s/iter; left time: 542.3612s
	iters: 3400, epoch: 6 | loss: 1.9208759
	speed: 0.0303s/iter; left time: 551.7533s
	iters: 3500, epoch: 6 | loss: 1.6199900
	speed: 0.0302s/iter; left time: 546.4506s
	iters: 3600, epoch: 6 | loss: 1.6928658
	speed: 0.0302s/iter; left time: 543.6529s
	iters: 3700, epoch: 6 | loss: 1.4663819
	speed: 0.0300s/iter; left time: 535.7271s
	iters: 3800, epoch: 6 | loss: 1.9676831
	speed: 0.0303s/iter; left time: 539.6471s
	iters: 3900, epoch: 6 | loss: 1.5114400
	speed: 0.0293s/iter; left time: 518.8769s
	iters: 4000, epoch: 6 | loss: 1.7672843
	speed: 0.0303s/iter; left time: 532.7879s
	iters: 4100, epoch: 6 | loss: 1.7722812
	speed: 0.0296s/iter; left time: 517.2733s
	iters: 4200, epoch: 6 | loss: 1.7914273
	speed: 0.0297s/iter; left time: 515.8440s
	iters: 4300, epoch: 6 | loss: 1.5657113
	speed: 0.0299s/iter; left time: 516.2043s
Epoch: 6 cost time: 129.19569778442383
Epoch: 6, Steps: 4316 | Train Loss: 1.7344603 Vali Loss: 0.8670704 Test Loss: 1.7592789
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 90034
test shape: (9003, 1, 96, 130) (9003, 1, 96, 130)
test shape: (9003, 96, 130) (9003, 96, 130)
mse:1.8643343448638916, mae:1.1061395406723022
>>>>>>>Overall time: 1116 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
