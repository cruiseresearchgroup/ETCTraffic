Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=151, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems03_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1393956
val 18864
test 248061
	iters: 100, epoch: 1 | loss: 2.1876843
	speed: 0.0338s/iter; left time: 2942.2566s
	iters: 200, epoch: 1 | loss: 2.3607352
	speed: 0.0299s/iter; left time: 2601.9190s
	iters: 300, epoch: 1 | loss: 1.8618202
	speed: 0.0303s/iter; left time: 2627.8321s
	iters: 400, epoch: 1 | loss: 1.9664859
	speed: 0.0302s/iter; left time: 2622.7870s
	iters: 500, epoch: 1 | loss: 2.2156754
	speed: 0.0303s/iter; left time: 2624.0915s
	iters: 600, epoch: 1 | loss: 1.8038048
	speed: 0.0302s/iter; left time: 2608.6716s
	iters: 700, epoch: 1 | loss: 2.1937563
	speed: 0.0300s/iter; left time: 2591.9062s
	iters: 800, epoch: 1 | loss: 1.8704336
	speed: 0.0304s/iter; left time: 2623.4430s
	iters: 900, epoch: 1 | loss: 2.0608346
	speed: 0.0300s/iter; left time: 2586.4125s
	iters: 1000, epoch: 1 | loss: 1.8336034
	speed: 0.0298s/iter; left time: 2569.0541s
	iters: 1100, epoch: 1 | loss: 1.6104589
	speed: 0.0300s/iter; left time: 2583.7281s
	iters: 1200, epoch: 1 | loss: 1.8485398
	speed: 0.0304s/iter; left time: 2608.4047s
	iters: 1300, epoch: 1 | loss: 1.7550983
	speed: 0.0302s/iter; left time: 2595.4928s
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=151, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems03_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164758
val 248062
test 248061
	iters: 100, epoch: 1 | loss: 1.8443238
	speed: 0.0336s/iter; left time: 2446.0069s
	iters: 200, epoch: 1 | loss: 2.0548422
	speed: 0.0302s/iter; left time: 2191.9062s
	iters: 300, epoch: 1 | loss: 1.8989758
	speed: 0.0295s/iter; left time: 2141.3306s
	iters: 400, epoch: 1 | loss: 2.2674134
	speed: 0.0304s/iter; left time: 2198.5127s
	iters: 500, epoch: 1 | loss: 2.2573991
	speed: 0.0301s/iter; left time: 2172.4137s
	iters: 600, epoch: 1 | loss: 1.8523749
	speed: 0.0300s/iter; left time: 2166.1830s
	iters: 700, epoch: 1 | loss: 2.3658378
	speed: 0.0297s/iter; left time: 2141.0398s
	iters: 800, epoch: 1 | loss: 2.6421449
	speed: 0.0303s/iter; left time: 2180.0700s
	iters: 900, epoch: 1 | loss: 2.1510322
	speed: 0.0301s/iter; left time: 2162.5050s
	iters: 1000, epoch: 1 | loss: 2.2072513
	speed: 0.0300s/iter; left time: 2156.4313s
	iters: 1100, epoch: 1 | loss: 1.8338712
	speed: 0.0299s/iter; left time: 2141.2517s
	iters: 1200, epoch: 1 | loss: 2.4006984
	speed: 0.0301s/iter; left time: 2152.5691s
	iters: 1300, epoch: 1 | loss: 2.2051778
	speed: 0.0302s/iter; left time: 2159.2225s
	iters: 1400, epoch: 1 | loss: 2.5189891
	speed: 0.0301s/iter; left time: 2149.7401s
	iters: 1500, epoch: 1 | loss: 1.8140982
	speed: 0.0294s/iter; left time: 2096.2531s
	iters: 1600, epoch: 1 | loss: 1.8444585
	speed: 0.0300s/iter; left time: 2134.8951s
	iters: 1700, epoch: 1 | loss: 1.8473502
	speed: 0.0302s/iter; left time: 2147.2012s
	iters: 1800, epoch: 1 | loss: 2.5412586
	speed: 0.0297s/iter; left time: 2106.0110s
	iters: 1900, epoch: 1 | loss: 2.5053518
	speed: 0.0301s/iter; left time: 2133.2160s
	iters: 2000, epoch: 1 | loss: 2.5115387
	speed: 0.0303s/iter; left time: 2142.5770s
	iters: 2100, epoch: 1 | loss: 2.6380112
	speed: 0.0293s/iter; left time: 2073.7692s
	iters: 2200, epoch: 1 | loss: 2.1715043
	speed: 0.0295s/iter; left time: 2081.3414s
	iters: 2300, epoch: 1 | loss: 2.0250762
	speed: 0.0302s/iter; left time: 2127.9117s
	iters: 2400, epoch: 1 | loss: 2.4061012
	speed: 0.0296s/iter; left time: 2080.5273s
	iters: 2500, epoch: 1 | loss: 2.1428676
	speed: 0.0299s/iter; left time: 2099.4197s
	iters: 2600, epoch: 1 | loss: 1.8064790
	speed: 0.0305s/iter; left time: 2139.2949s
	iters: 2700, epoch: 1 | loss: 2.2463963
	speed: 0.0304s/iter; left time: 2127.7764s
	iters: 2800, epoch: 1 | loss: 2.0851786
	speed: 0.0297s/iter; left time: 2078.8567s
	iters: 2900, epoch: 1 | loss: 2.1071501
	speed: 0.0301s/iter; left time: 2100.5332s
	iters: 3000, epoch: 1 | loss: 1.8144044
	speed: 0.0296s/iter; left time: 2065.5619s
	iters: 3100, epoch: 1 | loss: 1.8958970
	speed: 0.0303s/iter; left time: 2112.3542s
	iters: 3200, epoch: 1 | loss: 2.2415941
	speed: 0.0303s/iter; left time: 2107.2053s
	iters: 3300, epoch: 1 | loss: 2.1978867
	speed: 0.0299s/iter; left time: 2076.3600s
	iters: 3400, epoch: 1 | loss: 2.0134313
	speed: 0.0303s/iter; left time: 2105.8326s
	iters: 3500, epoch: 1 | loss: 2.1379836
	speed: 0.0301s/iter; left time: 2084.6312s
	iters: 3600, epoch: 1 | loss: 2.8510892
	speed: 0.0301s/iter; left time: 2081.0651s
	iters: 3700, epoch: 1 | loss: 2.4092617
	speed: 0.0296s/iter; left time: 2047.0196s
	iters: 3800, epoch: 1 | loss: 2.0300059
	speed: 0.0297s/iter; left time: 2048.2779s
	iters: 3900, epoch: 1 | loss: 2.1382444
	speed: 0.0296s/iter; left time: 2042.3985s
	iters: 4000, epoch: 1 | loss: 1.9858892
	speed: 0.0300s/iter; left time: 2067.0927s
	iters: 4100, epoch: 1 | loss: 1.6822144
	speed: 0.0302s/iter; left time: 2077.3642s
	iters: 4200, epoch: 1 | loss: 2.3113143
	speed: 0.0296s/iter; left time: 2028.8290s
	iters: 4300, epoch: 1 | loss: 2.0623136
	speed: 0.0301s/iter; left time: 2060.3616s
	iters: 4400, epoch: 1 | loss: 1.7077806
	speed: 0.0302s/iter; left time: 2064.8166s
	iters: 4500, epoch: 1 | loss: 2.2781234
	speed: 0.0302s/iter; left time: 2060.5931s
	iters: 4600, epoch: 1 | loss: 2.1723073
	speed: 0.0300s/iter; left time: 2048.5786s
	iters: 4700, epoch: 1 | loss: 1.8533272
	speed: 0.0301s/iter; left time: 2046.2017s
	iters: 4800, epoch: 1 | loss: 1.4932261
	speed: 0.0302s/iter; left time: 2051.5947s
	iters: 4900, epoch: 1 | loss: 2.1070192
	speed: 0.0302s/iter; left time: 2049.8443s
	iters: 5000, epoch: 1 | loss: 1.7845410
	speed: 0.0298s/iter; left time: 2023.4152s
	iters: 5100, epoch: 1 | loss: 1.8034165
	speed: 0.0300s/iter; left time: 2032.0897s
	iters: 5200, epoch: 1 | loss: 2.0032248
	speed: 0.0302s/iter; left time: 2040.7802s
	iters: 5300, epoch: 1 | loss: 1.7007281
	speed: 0.0299s/iter; left time: 2018.0068s
	iters: 5400, epoch: 1 | loss: 2.3187690
	speed: 0.0299s/iter; left time: 2012.2211s
	iters: 5500, epoch: 1 | loss: 1.8566716
	speed: 0.0299s/iter; left time: 2011.8278s
	iters: 5600, epoch: 1 | loss: 1.7619056
	speed: 0.0304s/iter; left time: 2039.5782s
	iters: 5700, epoch: 1 | loss: 1.8006293
	speed: 0.0297s/iter; left time: 1994.5462s
	iters: 5800, epoch: 1 | loss: 2.0123398
	speed: 0.0300s/iter; left time: 2010.4166s
	iters: 5900, epoch: 1 | loss: 2.5556223
	speed: 0.0299s/iter; left time: 2000.7455s
	iters: 6000, epoch: 1 | loss: 2.0183079
	speed: 0.0302s/iter; left time: 2019.9111s
	iters: 6100, epoch: 1 | loss: 2.5076032
	speed: 0.0301s/iter; left time: 2010.2600s
	iters: 6200, epoch: 1 | loss: 1.8261664
	speed: 0.0302s/iter; left time: 2011.7834s
	iters: 6300, epoch: 1 | loss: 2.2235508
	speed: 0.0300s/iter; left time: 1993.9345s
	iters: 6400, epoch: 1 | loss: 2.3494370
	speed: 0.0302s/iter; left time: 2002.8210s
	iters: 6500, epoch: 1 | loss: 2.0349183
	speed: 0.0299s/iter; left time: 1983.5973s
	iters: 6600, epoch: 1 | loss: 2.0423095
	speed: 0.0299s/iter; left time: 1981.6954s
	iters: 6700, epoch: 1 | loss: 2.0813613
	speed: 0.0296s/iter; left time: 1955.7281s
	iters: 6800, epoch: 1 | loss: 1.7920325
	speed: 0.0300s/iter; left time: 1982.8578s
	iters: 6900, epoch: 1 | loss: 1.9508804
	speed: 0.0302s/iter; left time: 1990.8058s
	iters: 7000, epoch: 1 | loss: 2.1058624
	speed: 0.0301s/iter; left time: 1981.3786s
	iters: 7100, epoch: 1 | loss: 2.2087753
	speed: 0.0299s/iter; left time: 1963.6102s
	iters: 7200, epoch: 1 | loss: 2.2263970
	speed: 0.0304s/iter; left time: 1994.3104s
Epoch: 1 cost time: 218.8353886604309
Epoch: 1, Steps: 7279 | Train Loss: 2.0717076 Vali Loss: 1.9689511 Test Loss: 1.8442935
Validation loss decreased (inf --> 1.968951).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.8465027
	speed: 1.1562s/iter; left time: 75627.1794s
	iters: 200, epoch: 2 | loss: 2.0556452
	speed: 0.0302s/iter; left time: 1970.9829s
	iters: 300, epoch: 2 | loss: 2.1473682
	speed: 0.0299s/iter; left time: 1951.5068s
	iters: 400, epoch: 2 | loss: 2.3673792
	speed: 0.0300s/iter; left time: 1952.2354s
	iters: 500, epoch: 2 | loss: 1.9892037
	speed: 0.0298s/iter; left time: 1934.9058s
	iters: 600, epoch: 2 | loss: 1.8888001
	speed: 0.0302s/iter; left time: 1960.6846s
	iters: 700, epoch: 2 | loss: 1.9213843
	speed: 0.0299s/iter; left time: 1940.5879s
	iters: 800, epoch: 2 | loss: 2.3524613
	speed: 0.0302s/iter; left time: 1953.3489s
	iters: 900, epoch: 2 | loss: 2.2842307
	speed: 0.0297s/iter; left time: 1916.7531s
	iters: 1000, epoch: 2 | loss: 1.8490738
	speed: 0.0301s/iter; left time: 1939.2241s
	iters: 1100, epoch: 2 | loss: 2.0117910
	speed: 0.0302s/iter; left time: 1944.2970s
	iters: 1200, epoch: 2 | loss: 1.9570254
	speed: 0.0304s/iter; left time: 1952.8671s
	iters: 1300, epoch: 2 | loss: 2.0904622
	speed: 0.0303s/iter; left time: 1945.9690s
	iters: 1400, epoch: 2 | loss: 2.0337589
	speed: 0.0303s/iter; left time: 1941.3125s
	iters: 1500, epoch: 2 | loss: 1.8930629
	speed: 0.0296s/iter; left time: 1893.2281s
	iters: 1600, epoch: 2 | loss: 1.7140179
	speed: 0.0301s/iter; left time: 1923.8763s
	iters: 1700, epoch: 2 | loss: 1.8126608
	speed: 0.0302s/iter; left time: 1930.1997s
	iters: 1800, epoch: 2 | loss: 1.8183864
	speed: 0.0303s/iter; left time: 1929.8321s
	iters: 1900, epoch: 2 | loss: 1.8801517
	speed: 0.0303s/iter; left time: 1928.9708s
	iters: 2000, epoch: 2 | loss: 1.9657528
	speed: 0.0304s/iter; left time: 1930.1683s
	iters: 2100, epoch: 2 | loss: 1.9501148
	speed: 0.0304s/iter; left time: 1929.2065s
	iters: 2200, epoch: 2 | loss: 1.9504373
	speed: 0.0300s/iter; left time: 1899.0486s
	iters: 2300, epoch: 2 | loss: 1.9252750
	speed: 0.0299s/iter; left time: 1892.7611s
	iters: 2400, epoch: 2 | loss: 1.9338268
	speed: 0.0302s/iter; left time: 1907.3360s
	iters: 2500, epoch: 2 | loss: 2.0106809
	speed: 0.0302s/iter; left time: 1901.4054s
	iters: 2600, epoch: 2 | loss: 2.5567105
	speed: 0.0300s/iter; left time: 1884.6843s
	iters: 2700, epoch: 2 | loss: 2.0888057
	speed: 0.0301s/iter; left time: 1891.1477s
	iters: 2800, epoch: 2 | loss: 1.7257268
	speed: 0.0299s/iter; left time: 1872.2223s
	iters: 2900, epoch: 2 | loss: 2.2074754
	speed: 0.0304s/iter; left time: 1903.4082s
	iters: 3000, epoch: 2 | loss: 2.1166327
	speed: 0.0303s/iter; left time: 1893.0693s
	iters: 3100, epoch: 2 | loss: 2.0240724
	speed: 0.0297s/iter; left time: 1852.9330s
	iters: 3200, epoch: 2 | loss: 2.0472765
	speed: 0.0300s/iter; left time: 1866.4981s
	iters: 3300, epoch: 2 | loss: 1.9832405
	speed: 0.0305s/iter; left time: 1900.2867s
	iters: 3400, epoch: 2 | loss: 2.4557941
	speed: 0.0303s/iter; left time: 1879.9605s
	iters: 3500, epoch: 2 | loss: 1.7110946
	speed: 0.0302s/iter; left time: 1873.9375s
	iters: 3600, epoch: 2 | loss: 2.0401351
	speed: 0.0302s/iter; left time: 1871.9419s
	iters: 3700, epoch: 2 | loss: 2.0294235
	speed: 0.0304s/iter; left time: 1879.5515s
	iters: 3800, epoch: 2 | loss: 2.3721063
	speed: 0.0299s/iter; left time: 1843.9332s
	iters: 3900, epoch: 2 | loss: 2.0922205
	speed: 0.0301s/iter; left time: 1851.9269s
	iters: 4000, epoch: 2 | loss: 1.3592650
	speed: 0.0298s/iter; left time: 1834.0291s
	iters: 4100, epoch: 2 | loss: 2.0024061
	speed: 0.0298s/iter; left time: 1830.4757s
	iters: 4200, epoch: 2 | loss: 1.7520951
	speed: 0.0301s/iter; left time: 1847.9602s
	iters: 4300, epoch: 2 | loss: 2.1237199
	speed: 0.0296s/iter; left time: 1813.8462s
	iters: 4400, epoch: 2 | loss: 2.1200604
	speed: 0.0301s/iter; left time: 1836.9003s
	iters: 4500, epoch: 2 | loss: 2.1808169
	speed: 0.0300s/iter; left time: 1833.3857s
	iters: 4600, epoch: 2 | loss: 1.7710563
	speed: 0.0299s/iter; left time: 1822.4123s
	iters: 4700, epoch: 2 | loss: 2.3103955
	speed: 0.0300s/iter; left time: 1823.5065s
	iters: 4800, epoch: 2 | loss: 1.9848635
	speed: 0.0301s/iter; left time: 1828.1324s
	iters: 4900, epoch: 2 | loss: 2.4098046
	speed: 0.0303s/iter; left time: 1837.2419s
	iters: 5000, epoch: 2 | loss: 1.9405237
	speed: 0.0303s/iter; left time: 1833.9680s
	iters: 5100, epoch: 2 | loss: 2.2874651
	speed: 0.0302s/iter; left time: 1823.9857s
	iters: 5200, epoch: 2 | loss: 2.3770061
	speed: 0.0304s/iter; left time: 1834.5376s
	iters: 5300, epoch: 2 | loss: 1.8818498
	speed: 0.0298s/iter; left time: 1795.1508s
	iters: 5400, epoch: 2 | loss: 1.9124604
	speed: 0.0304s/iter; left time: 1827.7565s
	iters: 5500, epoch: 2 | loss: 2.6081820
	speed: 0.0300s/iter; left time: 1800.1391s
	iters: 5600, epoch: 2 | loss: 1.7913331
	speed: 0.0298s/iter; left time: 1785.8076s
	iters: 5700, epoch: 2 | loss: 2.0267086
	speed: 0.0301s/iter; left time: 1802.7606s
	iters: 5800, epoch: 2 | loss: 2.1664600
	speed: 0.0299s/iter; left time: 1785.2103s
	iters: 5900, epoch: 2 | loss: 1.8866390
	speed: 0.0301s/iter; left time: 1794.8736s
	iters: 6000, epoch: 2 | loss: 1.7952781
	speed: 0.0303s/iter; left time: 1805.4585s
	iters: 6100, epoch: 2 | loss: 1.7249568
	speed: 0.0299s/iter; left time: 1779.2767s
	iters: 6200, epoch: 2 | loss: 2.1592736
	speed: 0.0299s/iter; left time: 1775.1105s
	iters: 6300, epoch: 2 | loss: 1.9525895
	speed: 0.0302s/iter; left time: 1790.6101s
	iters: 6400, epoch: 2 | loss: 2.1221495
	speed: 0.0303s/iter; left time: 1791.8821s
	iters: 6500, epoch: 2 | loss: 1.6673251
	speed: 0.0302s/iter; left time: 1779.3292s
	iters: 6600, epoch: 2 | loss: 2.0961993
	speed: 0.0302s/iter; left time: 1781.0529s
	iters: 6700, epoch: 2 | loss: 1.8509167
	speed: 0.0302s/iter; left time: 1773.5079s
	iters: 6800, epoch: 2 | loss: 2.1824441
	speed: 0.0305s/iter; left time: 1790.6857s
	iters: 6900, epoch: 2 | loss: 2.2572374
	speed: 0.0301s/iter; left time: 1764.7716s
	iters: 7000, epoch: 2 | loss: 2.1078353
	speed: 0.0302s/iter; left time: 1769.3688s
	iters: 7100, epoch: 2 | loss: 2.4565034
	speed: 0.0301s/iter; left time: 1759.1105s
	iters: 7200, epoch: 2 | loss: 2.1508932
	speed: 0.0298s/iter; left time: 1739.2460s
Epoch: 2 cost time: 219.331725358963
Epoch: 2, Steps: 7279 | Train Loss: 2.0529447 Vali Loss: 1.9980577 Test Loss: 1.8552966
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 2.1580071
	speed: 1.1602s/iter; left time: 67447.7218s
	iters: 200, epoch: 3 | loss: 2.0182276
	speed: 0.0300s/iter; left time: 1739.1676s
	iters: 300, epoch: 3 | loss: 2.0457616
	speed: 0.0299s/iter; left time: 1734.7554s
	iters: 400, epoch: 3 | loss: 2.6024120
	speed: 0.0296s/iter; left time: 1712.6195s
	iters: 500, epoch: 3 | loss: 2.0454090
	speed: 0.0297s/iter; left time: 1713.6430s
	iters: 600, epoch: 3 | loss: 2.2619543
	speed: 0.0302s/iter; left time: 1742.7706s
	iters: 700, epoch: 3 | loss: 2.2915282
	speed: 0.0300s/iter; left time: 1726.8149s
	iters: 800, epoch: 3 | loss: 2.0829487
	speed: 0.0299s/iter; left time: 1715.6923s
	iters: 900, epoch: 3 | loss: 2.2496946
	speed: 0.0300s/iter; left time: 1721.9582s
	iters: 1000, epoch: 3 | loss: 2.2920837
	speed: 0.0300s/iter; left time: 1714.7826s
	iters: 1100, epoch: 3 | loss: 2.2021542
	speed: 0.0302s/iter; left time: 1726.9189s
	iters: 1200, epoch: 3 | loss: 1.8021803
	speed: 0.0301s/iter; left time: 1717.2889s
	iters: 1300, epoch: 3 | loss: 2.5238242
	speed: 0.0304s/iter; left time: 1729.4994s
	iters: 1400, epoch: 3 | loss: 1.4043537
	speed: 0.0299s/iter; left time: 1699.0491s
	iters: 1500, epoch: 3 | loss: 1.9766060
	speed: 0.0299s/iter; left time: 1697.2001s
	iters: 1600, epoch: 3 | loss: 2.5567784
	speed: 0.0304s/iter; left time: 1722.9328s
	iters: 1700, epoch: 3 | loss: 2.1097803
	speed: 0.0298s/iter; left time: 1684.3066s
	iters: 1800, epoch: 3 | loss: 1.9274094
	speed: 0.0303s/iter; left time: 1710.8325s
	iters: 1900, epoch: 3 | loss: 2.0591958
	speed: 0.0293s/iter; left time: 1651.6455s
	iters: 2000, epoch: 3 | loss: 1.9323493
	speed: 0.0301s/iter; left time: 1694.3900s
	iters: 2100, epoch: 3 | loss: 1.5629425
	speed: 0.0303s/iter; left time: 1699.1874s
	iters: 2200, epoch: 3 | loss: 1.8251266
	speed: 0.0297s/iter; left time: 1665.3438s
	iters: 2300, epoch: 3 | loss: 2.3608162
	speed: 0.0300s/iter; left time: 1677.1140s
	iters: 2400, epoch: 3 | loss: 2.2319171
	speed: 0.0298s/iter; left time: 1665.7536s
	iters: 2500, epoch: 3 | loss: 2.4129572
	speed: 0.0302s/iter; left time: 1682.8288s
	iters: 2600, epoch: 3 | loss: 1.7243133
	speed: 0.0301s/iter; left time: 1672.5820s
	iters: 2700, epoch: 3 | loss: 1.9217668
	speed: 0.0302s/iter; left time: 1676.0080s
	iters: 2800, epoch: 3 | loss: 2.3712847
	speed: 0.0303s/iter; left time: 1680.0564s
	iters: 2900, epoch: 3 | loss: 2.1617427
	speed: 0.0300s/iter; left time: 1660.8306s
	iters: 3000, epoch: 3 | loss: 1.7746582
	speed: 0.0305s/iter; left time: 1682.8044s
	iters: 3100, epoch: 3 | loss: 1.8862925
	speed: 0.0303s/iter; left time: 1669.7588s
	iters: 3200, epoch: 3 | loss: 2.0869629
	speed: 0.0302s/iter; left time: 1662.8086s
	iters: 3300, epoch: 3 | loss: 1.8788987
	speed: 0.0305s/iter; left time: 1675.3522s
	iters: 3400, epoch: 3 | loss: 1.8538198
	speed: 0.0300s/iter; left time: 1644.6725s
	iters: 3500, epoch: 3 | loss: 1.9427208
	speed: 0.0302s/iter; left time: 1655.5111s
	iters: 3600, epoch: 3 | loss: 2.0308623
	speed: 0.0303s/iter; left time: 1653.2645s
	iters: 3700, epoch: 3 | loss: 2.3521419
	speed: 0.0299s/iter; left time: 1630.9966s
	iters: 3800, epoch: 3 | loss: 2.4944525
	speed: 0.0302s/iter; left time: 1644.3696s
	iters: 3900, epoch: 3 | loss: 2.0357103
	speed: 0.0299s/iter; left time: 1625.6351s
	iters: 4000, epoch: 3 | loss: 1.9349035
	speed: 0.0304s/iter; left time: 1650.2326s
	iters: 4100, epoch: 3 | loss: 2.1449170
	speed: 0.0300s/iter; left time: 1624.3851s
	iters: 4200, epoch: 3 | loss: 2.1041505
	speed: 0.0298s/iter; left time: 1611.0080s
	iters: 4300, epoch: 3 | loss: 1.8919672
	speed: 0.0299s/iter; left time: 1611.5332s
	iters: 4400, epoch: 3 | loss: 2.0095942
	speed: 0.0296s/iter; left time: 1592.5766s
	iters: 4500, epoch: 3 | loss: 1.9402509
	speed: 0.0302s/iter; left time: 1625.3138s
	iters: 4600, epoch: 3 | loss: 1.8878403
	speed: 0.0302s/iter; left time: 1622.0242s
	iters: 4700, epoch: 3 | loss: 2.1921246
	speed: 0.0304s/iter; left time: 1627.6614s
	iters: 4800, epoch: 3 | loss: 2.2570417
	speed: 0.0305s/iter; left time: 1628.9007s
	iters: 4900, epoch: 3 | loss: 1.5968666
	speed: 0.0301s/iter; left time: 1604.9123s
	iters: 5000, epoch: 3 | loss: 2.1531212
	speed: 0.0299s/iter; left time: 1592.7239s
	iters: 5100, epoch: 3 | loss: 2.0237629
	speed: 0.0303s/iter; left time: 1610.1000s
	iters: 5200, epoch: 3 | loss: 2.4792964
	speed: 0.0300s/iter; left time: 1591.7072s
	iters: 5300, epoch: 3 | loss: 2.0351238
	speed: 0.0302s/iter; left time: 1597.8205s
	iters: 5400, epoch: 3 | loss: 2.0932605
	speed: 0.0303s/iter; left time: 1598.2755s
	iters: 5500, epoch: 3 | loss: 2.0692317
	speed: 0.0302s/iter; left time: 1592.1225s
	iters: 5600, epoch: 3 | loss: 2.0604794
	speed: 0.0303s/iter; left time: 1595.4840s
	iters: 5700, epoch: 3 | loss: 2.2024591
	speed: 0.0303s/iter; left time: 1589.9618s
	iters: 5800, epoch: 3 | loss: 1.8782383
	speed: 0.0305s/iter; left time: 1596.6283s
	iters: 5900, epoch: 3 | loss: 2.7076836
	speed: 0.0298s/iter; left time: 1561.1080s
	iters: 6000, epoch: 3 | loss: 1.9739376
	speed: 0.0302s/iter; left time: 1579.0327s
	iters: 6100, epoch: 3 | loss: 2.1577067
	speed: 0.0303s/iter; left time: 1577.2521s
	iters: 6200, epoch: 3 | loss: 1.7662009
	speed: 0.0304s/iter; left time: 1582.2044s
	iters: 6300, epoch: 3 | loss: 2.3377430
	speed: 0.0301s/iter; left time: 1564.0409s
	iters: 6400, epoch: 3 | loss: 2.4300261
	speed: 0.0304s/iter; left time: 1576.5201s
	iters: 6500, epoch: 3 | loss: 1.9739873
	speed: 0.0303s/iter; left time: 1567.1170s
	iters: 6600, epoch: 3 | loss: 2.1076813
	speed: 0.0301s/iter; left time: 1553.1474s
	iters: 6700, epoch: 3 | loss: 1.9381675
	speed: 0.0297s/iter; left time: 1528.4785s
	iters: 6800, epoch: 3 | loss: 2.2302501
	speed: 0.0299s/iter; left time: 1540.3569s
	iters: 6900, epoch: 3 | loss: 1.9371750
	speed: 0.0302s/iter; left time: 1549.6921s
	iters: 7000, epoch: 3 | loss: 2.5748589
	speed: 0.0300s/iter; left time: 1537.5019s
	iters: 7100, epoch: 3 | loss: 2.0452654
	speed: 0.0302s/iter; left time: 1543.9178s
	iters: 7200, epoch: 3 | loss: 1.4579501
	speed: 0.0302s/iter; left time: 1543.7246s
Epoch: 3 cost time: 219.27323412895203
Epoch: 3, Steps: 7279 | Train Loss: 2.0649047 Vali Loss: 2.0258446 Test Loss: 1.8607445
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.8286172
	speed: 1.1657s/iter; left time: 59280.6390s
	iters: 200, epoch: 4 | loss: 2.1523442
	speed: 0.0299s/iter; left time: 1516.8593s
	iters: 300, epoch: 4 | loss: 1.8774741
	speed: 0.0301s/iter; left time: 1522.7636s
	iters: 400, epoch: 4 | loss: 1.9861772
	speed: 0.0300s/iter; left time: 1518.8833s
	iters: 500, epoch: 4 | loss: 1.9815708
	speed: 0.0300s/iter; left time: 1515.0642s
	iters: 600, epoch: 4 | loss: 1.9555707
	speed: 0.0300s/iter; left time: 1511.4703s
	iters: 700, epoch: 4 | loss: 1.9114022
	speed: 0.0301s/iter; left time: 1511.5941s
	iters: 800, epoch: 4 | loss: 2.0564587
	speed: 0.0304s/iter; left time: 1526.5442s
	iters: 900, epoch: 4 | loss: 2.0037494
	speed: 0.0297s/iter; left time: 1485.2986s
	iters: 1000, epoch: 4 | loss: 1.9836242
	speed: 0.0298s/iter; left time: 1489.3775s
	iters: 1100, epoch: 4 | loss: 1.4285241
	speed: 0.0303s/iter; left time: 1510.6703s
	iters: 1200, epoch: 4 | loss: 2.2113433
	speed: 0.0302s/iter; left time: 1501.7901s
	iters: 1300, epoch: 4 | loss: 2.1079168
	speed: 0.0299s/iter; left time: 1485.7862s
	iters: 1400, epoch: 4 | loss: 1.9549974
	speed: 0.0303s/iter; left time: 1501.4752s
	iters: 1500, epoch: 4 | loss: 2.2214706
	speed: 0.0301s/iter; left time: 1488.8005s
	iters: 1600, epoch: 4 | loss: 1.7813880
	speed: 0.0302s/iter; left time: 1489.0702s
	iters: 1700, epoch: 4 | loss: 1.9279804
	speed: 0.0304s/iter; left time: 1496.6353s
	iters: 1800, epoch: 4 | loss: 1.9287875
	speed: 0.0300s/iter; left time: 1473.8529s
	iters: 1900, epoch: 4 | loss: 1.9049814
	speed: 0.0301s/iter; left time: 1474.6470s
	iters: 2000, epoch: 4 | loss: 2.1353531
	speed: 0.0301s/iter; left time: 1472.6417s
	iters: 2100, epoch: 4 | loss: 2.1158688
	speed: 0.0302s/iter; left time: 1473.7691s
	iters: 2200, epoch: 4 | loss: 1.9221561
	speed: 0.0304s/iter; left time: 1480.5053s
	iters: 2300, epoch: 4 | loss: 2.3531680
	speed: 0.0293s/iter; left time: 1424.8474s
	iters: 2400, epoch: 4 | loss: 2.0728250
	speed: 0.0303s/iter; left time: 1471.2294s
	iters: 2500, epoch: 4 | loss: 1.9546945
	speed: 0.0302s/iter; left time: 1461.4022s
	iters: 2600, epoch: 4 | loss: 1.6518986
	speed: 0.0303s/iter; left time: 1463.7831s
	iters: 2700, epoch: 4 | loss: 1.7096618
	speed: 0.0298s/iter; left time: 1439.3017s
	iters: 2800, epoch: 4 | loss: 2.1276693
	speed: 0.0297s/iter; left time: 1431.3047s
	iters: 2900, epoch: 4 | loss: 2.1852648
	speed: 0.0295s/iter; left time: 1415.3323s
	iters: 3000, epoch: 4 | loss: 2.2124269
	speed: 0.0297s/iter; left time: 1425.4811s
	iters: 3100, epoch: 4 | loss: 2.2837620
	speed: 0.0303s/iter; left time: 1449.2860s
	iters: 3200, epoch: 4 | loss: 2.3569024
	speed: 0.0301s/iter; left time: 1436.7329s
	iters: 3300, epoch: 4 | loss: 2.3460371
	speed: 0.0301s/iter; left time: 1436.3638s
	iters: 3400, epoch: 4 | loss: 2.0395341
	speed: 0.0301s/iter; left time: 1431.8470s
	iters: 3500, epoch: 4 | loss: 1.9117739
	speed: 0.0298s/iter; left time: 1413.1002s
	iters: 3600, epoch: 4 | loss: 1.9852401
	speed: 0.0301s/iter; left time: 1424.0249s
	iters: 3700, epoch: 4 | loss: 2.3469408
	speed: 0.0298s/iter; left time: 1408.1606s
	iters: 3800, epoch: 4 | loss: 2.6067429
	speed: 0.0305s/iter; left time: 1437.2702s
	iters: 3900, epoch: 4 | loss: 1.9279050
	speed: 0.0302s/iter; left time: 1419.8822s
	iters: 4000, epoch: 4 | loss: 1.8393822
	speed: 0.0302s/iter; left time: 1419.4068s
	iters: 4100, epoch: 4 | loss: 2.2141871
	speed: 0.0301s/iter; left time: 1411.4570s
	iters: 4200, epoch: 4 | loss: 1.7468895
	speed: 0.0302s/iter; left time: 1410.8968s
	iters: 4300, epoch: 4 | loss: 1.9161191
	speed: 0.0304s/iter; left time: 1418.8394s
	iters: 4400, epoch: 4 | loss: 2.4707048
	speed: 0.0303s/iter; left time: 1410.3721s
	iters: 4500, epoch: 4 | loss: 1.7691544
	speed: 0.0298s/iter; left time: 1384.1877s
	iters: 4600, epoch: 4 | loss: 2.3883734
	speed: 0.0299s/iter; left time: 1384.3361s
	iters: 4700, epoch: 4 | loss: 2.2097330
	speed: 0.0301s/iter; left time: 1392.1354s
	iters: 4800, epoch: 4 | loss: 1.9636551
	speed: 0.0302s/iter; left time: 1394.8717s
	iters: 4900, epoch: 4 | loss: 2.0093226
	speed: 0.0302s/iter; left time: 1389.5441s
	iters: 5000, epoch: 4 | loss: 2.1735175
	speed: 0.0303s/iter; left time: 1392.7402s
	iters: 5100, epoch: 4 | loss: 2.0712719
	speed: 0.0303s/iter; left time: 1388.4855s
	iters: 5200, epoch: 4 | loss: 2.1481805
	speed: 0.0300s/iter; left time: 1372.8748s
	iters: 5300, epoch: 4 | loss: 1.9461783
	speed: 0.0301s/iter; left time: 1372.7377s
	iters: 5400, epoch: 4 | loss: 1.9062099
	speed: 0.0300s/iter; left time: 1366.4145s
	iters: 5500, epoch: 4 | loss: 2.3664165
	speed: 0.0303s/iter; left time: 1378.6896s
	iters: 5600, epoch: 4 | loss: 2.5076795
	speed: 0.0303s/iter; left time: 1376.2872s
	iters: 5700, epoch: 4 | loss: 2.2297940
	speed: 0.0301s/iter; left time: 1360.6939s
	iters: 5800, epoch: 4 | loss: 2.5896785
	speed: 0.0298s/iter; left time: 1346.6581s
	iters: 5900, epoch: 4 | loss: 2.0240476
	speed: 0.0302s/iter; left time: 1359.2425s
	iters: 6000, epoch: 4 | loss: 2.1402583
	speed: 0.0301s/iter; left time: 1354.1426s
	iters: 6100, epoch: 4 | loss: 2.3022127
	speed: 0.0301s/iter; left time: 1350.7057s
	iters: 6200, epoch: 4 | loss: 2.0808496
	speed: 0.0304s/iter; left time: 1358.3053s
	iters: 6300, epoch: 4 | loss: 2.2132626
	speed: 0.0302s/iter; left time: 1347.0572s
	iters: 6400, epoch: 4 | loss: 2.0338392
	speed: 0.0303s/iter; left time: 1348.2116s
	iters: 6500, epoch: 4 | loss: 2.1252279
	speed: 0.0304s/iter; left time: 1352.1641s
	iters: 6600, epoch: 4 | loss: 2.2946453
	speed: 0.0304s/iter; left time: 1346.7939s
	iters: 6700, epoch: 4 | loss: 2.2131786
	speed: 0.0300s/iter; left time: 1328.3085s
	iters: 6800, epoch: 4 | loss: 2.1572366
	speed: 0.0300s/iter; left time: 1323.1992s
	iters: 6900, epoch: 4 | loss: 1.8899390
	speed: 0.0302s/iter; left time: 1330.8720s
	iters: 7000, epoch: 4 | loss: 2.1213784
	speed: 0.0305s/iter; left time: 1340.0527s
	iters: 7100, epoch: 4 | loss: 2.2027824
	speed: 0.0301s/iter; left time: 1322.1912s
	iters: 7200, epoch: 4 | loss: 1.5174342
	speed: 0.0298s/iter; left time: 1304.6160s
Epoch: 4 cost time: 219.2656216621399
Epoch: 4, Steps: 7279 | Train Loss: 2.0633851 Vali Loss: 2.0044041 Test Loss: 1.8722959
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 248061
test shape: (24806, 1, 96, 151) (24806, 1, 96, 151)
test shape: (24806, 96, 151) (24806, 96, 151)
mse:1.8443037271499634, mae:1.0479018688201904
>>>>>>>Overall time: 1533 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
