Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=521, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems11_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1480222
val 121208
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=521, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems11_all_common_flow.csv', dec_in=521, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=521, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems11_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems11_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1480222
val 121208
test 347726
	iters: 100, epoch: 1 | loss: 1.1715642
	speed: 0.1563s/iter; left time: 144538.0465s
	iters: 200, epoch: 1 | loss: 1.0435510
	speed: 0.1490s/iter; left time: 137765.3324s
	iters: 300, epoch: 1 | loss: 0.8947072
	speed: 0.1490s/iter; left time: 137767.2374s
	iters: 400, epoch: 1 | loss: 1.0016853
	speed: 0.1492s/iter; left time: 137909.3354s
	iters: 500, epoch: 1 | loss: 0.8829200
	speed: 0.1491s/iter; left time: 137815.0914s
	iters: 600, epoch: 1 | loss: 0.9408758
	speed: 0.1488s/iter; left time: 137560.3953s
	iters: 700, epoch: 1 | loss: 0.7862545
	speed: 0.1484s/iter; left time: 137184.7391s
	iters: 800, epoch: 1 | loss: 0.9595112
	speed: 0.1487s/iter; left time: 137397.2398s
	iters: 900, epoch: 1 | loss: 0.8535431
	speed: 0.1497s/iter; left time: 138296.5742s
	iters: 1000, epoch: 1 | loss: 0.6738822
	speed: 0.1492s/iter; left time: 137816.0199s
	iters: 1100, epoch: 1 | loss: 0.8110381
	speed: 0.1491s/iter; left time: 137795.5494s
	iters: 1200, epoch: 1 | loss: 0.6887836
	speed: 0.1490s/iter; left time: 137664.1638s
	iters: 1300, epoch: 1 | loss: 0.6791778
	speed: 0.1496s/iter; left time: 138176.5459s
	iters: 1400, epoch: 1 | loss: 1.0670128
	speed: 0.1488s/iter; left time: 137472.7855s
	iters: 1500, epoch: 1 | loss: 0.6583590
	speed: 0.1483s/iter; left time: 136970.7203s
	iters: 1600, epoch: 1 | loss: 0.7687034
	speed: 0.1487s/iter; left time: 137331.2039s
	iters: 1700, epoch: 1 | loss: 0.7105353
	speed: 0.1498s/iter; left time: 138299.2985s
	iters: 1800, epoch: 1 | loss: 0.6844931
	speed: 0.1496s/iter; left time: 138109.5185s
	iters: 1900, epoch: 1 | loss: 0.6777770
	speed: 0.1482s/iter; left time: 136770.7068s
	iters: 2000, epoch: 1 | loss: 0.6648759
	speed: 0.1485s/iter; left time: 137065.4804s
	iters: 2100, epoch: 1 | loss: 0.6480941
	speed: 0.1489s/iter; left time: 137428.6623s
	iters: 2200, epoch: 1 | loss: 0.5877002
	speed: 0.1486s/iter; left time: 137092.5877s
	iters: 2300, epoch: 1 | loss: 0.6140024
	speed: 0.1483s/iter; left time: 136817.3064s
	iters: 2400, epoch: 1 | loss: 0.6201715
	speed: 0.1493s/iter; left time: 137755.5987s
	iters: 2500, epoch: 1 | loss: 0.6237344
	speed: 0.1494s/iter; left time: 137842.7203s
	iters: 2600, epoch: 1 | loss: 0.6599628
	speed: 0.1485s/iter; left time: 136980.8360s
	iters: 2700, epoch: 1 | loss: 0.6106938
	speed: 0.1479s/iter; left time: 136410.4109s
	iters: 2800, epoch: 1 | loss: 0.6703297
	speed: 0.1483s/iter; left time: 136716.4328s
	iters: 2900, epoch: 1 | loss: 0.6236034
	speed: 0.1478s/iter; left time: 136327.3837s
	iters: 3000, epoch: 1 | loss: 0.5909975
	speed: 0.1481s/iter; left time: 136559.3585s
	iters: 3100, epoch: 1 | loss: 0.8139548
	speed: 0.1482s/iter; left time: 136658.7984s
	iters: 3200, epoch: 1 | loss: 0.6079617
	speed: 0.1479s/iter; left time: 136358.8592s
	iters: 3300, epoch: 1 | loss: 0.6341302
	speed: 0.1487s/iter; left time: 137054.2567s
	iters: 3400, epoch: 1 | loss: 0.6866155
	speed: 0.1489s/iter; left time: 137232.7883s
	iters: 3500, epoch: 1 | loss: 0.6006801
	speed: 0.1476s/iter; left time: 136048.9614s
	iters: 3600, epoch: 1 | loss: 0.6403102
	speed: 0.1481s/iter; left time: 136446.6495s
	iters: 3700, epoch: 1 | loss: 0.5912575
	speed: 0.1478s/iter; left time: 136169.7197s
	iters: 3800, epoch: 1 | loss: 0.6285536
	speed: 0.1487s/iter; left time: 136984.0394s
	iters: 3900, epoch: 1 | loss: 0.7941933
	speed: 0.1479s/iter; left time: 136265.4082s
	iters: 4000, epoch: 1 | loss: 0.7686155
	speed: 0.1478s/iter; left time: 136088.2037s
	iters: 4100, epoch: 1 | loss: 0.6428447
	speed: 0.1478s/iter; left time: 136144.7802s
	iters: 4200, epoch: 1 | loss: 0.8127660
	speed: 0.1491s/iter; left time: 137256.2997s
	iters: 4300, epoch: 1 | loss: 0.7304441
	speed: 0.1481s/iter; left time: 136327.2063s
	iters: 4400, epoch: 1 | loss: 0.7199923
	speed: 0.1483s/iter; left time: 136497.4106s
	iters: 4500, epoch: 1 | loss: 0.5547810
	speed: 0.1481s/iter; left time: 136329.4413s
	iters: 4600, epoch: 1 | loss: 0.6382551
	speed: 0.1481s/iter; left time: 136336.7549s
Epoch: 1 cost time: 688.3341045379639
Epoch: 1, Steps: 4625 | Train Loss: 0.7299751 Vali Loss: 0.9562451 Test Loss: 5.1136751
Validation loss decreased (inf --> 0.956245).  Saving model ...
Traceback (most recent call last):
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 372, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 493, in _save
    zip_file.write_record(name, buf_value, len(buf_value))
OSError: [Errno 122] Disk quota exceeded

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 373, in save
    return
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 259, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:274] . unexpected pos 3623424 vs 3623312

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 214, in train
    early_stopping(vali_loss, self.model, path)
  File "/g/data/hn98/du/exlts/ddd2/utils/tools.py", line 43, in __call__
    self.save_checkpoint(val_loss, model, path)
  File "/g/data/hn98/du/exlts/ddd2/utils/tools.py", line 57, in save_checkpoint
    torch.save(model.state_dict(), path + '/' + 'checkpoint.pth')
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 374, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 214, in __exit__
    self.file_like.close()
OSError: [Errno 122] Disk quota exceeded
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:274] . unexpected pos 3623424 vs 3623312
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x151bff1576a7 in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1c99500 (0x151c3e4be500 in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x1c956d3 (0x151c3e4ba6d3 in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xa9 (0x151c3e4bf609 in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0xe1 (0x151c3e4c0141 in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x115 (0x151c3e4c0935 in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x654323 (0x151c4db91323 in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x2c2b90 (0x151c4d7ffb90 in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x2c3cfe (0x151c4d800cfe in /jobfs/116443686.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #9: python() [0x4e0800]
frame #10: python() [0x4f16a8]
frame #11: python() [0x4f1691]
frame #12: python() [0x4f1691]
frame #13: python() [0x4f1691]
frame #14: python() [0x4f1691]
frame #15: python() [0x4c9280]
<omitting python frames>
frame #21: __libc_start_main + 0xe5 (0x151c5c950d85 in /lib64/libc.so.6)
frame #22: python() [0x57a64d]

