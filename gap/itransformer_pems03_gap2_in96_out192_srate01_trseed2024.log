Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=151, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems03_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164662
val 247966
test 247965
	iters: 100, epoch: 1 | loss: 1.0667069
	speed: 0.0338s/iter; left time: 2456.8384s
	iters: 200, epoch: 1 | loss: 1.8700439
	speed: 0.0304s/iter; left time: 2205.0544s
	iters: 300, epoch: 1 | loss: 1.8849925
	speed: 0.0302s/iter; left time: 2189.7023s
	iters: 400, epoch: 1 | loss: 1.7457951
	speed: 0.0303s/iter; left time: 2194.5089s
	iters: 500, epoch: 1 | loss: 1.9048034
	speed: 0.0302s/iter; left time: 2180.4184s
	iters: 600, epoch: 1 | loss: 1.6266880
	speed: 0.0303s/iter; left time: 2189.3623s
	iters: 700, epoch: 1 | loss: 1.8108772
	speed: 0.0303s/iter; left time: 2187.3909s
	iters: 800, epoch: 1 | loss: 1.7745167
	speed: 0.0304s/iter; left time: 2185.3996s
	iters: 900, epoch: 1 | loss: 1.7968650
	speed: 0.0304s/iter; left time: 2183.8599s
	iters: 1000, epoch: 1 | loss: 1.8527721
	speed: 0.0303s/iter; left time: 2172.7098s
	iters: 1100, epoch: 1 | loss: 1.7530477
	speed: 0.0301s/iter; left time: 2161.2420s
	iters: 1200, epoch: 1 | loss: 1.9272968
	speed: 0.0304s/iter; left time: 2175.4626s
	iters: 1300, epoch: 1 | loss: 1.6428013
	speed: 0.0303s/iter; left time: 2168.8453s
	iters: 1400, epoch: 1 | loss: 1.9456456
	speed: 0.0300s/iter; left time: 2138.6749s
	iters: 1500, epoch: 1 | loss: 1.3037293
	speed: 0.0302s/iter; left time: 2150.0480s
	iters: 1600, epoch: 1 | loss: 1.9421551
	speed: 0.0298s/iter; left time: 2121.2788s
	iters: 1700, epoch: 1 | loss: 1.7508688
	speed: 0.0304s/iter; left time: 2161.4857s
	iters: 1800, epoch: 1 | loss: 1.7708794
	speed: 0.0299s/iter; left time: 2121.3584s
	iters: 1900, epoch: 1 | loss: 1.7082154
	speed: 0.0304s/iter; left time: 2155.7653s
	iters: 2000, epoch: 1 | loss: 2.1004441
	speed: 0.0301s/iter; left time: 2131.1051s
	iters: 2100, epoch: 1 | loss: 1.6592379
	speed: 0.0293s/iter; left time: 2073.6361s
	iters: 2200, epoch: 1 | loss: 1.8367963
	speed: 0.0304s/iter; left time: 2143.2232s
	iters: 2300, epoch: 1 | loss: 1.7094082
	speed: 0.0301s/iter; left time: 2118.8944s
	iters: 2400, epoch: 1 | loss: 1.9303970
	speed: 0.0301s/iter; left time: 2118.5706s
	iters: 2500, epoch: 1 | loss: 1.6513704
	speed: 0.0304s/iter; left time: 2136.9550s
	iters: 2600, epoch: 1 | loss: 1.7798079
	speed: 0.0298s/iter; left time: 2089.7804s
	iters: 2700, epoch: 1 | loss: 1.6949388
	speed: 0.0302s/iter; left time: 2114.7390s
	iters: 2800, epoch: 1 | loss: 1.7130185
	speed: 0.0302s/iter; left time: 2113.5904s
	iters: 2900, epoch: 1 | loss: 1.5024107
	speed: 0.0302s/iter; left time: 2111.2356s
	iters: 3000, epoch: 1 | loss: 1.7319967
	speed: 0.0305s/iter; left time: 2128.8578s
	iters: 3100, epoch: 1 | loss: 1.7685878
	speed: 0.0301s/iter; left time: 2096.8693s
	iters: 3200, epoch: 1 | loss: 1.8170236
	speed: 0.0302s/iter; left time: 2105.0792s
	iters: 3300, epoch: 1 | loss: 1.8305944
	speed: 0.0304s/iter; left time: 2111.1746s
	iters: 3400, epoch: 1 | loss: 1.7343564
	speed: 0.0304s/iter; left time: 2109.6005s
	iters: 3500, epoch: 1 | loss: 1.7293092
	speed: 0.0299s/iter; left time: 2070.9470s
	iters: 3600, epoch: 1 | loss: 1.6415023
	speed: 0.0302s/iter; left time: 2090.2850s
	iters: 3700, epoch: 1 | loss: 1.8275570
	speed: 0.0299s/iter; left time: 2064.4674s
	iters: 3800, epoch: 1 | loss: 1.8562675
	speed: 0.0302s/iter; left time: 2085.2384s
	iters: 3900, epoch: 1 | loss: 1.7061268
	speed: 0.0295s/iter; left time: 2031.2205s
	iters: 4000, epoch: 1 | loss: 1.7842263
	speed: 0.0301s/iter; left time: 2069.8232s
	iters: 4100, epoch: 1 | loss: 1.6929808
	speed: 0.0303s/iter; left time: 2082.1458s
	iters: 4200, epoch: 1 | loss: 1.6900419
	speed: 0.0304s/iter; left time: 2086.6746s
	iters: 4300, epoch: 1 | loss: 2.0303299
	speed: 0.0303s/iter; left time: 2072.9490s
	iters: 4400, epoch: 1 | loss: 1.7701870
	speed: 0.0302s/iter; left time: 2068.5831s
	iters: 4500, epoch: 1 | loss: 2.0839603
	speed: 0.0303s/iter; left time: 2067.7122s
	iters: 4600, epoch: 1 | loss: 1.7220680
	speed: 0.0303s/iter; left time: 2066.6911s
	iters: 4700, epoch: 1 | loss: 1.6018292
	speed: 0.0301s/iter; left time: 2050.5456s
	iters: 4800, epoch: 1 | loss: 1.8663404
	speed: 0.0304s/iter; left time: 2069.1170s
	iters: 4900, epoch: 1 | loss: 1.6960552
	speed: 0.0303s/iter; left time: 2057.2912s
	iters: 5000, epoch: 1 | loss: 1.8218000
	speed: 0.0301s/iter; left time: 2037.9581s
	iters: 5100, epoch: 1 | loss: 1.8404336
	speed: 0.0299s/iter; left time: 2025.1143s
	iters: 5200, epoch: 1 | loss: 1.8801506
	speed: 0.0304s/iter; left time: 2052.0101s
	iters: 5300, epoch: 1 | loss: 1.8144119
	speed: 0.0304s/iter; left time: 2052.4263s
	iters: 5400, epoch: 1 | loss: 1.7296195
	speed: 0.0303s/iter; left time: 2041.5196s
	iters: 5500, epoch: 1 | loss: 1.7446456
	speed: 0.0300s/iter; left time: 2016.6387s
	iters: 5600, epoch: 1 | loss: 1.9095911
	speed: 0.0298s/iter; left time: 1999.2764s
	iters: 5700, epoch: 1 | loss: 1.8193078
	speed: 0.0300s/iter; left time: 2011.8213s
	iters: 5800, epoch: 1 | loss: 1.7393185
	speed: 0.0302s/iter; left time: 2023.5596s
	iters: 5900, epoch: 1 | loss: 1.8568070
	speed: 0.0301s/iter; left time: 2015.7258s
	iters: 6000, epoch: 1 | loss: 1.7791735
	speed: 0.0301s/iter; left time: 2010.2456s
	iters: 6100, epoch: 1 | loss: 1.6854924
	speed: 0.0302s/iter; left time: 2016.8889s
	iters: 6200, epoch: 1 | loss: 1.8992001
	speed: 0.0297s/iter; left time: 1976.5126s
	iters: 6300, epoch: 1 | loss: 1.7922031
	speed: 0.0300s/iter; left time: 1996.4716s
	iters: 6400, epoch: 1 | loss: 1.4941487
	speed: 0.0303s/iter; left time: 2012.8536s
	iters: 6500, epoch: 1 | loss: 1.5986962
	speed: 0.0301s/iter; left time: 1997.3995s
	iters: 6600, epoch: 1 | loss: 1.4565358
	speed: 0.0304s/iter; left time: 2011.2354s
	iters: 6700, epoch: 1 | loss: 1.7083070
	speed: 0.0302s/iter; left time: 1995.7895s
	iters: 6800, epoch: 1 | loss: 1.8516062
	speed: 0.0301s/iter; left time: 1988.4020s
	iters: 6900, epoch: 1 | loss: 1.6297185
	speed: 0.0303s/iter; left time: 1998.4963s
	iters: 7000, epoch: 1 | loss: 1.7015352
	speed: 0.0304s/iter; left time: 2000.8042s
	iters: 7100, epoch: 1 | loss: 1.5914372
	speed: 0.0304s/iter; left time: 1995.3025s
	iters: 7200, epoch: 1 | loss: 1.8996909
	speed: 0.0302s/iter; left time: 1983.3637s
Epoch: 1 cost time: 220.14183592796326
Epoch: 1, Steps: 7279 | Train Loss: 1.7408917 Vali Loss: 1.8214672 Test Loss: 1.7304031
Validation loss decreased (inf --> 1.821467).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.9093853
	speed: 1.2097s/iter; left time: 79126.2106s
	iters: 200, epoch: 2 | loss: 1.5967638
	speed: 0.0303s/iter; left time: 1981.6993s
	iters: 300, epoch: 2 | loss: 1.7574688
	speed: 0.0303s/iter; left time: 1977.6674s
	iters: 400, epoch: 2 | loss: 1.4347484
	speed: 0.0304s/iter; left time: 1976.3146s
	iters: 500, epoch: 2 | loss: 1.7991825
	speed: 0.0302s/iter; left time: 1960.7581s
	iters: 600, epoch: 2 | loss: 1.7067622
	speed: 0.0304s/iter; left time: 1972.4764s
	iters: 700, epoch: 2 | loss: 1.6909368
	speed: 0.0304s/iter; left time: 1969.3022s
	iters: 800, epoch: 2 | loss: 2.0571229
	speed: 0.0301s/iter; left time: 1949.2559s
	iters: 900, epoch: 2 | loss: 1.9402187
	speed: 0.0305s/iter; left time: 1969.4099s
	iters: 1000, epoch: 2 | loss: 1.9300979
	speed: 0.0300s/iter; left time: 1938.1021s
	iters: 1100, epoch: 2 | loss: 1.7500641
	speed: 0.0303s/iter; left time: 1953.0668s
	iters: 1200, epoch: 2 | loss: 1.5163035
	speed: 0.0303s/iter; left time: 1945.8088s
	iters: 1300, epoch: 2 | loss: 1.9441770
	speed: 0.0299s/iter; left time: 1923.0062s
	iters: 1400, epoch: 2 | loss: 1.8244483
	speed: 0.0303s/iter; left time: 1941.1937s
	iters: 1500, epoch: 2 | loss: 1.7709446
	speed: 0.0302s/iter; left time: 1931.4644s
	iters: 1600, epoch: 2 | loss: 1.7760694
	speed: 0.0304s/iter; left time: 1941.7672s
	iters: 1700, epoch: 2 | loss: 1.6168513
	speed: 0.0304s/iter; left time: 1938.6188s
	iters: 1800, epoch: 2 | loss: 1.9277726
	speed: 0.0301s/iter; left time: 1917.0318s
	iters: 1900, epoch: 2 | loss: 1.8710668
	speed: 0.0303s/iter; left time: 1925.0901s
	iters: 2000, epoch: 2 | loss: 1.9102834
	speed: 0.0304s/iter; left time: 1928.6674s
	iters: 2100, epoch: 2 | loss: 1.8187056
	speed: 0.0299s/iter; left time: 1894.1544s
	iters: 2200, epoch: 2 | loss: 1.8655150
	speed: 0.0301s/iter; left time: 1906.5976s
	iters: 2300, epoch: 2 | loss: 1.8221408
	speed: 0.0304s/iter; left time: 1920.4332s
	iters: 2400, epoch: 2 | loss: 1.6692687
	speed: 0.0298s/iter; left time: 1878.6960s
	iters: 2500, epoch: 2 | loss: 1.8909438
	speed: 0.0304s/iter; left time: 1913.2410s
	iters: 2600, epoch: 2 | loss: 1.8184475
	speed: 0.0302s/iter; left time: 1899.3306s
	iters: 2700, epoch: 2 | loss: 1.8550256
	speed: 0.0302s/iter; left time: 1899.2568s
	iters: 2800, epoch: 2 | loss: 1.7402495
	speed: 0.0303s/iter; left time: 1901.1780s
	iters: 2900, epoch: 2 | loss: 1.6856889
	speed: 0.0303s/iter; left time: 1894.8893s
	iters: 3000, epoch: 2 | loss: 1.9123156
	speed: 0.0298s/iter; left time: 1865.8948s
	iters: 3100, epoch: 2 | loss: 1.7440019
	speed: 0.0300s/iter; left time: 1870.2128s
	iters: 3200, epoch: 2 | loss: 1.7052081
	speed: 0.0304s/iter; left time: 1891.8531s
	iters: 3300, epoch: 2 | loss: 1.6697286
	speed: 0.0302s/iter; left time: 1876.2576s
	iters: 3400, epoch: 2 | loss: 1.6520576
	speed: 0.0303s/iter; left time: 1880.3654s
	iters: 3500, epoch: 2 | loss: 1.8033775
	speed: 0.0304s/iter; left time: 1882.7606s
	iters: 3600, epoch: 2 | loss: 1.8433584
	speed: 0.0303s/iter; left time: 1873.4337s
	iters: 3700, epoch: 2 | loss: 1.6868166
	speed: 0.0298s/iter; left time: 1844.4905s
	iters: 3800, epoch: 2 | loss: 1.5109174
	speed: 0.0303s/iter; left time: 1869.7729s
	iters: 3900, epoch: 2 | loss: 1.8420780
	speed: 0.0300s/iter; left time: 1846.1814s
	iters: 4000, epoch: 2 | loss: 1.6186992
	speed: 0.0304s/iter; left time: 1866.9143s
	iters: 4100, epoch: 2 | loss: 1.9622931
	speed: 0.0297s/iter; left time: 1825.5763s
	iters: 4200, epoch: 2 | loss: 1.8711746
	speed: 0.0304s/iter; left time: 1861.8738s
	iters: 4300, epoch: 2 | loss: 1.6749567
	speed: 0.0304s/iter; left time: 1858.0942s
	iters: 4400, epoch: 2 | loss: 1.7287180
	speed: 0.0304s/iter; left time: 1855.9959s
	iters: 4500, epoch: 2 | loss: 1.7642784
	speed: 0.0304s/iter; left time: 1855.4346s
	iters: 4600, epoch: 2 | loss: 1.6970441
	speed: 0.0304s/iter; left time: 1850.4539s
	iters: 4700, epoch: 2 | loss: 1.6023073
	speed: 0.0301s/iter; left time: 1832.6093s
	iters: 4800, epoch: 2 | loss: 1.7027400
	speed: 0.0301s/iter; left time: 1828.1203s
	iters: 4900, epoch: 2 | loss: 1.7587082
	speed: 0.0301s/iter; left time: 1826.3036s
	iters: 5000, epoch: 2 | loss: 1.5663707
	speed: 0.0304s/iter; left time: 1837.3202s
	iters: 5100, epoch: 2 | loss: 1.6397883
	speed: 0.0303s/iter; left time: 1829.0239s
	iters: 5200, epoch: 2 | loss: 1.6877863
	speed: 0.0303s/iter; left time: 1829.5005s
	iters: 5300, epoch: 2 | loss: 1.6716292
	speed: 0.0302s/iter; left time: 1817.4719s
	iters: 5400, epoch: 2 | loss: 1.6939632
	speed: 0.0300s/iter; left time: 1805.2820s
	iters: 5500, epoch: 2 | loss: 1.7572676
	speed: 0.0304s/iter; left time: 1822.4727s
	iters: 5600, epoch: 2 | loss: 1.7689117
	speed: 0.0299s/iter; left time: 1789.1339s
	iters: 5700, epoch: 2 | loss: 1.6739488
	speed: 0.0304s/iter; left time: 1815.4995s
	iters: 5800, epoch: 2 | loss: 1.5822586
	speed: 0.0304s/iter; left time: 1815.0747s
	iters: 5900, epoch: 2 | loss: 1.8412189
	speed: 0.0304s/iter; left time: 1810.6057s
	iters: 6000, epoch: 2 | loss: 1.7538369
	speed: 0.0301s/iter; left time: 1790.3254s
	iters: 6100, epoch: 2 | loss: 1.7109667
	speed: 0.0302s/iter; left time: 1795.1848s
	iters: 6200, epoch: 2 | loss: 1.6644807
	speed: 0.0300s/iter; left time: 1782.1482s
	iters: 6300, epoch: 2 | loss: 1.9208647
	speed: 0.0304s/iter; left time: 1797.6024s
	iters: 6400, epoch: 2 | loss: 1.6657636
	speed: 0.0299s/iter; left time: 1769.3669s
	iters: 6500, epoch: 2 | loss: 1.7152067
	speed: 0.0302s/iter; left time: 1780.4891s
	iters: 6600, epoch: 2 | loss: 1.6139094
	speed: 0.0304s/iter; left time: 1790.5891s
	iters: 6700, epoch: 2 | loss: 1.7143881
	speed: 0.0305s/iter; left time: 1793.0346s
	iters: 6800, epoch: 2 | loss: 2.0127571
	speed: 0.0303s/iter; left time: 1781.7586s
	iters: 6900, epoch: 2 | loss: 1.7219301
	speed: 0.0303s/iter; left time: 1775.8448s
	iters: 7000, epoch: 2 | loss: 1.5664726
	speed: 0.0298s/iter; left time: 1741.6534s
	iters: 7100, epoch: 2 | loss: 1.9338379
	speed: 0.0302s/iter; left time: 1765.0154s
	iters: 7200, epoch: 2 | loss: 1.7050261
	speed: 0.0301s/iter; left time: 1756.1886s
Epoch: 2 cost time: 220.15011525154114
Epoch: 2, Steps: 7279 | Train Loss: 1.7489872 Vali Loss: 1.8207144 Test Loss: 1.7291899
Validation loss decreased (1.821467 --> 1.820714).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.9732567
	speed: 1.2160s/iter; left time: 70691.8392s
	iters: 200, epoch: 3 | loss: 1.6669292
	speed: 0.0303s/iter; left time: 1758.3124s
	iters: 300, epoch: 3 | loss: 1.5938445
	speed: 0.0304s/iter; left time: 1760.1731s
	iters: 400, epoch: 3 | loss: 1.6114396
	speed: 0.0304s/iter; left time: 1758.2491s
	iters: 500, epoch: 3 | loss: 1.8938525
	speed: 0.0302s/iter; left time: 1742.2123s
	iters: 600, epoch: 3 | loss: 1.6039963
	speed: 0.0305s/iter; left time: 1759.0291s
	iters: 700, epoch: 3 | loss: 1.5980029
	speed: 0.0305s/iter; left time: 1754.3734s
	iters: 800, epoch: 3 | loss: 1.6733048
	speed: 0.0302s/iter; left time: 1736.3898s
	iters: 900, epoch: 3 | loss: 1.8269552
	speed: 0.0301s/iter; left time: 1724.6183s
	iters: 1000, epoch: 3 | loss: 1.8751203
	speed: 0.0304s/iter; left time: 1738.2444s
	iters: 1100, epoch: 3 | loss: 1.8217076
	speed: 0.0304s/iter; left time: 1734.4654s
	iters: 1200, epoch: 3 | loss: 1.7001897
	speed: 0.0304s/iter; left time: 1732.9853s
	iters: 1300, epoch: 3 | loss: 1.6727514
	speed: 0.0304s/iter; left time: 1733.3335s
	iters: 1400, epoch: 3 | loss: 1.9874107
	speed: 0.0303s/iter; left time: 1724.8041s
	iters: 1500, epoch: 3 | loss: 1.5512199
	speed: 0.0304s/iter; left time: 1723.7449s
	iters: 1600, epoch: 3 | loss: 1.6115210
	speed: 0.0304s/iter; left time: 1720.9340s
	iters: 1700, epoch: 3 | loss: 1.8511798
	speed: 0.0304s/iter; left time: 1716.6922s
	iters: 1800, epoch: 3 | loss: 1.8570446
	speed: 0.0304s/iter; left time: 1713.3072s
	iters: 1900, epoch: 3 | loss: 1.9524360
	speed: 0.0304s/iter; left time: 1712.8326s
	iters: 2000, epoch: 3 | loss: 1.5826160
	speed: 0.0304s/iter; left time: 1712.0675s
	iters: 2100, epoch: 3 | loss: 1.8079956
	speed: 0.0305s/iter; left time: 1712.3753s
	iters: 2200, epoch: 3 | loss: 1.8338447
	speed: 0.0305s/iter; left time: 1708.0336s
	iters: 2300, epoch: 3 | loss: 1.6698408
	speed: 0.0304s/iter; left time: 1699.5581s
	iters: 2400, epoch: 3 | loss: 1.8898655
	speed: 0.0304s/iter; left time: 1696.4051s
	iters: 2500, epoch: 3 | loss: 1.7944473
	speed: 0.0304s/iter; left time: 1692.7243s
	iters: 2600, epoch: 3 | loss: 1.9534346
	speed: 0.0303s/iter; left time: 1687.7172s
	iters: 2700, epoch: 3 | loss: 2.0447080
	speed: 0.0304s/iter; left time: 1688.3410s
	iters: 2800, epoch: 3 | loss: 1.8216158
	speed: 0.0299s/iter; left time: 1658.0615s
	iters: 2900, epoch: 3 | loss: 1.7708325
	speed: 0.0301s/iter; left time: 1663.6162s
	iters: 3000, epoch: 3 | loss: 1.6613748
	speed: 0.0301s/iter; left time: 1659.7669s
	iters: 3100, epoch: 3 | loss: 1.7089067
	speed: 0.0302s/iter; left time: 1663.3891s
	iters: 3200, epoch: 3 | loss: 1.5493842
	speed: 0.0302s/iter; left time: 1662.3142s
	iters: 3300, epoch: 3 | loss: 1.6431460
	speed: 0.0305s/iter; left time: 1672.8816s
	iters: 3400, epoch: 3 | loss: 1.6085436
	speed: 0.0303s/iter; left time: 1663.9235s
	iters: 3500, epoch: 3 | loss: 1.6654671
	speed: 0.0309s/iter; left time: 1689.2478s
	iters: 3600, epoch: 3 | loss: 1.9094400
	speed: 0.0304s/iter; left time: 1659.9709s
	iters: 3700, epoch: 3 | loss: 1.8631406
	speed: 0.0303s/iter; left time: 1651.7640s
	iters: 3800, epoch: 3 | loss: 1.6020659
	speed: 0.0303s/iter; left time: 1649.5305s
	iters: 3900, epoch: 3 | loss: 1.7680309
	speed: 0.0301s/iter; left time: 1634.9768s
	iters: 4000, epoch: 3 | loss: 1.7764426
	speed: 0.0298s/iter; left time: 1617.3885s
	iters: 4100, epoch: 3 | loss: 1.7935281
	speed: 0.0300s/iter; left time: 1625.1534s
	iters: 4200, epoch: 3 | loss: 1.7982002
	speed: 0.0303s/iter; left time: 1635.4199s
	iters: 4300, epoch: 3 | loss: 1.8062452
	speed: 0.0302s/iter; left time: 1628.2599s
	iters: 4400, epoch: 3 | loss: 1.6105855
	speed: 0.0303s/iter; left time: 1632.0974s
	iters: 4500, epoch: 3 | loss: 1.7344254
	speed: 0.0301s/iter; left time: 1619.9147s
	iters: 4600, epoch: 3 | loss: 1.8110528
	speed: 0.0304s/iter; left time: 1630.0392s
	iters: 4700, epoch: 3 | loss: 1.6523720
	speed: 0.0304s/iter; left time: 1625.1691s
	iters: 4800, epoch: 3 | loss: 1.8530402
	speed: 0.0303s/iter; left time: 1618.4061s
	iters: 4900, epoch: 3 | loss: 1.8682508
	speed: 0.0304s/iter; left time: 1619.9879s
	iters: 5000, epoch: 3 | loss: 1.7693127
	speed: 0.0303s/iter; left time: 1612.8302s
	iters: 5100, epoch: 3 | loss: 1.4312969
	speed: 0.0302s/iter; left time: 1602.0603s
	iters: 5200, epoch: 3 | loss: 1.9050072
	speed: 0.0302s/iter; left time: 1602.6020s
	iters: 5300, epoch: 3 | loss: 1.5910751
	speed: 0.0304s/iter; left time: 1609.5342s
	iters: 5400, epoch: 3 | loss: 1.5846020
	speed: 0.0304s/iter; left time: 1604.1967s
	iters: 5500, epoch: 3 | loss: 1.8996741
	speed: 0.0304s/iter; left time: 1601.9087s
	iters: 5600, epoch: 3 | loss: 1.7998958
	speed: 0.0303s/iter; left time: 1597.3943s
	iters: 5700, epoch: 3 | loss: 1.4810499
	speed: 0.0304s/iter; left time: 1599.2086s
	iters: 5800, epoch: 3 | loss: 1.7775588
	speed: 0.0299s/iter; left time: 1568.9239s
	iters: 5900, epoch: 3 | loss: 1.6835912
	speed: 0.0304s/iter; left time: 1589.8631s
	iters: 6000, epoch: 3 | loss: 1.7972643
	speed: 0.0302s/iter; left time: 1576.2560s
	iters: 6100, epoch: 3 | loss: 1.5939366
	speed: 0.0302s/iter; left time: 1572.4470s
	iters: 6200, epoch: 3 | loss: 1.8123974
	speed: 0.0304s/iter; left time: 1579.8405s
	iters: 6300, epoch: 3 | loss: 1.6896524
	speed: 0.0301s/iter; left time: 1565.4383s
	iters: 6400, epoch: 3 | loss: 1.6645713
	speed: 0.0303s/iter; left time: 1570.8331s
	iters: 6500, epoch: 3 | loss: 1.6951530
	speed: 0.0303s/iter; left time: 1567.1894s
	iters: 6600, epoch: 3 | loss: 1.7592001
	speed: 0.0303s/iter; left time: 1564.0211s
	iters: 6700, epoch: 3 | loss: 1.5956804
	speed: 0.0300s/iter; left time: 1543.9979s
	iters: 6800, epoch: 3 | loss: 1.8676566
	speed: 0.0300s/iter; left time: 1545.2130s
	iters: 6900, epoch: 3 | loss: 1.7064486
	speed: 0.0303s/iter; left time: 1554.0516s
	iters: 7000, epoch: 3 | loss: 1.8231158
	speed: 0.0304s/iter; left time: 1559.1850s
	iters: 7100, epoch: 3 | loss: 1.7265986
	speed: 0.0301s/iter; left time: 1537.5503s
	iters: 7200, epoch: 3 | loss: 1.7171004
	speed: 0.0304s/iter; left time: 1550.9074s
Epoch: 3 cost time: 220.72625517845154
Epoch: 3, Steps: 7279 | Train Loss: 1.7484998 Vali Loss: 1.8235779 Test Loss: 1.7297168
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6357666
	speed: 1.2260s/iter; left time: 62347.5756s
	iters: 200, epoch: 4 | loss: 1.5472538
	speed: 0.0304s/iter; left time: 1543.5639s
	iters: 300, epoch: 4 | loss: 1.5457553
	speed: 0.0304s/iter; left time: 1538.8314s
	iters: 400, epoch: 4 | loss: 1.4740672
	speed: 0.0303s/iter; left time: 1530.4013s
	iters: 500, epoch: 4 | loss: 1.6653018
	speed: 0.0303s/iter; left time: 1527.6544s
	iters: 600, epoch: 4 | loss: 1.7362586
	speed: 0.0303s/iter; left time: 1524.6447s
	iters: 700, epoch: 4 | loss: 1.7278688
	speed: 0.0304s/iter; left time: 1525.9235s
	iters: 800, epoch: 4 | loss: 1.4838029
	speed: 0.0298s/iter; left time: 1496.0520s
	iters: 900, epoch: 4 | loss: 1.8990986
	speed: 0.0304s/iter; left time: 1523.4511s
	iters: 1000, epoch: 4 | loss: 1.8569137
	speed: 0.0304s/iter; left time: 1518.5363s
	iters: 1100, epoch: 4 | loss: 1.7666937
	speed: 0.0302s/iter; left time: 1505.7999s
	iters: 1200, epoch: 4 | loss: 1.4398818
	speed: 0.0304s/iter; left time: 1512.4407s
	iters: 1300, epoch: 4 | loss: 1.6824173
	speed: 0.0301s/iter; left time: 1496.9560s
	iters: 1400, epoch: 4 | loss: 1.8007739
	speed: 0.0305s/iter; left time: 1511.5100s
	iters: 1500, epoch: 4 | loss: 1.8871837
	speed: 0.0301s/iter; left time: 1489.7393s
	iters: 1600, epoch: 4 | loss: 1.8283435
	speed: 0.0301s/iter; left time: 1486.0258s
	iters: 1700, epoch: 4 | loss: 1.7928163
	speed: 0.0304s/iter; left time: 1499.2070s
	iters: 1800, epoch: 4 | loss: 1.8569415
	speed: 0.0301s/iter; left time: 1478.2519s
	iters: 1900, epoch: 4 | loss: 1.6729903
	speed: 0.0303s/iter; left time: 1488.5650s
	iters: 2000, epoch: 4 | loss: 1.6974671
	speed: 0.0304s/iter; left time: 1487.0159s
	iters: 2100, epoch: 4 | loss: 2.1069930
	speed: 0.0303s/iter; left time: 1480.2204s
	iters: 2200, epoch: 4 | loss: 1.8222746
	speed: 0.0302s/iter; left time: 1471.9461s
	iters: 2300, epoch: 4 | loss: 1.8009281
	speed: 0.0300s/iter; left time: 1460.5395s
	iters: 2400, epoch: 4 | loss: 1.6260066
	speed: 0.0304s/iter; left time: 1475.6350s
	iters: 2500, epoch: 4 | loss: 1.6554456
	speed: 0.0303s/iter; left time: 1466.5588s
	iters: 2600, epoch: 4 | loss: 1.9215584
	speed: 0.0304s/iter; left time: 1470.4331s
	iters: 2700, epoch: 4 | loss: 1.5918882
	speed: 0.0303s/iter; left time: 1459.8328s
	iters: 2800, epoch: 4 | loss: 1.6548280
	speed: 0.0301s/iter; left time: 1449.7590s
	iters: 2900, epoch: 4 | loss: 1.7313803
	speed: 0.0297s/iter; left time: 1428.2335s
	iters: 3000, epoch: 4 | loss: 1.7384615
	speed: 0.0304s/iter; left time: 1457.6926s
	iters: 3100, epoch: 4 | loss: 1.8179833
	speed: 0.0302s/iter; left time: 1445.0939s
	iters: 3200, epoch: 4 | loss: 1.8772494
	speed: 0.0304s/iter; left time: 1451.7359s
	iters: 3300, epoch: 4 | loss: 1.8524301
	speed: 0.0303s/iter; left time: 1444.2111s
	iters: 3400, epoch: 4 | loss: 1.7812551
	speed: 0.0304s/iter; left time: 1446.8629s
	iters: 3500, epoch: 4 | loss: 1.8224409
	speed: 0.0302s/iter; left time: 1434.6141s
	iters: 3600, epoch: 4 | loss: 1.6223683
	speed: 0.0301s/iter; left time: 1424.5408s
	iters: 3700, epoch: 4 | loss: 1.5710741
	speed: 0.0302s/iter; left time: 1427.7746s
	iters: 3800, epoch: 4 | loss: 1.8489556
	speed: 0.0303s/iter; left time: 1428.3730s
	iters: 3900, epoch: 4 | loss: 1.8072987
	speed: 0.0302s/iter; left time: 1422.1855s
	iters: 4000, epoch: 4 | loss: 1.6251214
	speed: 0.0303s/iter; left time: 1420.4638s
	iters: 4100, epoch: 4 | loss: 1.7226481
	speed: 0.0304s/iter; left time: 1425.0503s
	iters: 4200, epoch: 4 | loss: 1.7654073
	speed: 0.0304s/iter; left time: 1420.9095s
	iters: 4300, epoch: 4 | loss: 1.8371392
	speed: 0.0305s/iter; left time: 1424.2348s
	iters: 4400, epoch: 4 | loss: 1.5628009
	speed: 0.0304s/iter; left time: 1414.5911s
	iters: 4500, epoch: 4 | loss: 1.7027524
	speed: 0.0304s/iter; left time: 1412.7425s
	iters: 4600, epoch: 4 | loss: 1.6326323
	speed: 0.0301s/iter; left time: 1396.1112s
	iters: 4700, epoch: 4 | loss: 1.6368794
	speed: 0.0301s/iter; left time: 1391.0823s
	iters: 4800, epoch: 4 | loss: 1.6351275
	speed: 0.0304s/iter; left time: 1403.4660s
	iters: 4900, epoch: 4 | loss: 1.7257015
	speed: 0.0304s/iter; left time: 1400.0144s
	iters: 5000, epoch: 4 | loss: 1.8008399
	speed: 0.0302s/iter; left time: 1387.4406s
	iters: 5100, epoch: 4 | loss: 1.8510225
	speed: 0.0304s/iter; left time: 1393.5609s
	iters: 5200, epoch: 4 | loss: 1.7414695
	speed: 0.0304s/iter; left time: 1389.7629s
	iters: 5300, epoch: 4 | loss: 1.6903058
	speed: 0.0302s/iter; left time: 1378.1873s
	iters: 5400, epoch: 4 | loss: 1.8860747
	speed: 0.0304s/iter; left time: 1383.9861s
	iters: 5500, epoch: 4 | loss: 1.6706140
	speed: 0.0300s/iter; left time: 1364.1090s
	iters: 5600, epoch: 4 | loss: 1.6888175
	speed: 0.0303s/iter; left time: 1374.9225s
	iters: 5700, epoch: 4 | loss: 1.7580917
	speed: 0.0304s/iter; left time: 1374.8194s
	iters: 5800, epoch: 4 | loss: 1.8740430
	speed: 0.0304s/iter; left time: 1371.0157s
	iters: 5900, epoch: 4 | loss: 1.5290298
	speed: 0.0304s/iter; left time: 1370.9578s
	iters: 6000, epoch: 4 | loss: 1.6857486
	speed: 0.0304s/iter; left time: 1366.1814s
	iters: 6100, epoch: 4 | loss: 1.7519832
	speed: 0.0307s/iter; left time: 1378.9594s
	iters: 6200, epoch: 4 | loss: 1.6816037
	speed: 0.0304s/iter; left time: 1361.8561s
	iters: 6300, epoch: 4 | loss: 1.5460498
	speed: 0.0303s/iter; left time: 1354.9190s
	iters: 6400, epoch: 4 | loss: 1.8020095
	speed: 0.0303s/iter; left time: 1349.8799s
	iters: 6500, epoch: 4 | loss: 1.5682281
	speed: 0.0299s/iter; left time: 1330.2149s
	iters: 6600, epoch: 4 | loss: 2.0141072
	speed: 0.0301s/iter; left time: 1334.9900s
	iters: 6700, epoch: 4 | loss: 1.7030177
	speed: 0.0300s/iter; left time: 1328.6625s
	iters: 6800, epoch: 4 | loss: 1.8763539
	speed: 0.0302s/iter; left time: 1334.0872s
	iters: 6900, epoch: 4 | loss: 1.9671601
	speed: 0.0303s/iter; left time: 1335.3871s
	iters: 7000, epoch: 4 | loss: 1.6786958
	speed: 0.0303s/iter; left time: 1333.9125s
	iters: 7100, epoch: 4 | loss: 1.6759672
	speed: 0.0304s/iter; left time: 1334.3322s
	iters: 7200, epoch: 4 | loss: 1.8626564
	speed: 0.0304s/iter; left time: 1331.7756s
Epoch: 4 cost time: 220.64290308952332
Epoch: 4, Steps: 7279 | Train Loss: 1.7486542 Vali Loss: 1.8211020 Test Loss: 1.7301656
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.7300513
	speed: 1.2148s/iter; left time: 52935.2665s
	iters: 200, epoch: 5 | loss: 1.7203072
	speed: 0.0305s/iter; left time: 1327.3021s
	iters: 300, epoch: 5 | loss: 1.9864595
	speed: 0.0302s/iter; left time: 1310.4931s
	iters: 400, epoch: 5 | loss: 1.9859856
	speed: 0.0304s/iter; left time: 1315.7133s
	iters: 500, epoch: 5 | loss: 1.9117066
	speed: 0.0305s/iter; left time: 1315.8569s
	iters: 600, epoch: 5 | loss: 1.8689015
	speed: 0.0303s/iter; left time: 1305.7168s
	iters: 700, epoch: 5 | loss: 1.7192641
	speed: 0.0303s/iter; left time: 1301.8847s
	iters: 800, epoch: 5 | loss: 1.6992295
	speed: 0.0304s/iter; left time: 1304.5171s
	iters: 900, epoch: 5 | loss: 1.5384597
	speed: 0.0304s/iter; left time: 1299.3344s
	iters: 1000, epoch: 5 | loss: 1.7844639
	speed: 0.0302s/iter; left time: 1290.4761s
	iters: 1100, epoch: 5 | loss: 1.7494804
	speed: 0.0301s/iter; left time: 1281.8874s
	iters: 1200, epoch: 5 | loss: 1.7998357
	speed: 0.0301s/iter; left time: 1280.5308s
	iters: 1300, epoch: 5 | loss: 1.6173643
	speed: 0.0304s/iter; left time: 1287.4774s
	iters: 1400, epoch: 5 | loss: 1.6791383
	speed: 0.0303s/iter; left time: 1279.8522s
	iters: 1500, epoch: 5 | loss: 1.8439885
	speed: 0.0301s/iter; left time: 1269.3473s
	iters: 1600, epoch: 5 | loss: 1.8027664
	speed: 0.0304s/iter; left time: 1277.0029s
	iters: 1700, epoch: 5 | loss: 1.7993442
	speed: 0.0299s/iter; left time: 1256.2077s
	iters: 1800, epoch: 5 | loss: 1.8132542
	speed: 0.0303s/iter; left time: 1268.7167s
	iters: 1900, epoch: 5 | loss: 1.6993748
	speed: 0.0305s/iter; left time: 1272.1194s
	iters: 2000, epoch: 5 | loss: 1.8881987
	speed: 0.0303s/iter; left time: 1263.1514s
	iters: 2100, epoch: 5 | loss: 1.5409395
	speed: 0.0301s/iter; left time: 1252.7291s
	iters: 2200, epoch: 5 | loss: 1.6104720
	speed: 0.0303s/iter; left time: 1258.3231s
	iters: 2300, epoch: 5 | loss: 1.4701445
	speed: 0.0304s/iter; left time: 1258.8806s
	iters: 2400, epoch: 5 | loss: 1.8134577
	speed: 0.0302s/iter; left time: 1246.2097s
	iters: 2500, epoch: 5 | loss: 1.8166850
	speed: 0.0302s/iter; left time: 1241.5133s
	iters: 2600, epoch: 5 | loss: 1.7197087
	speed: 0.0302s/iter; left time: 1240.2812s
	iters: 2700, epoch: 5 | loss: 1.8890672
	speed: 0.0304s/iter; left time: 1244.6104s
	iters: 2800, epoch: 5 | loss: 1.5666590
	speed: 0.0298s/iter; left time: 1218.8358s
	iters: 2900, epoch: 5 | loss: 1.6327968
	speed: 0.0305s/iter; left time: 1243.3120s
	iters: 3000, epoch: 5 | loss: 1.8188184
	speed: 0.0301s/iter; left time: 1225.3707s
	iters: 3100, epoch: 5 | loss: 1.7428509
	speed: 0.0304s/iter; left time: 1234.3026s
	iters: 3200, epoch: 5 | loss: 1.6558787
	speed: 0.0304s/iter; left time: 1230.0913s
	iters: 3300, epoch: 5 | loss: 1.6980531
	speed: 0.0304s/iter; left time: 1228.2143s
	iters: 3400, epoch: 5 | loss: 1.8897914
	speed: 0.0303s/iter; left time: 1220.6184s
	iters: 3500, epoch: 5 | loss: 1.8865148
	speed: 0.0302s/iter; left time: 1214.6039s
	iters: 3600, epoch: 5 | loss: 1.9319284
	speed: 0.0305s/iter; left time: 1220.3245s
	iters: 3700, epoch: 5 | loss: 1.7481959
	speed: 0.0305s/iter; left time: 1217.7220s
	iters: 3800, epoch: 5 | loss: 1.5556307
	speed: 0.0303s/iter; left time: 1207.9399s
	iters: 3900, epoch: 5 | loss: 1.8267149
	speed: 0.0299s/iter; left time: 1189.4037s
	iters: 4000, epoch: 5 | loss: 1.5863293
	speed: 0.0304s/iter; left time: 1207.2494s
	iters: 4100, epoch: 5 | loss: 1.8945431
	speed: 0.0303s/iter; left time: 1199.2026s
	iters: 4200, epoch: 5 | loss: 1.8315409
	speed: 0.0304s/iter; left time: 1198.1791s
	iters: 4300, epoch: 5 | loss: 1.8480622
	speed: 0.0303s/iter; left time: 1194.3534s
	iters: 4400, epoch: 5 | loss: 1.8173133
	speed: 0.0304s/iter; left time: 1194.3411s
	iters: 4500, epoch: 5 | loss: 1.8795390
	speed: 0.0303s/iter; left time: 1188.5680s
	iters: 4600, epoch: 5 | loss: 1.8469794
	speed: 0.0304s/iter; left time: 1187.5895s
	iters: 4700, epoch: 5 | loss: 1.7470832
	speed: 0.0303s/iter; left time: 1180.2569s
	iters: 4800, epoch: 5 | loss: 1.6756684
	speed: 0.0302s/iter; left time: 1173.9345s
	iters: 4900, epoch: 5 | loss: 1.7228107
	speed: 0.0300s/iter; left time: 1164.9947s
	iters: 5000, epoch: 5 | loss: 1.8946226
	speed: 0.0304s/iter; left time: 1174.4532s
	iters: 5100, epoch: 5 | loss: 1.9299206
	speed: 0.0304s/iter; left time: 1170.7602s
	iters: 5200, epoch: 5 | loss: 1.9145620
	speed: 0.0300s/iter; left time: 1155.3038s
	iters: 5300, epoch: 5 | loss: 1.9203809
	speed: 0.0304s/iter; left time: 1167.2424s
	iters: 5400, epoch: 5 | loss: 1.8222212
	speed: 0.0302s/iter; left time: 1156.1604s
	iters: 5500, epoch: 5 | loss: 1.9003810
	speed: 0.0292s/iter; left time: 1114.9128s
	iters: 5600, epoch: 5 | loss: 1.4959782
	speed: 0.0303s/iter; left time: 1154.5560s
	iters: 5700, epoch: 5 | loss: 1.7080781
	speed: 0.0305s/iter; left time: 1158.4321s
	iters: 5800, epoch: 5 | loss: 1.7585979
	speed: 0.0303s/iter; left time: 1148.1678s
	iters: 5900, epoch: 5 | loss: 1.6560525
	speed: 0.0301s/iter; left time: 1137.2791s
	iters: 6000, epoch: 5 | loss: 1.8037810
	speed: 0.0301s/iter; left time: 1134.9200s
	iters: 6100, epoch: 5 | loss: 1.8607118
	speed: 0.0301s/iter; left time: 1129.7006s
	iters: 6200, epoch: 5 | loss: 1.6239119
	speed: 0.0304s/iter; left time: 1139.5144s
	iters: 6300, epoch: 5 | loss: 1.5039228
	speed: 0.0302s/iter; left time: 1130.0138s
	iters: 6400, epoch: 5 | loss: 1.6253034
	speed: 0.0301s/iter; left time: 1120.9201s
	iters: 6500, epoch: 5 | loss: 1.8592210
	speed: 0.0298s/iter; left time: 1106.9955s
	iters: 6600, epoch: 5 | loss: 1.6345940
	speed: 0.0303s/iter; left time: 1122.9975s
	iters: 6700, epoch: 5 | loss: 1.6159127
	speed: 0.0304s/iter; left time: 1123.5016s
	iters: 6800, epoch: 5 | loss: 1.8307678
	speed: 0.0299s/iter; left time: 1102.2830s
	iters: 6900, epoch: 5 | loss: 1.6460655
	speed: 0.0304s/iter; left time: 1118.5928s
	iters: 7000, epoch: 5 | loss: 1.6278104
	speed: 0.0300s/iter; left time: 1099.9350s
	iters: 7100, epoch: 5 | loss: 1.7414767
	speed: 0.0303s/iter; left time: 1108.5313s
	iters: 7200, epoch: 5 | loss: 1.6207006
	speed: 0.0301s/iter; left time: 1096.9306s
Epoch: 5 cost time: 220.37962865829468
Epoch: 5, Steps: 7279 | Train Loss: 1.7482490 Vali Loss: 1.8226283 Test Loss: 1.7294679
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247965
test shape: (24796, 1, 192, 151) (24796, 1, 192, 151)
test shape: (24796, 192, 151) (24796, 192, 151)
mse:1.729182481765747, mae:1.0077033042907715
>>>>>>>Overall time: 1905 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
