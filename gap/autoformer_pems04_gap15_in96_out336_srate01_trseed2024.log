Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems04_all_common_flow.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems04_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1216400
val 300061
test 300059
	iters: 100, epoch: 1 | loss: 1.4189230
	speed: 0.2254s/iter; left time: 171308.5178s
	iters: 200, epoch: 1 | loss: 1.2254711
	speed: 0.2141s/iter; left time: 162681.4011s
	iters: 300, epoch: 1 | loss: 1.2374063
	speed: 0.2144s/iter; left time: 162893.9337s
	iters: 400, epoch: 1 | loss: 1.1393747
	speed: 0.2132s/iter; left time: 161952.6723s
	iters: 500, epoch: 1 | loss: 0.9932260
	speed: 0.2139s/iter; left time: 162485.7737s
	iters: 600, epoch: 1 | loss: 0.9791866
	speed: 0.2132s/iter; left time: 161947.6879s
	iters: 700, epoch: 1 | loss: 1.0231705
	speed: 0.2146s/iter; left time: 162966.4556s
	iters: 800, epoch: 1 | loss: 0.9323865
	speed: 0.2143s/iter; left time: 162754.2550s
	iters: 900, epoch: 1 | loss: 1.0773345
	speed: 0.2149s/iter; left time: 163138.8350s
	iters: 1000, epoch: 1 | loss: 1.0486525
	speed: 0.2139s/iter; left time: 162366.6784s
	iters: 1100, epoch: 1 | loss: 0.9228534
	speed: 0.2149s/iter; left time: 163113.5120s
	iters: 1200, epoch: 1 | loss: 0.8983818
	speed: 0.2140s/iter; left time: 162456.7481s
	iters: 1300, epoch: 1 | loss: 0.8612928
	speed: 0.2144s/iter; left time: 162711.3241s
	iters: 1400, epoch: 1 | loss: 0.8831595
	speed: 0.2144s/iter; left time: 162697.5888s
	iters: 1500, epoch: 1 | loss: 0.8555056
	speed: 0.2136s/iter; left time: 162040.5923s
	iters: 1600, epoch: 1 | loss: 0.8198797
	speed: 0.2148s/iter; left time: 162934.1435s
	iters: 1700, epoch: 1 | loss: 0.8674560
	speed: 0.2138s/iter; left time: 162154.9137s
	iters: 1800, epoch: 1 | loss: 0.8681294
	speed: 0.2135s/iter; left time: 161948.0733s
	iters: 1900, epoch: 1 | loss: 0.9413916
	speed: 0.2134s/iter; left time: 161859.1317s
	iters: 2000, epoch: 1 | loss: 0.8582360
	speed: 0.2131s/iter; left time: 161599.8023s
	iters: 2100, epoch: 1 | loss: 0.9099698
	speed: 0.2145s/iter; left time: 162635.7551s
	iters: 2200, epoch: 1 | loss: 0.7295765
	speed: 0.2135s/iter; left time: 161868.8872s
	iters: 2300, epoch: 1 | loss: 0.7661855
	speed: 0.2142s/iter; left time: 162341.3648s
	iters: 2400, epoch: 1 | loss: 0.8668192
	speed: 0.2133s/iter; left time: 161644.8770s
	iters: 2500, epoch: 1 | loss: 0.8631209
	speed: 0.2143s/iter; left time: 162400.0793s
	iters: 2600, epoch: 1 | loss: 0.9303715
	speed: 0.2135s/iter; left time: 161768.9388s
	iters: 2700, epoch: 1 | loss: 0.7708001
	speed: 0.2130s/iter; left time: 161313.3874s
	iters: 2800, epoch: 1 | loss: 0.7358847
	speed: 0.2138s/iter; left time: 161962.6718s
	iters: 2900, epoch: 1 | loss: 0.7884371
	speed: 0.2122s/iter; left time: 160708.2875s
	iters: 3000, epoch: 1 | loss: 0.7490254
	speed: 0.2129s/iter; left time: 161182.0853s
	iters: 3100, epoch: 1 | loss: 0.8587682
	speed: 0.2127s/iter; left time: 161056.2690s
	iters: 3200, epoch: 1 | loss: 0.8272970
	speed: 0.2129s/iter; left time: 161178.4334s
	iters: 3300, epoch: 1 | loss: 0.7641461
	speed: 0.2133s/iter; left time: 161430.0448s
	iters: 3400, epoch: 1 | loss: 0.8037736
	speed: 0.2126s/iter; left time: 160859.9263s
	iters: 3500, epoch: 1 | loss: 0.7914864
	speed: 0.2137s/iter; left time: 161676.1344s
	iters: 3600, epoch: 1 | loss: 0.6993889
	speed: 0.2126s/iter; left time: 160880.4090s
	iters: 3700, epoch: 1 | loss: 0.7709765
	speed: 0.2135s/iter; left time: 161530.4671s
	iters: 3800, epoch: 1 | loss: 0.7615524
	speed: 0.2131s/iter; left time: 161201.8604s
Epoch: 1 cost time: 813.8247780799866
Epoch: 1, Steps: 3801 | Train Loss: 0.9142407 Vali Loss: 0.9437495 Test Loss: 0.9390743
Validation loss decreased (inf --> 0.943749).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8388946
	speed: 5.6980s/iter; left time: 4309384.8515s
	iters: 200, epoch: 2 | loss: 0.8536894
	speed: 0.2050s/iter; left time: 155017.5077s
	iters: 300, epoch: 2 | loss: 0.7010866
	speed: 0.2043s/iter; left time: 154481.4373s
	iters: 400, epoch: 2 | loss: 0.7574209
	speed: 0.2048s/iter; left time: 154835.0654s
	iters: 500, epoch: 2 | loss: 0.7610489
	speed: 0.2052s/iter; left time: 155136.1865s
	iters: 600, epoch: 2 | loss: 0.6918924
	speed: 0.2053s/iter; left time: 155188.5779s
	iters: 700, epoch: 2 | loss: 0.7945178
	speed: 0.2054s/iter; left time: 155229.2911s
	iters: 800, epoch: 2 | loss: 0.6574882
	speed: 0.2051s/iter; left time: 154999.8131s
	iters: 900, epoch: 2 | loss: 0.7675761
	speed: 0.2057s/iter; left time: 155404.6491s
	iters: 1000, epoch: 2 | loss: 0.7255390
	speed: 0.2055s/iter; left time: 155241.4300s
	iters: 1100, epoch: 2 | loss: 0.6722746
	speed: 0.2056s/iter; left time: 155286.4094s
	iters: 1200, epoch: 2 | loss: 0.7506473
	speed: 0.2053s/iter; left time: 155025.5447s
	iters: 1300, epoch: 2 | loss: 0.6595157
	speed: 0.2051s/iter; left time: 154874.7672s
	iters: 1400, epoch: 2 | loss: 0.6856416
	speed: 0.2043s/iter; left time: 154218.6644s
	iters: 1500, epoch: 2 | loss: 0.6961657
	speed: 0.2051s/iter; left time: 154836.7069s
	iters: 1600, epoch: 2 | loss: 0.7961473
	speed: 0.2038s/iter; left time: 153801.2147s
	iters: 1700, epoch: 2 | loss: 0.7050220
	speed: 0.2030s/iter; left time: 153186.6190s
	iters: 1800, epoch: 2 | loss: 0.6408672
	speed: 0.2034s/iter; left time: 153502.7776s
	iters: 1900, epoch: 2 | loss: 0.6437967
	speed: 0.2039s/iter; left time: 153856.2222s
	iters: 2000, epoch: 2 | loss: 0.7006184
	speed: 0.2029s/iter; left time: 153081.7836s
	iters: 2100, epoch: 2 | loss: 0.6502936
	speed: 0.2035s/iter; left time: 153527.5773s
	iters: 2200, epoch: 2 | loss: 0.6152022
	speed: 0.2070s/iter; left time: 156142.9274s
	iters: 2300, epoch: 2 | loss: 0.6215169
	speed: 0.2033s/iter; left time: 153294.3744s
	iters: 2400, epoch: 2 | loss: 0.6535494
	speed: 0.2030s/iter; left time: 153068.7301s
	iters: 2500, epoch: 2 | loss: 0.7030154
	speed: 0.2047s/iter; left time: 154331.3576s
	iters: 2600, epoch: 2 | loss: 0.6650365
	speed: 0.2060s/iter; left time: 155267.0271s
	iters: 2700, epoch: 2 | loss: 0.7418693
	speed: 0.2046s/iter; left time: 154194.5530s
	iters: 2800, epoch: 2 | loss: 0.6296149
	speed: 0.2055s/iter; left time: 154848.0919s
	iters: 2900, epoch: 2 | loss: 0.6544890
	speed: 0.2052s/iter; left time: 154629.8554s
	iters: 3000, epoch: 2 | loss: 0.6587189
	speed: 0.2035s/iter; left time: 153286.4888s
	iters: 3100, epoch: 2 | loss: 0.6267791
	speed: 0.2030s/iter; left time: 152946.4339s
	iters: 3200, epoch: 2 | loss: 0.7008030
	speed: 0.2025s/iter; left time: 152532.0650s
	iters: 3300, epoch: 2 | loss: 0.6547074
	speed: 0.2033s/iter; left time: 153087.3280s
	iters: 3400, epoch: 2 | loss: 0.7054924
	speed: 0.2030s/iter; left time: 152833.8189s
	iters: 3500, epoch: 2 | loss: 0.5825802
	speed: 0.2030s/iter; left time: 152866.5589s
	iters: 3600, epoch: 2 | loss: 0.7316645
	speed: 0.2045s/iter; left time: 153925.5313s
	iters: 3700, epoch: 2 | loss: 0.6859347
	speed: 0.2046s/iter; left time: 153984.7060s
	iters: 3800, epoch: 2 | loss: 0.6418673
	speed: 0.2068s/iter; left time: 155656.6664s
Epoch: 2 cost time: 777.9423487186432
Epoch: 2, Steps: 3801 | Train Loss: 0.6930124 Vali Loss: 0.8329864 Test Loss: 0.8462750
Validation loss decreased (0.943749 --> 0.832986).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6689039
	speed: 5.7103s/iter; left time: 4297014.6203s
	iters: 200, epoch: 3 | loss: 0.6341619
	speed: 0.2128s/iter; left time: 160107.7337s
	iters: 300, epoch: 3 | loss: 0.6700972
	speed: 0.2122s/iter; left time: 159660.9983s
	iters: 400, epoch: 3 | loss: 0.6243433
	speed: 0.2133s/iter; left time: 160446.2717s
	iters: 500, epoch: 3 | loss: 0.6145812
	speed: 0.2123s/iter; left time: 159686.4388s
	iters: 600, epoch: 3 | loss: 0.6286056
	speed: 0.2132s/iter; left time: 160339.0719s
	iters: 700, epoch: 3 | loss: 0.6970862
	speed: 0.2130s/iter; left time: 160181.7549s
	iters: 800, epoch: 3 | loss: 0.6405897
	speed: 0.2126s/iter; left time: 159855.5735s
	iters: 900, epoch: 3 | loss: 0.6758883
	speed: 0.2130s/iter; left time: 160099.2947s
	iters: 1000, epoch: 3 | loss: 0.5515821
	speed: 0.2127s/iter; left time: 159859.1883s
	iters: 1100, epoch: 3 | loss: 0.6397584
	speed: 0.2134s/iter; left time: 160397.6235s
	iters: 1200, epoch: 3 | loss: 0.5573172
	speed: 0.2130s/iter; left time: 160051.5875s
	iters: 1300, epoch: 3 | loss: 0.5599059
	speed: 0.2133s/iter; left time: 160287.2417s
	iters: 1400, epoch: 3 | loss: 0.7208335
	speed: 0.2128s/iter; left time: 159855.1756s
	iters: 1500, epoch: 3 | loss: 0.6407255
	speed: 0.2133s/iter; left time: 160222.2845s
	iters: 1600, epoch: 3 | loss: 0.5968637
	speed: 0.2134s/iter; left time: 160263.7768s
	iters: 1700, epoch: 3 | loss: 0.6375852
	speed: 0.2122s/iter; left time: 159339.4593s
	iters: 1800, epoch: 3 | loss: 0.6486478
	speed: 0.2125s/iter; left time: 159541.4347s
	iters: 1900, epoch: 3 | loss: 0.6556016
	speed: 0.2129s/iter; left time: 159832.9806s
	iters: 2000, epoch: 3 | loss: 0.5919861
	speed: 0.2129s/iter; left time: 159834.8894s
	iters: 2100, epoch: 3 | loss: 0.6436524
	speed: 0.2123s/iter; left time: 159347.7880s
	iters: 2200, epoch: 3 | loss: 0.5609083
	speed: 0.2130s/iter; left time: 159825.7424s
	iters: 2300, epoch: 3 | loss: 0.7730318
	speed: 0.2135s/iter; left time: 160177.2476s
	iters: 2400, epoch: 3 | loss: 0.5743321
	speed: 0.2126s/iter; left time: 159504.2928s
	iters: 2500, epoch: 3 | loss: 0.5715397
	speed: 0.2132s/iter; left time: 159948.9495s
	iters: 2600, epoch: 3 | loss: 0.5734756
	speed: 0.2126s/iter; left time: 159470.2061s
	iters: 2700, epoch: 3 | loss: 0.6749995
	speed: 0.2131s/iter; left time: 159818.2946s
	iters: 2800, epoch: 3 | loss: 0.5715100
	speed: 0.2121s/iter; left time: 159060.8563s
	iters: 2900, epoch: 3 | loss: 0.6476620
	speed: 0.2121s/iter; left time: 158997.3968s
	iters: 3000, epoch: 3 | loss: 0.6365653
	speed: 0.2119s/iter; left time: 158841.7281s
	iters: 3100, epoch: 3 | loss: 0.6753516
	speed: 0.2116s/iter; left time: 158564.7796s
	iters: 3200, epoch: 3 | loss: 0.6493377
	speed: 0.2130s/iter; left time: 159595.7292s
	iters: 3300, epoch: 3 | loss: 0.5991995
	speed: 0.2117s/iter; left time: 158613.0664s
	iters: 3400, epoch: 3 | loss: 0.6658904
	speed: 0.2124s/iter; left time: 159166.0978s
	iters: 3500, epoch: 3 | loss: 0.5648057
	speed: 0.2120s/iter; left time: 158821.5349s
	iters: 3600, epoch: 3 | loss: 0.6116443
	speed: 0.2108s/iter; left time: 157862.3238s
	iters: 3700, epoch: 3 | loss: 0.6444817
	speed: 0.2034s/iter; left time: 152348.1053s
	iters: 3800, epoch: 3 | loss: 0.5908110
	speed: 0.2052s/iter; left time: 153655.6327s
Epoch: 3 cost time: 807.364803314209
Epoch: 3, Steps: 3801 | Train Loss: 0.6278861 Vali Loss: 0.7819075 Test Loss: 0.7868468
Validation loss decreased (0.832986 --> 0.781907).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.6195708
	speed: 5.7068s/iter; left time: 4272682.8562s
	iters: 200, epoch: 4 | loss: 0.5965181
	speed: 0.2122s/iter; left time: 158834.9959s
	iters: 300, epoch: 4 | loss: 0.5975218
	speed: 0.2132s/iter; left time: 159585.8977s
	iters: 400, epoch: 4 | loss: 0.5646785
	speed: 0.2130s/iter; left time: 159414.0802s
	iters: 500, epoch: 4 | loss: 0.5671256
	speed: 0.2133s/iter; left time: 159592.2291s
	iters: 600, epoch: 4 | loss: 0.5956092
	speed: 0.2124s/iter; left time: 158887.6970s
	iters: 700, epoch: 4 | loss: 0.5260823
	speed: 0.2127s/iter; left time: 159147.9904s
	iters: 800, epoch: 4 | loss: 0.5994159
	speed: 0.2114s/iter; left time: 158098.8469s
	iters: 900, epoch: 4 | loss: 0.5772442
	speed: 0.2124s/iter; left time: 158857.4510s
	iters: 1000, epoch: 4 | loss: 0.6831051
	speed: 0.2136s/iter; left time: 159763.2096s
	iters: 1100, epoch: 4 | loss: 0.6251009
	speed: 0.2126s/iter; left time: 158948.1839s
	iters: 1200, epoch: 4 | loss: 0.5443512
	speed: 0.2124s/iter; left time: 158772.0500s
	iters: 1300, epoch: 4 | loss: 0.5583566
	speed: 0.2130s/iter; left time: 159203.6966s
	iters: 1400, epoch: 4 | loss: 0.5826157
	speed: 0.2121s/iter; left time: 158530.9477s
	iters: 1500, epoch: 4 | loss: 0.5856650
	speed: 0.2130s/iter; left time: 159158.6344s
	iters: 1600, epoch: 4 | loss: 0.5495806
	speed: 0.2133s/iter; left time: 159356.0515s
	iters: 1700, epoch: 4 | loss: 0.5918002
	speed: 0.2132s/iter; left time: 159309.0410s
	iters: 1800, epoch: 4 | loss: 0.6245138
	speed: 0.2125s/iter; left time: 158702.4563s
	iters: 1900, epoch: 4 | loss: 0.5516793
	speed: 0.2127s/iter; left time: 158876.7739s
	iters: 2000, epoch: 4 | loss: 0.6576818
	speed: 0.2129s/iter; left time: 158976.3773s
	iters: 2100, epoch: 4 | loss: 0.5982794
	speed: 0.2132s/iter; left time: 159182.1217s
	iters: 2200, epoch: 4 | loss: 0.5683219
	speed: 0.2129s/iter; left time: 158984.0574s
	iters: 2300, epoch: 4 | loss: 0.5783116
	speed: 0.2131s/iter; left time: 159099.3511s
	iters: 2400, epoch: 4 | loss: 0.5114322
	speed: 0.2133s/iter; left time: 159233.8506s
	iters: 2500, epoch: 4 | loss: 0.5634696
	speed: 0.2123s/iter; left time: 158435.1030s
	iters: 2600, epoch: 4 | loss: 0.6055442
	speed: 0.2128s/iter; left time: 158826.7114s
	iters: 2700, epoch: 4 | loss: 0.5324926
	speed: 0.2127s/iter; left time: 158722.0045s
	iters: 2800, epoch: 4 | loss: 0.5780486
	speed: 0.2131s/iter; left time: 158963.9047s
	iters: 2900, epoch: 4 | loss: 0.5562306
	speed: 0.2130s/iter; left time: 158910.3417s
	iters: 3000, epoch: 4 | loss: 0.5420627
	speed: 0.2128s/iter; left time: 158695.2628s
	iters: 3100, epoch: 4 | loss: 0.6162029
	speed: 0.2133s/iter; left time: 159082.0385s
	iters: 3200, epoch: 4 | loss: 0.5310549
	speed: 0.2125s/iter; left time: 158469.1977s
	iters: 3300, epoch: 4 | loss: 0.5073091
	speed: 0.2135s/iter; left time: 159197.0847s
	iters: 3400, epoch: 4 | loss: 0.5457617
	speed: 0.2131s/iter; left time: 158833.4424s
	iters: 3500, epoch: 4 | loss: 0.6335108
	speed: 0.2129s/iter; left time: 158709.1520s
	iters: 3600, epoch: 4 | loss: 0.6231659
	speed: 0.2128s/iter; left time: 158556.2187s
	iters: 3700, epoch: 4 | loss: 0.5749927
	speed: 0.2122s/iter; left time: 158083.0904s
	iters: 3800, epoch: 4 | loss: 0.5815530
	speed: 0.2130s/iter; left time: 158676.0620s
Epoch: 4 cost time: 809.82839012146
Epoch: 4, Steps: 3801 | Train Loss: 0.5868395 Vali Loss: 0.7644206 Test Loss: 0.7618915
Validation loss decreased (0.781907 --> 0.764421).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5325059
	speed: 5.6859s/iter; left time: 4235395.6581s
	iters: 200, epoch: 5 | loss: 0.5417246
	speed: 0.2050s/iter; left time: 152675.5078s
	iters: 300, epoch: 5 | loss: 0.5597146
	speed: 0.2051s/iter; left time: 152760.6296s
	iters: 400, epoch: 5 | loss: 0.5637447
	speed: 0.2043s/iter; left time: 152115.6803s
	iters: 500, epoch: 5 | loss: 0.5805477
	speed: 0.2041s/iter; left time: 151985.9045s
	iters: 600, epoch: 5 | loss: 0.5611032
	speed: 0.2028s/iter; left time: 150981.5621s
	iters: 700, epoch: 5 | loss: 0.5920702
	speed: 0.2039s/iter; left time: 151775.7432s
	iters: 800, epoch: 5 | loss: 0.5869728
	speed: 0.2033s/iter; left time: 151297.0114s
	iters: 900, epoch: 5 | loss: 0.6005470
	speed: 0.2046s/iter; left time: 152240.8929s
	iters: 1000, epoch: 5 | loss: 0.5407680
	speed: 0.2090s/iter; left time: 155524.7447s
	iters: 1100, epoch: 5 | loss: 0.6946075
	speed: 0.2125s/iter; left time: 158111.5659s
	iters: 1200, epoch: 5 | loss: 0.5507713
	speed: 0.2133s/iter; left time: 158658.2659s
	iters: 1300, epoch: 5 | loss: 0.5272444
	speed: 0.2123s/iter; left time: 157908.2428s
	iters: 1400, epoch: 5 | loss: 0.5641108
	speed: 0.2124s/iter; left time: 157923.5045s
	iters: 1500, epoch: 5 | loss: 0.6366099
	speed: 0.2126s/iter; left time: 158059.5633s
	iters: 1600, epoch: 5 | loss: 0.5206469
	speed: 0.2126s/iter; left time: 158057.5437s
	iters: 1700, epoch: 5 | loss: 0.6064482
	speed: 0.2113s/iter; left time: 157080.1798s
	iters: 1800, epoch: 5 | loss: 0.6752068
	speed: 0.2112s/iter; left time: 156939.6284s
	iters: 1900, epoch: 5 | loss: 0.5541102
	speed: 0.2123s/iter; left time: 157746.7265s
	iters: 2000, epoch: 5 | loss: 0.5316088
	speed: 0.2125s/iter; left time: 157923.5881s
	iters: 2100, epoch: 5 | loss: 0.5451618
	speed: 0.2145s/iter; left time: 159382.8564s
	iters: 2200, epoch: 5 | loss: 0.5699744
	speed: 0.2146s/iter; left time: 159435.4126s
	iters: 2300, epoch: 5 | loss: 0.5659633
	speed: 0.2167s/iter; left time: 160943.0531s
	iters: 2400, epoch: 5 | loss: 0.6070164
	speed: 0.2218s/iter; left time: 164728.8839s
	iters: 2500, epoch: 5 | loss: 0.6651090
	speed: 0.2217s/iter; left time: 164632.5382s
	iters: 2600, epoch: 5 | loss: 0.5153504
	speed: 0.2214s/iter; left time: 164333.9053s
	iters: 2700, epoch: 5 | loss: 0.6133597
	speed: 0.2209s/iter; left time: 163953.4666s
	iters: 2800, epoch: 5 | loss: 0.5455008
	speed: 0.2227s/iter; left time: 165260.3076s
	iters: 2900, epoch: 5 | loss: 0.5191331
	speed: 0.2215s/iter; left time: 164357.7540s
	iters: 3000, epoch: 5 | loss: 0.5440698
	speed: 0.2222s/iter; left time: 164889.5710s
	iters: 3100, epoch: 5 | loss: 0.6580804
	speed: 0.2216s/iter; left time: 164412.3391s
	iters: 3200, epoch: 5 | loss: 0.4845307
	speed: 0.2221s/iter; left time: 164752.4897s
	iters: 3300, epoch: 5 | loss: 0.6031300
	speed: 0.2219s/iter; left time: 164550.9786s
	iters: 3400, epoch: 5 | loss: 0.5805480
	speed: 0.2215s/iter; left time: 164229.6012s
	iters: 3500, epoch: 5 | loss: 0.5673352
	speed: 0.2209s/iter; left time: 163774.2135s
	iters: 3600, epoch: 5 | loss: 0.5386517
	speed: 0.2211s/iter; left time: 163916.1943s
	iters: 3700, epoch: 5 | loss: 0.5419999
	speed: 0.2211s/iter; left time: 163882.1005s
	iters: 3800, epoch: 5 | loss: 0.5074173
	speed: 0.2212s/iter; left time: 163949.3066s
Epoch: 5 cost time: 815.0010843276978
Epoch: 5, Steps: 3801 | Train Loss: 0.5590598 Vali Loss: 0.8267825 Test Loss: 0.7840000
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.5137176
	speed: 5.6882s/iter; left time: 4215508.2689s
	iters: 200, epoch: 6 | loss: 0.5294208
	speed: 0.2044s/iter; left time: 151481.2263s
	iters: 300, epoch: 6 | loss: 0.5048020
	speed: 0.2052s/iter; left time: 152009.6126s
	iters: 400, epoch: 6 | loss: 0.5107632
	speed: 0.2048s/iter; left time: 151710.2663s
	iters: 500, epoch: 6 | loss: 0.4965018
	speed: 0.2044s/iter; left time: 151419.4525s
	iters: 600, epoch: 6 | loss: 0.5194670
	speed: 0.2038s/iter; left time: 150923.6606s
	iters: 700, epoch: 6 | loss: 0.5273725
	speed: 0.2031s/iter; left time: 150358.3294s
	iters: 800, epoch: 6 | loss: 0.5898458
	speed: 0.2034s/iter; left time: 150609.8398s
	iters: 900, epoch: 6 | loss: 0.5212069
	speed: 0.2040s/iter; left time: 151007.1331s
	iters: 1000, epoch: 6 | loss: 0.5671527
	speed: 0.2038s/iter; left time: 150882.3878s
	iters: 1100, epoch: 6 | loss: 0.4795771
	speed: 0.2037s/iter; left time: 150751.2568s
	iters: 1200, epoch: 6 | loss: 0.5631299
	speed: 0.2050s/iter; left time: 151734.6122s
	iters: 1300, epoch: 6 | loss: 0.4909042
	speed: 0.2062s/iter; left time: 152558.9901s
	iters: 1400, epoch: 6 | loss: 0.5402989
	speed: 0.2054s/iter; left time: 151921.7922s
	iters: 1500, epoch: 6 | loss: 0.4897419
	speed: 0.2056s/iter; left time: 152109.7038s
	iters: 1600, epoch: 6 | loss: 0.5212454
	speed: 0.2036s/iter; left time: 150569.8159s
	iters: 1700, epoch: 6 | loss: 0.5767754
	speed: 0.2039s/iter; left time: 150774.2645s
	iters: 1800, epoch: 6 | loss: 0.5502955
	speed: 0.2034s/iter; left time: 150396.0439s
	iters: 1900, epoch: 6 | loss: 0.5524500
	speed: 0.2054s/iter; left time: 151853.7759s
	iters: 2000, epoch: 6 | loss: 0.5496839
	speed: 0.2116s/iter; left time: 156416.1900s
	iters: 2100, epoch: 6 | loss: 0.4704332
	speed: 0.2096s/iter; left time: 154947.0792s
	iters: 2200, epoch: 6 | loss: 0.5304020
	speed: 0.2058s/iter; left time: 152077.8547s
	iters: 2300, epoch: 6 | loss: 0.4756548
	speed: 0.2055s/iter; left time: 151843.3197s
	iters: 2400, epoch: 6 | loss: 0.5620813
	speed: 0.2063s/iter; left time: 152383.3402s
	iters: 2500, epoch: 6 | loss: 0.4698407
	speed: 0.2055s/iter; left time: 151797.8695s
	iters: 2600, epoch: 6 | loss: 0.5563241
	speed: 0.2032s/iter; left time: 150053.8289s
	iters: 2700, epoch: 6 | loss: 0.5855231
	speed: 0.2039s/iter; left time: 150570.2112s
	iters: 2800, epoch: 6 | loss: 0.7384639
	speed: 0.2033s/iter; left time: 150137.7449s
	iters: 2900, epoch: 6 | loss: 0.5111841
	speed: 0.2034s/iter; left time: 150166.0261s
	iters: 3000, epoch: 6 | loss: 0.5315344
	speed: 0.2033s/iter; left time: 150068.0250s
	iters: 3100, epoch: 6 | loss: 0.5241623
	speed: 0.2033s/iter; left time: 150063.4176s
	iters: 3200, epoch: 6 | loss: 0.4911790
	speed: 0.2041s/iter; left time: 150639.5671s
	iters: 3300, epoch: 6 | loss: 0.5284511
	speed: 0.2049s/iter; left time: 151224.3602s
	iters: 3400, epoch: 6 | loss: 0.5548776
	speed: 0.2055s/iter; left time: 151591.8547s
	iters: 3500, epoch: 6 | loss: 0.5291886
	speed: 0.2046s/iter; left time: 150963.7362s
	iters: 3600, epoch: 6 | loss: 0.5598658
	speed: 0.2046s/iter; left time: 150927.5926s
	iters: 3700, epoch: 6 | loss: 0.6326527
	speed: 0.2042s/iter; left time: 150576.0006s
	iters: 3800, epoch: 6 | loss: 0.5567203
	speed: 0.2049s/iter; left time: 151087.9521s
Epoch: 6 cost time: 779.2496302127838
Epoch: 6, Steps: 3801 | Train Loss: 0.5326515 Vali Loss: 0.8969933 Test Loss: 0.8670425
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 0.4667666
	speed: 5.7208s/iter; left time: 4217894.5961s
	iters: 200, epoch: 7 | loss: 0.5378014
	speed: 0.2125s/iter; left time: 156672.4117s
	iters: 300, epoch: 7 | loss: 0.5374194
	speed: 0.2137s/iter; left time: 157501.3386s
	iters: 400, epoch: 7 | loss: 0.5292383
	speed: 0.2130s/iter; left time: 157008.4160s
	iters: 500, epoch: 7 | loss: 0.4912947
	speed: 0.2129s/iter; left time: 156852.9645s
	iters: 600, epoch: 7 | loss: 0.4664371
	speed: 0.2116s/iter; left time: 155913.7539s
	iters: 700, epoch: 7 | loss: 0.5682093
	speed: 0.2113s/iter; left time: 155634.1869s
	iters: 800, epoch: 7 | loss: 0.5559456
	speed: 0.2124s/iter; left time: 156461.2551s
	iters: 900, epoch: 7 | loss: 0.5103351
	speed: 0.2121s/iter; left time: 156210.0156s
	iters: 1000, epoch: 7 | loss: 0.5587754
	speed: 0.2125s/iter; left time: 156452.8739s
	iters: 1100, epoch: 7 | loss: 0.5702053
	speed: 0.2119s/iter; left time: 156001.9958s
	iters: 1200, epoch: 7 | loss: 0.5006970
	speed: 0.2123s/iter; left time: 156311.4332s
	iters: 1300, epoch: 7 | loss: 0.6397310
	speed: 0.2120s/iter; left time: 156084.0899s
	iters: 1400, epoch: 7 | loss: 0.5812234
	speed: 0.2122s/iter; left time: 156190.5084s
	iters: 1500, epoch: 7 | loss: 0.5075090
	speed: 0.2130s/iter; left time: 156778.3633s
	iters: 1600, epoch: 7 | loss: 0.5483563
	speed: 0.2117s/iter; left time: 155789.1866s
	iters: 1700, epoch: 7 | loss: 0.5356877
	speed: 0.2118s/iter; left time: 155834.3039s
	iters: 1800, epoch: 7 | loss: 0.4961925
	speed: 0.2128s/iter; left time: 156513.4650s
	iters: 1900, epoch: 7 | loss: 0.4636087
	speed: 0.2131s/iter; left time: 156767.2578s
	iters: 2000, epoch: 7 | loss: 0.5326678
	speed: 0.2139s/iter; left time: 157311.9565s
	iters: 2100, epoch: 7 | loss: 0.4749350
	speed: 0.2125s/iter; left time: 156243.0086s
	iters: 2200, epoch: 7 | loss: 0.5220077
	speed: 0.2114s/iter; left time: 155444.0396s
	iters: 2300, epoch: 7 | loss: 0.5251133
	speed: 0.2122s/iter; left time: 155956.8094s
	iters: 2400, epoch: 7 | loss: 0.4675580
	speed: 0.2122s/iter; left time: 155967.2587s
	iters: 2500, epoch: 7 | loss: 0.5529183
	speed: 0.2122s/iter; left time: 155952.8175s
	iters: 2600, epoch: 7 | loss: 0.4578753
	speed: 0.2118s/iter; left time: 155655.8738s
	iters: 2700, epoch: 7 | loss: 0.5192929
	speed: 0.2119s/iter; left time: 155693.5509s
	iters: 2800, epoch: 7 | loss: 0.5658149
	speed: 0.2123s/iter; left time: 155918.4168s
	iters: 2900, epoch: 7 | loss: 0.4524898
	speed: 0.2122s/iter; left time: 155835.6030s
	iters: 3000, epoch: 7 | loss: 0.4822596
	speed: 0.2120s/iter; left time: 155689.7373s
	iters: 3100, epoch: 7 | loss: 0.5000995
	speed: 0.2115s/iter; left time: 155318.9061s
	iters: 3200, epoch: 7 | loss: 0.5028505
	speed: 0.2127s/iter; left time: 156181.7909s
	iters: 3300, epoch: 7 | loss: 0.4983098
	speed: 0.2132s/iter; left time: 156543.9651s
	iters: 3400, epoch: 7 | loss: 0.4778442
	speed: 0.2113s/iter; left time: 155113.1589s
	iters: 3500, epoch: 7 | loss: 0.5502547
	speed: 0.2117s/iter; left time: 155375.9130s
	iters: 3600, epoch: 7 | loss: 0.5221119
	speed: 0.2122s/iter; left time: 155742.4089s
	iters: 3700, epoch: 7 | loss: 0.5474834
	speed: 0.2122s/iter; left time: 155711.1054s
	iters: 3800, epoch: 7 | loss: 0.4702528
	speed: 0.2128s/iter; left time: 156073.1625s
Epoch: 7 cost time: 807.8359739780426
Epoch: 7, Steps: 3801 | Train Loss: 0.5180934 Vali Loss: 0.7729935 Test Loss: 0.7843674
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 8 | loss: 0.5813503
	speed: 5.6910s/iter; left time: 4174279.8672s
	iters: 200, epoch: 8 | loss: 0.4203890
	speed: 0.2049s/iter; left time: 150239.8832s
	iters: 300, epoch: 8 | loss: 0.4847546
	speed: 0.2111s/iter; left time: 154767.5976s
	iters: 400, epoch: 8 | loss: 0.4837506
	speed: 0.2124s/iter; left time: 155700.6518s
	iters: 500, epoch: 8 | loss: 0.4570938
	speed: 0.2121s/iter; left time: 155507.2211s
	iters: 600, epoch: 8 | loss: 0.5483383
	speed: 0.2122s/iter; left time: 155505.8142s
	iters: 700, epoch: 8 | loss: 0.4916275
	speed: 0.2118s/iter; left time: 155212.8468s
	iters: 800, epoch: 8 | loss: 0.4101667
	speed: 0.2120s/iter; left time: 155382.5849s
	iters: 900, epoch: 8 | loss: 0.5282578
	speed: 0.2119s/iter; left time: 155279.5622s
	iters: 1000, epoch: 8 | loss: 0.4722195
	speed: 0.2127s/iter; left time: 155789.8562s
	iters: 1100, epoch: 8 | loss: 0.4325772
	speed: 0.2120s/iter; left time: 155269.0796s
	iters: 1200, epoch: 8 | loss: 0.5735677
	speed: 0.2121s/iter; left time: 155309.6336s
	iters: 1300, epoch: 8 | loss: 0.4916013
	speed: 0.2129s/iter; left time: 155933.2154s
	iters: 1400, epoch: 8 | loss: 0.4722948
	speed: 0.2130s/iter; left time: 155948.1935s
	iters: 1500, epoch: 8 | loss: 0.4744071
	speed: 0.2121s/iter; left time: 155270.3042s
	iters: 1600, epoch: 8 | loss: 0.5966882
	speed: 0.2119s/iter; left time: 155091.6895s
	iters: 1700, epoch: 8 | loss: 0.4212301
	speed: 0.2123s/iter; left time: 155360.1637s
	iters: 1800, epoch: 8 | loss: 0.4436983
	speed: 0.2118s/iter; left time: 154998.6613s
	iters: 1900, epoch: 8 | loss: 0.4922242
	speed: 0.2123s/iter; left time: 155316.0940s
	iters: 2000, epoch: 8 | loss: 0.4691363
	speed: 0.2117s/iter; left time: 154875.4171s
	iters: 2100, epoch: 8 | loss: 0.4723426
	speed: 0.2120s/iter; left time: 155100.1017s
	iters: 2200, epoch: 8 | loss: 0.4508629
	speed: 0.2121s/iter; left time: 155105.5085s
	iters: 2300, epoch: 8 | loss: 0.5135525
	speed: 0.2117s/iter; left time: 154816.8007s
	iters: 2400, epoch: 8 | loss: 0.5901375
	speed: 0.2124s/iter; left time: 155298.8364s
	iters: 2500, epoch: 8 | loss: 0.5557150
	speed: 0.2110s/iter; left time: 154271.5723s
	iters: 2600, epoch: 8 | loss: 0.4593392
	speed: 0.2112s/iter; left time: 154374.7012s
	iters: 2700, epoch: 8 | loss: 0.4497011
	speed: 0.2108s/iter; left time: 154062.9715s
	iters: 2800, epoch: 8 | loss: 0.4814797
	speed: 0.2116s/iter; left time: 154609.6876s
	iters: 2900, epoch: 8 | loss: 0.5035689
	speed: 0.2107s/iter; left time: 153971.6691s
	iters: 3000, epoch: 8 | loss: 0.5784757
	speed: 0.2108s/iter; left time: 153986.7532s
	iters: 3100, epoch: 8 | loss: 0.4997464
	speed: 0.2063s/iter; left time: 150723.3296s
	iters: 3200, epoch: 8 | loss: 0.4716375
	speed: 0.2034s/iter; left time: 148550.8704s
	iters: 3300, epoch: 8 | loss: 0.4587971
	speed: 0.2090s/iter; left time: 152623.2162s
	iters: 3400, epoch: 8 | loss: 0.4616647
	speed: 0.2087s/iter; left time: 152367.6521s
	iters: 3500, epoch: 8 | loss: 0.6610847
	speed: 0.2082s/iter; left time: 152016.8778s
	iters: 3600, epoch: 8 | loss: 0.4786049
	speed: 0.2091s/iter; left time: 152613.0810s
	iters: 3700, epoch: 8 | loss: 0.5457198
	speed: 0.2084s/iter; left time: 152121.8990s
	iters: 3800, epoch: 8 | loss: 0.4954513
	speed: 0.2104s/iter; left time: 153519.8000s
Epoch: 8 cost time: 801.5842921733856
Epoch: 8, Steps: 3801 | Train Loss: 0.5081032 Vali Loss: 0.7991953 Test Loss: 0.7774150
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 9 | loss: 0.4801367
	speed: 5.7144s/iter; left time: 4169780.3239s
	iters: 200, epoch: 9 | loss: 0.4621979
	speed: 0.2127s/iter; left time: 155171.0804s
	iters: 300, epoch: 9 | loss: 0.4803568
	speed: 0.2133s/iter; left time: 155574.3711s
	iters: 400, epoch: 9 | loss: 0.5018170
	speed: 0.2130s/iter; left time: 155358.9349s
	iters: 500, epoch: 9 | loss: 0.5399660
	speed: 0.2120s/iter; left time: 154590.1170s
	iters: 600, epoch: 9 | loss: 0.4758561
	speed: 0.2123s/iter; left time: 154773.4180s
	iters: 700, epoch: 9 | loss: 0.4305882
	speed: 0.2126s/iter; left time: 155036.0838s
	iters: 800, epoch: 9 | loss: 0.4892288
	speed: 0.2123s/iter; left time: 154794.1127s
	iters: 900, epoch: 9 | loss: 0.5089744
	speed: 0.2132s/iter; left time: 155422.1338s
	iters: 1000, epoch: 9 | loss: 0.4546990
	speed: 0.2133s/iter; left time: 155423.5592s
	iters: 1100, epoch: 9 | loss: 0.5356702
	speed: 0.2135s/iter; left time: 155590.9394s
	iters: 1200, epoch: 9 | loss: 0.5330701
	speed: 0.2130s/iter; left time: 155162.1885s
	iters: 1300, epoch: 9 | loss: 0.4891327
	speed: 0.2132s/iter; left time: 155342.3493s
	iters: 1400, epoch: 9 | loss: 0.5162142
	speed: 0.2142s/iter; left time: 156009.0187s
	iters: 1500, epoch: 9 | loss: 0.4975561
	speed: 0.2126s/iter; left time: 154853.4245s
	iters: 1600, epoch: 9 | loss: 0.4186681
	speed: 0.2124s/iter; left time: 154667.4085s
	iters: 1700, epoch: 9 | loss: 0.4517873
	speed: 0.2126s/iter; left time: 154797.3333s
	iters: 1800, epoch: 9 | loss: 0.4770303
	speed: 0.2128s/iter; left time: 154952.8976s
	iters: 1900, epoch: 9 | loss: 0.5049660
	speed: 0.2133s/iter; left time: 155228.8123s
	iters: 2000, epoch: 9 | loss: 0.4449671
	speed: 0.2124s/iter; left time: 154603.9393s
	iters: 2100, epoch: 9 | loss: 0.3981806
	speed: 0.2134s/iter; left time: 155262.9222s
	iters: 2200, epoch: 9 | loss: 0.4881805
	speed: 0.2127s/iter; left time: 154728.7150s
	iters: 2300, epoch: 9 | loss: 0.5362250
	speed: 0.2127s/iter; left time: 154766.6331s
	iters: 2400, epoch: 9 | loss: 0.4553634
	speed: 0.2119s/iter; left time: 154101.3196s
	iters: 2500, epoch: 9 | loss: 0.4380245
	speed: 0.2121s/iter; left time: 154227.2139s
	iters: 2600, epoch: 9 | loss: 0.4633437
	speed: 0.2122s/iter; left time: 154320.5632s
	iters: 2700, epoch: 9 | loss: 0.5731736
	speed: 0.2121s/iter; left time: 154208.7634s
	iters: 2800, epoch: 9 | loss: 0.7254200
	speed: 0.2125s/iter; left time: 154478.3462s
	iters: 2900, epoch: 9 | loss: 0.4956618
	speed: 0.2119s/iter; left time: 153993.4861s
	iters: 3000, epoch: 9 | loss: 0.4325362
	speed: 0.2124s/iter; left time: 154363.7703s
	iters: 3100, epoch: 9 | loss: 0.4769682
	speed: 0.2126s/iter; left time: 154483.7792s
	iters: 3200, epoch: 9 | loss: 0.5522140
	speed: 0.2116s/iter; left time: 153726.1944s
	iters: 3300, epoch: 9 | loss: 0.4764798
	speed: 0.2131s/iter; left time: 154788.9923s
	iters: 3400, epoch: 9 | loss: 0.4494553
	speed: 0.2128s/iter; left time: 154575.5608s
	iters: 3500, epoch: 9 | loss: 0.5546304
	speed: 0.2131s/iter; left time: 154757.6559s
	iters: 3600, epoch: 9 | loss: 0.5727645
	speed: 0.2132s/iter; left time: 154851.3220s
	iters: 3700, epoch: 9 | loss: 0.5471401
	speed: 0.2131s/iter; left time: 154725.5516s
	iters: 3800, epoch: 9 | loss: 0.5254259
	speed: 0.2131s/iter; left time: 154715.0587s
Epoch: 9 cost time: 809.3901977539062
Epoch: 9, Steps: 3801 | Train Loss: 0.4933117 Vali Loss: 0.7960747 Test Loss: 0.7931435
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 300059
test shape: (30005, 1, 336, 822) (30005, 1, 336, 822)
test shape: (30005, 336, 822) (30005, 336, 822)
mse:0.7618616223335266, mae:0.678947925567627
>>>>>>>Overall time: 13544 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
