Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164662
val 247966
test 247965
	iters: 100, epoch: 1 | loss: 1.2992151
	speed: 0.1359s/iter; left time: 98907.6210s
	iters: 200, epoch: 1 | loss: 1.1441711
	speed: 0.1320s/iter; left time: 96057.1339s
	iters: 300, epoch: 1 | loss: 1.1410319
	speed: 0.1320s/iter; left time: 96010.9731s
	iters: 400, epoch: 1 | loss: 0.9329027
	speed: 0.1323s/iter; left time: 96231.8504s
	iters: 500, epoch: 1 | loss: 1.1036478
	speed: 0.1321s/iter; left time: 96068.8847s
	iters: 600, epoch: 1 | loss: 0.8732244
	speed: 0.1323s/iter; left time: 96241.9134s
	iters: 700, epoch: 1 | loss: 1.0546166
	speed: 0.1325s/iter; left time: 96366.2148s
	iters: 800, epoch: 1 | loss: 1.0056078
	speed: 0.1319s/iter; left time: 95905.9730s
	iters: 900, epoch: 1 | loss: 1.0250894
	speed: 0.1327s/iter; left time: 96495.7861s
	iters: 1000, epoch: 1 | loss: 1.2453301
	speed: 0.1319s/iter; left time: 95837.0481s
	iters: 1100, epoch: 1 | loss: 1.1140679
	speed: 0.1319s/iter; left time: 95864.5917s
	iters: 1200, epoch: 1 | loss: 1.3781404
	speed: 0.1317s/iter; left time: 95664.1968s
	iters: 1300, epoch: 1 | loss: 1.2201334
	speed: 0.1318s/iter; left time: 95785.7961s
	iters: 1400, epoch: 1 | loss: 1.1100765
	speed: 0.1317s/iter; left time: 95645.8678s
	iters: 1500, epoch: 1 | loss: 1.0380517
	speed: 0.1316s/iter; left time: 95560.1555s
	iters: 1600, epoch: 1 | loss: 1.0638176
	speed: 0.1318s/iter; left time: 95678.1501s
	iters: 1700, epoch: 1 | loss: 1.1645796
	speed: 0.1320s/iter; left time: 95836.3944s
	iters: 1800, epoch: 1 | loss: 1.1137284
	speed: 0.1318s/iter; left time: 95695.2632s
	iters: 1900, epoch: 1 | loss: 1.2541901
	speed: 0.1315s/iter; left time: 95480.9802s
	iters: 2000, epoch: 1 | loss: 1.1104196
	speed: 0.1320s/iter; left time: 95787.2391s
	iters: 2100, epoch: 1 | loss: 1.0312477
	speed: 0.1316s/iter; left time: 95506.6504s
	iters: 2200, epoch: 1 | loss: 1.0019715
	speed: 0.1319s/iter; left time: 95685.8553s
	iters: 2300, epoch: 1 | loss: 0.9969952
	speed: 0.1318s/iter; left time: 95607.3103s
	iters: 2400, epoch: 1 | loss: 1.0341778
	speed: 0.1318s/iter; left time: 95615.2424s
	iters: 2500, epoch: 1 | loss: 1.0925757
	speed: 0.1318s/iter; left time: 95618.8559s
	iters: 2600, epoch: 1 | loss: 1.0634656
	speed: 0.1318s/iter; left time: 95573.0080s
	iters: 2700, epoch: 1 | loss: 1.1233770
	speed: 0.1317s/iter; left time: 95501.5349s
	iters: 2800, epoch: 1 | loss: 1.0280299
	speed: 0.1318s/iter; left time: 95569.0211s
	iters: 2900, epoch: 1 | loss: 0.9087145
	speed: 0.1319s/iter; left time: 95618.8149s
	iters: 3000, epoch: 1 | loss: 0.9775315
	speed: 0.1321s/iter; left time: 95724.8743s
	iters: 3100, epoch: 1 | loss: 0.9718559
	speed: 0.1317s/iter; left time: 95429.7005s
	iters: 3200, epoch: 1 | loss: 0.9664959
	speed: 0.1317s/iter; left time: 95439.8876s
	iters: 3300, epoch: 1 | loss: 1.0452409
	speed: 0.1321s/iter; left time: 95679.4752s
	iters: 3400, epoch: 1 | loss: 1.0501628
	speed: 0.1320s/iter; left time: 95631.7112s
	iters: 3500, epoch: 1 | loss: 1.0136158
	speed: 0.1318s/iter; left time: 95461.7066s
	iters: 3600, epoch: 1 | loss: 1.0004414
	speed: 0.1317s/iter; left time: 95364.7300s
Epoch: 1 cost time: 480.64821887016296
Epoch: 1, Steps: 3639 | Train Loss: 1.0895383 Vali Loss: 1.4307238 Test Loss: 1.3188294
Validation loss decreased (inf --> 1.430724).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9004186
	speed: 3.4174s/iter; left time: 2474421.7149s
	iters: 200, epoch: 2 | loss: 0.9267299
	speed: 0.1316s/iter; left time: 95269.8976s
	iters: 300, epoch: 2 | loss: 1.0644637
	speed: 0.1313s/iter; left time: 95056.6326s
	iters: 400, epoch: 2 | loss: 1.1505741
	speed: 0.1327s/iter; left time: 96011.2612s
	iters: 500, epoch: 2 | loss: 0.9967197
	speed: 0.1308s/iter; left time: 94673.0016s
	iters: 600, epoch: 2 | loss: 0.9489444
	speed: 0.1323s/iter; left time: 95750.2674s
	iters: 700, epoch: 2 | loss: 0.9721418
	speed: 0.1306s/iter; left time: 94510.0529s
	iters: 800, epoch: 2 | loss: 0.8965027
	speed: 0.1317s/iter; left time: 95239.4975s
	iters: 900, epoch: 2 | loss: 0.9797061
	speed: 0.1319s/iter; left time: 95370.0541s
	iters: 1000, epoch: 2 | loss: 0.9778920
	speed: 0.1320s/iter; left time: 95437.0756s
	iters: 1100, epoch: 2 | loss: 0.9858835
	speed: 0.1321s/iter; left time: 95521.0347s
	iters: 1200, epoch: 2 | loss: 0.9133996
	speed: 0.1322s/iter; left time: 95593.6752s
	iters: 1300, epoch: 2 | loss: 0.9997087
	speed: 0.1322s/iter; left time: 95546.8146s
	iters: 1400, epoch: 2 | loss: 0.9625427
	speed: 0.1333s/iter; left time: 96343.7553s
	iters: 1500, epoch: 2 | loss: 1.0355151
	speed: 0.1319s/iter; left time: 95338.3258s
	iters: 1600, epoch: 2 | loss: 1.0522605
	speed: 0.1320s/iter; left time: 95382.1776s
	iters: 1700, epoch: 2 | loss: 0.9244488
	speed: 0.1320s/iter; left time: 95358.7335s
	iters: 1800, epoch: 2 | loss: 0.9853594
	speed: 0.1321s/iter; left time: 95437.7123s
	iters: 1900, epoch: 2 | loss: 0.9075519
	speed: 0.1319s/iter; left time: 95278.8617s
	iters: 2000, epoch: 2 | loss: 0.9689528
	speed: 0.1316s/iter; left time: 95058.2330s
	iters: 2100, epoch: 2 | loss: 0.9818528
	speed: 0.1320s/iter; left time: 95279.8316s
	iters: 2200, epoch: 2 | loss: 0.9728269
	speed: 0.1316s/iter; left time: 95045.2642s
	iters: 2300, epoch: 2 | loss: 0.9363964
	speed: 0.1319s/iter; left time: 95205.3303s
	iters: 2400, epoch: 2 | loss: 0.9581194
	speed: 0.1317s/iter; left time: 95076.7918s
	iters: 2500, epoch: 2 | loss: 0.9609054
	speed: 0.1322s/iter; left time: 95381.0170s
	iters: 2600, epoch: 2 | loss: 0.9945524
	speed: 0.1293s/iter; left time: 93265.9309s
	iters: 2700, epoch: 2 | loss: 1.0582448
	speed: 0.1310s/iter; left time: 94505.3530s
	iters: 2800, epoch: 2 | loss: 0.9044960
	speed: 0.1323s/iter; left time: 95463.0449s
	iters: 2900, epoch: 2 | loss: 0.9606391
	speed: 0.1320s/iter; left time: 95177.4815s
	iters: 3000, epoch: 2 | loss: 0.9250706
	speed: 0.1323s/iter; left time: 95441.8233s
	iters: 3100, epoch: 2 | loss: 0.8523917
	speed: 0.1326s/iter; left time: 95643.1984s
	iters: 3200, epoch: 2 | loss: 0.8408476
	speed: 0.1326s/iter; left time: 95612.2484s
	iters: 3300, epoch: 2 | loss: 0.9354942
	speed: 0.1317s/iter; left time: 94945.9801s
	iters: 3400, epoch: 2 | loss: 1.0043669
	speed: 0.1319s/iter; left time: 95074.0123s
	iters: 3500, epoch: 2 | loss: 0.8953125
	speed: 0.1325s/iter; left time: 95471.0606s
	iters: 3600, epoch: 2 | loss: 0.9020727
	speed: 0.1321s/iter; left time: 95165.4550s
Epoch: 2 cost time: 480.27360486984253
Epoch: 2, Steps: 3639 | Train Loss: 0.9682223 Vali Loss: 1.4225206 Test Loss: 1.2351582
Validation loss decreased (1.430724 --> 1.422521).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8918567
	speed: 3.4008s/iter; left time: 2450002.7086s
	iters: 200, epoch: 3 | loss: 0.8831440
	speed: 0.1316s/iter; left time: 94806.9138s
	iters: 300, epoch: 3 | loss: 0.8404445
	speed: 0.1319s/iter; left time: 94970.5803s
	iters: 400, epoch: 3 | loss: 0.8704465
	speed: 0.1318s/iter; left time: 94946.4607s
	iters: 500, epoch: 3 | loss: 0.9639271
	speed: 0.1318s/iter; left time: 94905.6445s
	iters: 600, epoch: 3 | loss: 0.9180118
	speed: 0.1318s/iter; left time: 94912.1304s
	iters: 700, epoch: 3 | loss: 0.9704463
	speed: 0.1322s/iter; left time: 95162.3376s
	iters: 800, epoch: 3 | loss: 0.9240410
	speed: 0.1319s/iter; left time: 94905.1465s
	iters: 900, epoch: 3 | loss: 0.9091402
	speed: 0.1316s/iter; left time: 94737.9456s
	iters: 1000, epoch: 3 | loss: 0.7494790
	speed: 0.1316s/iter; left time: 94668.3192s
	iters: 1100, epoch: 3 | loss: 0.9214808
	speed: 0.1318s/iter; left time: 94817.0926s
	iters: 1200, epoch: 3 | loss: 0.9239623
	speed: 0.1318s/iter; left time: 94818.5591s
	iters: 1300, epoch: 3 | loss: 0.8883570
	speed: 0.1318s/iter; left time: 94772.2637s
	iters: 1400, epoch: 3 | loss: 0.8478812
	speed: 0.1321s/iter; left time: 95026.8282s
	iters: 1500, epoch: 3 | loss: 0.8833082
	speed: 0.1319s/iter; left time: 94862.0884s
	iters: 1600, epoch: 3 | loss: 0.8472404
	speed: 0.1319s/iter; left time: 94795.4221s
	iters: 1700, epoch: 3 | loss: 0.8315865
	speed: 0.1318s/iter; left time: 94717.5658s
	iters: 1800, epoch: 3 | loss: 0.8597067
	speed: 0.1317s/iter; left time: 94635.0735s
	iters: 1900, epoch: 3 | loss: 0.7302157
	speed: 0.1317s/iter; left time: 94619.1633s
	iters: 2000, epoch: 3 | loss: 0.8773026
	speed: 0.1322s/iter; left time: 94983.0122s
	iters: 2100, epoch: 3 | loss: 0.8720347
	speed: 0.1318s/iter; left time: 94655.8834s
	iters: 2200, epoch: 3 | loss: 0.8280710
	speed: 0.1317s/iter; left time: 94617.6592s
	iters: 2300, epoch: 3 | loss: 0.8185155
	speed: 0.1318s/iter; left time: 94659.3415s
	iters: 2400, epoch: 3 | loss: 0.9001245
	speed: 0.1319s/iter; left time: 94742.2950s
	iters: 2500, epoch: 3 | loss: 0.9285294
	speed: 0.1319s/iter; left time: 94717.3275s
	iters: 2600, epoch: 3 | loss: 1.0155941
	speed: 0.1322s/iter; left time: 94930.3133s
	iters: 2700, epoch: 3 | loss: 0.8685117
	speed: 0.1321s/iter; left time: 94847.0436s
	iters: 2800, epoch: 3 | loss: 0.8810108
	speed: 0.1317s/iter; left time: 94542.4516s
	iters: 2900, epoch: 3 | loss: 0.8987659
	speed: 0.1318s/iter; left time: 94575.3428s
	iters: 3000, epoch: 3 | loss: 0.8820127
	speed: 0.1316s/iter; left time: 94443.4766s
	iters: 3100, epoch: 3 | loss: 0.8202935
	speed: 0.1318s/iter; left time: 94552.2946s
	iters: 3200, epoch: 3 | loss: 0.8229687
	speed: 0.1318s/iter; left time: 94565.8461s
	iters: 3300, epoch: 3 | loss: 0.8711076
	speed: 0.1317s/iter; left time: 94424.6649s
	iters: 3400, epoch: 3 | loss: 0.9449932
	speed: 0.1318s/iter; left time: 94538.1069s
	iters: 3500, epoch: 3 | loss: 0.9316343
	speed: 0.1318s/iter; left time: 94502.8113s
	iters: 3600, epoch: 3 | loss: 0.8288403
	speed: 0.1319s/iter; left time: 94540.0773s
Epoch: 3 cost time: 480.02564549446106
Epoch: 3, Steps: 3639 | Train Loss: 0.8840556 Vali Loss: 1.4982220 Test Loss: 1.3213888
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.8478945
	speed: 3.4198s/iter; left time: 2451226.2121s
	iters: 200, epoch: 4 | loss: 0.7488553
	speed: 0.1337s/iter; left time: 95840.3531s
	iters: 300, epoch: 4 | loss: 0.8460910
	speed: 0.1322s/iter; left time: 94699.6741s
	iters: 400, epoch: 4 | loss: 0.7647126
	speed: 0.1320s/iter; left time: 94542.3609s
	iters: 500, epoch: 4 | loss: 0.8611230
	speed: 0.1318s/iter; left time: 94402.9500s
	iters: 600, epoch: 4 | loss: 0.7658001
	speed: 0.1320s/iter; left time: 94583.8876s
	iters: 700, epoch: 4 | loss: 0.8631347
	speed: 0.1317s/iter; left time: 94288.0565s
	iters: 800, epoch: 4 | loss: 0.8910121
	speed: 0.1322s/iter; left time: 94696.6365s
	iters: 900, epoch: 4 | loss: 0.8589211
	speed: 0.1324s/iter; left time: 94790.6843s
	iters: 1000, epoch: 4 | loss: 0.8706453
	speed: 0.1323s/iter; left time: 94714.0613s
	iters: 1100, epoch: 4 | loss: 0.7205582
	speed: 0.1319s/iter; left time: 94382.9957s
	iters: 1200, epoch: 4 | loss: 0.8547477
	speed: 0.1320s/iter; left time: 94493.2657s
	iters: 1300, epoch: 4 | loss: 0.8117065
	speed: 0.1321s/iter; left time: 94529.1397s
	iters: 1400, epoch: 4 | loss: 0.8481359
	speed: 0.1322s/iter; left time: 94581.5553s
	iters: 1500, epoch: 4 | loss: 0.7964102
	speed: 0.1320s/iter; left time: 94451.4575s
	iters: 1600, epoch: 4 | loss: 0.8526046
	speed: 0.1321s/iter; left time: 94491.1228s
	iters: 1700, epoch: 4 | loss: 0.7890129
	speed: 0.1320s/iter; left time: 94385.9224s
	iters: 1800, epoch: 4 | loss: 0.8893507
	speed: 0.1318s/iter; left time: 94271.7782s
	iters: 1900, epoch: 4 | loss: 0.8305485
	speed: 0.1321s/iter; left time: 94428.0614s
	iters: 2000, epoch: 4 | loss: 0.7817393
	speed: 0.1322s/iter; left time: 94513.6714s
	iters: 2100, epoch: 4 | loss: 0.7459043
	speed: 0.1323s/iter; left time: 94575.4378s
	iters: 2200, epoch: 4 | loss: 0.8027323
	speed: 0.1321s/iter; left time: 94432.6440s
	iters: 2300, epoch: 4 | loss: 0.7692112
	speed: 0.1318s/iter; left time: 94183.9878s
	iters: 2400, epoch: 4 | loss: 0.8122470
	speed: 0.1323s/iter; left time: 94561.7079s
	iters: 2500, epoch: 4 | loss: 0.7680840
	speed: 0.1316s/iter; left time: 94019.1722s
	iters: 2600, epoch: 4 | loss: 0.7466936
	speed: 0.1325s/iter; left time: 94617.5093s
	iters: 2700, epoch: 4 | loss: 0.8462562
	speed: 0.1318s/iter; left time: 94123.2554s
	iters: 2800, epoch: 4 | loss: 0.8000344
	speed: 0.1319s/iter; left time: 94186.5189s
	iters: 2900, epoch: 4 | loss: 0.7671984
	speed: 0.1319s/iter; left time: 94150.4574s
	iters: 3000, epoch: 4 | loss: 0.7736854
	speed: 0.1317s/iter; left time: 94021.4645s
	iters: 3100, epoch: 4 | loss: 0.7549109
	speed: 0.1318s/iter; left time: 94091.1425s
	iters: 3200, epoch: 4 | loss: 0.8297800
	speed: 0.1318s/iter; left time: 94098.4693s
	iters: 3300, epoch: 4 | loss: 0.7236640
	speed: 0.1320s/iter; left time: 94206.7057s
	iters: 3400, epoch: 4 | loss: 0.8286021
	speed: 0.1321s/iter; left time: 94226.9198s
	iters: 3500, epoch: 4 | loss: 0.8695596
	speed: 0.1326s/iter; left time: 94563.6321s
	iters: 3600, epoch: 4 | loss: 0.7210100
	speed: 0.1321s/iter; left time: 94237.9317s
Epoch: 4 cost time: 481.0396041870117
Epoch: 4, Steps: 3639 | Train Loss: 0.8065668 Vali Loss: 1.5091714 Test Loss: 1.3624998
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.7064373
	speed: 3.4013s/iter; left time: 2425627.9429s
	iters: 200, epoch: 5 | loss: 0.7878380
	speed: 0.1319s/iter; left time: 94016.9668s
	iters: 300, epoch: 5 | loss: 0.7641026
	speed: 0.1317s/iter; left time: 93928.4025s
	iters: 400, epoch: 5 | loss: 0.7483806
	speed: 0.1321s/iter; left time: 94151.9928s
	iters: 500, epoch: 5 | loss: 0.7572213
	speed: 0.1318s/iter; left time: 93921.0616s
	iters: 600, epoch: 5 | loss: 0.7789447
	speed: 0.1318s/iter; left time: 93954.3404s
	iters: 700, epoch: 5 | loss: 0.7560689
	speed: 0.1316s/iter; left time: 93752.7960s
	iters: 800, epoch: 5 | loss: 0.8047798
	speed: 0.1321s/iter; left time: 94113.3087s
	iters: 900, epoch: 5 | loss: 0.7599533
	speed: 0.1319s/iter; left time: 93950.3746s
	iters: 1000, epoch: 5 | loss: 0.7030510
	speed: 0.1316s/iter; left time: 93749.4631s
	iters: 1100, epoch: 5 | loss: 0.6788256
	speed: 0.1320s/iter; left time: 93972.7380s
	iters: 1200, epoch: 5 | loss: 0.7566389
	speed: 0.1317s/iter; left time: 93803.9121s
	iters: 1300, epoch: 5 | loss: 0.7580918
	speed: 0.1320s/iter; left time: 93956.7941s
	iters: 1400, epoch: 5 | loss: 0.7383499
	speed: 0.1321s/iter; left time: 94054.7836s
	iters: 1500, epoch: 5 | loss: 0.6721092
	speed: 0.1321s/iter; left time: 94002.8112s
	iters: 1600, epoch: 5 | loss: 0.7650833
	speed: 0.1319s/iter; left time: 93888.9559s
	iters: 1700, epoch: 5 | loss: 0.8124767
	speed: 0.1318s/iter; left time: 93815.3044s
	iters: 1800, epoch: 5 | loss: 0.7713071
	speed: 0.1318s/iter; left time: 93752.9989s
	iters: 1900, epoch: 5 | loss: 0.6679350
	speed: 0.1316s/iter; left time: 93608.0656s
	iters: 2000, epoch: 5 | loss: 0.6726725
	speed: 0.1320s/iter; left time: 93883.9028s
	iters: 2100, epoch: 5 | loss: 0.7630501
	speed: 0.1320s/iter; left time: 93883.3293s
	iters: 2200, epoch: 5 | loss: 0.6831222
	speed: 0.1318s/iter; left time: 93710.8000s
	iters: 2300, epoch: 5 | loss: 0.5930626
	speed: 0.1320s/iter; left time: 93813.0502s
	iters: 2400, epoch: 5 | loss: 0.6726030
	speed: 0.1321s/iter; left time: 93921.8623s
	iters: 2500, epoch: 5 | loss: 0.7084091
	speed: 0.1316s/iter; left time: 93540.4802s
	iters: 2600, epoch: 5 | loss: 0.7598871
	speed: 0.1316s/iter; left time: 93509.4968s
	iters: 2700, epoch: 5 | loss: 0.8188340
	speed: 0.1317s/iter; left time: 93597.5338s
	iters: 2800, epoch: 5 | loss: 0.6704994
	speed: 0.1317s/iter; left time: 93557.1447s
	iters: 2900, epoch: 5 | loss: 0.8302575
	speed: 0.1316s/iter; left time: 93477.5158s
	iters: 3000, epoch: 5 | loss: 0.7124059
	speed: 0.1318s/iter; left time: 93605.5196s
	iters: 3100, epoch: 5 | loss: 0.6368201
	speed: 0.1322s/iter; left time: 93873.0321s
	iters: 3200, epoch: 5 | loss: 0.6731010
	speed: 0.1317s/iter; left time: 93546.5578s
	iters: 3300, epoch: 5 | loss: 0.6686081
	speed: 0.1320s/iter; left time: 93692.4523s
	iters: 3400, epoch: 5 | loss: 0.7145102
	speed: 0.1316s/iter; left time: 93400.5470s
	iters: 3500, epoch: 5 | loss: 0.7408253
	speed: 0.1320s/iter; left time: 93667.5167s
	iters: 3600, epoch: 5 | loss: 0.7924373
	speed: 0.1318s/iter; left time: 93558.6393s
Epoch: 5 cost time: 480.44921875
Epoch: 5, Steps: 3639 | Train Loss: 0.7357901 Vali Loss: 1.5326090 Test Loss: 1.3404013
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.7011455
	speed: 3.4257s/iter; left time: 2430586.4448s
	iters: 200, epoch: 6 | loss: 0.6724304
	speed: 0.1316s/iter; left time: 93378.7658s
	iters: 300, epoch: 6 | loss: 0.7201726
	speed: 0.1320s/iter; left time: 93597.7273s
	iters: 400, epoch: 6 | loss: 0.6462261
	speed: 0.1318s/iter; left time: 93498.0838s
	iters: 500, epoch: 6 | loss: 0.7211336
	speed: 0.1316s/iter; left time: 93349.0894s
	iters: 600, epoch: 6 | loss: 0.6995462
	speed: 0.1316s/iter; left time: 93319.7277s
	iters: 700, epoch: 6 | loss: 0.6965681
	speed: 0.1318s/iter; left time: 93467.4185s
	iters: 800, epoch: 6 | loss: 0.6576647
	speed: 0.1318s/iter; left time: 93451.9828s
	iters: 900, epoch: 6 | loss: 0.7266319
	speed: 0.1295s/iter; left time: 91773.6340s
	iters: 1000, epoch: 6 | loss: 0.6782197
	speed: 0.1316s/iter; left time: 93256.1318s
	iters: 1100, epoch: 6 | loss: 0.6430308
	speed: 0.1291s/iter; left time: 91485.1305s
	iters: 1200, epoch: 6 | loss: 0.6190826
	speed: 0.1289s/iter; left time: 91321.2122s
	iters: 1300, epoch: 6 | loss: 0.6749414
	speed: 0.1292s/iter; left time: 91542.5416s
	iters: 1400, epoch: 6 | loss: 0.7213755
	speed: 0.1317s/iter; left time: 93254.6748s
	iters: 1500, epoch: 6 | loss: 0.7106066
	speed: 0.1318s/iter; left time: 93360.4971s
	iters: 1600, epoch: 6 | loss: 0.6597499
	speed: 0.1317s/iter; left time: 93253.3777s
	iters: 1700, epoch: 6 | loss: 0.6996441
	speed: 0.1317s/iter; left time: 93227.7102s
	iters: 1800, epoch: 6 | loss: 0.8442492
	speed: 0.1318s/iter; left time: 93287.6652s
	iters: 1900, epoch: 6 | loss: 0.7618496
	speed: 0.1318s/iter; left time: 93271.6321s
	iters: 2000, epoch: 6 | loss: 0.7373520
	speed: 0.1317s/iter; left time: 93191.3868s
	iters: 2100, epoch: 6 | loss: 0.7588370
	speed: 0.1320s/iter; left time: 93403.4182s
	iters: 2200, epoch: 6 | loss: 0.6515338
	speed: 0.1318s/iter; left time: 93214.7119s
	iters: 2300, epoch: 6 | loss: 0.7373849
	speed: 0.1319s/iter; left time: 93328.8795s
	iters: 2400, epoch: 6 | loss: 0.7598211
	speed: 0.1321s/iter; left time: 93412.3931s
	iters: 2500, epoch: 6 | loss: 0.6798148
	speed: 0.1318s/iter; left time: 93216.8068s
	iters: 2600, epoch: 6 | loss: 0.6940743
	speed: 0.1323s/iter; left time: 93508.2196s
	iters: 2700, epoch: 6 | loss: 0.7031971
	speed: 0.1317s/iter; left time: 93120.8646s
	iters: 2800, epoch: 6 | loss: 0.6543667
	speed: 0.1318s/iter; left time: 93128.5959s
	iters: 2900, epoch: 6 | loss: 0.6691528
	speed: 0.1319s/iter; left time: 93183.5682s
	iters: 3000, epoch: 6 | loss: 0.7660831
	speed: 0.1318s/iter; left time: 93158.6723s
	iters: 3100, epoch: 6 | loss: 0.6599224
	speed: 0.1306s/iter; left time: 92262.7467s
	iters: 3200, epoch: 6 | loss: 0.6245455
	speed: 0.1286s/iter; left time: 90871.7804s
	iters: 3300, epoch: 6 | loss: 0.6846812
	speed: 0.1297s/iter; left time: 91630.9958s
	iters: 3400, epoch: 6 | loss: 0.6429494
	speed: 0.1319s/iter; left time: 93139.1934s
	iters: 3500, epoch: 6 | loss: 0.6138012
	speed: 0.1321s/iter; left time: 93264.6602s
	iters: 3600, epoch: 6 | loss: 0.6795772
	speed: 0.1317s/iter; left time: 92967.0029s
Epoch: 6 cost time: 478.30215072631836
Epoch: 6, Steps: 3639 | Train Loss: 0.7083993 Vali Loss: 1.5124550 Test Loss: 1.3160090
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.6475559
	speed: 3.4241s/iter; left time: 2416987.2209s
	iters: 200, epoch: 7 | loss: 0.6629648
	speed: 0.1307s/iter; left time: 92235.2405s
	iters: 300, epoch: 7 | loss: 0.7218354
	speed: 0.1298s/iter; left time: 91570.2476s
	iters: 400, epoch: 7 | loss: 0.6654896
	speed: 0.1298s/iter; left time: 91551.0706s
	iters: 500, epoch: 7 | loss: 0.6547799
	speed: 0.1320s/iter; left time: 93122.5610s
	iters: 600, epoch: 7 | loss: 0.6724138
	speed: 0.1323s/iter; left time: 93295.6036s
	iters: 700, epoch: 7 | loss: 0.6846269
	speed: 0.1317s/iter; left time: 92861.2771s
	iters: 800, epoch: 7 | loss: 0.6524063
	speed: 0.1321s/iter; left time: 93155.3333s
	iters: 900, epoch: 7 | loss: 0.7290218
	speed: 0.1319s/iter; left time: 92972.3341s
	iters: 1000, epoch: 7 | loss: 0.6516898
	speed: 0.1320s/iter; left time: 93085.7402s
	iters: 1100, epoch: 7 | loss: 0.6399046
	speed: 0.1317s/iter; left time: 92844.1481s
	iters: 1200, epoch: 7 | loss: 0.6454521
	speed: 0.1316s/iter; left time: 92745.2677s
	iters: 1300, epoch: 7 | loss: 0.5959519
	speed: 0.1318s/iter; left time: 92902.7127s
	iters: 1400, epoch: 7 | loss: 0.6274415
	speed: 0.1317s/iter; left time: 92782.0103s
	iters: 1500, epoch: 7 | loss: 0.6504562
	speed: 0.1318s/iter; left time: 92837.9816s
	iters: 1600, epoch: 7 | loss: 0.6668903
	speed: 0.1319s/iter; left time: 92905.6550s
	iters: 1700, epoch: 7 | loss: 0.6490128
	speed: 0.1318s/iter; left time: 92822.0368s
	iters: 1800, epoch: 7 | loss: 0.7640128
	speed: 0.1317s/iter; left time: 92709.6107s
	iters: 1900, epoch: 7 | loss: 0.6224623
	speed: 0.1317s/iter; left time: 92748.2389s
	iters: 2000, epoch: 7 | loss: 0.6744968
	speed: 0.1318s/iter; left time: 92799.0156s
	iters: 2100, epoch: 7 | loss: 0.6376486
	speed: 0.1319s/iter; left time: 92843.8302s
	iters: 2200, epoch: 7 | loss: 0.6583583
	speed: 0.1316s/iter; left time: 92639.3628s
	iters: 2300, epoch: 7 | loss: 0.6066325
	speed: 0.1321s/iter; left time: 92948.5609s
	iters: 2400, epoch: 7 | loss: 0.6041483
	speed: 0.1317s/iter; left time: 92656.5001s
	iters: 2500, epoch: 7 | loss: 0.6629989
	speed: 0.1322s/iter; left time: 92995.8503s
	iters: 2600, epoch: 7 | loss: 0.6200637
	speed: 0.1318s/iter; left time: 92707.3899s
	iters: 2700, epoch: 7 | loss: 0.7099833
	speed: 0.1321s/iter; left time: 92882.6006s
	iters: 2800, epoch: 7 | loss: 0.6382775
	speed: 0.1323s/iter; left time: 93029.5642s
	iters: 2900, epoch: 7 | loss: 0.6185223
	speed: 0.1318s/iter; left time: 92694.3012s
	iters: 3000, epoch: 7 | loss: 0.6883281
	speed: 0.1325s/iter; left time: 93162.7786s
	iters: 3100, epoch: 7 | loss: 0.9284956
	speed: 0.1316s/iter; left time: 92469.1500s
	iters: 3200, epoch: 7 | loss: 0.6161155
	speed: 0.1324s/iter; left time: 93054.4118s
	iters: 3300, epoch: 7 | loss: 0.7194785
	speed: 0.1317s/iter; left time: 92550.7785s
	iters: 3400, epoch: 7 | loss: 0.6714488
	speed: 0.1319s/iter; left time: 92642.1571s
	iters: 3500, epoch: 7 | loss: 0.6602731
	speed: 0.1321s/iter; left time: 92780.2784s
	iters: 3600, epoch: 7 | loss: 0.6119356
	speed: 0.1318s/iter; left time: 92573.1851s
Epoch: 7 cost time: 479.61198925971985
Epoch: 7, Steps: 3639 | Train Loss: 0.6690016 Vali Loss: 1.5237731 Test Loss: 1.2843723
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247965
test shape: (24796, 1, 192, 151) (24796, 1, 192, 151)
test shape: (24796, 192, 151) (24796, 192, 151)
mse:1.2351595163345337, mae:0.8371953368186951
>>>>>>>Overall time: 6047 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
