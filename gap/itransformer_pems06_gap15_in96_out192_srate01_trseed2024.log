Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 742998
val 142356
test 142354
	iters: 100, epoch: 1 | loss: 1.8741757
	speed: 0.0329s/iter; left time: 1526.0490s
	iters: 200, epoch: 1 | loss: 1.5868748
	speed: 0.0303s/iter; left time: 1401.7489s
	iters: 300, epoch: 1 | loss: 1.9162202
	speed: 0.0303s/iter; left time: 1399.4875s
	iters: 400, epoch: 1 | loss: 1.7117703
	speed: 0.0304s/iter; left time: 1399.6953s
	iters: 500, epoch: 1 | loss: 1.9999037
	speed: 0.0302s/iter; left time: 1385.0189s
	iters: 600, epoch: 1 | loss: 1.8839126
	speed: 0.0299s/iter; left time: 1370.2668s
	iters: 700, epoch: 1 | loss: 1.9217056
	speed: 0.0304s/iter; left time: 1391.6487s
	iters: 800, epoch: 1 | loss: 1.9935895
	speed: 0.0301s/iter; left time: 1372.6276s
	iters: 900, epoch: 1 | loss: 1.6106809
	speed: 0.0304s/iter; left time: 1383.6131s
	iters: 1000, epoch: 1 | loss: 1.4179119
	speed: 0.0304s/iter; left time: 1380.8539s
	iters: 1100, epoch: 1 | loss: 1.4704949
	speed: 0.0304s/iter; left time: 1377.9747s
	iters: 1200, epoch: 1 | loss: 1.4409407
	speed: 0.0304s/iter; left time: 1373.9691s
	iters: 1300, epoch: 1 | loss: 1.5999020
	speed: 0.0299s/iter; left time: 1347.6084s
	iters: 1400, epoch: 1 | loss: 1.6300516
	speed: 0.0304s/iter; left time: 1369.1901s
	iters: 1500, epoch: 1 | loss: 1.6341469
	speed: 0.0304s/iter; left time: 1366.8502s
	iters: 1600, epoch: 1 | loss: 1.8847735
	speed: 0.0301s/iter; left time: 1350.3303s
	iters: 1700, epoch: 1 | loss: 1.8988596
	speed: 0.0304s/iter; left time: 1358.8587s
	iters: 1800, epoch: 1 | loss: 2.1983657
	speed: 0.0304s/iter; left time: 1355.2577s
	iters: 1900, epoch: 1 | loss: 1.7505286
	speed: 0.0303s/iter; left time: 1348.8822s
	iters: 2000, epoch: 1 | loss: 1.8106596
	speed: 0.0305s/iter; left time: 1356.5014s
	iters: 2100, epoch: 1 | loss: 1.8399693
	speed: 0.0300s/iter; left time: 1330.0394s
	iters: 2200, epoch: 1 | loss: 1.9656661
	speed: 0.0302s/iter; left time: 1335.3383s
	iters: 2300, epoch: 1 | loss: 1.6453915
	speed: 0.0303s/iter; left time: 1336.3910s
	iters: 2400, epoch: 1 | loss: 1.6935523
	speed: 0.0300s/iter; left time: 1322.7511s
	iters: 2500, epoch: 1 | loss: 1.6978363
	speed: 0.0303s/iter; left time: 1330.5609s
	iters: 2600, epoch: 1 | loss: 1.9699029
	speed: 0.0304s/iter; left time: 1330.3460s
	iters: 2700, epoch: 1 | loss: 1.6334277
	speed: 0.0304s/iter; left time: 1328.5405s
	iters: 2800, epoch: 1 | loss: 1.6822959
	speed: 0.0304s/iter; left time: 1325.6649s
	iters: 2900, epoch: 1 | loss: 1.6296444
	speed: 0.0299s/iter; left time: 1301.8940s
	iters: 3000, epoch: 1 | loss: 1.9508538
	speed: 0.0302s/iter; left time: 1312.2599s
	iters: 3100, epoch: 1 | loss: 1.6068639
	speed: 0.0305s/iter; left time: 1322.1766s
	iters: 3200, epoch: 1 | loss: 1.5174608
	speed: 0.0301s/iter; left time: 1299.8052s
	iters: 3300, epoch: 1 | loss: 1.3812100
	speed: 0.0301s/iter; left time: 1298.5800s
	iters: 3400, epoch: 1 | loss: 1.5833508
	speed: 0.0303s/iter; left time: 1304.7461s
	iters: 3500, epoch: 1 | loss: 1.6215509
	speed: 0.0304s/iter; left time: 1303.2944s
	iters: 3600, epoch: 1 | loss: 1.8360332
	speed: 0.0304s/iter; left time: 1301.4845s
	iters: 3700, epoch: 1 | loss: 1.5603101
	speed: 0.0304s/iter; left time: 1298.2991s
	iters: 3800, epoch: 1 | loss: 1.8917226
	speed: 0.0302s/iter; left time: 1289.2637s
	iters: 3900, epoch: 1 | loss: 1.7598774
	speed: 0.0304s/iter; left time: 1293.3513s
	iters: 4000, epoch: 1 | loss: 1.9271003
	speed: 0.0303s/iter; left time: 1283.9223s
	iters: 4100, epoch: 1 | loss: 1.8687141
	speed: 0.0302s/iter; left time: 1278.4849s
	iters: 4200, epoch: 1 | loss: 1.7839230
	speed: 0.0304s/iter; left time: 1282.7901s
	iters: 4300, epoch: 1 | loss: 1.7307007
	speed: 0.0303s/iter; left time: 1276.0782s
	iters: 4400, epoch: 1 | loss: 1.9764223
	speed: 0.0304s/iter; left time: 1276.9758s
	iters: 4500, epoch: 1 | loss: 1.6217030
	speed: 0.0304s/iter; left time: 1274.4767s
	iters: 4600, epoch: 1 | loss: 1.9646604
	speed: 0.0305s/iter; left time: 1274.4431s
Epoch: 1 cost time: 140.9487087726593
Epoch: 1, Steps: 4643 | Train Loss: 1.7282496 Vali Loss: 1.0895985 Test Loss: 1.0766737
Validation loss decreased (inf --> 1.089599).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6015389
	speed: 0.6974s/iter; left time: 29071.7111s
	iters: 200, epoch: 2 | loss: 1.8604106
	speed: 0.0304s/iter; left time: 1264.0263s
	iters: 300, epoch: 2 | loss: 1.7726074
	speed: 0.0302s/iter; left time: 1252.0320s
	iters: 400, epoch: 2 | loss: 1.8118361
	speed: 0.0303s/iter; left time: 1253.6896s
	iters: 500, epoch: 2 | loss: 1.6497972
	speed: 0.0304s/iter; left time: 1254.8274s
	iters: 600, epoch: 2 | loss: 1.5404322
	speed: 0.0303s/iter; left time: 1247.6009s
	iters: 700, epoch: 2 | loss: 1.8821663
	speed: 0.0304s/iter; left time: 1249.3660s
	iters: 800, epoch: 2 | loss: 1.5954487
	speed: 0.0299s/iter; left time: 1223.5331s
	iters: 900, epoch: 2 | loss: 1.9626064
	speed: 0.0302s/iter; left time: 1233.6979s
	iters: 1000, epoch: 2 | loss: 2.0936635
	speed: 0.0305s/iter; left time: 1242.5278s
	iters: 1100, epoch: 2 | loss: 1.7278552
	speed: 0.0303s/iter; left time: 1233.2800s
	iters: 1200, epoch: 2 | loss: 1.8946567
	speed: 0.0303s/iter; left time: 1230.3917s
	iters: 1300, epoch: 2 | loss: 2.0253971
	speed: 0.0298s/iter; left time: 1205.2465s
	iters: 1400, epoch: 2 | loss: 1.7034231
	speed: 0.0303s/iter; left time: 1224.3802s
	iters: 1500, epoch: 2 | loss: 1.5653180
	speed: 0.0303s/iter; left time: 1219.5244s
	iters: 1600, epoch: 2 | loss: 1.7665337
	speed: 0.0303s/iter; left time: 1217.7036s
	iters: 1700, epoch: 2 | loss: 1.8977751
	speed: 0.0304s/iter; left time: 1217.6382s
	iters: 1800, epoch: 2 | loss: 1.7886590
	speed: 0.0303s/iter; left time: 1210.8135s
	iters: 1900, epoch: 2 | loss: 1.7120730
	speed: 0.0299s/iter; left time: 1193.5907s
	iters: 2000, epoch: 2 | loss: 1.7066303
	speed: 0.0303s/iter; left time: 1207.2838s
	iters: 2100, epoch: 2 | loss: 2.0230517
	speed: 0.0304s/iter; left time: 1204.6993s
	iters: 2200, epoch: 2 | loss: 1.4587494
	speed: 0.0304s/iter; left time: 1202.3685s
	iters: 2300, epoch: 2 | loss: 2.3229032
	speed: 0.0304s/iter; left time: 1199.4956s
	iters: 2400, epoch: 2 | loss: 1.6783000
	speed: 0.0304s/iter; left time: 1197.5402s
	iters: 2500, epoch: 2 | loss: 2.0755875
	speed: 0.0302s/iter; left time: 1185.3144s
	iters: 2600, epoch: 2 | loss: 1.8964285
	speed: 0.0303s/iter; left time: 1185.4659s
	iters: 2700, epoch: 2 | loss: 1.5992879
	speed: 0.0304s/iter; left time: 1188.2148s
	iters: 2800, epoch: 2 | loss: 1.7585174
	speed: 0.0304s/iter; left time: 1183.6933s
	iters: 2900, epoch: 2 | loss: 1.8306012
	speed: 0.0302s/iter; left time: 1173.7929s
	iters: 3000, epoch: 2 | loss: 1.5199664
	speed: 0.0304s/iter; left time: 1179.3671s
	iters: 3100, epoch: 2 | loss: 1.8228016
	speed: 0.0302s/iter; left time: 1169.9059s
	iters: 3200, epoch: 2 | loss: 1.6853410
	speed: 0.0302s/iter; left time: 1166.0443s
	iters: 3300, epoch: 2 | loss: 1.7381331
	speed: 0.0304s/iter; left time: 1169.3683s
	iters: 3400, epoch: 2 | loss: 1.7734847
	speed: 0.0304s/iter; left time: 1165.5720s
	iters: 3500, epoch: 2 | loss: 1.8104467
	speed: 0.0304s/iter; left time: 1162.4762s
	iters: 3600, epoch: 2 | loss: 1.6499267
	speed: 0.0304s/iter; left time: 1160.3158s
	iters: 3700, epoch: 2 | loss: 1.4274764
	speed: 0.0304s/iter; left time: 1157.1959s
	iters: 3800, epoch: 2 | loss: 2.0879531
	speed: 0.0303s/iter; left time: 1152.7051s
	iters: 3900, epoch: 2 | loss: 1.8602250
	speed: 0.0304s/iter; left time: 1150.9619s
	iters: 4000, epoch: 2 | loss: 2.0646102
	speed: 0.0304s/iter; left time: 1148.4930s
	iters: 4100, epoch: 2 | loss: 1.6773033
	speed: 0.0302s/iter; left time: 1136.7257s
	iters: 4200, epoch: 2 | loss: 1.7379197
	speed: 0.0302s/iter; left time: 1137.0179s
	iters: 4300, epoch: 2 | loss: 1.5516840
	speed: 0.0300s/iter; left time: 1125.6169s
	iters: 4400, epoch: 2 | loss: 1.7380613
	speed: 0.0301s/iter; left time: 1124.0835s
	iters: 4500, epoch: 2 | loss: 1.7828408
	speed: 0.0303s/iter; left time: 1128.6947s
	iters: 4600, epoch: 2 | loss: 1.5882461
	speed: 0.0301s/iter; left time: 1118.0890s
Epoch: 2 cost time: 140.6430745124817
Epoch: 2, Steps: 4643 | Train Loss: 1.7295004 Vali Loss: 1.0937467 Test Loss: 1.0766296
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.4370126
	speed: 0.6954s/iter; left time: 25760.9838s
	iters: 200, epoch: 3 | loss: 1.6116447
	speed: 0.0302s/iter; left time: 1115.1738s
	iters: 300, epoch: 3 | loss: 1.4517394
	speed: 0.0305s/iter; left time: 1122.3227s
	iters: 400, epoch: 3 | loss: 1.4689823
	speed: 0.0301s/iter; left time: 1105.3544s
	iters: 500, epoch: 3 | loss: 1.5760307
	speed: 0.0304s/iter; left time: 1113.1706s
	iters: 600, epoch: 3 | loss: 2.1363156
	speed: 0.0302s/iter; left time: 1102.0531s
	iters: 700, epoch: 3 | loss: 1.5328773
	speed: 0.0305s/iter; left time: 1111.1644s
	iters: 800, epoch: 3 | loss: 1.6582326
	speed: 0.0306s/iter; left time: 1111.8124s
	iters: 900, epoch: 3 | loss: 1.8618534
	speed: 0.0304s/iter; left time: 1100.6926s
	iters: 1000, epoch: 3 | loss: 1.9478488
	speed: 0.0304s/iter; left time: 1098.9731s
	iters: 1100, epoch: 3 | loss: 1.4826955
	speed: 0.0303s/iter; left time: 1093.8258s
	iters: 1200, epoch: 3 | loss: 1.5666282
	speed: 0.0304s/iter; left time: 1092.1627s
	iters: 1300, epoch: 3 | loss: 1.6807936
	speed: 0.0301s/iter; left time: 1080.4443s
	iters: 1400, epoch: 3 | loss: 1.9788628
	speed: 0.0303s/iter; left time: 1082.9111s
	iters: 1500, epoch: 3 | loss: 1.6302675
	speed: 0.0302s/iter; left time: 1077.2599s
	iters: 1600, epoch: 3 | loss: 1.7477967
	speed: 0.0303s/iter; left time: 1077.6691s
	iters: 1700, epoch: 3 | loss: 1.5261744
	speed: 0.0303s/iter; left time: 1075.2834s
	iters: 1800, epoch: 3 | loss: 1.6126577
	speed: 0.0302s/iter; left time: 1067.8849s
	iters: 1900, epoch: 3 | loss: 1.3593243
	speed: 0.0302s/iter; left time: 1063.4231s
	iters: 2000, epoch: 3 | loss: 1.6938761
	speed: 0.0304s/iter; left time: 1067.7686s
	iters: 2100, epoch: 3 | loss: 1.6153684
	speed: 0.0303s/iter; left time: 1062.4355s
	iters: 2200, epoch: 3 | loss: 1.5513428
	speed: 0.0302s/iter; left time: 1054.9337s
	iters: 2300, epoch: 3 | loss: 1.6789840
	speed: 0.0302s/iter; left time: 1050.7140s
	iters: 2400, epoch: 3 | loss: 1.8132359
	speed: 0.0300s/iter; left time: 1042.2262s
	iters: 2500, epoch: 3 | loss: 1.7699783
	speed: 0.0304s/iter; left time: 1051.7584s
	iters: 2600, epoch: 3 | loss: 1.4241706
	speed: 0.0300s/iter; left time: 1035.3697s
	iters: 2700, epoch: 3 | loss: 1.8770195
	speed: 0.0305s/iter; left time: 1050.7585s
	iters: 2800, epoch: 3 | loss: 1.6263357
	speed: 0.0303s/iter; left time: 1040.4221s
	iters: 2900, epoch: 3 | loss: 1.7173525
	speed: 0.0300s/iter; left time: 1027.0451s
	iters: 3000, epoch: 3 | loss: 1.5824647
	speed: 0.0304s/iter; left time: 1036.7160s
	iters: 3100, epoch: 3 | loss: 1.9475971
	speed: 0.0303s/iter; left time: 1030.2534s
	iters: 3200, epoch: 3 | loss: 2.1402392
	speed: 0.0304s/iter; left time: 1031.6400s
	iters: 3300, epoch: 3 | loss: 1.5732770
	speed: 0.0303s/iter; left time: 1027.1585s
	iters: 3400, epoch: 3 | loss: 1.4996891
	speed: 0.0304s/iter; left time: 1026.5064s
	iters: 3500, epoch: 3 | loss: 2.0851896
	speed: 0.0304s/iter; left time: 1022.8406s
	iters: 3600, epoch: 3 | loss: 1.8267139
	speed: 0.0303s/iter; left time: 1014.8571s
	iters: 3700, epoch: 3 | loss: 1.7725077
	speed: 0.0303s/iter; left time: 1012.3097s
	iters: 3800, epoch: 3 | loss: 1.6166741
	speed: 0.0304s/iter; left time: 1013.8296s
	iters: 3900, epoch: 3 | loss: 2.0130992
	speed: 0.0305s/iter; left time: 1014.5066s
	iters: 4000, epoch: 3 | loss: 1.4088533
	speed: 0.0304s/iter; left time: 1008.8914s
	iters: 4100, epoch: 3 | loss: 1.5602082
	speed: 0.0304s/iter; left time: 1003.2164s
	iters: 4200, epoch: 3 | loss: 1.9138241
	speed: 0.0304s/iter; left time: 1000.8649s
	iters: 4300, epoch: 3 | loss: 1.6705806
	speed: 0.0303s/iter; left time: 994.0797s
	iters: 4400, epoch: 3 | loss: 1.5481317
	speed: 0.0303s/iter; left time: 993.2609s
	iters: 4500, epoch: 3 | loss: 1.9583337
	speed: 0.0300s/iter; left time: 978.4810s
	iters: 4600, epoch: 3 | loss: 1.8703668
	speed: 0.0304s/iter; left time: 988.2001s
Epoch: 3 cost time: 140.78724551200867
Epoch: 3, Steps: 4643 | Train Loss: 1.7288075 Vali Loss: 1.0957503 Test Loss: 1.0766233
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6428831
	speed: 0.6970s/iter; left time: 22582.7938s
	iters: 200, epoch: 4 | loss: 1.5206128
	speed: 0.0304s/iter; left time: 982.1001s
	iters: 300, epoch: 4 | loss: 1.8529167
	speed: 0.0302s/iter; left time: 972.3534s
	iters: 400, epoch: 4 | loss: 1.6378993
	speed: 0.0304s/iter; left time: 975.0086s
	iters: 500, epoch: 4 | loss: 1.6968163
	speed: 0.0301s/iter; left time: 963.8849s
	iters: 600, epoch: 4 | loss: 1.6395364
	speed: 0.0302s/iter; left time: 962.1049s
	iters: 700, epoch: 4 | loss: 1.7067996
	speed: 0.0298s/iter; left time: 946.6622s
	iters: 800, epoch: 4 | loss: 1.9601929
	speed: 0.0304s/iter; left time: 965.1514s
	iters: 900, epoch: 4 | loss: 1.6950158
	speed: 0.0304s/iter; left time: 960.4815s
	iters: 1000, epoch: 4 | loss: 1.6472239
	speed: 0.0303s/iter; left time: 954.9010s
	iters: 1100, epoch: 4 | loss: 1.7724658
	speed: 0.0305s/iter; left time: 957.9843s
	iters: 1200, epoch: 4 | loss: 1.9266402
	speed: 0.0304s/iter; left time: 951.1347s
	iters: 1300, epoch: 4 | loss: 1.4246868
	speed: 0.0302s/iter; left time: 943.6449s
	iters: 1400, epoch: 4 | loss: 1.9389879
	speed: 0.0304s/iter; left time: 944.8683s
	iters: 1500, epoch: 4 | loss: 1.9226277
	speed: 0.0304s/iter; left time: 941.7381s
	iters: 1600, epoch: 4 | loss: 1.5791223
	speed: 0.0305s/iter; left time: 941.9104s
	iters: 1700, epoch: 4 | loss: 2.0395930
	speed: 0.0304s/iter; left time: 936.3191s
	iters: 1800, epoch: 4 | loss: 1.9165131
	speed: 0.0304s/iter; left time: 933.5609s
	iters: 1900, epoch: 4 | loss: 1.6440542
	speed: 0.0304s/iter; left time: 929.5266s
	iters: 2000, epoch: 4 | loss: 1.9971882
	speed: 0.0305s/iter; left time: 929.4418s
	iters: 2100, epoch: 4 | loss: 1.6116543
	speed: 0.0304s/iter; left time: 923.6887s
	iters: 2200, epoch: 4 | loss: 2.3022950
	speed: 0.0304s/iter; left time: 920.8433s
	iters: 2300, epoch: 4 | loss: 1.5688826
	speed: 0.0304s/iter; left time: 917.2796s
	iters: 2400, epoch: 4 | loss: 1.6123680
	speed: 0.0304s/iter; left time: 916.1507s
	iters: 2500, epoch: 4 | loss: 1.8866014
	speed: 0.0300s/iter; left time: 899.1609s
	iters: 2600, epoch: 4 | loss: 1.6795336
	speed: 0.0304s/iter; left time: 908.1861s
	iters: 2700, epoch: 4 | loss: 1.2757198
	speed: 0.0303s/iter; left time: 903.8186s
	iters: 2800, epoch: 4 | loss: 1.7954204
	speed: 0.0299s/iter; left time: 888.2954s
	iters: 2900, epoch: 4 | loss: 1.6351421
	speed: 0.0303s/iter; left time: 896.2473s
	iters: 3000, epoch: 4 | loss: 1.9368939
	speed: 0.0302s/iter; left time: 890.9258s
	iters: 3100, epoch: 4 | loss: 1.7800640
	speed: 0.0304s/iter; left time: 893.7736s
	iters: 3200, epoch: 4 | loss: 1.4961871
	speed: 0.0304s/iter; left time: 890.5567s
	iters: 3300, epoch: 4 | loss: 1.7347069
	speed: 0.0301s/iter; left time: 878.6961s
	iters: 3400, epoch: 4 | loss: 1.7797191
	speed: 0.0304s/iter; left time: 884.4626s
	iters: 3500, epoch: 4 | loss: 1.6452196
	speed: 0.0304s/iter; left time: 882.7494s
	iters: 3600, epoch: 4 | loss: 1.6522950
	speed: 0.0304s/iter; left time: 877.2477s
	iters: 3700, epoch: 4 | loss: 2.0666404
	speed: 0.0305s/iter; left time: 879.2105s
	iters: 3800, epoch: 4 | loss: 1.7321092
	speed: 0.0304s/iter; left time: 871.8573s
	iters: 3900, epoch: 4 | loss: 1.8648310
	speed: 0.0304s/iter; left time: 868.5514s
	iters: 4000, epoch: 4 | loss: 2.2013476
	speed: 0.0305s/iter; left time: 868.8766s
	iters: 4100, epoch: 4 | loss: 1.7360414
	speed: 0.0302s/iter; left time: 856.8629s
	iters: 4200, epoch: 4 | loss: 1.8954846
	speed: 0.0304s/iter; left time: 861.2772s
	iters: 4300, epoch: 4 | loss: 1.7533745
	speed: 0.0298s/iter; left time: 841.7946s
	iters: 4400, epoch: 4 | loss: 1.8233731
	speed: 0.0305s/iter; left time: 855.8866s
	iters: 4500, epoch: 4 | loss: 1.6401440
	speed: 0.0304s/iter; left time: 850.7730s
	iters: 4600, epoch: 4 | loss: 1.8842911
	speed: 0.0304s/iter; left time: 848.0288s
Epoch: 4 cost time: 140.88423657417297
Epoch: 4, Steps: 4643 | Train Loss: 1.7286230 Vali Loss: 1.0921119 Test Loss: 1.0758727
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 142354
test shape: (14235, 1, 192, 130) (14235, 1, 192, 130)
test shape: (14235, 192, 130) (14235, 192, 130)
mse:1.0766717195510864, mae:0.7778357863426208
>>>>>>>Overall time: 951 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
