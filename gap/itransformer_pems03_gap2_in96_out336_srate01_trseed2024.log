Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=151, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems03_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164518
val 247822
test 247821
	iters: 100, epoch: 1 | loss: 1.4695218
	speed: 0.0342s/iter; left time: 2482.3031s
	iters: 200, epoch: 1 | loss: 1.8040925
	speed: 0.0304s/iter; left time: 2208.4986s
	iters: 300, epoch: 1 | loss: 1.6453432
	speed: 0.0304s/iter; left time: 2203.7485s
	iters: 400, epoch: 1 | loss: 1.6980149
	speed: 0.0304s/iter; left time: 2202.4646s
	iters: 500, epoch: 1 | loss: 1.7480744
	speed: 0.0304s/iter; left time: 2197.6626s
	iters: 600, epoch: 1 | loss: 1.8422725
	speed: 0.0304s/iter; left time: 2193.8419s
	iters: 700, epoch: 1 | loss: 1.5435371
	speed: 0.0304s/iter; left time: 2194.7503s
	iters: 800, epoch: 1 | loss: 1.5407195
	speed: 0.0304s/iter; left time: 2190.5394s
	iters: 900, epoch: 1 | loss: 1.8473787
	speed: 0.0304s/iter; left time: 2186.9008s
	iters: 1000, epoch: 1 | loss: 1.7018334
	speed: 0.0304s/iter; left time: 2182.9048s
	iters: 1100, epoch: 1 | loss: 1.7487659
	speed: 0.0305s/iter; left time: 2182.7569s
	iters: 1200, epoch: 1 | loss: 1.6998721
	speed: 0.0304s/iter; left time: 2178.3935s
	iters: 1300, epoch: 1 | loss: 1.6504958
	speed: 0.0304s/iter; left time: 2174.8463s
	iters: 1400, epoch: 1 | loss: 1.6513034
	speed: 0.0304s/iter; left time: 2170.5676s
	iters: 1500, epoch: 1 | loss: 1.6458225
	speed: 0.0304s/iter; left time: 2168.7217s
	iters: 1600, epoch: 1 | loss: 1.8974775
	speed: 0.0304s/iter; left time: 2166.9300s
	iters: 1700, epoch: 1 | loss: 1.6825252
	speed: 0.0305s/iter; left time: 2166.8548s
	iters: 1800, epoch: 1 | loss: 1.8023251
	speed: 0.0304s/iter; left time: 2160.2503s
	iters: 1900, epoch: 1 | loss: 1.5524505
	speed: 0.0304s/iter; left time: 2155.6424s
	iters: 2000, epoch: 1 | loss: 1.7640371
	speed: 0.0305s/iter; left time: 2157.1476s
	iters: 2100, epoch: 1 | loss: 1.6638829
	speed: 0.0304s/iter; left time: 2149.1548s
	iters: 2200, epoch: 1 | loss: 1.8019660
	speed: 0.0304s/iter; left time: 2148.9864s
	iters: 2300, epoch: 1 | loss: 1.7561506
	speed: 0.0304s/iter; left time: 2145.1205s
	iters: 2400, epoch: 1 | loss: 1.6589818
	speed: 0.0304s/iter; left time: 2141.5396s
	iters: 2500, epoch: 1 | loss: 1.6188018
	speed: 0.0304s/iter; left time: 2139.9176s
	iters: 2600, epoch: 1 | loss: 1.6089449
	speed: 0.0304s/iter; left time: 2136.0204s
	iters: 2700, epoch: 1 | loss: 1.8674319
	speed: 0.0305s/iter; left time: 2134.1226s
	iters: 2800, epoch: 1 | loss: 1.6674879
	speed: 0.0304s/iter; left time: 2130.3772s
	iters: 2900, epoch: 1 | loss: 1.4598149
	speed: 0.0304s/iter; left time: 2127.5536s
	iters: 3000, epoch: 1 | loss: 1.5719010
	speed: 0.0305s/iter; left time: 2126.1668s
	iters: 3100, epoch: 1 | loss: 1.6481525
	speed: 0.0305s/iter; left time: 2122.7486s
	iters: 3200, epoch: 1 | loss: 1.6165657
	speed: 0.0305s/iter; left time: 2120.4225s
	iters: 3300, epoch: 1 | loss: 1.7047771
	speed: 0.0305s/iter; left time: 2118.3475s
	iters: 3400, epoch: 1 | loss: 1.5977089
	speed: 0.0304s/iter; left time: 2109.6138s
	iters: 3500, epoch: 1 | loss: 1.8190912
	speed: 0.0304s/iter; left time: 2109.2201s
	iters: 3600, epoch: 1 | loss: 1.7787850
	speed: 0.0304s/iter; left time: 2104.2665s
	iters: 3700, epoch: 1 | loss: 1.7559530
	speed: 0.0304s/iter; left time: 2100.9865s
	iters: 3800, epoch: 1 | loss: 1.8718121
	speed: 0.0304s/iter; left time: 2097.6302s
	iters: 3900, epoch: 1 | loss: 1.8155639
	speed: 0.0304s/iter; left time: 2096.6389s
	iters: 4000, epoch: 1 | loss: 1.5944334
	speed: 0.0304s/iter; left time: 2090.3988s
	iters: 4100, epoch: 1 | loss: 1.6726995
	speed: 0.0304s/iter; left time: 2087.9615s
	iters: 4200, epoch: 1 | loss: 1.5014222
	speed: 0.0304s/iter; left time: 2083.4783s
	iters: 4300, epoch: 1 | loss: 1.7289132
	speed: 0.0304s/iter; left time: 2082.0772s
	iters: 4400, epoch: 1 | loss: 1.6327660
	speed: 0.0305s/iter; left time: 2082.7853s
	iters: 4500, epoch: 1 | loss: 1.6576294
	speed: 0.0304s/iter; left time: 2074.6048s
	iters: 4600, epoch: 1 | loss: 1.7938443
	speed: 0.0304s/iter; left time: 2073.7977s
	iters: 4700, epoch: 1 | loss: 1.5445725
	speed: 0.0304s/iter; left time: 2070.1996s
	iters: 4800, epoch: 1 | loss: 1.6852427
	speed: 0.0304s/iter; left time: 2067.5838s
	iters: 4900, epoch: 1 | loss: 1.6270963
	speed: 0.0305s/iter; left time: 2068.2868s
	iters: 5000, epoch: 1 | loss: 1.7246356
	speed: 0.0304s/iter; left time: 2061.2972s
	iters: 5100, epoch: 1 | loss: 1.7349055
	speed: 0.0305s/iter; left time: 2061.7958s
	iters: 5200, epoch: 1 | loss: 1.5248194
	speed: 0.0305s/iter; left time: 2062.7239s
	iters: 5300, epoch: 1 | loss: 1.5904237
	speed: 0.0304s/iter; left time: 2054.5674s
	iters: 5400, epoch: 1 | loss: 1.6142267
	speed: 0.0304s/iter; left time: 2051.7023s
	iters: 5500, epoch: 1 | loss: 1.7860759
	speed: 0.0304s/iter; left time: 2044.5384s
	iters: 5600, epoch: 1 | loss: 1.5494506
	speed: 0.0304s/iter; left time: 2043.1921s
	iters: 5700, epoch: 1 | loss: 1.8063762
	speed: 0.0304s/iter; left time: 2040.7288s
	iters: 5800, epoch: 1 | loss: 1.6591748
	speed: 0.0304s/iter; left time: 2036.5047s
	iters: 5900, epoch: 1 | loss: 1.6265506
	speed: 0.0304s/iter; left time: 2032.4626s
	iters: 6000, epoch: 1 | loss: 1.6639612
	speed: 0.0304s/iter; left time: 2030.5804s
	iters: 6100, epoch: 1 | loss: 1.5549563
	speed: 0.0305s/iter; left time: 2033.2953s
	iters: 6200, epoch: 1 | loss: 1.5903245
	speed: 0.0304s/iter; left time: 2026.3589s
	iters: 6300, epoch: 1 | loss: 1.6980193
	speed: 0.0304s/iter; left time: 2020.7366s
	iters: 6400, epoch: 1 | loss: 1.6137259
	speed: 0.0304s/iter; left time: 2017.2909s
	iters: 6500, epoch: 1 | loss: 1.6323576
	speed: 0.0304s/iter; left time: 2015.3221s
	iters: 6600, epoch: 1 | loss: 1.7781521
	speed: 0.0304s/iter; left time: 2011.1227s
	iters: 6700, epoch: 1 | loss: 1.8467370
	speed: 0.0304s/iter; left time: 2005.8962s
	iters: 6800, epoch: 1 | loss: 1.5009630
	speed: 0.0304s/iter; left time: 2004.0466s
	iters: 6900, epoch: 1 | loss: 1.7583699
	speed: 0.0304s/iter; left time: 2003.9664s
	iters: 7000, epoch: 1 | loss: 1.5433726
	speed: 0.0304s/iter; left time: 1998.1110s
	iters: 7100, epoch: 1 | loss: 1.5988197
	speed: 0.0304s/iter; left time: 1995.8466s
	iters: 7200, epoch: 1 | loss: 1.5597866
	speed: 0.0304s/iter; left time: 1991.9068s
Epoch: 1 cost time: 221.91239833831787
Epoch: 1, Steps: 7278 | Train Loss: 1.6668912 Vali Loss: 1.8534790 Test Loss: 1.6142210
Validation loss decreased (inf --> 1.853479).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.7827550
	speed: 1.3391s/iter; left time: 87578.3127s
	iters: 200, epoch: 2 | loss: 1.5503435
	speed: 0.0304s/iter; left time: 1985.4025s
	iters: 300, epoch: 2 | loss: 1.6417624
	speed: 0.0304s/iter; left time: 1983.7083s
	iters: 400, epoch: 2 | loss: 1.5054697
	speed: 0.0304s/iter; left time: 1979.9153s
	iters: 500, epoch: 2 | loss: 1.6850183
	speed: 0.0304s/iter; left time: 1974.7669s
	iters: 600, epoch: 2 | loss: 1.6827842
	speed: 0.0304s/iter; left time: 1972.4460s
	iters: 700, epoch: 2 | loss: 1.6545508
	speed: 0.0304s/iter; left time: 1968.4434s
	iters: 800, epoch: 2 | loss: 1.7227000
	speed: 0.0304s/iter; left time: 1966.2717s
	iters: 900, epoch: 2 | loss: 1.6853029
	speed: 0.0304s/iter; left time: 1964.2993s
	iters: 1000, epoch: 2 | loss: 1.8449323
	speed: 0.0304s/iter; left time: 1958.5370s
	iters: 1100, epoch: 2 | loss: 1.7186580
	speed: 0.0304s/iter; left time: 1956.5492s
	iters: 1200, epoch: 2 | loss: 1.6588080
	speed: 0.0304s/iter; left time: 1954.6266s
	iters: 1300, epoch: 2 | loss: 1.5234513
	speed: 0.0304s/iter; left time: 1950.5561s
	iters: 1400, epoch: 2 | loss: 1.7470201
	speed: 0.0304s/iter; left time: 1949.4374s
	iters: 1500, epoch: 2 | loss: 1.6261044
	speed: 0.0304s/iter; left time: 1944.7669s
	iters: 1600, epoch: 2 | loss: 1.6575465
	speed: 0.0304s/iter; left time: 1942.9399s
	iters: 1700, epoch: 2 | loss: 1.7299012
	speed: 0.0304s/iter; left time: 1938.6741s
	iters: 1800, epoch: 2 | loss: 1.7975233
	speed: 0.0304s/iter; left time: 1936.2670s
	iters: 1900, epoch: 2 | loss: 1.6356921
	speed: 0.0304s/iter; left time: 1930.9533s
	iters: 2000, epoch: 2 | loss: 1.7852656
	speed: 0.0304s/iter; left time: 1928.6746s
	iters: 2100, epoch: 2 | loss: 1.6468638
	speed: 0.0304s/iter; left time: 1925.9559s
	iters: 2200, epoch: 2 | loss: 1.6393754
	speed: 0.0303s/iter; left time: 1919.0681s
	iters: 2300, epoch: 2 | loss: 1.7814972
	speed: 0.0303s/iter; left time: 1917.9735s
	iters: 2400, epoch: 2 | loss: 1.7896067
	speed: 0.0303s/iter; left time: 1915.1475s
	iters: 2500, epoch: 2 | loss: 1.4985193
	speed: 0.0304s/iter; left time: 1913.6630s
	iters: 2600, epoch: 2 | loss: 1.5871546
	speed: 0.0304s/iter; left time: 1912.3886s
	iters: 2700, epoch: 2 | loss: 1.7535857
	speed: 0.0304s/iter; left time: 1906.2912s
	iters: 2800, epoch: 2 | loss: 1.6258217
	speed: 0.0304s/iter; left time: 1904.2007s
	iters: 2900, epoch: 2 | loss: 1.5270102
	speed: 0.0304s/iter; left time: 1901.5189s
	iters: 3000, epoch: 2 | loss: 1.6704031
	speed: 0.0303s/iter; left time: 1896.6003s
	iters: 3100, epoch: 2 | loss: 1.8065368
	speed: 0.0305s/iter; left time: 1900.9638s
	iters: 3200, epoch: 2 | loss: 1.6876128
	speed: 0.0303s/iter; left time: 1890.5268s
	iters: 3300, epoch: 2 | loss: 1.7089722
	speed: 0.0304s/iter; left time: 1888.9597s
	iters: 3400, epoch: 2 | loss: 1.8992155
	speed: 0.0304s/iter; left time: 1886.1692s
	iters: 3500, epoch: 2 | loss: 1.6186242
	speed: 0.0303s/iter; left time: 1881.6689s
	iters: 3600, epoch: 2 | loss: 1.8494647
	speed: 0.0304s/iter; left time: 1880.2050s
	iters: 3700, epoch: 2 | loss: 1.5874176
	speed: 0.0304s/iter; left time: 1877.5914s
	iters: 3800, epoch: 2 | loss: 1.6037642
	speed: 0.0303s/iter; left time: 1872.4132s
	iters: 3900, epoch: 2 | loss: 1.8135716
	speed: 0.0304s/iter; left time: 1870.6409s
	iters: 4000, epoch: 2 | loss: 1.5616735
	speed: 0.0304s/iter; left time: 1871.9864s
	iters: 4100, epoch: 2 | loss: 1.8095626
	speed: 0.0304s/iter; left time: 1864.3637s
	iters: 4200, epoch: 2 | loss: 1.6028765
	speed: 0.0303s/iter; left time: 1858.6819s
	iters: 4300, epoch: 2 | loss: 1.8219459
	speed: 0.0304s/iter; left time: 1858.3599s
	iters: 4400, epoch: 2 | loss: 1.6423323
	speed: 0.0303s/iter; left time: 1853.2244s
	iters: 4500, epoch: 2 | loss: 1.6485643
	speed: 0.0304s/iter; left time: 1852.0397s
	iters: 4600, epoch: 2 | loss: 1.5281440
	speed: 0.0303s/iter; left time: 1848.2834s
	iters: 4700, epoch: 2 | loss: 1.7593644
	speed: 0.0304s/iter; left time: 1846.1541s
	iters: 4800, epoch: 2 | loss: 1.4894686
	speed: 0.0304s/iter; left time: 1842.8447s
	iters: 4900, epoch: 2 | loss: 1.7532026
	speed: 0.0304s/iter; left time: 1844.7561s
	iters: 5000, epoch: 2 | loss: 1.6610548
	speed: 0.0303s/iter; left time: 1835.9681s
	iters: 5100, epoch: 2 | loss: 1.6571354
	speed: 0.0304s/iter; left time: 1834.2870s
	iters: 5200, epoch: 2 | loss: 1.7924814
	speed: 0.0303s/iter; left time: 1829.4351s
	iters: 5300, epoch: 2 | loss: 1.6233050
	speed: 0.0304s/iter; left time: 1827.3883s
	iters: 5400, epoch: 2 | loss: 1.7132872
	speed: 0.0303s/iter; left time: 1823.5999s
	iters: 5500, epoch: 2 | loss: 1.6682602
	speed: 0.0304s/iter; left time: 1823.6540s
	iters: 5600, epoch: 2 | loss: 1.7917068
	speed: 0.0304s/iter; left time: 1819.4772s
	iters: 5700, epoch: 2 | loss: 1.6473764
	speed: 0.0304s/iter; left time: 1815.1256s
	iters: 5800, epoch: 2 | loss: 1.7594484
	speed: 0.0303s/iter; left time: 1810.8871s
	iters: 5900, epoch: 2 | loss: 1.6097856
	speed: 0.0304s/iter; left time: 1809.0409s
	iters: 6000, epoch: 2 | loss: 1.7886229
	speed: 0.0304s/iter; left time: 1806.0199s
	iters: 6100, epoch: 2 | loss: 1.7522433
	speed: 0.0303s/iter; left time: 1801.2827s
	iters: 6200, epoch: 2 | loss: 1.8576872
	speed: 0.0304s/iter; left time: 1801.0855s
	iters: 6300, epoch: 2 | loss: 1.6212293
	speed: 0.0303s/iter; left time: 1796.1679s
	iters: 6400, epoch: 2 | loss: 1.7374313
	speed: 0.0303s/iter; left time: 1793.2628s
	iters: 6500, epoch: 2 | loss: 1.7269663
	speed: 0.0306s/iter; left time: 1803.0677s
	iters: 6600, epoch: 2 | loss: 1.5779145
	speed: 0.0303s/iter; left time: 1786.8573s
	iters: 6700, epoch: 2 | loss: 1.7765347
	speed: 0.0304s/iter; left time: 1784.9191s
	iters: 6800, epoch: 2 | loss: 1.7072393
	speed: 0.0304s/iter; left time: 1782.6396s
	iters: 6900, epoch: 2 | loss: 1.5314844
	speed: 0.0304s/iter; left time: 1780.0334s
	iters: 7000, epoch: 2 | loss: 1.7755333
	speed: 0.0304s/iter; left time: 1775.8608s
	iters: 7100, epoch: 2 | loss: 1.6561819
	speed: 0.0304s/iter; left time: 1773.7198s
	iters: 7200, epoch: 2 | loss: 1.6703811
	speed: 0.0304s/iter; left time: 1771.3867s
Epoch: 2 cost time: 221.23871636390686
Epoch: 2, Steps: 7278 | Train Loss: 1.6712934 Vali Loss: 1.8544660 Test Loss: 1.6166065
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6809337
	speed: 1.3384s/iter; left time: 77796.8569s
	iters: 200, epoch: 3 | loss: 1.4608924
	speed: 0.0304s/iter; left time: 1761.6328s
	iters: 300, epoch: 3 | loss: 1.6780254
	speed: 0.0304s/iter; left time: 1758.8255s
	iters: 400, epoch: 3 | loss: 1.6263634
	speed: 0.0304s/iter; left time: 1755.5791s
	iters: 500, epoch: 3 | loss: 1.6704279
	speed: 0.0304s/iter; left time: 1752.6096s
	iters: 600, epoch: 3 | loss: 1.5708795
	speed: 0.0304s/iter; left time: 1749.2418s
	iters: 700, epoch: 3 | loss: 1.6210332
	speed: 0.0303s/iter; left time: 1745.7169s
	iters: 800, epoch: 3 | loss: 1.7536346
	speed: 0.0303s/iter; left time: 1741.8529s
	iters: 900, epoch: 3 | loss: 1.6809496
	speed: 0.0304s/iter; left time: 1740.2551s
	iters: 1000, epoch: 3 | loss: 1.7736498
	speed: 0.0303s/iter; left time: 1735.8662s
	iters: 1100, epoch: 3 | loss: 1.7356689
	speed: 0.0304s/iter; left time: 1734.5777s
	iters: 1200, epoch: 3 | loss: 1.5277445
	speed: 0.0304s/iter; left time: 1731.7747s
	iters: 1300, epoch: 3 | loss: 1.7608912
	speed: 0.0304s/iter; left time: 1728.7311s
	iters: 1400, epoch: 3 | loss: 1.9221888
	speed: 0.0304s/iter; left time: 1725.7113s
	iters: 1500, epoch: 3 | loss: 1.7326611
	speed: 0.0304s/iter; left time: 1722.2375s
	iters: 1600, epoch: 3 | loss: 1.6535553
	speed: 0.0304s/iter; left time: 1719.1277s
	iters: 1700, epoch: 3 | loss: 1.6746409
	speed: 0.0304s/iter; left time: 1716.7082s
	iters: 1800, epoch: 3 | loss: 1.7765055
	speed: 0.0304s/iter; left time: 1713.2441s
	iters: 1900, epoch: 3 | loss: 1.8268882
	speed: 0.0304s/iter; left time: 1709.6643s
	iters: 2000, epoch: 3 | loss: 1.5917382
	speed: 0.0304s/iter; left time: 1706.6061s
	iters: 2100, epoch: 3 | loss: 1.6792530
	speed: 0.0304s/iter; left time: 1704.6033s
	iters: 2200, epoch: 3 | loss: 1.8048964
	speed: 0.0303s/iter; left time: 1700.2827s
	iters: 2300, epoch: 3 | loss: 1.5663345
	speed: 0.0303s/iter; left time: 1695.8003s
	iters: 2400, epoch: 3 | loss: 1.8898557
	speed: 0.0304s/iter; left time: 1695.4664s
	iters: 2500, epoch: 3 | loss: 1.9146549
	speed: 0.0304s/iter; left time: 1691.5902s
	iters: 2600, epoch: 3 | loss: 1.6317046
	speed: 0.0303s/iter; left time: 1687.8544s
	iters: 2700, epoch: 3 | loss: 1.6291753
	speed: 0.0304s/iter; left time: 1686.0558s
	iters: 2800, epoch: 3 | loss: 1.5711846
	speed: 0.0303s/iter; left time: 1681.2338s
	iters: 2900, epoch: 3 | loss: 1.5566981
	speed: 0.0304s/iter; left time: 1679.8224s
	iters: 3000, epoch: 3 | loss: 1.6887137
	speed: 0.0303s/iter; left time: 1675.0282s
	iters: 3100, epoch: 3 | loss: 1.6355562
	speed: 0.0304s/iter; left time: 1674.5782s
	iters: 3200, epoch: 3 | loss: 1.6424785
	speed: 0.0304s/iter; left time: 1670.4146s
	iters: 3300, epoch: 3 | loss: 1.7189101
	speed: 0.0303s/iter; left time: 1666.0966s
	iters: 3400, epoch: 3 | loss: 1.6688893
	speed: 0.0304s/iter; left time: 1664.5887s
	iters: 3500, epoch: 3 | loss: 1.6391094
	speed: 0.0304s/iter; left time: 1661.0178s
	iters: 3600, epoch: 3 | loss: 1.6770316
	speed: 0.0303s/iter; left time: 1656.8493s
	iters: 3700, epoch: 3 | loss: 1.8862157
	speed: 0.0304s/iter; left time: 1655.5589s
	iters: 3800, epoch: 3 | loss: 1.4718306
	speed: 0.0304s/iter; left time: 1652.8713s
	iters: 3900, epoch: 3 | loss: 1.7718548
	speed: 0.0304s/iter; left time: 1649.0548s
	iters: 4000, epoch: 3 | loss: 1.4473658
	speed: 0.0304s/iter; left time: 1646.2088s
	iters: 4100, epoch: 3 | loss: 1.6720662
	speed: 0.0304s/iter; left time: 1643.6405s
	iters: 4200, epoch: 3 | loss: 1.5783466
	speed: 0.0304s/iter; left time: 1639.9051s
	iters: 4300, epoch: 3 | loss: 1.7590848
	speed: 0.0304s/iter; left time: 1636.6805s
	iters: 4400, epoch: 3 | loss: 1.7098080
	speed: 0.0303s/iter; left time: 1633.4865s
	iters: 4500, epoch: 3 | loss: 1.7475375
	speed: 0.0304s/iter; left time: 1631.6914s
	iters: 4600, epoch: 3 | loss: 1.7703589
	speed: 0.0303s/iter; left time: 1627.2518s
	iters: 4700, epoch: 3 | loss: 1.4832646
	speed: 0.0304s/iter; left time: 1625.2476s
	iters: 4800, epoch: 3 | loss: 1.7624545
	speed: 0.0303s/iter; left time: 1621.1570s
	iters: 4900, epoch: 3 | loss: 1.4170853
	speed: 0.0304s/iter; left time: 1619.6198s
	iters: 5000, epoch: 3 | loss: 1.8007828
	speed: 0.0304s/iter; left time: 1615.8080s
	iters: 5100, epoch: 3 | loss: 1.7651298
	speed: 0.0303s/iter; left time: 1611.3756s
	iters: 5200, epoch: 3 | loss: 1.7270172
	speed: 0.0304s/iter; left time: 1609.6931s
	iters: 5300, epoch: 3 | loss: 1.8660200
	speed: 0.0303s/iter; left time: 1605.7937s
	iters: 5400, epoch: 3 | loss: 1.6023854
	speed: 0.0303s/iter; left time: 1602.7775s
	iters: 5500, epoch: 3 | loss: 1.7487842
	speed: 0.0304s/iter; left time: 1601.3385s
	iters: 5600, epoch: 3 | loss: 1.7338535
	speed: 0.0303s/iter; left time: 1595.4840s
	iters: 5700, epoch: 3 | loss: 1.6879987
	speed: 0.0304s/iter; left time: 1594.8259s
	iters: 5800, epoch: 3 | loss: 1.5795540
	speed: 0.0304s/iter; left time: 1592.2065s
	iters: 5900, epoch: 3 | loss: 1.8503633
	speed: 0.0304s/iter; left time: 1589.0204s
	iters: 6000, epoch: 3 | loss: 1.8431057
	speed: 0.0303s/iter; left time: 1584.3731s
	iters: 6100, epoch: 3 | loss: 1.6947728
	speed: 0.0306s/iter; left time: 1593.0362s
	iters: 6200, epoch: 3 | loss: 1.5652635
	speed: 0.0304s/iter; left time: 1579.6692s
	iters: 6300, epoch: 3 | loss: 1.6050988
	speed: 0.0303s/iter; left time: 1575.4369s
	iters: 6400, epoch: 3 | loss: 1.6958483
	speed: 0.0304s/iter; left time: 1574.2839s
	iters: 6500, epoch: 3 | loss: 1.6958699
	speed: 0.0303s/iter; left time: 1569.7402s
	iters: 6600, epoch: 3 | loss: 1.6970866
	speed: 0.0304s/iter; left time: 1567.0214s
	iters: 6700, epoch: 3 | loss: 1.5382880
	speed: 0.0304s/iter; left time: 1563.7864s
	iters: 6800, epoch: 3 | loss: 1.8412250
	speed: 0.0303s/iter; left time: 1560.6229s
	iters: 6900, epoch: 3 | loss: 1.5579572
	speed: 0.0303s/iter; left time: 1557.3917s
	iters: 7000, epoch: 3 | loss: 1.8080225
	speed: 0.0303s/iter; left time: 1554.0771s
	iters: 7100, epoch: 3 | loss: 1.5167949
	speed: 0.0304s/iter; left time: 1553.0714s
	iters: 7200, epoch: 3 | loss: 1.5923026
	speed: 0.0303s/iter; left time: 1546.2166s
Epoch: 3 cost time: 221.13534379005432
Epoch: 3, Steps: 7278 | Train Loss: 1.6704892 Vali Loss: 1.8538377 Test Loss: 1.6118402
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.5917952
	speed: 1.3428s/iter; left time: 68276.6971s
	iters: 200, epoch: 4 | loss: 1.7713673
	speed: 0.0304s/iter; left time: 1541.1933s
	iters: 300, epoch: 4 | loss: 1.5183225
	speed: 0.0303s/iter; left time: 1537.1144s
	iters: 400, epoch: 4 | loss: 1.6072756
	speed: 0.0304s/iter; left time: 1534.4345s
	iters: 500, epoch: 4 | loss: 1.8088804
	speed: 0.0304s/iter; left time: 1531.6412s
	iters: 600, epoch: 4 | loss: 1.3953267
	speed: 0.0304s/iter; left time: 1528.2459s
	iters: 700, epoch: 4 | loss: 1.5246885
	speed: 0.0303s/iter; left time: 1524.6510s
	iters: 800, epoch: 4 | loss: 1.7114584
	speed: 0.0304s/iter; left time: 1522.9118s
	iters: 900, epoch: 4 | loss: 1.6151814
	speed: 0.0304s/iter; left time: 1519.2715s
	iters: 1000, epoch: 4 | loss: 1.5850649
	speed: 0.0304s/iter; left time: 1516.6141s
	iters: 1100, epoch: 4 | loss: 1.7482033
	speed: 0.0304s/iter; left time: 1513.6267s
	iters: 1200, epoch: 4 | loss: 1.6076957
	speed: 0.0304s/iter; left time: 1510.2558s
	iters: 1300, epoch: 4 | loss: 1.4812932
	speed: 0.0303s/iter; left time: 1506.6152s
	iters: 1400, epoch: 4 | loss: 1.8279043
	speed: 0.0304s/iter; left time: 1505.1845s
	iters: 1500, epoch: 4 | loss: 1.8936195
	speed: 0.0304s/iter; left time: 1501.5402s
	iters: 1600, epoch: 4 | loss: 1.7781769
	speed: 0.0303s/iter; left time: 1497.2755s
	iters: 1700, epoch: 4 | loss: 1.7218920
	speed: 0.0303s/iter; left time: 1494.6066s
	iters: 1800, epoch: 4 | loss: 1.6789273
	speed: 0.0304s/iter; left time: 1492.0843s
	iters: 1900, epoch: 4 | loss: 1.7005824
	speed: 0.0304s/iter; left time: 1488.6483s
	iters: 2000, epoch: 4 | loss: 1.5934254
	speed: 0.0304s/iter; left time: 1486.4258s
	iters: 2100, epoch: 4 | loss: 1.6288055
	speed: 0.0304s/iter; left time: 1483.2939s
	iters: 2200, epoch: 4 | loss: 1.5969584
	speed: 0.0303s/iter; left time: 1478.5531s
	iters: 2300, epoch: 4 | loss: 1.7054082
	speed: 0.0303s/iter; left time: 1476.1708s
	iters: 2400, epoch: 4 | loss: 1.6435398
	speed: 0.0303s/iter; left time: 1472.1425s
	iters: 2500, epoch: 4 | loss: 1.8078910
	speed: 0.0304s/iter; left time: 1470.4376s
	iters: 2600, epoch: 4 | loss: 1.3937961
	speed: 0.0304s/iter; left time: 1468.8174s
	iters: 2700, epoch: 4 | loss: 1.5835329
	speed: 0.0303s/iter; left time: 1462.7876s
	iters: 2800, epoch: 4 | loss: 1.6993028
	speed: 0.0303s/iter; left time: 1460.4319s
	iters: 2900, epoch: 4 | loss: 1.5970908
	speed: 0.0304s/iter; left time: 1458.4885s
	iters: 3000, epoch: 4 | loss: 1.5319341
	speed: 0.0303s/iter; left time: 1454.1351s
	iters: 3100, epoch: 4 | loss: 1.5220712
	speed: 0.0304s/iter; left time: 1452.5254s
	iters: 3200, epoch: 4 | loss: 1.5333815
	speed: 0.0304s/iter; left time: 1449.1392s
	iters: 3300, epoch: 4 | loss: 1.5706747
	speed: 0.0303s/iter; left time: 1445.5113s
	iters: 3400, epoch: 4 | loss: 1.5561414
	speed: 0.0304s/iter; left time: 1443.3072s
	iters: 3500, epoch: 4 | loss: 1.7276684
	speed: 0.0304s/iter; left time: 1440.0579s
	iters: 3600, epoch: 4 | loss: 1.6540927
	speed: 0.0303s/iter; left time: 1436.6540s
	iters: 3700, epoch: 4 | loss: 1.6668599
	speed: 0.0303s/iter; left time: 1433.4124s
	iters: 3800, epoch: 4 | loss: 1.5450112
	speed: 0.0303s/iter; left time: 1430.5000s
	iters: 3900, epoch: 4 | loss: 1.8774841
	speed: 0.0304s/iter; left time: 1428.8315s
	iters: 4000, epoch: 4 | loss: 1.6361707
	speed: 0.0304s/iter; left time: 1425.8087s
	iters: 4100, epoch: 4 | loss: 1.6825290
	speed: 0.0304s/iter; left time: 1422.2578s
	iters: 4200, epoch: 4 | loss: 1.4540086
	speed: 0.0304s/iter; left time: 1418.9432s
	iters: 4300, epoch: 4 | loss: 1.6949319
	speed: 0.0304s/iter; left time: 1416.1100s
	iters: 4400, epoch: 4 | loss: 1.8827637
	speed: 0.0304s/iter; left time: 1413.2136s
	iters: 4500, epoch: 4 | loss: 1.6372842
	speed: 0.0303s/iter; left time: 1409.1361s
	iters: 4600, epoch: 4 | loss: 1.3776199
	speed: 0.0305s/iter; left time: 1412.7794s
	iters: 4700, epoch: 4 | loss: 1.6597335
	speed: 0.0304s/iter; left time: 1403.8930s
	iters: 4800, epoch: 4 | loss: 1.8358645
	speed: 0.0303s/iter; left time: 1399.9468s
	iters: 4900, epoch: 4 | loss: 1.6149246
	speed: 0.0304s/iter; left time: 1399.7271s
	iters: 5000, epoch: 4 | loss: 1.8147262
	speed: 0.0303s/iter; left time: 1393.7349s
	iters: 5100, epoch: 4 | loss: 1.6333114
	speed: 0.0304s/iter; left time: 1391.6722s
	iters: 5200, epoch: 4 | loss: 1.7888291
	speed: 0.0305s/iter; left time: 1394.1576s
	iters: 5300, epoch: 4 | loss: 1.5820599
	speed: 0.0303s/iter; left time: 1385.0686s
	iters: 5400, epoch: 4 | loss: 1.5824101
	speed: 0.0304s/iter; left time: 1382.9332s
	iters: 5500, epoch: 4 | loss: 1.5548390
	speed: 0.0304s/iter; left time: 1379.7327s
	iters: 5600, epoch: 4 | loss: 1.6041702
	speed: 0.0304s/iter; left time: 1376.4827s
	iters: 5700, epoch: 4 | loss: 1.5576485
	speed: 0.0304s/iter; left time: 1375.0155s
	iters: 5800, epoch: 4 | loss: 1.7640581
	speed: 0.0303s/iter; left time: 1368.9493s
	iters: 5900, epoch: 4 | loss: 1.7148659
	speed: 0.0304s/iter; left time: 1367.4004s
	iters: 6000, epoch: 4 | loss: 1.6501747
	speed: 0.0303s/iter; left time: 1363.9657s
	iters: 6100, epoch: 4 | loss: 1.5614940
	speed: 0.0304s/iter; left time: 1362.0552s
	iters: 6200, epoch: 4 | loss: 1.5790006
	speed: 0.0304s/iter; left time: 1358.2479s
	iters: 6300, epoch: 4 | loss: 1.6761467
	speed: 0.0304s/iter; left time: 1356.4949s
	iters: 6400, epoch: 4 | loss: 1.7228037
	speed: 0.0304s/iter; left time: 1353.2311s
	iters: 6500, epoch: 4 | loss: 1.6483272
	speed: 0.0304s/iter; left time: 1350.2476s
	iters: 6600, epoch: 4 | loss: 1.8445140
	speed: 0.0304s/iter; left time: 1347.4414s
	iters: 6700, epoch: 4 | loss: 1.6200781
	speed: 0.0304s/iter; left time: 1344.2883s
	iters: 6800, epoch: 4 | loss: 1.6256249
	speed: 0.0304s/iter; left time: 1340.2925s
	iters: 6900, epoch: 4 | loss: 1.5657318
	speed: 0.0304s/iter; left time: 1339.6607s
	iters: 7000, epoch: 4 | loss: 1.7050846
	speed: 0.0304s/iter; left time: 1334.5191s
	iters: 7100, epoch: 4 | loss: 1.4137638
	speed: 0.0304s/iter; left time: 1331.8726s
	iters: 7200, epoch: 4 | loss: 1.8385127
	speed: 0.0304s/iter; left time: 1328.3373s
Epoch: 4 cost time: 221.167959690094
Epoch: 4, Steps: 7278 | Train Loss: 1.6706168 Vali Loss: 1.8537714 Test Loss: 1.6124581
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247821
test shape: (24782, 1, 336, 151) (24782, 1, 336, 151)
test shape: (24782, 336, 151) (24782, 336, 151)
mse:1.6142184734344482, mae:0.9603198766708374
>>>>>>>Overall time: 1641 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
