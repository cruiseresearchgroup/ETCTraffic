Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 742470
val 141828
test 141826
	iters: 100, epoch: 1 | loss: 1.5879892
	speed: 0.2915s/iter; left time: 135212.0580s
	iters: 200, epoch: 1 | loss: 1.4503049
	speed: 0.2910s/iter; left time: 134943.2704s
	iters: 300, epoch: 1 | loss: 1.5423454
	speed: 0.2903s/iter; left time: 134611.2051s
	iters: 400, epoch: 1 | loss: 1.2229594
	speed: 0.2901s/iter; left time: 134504.2177s
	iters: 500, epoch: 1 | loss: 1.3392769
	speed: 0.2904s/iter; left time: 134605.1006s
	iters: 600, epoch: 1 | loss: 1.4702567
	speed: 0.2905s/iter; left time: 134606.7519s
	iters: 700, epoch: 1 | loss: 1.4643222
	speed: 0.2906s/iter; left time: 134646.1053s
	iters: 800, epoch: 1 | loss: 1.2571584
	speed: 0.2905s/iter; left time: 134538.0152s
	iters: 900, epoch: 1 | loss: 1.2685009
	speed: 0.2907s/iter; left time: 134620.5797s
	iters: 1000, epoch: 1 | loss: 1.2782861
	speed: 0.2913s/iter; left time: 134852.8419s
	iters: 1100, epoch: 1 | loss: 1.6278422
	speed: 0.2902s/iter; left time: 134337.8576s
	iters: 1200, epoch: 1 | loss: 1.2878275
	speed: 0.2910s/iter; left time: 134673.2920s
	iters: 1300, epoch: 1 | loss: 1.1473421
	speed: 0.2902s/iter; left time: 134254.6394s
	iters: 1400, epoch: 1 | loss: 1.2162048
	speed: 0.2899s/iter; left time: 134089.9022s
	iters: 1500, epoch: 1 | loss: 1.2173331
	speed: 0.2910s/iter; left time: 134608.4935s
	iters: 1600, epoch: 1 | loss: 1.2566173
	speed: 0.2907s/iter; left time: 134418.4898s
	iters: 1700, epoch: 1 | loss: 1.3630587
	speed: 0.2907s/iter; left time: 134406.3854s
	iters: 1800, epoch: 1 | loss: 1.2869478
	speed: 0.2909s/iter; left time: 134432.9859s
	iters: 1900, epoch: 1 | loss: 1.3396916
	speed: 0.2906s/iter; left time: 134284.6653s
	iters: 2000, epoch: 1 | loss: 1.3081224
	speed: 0.2911s/iter; left time: 134486.4209s
	iters: 2100, epoch: 1 | loss: 1.1174847
	speed: 0.2919s/iter; left time: 134827.2690s
	iters: 2200, epoch: 1 | loss: 1.2051066
	speed: 0.2871s/iter; left time: 132575.4284s
	iters: 2300, epoch: 1 | loss: 1.0951703
	speed: 0.2909s/iter; left time: 134290.7754s
Epoch: 1 cost time: 674.3883159160614
Epoch: 1, Steps: 2320 | Train Loss: 1.2737060 Vali Loss: 0.9837025 Test Loss: 1.0798893
Validation loss decreased (inf --> 0.983703).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.1420041
	speed: 2.5251s/iter; left time: 1165522.9632s
	iters: 200, epoch: 2 | loss: 1.2503018
	speed: 0.2870s/iter; left time: 132422.0067s
	iters: 300, epoch: 2 | loss: 1.0487367
	speed: 0.2883s/iter; left time: 133032.2341s
	iters: 400, epoch: 2 | loss: 0.9636558
	speed: 0.2885s/iter; left time: 133083.2457s
	iters: 500, epoch: 2 | loss: 1.2970206
	speed: 0.2901s/iter; left time: 133770.9296s
	iters: 600, epoch: 2 | loss: 0.9712461
	speed: 0.2888s/iter; left time: 133180.3721s
	iters: 700, epoch: 2 | loss: 1.1953930
	speed: 0.2890s/iter; left time: 133216.1556s
	iters: 800, epoch: 2 | loss: 1.0215731
	speed: 0.2889s/iter; left time: 133164.7774s
	iters: 900, epoch: 2 | loss: 1.0417359
	speed: 0.2888s/iter; left time: 133069.6281s
	iters: 1000, epoch: 2 | loss: 1.2945534
	speed: 0.2881s/iter; left time: 132720.6120s
	iters: 1100, epoch: 2 | loss: 1.2425208
	speed: 0.2887s/iter; left time: 132952.3774s
	iters: 1200, epoch: 2 | loss: 0.9317282
	speed: 0.2889s/iter; left time: 133050.3572s
	iters: 1300, epoch: 2 | loss: 0.8867496
	speed: 0.2884s/iter; left time: 132789.3402s
	iters: 1400, epoch: 2 | loss: 1.0444540
	speed: 0.2884s/iter; left time: 132734.0134s
	iters: 1500, epoch: 2 | loss: 1.0415637
	speed: 0.2880s/iter; left time: 132541.3252s
	iters: 1600, epoch: 2 | loss: 1.0635451
	speed: 0.2884s/iter; left time: 132692.3203s
	iters: 1700, epoch: 2 | loss: 0.9249688
	speed: 0.2884s/iter; left time: 132672.4182s
	iters: 1800, epoch: 2 | loss: 1.0666428
	speed: 0.2878s/iter; left time: 132337.8072s
	iters: 1900, epoch: 2 | loss: 1.1836435
	speed: 0.2887s/iter; left time: 132759.3368s
	iters: 2000, epoch: 2 | loss: 0.9112214
	speed: 0.2888s/iter; left time: 132736.7257s
	iters: 2100, epoch: 2 | loss: 0.9427137
	speed: 0.2883s/iter; left time: 132490.3493s
	iters: 2200, epoch: 2 | loss: 0.8537191
	speed: 0.2882s/iter; left time: 132402.5309s
	iters: 2300, epoch: 2 | loss: 1.0225632
	speed: 0.2897s/iter; left time: 133061.8562s
Epoch: 2 cost time: 669.7218563556671
Epoch: 2, Steps: 2320 | Train Loss: 1.0433618 Vali Loss: 0.8758946 Test Loss: 0.9225461
Validation loss decreased (0.983703 --> 0.875895).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8600895
	speed: 2.5268s/iter; left time: 1160468.2066s
	iters: 200, epoch: 3 | loss: 0.8660558
	speed: 0.2884s/iter; left time: 132442.3884s
	iters: 300, epoch: 3 | loss: 0.9283068
	speed: 0.2883s/iter; left time: 132360.8040s
	iters: 400, epoch: 3 | loss: 0.8140303
	speed: 0.2880s/iter; left time: 132166.7691s
	iters: 500, epoch: 3 | loss: 0.9084615
	speed: 0.2886s/iter; left time: 132444.6351s
	iters: 600, epoch: 3 | loss: 0.9773556
	speed: 0.2883s/iter; left time: 132269.2333s
	iters: 700, epoch: 3 | loss: 0.9310964
	speed: 0.2885s/iter; left time: 132313.2176s
	iters: 800, epoch: 3 | loss: 0.7795969
	speed: 0.2884s/iter; left time: 132230.1764s
	iters: 900, epoch: 3 | loss: 0.9563093
	speed: 0.2886s/iter; left time: 132305.1481s
	iters: 1000, epoch: 3 | loss: 0.9109131
	speed: 0.2884s/iter; left time: 132180.7182s
	iters: 1100, epoch: 3 | loss: 0.6836749
	speed: 0.2884s/iter; left time: 132154.4230s
	iters: 1200, epoch: 3 | loss: 0.9095214
	speed: 0.2883s/iter; left time: 132109.1778s
	iters: 1300, epoch: 3 | loss: 0.9013861
	speed: 0.2882s/iter; left time: 132007.8854s
	iters: 1400, epoch: 3 | loss: 1.1477304
	speed: 0.2891s/iter; left time: 132377.1449s
	iters: 1500, epoch: 3 | loss: 1.0361496
	speed: 0.2886s/iter; left time: 132156.5300s
	iters: 1600, epoch: 3 | loss: 0.8513674
	speed: 0.2887s/iter; left time: 132144.8707s
	iters: 1700, epoch: 3 | loss: 0.8893898
	speed: 0.2883s/iter; left time: 131954.8851s
	iters: 1800, epoch: 3 | loss: 0.8520482
	speed: 0.2883s/iter; left time: 131934.3043s
	iters: 1900, epoch: 3 | loss: 0.9319843
	speed: 0.2886s/iter; left time: 132044.1948s
	iters: 2000, epoch: 3 | loss: 0.6954790
	speed: 0.2886s/iter; left time: 132007.5184s
	iters: 2100, epoch: 3 | loss: 0.7700122
	speed: 0.2886s/iter; left time: 131971.6685s
	iters: 2200, epoch: 3 | loss: 1.0210160
	speed: 0.2895s/iter; left time: 132327.1934s
	iters: 2300, epoch: 3 | loss: 0.7538697
	speed: 0.2964s/iter; left time: 135461.3201s
Epoch: 3 cost time: 670.3020317554474
Epoch: 3, Steps: 2320 | Train Loss: 0.9211776 Vali Loss: 0.8836674 Test Loss: 0.9371403
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.7815298
	speed: 2.5230s/iter; left time: 1152858.9497s
	iters: 200, epoch: 4 | loss: 0.6425083
	speed: 0.2936s/iter; left time: 134117.4400s
	iters: 300, epoch: 4 | loss: 0.7899109
	speed: 0.2935s/iter; left time: 134056.4962s
	iters: 400, epoch: 4 | loss: 0.8064104
	speed: 0.2930s/iter; left time: 133784.6306s
	iters: 500, epoch: 4 | loss: 0.7169459
	speed: 0.2926s/iter; left time: 133575.8266s
	iters: 600, epoch: 4 | loss: 0.8374831
	speed: 0.2926s/iter; left time: 133568.3070s
	iters: 700, epoch: 4 | loss: 0.9265363
	speed: 0.2925s/iter; left time: 133485.8897s
	iters: 800, epoch: 4 | loss: 0.9099499
	speed: 0.2924s/iter; left time: 133426.5171s
	iters: 900, epoch: 4 | loss: 0.8685177
	speed: 0.2927s/iter; left time: 133519.6635s
	iters: 1000, epoch: 4 | loss: 1.0326453
	speed: 0.2934s/iter; left time: 133793.3534s
	iters: 1100, epoch: 4 | loss: 0.8319393
	speed: 0.2921s/iter; left time: 133193.7000s
	iters: 1200, epoch: 4 | loss: 0.5647184
	speed: 0.2926s/iter; left time: 133397.7871s
	iters: 1300, epoch: 4 | loss: 0.9074262
	speed: 0.2928s/iter; left time: 133434.1736s
	iters: 1400, epoch: 4 | loss: 0.7952660
	speed: 0.2928s/iter; left time: 133408.3464s
	iters: 1500, epoch: 4 | loss: 0.8889854
	speed: 0.2924s/iter; left time: 133196.6652s
	iters: 1600, epoch: 4 | loss: 0.8343912
	speed: 0.2924s/iter; left time: 133155.8909s
	iters: 1700, epoch: 4 | loss: 0.6626190
	speed: 0.2929s/iter; left time: 133388.9861s
	iters: 1800, epoch: 4 | loss: 1.3185146
	speed: 0.2927s/iter; left time: 133231.4097s
	iters: 1900, epoch: 4 | loss: 0.8741752
	speed: 0.2921s/iter; left time: 132968.6625s
	iters: 2000, epoch: 4 | loss: 0.9255672
	speed: 0.2923s/iter; left time: 132988.4289s
	iters: 2100, epoch: 4 | loss: 0.8882066
	speed: 0.2925s/iter; left time: 133061.9709s
	iters: 2200, epoch: 4 | loss: 0.8603477
	speed: 0.2923s/iter; left time: 132963.0483s
	iters: 2300, epoch: 4 | loss: 0.7891591
	speed: 0.2924s/iter; left time: 132980.9516s
Epoch: 4 cost time: 679.2122092247009
Epoch: 4, Steps: 2320 | Train Loss: 0.8773902 Vali Loss: 1.0160251 Test Loss: 1.0657250
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.8629712
	speed: 2.5396s/iter; left time: 1154559.1890s
	iters: 200, epoch: 5 | loss: 0.8104010
	speed: 0.2919s/iter; left time: 132686.1399s
	iters: 300, epoch: 5 | loss: 0.9357139
	speed: 0.2895s/iter; left time: 131562.9014s
	iters: 400, epoch: 5 | loss: 0.7936376
	speed: 0.2873s/iter; left time: 130535.2828s
	iters: 500, epoch: 5 | loss: 0.7537862
	speed: 0.2876s/iter; left time: 130619.8347s
	iters: 600, epoch: 5 | loss: 0.8558820
	speed: 0.2886s/iter; left time: 131038.3589s
	iters: 700, epoch: 5 | loss: 0.8821713
	speed: 0.2881s/iter; left time: 130799.9903s
	iters: 800, epoch: 5 | loss: 0.8705131
	speed: 0.2909s/iter; left time: 132063.3260s
	iters: 900, epoch: 5 | loss: 0.9037999
	speed: 0.2892s/iter; left time: 131225.5663s
	iters: 1000, epoch: 5 | loss: 0.8080807
	speed: 0.2888s/iter; left time: 131053.5831s
	iters: 1100, epoch: 5 | loss: 0.8005430
	speed: 0.2885s/iter; left time: 130851.7482s
	iters: 1200, epoch: 5 | loss: 0.8019524
	speed: 0.2873s/iter; left time: 130312.9907s
	iters: 1300, epoch: 5 | loss: 0.7372628
	speed: 0.2870s/iter; left time: 130114.4592s
	iters: 1400, epoch: 5 | loss: 0.7376137
	speed: 0.2888s/iter; left time: 130904.8031s
	iters: 1500, epoch: 5 | loss: 0.9114828
	speed: 0.2876s/iter; left time: 130364.2213s
	iters: 1600, epoch: 5 | loss: 0.8578755
	speed: 0.2878s/iter; left time: 130405.2895s
	iters: 1700, epoch: 5 | loss: 0.8794454
	speed: 0.2873s/iter; left time: 130160.9519s
	iters: 1800, epoch: 5 | loss: 0.6285684
	speed: 0.2872s/iter; left time: 130079.9221s
	iters: 1900, epoch: 5 | loss: 0.9115605
	speed: 0.2868s/iter; left time: 129865.0448s
	iters: 2000, epoch: 5 | loss: 0.6627845
	speed: 0.2869s/iter; left time: 129895.6437s
	iters: 2100, epoch: 5 | loss: 0.7187336
	speed: 0.2919s/iter; left time: 132108.7760s
	iters: 2200, epoch: 5 | loss: 0.9499181
	speed: 0.2869s/iter; left time: 129831.3662s
	iters: 2300, epoch: 5 | loss: 0.8245851
	speed: 0.2869s/iter; left time: 129790.1696s
Epoch: 5 cost time: 668.9874730110168
Epoch: 5, Steps: 2320 | Train Loss: 0.8644344 Vali Loss: 0.9452922 Test Loss: 1.0414380
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.7351416
	speed: 2.5343s/iter; left time: 1146262.3074s
	iters: 200, epoch: 6 | loss: 0.7735094
	speed: 0.2877s/iter; left time: 130113.5123s
	iters: 300, epoch: 6 | loss: 0.9231367
	speed: 0.2874s/iter; left time: 129913.6967s
	iters: 400, epoch: 6 | loss: 0.8202316
	speed: 0.2887s/iter; left time: 130470.1016s
	iters: 500, epoch: 6 | loss: 0.9098623
	speed: 0.2887s/iter; left time: 130483.9141s
	iters: 600, epoch: 6 | loss: 0.7649641
	speed: 0.2875s/iter; left time: 129880.4301s
	iters: 700, epoch: 6 | loss: 0.7963669
	speed: 0.2873s/iter; left time: 129782.9849s
	iters: 800, epoch: 6 | loss: 0.8973544
	speed: 0.2875s/iter; left time: 129812.8491s
	iters: 900, epoch: 6 | loss: 0.7979797
	speed: 0.2905s/iter; left time: 131152.2445s
	iters: 1000, epoch: 6 | loss: 0.9152361
	speed: 0.2870s/iter; left time: 129532.3600s
	iters: 1100, epoch: 6 | loss: 0.8791004
	speed: 0.2877s/iter; left time: 129834.0651s
	iters: 1200, epoch: 6 | loss: 0.9161938
	speed: 0.2889s/iter; left time: 130372.8313s
	iters: 1300, epoch: 6 | loss: 0.7467803
	speed: 0.2876s/iter; left time: 129728.6931s
	iters: 1400, epoch: 6 | loss: 0.7257214
	speed: 0.2880s/iter; left time: 129882.9039s
	iters: 1500, epoch: 6 | loss: 0.7738699
	speed: 0.2877s/iter; left time: 129741.9126s
	iters: 1600, epoch: 6 | loss: 0.7187240
	speed: 0.2874s/iter; left time: 129559.9398s
	iters: 1700, epoch: 6 | loss: 0.9168040
	speed: 0.2872s/iter; left time: 129429.4481s
	iters: 1800, epoch: 6 | loss: 1.0660092
	speed: 0.2884s/iter; left time: 129964.6578s
	iters: 1900, epoch: 6 | loss: 0.9018899
	speed: 0.2873s/iter; left time: 129416.0785s
	iters: 2000, epoch: 6 | loss: 0.8701426
	speed: 0.2872s/iter; left time: 129352.7319s
	iters: 2100, epoch: 6 | loss: 0.8882542
	speed: 0.2872s/iter; left time: 129324.7875s
	iters: 2200, epoch: 6 | loss: 0.6940374
	speed: 0.2885s/iter; left time: 129862.0822s
	iters: 2300, epoch: 6 | loss: 0.9784960
	speed: 0.2875s/iter; left time: 129381.6350s
Epoch: 6 cost time: 667.8736715316772
Epoch: 6, Steps: 2320 | Train Loss: 0.8246441 Vali Loss: 0.9365059 Test Loss: 0.9810740
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.7715463
	speed: 2.5410s/iter; left time: 1143417.1501s
	iters: 200, epoch: 7 | loss: 0.6594478
	speed: 0.2881s/iter; left time: 129625.9586s
	iters: 300, epoch: 7 | loss: 0.8318984
	speed: 0.2884s/iter; left time: 129726.3872s
	iters: 400, epoch: 7 | loss: 0.7966480
	speed: 0.2879s/iter; left time: 129455.5155s
	iters: 500, epoch: 7 | loss: 0.8432377
	speed: 0.2880s/iter; left time: 129457.7679s
	iters: 600, epoch: 7 | loss: 0.7944888
	speed: 0.2887s/iter; left time: 129774.0642s
	iters: 700, epoch: 7 | loss: 0.8132885
	speed: 0.2882s/iter; left time: 129517.2127s
	iters: 800, epoch: 7 | loss: 0.7794257
	speed: 0.2882s/iter; left time: 129469.2850s
	iters: 900, epoch: 7 | loss: 0.7611626
	speed: 0.2901s/iter; left time: 130316.0183s
	iters: 1000, epoch: 7 | loss: 0.8517051
	speed: 0.2883s/iter; left time: 129488.5096s
	iters: 1100, epoch: 7 | loss: 0.8072359
	speed: 0.2873s/iter; left time: 128994.0654s
	iters: 1200, epoch: 7 | loss: 0.8183696
	speed: 0.2872s/iter; left time: 128906.7097s
	iters: 1300, epoch: 7 | loss: 0.7117258
	speed: 0.2891s/iter; left time: 129731.1944s
	iters: 1400, epoch: 7 | loss: 0.9984687
	speed: 0.2875s/iter; left time: 128983.2277s
	iters: 1500, epoch: 7 | loss: 1.0599170
	speed: 0.2900s/iter; left time: 130098.5679s
	iters: 1600, epoch: 7 | loss: 0.8239331
	speed: 0.2874s/iter; left time: 128908.9812s
	iters: 1700, epoch: 7 | loss: 0.8988084
	speed: 0.2901s/iter; left time: 130095.3605s
	iters: 1800, epoch: 7 | loss: 0.6645191
	speed: 0.2902s/iter; left time: 130082.2987s
	iters: 1900, epoch: 7 | loss: 0.6901528
	speed: 0.2878s/iter; left time: 128964.9220s
	iters: 2000, epoch: 7 | loss: 0.7433040
	speed: 0.2881s/iter; left time: 129096.4742s
	iters: 2100, epoch: 7 | loss: 0.7139642
	speed: 0.2888s/iter; left time: 129374.6629s
	iters: 2200, epoch: 7 | loss: 0.9252031
	speed: 0.2878s/iter; left time: 128880.9211s
	iters: 2300, epoch: 7 | loss: 0.9097772
	speed: 0.2895s/iter; left time: 129642.8166s
Epoch: 7 cost time: 669.8424174785614
Epoch: 7, Steps: 2320 | Train Loss: 0.8066617 Vali Loss: 0.9030579 Test Loss: 0.9349559
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141826
test shape: (14182, 1, 720, 130) (14182, 1, 720, 130)
test shape: (14182, 720, 130) (14182, 720, 130)
mse:0.922544538974762, mae:0.7425599098205566
>>>>>>>Overall time: 6502 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
