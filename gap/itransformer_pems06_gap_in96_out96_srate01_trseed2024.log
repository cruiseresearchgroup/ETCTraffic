Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 945983
val 44971
test 195154
	iters: 100, epoch: 1 | loss: 2.0645213
	speed: 0.0338s/iter; left time: 1997.5814s
	iters: 200, epoch: 1 | loss: 2.2549555
	speed: 0.0299s/iter; left time: 1761.5144s
	iters: 300, epoch: 1 | loss: 2.7104199
	speed: 0.0304s/iter; left time: 1787.3422s
	iters: 400, epoch: 1 | loss: 1.5613930
	speed: 0.0305s/iter; left time: 1789.0555s
	iters: 500, epoch: 1 | loss: 1.8374778
	speed: 0.0304s/iter; left time: 1780.1678s
	iters: 600, epoch: 1 | loss: 1.5544297
	speed: 0.0305s/iter; left time: 1787.0262s
	iters: 700, epoch: 1 | loss: 2.0216222
	speed: 0.0303s/iter; left time: 1772.1722s
	iters: 800, epoch: 1 | loss: 1.9610523
	speed: 0.0302s/iter; left time: 1762.6396s
	iters: 900, epoch: 1 | loss: 1.9746404
	speed: 0.0300s/iter; left time: 1747.3110s
	iters: 1000, epoch: 1 | loss: 1.8702390
	speed: 0.0302s/iter; left time: 1757.8920s
	iters: 1100, epoch: 1 | loss: 1.5034720
	speed: 0.0300s/iter; left time: 1738.0841s
	iters: 1200, epoch: 1 | loss: 2.5903480
	speed: 0.0303s/iter; left time: 1752.7475s
	iters: 1300, epoch: 1 | loss: 1.6521454
	speed: 0.0304s/iter; left time: 1757.0352s
	iters: 1400, epoch: 1 | loss: 1.9651289
	speed: 0.0303s/iter; left time: 1749.9304s
	iters: 1500, epoch: 1 | loss: 1.7560928
	speed: 0.0304s/iter; left time: 1752.6845s
	iters: 1600, epoch: 1 | loss: 1.8859370
	speed: 0.0299s/iter; left time: 1719.4123s
	iters: 1700, epoch: 1 | loss: 1.9254478
	speed: 0.0305s/iter; left time: 1751.8982s
	iters: 1800, epoch: 1 | loss: 1.3766133
	speed: 0.0304s/iter; left time: 1741.9627s
	iters: 1900, epoch: 1 | loss: 1.6754088
	speed: 0.0304s/iter; left time: 1741.1659s
	iters: 2000, epoch: 1 | loss: 1.4532863
	speed: 0.0304s/iter; left time: 1735.1264s
	iters: 2100, epoch: 1 | loss: 1.4476891
	speed: 0.0301s/iter; left time: 1718.7905s
	iters: 2200, epoch: 1 | loss: 1.8273128
	speed: 0.0301s/iter; left time: 1710.5639s
	iters: 2300, epoch: 1 | loss: 2.5710456
	speed: 0.0302s/iter; left time: 1717.0232s
	iters: 2400, epoch: 1 | loss: 1.7291492
	speed: 0.0304s/iter; left time: 1724.9633s
	iters: 2500, epoch: 1 | loss: 1.3922724
	speed: 0.0300s/iter; left time: 1696.4556s
	iters: 2600, epoch: 1 | loss: 2.0043590
	speed: 0.0300s/iter; left time: 1695.4395s
	iters: 2700, epoch: 1 | loss: 1.7430607
	speed: 0.0303s/iter; left time: 1708.1503s
	iters: 2800, epoch: 1 | loss: 1.6775458
	speed: 0.0304s/iter; left time: 1711.5177s
	iters: 2900, epoch: 1 | loss: 1.9292125
	speed: 0.0303s/iter; left time: 1702.1362s
	iters: 3000, epoch: 1 | loss: 2.2471461
	speed: 0.0304s/iter; left time: 1704.7584s
	iters: 3100, epoch: 1 | loss: 2.2349677
	speed: 0.0304s/iter; left time: 1702.4731s
	iters: 3200, epoch: 1 | loss: 1.9872601
	speed: 0.0304s/iter; left time: 1699.3324s
	iters: 3300, epoch: 1 | loss: 1.8120487
	speed: 0.0304s/iter; left time: 1695.9078s
	iters: 3400, epoch: 1 | loss: 1.6142613
	speed: 0.0304s/iter; left time: 1692.1464s
	iters: 3500, epoch: 1 | loss: 1.6060063
	speed: 0.0304s/iter; left time: 1690.7495s
	iters: 3600, epoch: 1 | loss: 1.4665550
	speed: 0.0305s/iter; left time: 1692.9113s
	iters: 3700, epoch: 1 | loss: 1.9958634
	speed: 0.0304s/iter; left time: 1685.4483s
	iters: 3800, epoch: 1 | loss: 1.9353610
	speed: 0.0304s/iter; left time: 1681.5029s
	iters: 3900, epoch: 1 | loss: 1.5892297
	speed: 0.0303s/iter; left time: 1671.7579s
	iters: 4000, epoch: 1 | loss: 1.8277707
	speed: 0.0304s/iter; left time: 1675.3660s
	iters: 4100, epoch: 1 | loss: 1.8586224
	speed: 0.0304s/iter; left time: 1672.4383s
	iters: 4200, epoch: 1 | loss: 1.9407325
	speed: 0.0304s/iter; left time: 1668.6858s
	iters: 4300, epoch: 1 | loss: 1.7190095
	speed: 0.0304s/iter; left time: 1665.5270s
	iters: 4400, epoch: 1 | loss: 1.5882137
	speed: 0.0304s/iter; left time: 1660.9726s
	iters: 4500, epoch: 1 | loss: 2.1786628
	speed: 0.0302s/iter; left time: 1650.7691s
	iters: 4600, epoch: 1 | loss: 1.4796953
	speed: 0.0304s/iter; left time: 1656.2886s
	iters: 4700, epoch: 1 | loss: 1.5087423
	speed: 0.0303s/iter; left time: 1647.3710s
	iters: 4800, epoch: 1 | loss: 1.6189070
	speed: 0.0302s/iter; left time: 1639.2023s
	iters: 4900, epoch: 1 | loss: 2.6194398
	speed: 0.0304s/iter; left time: 1647.2947s
	iters: 5000, epoch: 1 | loss: 1.8041101
	speed: 0.0303s/iter; left time: 1640.0890s
	iters: 5100, epoch: 1 | loss: 1.6400121
	speed: 0.0300s/iter; left time: 1618.1755s
	iters: 5200, epoch: 1 | loss: 2.0404105
	speed: 0.0304s/iter; left time: 1637.9122s
	iters: 5300, epoch: 1 | loss: 1.6068779
	speed: 0.0302s/iter; left time: 1625.4804s
	iters: 5400, epoch: 1 | loss: 2.1681149
	speed: 0.0302s/iter; left time: 1620.8175s
	iters: 5500, epoch: 1 | loss: 1.5863047
	speed: 0.0303s/iter; left time: 1625.1332s
	iters: 5600, epoch: 1 | loss: 1.7804140
	speed: 0.0308s/iter; left time: 1646.7213s
	iters: 5700, epoch: 1 | loss: 1.8412642
	speed: 0.0304s/iter; left time: 1623.4158s
	iters: 5800, epoch: 1 | loss: 2.0225203
	speed: 0.0302s/iter; left time: 1611.1360s
	iters: 5900, epoch: 1 | loss: 1.7176383
	speed: 0.0304s/iter; left time: 1616.9096s
Epoch: 1 cost time: 179.59549617767334
Epoch: 1, Steps: 5912 | Train Loss: 1.8154171 Vali Loss: 1.2655790 Test Loss: 0.8750178
Validation loss decreased (inf --> 1.265579).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.7339065
	speed: 0.9134s/iter; left time: 48511.7004s
	iters: 200, epoch: 2 | loss: 1.7643727
	speed: 0.0292s/iter; left time: 1548.1410s
	iters: 300, epoch: 2 | loss: 1.9375964
	speed: 0.0299s/iter; left time: 1579.6046s
	iters: 400, epoch: 2 | loss: 2.5826607
	speed: 0.0300s/iter; left time: 1581.8918s
	iters: 500, epoch: 2 | loss: 2.3444130
	speed: 0.0304s/iter; left time: 1600.4182s
	iters: 600, epoch: 2 | loss: 2.1920812
	speed: 0.0294s/iter; left time: 1547.4782s
	iters: 700, epoch: 2 | loss: 1.9218538
	speed: 0.0303s/iter; left time: 1592.1585s
	iters: 800, epoch: 2 | loss: 1.6913586
	speed: 0.0303s/iter; left time: 1589.7413s
	iters: 900, epoch: 2 | loss: 1.3670672
	speed: 0.0296s/iter; left time: 1548.6050s
	iters: 1000, epoch: 2 | loss: 1.7186990
	speed: 0.0304s/iter; left time: 1587.0729s
	iters: 1100, epoch: 2 | loss: 1.9254254
	speed: 0.0301s/iter; left time: 1566.4233s
	iters: 1200, epoch: 2 | loss: 1.8849651
	speed: 0.0304s/iter; left time: 1580.9256s
	iters: 1300, epoch: 2 | loss: 1.7319103
	speed: 0.0299s/iter; left time: 1552.1779s
	iters: 1400, epoch: 2 | loss: 2.0983956
	speed: 0.0300s/iter; left time: 1555.6968s
	iters: 1500, epoch: 2 | loss: 1.8657556
	speed: 0.0301s/iter; left time: 1557.6603s
	iters: 1600, epoch: 2 | loss: 1.3276199
	speed: 0.0301s/iter; left time: 1555.3344s
	iters: 1700, epoch: 2 | loss: 2.4743347
	speed: 0.0301s/iter; left time: 1551.1468s
	iters: 1800, epoch: 2 | loss: 1.9447199
	speed: 0.0303s/iter; left time: 1557.8806s
	iters: 1900, epoch: 2 | loss: 1.5091788
	speed: 0.0298s/iter; left time: 1528.1305s
	iters: 2000, epoch: 2 | loss: 1.5868731
	speed: 0.0302s/iter; left time: 1545.5503s
	iters: 2100, epoch: 2 | loss: 2.0136347
	speed: 0.0296s/iter; left time: 1512.0374s
	iters: 2200, epoch: 2 | loss: 1.4095958
	speed: 0.0304s/iter; left time: 1551.6323s
	iters: 2300, epoch: 2 | loss: 2.3336990
	speed: 0.0305s/iter; left time: 1550.9158s
	iters: 2400, epoch: 2 | loss: 1.5167626
	speed: 0.0301s/iter; left time: 1528.6484s
	iters: 2500, epoch: 2 | loss: 1.5525587
	speed: 0.0302s/iter; left time: 1528.9813s
	iters: 2600, epoch: 2 | loss: 2.3435528
	speed: 0.0305s/iter; left time: 1542.4219s
	iters: 2700, epoch: 2 | loss: 1.2809207
	speed: 0.0293s/iter; left time: 1481.9007s
	iters: 2800, epoch: 2 | loss: 2.0610979
	speed: 0.0297s/iter; left time: 1497.5007s
	iters: 2900, epoch: 2 | loss: 1.5188653
	speed: 0.0294s/iter; left time: 1481.2062s
	iters: 3000, epoch: 2 | loss: 1.7228161
	speed: 0.0289s/iter; left time: 1452.2366s
	iters: 3100, epoch: 2 | loss: 1.7298734
	speed: 0.0303s/iter; left time: 1515.8540s
	iters: 3200, epoch: 2 | loss: 2.0038118
	speed: 0.0304s/iter; left time: 1519.6905s
	iters: 3300, epoch: 2 | loss: 2.3620307
	speed: 0.0303s/iter; left time: 1511.8908s
	iters: 3400, epoch: 2 | loss: 2.2091167
	speed: 0.0301s/iter; left time: 1498.8359s
	iters: 3500, epoch: 2 | loss: 1.7947509
	speed: 0.0303s/iter; left time: 1507.0893s
	iters: 3600, epoch: 2 | loss: 1.8618371
	speed: 0.0296s/iter; left time: 1470.7687s
	iters: 3700, epoch: 2 | loss: 1.6148138
	speed: 0.0297s/iter; left time: 1468.1820s
	iters: 3800, epoch: 2 | loss: 2.0836964
	speed: 0.0300s/iter; left time: 1481.1019s
	iters: 3900, epoch: 2 | loss: 2.1692662
	speed: 0.0296s/iter; left time: 1460.8064s
	iters: 4000, epoch: 2 | loss: 1.5940140
	speed: 0.0307s/iter; left time: 1510.3446s
	iters: 4100, epoch: 2 | loss: 1.9897414
	speed: 0.0307s/iter; left time: 1507.3882s
	iters: 4200, epoch: 2 | loss: 1.5391879
	speed: 0.0306s/iter; left time: 1497.8390s
	iters: 4300, epoch: 2 | loss: 2.1556227
	speed: 0.0306s/iter; left time: 1495.4016s
	iters: 4400, epoch: 2 | loss: 1.7109113
	speed: 0.0309s/iter; left time: 1507.2342s
	iters: 4500, epoch: 2 | loss: 1.9351225
	speed: 0.0306s/iter; left time: 1488.7111s
	iters: 4600, epoch: 2 | loss: 1.5391480
	speed: 0.0309s/iter; left time: 1504.2580s
	iters: 4700, epoch: 2 | loss: 1.8047959
	speed: 0.0305s/iter; left time: 1480.4897s
	iters: 4800, epoch: 2 | loss: 1.8361754
	speed: 0.0306s/iter; left time: 1479.5534s
	iters: 4900, epoch: 2 | loss: 1.5344003
	speed: 0.0307s/iter; left time: 1481.0472s
	iters: 5000, epoch: 2 | loss: 1.9324476
	speed: 0.0309s/iter; left time: 1487.8320s
	iters: 5100, epoch: 2 | loss: 1.7495277
	speed: 0.0309s/iter; left time: 1485.3815s
	iters: 5200, epoch: 2 | loss: 1.5682096
	speed: 0.0307s/iter; left time: 1474.4657s
	iters: 5300, epoch: 2 | loss: 1.9034388
	speed: 0.0306s/iter; left time: 1464.3319s
	iters: 5400, epoch: 2 | loss: 1.7930942
	speed: 0.0308s/iter; left time: 1472.4391s
	iters: 5500, epoch: 2 | loss: 1.9923400
	speed: 0.0307s/iter; left time: 1465.7470s
	iters: 5600, epoch: 2 | loss: 1.4370717
	speed: 0.0308s/iter; left time: 1466.5330s
	iters: 5700, epoch: 2 | loss: 1.6035733
	speed: 0.0307s/iter; left time: 1456.4843s
	iters: 5800, epoch: 2 | loss: 1.5342273
	speed: 0.0306s/iter; left time: 1452.1282s
	iters: 5900, epoch: 2 | loss: 2.1003883
	speed: 0.0311s/iter; left time: 1469.2258s
Epoch: 2 cost time: 178.9770703315735
Epoch: 2, Steps: 5912 | Train Loss: 1.8501044 Vali Loss: 1.2709585 Test Loss: 0.8747578
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6373285
	speed: 0.8869s/iter; left time: 41859.8884s
	iters: 200, epoch: 3 | loss: 2.0913916
	speed: 0.0293s/iter; left time: 1380.5586s
	iters: 300, epoch: 3 | loss: 1.4753766
	speed: 0.0295s/iter; left time: 1386.8388s
	iters: 400, epoch: 3 | loss: 1.5229266
	speed: 0.0297s/iter; left time: 1390.9854s
	iters: 500, epoch: 3 | loss: 1.9640383
	speed: 0.0302s/iter; left time: 1412.5779s
	iters: 600, epoch: 3 | loss: 1.9522136
	speed: 0.0301s/iter; left time: 1407.4371s
	iters: 700, epoch: 3 | loss: 2.0798850
	speed: 0.0305s/iter; left time: 1423.1405s
	iters: 800, epoch: 3 | loss: 1.5122473
	speed: 0.0296s/iter; left time: 1377.7970s
	iters: 900, epoch: 3 | loss: 1.9016432
	speed: 0.0305s/iter; left time: 1413.3401s
	iters: 1000, epoch: 3 | loss: 2.1040261
	speed: 0.0300s/iter; left time: 1390.7441s
	iters: 1100, epoch: 3 | loss: 2.0320375
	speed: 0.0304s/iter; left time: 1405.9237s
	iters: 1200, epoch: 3 | loss: 1.9330207
	speed: 0.0305s/iter; left time: 1405.2952s
	iters: 1300, epoch: 3 | loss: 1.8493612
	speed: 0.0305s/iter; left time: 1403.1977s
	iters: 1400, epoch: 3 | loss: 1.6048313
	speed: 0.0295s/iter; left time: 1351.8899s
	iters: 1500, epoch: 3 | loss: 1.5466713
	speed: 0.0291s/iter; left time: 1331.3532s
	iters: 1600, epoch: 3 | loss: 1.7603981
	speed: 0.0292s/iter; left time: 1333.6408s
	iters: 1700, epoch: 3 | loss: 2.2986071
	speed: 0.0297s/iter; left time: 1352.3360s
	iters: 1800, epoch: 3 | loss: 2.1517582
	speed: 0.0301s/iter; left time: 1370.1587s
	iters: 1900, epoch: 3 | loss: 1.6311703
	speed: 0.0303s/iter; left time: 1377.3308s
	iters: 2000, epoch: 3 | loss: 1.9192352
	speed: 0.0299s/iter; left time: 1354.4656s
	iters: 2100, epoch: 3 | loss: 1.5993727
	speed: 0.0301s/iter; left time: 1362.2362s
	iters: 2200, epoch: 3 | loss: 1.6837441
	speed: 0.0297s/iter; left time: 1337.4950s
	iters: 2300, epoch: 3 | loss: 1.5588263
	speed: 0.0300s/iter; left time: 1351.6618s
	iters: 2400, epoch: 3 | loss: 1.5174322
	speed: 0.0303s/iter; left time: 1361.0352s
	iters: 2500, epoch: 3 | loss: 1.9079119
	speed: 0.0304s/iter; left time: 1360.0036s
	iters: 2600, epoch: 3 | loss: 1.7228647
	speed: 0.0305s/iter; left time: 1363.2865s
	iters: 2700, epoch: 3 | loss: 1.6221113
	speed: 0.0301s/iter; left time: 1343.8457s
	iters: 2800, epoch: 3 | loss: 1.4136505
	speed: 0.0302s/iter; left time: 1343.2624s
	iters: 2900, epoch: 3 | loss: 2.3313549
	speed: 0.0304s/iter; left time: 1348.2214s
	iters: 3000, epoch: 3 | loss: 1.9400116
	speed: 0.0303s/iter; left time: 1343.9008s
	iters: 3100, epoch: 3 | loss: 1.8298024
	speed: 0.0299s/iter; left time: 1319.8559s
	iters: 3200, epoch: 3 | loss: 1.9287231
	speed: 0.0301s/iter; left time: 1325.3389s
	iters: 3300, epoch: 3 | loss: 1.9629710
	speed: 0.0302s/iter; left time: 1327.7027s
	iters: 3400, epoch: 3 | loss: 1.6406143
	speed: 0.0300s/iter; left time: 1317.0354s
	iters: 3500, epoch: 3 | loss: 1.3432006
	speed: 0.0301s/iter; left time: 1317.3294s
	iters: 3600, epoch: 3 | loss: 1.5566823
	speed: 0.0301s/iter; left time: 1313.6231s
	iters: 3700, epoch: 3 | loss: 2.2320352
	speed: 0.0305s/iter; left time: 1327.8419s
	iters: 3800, epoch: 3 | loss: 1.7567801
	speed: 0.0299s/iter; left time: 1302.2909s
	iters: 3900, epoch: 3 | loss: 1.9901928
	speed: 0.0304s/iter; left time: 1319.2843s
	iters: 4000, epoch: 3 | loss: 2.0185432
	speed: 0.0304s/iter; left time: 1314.9839s
	iters: 4100, epoch: 3 | loss: 2.3685405
	speed: 0.0304s/iter; left time: 1313.8039s
	iters: 4200, epoch: 3 | loss: 1.4145021
	speed: 0.0301s/iter; left time: 1295.4742s
	iters: 4300, epoch: 3 | loss: 1.8885536
	speed: 0.0302s/iter; left time: 1297.4666s
	iters: 4400, epoch: 3 | loss: 1.9428787
	speed: 0.0304s/iter; left time: 1305.6932s
	iters: 4500, epoch: 3 | loss: 2.2651827
	speed: 0.0298s/iter; left time: 1273.7669s
	iters: 4600, epoch: 3 | loss: 1.5400224
	speed: 0.0303s/iter; left time: 1293.1981s
	iters: 4700, epoch: 3 | loss: 1.3116065
	speed: 0.0304s/iter; left time: 1295.5521s
	iters: 4800, epoch: 3 | loss: 1.5874270
	speed: 0.0304s/iter; left time: 1293.7860s
	iters: 4900, epoch: 3 | loss: 1.7281594
	speed: 0.0304s/iter; left time: 1289.3713s
	iters: 5000, epoch: 3 | loss: 1.6435962
	speed: 0.0304s/iter; left time: 1287.6816s
	iters: 5100, epoch: 3 | loss: 1.9014437
	speed: 0.0304s/iter; left time: 1284.1520s
	iters: 5200, epoch: 3 | loss: 2.0719500
	speed: 0.0304s/iter; left time: 1277.6878s
	iters: 5300, epoch: 3 | loss: 1.7046043
	speed: 0.0302s/iter; left time: 1269.6328s
	iters: 5400, epoch: 3 | loss: 1.8583767
	speed: 0.0304s/iter; left time: 1273.1968s
	iters: 5500, epoch: 3 | loss: 1.6834635
	speed: 0.0304s/iter; left time: 1270.1852s
	iters: 5600, epoch: 3 | loss: 2.2357562
	speed: 0.0298s/iter; left time: 1244.5161s
	iters: 5700, epoch: 3 | loss: 1.7840179
	speed: 0.0300s/iter; left time: 1248.0809s
	iters: 5800, epoch: 3 | loss: 2.0293171
	speed: 0.0303s/iter; left time: 1259.3679s
	iters: 5900, epoch: 3 | loss: 1.8189297
	speed: 0.0302s/iter; left time: 1250.0150s
Epoch: 3 cost time: 178.29527020454407
Epoch: 3, Steps: 5912 | Train Loss: 1.8492570 Vali Loss: 1.2712225 Test Loss: 0.8749039
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 2.5298350
	speed: 0.9373s/iter; left time: 38697.3795s
	iters: 200, epoch: 4 | loss: 1.7860972
	speed: 0.0305s/iter; left time: 1257.2579s
	iters: 300, epoch: 4 | loss: 2.4158723
	speed: 0.0305s/iter; left time: 1254.5712s
	iters: 400, epoch: 4 | loss: 1.5666282
	speed: 0.0305s/iter; left time: 1250.2722s
	iters: 500, epoch: 4 | loss: 1.5635633
	speed: 0.0306s/iter; left time: 1252.3677s
	iters: 600, epoch: 4 | loss: 1.6183101
	speed: 0.0305s/iter; left time: 1245.4109s
	iters: 700, epoch: 4 | loss: 1.8550962
	speed: 0.0305s/iter; left time: 1242.6130s
	iters: 800, epoch: 4 | loss: 2.5351026
	speed: 0.0305s/iter; left time: 1238.4973s
	iters: 900, epoch: 4 | loss: 1.6237730
	speed: 0.0305s/iter; left time: 1236.5257s
	iters: 1000, epoch: 4 | loss: 1.9309725
	speed: 0.0308s/iter; left time: 1245.7423s
	iters: 1100, epoch: 4 | loss: 1.8748136
	speed: 0.0305s/iter; left time: 1229.4122s
	iters: 1200, epoch: 4 | loss: 1.6841588
	speed: 0.0306s/iter; left time: 1227.8210s
	iters: 1300, epoch: 4 | loss: 1.6740695
	speed: 0.0306s/iter; left time: 1225.1045s
	iters: 1400, epoch: 4 | loss: 1.8771331
	speed: 0.0306s/iter; left time: 1221.5709s
	iters: 1500, epoch: 4 | loss: 1.8093475
	speed: 0.0305s/iter; left time: 1218.3188s
	iters: 1600, epoch: 4 | loss: 1.8167208
	speed: 0.0305s/iter; left time: 1214.0843s
	iters: 1700, epoch: 4 | loss: 1.7760497
	speed: 0.0306s/iter; left time: 1215.5120s
	iters: 1800, epoch: 4 | loss: 1.4972851
	speed: 0.0309s/iter; left time: 1223.2813s
	iters: 1900, epoch: 4 | loss: 1.7304813
	speed: 0.0306s/iter; left time: 1207.1568s
	iters: 2000, epoch: 4 | loss: 1.7675449
	speed: 0.0303s/iter; left time: 1192.5901s
	iters: 2100, epoch: 4 | loss: 1.7554026
	speed: 0.0304s/iter; left time: 1193.1239s
	iters: 2200, epoch: 4 | loss: 1.9584824
	speed: 0.0304s/iter; left time: 1190.8137s
	iters: 2300, epoch: 4 | loss: 1.9925504
	speed: 0.0304s/iter; left time: 1187.6029s
	iters: 2400, epoch: 4 | loss: 1.8527796
	speed: 0.0305s/iter; left time: 1189.6205s
	iters: 2500, epoch: 4 | loss: 2.0783577
	speed: 0.0304s/iter; left time: 1182.4839s
	iters: 2600, epoch: 4 | loss: 2.5495675
	speed: 0.0302s/iter; left time: 1171.4602s
	iters: 2700, epoch: 4 | loss: 1.7745601
	speed: 0.0304s/iter; left time: 1174.7652s
	iters: 2800, epoch: 4 | loss: 2.1117263
	speed: 0.0296s/iter; left time: 1140.3834s
	iters: 2900, epoch: 4 | loss: 1.4843464
	speed: 0.0262s/iter; left time: 1007.9288s
	iters: 3000, epoch: 4 | loss: 2.0958595
	speed: 0.0283s/iter; left time: 1084.7297s
	iters: 3100, epoch: 4 | loss: 1.8148310
	speed: 0.0298s/iter; left time: 1140.3954s
	iters: 3200, epoch: 4 | loss: 2.0022707
	speed: 0.0299s/iter; left time: 1141.5502s
	iters: 3300, epoch: 4 | loss: 1.5220695
	speed: 0.0293s/iter; left time: 1114.3595s
	iters: 3400, epoch: 4 | loss: 2.0640020
	speed: 0.0300s/iter; left time: 1140.1614s
	iters: 3500, epoch: 4 | loss: 2.2522044
	speed: 0.0301s/iter; left time: 1140.1004s
	iters: 3600, epoch: 4 | loss: 2.1065593
	speed: 0.0303s/iter; left time: 1145.6662s
	iters: 3700, epoch: 4 | loss: 2.1344972
	speed: 0.0304s/iter; left time: 1145.5835s
	iters: 3800, epoch: 4 | loss: 1.6428636
	speed: 0.0305s/iter; left time: 1144.9048s
	iters: 3900, epoch: 4 | loss: 2.2668533
	speed: 0.0298s/iter; left time: 1116.6249s
	iters: 4000, epoch: 4 | loss: 1.8030020
	speed: 0.0299s/iter; left time: 1117.6561s
	iters: 4100, epoch: 4 | loss: 1.9919031
	speed: 0.0301s/iter; left time: 1123.8029s
	iters: 4200, epoch: 4 | loss: 2.2793295
	speed: 0.0300s/iter; left time: 1115.8801s
	iters: 4300, epoch: 4 | loss: 1.5820973
	speed: 0.0294s/iter; left time: 1089.5660s
	iters: 4400, epoch: 4 | loss: 2.0133607
	speed: 0.0299s/iter; left time: 1104.9089s
	iters: 4500, epoch: 4 | loss: 2.5059805
	speed: 0.0300s/iter; left time: 1107.1221s
	iters: 4600, epoch: 4 | loss: 2.1059203
	speed: 0.0303s/iter; left time: 1116.1558s
	iters: 4700, epoch: 4 | loss: 2.3694646
	speed: 0.0303s/iter; left time: 1110.4573s
	iters: 4800, epoch: 4 | loss: 1.6764586
	speed: 0.0303s/iter; left time: 1107.2213s
	iters: 4900, epoch: 4 | loss: 1.7834717
	speed: 0.0304s/iter; left time: 1108.9923s
	iters: 5000, epoch: 4 | loss: 1.7848755
	speed: 0.0302s/iter; left time: 1097.4776s
	iters: 5100, epoch: 4 | loss: 1.7094245
	speed: 0.0300s/iter; left time: 1089.8165s
	iters: 5200, epoch: 4 | loss: 2.0198112
	speed: 0.0303s/iter; left time: 1094.7521s
	iters: 5300, epoch: 4 | loss: 1.7936330
	speed: 0.0288s/iter; left time: 1038.7532s
	iters: 5400, epoch: 4 | loss: 1.3498319
	speed: 0.0299s/iter; left time: 1076.6526s
	iters: 5500, epoch: 4 | loss: 2.2658598
	speed: 0.0297s/iter; left time: 1065.7297s
	iters: 5600, epoch: 4 | loss: 2.0357702
	speed: 0.0305s/iter; left time: 1089.7689s
	iters: 5700, epoch: 4 | loss: 1.8776429
	speed: 0.0302s/iter; left time: 1076.9817s
	iters: 5800, epoch: 4 | loss: 1.5101973
	speed: 0.0298s/iter; left time: 1061.2356s
	iters: 5900, epoch: 4 | loss: 2.0534756
	speed: 0.0300s/iter; left time: 1065.1673s
Epoch: 4 cost time: 178.36216187477112
Epoch: 4, Steps: 5912 | Train Loss: 1.8490880 Vali Loss: 1.2728995 Test Loss: 0.8756763
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 195154
test shape: (19515, 1, 96, 130) (19515, 1, 96, 130)
test shape: (19515, 96, 130) (19515, 96, 130)
mse:0.8750178813934326, mae:0.6919171810150146
>>>>>>>Overall time: 1254 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
