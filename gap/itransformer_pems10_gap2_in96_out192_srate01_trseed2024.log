Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 844455
val 141231
test 141229
	iters: 100, epoch: 1 | loss: 1.4204992
	speed: 0.0320s/iter; left time: 1687.9686s
	iters: 200, epoch: 1 | loss: 1.5240854
	speed: 0.0297s/iter; left time: 1558.8107s
	iters: 300, epoch: 1 | loss: 1.6311486
	speed: 0.0304s/iter; left time: 1594.2953s
	iters: 400, epoch: 1 | loss: 1.5338649
	speed: 0.0291s/iter; left time: 1524.7447s
	iters: 500, epoch: 1 | loss: 1.6666626
	speed: 0.0287s/iter; left time: 1498.6192s
	iters: 600, epoch: 1 | loss: 1.4728711
	speed: 0.0300s/iter; left time: 1565.8067s
	iters: 700, epoch: 1 | loss: 2.0213616
	speed: 0.0294s/iter; left time: 1532.3741s
	iters: 800, epoch: 1 | loss: 1.6170694
	speed: 0.0300s/iter; left time: 1560.0557s
	iters: 900, epoch: 1 | loss: 1.8966801
	speed: 0.0299s/iter; left time: 1553.3634s
	iters: 1000, epoch: 1 | loss: 1.5227619
	speed: 0.0298s/iter; left time: 1541.9888s
	iters: 1100, epoch: 1 | loss: 1.4438833
	speed: 0.0294s/iter; left time: 1518.7459s
	iters: 1200, epoch: 1 | loss: 1.7967904
	speed: 0.0302s/iter; left time: 1557.8392s
	iters: 1300, epoch: 1 | loss: 1.7873685
	speed: 0.0295s/iter; left time: 1519.8672s
	iters: 1400, epoch: 1 | loss: 1.8575321
	speed: 0.0298s/iter; left time: 1529.2979s
	iters: 1500, epoch: 1 | loss: 1.7127386
	speed: 0.0301s/iter; left time: 1545.3278s
	iters: 1600, epoch: 1 | loss: 1.3807859
	speed: 0.0296s/iter; left time: 1517.0499s
	iters: 1700, epoch: 1 | loss: 1.4502319
	speed: 0.0302s/iter; left time: 1540.5887s
	iters: 1800, epoch: 1 | loss: 1.4495623
	speed: 0.0300s/iter; left time: 1527.2164s
	iters: 1900, epoch: 1 | loss: 1.8345000
	speed: 0.0299s/iter; left time: 1519.3049s
	iters: 2000, epoch: 1 | loss: 1.5770905
	speed: 0.0299s/iter; left time: 1515.9404s
	iters: 2100, epoch: 1 | loss: 1.6250783
	speed: 0.0304s/iter; left time: 1537.8857s
	iters: 2200, epoch: 1 | loss: 1.6294612
	speed: 0.0303s/iter; left time: 1533.6645s
	iters: 2300, epoch: 1 | loss: 1.4735379
	speed: 0.0298s/iter; left time: 1505.0866s
	iters: 2400, epoch: 1 | loss: 1.5350227
	speed: 0.0304s/iter; left time: 1530.6104s
	iters: 2500, epoch: 1 | loss: 1.5234334
	speed: 0.0301s/iter; left time: 1514.2828s
	iters: 2600, epoch: 1 | loss: 1.5349617
	speed: 0.0303s/iter; left time: 1517.7614s
	iters: 2700, epoch: 1 | loss: 1.6212502
	speed: 0.0301s/iter; left time: 1509.1331s
	iters: 2800, epoch: 1 | loss: 1.6309751
	speed: 0.0302s/iter; left time: 1506.8560s
	iters: 2900, epoch: 1 | loss: 1.9976510
	speed: 0.0303s/iter; left time: 1513.5427s
	iters: 3000, epoch: 1 | loss: 1.4891633
	speed: 0.0299s/iter; left time: 1488.4672s
	iters: 3100, epoch: 1 | loss: 1.5629131
	speed: 0.0302s/iter; left time: 1499.1839s
	iters: 3200, epoch: 1 | loss: 1.7258878
	speed: 0.0303s/iter; left time: 1501.1414s
	iters: 3300, epoch: 1 | loss: 1.4537138
	speed: 0.0299s/iter; left time: 1479.8554s
	iters: 3400, epoch: 1 | loss: 1.6484581
	speed: 0.0303s/iter; left time: 1494.9232s
	iters: 3500, epoch: 1 | loss: 1.6143717
	speed: 0.0296s/iter; left time: 1458.2501s
	iters: 3600, epoch: 1 | loss: 1.9383508
	speed: 0.0300s/iter; left time: 1474.3095s
	iters: 3700, epoch: 1 | loss: 1.6140113
	speed: 0.0301s/iter; left time: 1475.7502s
	iters: 3800, epoch: 1 | loss: 1.5626415
	speed: 0.0294s/iter; left time: 1437.5099s
	iters: 3900, epoch: 1 | loss: 1.8089306
	speed: 0.0298s/iter; left time: 1455.6849s
	iters: 4000, epoch: 1 | loss: 1.5855209
	speed: 0.0303s/iter; left time: 1477.7719s
	iters: 4100, epoch: 1 | loss: 1.6927096
	speed: 0.0303s/iter; left time: 1475.7483s
	iters: 4200, epoch: 1 | loss: 1.4620693
	speed: 0.0301s/iter; left time: 1460.7038s
	iters: 4300, epoch: 1 | loss: 1.7775676
	speed: 0.0303s/iter; left time: 1469.2645s
	iters: 4400, epoch: 1 | loss: 1.5888939
	speed: 0.0294s/iter; left time: 1421.1378s
	iters: 4500, epoch: 1 | loss: 1.4683900
	speed: 0.0288s/iter; left time: 1389.6590s
	iters: 4600, epoch: 1 | loss: 1.5968773
	speed: 0.0297s/iter; left time: 1432.8743s
	iters: 4700, epoch: 1 | loss: 1.6643873
	speed: 0.0293s/iter; left time: 1409.8408s
	iters: 4800, epoch: 1 | loss: 1.7909714
	speed: 0.0304s/iter; left time: 1457.1418s
	iters: 4900, epoch: 1 | loss: 1.6049039
	speed: 0.0301s/iter; left time: 1442.6173s
	iters: 5000, epoch: 1 | loss: 1.7582814
	speed: 0.0298s/iter; left time: 1421.4038s
	iters: 5100, epoch: 1 | loss: 1.4804999
	speed: 0.0294s/iter; left time: 1399.2142s
	iters: 5200, epoch: 1 | loss: 1.8720288
	speed: 0.0296s/iter; left time: 1409.8612s
Epoch: 1 cost time: 158.01781463623047
Epoch: 1, Steps: 5277 | Train Loss: 1.6589754 Vali Loss: 2.3224008 Test Loss: 1.9476688
Validation loss decreased (inf --> 2.322401).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6805094
	speed: 0.6843s/iter; left time: 32431.0995s
	iters: 200, epoch: 2 | loss: 1.8856895
	speed: 0.0293s/iter; left time: 1386.9612s
	iters: 300, epoch: 2 | loss: 1.6840492
	speed: 0.0296s/iter; left time: 1395.0521s
	iters: 400, epoch: 2 | loss: 1.4720044
	speed: 0.0299s/iter; left time: 1409.7489s
	iters: 500, epoch: 2 | loss: 1.4962257
	speed: 0.0300s/iter; left time: 1411.7037s
	iters: 600, epoch: 2 | loss: 1.6569126
	speed: 0.0296s/iter; left time: 1390.3031s
	iters: 700, epoch: 2 | loss: 1.8384686
	speed: 0.0293s/iter; left time: 1370.4231s
	iters: 800, epoch: 2 | loss: 1.3155861
	speed: 0.0292s/iter; left time: 1362.3181s
	iters: 900, epoch: 2 | loss: 1.4606328
	speed: 0.0302s/iter; left time: 1406.4133s
	iters: 1000, epoch: 2 | loss: 1.9845502
	speed: 0.0294s/iter; left time: 1368.3455s
	iters: 1100, epoch: 2 | loss: 1.2619406
	speed: 0.0301s/iter; left time: 1394.4846s
	iters: 1200, epoch: 2 | loss: 1.6228149
	speed: 0.0303s/iter; left time: 1400.9104s
	iters: 1300, epoch: 2 | loss: 1.6363027
	speed: 0.0299s/iter; left time: 1383.3533s
	iters: 1400, epoch: 2 | loss: 1.8360808
	speed: 0.0304s/iter; left time: 1399.0295s
	iters: 1500, epoch: 2 | loss: 1.7843351
	speed: 0.0297s/iter; left time: 1366.8256s
	iters: 1600, epoch: 2 | loss: 1.7264594
	speed: 0.0304s/iter; left time: 1393.9274s
	iters: 1700, epoch: 2 | loss: 1.6271958
	speed: 0.0304s/iter; left time: 1390.6310s
	iters: 1800, epoch: 2 | loss: 1.7616483
	speed: 0.0300s/iter; left time: 1369.6820s
	iters: 1900, epoch: 2 | loss: 1.7317723
	speed: 0.0299s/iter; left time: 1364.9930s
	iters: 2000, epoch: 2 | loss: 1.6361187
	speed: 0.0302s/iter; left time: 1372.8066s
	iters: 2100, epoch: 2 | loss: 1.9546800
	speed: 0.0289s/iter; left time: 1309.8653s
	iters: 2200, epoch: 2 | loss: 1.5502163
	speed: 0.0299s/iter; left time: 1353.3533s
	iters: 2300, epoch: 2 | loss: 1.6209055
	speed: 0.0303s/iter; left time: 1368.3596s
	iters: 2400, epoch: 2 | loss: 1.4811068
	speed: 0.0302s/iter; left time: 1361.1523s
	iters: 2500, epoch: 2 | loss: 1.7979323
	speed: 0.0303s/iter; left time: 1363.9511s
	iters: 2600, epoch: 2 | loss: 2.0836344
	speed: 0.0298s/iter; left time: 1337.6459s
	iters: 2700, epoch: 2 | loss: 1.7409304
	speed: 0.0304s/iter; left time: 1361.0477s
	iters: 2800, epoch: 2 | loss: 1.5220760
	speed: 0.0305s/iter; left time: 1361.2483s
	iters: 2900, epoch: 2 | loss: 1.6147244
	speed: 0.0300s/iter; left time: 1336.6620s
	iters: 3000, epoch: 2 | loss: 1.6854432
	speed: 0.0300s/iter; left time: 1336.9234s
	iters: 3100, epoch: 2 | loss: 1.8903954
	speed: 0.0303s/iter; left time: 1343.0421s
	iters: 3200, epoch: 2 | loss: 1.5693631
	speed: 0.0303s/iter; left time: 1344.1448s
	iters: 3300, epoch: 2 | loss: 1.6433020
	speed: 0.0302s/iter; left time: 1332.8530s
	iters: 3400, epoch: 2 | loss: 1.5767081
	speed: 0.0303s/iter; left time: 1337.7881s
	iters: 3500, epoch: 2 | loss: 1.8577884
	speed: 0.0303s/iter; left time: 1331.1740s
	iters: 3600, epoch: 2 | loss: 1.7481699
	speed: 0.0304s/iter; left time: 1333.0387s
	iters: 3700, epoch: 2 | loss: 1.5096695
	speed: 0.0298s/iter; left time: 1306.6609s
	iters: 3800, epoch: 2 | loss: 1.7679135
	speed: 0.0296s/iter; left time: 1293.5819s
	iters: 3900, epoch: 2 | loss: 1.5732362
	speed: 0.0302s/iter; left time: 1314.5755s
	iters: 4000, epoch: 2 | loss: 1.8145372
	speed: 0.0293s/iter; left time: 1273.0441s
	iters: 4100, epoch: 2 | loss: 1.9019777
	speed: 0.0300s/iter; left time: 1300.2979s
	iters: 4200, epoch: 2 | loss: 1.5256425
	speed: 0.0299s/iter; left time: 1295.5659s
	iters: 4300, epoch: 2 | loss: 1.6807657
	speed: 0.0295s/iter; left time: 1275.4451s
	iters: 4400, epoch: 2 | loss: 1.9514004
	speed: 0.0294s/iter; left time: 1266.7764s
	iters: 4500, epoch: 2 | loss: 1.6228067
	speed: 0.0304s/iter; left time: 1304.9525s
	iters: 4600, epoch: 2 | loss: 1.8695724
	speed: 0.0300s/iter; left time: 1287.3495s
	iters: 4700, epoch: 2 | loss: 1.4562973
	speed: 0.0300s/iter; left time: 1285.8273s
	iters: 4800, epoch: 2 | loss: 1.6106766
	speed: 0.0300s/iter; left time: 1281.3593s
	iters: 4900, epoch: 2 | loss: 1.7702225
	speed: 0.0299s/iter; left time: 1271.5549s
	iters: 5000, epoch: 2 | loss: 1.6648977
	speed: 0.0304s/iter; left time: 1289.7061s
	iters: 5100, epoch: 2 | loss: 1.3704742
	speed: 0.0303s/iter; left time: 1283.2061s
	iters: 5200, epoch: 2 | loss: 2.1472547
	speed: 0.0300s/iter; left time: 1269.5153s
Epoch: 2 cost time: 158.17617297172546
Epoch: 2, Steps: 5277 | Train Loss: 1.6640017 Vali Loss: 2.3232388 Test Loss: 1.9478271
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6736828
	speed: 0.6816s/iter; left time: 28708.0124s
	iters: 200, epoch: 3 | loss: 1.4469873
	speed: 0.0281s/iter; left time: 1181.2121s
	iters: 300, epoch: 3 | loss: 1.6985370
	speed: 0.0304s/iter; left time: 1272.9683s
	iters: 400, epoch: 3 | loss: 1.5739408
	speed: 0.0304s/iter; left time: 1269.3381s
	iters: 500, epoch: 3 | loss: 1.7410296
	speed: 0.0301s/iter; left time: 1254.1503s
	iters: 600, epoch: 3 | loss: 1.8273361
	speed: 0.0293s/iter; left time: 1221.1077s
	iters: 700, epoch: 3 | loss: 1.7099396
	speed: 0.0302s/iter; left time: 1254.6758s
	iters: 800, epoch: 3 | loss: 1.8980001
	speed: 0.0302s/iter; left time: 1249.3660s
	iters: 900, epoch: 3 | loss: 1.9681938
	speed: 0.0295s/iter; left time: 1219.4468s
	iters: 1000, epoch: 3 | loss: 1.7424381
	speed: 0.0301s/iter; left time: 1240.6772s
	iters: 1100, epoch: 3 | loss: 1.7098665
	speed: 0.0303s/iter; left time: 1245.2463s
	iters: 1200, epoch: 3 | loss: 1.6148229
	speed: 0.0300s/iter; left time: 1228.6745s
	iters: 1300, epoch: 3 | loss: 1.5556433
	speed: 0.0301s/iter; left time: 1233.3343s
	iters: 1400, epoch: 3 | loss: 1.8863384
	speed: 0.0298s/iter; left time: 1217.2456s
	iters: 1500, epoch: 3 | loss: 1.5766546
	speed: 0.0299s/iter; left time: 1218.6068s
	iters: 1600, epoch: 3 | loss: 1.7829654
	speed: 0.0296s/iter; left time: 1200.8091s
	iters: 1700, epoch: 3 | loss: 1.7553064
	speed: 0.0294s/iter; left time: 1192.4733s
	iters: 1800, epoch: 3 | loss: 1.7097607
	speed: 0.0288s/iter; left time: 1164.4938s
	iters: 1900, epoch: 3 | loss: 1.5808939
	speed: 0.0302s/iter; left time: 1218.7190s
	iters: 2000, epoch: 3 | loss: 1.7373704
	speed: 0.0304s/iter; left time: 1220.7914s
	iters: 2100, epoch: 3 | loss: 1.4187886
	speed: 0.0303s/iter; left time: 1213.6296s
	iters: 2200, epoch: 3 | loss: 1.6732444
	speed: 0.0303s/iter; left time: 1212.2164s
	iters: 2300, epoch: 3 | loss: 1.6134278
	speed: 0.0295s/iter; left time: 1178.4043s
	iters: 2400, epoch: 3 | loss: 1.8049240
	speed: 0.0301s/iter; left time: 1199.9515s
	iters: 2500, epoch: 3 | loss: 1.6391762
	speed: 0.0302s/iter; left time: 1198.1254s
	iters: 2600, epoch: 3 | loss: 1.7676631
	speed: 0.0296s/iter; left time: 1173.8810s
	iters: 2700, epoch: 3 | loss: 1.6319979
	speed: 0.0300s/iter; left time: 1185.6878s
	iters: 2800, epoch: 3 | loss: 1.8020676
	speed: 0.0291s/iter; left time: 1146.5092s
	iters: 2900, epoch: 3 | loss: 1.7379842
	speed: 0.0297s/iter; left time: 1167.0926s
	iters: 3000, epoch: 3 | loss: 1.7640605
	speed: 0.0304s/iter; left time: 1191.3847s
	iters: 3100, epoch: 3 | loss: 2.0059278
	speed: 0.0301s/iter; left time: 1177.0588s
	iters: 3200, epoch: 3 | loss: 1.7144775
	speed: 0.0303s/iter; left time: 1184.0598s
	iters: 3300, epoch: 3 | loss: 1.5065322
	speed: 0.0294s/iter; left time: 1146.0149s
	iters: 3400, epoch: 3 | loss: 1.6581563
	speed: 0.0303s/iter; left time: 1175.4794s
	iters: 3500, epoch: 3 | loss: 1.6739688
	speed: 0.0301s/iter; left time: 1166.6334s
	iters: 3600, epoch: 3 | loss: 1.8434145
	speed: 0.0300s/iter; left time: 1157.6883s
	iters: 3700, epoch: 3 | loss: 1.8119980
	speed: 0.0295s/iter; left time: 1135.1507s
	iters: 3800, epoch: 3 | loss: 1.7948942
	speed: 0.0294s/iter; left time: 1127.8058s
	iters: 3900, epoch: 3 | loss: 1.4991270
	speed: 0.0304s/iter; left time: 1163.2636s
	iters: 4000, epoch: 3 | loss: 1.6430393
	speed: 0.0297s/iter; left time: 1135.4359s
	iters: 4100, epoch: 3 | loss: 1.6448839
	speed: 0.0297s/iter; left time: 1131.9049s
	iters: 4200, epoch: 3 | loss: 1.7060202
	speed: 0.0300s/iter; left time: 1139.0538s
	iters: 4300, epoch: 3 | loss: 1.7413912
	speed: 0.0302s/iter; left time: 1145.5483s
	iters: 4400, epoch: 3 | loss: 1.7491314
	speed: 0.0303s/iter; left time: 1146.5914s
	iters: 4500, epoch: 3 | loss: 1.5531273
	speed: 0.0298s/iter; left time: 1125.2029s
	iters: 4600, epoch: 3 | loss: 1.6606616
	speed: 0.0302s/iter; left time: 1135.2789s
	iters: 4700, epoch: 3 | loss: 1.8086928
	speed: 0.0303s/iter; left time: 1135.0469s
	iters: 4800, epoch: 3 | loss: 1.4880675
	speed: 0.0298s/iter; left time: 1113.4160s
	iters: 4900, epoch: 3 | loss: 1.9943267
	speed: 0.0293s/iter; left time: 1094.5937s
	iters: 5000, epoch: 3 | loss: 1.4674844
	speed: 0.0296s/iter; left time: 1100.2150s
	iters: 5100, epoch: 3 | loss: 1.7286640
	speed: 0.0290s/iter; left time: 1075.3159s
	iters: 5200, epoch: 3 | loss: 1.4552853
	speed: 0.0303s/iter; left time: 1121.8770s
Epoch: 3 cost time: 157.70860195159912
Epoch: 3, Steps: 5277 | Train Loss: 1.6640216 Vali Loss: 2.3203785 Test Loss: 1.9469891
Validation loss decreased (2.322401 --> 2.320379).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6613860
	speed: 0.6837s/iter; left time: 25186.3652s
	iters: 200, epoch: 4 | loss: 1.5478185
	speed: 0.0298s/iter; left time: 1093.0949s
	iters: 300, epoch: 4 | loss: 1.7568270
	speed: 0.0296s/iter; left time: 1085.8133s
	iters: 400, epoch: 4 | loss: 1.5151842
	speed: 0.0296s/iter; left time: 1081.1620s
	iters: 500, epoch: 4 | loss: 1.8100951
	speed: 0.0303s/iter; left time: 1105.4253s
	iters: 600, epoch: 4 | loss: 1.4707253
	speed: 0.0289s/iter; left time: 1050.6286s
	iters: 700, epoch: 4 | loss: 1.7475816
	speed: 0.0296s/iter; left time: 1072.4121s
	iters: 800, epoch: 4 | loss: 1.9822047
	speed: 0.0297s/iter; left time: 1072.5629s
	iters: 900, epoch: 4 | loss: 1.8091717
	speed: 0.0301s/iter; left time: 1086.2495s
	iters: 1000, epoch: 4 | loss: 1.5470873
	speed: 0.0303s/iter; left time: 1088.6705s
	iters: 1100, epoch: 4 | loss: 1.6013418
	speed: 0.0302s/iter; left time: 1082.5204s
	iters: 1200, epoch: 4 | loss: 1.6720016
	speed: 0.0297s/iter; left time: 1060.8158s
	iters: 1300, epoch: 4 | loss: 1.9223007
	speed: 0.0299s/iter; left time: 1065.5035s
	iters: 1400, epoch: 4 | loss: 1.4812806
	speed: 0.0296s/iter; left time: 1053.3846s
	iters: 1500, epoch: 4 | loss: 1.9774127
	speed: 0.0302s/iter; left time: 1069.2419s
	iters: 1600, epoch: 4 | loss: 1.8062185
	speed: 0.0295s/iter; left time: 1044.1112s
	iters: 1700, epoch: 4 | loss: 1.9168564
	speed: 0.0304s/iter; left time: 1070.4860s
	iters: 1800, epoch: 4 | loss: 1.7676971
	speed: 0.0292s/iter; left time: 1025.0139s
	iters: 1900, epoch: 4 | loss: 1.4614168
	speed: 0.0299s/iter; left time: 1049.1449s
	iters: 2000, epoch: 4 | loss: 1.7264699
	speed: 0.0303s/iter; left time: 1057.5481s
	iters: 2100, epoch: 4 | loss: 1.7446935
	speed: 0.0295s/iter; left time: 1028.8919s
	iters: 2200, epoch: 4 | loss: 1.4840581
	speed: 0.0303s/iter; left time: 1051.5257s
	iters: 2300, epoch: 4 | loss: 1.6955317
	speed: 0.0300s/iter; left time: 1038.1515s
	iters: 2400, epoch: 4 | loss: 1.5462458
	speed: 0.0303s/iter; left time: 1048.1377s
	iters: 2500, epoch: 4 | loss: 1.5375984
	speed: 0.0303s/iter; left time: 1043.4829s
	iters: 2600, epoch: 4 | loss: 1.6394324
	speed: 0.0296s/iter; left time: 1016.8942s
	iters: 2700, epoch: 4 | loss: 1.6003946
	speed: 0.0303s/iter; left time: 1037.1658s
	iters: 2800, epoch: 4 | loss: 1.7254294
	speed: 0.0303s/iter; left time: 1033.9600s
	iters: 2900, epoch: 4 | loss: 1.6969838
	speed: 0.0300s/iter; left time: 1021.7716s
	iters: 3000, epoch: 4 | loss: 1.6348488
	speed: 0.0297s/iter; left time: 1007.7917s
	iters: 3100, epoch: 4 | loss: 1.8320407
	speed: 0.0303s/iter; left time: 1025.7602s
	iters: 3200, epoch: 4 | loss: 1.6137763
	speed: 0.0302s/iter; left time: 1018.5837s
	iters: 3300, epoch: 4 | loss: 1.5401878
	speed: 0.0304s/iter; left time: 1021.5916s
	iters: 3400, epoch: 4 | loss: 1.8073969
	speed: 0.0303s/iter; left time: 1015.5162s
	iters: 3500, epoch: 4 | loss: 1.8429700
	speed: 0.0302s/iter; left time: 1011.5083s
	iters: 3600, epoch: 4 | loss: 1.5113293
	speed: 0.0298s/iter; left time: 992.9300s
	iters: 3700, epoch: 4 | loss: 1.7082983
	speed: 0.0302s/iter; left time: 1002.9057s
	iters: 3800, epoch: 4 | loss: 1.7795037
	speed: 0.0298s/iter; left time: 986.1810s
	iters: 3900, epoch: 4 | loss: 1.4843007
	speed: 0.0299s/iter; left time: 989.4029s
	iters: 4000, epoch: 4 | loss: 1.4741927
	speed: 0.0303s/iter; left time: 996.6895s
	iters: 4100, epoch: 4 | loss: 1.7592745
	speed: 0.0297s/iter; left time: 976.1260s
	iters: 4200, epoch: 4 | loss: 1.5315346
	speed: 0.0301s/iter; left time: 985.4658s
	iters: 4300, epoch: 4 | loss: 1.6555816
	speed: 0.0301s/iter; left time: 981.0298s
	iters: 4400, epoch: 4 | loss: 1.3490010
	speed: 0.0293s/iter; left time: 954.8647s
	iters: 4500, epoch: 4 | loss: 1.8457128
	speed: 0.0302s/iter; left time: 979.3580s
	iters: 4600, epoch: 4 | loss: 1.7167778
	speed: 0.0299s/iter; left time: 968.2432s
	iters: 4700, epoch: 4 | loss: 1.3016613
	speed: 0.0304s/iter; left time: 979.4977s
	iters: 4800, epoch: 4 | loss: 1.8127384
	speed: 0.0303s/iter; left time: 973.3757s
	iters: 4900, epoch: 4 | loss: 1.7788087
	speed: 0.0303s/iter; left time: 971.8966s
	iters: 5000, epoch: 4 | loss: 1.8373920
	speed: 0.0293s/iter; left time: 934.7202s
	iters: 5100, epoch: 4 | loss: 1.5965724
	speed: 0.0303s/iter; left time: 964.3641s
	iters: 5200, epoch: 4 | loss: 1.5854102
	speed: 0.0299s/iter; left time: 948.9238s
Epoch: 4 cost time: 158.2556803226471
Epoch: 4, Steps: 5277 | Train Loss: 1.6636705 Vali Loss: 2.3317091 Test Loss: 1.9516543
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.4081130
	speed: 0.6835s/iter; left time: 21571.9962s
	iters: 200, epoch: 5 | loss: 1.6682997
	speed: 0.0296s/iter; left time: 931.4383s
	iters: 300, epoch: 5 | loss: 1.5865220
	speed: 0.0303s/iter; left time: 949.0237s
	iters: 400, epoch: 5 | loss: 1.6543343
	speed: 0.0299s/iter; left time: 935.1629s
	iters: 500, epoch: 5 | loss: 1.4639088
	speed: 0.0301s/iter; left time: 936.8278s
	iters: 600, epoch: 5 | loss: 1.8075083
	speed: 0.0300s/iter; left time: 932.6400s
	iters: 700, epoch: 5 | loss: 1.9963773
	speed: 0.0293s/iter; left time: 908.6857s
	iters: 800, epoch: 5 | loss: 1.5995327
	speed: 0.0297s/iter; left time: 917.9622s
	iters: 900, epoch: 5 | loss: 1.3747009
	speed: 0.0300s/iter; left time: 921.7800s
	iters: 1000, epoch: 5 | loss: 1.6708148
	speed: 0.0294s/iter; left time: 902.1240s
	iters: 1100, epoch: 5 | loss: 1.5950739
	speed: 0.0303s/iter; left time: 925.4332s
	iters: 1200, epoch: 5 | loss: 1.7560860
	speed: 0.0295s/iter; left time: 900.1488s
	iters: 1300, epoch: 5 | loss: 1.7812555
	speed: 0.0292s/iter; left time: 887.3564s
	iters: 1400, epoch: 5 | loss: 1.2544223
	speed: 0.0298s/iter; left time: 902.4757s
	iters: 1500, epoch: 5 | loss: 1.4003873
	speed: 0.0298s/iter; left time: 900.2683s
	iters: 1600, epoch: 5 | loss: 1.4548969
	speed: 0.0295s/iter; left time: 888.1987s
	iters: 1700, epoch: 5 | loss: 1.4891372
	speed: 0.0299s/iter; left time: 895.2304s
	iters: 1800, epoch: 5 | loss: 1.5820448
	speed: 0.0300s/iter; left time: 894.6168s
	iters: 1900, epoch: 5 | loss: 1.3333676
	speed: 0.0300s/iter; left time: 892.9093s
	iters: 2000, epoch: 5 | loss: 1.7161489
	speed: 0.0299s/iter; left time: 886.8831s
	iters: 2100, epoch: 5 | loss: 1.5149742
	speed: 0.0304s/iter; left time: 898.4841s
	iters: 2200, epoch: 5 | loss: 1.5697625
	speed: 0.0298s/iter; left time: 876.5716s
	iters: 2300, epoch: 5 | loss: 1.5571407
	speed: 0.0292s/iter; left time: 857.4015s
	iters: 2400, epoch: 5 | loss: 1.4871312
	speed: 0.0296s/iter; left time: 865.8795s
	iters: 2500, epoch: 5 | loss: 1.3577130
	speed: 0.0302s/iter; left time: 881.9780s
	iters: 2600, epoch: 5 | loss: 1.5277323
	speed: 0.0288s/iter; left time: 836.2948s
	iters: 2700, epoch: 5 | loss: 1.6088912
	speed: 0.0302s/iter; left time: 875.5409s
	iters: 2800, epoch: 5 | loss: 1.1954219
	speed: 0.0294s/iter; left time: 848.3837s
	iters: 2900, epoch: 5 | loss: 1.6429812
	speed: 0.0302s/iter; left time: 868.4129s
	iters: 3000, epoch: 5 | loss: 1.5266585
	speed: 0.0301s/iter; left time: 862.6740s
	iters: 3100, epoch: 5 | loss: 1.3626888
	speed: 0.0302s/iter; left time: 861.8883s
	iters: 3200, epoch: 5 | loss: 1.5653318
	speed: 0.0304s/iter; left time: 864.3475s
	iters: 3300, epoch: 5 | loss: 1.1575050
	speed: 0.0304s/iter; left time: 862.5885s
	iters: 3400, epoch: 5 | loss: 1.5444442
	speed: 0.0296s/iter; left time: 835.5869s
	iters: 3500, epoch: 5 | loss: 1.4825897
	speed: 0.0303s/iter; left time: 852.7536s
	iters: 3600, epoch: 5 | loss: 1.1939386
	speed: 0.0298s/iter; left time: 837.4159s
	iters: 3700, epoch: 5 | loss: 1.5238560
	speed: 0.0302s/iter; left time: 844.3374s
	iters: 3800, epoch: 5 | loss: 1.4376948
	speed: 0.0303s/iter; left time: 843.7683s
	iters: 3900, epoch: 5 | loss: 1.3832654
	speed: 0.0300s/iter; left time: 831.7951s
	iters: 4000, epoch: 5 | loss: 1.5035297
	speed: 0.0304s/iter; left time: 840.4035s
	iters: 4100, epoch: 5 | loss: 1.5031428
	speed: 0.0304s/iter; left time: 838.1422s
	iters: 4200, epoch: 5 | loss: 1.3117492
	speed: 0.0304s/iter; left time: 833.8502s
	iters: 4300, epoch: 5 | loss: 1.5136379
	speed: 0.0304s/iter; left time: 830.8421s
	iters: 4400, epoch: 5 | loss: 1.7224905
	speed: 0.0304s/iter; left time: 827.8256s
	iters: 4500, epoch: 5 | loss: 1.3081515
	speed: 0.0298s/iter; left time: 808.3049s
	iters: 4600, epoch: 5 | loss: 1.1881247
	speed: 0.0301s/iter; left time: 813.7269s
	iters: 4700, epoch: 5 | loss: 1.6002729
	speed: 0.0295s/iter; left time: 795.6898s
	iters: 4800, epoch: 5 | loss: 1.5412542
	speed: 0.0300s/iter; left time: 805.4334s
	iters: 4900, epoch: 5 | loss: 1.4955740
	speed: 0.0292s/iter; left time: 782.2905s
	iters: 5000, epoch: 5 | loss: 1.4491957
	speed: 0.0299s/iter; left time: 796.7127s
	iters: 5100, epoch: 5 | loss: 1.6263458
	speed: 0.0294s/iter; left time: 780.4256s
	iters: 5200, epoch: 5 | loss: 1.7941023
	speed: 0.0303s/iter; left time: 800.5134s
Epoch: 5 cost time: 157.92472529411316
Epoch: 5, Steps: 5277 | Train Loss: 1.5312140 Vali Loss: 2.3796647 Test Loss: 1.8390718
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.6352186
	speed: 0.6838s/iter; left time: 17975.0945s
	iters: 200, epoch: 6 | loss: 1.5414015
	speed: 0.0304s/iter; left time: 797.2722s
	iters: 300, epoch: 6 | loss: 1.5166024
	speed: 0.0304s/iter; left time: 794.1209s
	iters: 400, epoch: 6 | loss: 1.4133780
	speed: 0.0301s/iter; left time: 781.5818s
	iters: 500, epoch: 6 | loss: 1.5083529
	speed: 0.0296s/iter; left time: 765.4544s
	iters: 600, epoch: 6 | loss: 1.2748640
	speed: 0.0298s/iter; left time: 767.9295s
	iters: 700, epoch: 6 | loss: 1.6121031
	speed: 0.0303s/iter; left time: 777.6243s
	iters: 800, epoch: 6 | loss: 1.4782212
	speed: 0.0295s/iter; left time: 753.7208s
	iters: 900, epoch: 6 | loss: 1.7675891
	speed: 0.0303s/iter; left time: 771.5219s
	iters: 1000, epoch: 6 | loss: 1.4345099
	speed: 0.0304s/iter; left time: 771.0075s
	iters: 1100, epoch: 6 | loss: 1.2869939
	speed: 0.0295s/iter; left time: 746.8218s
	iters: 1200, epoch: 6 | loss: 1.6229012
	speed: 0.0304s/iter; left time: 765.3800s
	iters: 1300, epoch: 6 | loss: 1.4487089
	speed: 0.0294s/iter; left time: 738.2044s
	iters: 1400, epoch: 6 | loss: 1.5779316
	speed: 0.0294s/iter; left time: 733.8366s
	iters: 1500, epoch: 6 | loss: 1.4898891
	speed: 0.0299s/iter; left time: 743.6178s
	iters: 1600, epoch: 6 | loss: 1.7153084
	speed: 0.0294s/iter; left time: 727.9967s
	iters: 1700, epoch: 6 | loss: 1.6085414
	speed: 0.0302s/iter; left time: 746.3056s
	iters: 1800, epoch: 6 | loss: 1.4579890
	speed: 0.0291s/iter; left time: 716.6267s
	iters: 1900, epoch: 6 | loss: 1.5361121
	speed: 0.0304s/iter; left time: 744.0243s
	iters: 2000, epoch: 6 | loss: 1.5357270
	speed: 0.0299s/iter; left time: 729.0373s
	iters: 2100, epoch: 6 | loss: 1.7428011
	speed: 0.0300s/iter; left time: 727.5321s
	iters: 2200, epoch: 6 | loss: 1.2340312
	speed: 0.0292s/iter; left time: 706.2013s
	iters: 2300, epoch: 6 | loss: 1.2764651
	speed: 0.0300s/iter; left time: 722.3841s
	iters: 2400, epoch: 6 | loss: 1.5766561
	speed: 0.0302s/iter; left time: 725.5399s
	iters: 2500, epoch: 6 | loss: 1.6013418
	speed: 0.0304s/iter; left time: 725.9694s
	iters: 2600, epoch: 6 | loss: 1.4272420
	speed: 0.0299s/iter; left time: 710.4280s
	iters: 2700, epoch: 6 | loss: 1.6331782
	speed: 0.0300s/iter; left time: 710.3165s
	iters: 2800, epoch: 6 | loss: 1.4173944
	speed: 0.0301s/iter; left time: 708.7828s
	iters: 2900, epoch: 6 | loss: 1.4572595
	speed: 0.0303s/iter; left time: 710.9425s
	iters: 3000, epoch: 6 | loss: 1.5693280
	speed: 0.0298s/iter; left time: 696.4868s
	iters: 3100, epoch: 6 | loss: 1.4020780
	speed: 0.0302s/iter; left time: 702.7819s
	iters: 3200, epoch: 6 | loss: 1.5072106
	speed: 0.0304s/iter; left time: 703.9432s
	iters: 3300, epoch: 6 | loss: 1.4484766
	speed: 0.0300s/iter; left time: 693.2703s
	iters: 3400, epoch: 6 | loss: 1.4213544
	speed: 0.0298s/iter; left time: 684.9088s
	iters: 3500, epoch: 6 | loss: 1.5701139
	speed: 0.0304s/iter; left time: 695.8867s
	iters: 3600, epoch: 6 | loss: 1.4482789
	speed: 0.0300s/iter; left time: 684.5277s
	iters: 3700, epoch: 6 | loss: 1.5877670
	speed: 0.0304s/iter; left time: 689.8882s
	iters: 3800, epoch: 6 | loss: 1.7009573
	speed: 0.0301s/iter; left time: 679.3497s
	iters: 3900, epoch: 6 | loss: 1.3898374
	speed: 0.0290s/iter; left time: 652.7702s
	iters: 4000, epoch: 6 | loss: 1.5936841
	speed: 0.0302s/iter; left time: 676.0433s
	iters: 4100, epoch: 6 | loss: 1.6269689
	speed: 0.0300s/iter; left time: 668.0860s
	iters: 4200, epoch: 6 | loss: 1.6153514
	speed: 0.0299s/iter; left time: 662.5584s
	iters: 4300, epoch: 6 | loss: 1.1461325
	speed: 0.0295s/iter; left time: 650.7217s
	iters: 4400, epoch: 6 | loss: 1.1667312
	speed: 0.0294s/iter; left time: 647.2178s
	iters: 4500, epoch: 6 | loss: 1.4098632
	speed: 0.0304s/iter; left time: 664.3902s
	iters: 4600, epoch: 6 | loss: 1.4403749
	speed: 0.0304s/iter; left time: 662.0166s
	iters: 4700, epoch: 6 | loss: 1.6085011
	speed: 0.0300s/iter; left time: 651.2182s
	iters: 4800, epoch: 6 | loss: 1.5499574
	speed: 0.0301s/iter; left time: 649.5096s
	iters: 4900, epoch: 6 | loss: 1.6323934
	speed: 0.0304s/iter; left time: 652.2883s
	iters: 5000, epoch: 6 | loss: 1.6837252
	speed: 0.0293s/iter; left time: 626.7489s
	iters: 5100, epoch: 6 | loss: 1.7787648
	speed: 0.0296s/iter; left time: 629.8660s
	iters: 5200, epoch: 6 | loss: 1.6999944
	speed: 0.0290s/iter; left time: 614.7245s
Epoch: 6 cost time: 158.0461723804474
Epoch: 6, Steps: 5277 | Train Loss: 1.5595974 Vali Loss: 2.3738320 Test Loss: 1.8701422
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141229
test shape: (14122, 1, 192, 107) (14122, 1, 192, 107)
test shape: (14122, 192, 107) (14122, 192, 107)
mse:1.946996808052063, mae:1.083926796913147
>>>>>>>Overall time: 1456 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
