Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 896343
val 193119
test 193117
	iters: 100, epoch: 1 | loss: 1.2409009
	speed: 0.0330s/iter; left time: 1845.4151s
	iters: 200, epoch: 1 | loss: 2.0527773
	speed: 0.0304s/iter; left time: 1694.5733s
	iters: 300, epoch: 1 | loss: 1.7236565
	speed: 0.0304s/iter; left time: 1691.2207s
	iters: 400, epoch: 1 | loss: 1.7430446
	speed: 0.0303s/iter; left time: 1686.8166s
	iters: 500, epoch: 1 | loss: 1.7795099
	speed: 0.0304s/iter; left time: 1686.0108s
	iters: 600, epoch: 1 | loss: 1.9318022
	speed: 0.0303s/iter; left time: 1681.8264s
	iters: 700, epoch: 1 | loss: 1.5311381
	speed: 0.0303s/iter; left time: 1678.4096s
	iters: 800, epoch: 1 | loss: 1.5407076
	speed: 0.0304s/iter; left time: 1677.1199s
	iters: 900, epoch: 1 | loss: 1.6451491
	speed: 0.0304s/iter; left time: 1673.3860s
	iters: 1000, epoch: 1 | loss: 1.4079626
	speed: 0.0305s/iter; left time: 1678.7002s
	iters: 1100, epoch: 1 | loss: 1.5806739
	speed: 0.0303s/iter; left time: 1664.9149s
	iters: 1200, epoch: 1 | loss: 1.6375721
	speed: 0.0305s/iter; left time: 1672.9856s
	iters: 1300, epoch: 1 | loss: 1.5018449
	speed: 0.0303s/iter; left time: 1660.4504s
	iters: 1400, epoch: 1 | loss: 1.4073590
	speed: 0.0304s/iter; left time: 1660.0786s
	iters: 1500, epoch: 1 | loss: 1.6347150
	speed: 0.0304s/iter; left time: 1655.3378s
	iters: 1600, epoch: 1 | loss: 1.2278353
	speed: 0.0304s/iter; left time: 1654.1816s
	iters: 1700, epoch: 1 | loss: 1.5415896
	speed: 0.0304s/iter; left time: 1650.2960s
	iters: 1800, epoch: 1 | loss: 1.6033152
	speed: 0.0304s/iter; left time: 1647.9101s
	iters: 1900, epoch: 1 | loss: 1.4993377
	speed: 0.0304s/iter; left time: 1643.2158s
	iters: 2000, epoch: 1 | loss: 1.5886652
	speed: 0.0304s/iter; left time: 1640.4777s
	iters: 2100, epoch: 1 | loss: 1.5345963
	speed: 0.0304s/iter; left time: 1638.5636s
	iters: 2200, epoch: 1 | loss: 1.3590363
	speed: 0.0304s/iter; left time: 1634.9023s
	iters: 2300, epoch: 1 | loss: 1.7460142
	speed: 0.0304s/iter; left time: 1631.5093s
	iters: 2400, epoch: 1 | loss: 1.9137906
	speed: 0.0304s/iter; left time: 1629.8419s
	iters: 2500, epoch: 1 | loss: 1.6484909
	speed: 0.0304s/iter; left time: 1626.6103s
	iters: 2600, epoch: 1 | loss: 1.2686707
	speed: 0.0304s/iter; left time: 1623.3526s
	iters: 2700, epoch: 1 | loss: 1.5221257
	speed: 0.0304s/iter; left time: 1620.1335s
	iters: 2800, epoch: 1 | loss: 1.6930544
	speed: 0.0305s/iter; left time: 1621.5327s
	iters: 2900, epoch: 1 | loss: 1.5894212
	speed: 0.0304s/iter; left time: 1614.9789s
	iters: 3000, epoch: 1 | loss: 1.6530082
	speed: 0.0304s/iter; left time: 1611.1670s
	iters: 3100, epoch: 1 | loss: 1.7133495
	speed: 0.0304s/iter; left time: 1608.6105s
	iters: 3200, epoch: 1 | loss: 1.4853431
	speed: 0.0304s/iter; left time: 1603.7332s
	iters: 3300, epoch: 1 | loss: 1.3438257
	speed: 0.0304s/iter; left time: 1601.7388s
	iters: 3400, epoch: 1 | loss: 1.5390841
	speed: 0.0304s/iter; left time: 1600.4378s
	iters: 3500, epoch: 1 | loss: 1.8156631
	speed: 0.0304s/iter; left time: 1594.5308s
	iters: 3600, epoch: 1 | loss: 1.3883464
	speed: 0.0304s/iter; left time: 1593.6036s
	iters: 3700, epoch: 1 | loss: 1.5811026
	speed: 0.0304s/iter; left time: 1591.1082s
	iters: 3800, epoch: 1 | loss: 1.5959344
	speed: 0.0305s/iter; left time: 1590.8006s
	iters: 3900, epoch: 1 | loss: 1.5974462
	speed: 0.0304s/iter; left time: 1584.5688s
	iters: 4000, epoch: 1 | loss: 1.4795792
	speed: 0.0304s/iter; left time: 1581.4358s
	iters: 4100, epoch: 1 | loss: 1.7585053
	speed: 0.0303s/iter; left time: 1575.3616s
	iters: 4200, epoch: 1 | loss: 1.6342598
	speed: 0.0303s/iter; left time: 1572.7597s
	iters: 4300, epoch: 1 | loss: 1.5027264
	speed: 0.0304s/iter; left time: 1570.8960s
	iters: 4400, epoch: 1 | loss: 1.6845076
	speed: 0.0304s/iter; left time: 1566.9127s
	iters: 4500, epoch: 1 | loss: 1.5363473
	speed: 0.0304s/iter; left time: 1564.8249s
	iters: 4600, epoch: 1 | loss: 1.5455340
	speed: 0.0304s/iter; left time: 1560.8743s
	iters: 4700, epoch: 1 | loss: 1.4720993
	speed: 0.0304s/iter; left time: 1559.5700s
	iters: 4800, epoch: 1 | loss: 1.6233999
	speed: 0.0304s/iter; left time: 1554.8480s
	iters: 4900, epoch: 1 | loss: 1.3048035
	speed: 0.0303s/iter; left time: 1551.5064s
	iters: 5000, epoch: 1 | loss: 1.5768460
	speed: 0.0305s/iter; left time: 1554.5021s
	iters: 5100, epoch: 1 | loss: 1.6726751
	speed: 0.0305s/iter; left time: 1550.9988s
	iters: 5200, epoch: 1 | loss: 1.3664960
	speed: 0.0304s/iter; left time: 1543.5900s
	iters: 5300, epoch: 1 | loss: 1.5871801
	speed: 0.0304s/iter; left time: 1540.3430s
	iters: 5400, epoch: 1 | loss: 1.4211121
	speed: 0.0304s/iter; left time: 1537.4347s
	iters: 5500, epoch: 1 | loss: 1.3415939
	speed: 0.0303s/iter; left time: 1532.8079s
	iters: 5600, epoch: 1 | loss: 1.7157902
	speed: 0.0304s/iter; left time: 1532.4371s
Epoch: 1 cost time: 170.548184633255
Epoch: 1, Steps: 5602 | Train Loss: 1.5520657 Vali Loss: 2.3962860 Test Loss: 2.0362759
Validation loss decreased (inf --> 2.396286).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.3861464
	speed: 1.1074s/iter; left time: 55722.0087s
	iters: 200, epoch: 2 | loss: 1.3429308
	speed: 0.0304s/iter; left time: 1525.9556s
	iters: 300, epoch: 2 | loss: 1.5738214
	speed: 0.0305s/iter; left time: 1526.7984s
	iters: 400, epoch: 2 | loss: 1.5769850
	speed: 0.0304s/iter; left time: 1519.8774s
	iters: 500, epoch: 2 | loss: 1.6011525
	speed: 0.0304s/iter; left time: 1515.4290s
	iters: 600, epoch: 2 | loss: 1.5967093
	speed: 0.0304s/iter; left time: 1513.2708s
	iters: 700, epoch: 2 | loss: 1.4707453
	speed: 0.0304s/iter; left time: 1510.8622s
	iters: 800, epoch: 2 | loss: 1.8746431
	speed: 0.0304s/iter; left time: 1507.1682s
	iters: 900, epoch: 2 | loss: 1.7148064
	speed: 0.0304s/iter; left time: 1502.9603s
	iters: 1000, epoch: 2 | loss: 1.6576115
	speed: 0.0304s/iter; left time: 1500.8022s
	iters: 1100, epoch: 2 | loss: 1.6437964
	speed: 0.0304s/iter; left time: 1497.0582s
	iters: 1200, epoch: 2 | loss: 1.6589309
	speed: 0.0304s/iter; left time: 1496.2768s
	iters: 1300, epoch: 2 | loss: 1.6637416
	speed: 0.0303s/iter; left time: 1490.1936s
	iters: 1400, epoch: 2 | loss: 1.4794574
	speed: 0.0304s/iter; left time: 1488.2916s
	iters: 1500, epoch: 2 | loss: 1.7294798
	speed: 0.0304s/iter; left time: 1486.3566s
	iters: 1600, epoch: 2 | loss: 1.7384683
	speed: 0.0303s/iter; left time: 1481.0874s
	iters: 1700, epoch: 2 | loss: 1.7705153
	speed: 0.0303s/iter; left time: 1477.7515s
	iters: 1800, epoch: 2 | loss: 1.8874972
	speed: 0.0303s/iter; left time: 1475.3631s
	iters: 1900, epoch: 2 | loss: 1.6985420
	speed: 0.0303s/iter; left time: 1472.1121s
	iters: 2000, epoch: 2 | loss: 1.7703202
	speed: 0.0304s/iter; left time: 1470.9632s
	iters: 2100, epoch: 2 | loss: 1.5876000
	speed: 0.0303s/iter; left time: 1465.3932s
	iters: 2200, epoch: 2 | loss: 1.8345385
	speed: 0.0304s/iter; left time: 1464.5998s
	iters: 2300, epoch: 2 | loss: 1.6500061
	speed: 0.0304s/iter; left time: 1461.8827s
	iters: 2400, epoch: 2 | loss: 1.7257594
	speed: 0.0304s/iter; left time: 1458.8845s
	iters: 2500, epoch: 2 | loss: 1.8621688
	speed: 0.0304s/iter; left time: 1455.0071s
	iters: 2600, epoch: 2 | loss: 1.5552043
	speed: 0.0304s/iter; left time: 1451.4753s
	iters: 2700, epoch: 2 | loss: 1.6812754
	speed: 0.0304s/iter; left time: 1450.9557s
	iters: 2800, epoch: 2 | loss: 1.4163506
	speed: 0.0304s/iter; left time: 1445.6737s
	iters: 2900, epoch: 2 | loss: 1.7149194
	speed: 0.0304s/iter; left time: 1443.6507s
	iters: 3000, epoch: 2 | loss: 1.4621426
	speed: 0.0304s/iter; left time: 1440.0341s
	iters: 3100, epoch: 2 | loss: 1.5688888
	speed: 0.0304s/iter; left time: 1437.0748s
	iters: 3200, epoch: 2 | loss: 1.5336306
	speed: 0.0304s/iter; left time: 1434.1183s
	iters: 3300, epoch: 2 | loss: 1.5028241
	speed: 0.0304s/iter; left time: 1431.7150s
	iters: 3400, epoch: 2 | loss: 1.5451748
	speed: 0.0303s/iter; left time: 1426.8103s
	iters: 3500, epoch: 2 | loss: 1.6335187
	speed: 0.0304s/iter; left time: 1425.1283s
	iters: 3600, epoch: 2 | loss: 1.7885287
	speed: 0.0304s/iter; left time: 1421.9974s
	iters: 3700, epoch: 2 | loss: 1.7143189
	speed: 0.0306s/iter; left time: 1428.6535s
	iters: 3800, epoch: 2 | loss: 1.7440625
	speed: 0.0304s/iter; left time: 1415.7405s
	iters: 3900, epoch: 2 | loss: 1.6877784
	speed: 0.0304s/iter; left time: 1412.2710s
	iters: 4000, epoch: 2 | loss: 1.5467329
	speed: 0.0304s/iter; left time: 1410.1118s
	iters: 4100, epoch: 2 | loss: 1.6379383
	speed: 0.0304s/iter; left time: 1406.8379s
	iters: 4200, epoch: 2 | loss: 1.5581626
	speed: 0.0305s/iter; left time: 1409.4390s
	iters: 4300, epoch: 2 | loss: 1.7630931
	speed: 0.0304s/iter; left time: 1400.7915s
	iters: 4400, epoch: 2 | loss: 1.6944339
	speed: 0.0304s/iter; left time: 1397.9198s
	iters: 4500, epoch: 2 | loss: 1.8470273
	speed: 0.0304s/iter; left time: 1395.1525s
	iters: 4600, epoch: 2 | loss: 1.6208980
	speed: 0.0304s/iter; left time: 1392.1662s
	iters: 4700, epoch: 2 | loss: 1.6325027
	speed: 0.0304s/iter; left time: 1388.5570s
	iters: 4800, epoch: 2 | loss: 1.6878523
	speed: 0.0304s/iter; left time: 1387.4531s
	iters: 4900, epoch: 2 | loss: 2.0471163
	speed: 0.0304s/iter; left time: 1383.0278s
	iters: 5000, epoch: 2 | loss: 1.6174785
	speed: 0.0304s/iter; left time: 1380.7478s
	iters: 5100, epoch: 2 | loss: 1.5461015
	speed: 0.0304s/iter; left time: 1376.8703s
	iters: 5200, epoch: 2 | loss: 1.8445635
	speed: 0.0304s/iter; left time: 1373.0966s
	iters: 5300, epoch: 2 | loss: 1.7967322
	speed: 0.0304s/iter; left time: 1369.9605s
	iters: 5400, epoch: 2 | loss: 1.4672618
	speed: 0.0304s/iter; left time: 1366.8659s
	iters: 5500, epoch: 2 | loss: 1.8339592
	speed: 0.0304s/iter; left time: 1363.5286s
	iters: 5600, epoch: 2 | loss: 1.4610491
	speed: 0.0303s/iter; left time: 1359.9942s
Epoch: 2 cost time: 170.30593609809875
Epoch: 2, Steps: 5602 | Train Loss: 1.6221473 Vali Loss: 2.3725216 Test Loss: 1.9417241
Validation loss decreased (2.396286 --> 2.372522).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6690341
	speed: 1.1057s/iter; left time: 49445.3911s
	iters: 200, epoch: 3 | loss: 1.7833477
	speed: 0.0303s/iter; left time: 1354.0630s
	iters: 300, epoch: 3 | loss: 1.7338980
	speed: 0.0304s/iter; left time: 1352.4045s
	iters: 400, epoch: 3 | loss: 1.8423747
	speed: 0.0304s/iter; left time: 1350.4218s
	iters: 500, epoch: 3 | loss: 1.5332202
	speed: 0.0304s/iter; left time: 1345.3877s
	iters: 600, epoch: 3 | loss: 1.8043286
	speed: 0.0304s/iter; left time: 1343.1530s
	iters: 700, epoch: 3 | loss: 1.4592195
	speed: 0.0304s/iter; left time: 1340.3301s
	iters: 800, epoch: 3 | loss: 1.5322199
	speed: 0.0304s/iter; left time: 1337.7913s
	iters: 900, epoch: 3 | loss: 1.5590142
	speed: 0.0304s/iter; left time: 1334.0852s
	iters: 1000, epoch: 3 | loss: 1.4903843
	speed: 0.0304s/iter; left time: 1331.6991s
	iters: 1100, epoch: 3 | loss: 1.7324837
	speed: 0.0304s/iter; left time: 1328.1780s
	iters: 1200, epoch: 3 | loss: 1.5833364
	speed: 0.0304s/iter; left time: 1325.3665s
	iters: 1300, epoch: 3 | loss: 1.5329934
	speed: 0.0304s/iter; left time: 1322.1359s
	iters: 1400, epoch: 3 | loss: 1.7168225
	speed: 0.0304s/iter; left time: 1318.8380s
	iters: 1500, epoch: 3 | loss: 1.4215378
	speed: 0.0304s/iter; left time: 1316.7358s
	iters: 1600, epoch: 3 | loss: 1.6791407
	speed: 0.0304s/iter; left time: 1311.9327s
	iters: 1700, epoch: 3 | loss: 1.5657732
	speed: 0.0304s/iter; left time: 1309.5895s
	iters: 1800, epoch: 3 | loss: 1.6130754
	speed: 0.0304s/iter; left time: 1306.0602s
	iters: 1900, epoch: 3 | loss: 1.8775630
	speed: 0.0304s/iter; left time: 1304.1508s
	iters: 2000, epoch: 3 | loss: 1.6166229
	speed: 0.0304s/iter; left time: 1300.0175s
	iters: 2100, epoch: 3 | loss: 1.7118263
	speed: 0.0304s/iter; left time: 1297.3000s
	iters: 2200, epoch: 3 | loss: 1.7006867
	speed: 0.0304s/iter; left time: 1295.0234s
	iters: 2300, epoch: 3 | loss: 1.7828125
	speed: 0.0304s/iter; left time: 1291.2308s
	iters: 2400, epoch: 3 | loss: 1.6449466
	speed: 0.0304s/iter; left time: 1288.2989s
	iters: 2500, epoch: 3 | loss: 1.5304664
	speed: 0.0304s/iter; left time: 1285.2124s
	iters: 2600, epoch: 3 | loss: 1.6180000
	speed: 0.0303s/iter; left time: 1280.9387s
	iters: 2700, epoch: 3 | loss: 1.7638748
	speed: 0.0304s/iter; left time: 1279.1650s
	iters: 2800, epoch: 3 | loss: 1.6178230
	speed: 0.0303s/iter; left time: 1274.5330s
	iters: 2900, epoch: 3 | loss: 1.6658912
	speed: 0.0304s/iter; left time: 1272.6227s
	iters: 3000, epoch: 3 | loss: 1.8485444
	speed: 0.0303s/iter; left time: 1269.0665s
	iters: 3100, epoch: 3 | loss: 1.4986688
	speed: 0.0304s/iter; left time: 1267.0303s
	iters: 3200, epoch: 3 | loss: 1.6804649
	speed: 0.0304s/iter; left time: 1265.1899s
	iters: 3300, epoch: 3 | loss: 1.7583971
	speed: 0.0304s/iter; left time: 1261.3127s
	iters: 3400, epoch: 3 | loss: 1.6393217
	speed: 0.0304s/iter; left time: 1257.3059s
	iters: 3500, epoch: 3 | loss: 1.5201087
	speed: 0.0304s/iter; left time: 1254.3907s
	iters: 3600, epoch: 3 | loss: 1.6508712
	speed: 0.0304s/iter; left time: 1252.1424s
	iters: 3700, epoch: 3 | loss: 1.6266555
	speed: 0.0304s/iter; left time: 1249.6268s
	iters: 3800, epoch: 3 | loss: 1.6234499
	speed: 0.0304s/iter; left time: 1246.4111s
	iters: 3900, epoch: 3 | loss: 1.6632440
	speed: 0.0304s/iter; left time: 1242.7363s
	iters: 4000, epoch: 3 | loss: 1.5737480
	speed: 0.0304s/iter; left time: 1238.9279s
	iters: 4100, epoch: 3 | loss: 1.5584550
	speed: 0.0304s/iter; left time: 1236.7525s
	iters: 4200, epoch: 3 | loss: 1.6261183
	speed: 0.0304s/iter; left time: 1233.3015s
	iters: 4300, epoch: 3 | loss: 1.6868728
	speed: 0.0304s/iter; left time: 1231.9111s
	iters: 4400, epoch: 3 | loss: 1.4674792
	speed: 0.0304s/iter; left time: 1227.1864s
	iters: 4500, epoch: 3 | loss: 1.7927938
	speed: 0.0304s/iter; left time: 1224.8805s
	iters: 4600, epoch: 3 | loss: 1.7348955
	speed: 0.0304s/iter; left time: 1220.9952s
	iters: 4700, epoch: 3 | loss: 1.7225631
	speed: 0.0304s/iter; left time: 1218.5321s
	iters: 4800, epoch: 3 | loss: 1.5813035
	speed: 0.0304s/iter; left time: 1216.0975s
	iters: 4900, epoch: 3 | loss: 1.7829500
	speed: 0.0304s/iter; left time: 1212.7501s
	iters: 5000, epoch: 3 | loss: 1.5415269
	speed: 0.0304s/iter; left time: 1209.8435s
	iters: 5100, epoch: 3 | loss: 1.7753963
	speed: 0.0304s/iter; left time: 1205.8199s
	iters: 5200, epoch: 3 | loss: 1.6317387
	speed: 0.0304s/iter; left time: 1203.8593s
	iters: 5300, epoch: 3 | loss: 1.6980505
	speed: 0.0304s/iter; left time: 1201.5742s
	iters: 5400, epoch: 3 | loss: 1.7231262
	speed: 0.0304s/iter; left time: 1196.4320s
	iters: 5500, epoch: 3 | loss: 1.5456184
	speed: 0.0304s/iter; left time: 1194.2619s
	iters: 5600, epoch: 3 | loss: 1.6485821
	speed: 0.0304s/iter; left time: 1192.1649s
Epoch: 3 cost time: 170.28731632232666
Epoch: 3, Steps: 5602 | Train Loss: 1.6422974 Vali Loss: 2.3705511 Test Loss: 1.9393964
Validation loss decreased (2.372522 --> 2.370551).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.7757497
	speed: 1.1077s/iter; left time: 43327.2187s
	iters: 200, epoch: 4 | loss: 1.8522801
	speed: 0.0304s/iter; left time: 1184.2909s
	iters: 300, epoch: 4 | loss: 1.6461726
	speed: 0.0304s/iter; left time: 1181.2276s
	iters: 400, epoch: 4 | loss: 1.5976381
	speed: 0.0304s/iter; left time: 1179.5025s
	iters: 500, epoch: 4 | loss: 1.5642452
	speed: 0.0304s/iter; left time: 1176.9542s
	iters: 600, epoch: 4 | loss: 1.7069124
	speed: 0.0304s/iter; left time: 1172.0487s
	iters: 700, epoch: 4 | loss: 1.6187494
	speed: 0.0304s/iter; left time: 1169.6328s
	iters: 800, epoch: 4 | loss: 1.7505740
	speed: 0.0304s/iter; left time: 1165.9376s
	iters: 900, epoch: 4 | loss: 1.4919813
	speed: 0.0304s/iter; left time: 1163.6711s
	iters: 1000, epoch: 4 | loss: 1.6161823
	speed: 0.0304s/iter; left time: 1160.7139s
	iters: 1100, epoch: 4 | loss: 1.6354179
	speed: 0.0304s/iter; left time: 1157.1268s
	iters: 1200, epoch: 4 | loss: 1.5820726
	speed: 0.0304s/iter; left time: 1153.7826s
	iters: 1300, epoch: 4 | loss: 1.4996480
	speed: 0.0304s/iter; left time: 1150.9302s
	iters: 1400, epoch: 4 | loss: 1.7665870
	speed: 0.0304s/iter; left time: 1149.0780s
	iters: 1500, epoch: 4 | loss: 1.6375539
	speed: 0.0304s/iter; left time: 1145.2669s
	iters: 1600, epoch: 4 | loss: 1.5839199
	speed: 0.0304s/iter; left time: 1142.6868s
	iters: 1700, epoch: 4 | loss: 1.6335331
	speed: 0.0304s/iter; left time: 1139.5948s
	iters: 1800, epoch: 4 | loss: 1.5937519
	speed: 0.0304s/iter; left time: 1136.4341s
	iters: 1900, epoch: 4 | loss: 1.7536199
	speed: 0.0304s/iter; left time: 1132.7324s
	iters: 2000, epoch: 4 | loss: 2.0098140
	speed: 0.0304s/iter; left time: 1129.6771s
	iters: 2100, epoch: 4 | loss: 1.6578070
	speed: 0.0303s/iter; left time: 1126.1911s
	iters: 2200, epoch: 4 | loss: 1.7347316
	speed: 0.0304s/iter; left time: 1124.1272s
	iters: 2300, epoch: 4 | loss: 1.6716486
	speed: 0.0304s/iter; left time: 1121.3646s
	iters: 2400, epoch: 4 | loss: 1.7476770
	speed: 0.0303s/iter; left time: 1117.2559s
	iters: 2500, epoch: 4 | loss: 1.7070479
	speed: 0.0303s/iter; left time: 1113.9028s
	iters: 2600, epoch: 4 | loss: 1.4755607
	speed: 0.0304s/iter; left time: 1111.8379s
	iters: 2700, epoch: 4 | loss: 1.7086425
	speed: 0.0304s/iter; left time: 1108.7990s
	iters: 2800, epoch: 4 | loss: 1.6848563
	speed: 0.0304s/iter; left time: 1106.3946s
	iters: 2900, epoch: 4 | loss: 1.6146502
	speed: 0.0304s/iter; left time: 1103.6814s
	iters: 3000, epoch: 4 | loss: 1.8362559
	speed: 0.0304s/iter; left time: 1099.2734s
	iters: 3100, epoch: 4 | loss: 1.6826839
	speed: 0.0304s/iter; left time: 1097.2750s
	iters: 3200, epoch: 4 | loss: 1.7246900
	speed: 0.0304s/iter; left time: 1093.3537s
	iters: 3300, epoch: 4 | loss: 1.8101944
	speed: 0.0304s/iter; left time: 1090.1688s
	iters: 3400, epoch: 4 | loss: 1.8453966
	speed: 0.0304s/iter; left time: 1087.2931s
	iters: 3500, epoch: 4 | loss: 1.6946753
	speed: 0.0304s/iter; left time: 1084.6115s
	iters: 3600, epoch: 4 | loss: 1.6764820
	speed: 0.0304s/iter; left time: 1081.7063s
	iters: 3700, epoch: 4 | loss: 1.6326849
	speed: 0.0304s/iter; left time: 1078.6592s
	iters: 3800, epoch: 4 | loss: 1.3952866
	speed: 0.0305s/iter; left time: 1080.1302s
	iters: 3900, epoch: 4 | loss: 1.3695426
	speed: 0.0304s/iter; left time: 1072.8313s
	iters: 4000, epoch: 4 | loss: 1.8142883
	speed: 0.0304s/iter; left time: 1069.8003s
	iters: 4100, epoch: 4 | loss: 1.8220882
	speed: 0.0304s/iter; left time: 1067.5041s
	iters: 4200, epoch: 4 | loss: 1.5620320
	speed: 0.0304s/iter; left time: 1064.7240s
	iters: 4300, epoch: 4 | loss: 1.7330511
	speed: 0.0304s/iter; left time: 1059.9590s
	iters: 4400, epoch: 4 | loss: 1.7055792
	speed: 0.0304s/iter; left time: 1056.9856s
	iters: 4500, epoch: 4 | loss: 1.5863394
	speed: 0.0304s/iter; left time: 1054.6780s
	iters: 4600, epoch: 4 | loss: 1.5286596
	speed: 0.0304s/iter; left time: 1051.2973s
	iters: 4700, epoch: 4 | loss: 1.7199960
	speed: 0.0304s/iter; left time: 1047.8723s
	iters: 4800, epoch: 4 | loss: 1.5120780
	speed: 0.0304s/iter; left time: 1045.3005s
	iters: 4900, epoch: 4 | loss: 1.4356806
	speed: 0.0304s/iter; left time: 1042.3030s
	iters: 5000, epoch: 4 | loss: 1.5820016
	speed: 0.0304s/iter; left time: 1039.1229s
	iters: 5100, epoch: 4 | loss: 1.6720722
	speed: 0.0304s/iter; left time: 1035.8402s
	iters: 5200, epoch: 4 | loss: 1.7304074
	speed: 0.0304s/iter; left time: 1032.8321s
	iters: 5300, epoch: 4 | loss: 1.5028758
	speed: 0.0304s/iter; left time: 1030.6482s
	iters: 5400, epoch: 4 | loss: 1.6280929
	speed: 0.0304s/iter; left time: 1027.9875s
	iters: 5500, epoch: 4 | loss: 1.5511276
	speed: 0.0304s/iter; left time: 1023.5738s
	iters: 5600, epoch: 4 | loss: 1.5165356
	speed: 0.0304s/iter; left time: 1020.9394s
Epoch: 4 cost time: 170.26712322235107
Epoch: 4, Steps: 5602 | Train Loss: 1.6421259 Vali Loss: 2.3709502 Test Loss: 1.9392904
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.6597792
	speed: 1.1070s/iter; left time: 37100.4684s
	iters: 200, epoch: 5 | loss: 1.8841637
	speed: 0.0304s/iter; left time: 1015.0236s
	iters: 300, epoch: 5 | loss: 1.8321582
	speed: 0.0304s/iter; left time: 1012.0073s
	iters: 400, epoch: 5 | loss: 1.4582394
	speed: 0.0304s/iter; left time: 1009.1742s
	iters: 500, epoch: 5 | loss: 1.5555296
	speed: 0.0304s/iter; left time: 1006.9896s
	iters: 600, epoch: 5 | loss: 1.7402097
	speed: 0.0304s/iter; left time: 1003.9897s
	iters: 700, epoch: 5 | loss: 1.7894691
	speed: 0.0304s/iter; left time: 1000.0999s
	iters: 800, epoch: 5 | loss: 1.8012818
	speed: 0.0304s/iter; left time: 996.6097s
	iters: 900, epoch: 5 | loss: 1.6199750
	speed: 0.0304s/iter; left time: 993.7520s
	iters: 1000, epoch: 5 | loss: 1.5832025
	speed: 0.0304s/iter; left time: 992.0303s
	iters: 1100, epoch: 5 | loss: 1.6902944
	speed: 0.0306s/iter; left time: 994.3201s
	iters: 1200, epoch: 5 | loss: 1.6923033
	speed: 0.0304s/iter; left time: 984.9242s
	iters: 1300, epoch: 5 | loss: 1.6508359
	speed: 0.0304s/iter; left time: 981.7377s
	iters: 1400, epoch: 5 | loss: 1.6025871
	speed: 0.0304s/iter; left time: 979.4581s
	iters: 1500, epoch: 5 | loss: 1.7633219
	speed: 0.0304s/iter; left time: 975.6205s
	iters: 1600, epoch: 5 | loss: 1.6239632
	speed: 0.0304s/iter; left time: 972.7396s
	iters: 1700, epoch: 5 | loss: 1.6354480
	speed: 0.0304s/iter; left time: 968.9891s
	iters: 1800, epoch: 5 | loss: 1.5820876
	speed: 0.0304s/iter; left time: 966.4562s
	iters: 1900, epoch: 5 | loss: 1.7562618
	speed: 0.0304s/iter; left time: 962.9633s
	iters: 2000, epoch: 5 | loss: 1.5510780
	speed: 0.0304s/iter; left time: 960.6121s
	iters: 2100, epoch: 5 | loss: 1.4296036
	speed: 0.0304s/iter; left time: 957.8132s
	iters: 2200, epoch: 5 | loss: 1.7248242
	speed: 0.0306s/iter; left time: 960.0659s
	iters: 2300, epoch: 5 | loss: 1.4275006
	speed: 0.0304s/iter; left time: 951.6666s
	iters: 2400, epoch: 5 | loss: 1.6031331
	speed: 0.0304s/iter; left time: 947.7618s
	iters: 2500, epoch: 5 | loss: 1.7477074
	speed: 0.0304s/iter; left time: 945.2977s
	iters: 2600, epoch: 5 | loss: 1.7540520
	speed: 0.0304s/iter; left time: 943.1352s
	iters: 2700, epoch: 5 | loss: 1.7595190
	speed: 0.0303s/iter; left time: 938.1357s
	iters: 2800, epoch: 5 | loss: 1.4664682
	speed: 0.0304s/iter; left time: 936.7477s
	iters: 2900, epoch: 5 | loss: 1.7127498
	speed: 0.0304s/iter; left time: 933.4800s
	iters: 3000, epoch: 5 | loss: 1.7766129
	speed: 0.0304s/iter; left time: 930.1965s
	iters: 3100, epoch: 5 | loss: 1.6044072
	speed: 0.0304s/iter; left time: 927.3953s
	iters: 3200, epoch: 5 | loss: 1.5892349
	speed: 0.0304s/iter; left time: 924.2638s
	iters: 3300, epoch: 5 | loss: 1.7259409
	speed: 0.0307s/iter; left time: 930.9769s
	iters: 3400, epoch: 5 | loss: 1.6856791
	speed: 0.0304s/iter; left time: 918.9915s
	iters: 3500, epoch: 5 | loss: 1.5806779
	speed: 0.0304s/iter; left time: 915.2759s
	iters: 3600, epoch: 5 | loss: 1.5905838
	speed: 0.0304s/iter; left time: 912.5057s
	iters: 3700, epoch: 5 | loss: 1.8592920
	speed: 0.0304s/iter; left time: 908.8070s
	iters: 3800, epoch: 5 | loss: 1.6724076
	speed: 0.0304s/iter; left time: 906.7187s
	iters: 3900, epoch: 5 | loss: 1.6378330
	speed: 0.0304s/iter; left time: 902.6004s
	iters: 4000, epoch: 5 | loss: 1.6123232
	speed: 0.0304s/iter; left time: 899.3128s
	iters: 4100, epoch: 5 | loss: 1.7821476
	speed: 0.0304s/iter; left time: 897.6867s
	iters: 4200, epoch: 5 | loss: 1.5242862
	speed: 0.0304s/iter; left time: 893.4795s
	iters: 4300, epoch: 5 | loss: 1.6825612
	speed: 0.0304s/iter; left time: 889.9097s
	iters: 4400, epoch: 5 | loss: 1.7107193
	speed: 0.0304s/iter; left time: 888.0684s
	iters: 4500, epoch: 5 | loss: 1.6505340
	speed: 0.0304s/iter; left time: 884.4825s
	iters: 4600, epoch: 5 | loss: 1.5453498
	speed: 0.0304s/iter; left time: 880.8217s
	iters: 4700, epoch: 5 | loss: 1.7369914
	speed: 0.0304s/iter; left time: 879.0997s
	iters: 4800, epoch: 5 | loss: 1.8201860
	speed: 0.0304s/iter; left time: 875.8629s
	iters: 4900, epoch: 5 | loss: 1.7581224
	speed: 0.0304s/iter; left time: 872.8381s
	iters: 5000, epoch: 5 | loss: 1.5240289
	speed: 0.0304s/iter; left time: 870.0857s
	iters: 5100, epoch: 5 | loss: 1.6779937
	speed: 0.0304s/iter; left time: 866.7515s
	iters: 5200, epoch: 5 | loss: 1.6929647
	speed: 0.0304s/iter; left time: 864.3702s
	iters: 5300, epoch: 5 | loss: 1.6219764
	speed: 0.0305s/iter; left time: 863.8225s
	iters: 5400, epoch: 5 | loss: 1.6286051
	speed: 0.0304s/iter; left time: 857.1971s
	iters: 5500, epoch: 5 | loss: 1.5127711
	speed: 0.0304s/iter; left time: 853.7885s
	iters: 5600, epoch: 5 | loss: 1.5168473
	speed: 0.0304s/iter; left time: 852.0349s
Epoch: 5 cost time: 170.44484329223633
Epoch: 5, Steps: 5602 | Train Loss: 1.6420552 Vali Loss: 2.3726113 Test Loss: 1.9412806
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.5654134
	speed: 1.1047s/iter; left time: 30833.9923s
	iters: 200, epoch: 6 | loss: 1.6290853
	speed: 0.0304s/iter; left time: 844.9025s
	iters: 300, epoch: 6 | loss: 1.6649461
	speed: 0.0304s/iter; left time: 841.8821s
	iters: 400, epoch: 6 | loss: 1.5558871
	speed: 0.0306s/iter; left time: 844.9047s
	iters: 500, epoch: 6 | loss: 1.6550682
	speed: 0.0304s/iter; left time: 835.8389s
	iters: 600, epoch: 6 | loss: 1.6830229
	speed: 0.0304s/iter; left time: 832.5474s
	iters: 700, epoch: 6 | loss: 1.6153421
	speed: 0.0304s/iter; left time: 829.3804s
	iters: 800, epoch: 6 | loss: 1.6104788
	speed: 0.0304s/iter; left time: 826.3613s
	iters: 900, epoch: 6 | loss: 1.5919154
	speed: 0.0304s/iter; left time: 823.5440s
	iters: 1000, epoch: 6 | loss: 1.4547682
	speed: 0.0304s/iter; left time: 820.3447s
	iters: 1100, epoch: 6 | loss: 1.8107903
	speed: 0.0304s/iter; left time: 817.6288s
	iters: 1200, epoch: 6 | loss: 1.5984758
	speed: 0.0304s/iter; left time: 814.5062s
	iters: 1300, epoch: 6 | loss: 1.6176468
	speed: 0.0304s/iter; left time: 810.9595s
	iters: 1400, epoch: 6 | loss: 1.7399811
	speed: 0.0304s/iter; left time: 808.9217s
	iters: 1500, epoch: 6 | loss: 1.6791314
	speed: 0.0304s/iter; left time: 805.7635s
	iters: 1600, epoch: 6 | loss: 1.6028696
	speed: 0.0304s/iter; left time: 802.4352s
	iters: 1700, epoch: 6 | loss: 1.7020177
	speed: 0.0304s/iter; left time: 800.0902s
	iters: 1800, epoch: 6 | loss: 1.4396425
	speed: 0.0304s/iter; left time: 795.7859s
	iters: 1900, epoch: 6 | loss: 1.7491847
	speed: 0.0304s/iter; left time: 793.5495s
	iters: 2000, epoch: 6 | loss: 1.6919175
	speed: 0.0304s/iter; left time: 790.4956s
	iters: 2100, epoch: 6 | loss: 1.6196542
	speed: 0.0304s/iter; left time: 787.6646s
	iters: 2200, epoch: 6 | loss: 1.5682925
	speed: 0.0304s/iter; left time: 784.6231s
	iters: 2300, epoch: 6 | loss: 1.6425364
	speed: 0.0304s/iter; left time: 781.5963s
	iters: 2400, epoch: 6 | loss: 1.7227620
	speed: 0.0304s/iter; left time: 778.5233s
	iters: 2500, epoch: 6 | loss: 1.5961788
	speed: 0.0304s/iter; left time: 775.2472s
	iters: 2600, epoch: 6 | loss: 1.7906066
	speed: 0.0304s/iter; left time: 772.6646s
	iters: 2700, epoch: 6 | loss: 1.7866076
	speed: 0.0304s/iter; left time: 769.5373s
	iters: 2800, epoch: 6 | loss: 1.6444399
	speed: 0.0304s/iter; left time: 766.0634s
	iters: 2900, epoch: 6 | loss: 1.7059020
	speed: 0.0304s/iter; left time: 763.5303s
	iters: 3000, epoch: 6 | loss: 1.7534649
	speed: 0.0304s/iter; left time: 760.9924s
	iters: 3100, epoch: 6 | loss: 1.4838434
	speed: 0.0304s/iter; left time: 757.6470s
	iters: 3200, epoch: 6 | loss: 1.7501825
	speed: 0.0304s/iter; left time: 753.8694s
	iters: 3300, epoch: 6 | loss: 1.6964214
	speed: 0.0304s/iter; left time: 751.8657s
	iters: 3400, epoch: 6 | loss: 1.4860864
	speed: 0.0304s/iter; left time: 748.7872s
	iters: 3500, epoch: 6 | loss: 1.6270456
	speed: 0.0304s/iter; left time: 744.8910s
	iters: 3600, epoch: 6 | loss: 1.7147679
	speed: 0.0304s/iter; left time: 743.1870s
	iters: 3700, epoch: 6 | loss: 1.5199499
	speed: 0.0304s/iter; left time: 739.0923s
	iters: 3800, epoch: 6 | loss: 1.9080342
	speed: 0.0304s/iter; left time: 735.7083s
	iters: 3900, epoch: 6 | loss: 1.7743788
	speed: 0.0307s/iter; left time: 739.8183s
	iters: 4000, epoch: 6 | loss: 1.9125179
	speed: 0.0304s/iter; left time: 729.9438s
	iters: 4100, epoch: 6 | loss: 1.8633989
	speed: 0.0304s/iter; left time: 726.9560s
	iters: 4200, epoch: 6 | loss: 1.6979263
	speed: 0.0304s/iter; left time: 723.6764s
	iters: 4300, epoch: 6 | loss: 1.7343189
	speed: 0.0304s/iter; left time: 721.0093s
	iters: 4400, epoch: 6 | loss: 1.6385050
	speed: 0.0304s/iter; left time: 717.9754s
	iters: 4500, epoch: 6 | loss: 1.5894743
	speed: 0.0304s/iter; left time: 713.9831s
	iters: 4600, epoch: 6 | loss: 1.6722533
	speed: 0.0304s/iter; left time: 711.7562s
	iters: 4700, epoch: 6 | loss: 1.6801010
	speed: 0.0304s/iter; left time: 708.3828s
	iters: 4800, epoch: 6 | loss: 1.8434073
	speed: 0.0304s/iter; left time: 705.9276s
	iters: 4900, epoch: 6 | loss: 1.8303260
	speed: 0.0304s/iter; left time: 702.4608s
	iters: 5000, epoch: 6 | loss: 1.5944085
	speed: 0.0304s/iter; left time: 700.4983s
	iters: 5100, epoch: 6 | loss: 1.5219914
	speed: 0.0304s/iter; left time: 696.4155s
	iters: 5200, epoch: 6 | loss: 1.5681418
	speed: 0.0304s/iter; left time: 693.2135s
	iters: 5300, epoch: 6 | loss: 1.5890522
	speed: 0.0304s/iter; left time: 690.1975s
	iters: 5400, epoch: 6 | loss: 1.7247595
	speed: 0.0304s/iter; left time: 686.5610s
	iters: 5500, epoch: 6 | loss: 1.7748319
	speed: 0.0304s/iter; left time: 684.4674s
	iters: 5600, epoch: 6 | loss: 1.9743811
	speed: 0.0303s/iter; left time: 679.6938s
Epoch: 6 cost time: 170.43477392196655
Epoch: 6, Steps: 5602 | Train Loss: 1.6420489 Vali Loss: 2.3733413 Test Loss: 1.9417214
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 193117
test shape: (19311, 1, 720, 107) (19311, 1, 720, 107)
test shape: (19311, 720, 107) (19311, 720, 107)
mse:1.9393855333328247, mae:1.093685269355774
>>>>>>>Overall time: 1847 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
