Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=822, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems04_all_common_flow.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems04_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1216640
val 300301
test 300299
	iters: 100, epoch: 1 | loss: 2.1525798
	speed: 0.1213s/iter; left time: 9212.6868s
	iters: 200, epoch: 1 | loss: 2.0501192
	speed: 0.1148s/iter; left time: 8704.7619s
	iters: 300, epoch: 1 | loss: 1.6500564
	speed: 0.1147s/iter; left time: 8688.7712s
	iters: 400, epoch: 1 | loss: 2.5703757
	speed: 0.1146s/iter; left time: 8669.5986s
	iters: 500, epoch: 1 | loss: 2.4666262
	speed: 0.1148s/iter; left time: 8669.0126s
	iters: 600, epoch: 1 | loss: 2.1244640
	speed: 0.1147s/iter; left time: 8656.4365s
	iters: 700, epoch: 1 | loss: 1.8019990
	speed: 0.1147s/iter; left time: 8639.1454s
	iters: 800, epoch: 1 | loss: 2.3198514
	speed: 0.1148s/iter; left time: 8639.4602s
	iters: 900, epoch: 1 | loss: 2.0433106
	speed: 0.1148s/iter; left time: 8624.0829s
	iters: 1000, epoch: 1 | loss: 1.9033812
	speed: 0.1148s/iter; left time: 8612.6339s
	iters: 1100, epoch: 1 | loss: 2.2917197
	speed: 0.1147s/iter; left time: 8595.7422s
	iters: 1200, epoch: 1 | loss: 1.8013622
	speed: 0.1148s/iter; left time: 8591.4383s
	iters: 1300, epoch: 1 | loss: 2.2863448
	speed: 0.1147s/iter; left time: 8573.1092s
	iters: 1400, epoch: 1 | loss: 2.4171796
	speed: 0.1147s/iter; left time: 8563.7325s
	iters: 1500, epoch: 1 | loss: 2.4983902
	speed: 0.1148s/iter; left time: 8559.4471s
	iters: 1600, epoch: 1 | loss: 2.4486661
	speed: 0.1148s/iter; left time: 8548.0876s
	iters: 1700, epoch: 1 | loss: 2.2962093
	speed: 0.1148s/iter; left time: 8532.0836s
	iters: 1800, epoch: 1 | loss: 2.2742884
	speed: 0.1148s/iter; left time: 8521.4494s
	iters: 1900, epoch: 1 | loss: 1.6665273
	speed: 0.1147s/iter; left time: 8505.4323s
	iters: 2000, epoch: 1 | loss: 2.4042864
	speed: 0.1147s/iter; left time: 8495.4084s
	iters: 2100, epoch: 1 | loss: 2.1457815
	speed: 0.1148s/iter; left time: 8486.3309s
	iters: 2200, epoch: 1 | loss: 2.5161905
	speed: 0.1147s/iter; left time: 8468.7143s
	iters: 2300, epoch: 1 | loss: 2.2800469
	speed: 0.1147s/iter; left time: 8460.7487s
	iters: 2400, epoch: 1 | loss: 2.0188239
	speed: 0.1147s/iter; left time: 8448.7033s
	iters: 2500, epoch: 1 | loss: 1.8638130
	speed: 0.1148s/iter; left time: 8441.7034s
	iters: 2600, epoch: 1 | loss: 2.0349669
	speed: 0.1147s/iter; left time: 8426.9225s
	iters: 2700, epoch: 1 | loss: 2.0819919
	speed: 0.1148s/iter; left time: 8417.2560s
	iters: 2800, epoch: 1 | loss: 2.2834690
	speed: 0.1147s/iter; left time: 8404.3808s
	iters: 2900, epoch: 1 | loss: 1.8128427
	speed: 0.1148s/iter; left time: 8396.4346s
	iters: 3000, epoch: 1 | loss: 2.1992795
	speed: 0.1148s/iter; left time: 8382.6838s
	iters: 3100, epoch: 1 | loss: 2.2260594
	speed: 0.1148s/iter; left time: 8373.0721s
	iters: 3200, epoch: 1 | loss: 2.0693617
	speed: 0.1148s/iter; left time: 8359.0498s
	iters: 3300, epoch: 1 | loss: 2.2438788
	speed: 0.1148s/iter; left time: 8349.4493s
	iters: 3400, epoch: 1 | loss: 2.1688695
	speed: 0.1148s/iter; left time: 8340.7107s
	iters: 3500, epoch: 1 | loss: 1.8040845
	speed: 0.1147s/iter; left time: 8322.5914s
	iters: 3600, epoch: 1 | loss: 1.8841349
	speed: 0.1147s/iter; left time: 8308.8271s
	iters: 3700, epoch: 1 | loss: 1.8321625
	speed: 0.1145s/iter; left time: 8285.8743s
	iters: 3800, epoch: 1 | loss: 2.0859456
	speed: 0.1146s/iter; left time: 8278.5110s
	iters: 3900, epoch: 1 | loss: 1.7863423
	speed: 0.1146s/iter; left time: 8268.4290s
	iters: 4000, epoch: 1 | loss: 2.4971826
	speed: 0.1146s/iter; left time: 8257.7404s
	iters: 4100, epoch: 1 | loss: 2.4742165
	speed: 0.1146s/iter; left time: 8245.6256s
	iters: 4200, epoch: 1 | loss: 1.8822248
	speed: 0.1146s/iter; left time: 8235.5434s
	iters: 4300, epoch: 1 | loss: 2.1202102
	speed: 0.1146s/iter; left time: 8218.3815s
	iters: 4400, epoch: 1 | loss: 2.2671876
	speed: 0.1145s/iter; left time: 8205.9513s
	iters: 4500, epoch: 1 | loss: 2.1418757
	speed: 0.1145s/iter; left time: 8191.6422s
	iters: 4600, epoch: 1 | loss: 2.0725746
	speed: 0.1145s/iter; left time: 8180.2633s
	iters: 4700, epoch: 1 | loss: 1.9700477
	speed: 0.1146s/iter; left time: 8172.3845s
	iters: 4800, epoch: 1 | loss: 1.8986652
	speed: 0.1146s/iter; left time: 8165.5727s
	iters: 4900, epoch: 1 | loss: 2.3515980
	speed: 0.1146s/iter; left time: 8154.5614s
	iters: 5000, epoch: 1 | loss: 1.8554389
	speed: 0.1147s/iter; left time: 8147.8606s
	iters: 5100, epoch: 1 | loss: 1.9202845
	speed: 0.1146s/iter; left time: 8128.2981s
	iters: 5200, epoch: 1 | loss: 1.8427688
	speed: 0.1146s/iter; left time: 8119.2466s
	iters: 5300, epoch: 1 | loss: 1.9898759
	speed: 0.1146s/iter; left time: 8104.1388s
	iters: 5400, epoch: 1 | loss: 1.7955987
	speed: 0.1145s/iter; left time: 8090.7506s
	iters: 5500, epoch: 1 | loss: 1.9707679
	speed: 0.1145s/iter; left time: 8079.0534s
	iters: 5600, epoch: 1 | loss: 2.3306000
	speed: 0.1145s/iter; left time: 8068.9233s
	iters: 5700, epoch: 1 | loss: 2.7962542
	speed: 0.1145s/iter; left time: 8055.8801s
	iters: 5800, epoch: 1 | loss: 2.1461086
	speed: 0.1145s/iter; left time: 8041.7602s
	iters: 5900, epoch: 1 | loss: 1.9240628
	speed: 0.1145s/iter; left time: 8031.2096s
	iters: 6000, epoch: 1 | loss: 2.1153216
	speed: 0.1145s/iter; left time: 8021.4257s
	iters: 6100, epoch: 1 | loss: 1.4913168
	speed: 0.1146s/iter; left time: 8011.9056s
	iters: 6200, epoch: 1 | loss: 2.0396736
	speed: 0.1146s/iter; left time: 8005.1500s
	iters: 6300, epoch: 1 | loss: 2.2198832
	speed: 0.1146s/iter; left time: 7989.8631s
	iters: 6400, epoch: 1 | loss: 2.6988626
	speed: 0.1146s/iter; left time: 7980.4769s
	iters: 6500, epoch: 1 | loss: 1.9105653
	speed: 0.1146s/iter; left time: 7966.7604s
	iters: 6600, epoch: 1 | loss: 2.4263048
	speed: 0.1147s/iter; left time: 7962.6140s
	iters: 6700, epoch: 1 | loss: 2.0325987
	speed: 0.1146s/iter; left time: 7949.4099s
	iters: 6800, epoch: 1 | loss: 2.1329083
	speed: 0.1146s/iter; left time: 7934.8702s
	iters: 6900, epoch: 1 | loss: 1.7473124
	speed: 0.1146s/iter; left time: 7920.6424s
	iters: 7000, epoch: 1 | loss: 2.2904072
	speed: 0.1146s/iter; left time: 7912.3873s
	iters: 7100, epoch: 1 | loss: 2.3327007
	speed: 0.1146s/iter; left time: 7902.5652s
	iters: 7200, epoch: 1 | loss: 2.4085174
	speed: 0.1146s/iter; left time: 7886.6990s
	iters: 7300, epoch: 1 | loss: 1.8466582
	speed: 0.1146s/iter; left time: 7877.8633s
	iters: 7400, epoch: 1 | loss: 2.0125103
	speed: 0.1145s/iter; left time: 7862.4851s
	iters: 7500, epoch: 1 | loss: 2.0718353
	speed: 0.1145s/iter; left time: 7847.2691s
	iters: 7600, epoch: 1 | loss: 2.2600818
	speed: 0.1145s/iter; left time: 7834.5123s
Epoch: 1 cost time: 872.7152321338654
Epoch: 1, Steps: 7604 | Train Loss: 2.1027114 Vali Loss: 1.9116294 Test Loss: 2.0143344
Validation loss decreased (inf --> 1.911629).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 2.1580458
	speed: 2.6970s/iter; left time: 184306.9760s
	iters: 200, epoch: 2 | loss: 2.0715883
	speed: 0.1143s/iter; left time: 7798.7365s
	iters: 300, epoch: 2 | loss: 1.7655065
	speed: 0.1143s/iter; left time: 7785.9827s
	iters: 400, epoch: 2 | loss: 2.2531064
	speed: 0.1143s/iter; left time: 7774.7624s
	iters: 500, epoch: 2 | loss: 2.1455209
	speed: 0.1143s/iter; left time: 7766.1903s
	iters: 600, epoch: 2 | loss: 1.9712942
	speed: 0.1143s/iter; left time: 7751.8907s
	iters: 700, epoch: 2 | loss: 2.1371207
	speed: 0.1143s/iter; left time: 7742.2083s
	iters: 800, epoch: 2 | loss: 1.7320604
	speed: 0.1143s/iter; left time: 7731.9033s
	iters: 900, epoch: 2 | loss: 2.5181100
	speed: 0.1143s/iter; left time: 7718.4304s
	iters: 1000, epoch: 2 | loss: 2.2624936
	speed: 0.1143s/iter; left time: 7709.0203s
	iters: 1100, epoch: 2 | loss: 1.7479203
	speed: 0.1142s/iter; left time: 7690.0171s
	iters: 1200, epoch: 2 | loss: 1.9471594
	speed: 0.1141s/iter; left time: 7670.3995s
	iters: 1300, epoch: 2 | loss: 1.9200118
	speed: 0.1141s/iter; left time: 7661.1124s
	iters: 1400, epoch: 2 | loss: 1.8266169
	speed: 0.1142s/iter; left time: 7652.3071s
	iters: 1500, epoch: 2 | loss: 2.1327012
	speed: 0.1142s/iter; left time: 7643.4439s
	iters: 1600, epoch: 2 | loss: 2.3813057
	speed: 0.1142s/iter; left time: 7631.8781s
	iters: 1700, epoch: 2 | loss: 2.1167758
	speed: 0.1141s/iter; left time: 7612.6729s
	iters: 1800, epoch: 2 | loss: 2.2570386
	speed: 0.1142s/iter; left time: 7612.2707s
	iters: 1900, epoch: 2 | loss: 2.4022474
	speed: 0.1143s/iter; left time: 7606.8404s
	iters: 2000, epoch: 2 | loss: 2.1960220
	speed: 0.1144s/iter; left time: 7598.2972s
	iters: 2100, epoch: 2 | loss: 2.4499106
	speed: 0.1143s/iter; left time: 7585.0480s
	iters: 2200, epoch: 2 | loss: 2.1440048
	speed: 0.1143s/iter; left time: 7572.5581s
	iters: 2300, epoch: 2 | loss: 2.0603521
	speed: 0.1143s/iter; left time: 7561.7295s
	iters: 2400, epoch: 2 | loss: 1.8413992
	speed: 0.1143s/iter; left time: 7545.1966s
	iters: 2500, epoch: 2 | loss: 1.7993953
	speed: 0.1143s/iter; left time: 7537.9539s
	iters: 2600, epoch: 2 | loss: 1.8555225
	speed: 0.1142s/iter; left time: 7520.5540s
	iters: 2700, epoch: 2 | loss: 2.1231635
	speed: 0.1144s/iter; left time: 7518.7438s
	iters: 2800, epoch: 2 | loss: 2.2637761
	speed: 0.1143s/iter; left time: 7504.8513s
	iters: 2900, epoch: 2 | loss: 2.0951300
	speed: 0.1143s/iter; left time: 7490.0935s
	iters: 3000, epoch: 2 | loss: 2.2087002
	speed: 0.1143s/iter; left time: 7477.8388s
	iters: 3100, epoch: 2 | loss: 2.3010688
	speed: 0.1143s/iter; left time: 7469.4286s
	iters: 3200, epoch: 2 | loss: 1.8313926
	speed: 0.1144s/iter; left time: 7461.6681s
	iters: 3300, epoch: 2 | loss: 2.1805663
	speed: 0.1144s/iter; left time: 7448.7149s
	iters: 3400, epoch: 2 | loss: 1.6633766
	speed: 0.1143s/iter; left time: 7434.6567s
	iters: 3500, epoch: 2 | loss: 2.1085186
	speed: 0.1143s/iter; left time: 7420.7734s
	iters: 3600, epoch: 2 | loss: 2.0683696
	speed: 0.1144s/iter; left time: 7418.6495s
	iters: 3700, epoch: 2 | loss: 2.0647793
	speed: 0.1143s/iter; left time: 7400.7444s
	iters: 3800, epoch: 2 | loss: 1.9545678
	speed: 0.1142s/iter; left time: 7384.0619s
	iters: 3900, epoch: 2 | loss: 1.8284315
	speed: 0.1143s/iter; left time: 7377.2199s
	iters: 4000, epoch: 2 | loss: 2.1035228
	speed: 0.1144s/iter; left time: 7370.1779s
	iters: 4100, epoch: 2 | loss: 1.6715302
	speed: 0.1143s/iter; left time: 7355.3681s
	iters: 4200, epoch: 2 | loss: 2.0856271
	speed: 0.1143s/iter; left time: 7343.8159s
	iters: 4300, epoch: 2 | loss: 2.2140565
	speed: 0.1143s/iter; left time: 7329.5078s
	iters: 4400, epoch: 2 | loss: 2.3486731
	speed: 0.1143s/iter; left time: 7319.4194s
	iters: 4500, epoch: 2 | loss: 1.8962590
	speed: 0.1144s/iter; left time: 7313.8177s
	iters: 4600, epoch: 2 | loss: 2.2220891
	speed: 0.1143s/iter; left time: 7298.7800s
	iters: 4700, epoch: 2 | loss: 2.1103158
	speed: 0.1143s/iter; left time: 7286.5053s
	iters: 4800, epoch: 2 | loss: 1.7744045
	speed: 0.1144s/iter; left time: 7277.7600s
	iters: 4900, epoch: 2 | loss: 2.4370782
	speed: 0.1144s/iter; left time: 7268.6968s
	iters: 5000, epoch: 2 | loss: 2.3901248
	speed: 0.1144s/iter; left time: 7254.2197s
	iters: 5100, epoch: 2 | loss: 2.1001008
	speed: 0.1143s/iter; left time: 7237.0826s
	iters: 5200, epoch: 2 | loss: 1.8414404
	speed: 0.1143s/iter; left time: 7228.9132s
	iters: 5300, epoch: 2 | loss: 2.0635703
	speed: 0.1144s/iter; left time: 7222.6404s
	iters: 5400, epoch: 2 | loss: 2.4044092
	speed: 0.1143s/iter; left time: 7204.8520s
	iters: 5500, epoch: 2 | loss: 2.3492286
	speed: 0.1142s/iter; left time: 7187.7104s
	iters: 5600, epoch: 2 | loss: 1.8696293
	speed: 0.1143s/iter; left time: 7184.5532s
	iters: 5700, epoch: 2 | loss: 2.2587609
	speed: 0.1144s/iter; left time: 7176.3874s
	iters: 5800, epoch: 2 | loss: 2.1684656
	speed: 0.1143s/iter; left time: 7159.0483s
	iters: 5900, epoch: 2 | loss: 2.7311411
	speed: 0.1144s/iter; left time: 7151.2805s
	iters: 6000, epoch: 2 | loss: 2.2093709
	speed: 0.1142s/iter; left time: 7133.0341s
	iters: 6100, epoch: 2 | loss: 1.7188931
	speed: 0.1142s/iter; left time: 7119.1336s
	iters: 6200, epoch: 2 | loss: 2.0946693
	speed: 0.1143s/iter; left time: 7111.0805s
	iters: 6300, epoch: 2 | loss: 2.3508644
	speed: 0.1143s/iter; left time: 7103.7653s
	iters: 6400, epoch: 2 | loss: 2.4235921
	speed: 0.1143s/iter; left time: 7093.0831s
	iters: 6500, epoch: 2 | loss: 1.8746227
	speed: 0.1143s/iter; left time: 7078.5805s
	iters: 6600, epoch: 2 | loss: 2.2506497
	speed: 0.1143s/iter; left time: 7068.7457s
	iters: 6700, epoch: 2 | loss: 1.9850026
	speed: 0.1143s/iter; left time: 7059.4982s
	iters: 6800, epoch: 2 | loss: 2.2517114
	speed: 0.1144s/iter; left time: 7049.3613s
	iters: 6900, epoch: 2 | loss: 2.4240770
	speed: 0.1143s/iter; left time: 7033.6067s
	iters: 7000, epoch: 2 | loss: 2.2227778
	speed: 0.1143s/iter; left time: 7021.8788s
	iters: 7100, epoch: 2 | loss: 1.7715100
	speed: 0.1142s/iter; left time: 7007.1714s
	iters: 7200, epoch: 2 | loss: 2.0778706
	speed: 0.1144s/iter; left time: 7003.9433s
	iters: 7300, epoch: 2 | loss: 1.7354137
	speed: 0.1143s/iter; left time: 6987.7806s
	iters: 7400, epoch: 2 | loss: 2.2226689
	speed: 0.1143s/iter; left time: 6978.0974s
	iters: 7500, epoch: 2 | loss: 1.7143805
	speed: 0.1143s/iter; left time: 6965.9774s
	iters: 7600, epoch: 2 | loss: 2.0289495
	speed: 0.1143s/iter; left time: 6950.8892s
Epoch: 2 cost time: 869.4831244945526
Epoch: 2, Steps: 7604 | Train Loss: 2.1041345 Vali Loss: 1.9099693 Test Loss: 2.0148814
Validation loss decreased (1.911629 --> 1.909969).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 2.1032324
	speed: 2.7066s/iter; left time: 164379.0996s
	iters: 200, epoch: 3 | loss: 2.2554028
	speed: 0.1144s/iter; left time: 6934.2240s
	iters: 300, epoch: 3 | loss: 2.1890395
	speed: 0.1142s/iter; left time: 6914.2091s
	iters: 400, epoch: 3 | loss: 1.7210630
	speed: 0.1143s/iter; left time: 6906.0889s
	iters: 500, epoch: 3 | loss: 2.0538788
	speed: 0.1143s/iter; left time: 6896.7353s
	iters: 600, epoch: 3 | loss: 2.5226774
	speed: 0.1143s/iter; left time: 6883.1726s
	iters: 700, epoch: 3 | loss: 1.9332151
	speed: 0.1142s/iter; left time: 6868.0481s
	iters: 800, epoch: 3 | loss: 1.8780739
	speed: 0.1143s/iter; left time: 6861.8239s
	iters: 900, epoch: 3 | loss: 1.6353363
	speed: 0.1143s/iter; left time: 6848.5081s
	iters: 1000, epoch: 3 | loss: 2.2542582
	speed: 0.1143s/iter; left time: 6838.6078s
	iters: 1100, epoch: 3 | loss: 2.1037133
	speed: 0.1143s/iter; left time: 6825.5158s
	iters: 1200, epoch: 3 | loss: 2.4832022
	speed: 0.1143s/iter; left time: 6818.6977s
	iters: 1300, epoch: 3 | loss: 1.8121086
	speed: 0.1143s/iter; left time: 6802.9752s
	iters: 1400, epoch: 3 | loss: 2.1209507
	speed: 0.1143s/iter; left time: 6791.7904s
	iters: 1500, epoch: 3 | loss: 2.4544637
	speed: 0.1144s/iter; left time: 6786.2115s
	iters: 1600, epoch: 3 | loss: 2.2996831
	speed: 0.1144s/iter; left time: 6773.7437s
	iters: 1700, epoch: 3 | loss: 2.3282688
	speed: 0.1144s/iter; left time: 6761.9059s
	iters: 1800, epoch: 3 | loss: 2.2990541
	speed: 0.1144s/iter; left time: 6750.7023s
	iters: 1900, epoch: 3 | loss: 2.3402317
	speed: 0.1144s/iter; left time: 6741.0201s
	iters: 2000, epoch: 3 | loss: 2.3301957
	speed: 0.1143s/iter; left time: 6724.3865s
	iters: 2100, epoch: 3 | loss: 2.2851727
	speed: 0.1143s/iter; left time: 6712.8998s
	iters: 2200, epoch: 3 | loss: 2.6219828
	speed: 0.1143s/iter; left time: 6700.2316s
	iters: 2300, epoch: 3 | loss: 1.9999148
	speed: 0.1144s/iter; left time: 6695.0203s
	iters: 2400, epoch: 3 | loss: 1.7905283
	speed: 0.1142s/iter; left time: 6674.7820s
	iters: 2500, epoch: 3 | loss: 2.8455989
	speed: 0.1144s/iter; left time: 6670.8671s
	iters: 2600, epoch: 3 | loss: 2.0001361
	speed: 0.1143s/iter; left time: 6656.6177s
	iters: 2700, epoch: 3 | loss: 1.9077516
	speed: 0.1144s/iter; left time: 6648.1408s
	iters: 2800, epoch: 3 | loss: 1.8820925
	speed: 0.1143s/iter; left time: 6636.0070s
	iters: 2900, epoch: 3 | loss: 1.6969773
	speed: 0.1143s/iter; left time: 6621.5363s
	iters: 3000, epoch: 3 | loss: 2.0357137
	speed: 0.1144s/iter; left time: 6613.5813s
	iters: 3100, epoch: 3 | loss: 1.9991156
	speed: 0.1143s/iter; left time: 6599.4500s
	iters: 3200, epoch: 3 | loss: 1.9086406
	speed: 0.1143s/iter; left time: 6587.3924s
	iters: 3300, epoch: 3 | loss: 2.0022581
	speed: 0.1143s/iter; left time: 6578.7450s
	iters: 3400, epoch: 3 | loss: 2.4044015
	speed: 0.1143s/iter; left time: 6563.2960s
	iters: 3500, epoch: 3 | loss: 1.8348413
	speed: 0.1144s/iter; left time: 6557.1279s
	iters: 3600, epoch: 3 | loss: 2.2830861
	speed: 0.1143s/iter; left time: 6544.1847s
	iters: 3700, epoch: 3 | loss: 2.3939109
	speed: 0.1143s/iter; left time: 6528.7919s
	iters: 3800, epoch: 3 | loss: 2.0710540
	speed: 0.1143s/iter; left time: 6516.6535s
	iters: 3900, epoch: 3 | loss: 2.3233063
	speed: 0.1142s/iter; left time: 6502.1142s
	iters: 4000, epoch: 3 | loss: 2.0472765
	speed: 0.1143s/iter; left time: 6496.0957s
	iters: 4100, epoch: 3 | loss: 2.2171264
	speed: 0.1144s/iter; left time: 6489.2559s
	iters: 4200, epoch: 3 | loss: 2.4921415
	speed: 0.1144s/iter; left time: 6477.8610s
	iters: 4300, epoch: 3 | loss: 2.1272883
	speed: 0.1142s/iter; left time: 6456.9123s
	iters: 4400, epoch: 3 | loss: 1.5534209
	speed: 0.1142s/iter; left time: 6445.5545s
	iters: 4500, epoch: 3 | loss: 2.2621124
	speed: 0.1142s/iter; left time: 6433.0865s
	iters: 4600, epoch: 3 | loss: 2.3251612
	speed: 0.1142s/iter; left time: 6423.6113s
	iters: 4700, epoch: 3 | loss: 2.1067138
	speed: 0.1143s/iter; left time: 6416.4222s
	iters: 4800, epoch: 3 | loss: 1.8995821
	speed: 0.1144s/iter; left time: 6408.0180s
	iters: 4900, epoch: 3 | loss: 2.1278412
	speed: 0.1143s/iter; left time: 6393.5871s
	iters: 5000, epoch: 3 | loss: 2.0622118
	speed: 0.1144s/iter; left time: 6386.9912s
	iters: 5100, epoch: 3 | loss: 1.5596930
	speed: 0.1144s/iter; left time: 6373.6170s
	iters: 5200, epoch: 3 | loss: 2.2229052
	speed: 0.1144s/iter; left time: 6363.1300s
	iters: 5300, epoch: 3 | loss: 2.0303743
	speed: 0.1144s/iter; left time: 6353.8365s
	iters: 5400, epoch: 3 | loss: 2.1031275
	speed: 0.1144s/iter; left time: 6342.7959s
	iters: 5500, epoch: 3 | loss: 1.9427526
	speed: 0.1143s/iter; left time: 6322.5662s
	iters: 5600, epoch: 3 | loss: 2.5260880
	speed: 0.1143s/iter; left time: 6314.1958s
	iters: 5700, epoch: 3 | loss: 2.2126141
	speed: 0.1144s/iter; left time: 6305.5773s
	iters: 5800, epoch: 3 | loss: 2.0574105
	speed: 0.1144s/iter; left time: 6297.2466s
	iters: 5900, epoch: 3 | loss: 2.2920096
	speed: 0.1143s/iter; left time: 6277.2277s
	iters: 6000, epoch: 3 | loss: 2.3154495
	speed: 0.1144s/iter; left time: 6270.7295s
	iters: 6100, epoch: 3 | loss: 2.0306373
	speed: 0.1144s/iter; left time: 6259.3211s
	iters: 6200, epoch: 3 | loss: 2.0729399
	speed: 0.1143s/iter; left time: 6243.9636s
	iters: 6300, epoch: 3 | loss: 1.6940602
	speed: 0.1143s/iter; left time: 6231.1215s
	iters: 6400, epoch: 3 | loss: 2.0048444
	speed: 0.1144s/iter; left time: 6226.1117s
	iters: 6500, epoch: 3 | loss: 2.0715837
	speed: 0.1143s/iter; left time: 6208.2456s
	iters: 6600, epoch: 3 | loss: 1.9699969
	speed: 0.1142s/iter; left time: 6194.2327s
	iters: 6700, epoch: 3 | loss: 2.4122245
	speed: 0.1143s/iter; left time: 6185.3067s
	iters: 6800, epoch: 3 | loss: 2.1432517
	speed: 0.1144s/iter; left time: 6179.3743s
	iters: 6900, epoch: 3 | loss: 2.3279934
	speed: 0.1146s/iter; left time: 6179.7601s
	iters: 7000, epoch: 3 | loss: 2.4283764
	speed: 0.1145s/iter; left time: 6166.4242s
	iters: 7100, epoch: 3 | loss: 2.2515209
	speed: 0.1147s/iter; left time: 6160.9864s
	iters: 7200, epoch: 3 | loss: 2.1193440
	speed: 0.1147s/iter; left time: 6151.1257s
	iters: 7300, epoch: 3 | loss: 2.1881099
	speed: 0.1146s/iter; left time: 6136.6045s
	iters: 7400, epoch: 3 | loss: 1.9136921
	speed: 0.1146s/iter; left time: 6121.9317s
	iters: 7500, epoch: 3 | loss: 2.4988685
	speed: 0.1147s/iter; left time: 6115.8903s
	iters: 7600, epoch: 3 | loss: 2.0319350
	speed: 0.1146s/iter; left time: 6102.3205s
Epoch: 3 cost time: 869.8556351661682
Epoch: 3, Steps: 7604 | Train Loss: 2.1038042 Vali Loss: 1.9108508 Test Loss: 2.0141881
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 2.0375035
	speed: 2.6770s/iter; left time: 142226.4240s
	iters: 200, epoch: 4 | loss: 2.2214179
	speed: 0.1146s/iter; left time: 6075.9780s
	iters: 300, epoch: 4 | loss: 2.1373174
	speed: 0.1145s/iter; left time: 6062.9939s
	iters: 400, epoch: 4 | loss: 2.2024581
	speed: 0.1145s/iter; left time: 6049.1153s
	iters: 500, epoch: 4 | loss: 1.9543872
	speed: 0.1146s/iter; left time: 6043.0318s
	iters: 600, epoch: 4 | loss: 2.0931561
	speed: 0.1146s/iter; left time: 6032.9984s
	iters: 700, epoch: 4 | loss: 2.1675074
	speed: 0.1147s/iter; left time: 6025.1049s
	iters: 800, epoch: 4 | loss: 2.4248576
	speed: 0.1147s/iter; left time: 6011.6064s
	iters: 900, epoch: 4 | loss: 2.1502197
	speed: 0.1148s/iter; left time: 6008.1694s
	iters: 1000, epoch: 4 | loss: 2.4084439
	speed: 0.1147s/iter; left time: 5989.7167s
	iters: 1100, epoch: 4 | loss: 1.9675567
	speed: 0.1147s/iter; left time: 5976.7048s
	iters: 1200, epoch: 4 | loss: 2.1245556
	speed: 0.1147s/iter; left time: 5968.6544s
	iters: 1300, epoch: 4 | loss: 1.8578600
	speed: 0.1147s/iter; left time: 5958.2845s
	iters: 1400, epoch: 4 | loss: 2.0215378
	speed: 0.1148s/iter; left time: 5948.7786s
	iters: 1500, epoch: 4 | loss: 2.1999953
	speed: 0.1148s/iter; left time: 5936.3864s
	iters: 1600, epoch: 4 | loss: 2.2674427
	speed: 0.1148s/iter; left time: 5924.6811s
	iters: 1700, epoch: 4 | loss: 1.9366976
	speed: 0.1147s/iter; left time: 5910.3699s
	iters: 1800, epoch: 4 | loss: 2.1044660
	speed: 0.1148s/iter; left time: 5902.6966s
	iters: 1900, epoch: 4 | loss: 2.1731088
	speed: 0.1148s/iter; left time: 5890.7066s
	iters: 2000, epoch: 4 | loss: 1.9496456
	speed: 0.1148s/iter; left time: 5878.6941s
	iters: 2100, epoch: 4 | loss: 1.7118551
	speed: 0.1148s/iter; left time: 5868.2749s
	iters: 2200, epoch: 4 | loss: 2.3520744
	speed: 0.1147s/iter; left time: 5855.2975s
	iters: 2300, epoch: 4 | loss: 2.4034700
	speed: 0.1147s/iter; left time: 5843.0578s
	iters: 2400, epoch: 4 | loss: 2.1173759
	speed: 0.1146s/iter; left time: 5827.3720s
	iters: 2500, epoch: 4 | loss: 2.4428394
	speed: 0.1148s/iter; left time: 5823.0767s
	iters: 2600, epoch: 4 | loss: 1.9476947
	speed: 0.1147s/iter; left time: 5808.0402s
	iters: 2700, epoch: 4 | loss: 2.6212418
	speed: 0.1147s/iter; left time: 5796.0005s
	iters: 2800, epoch: 4 | loss: 2.2735989
	speed: 0.1148s/iter; left time: 5788.8337s
	iters: 2900, epoch: 4 | loss: 2.2717307
	speed: 0.1146s/iter; left time: 5768.7226s
	iters: 3000, epoch: 4 | loss: 2.0658329
	speed: 0.1146s/iter; left time: 5757.9872s
	iters: 3100, epoch: 4 | loss: 1.5101774
	speed: 0.1146s/iter; left time: 5747.1473s
	iters: 3200, epoch: 4 | loss: 2.5535750
	speed: 0.1147s/iter; left time: 5739.1361s
	iters: 3300, epoch: 4 | loss: 2.0075815
	speed: 0.1148s/iter; left time: 5730.7357s
	iters: 3400, epoch: 4 | loss: 2.0184989
	speed: 0.1147s/iter; left time: 5715.1392s
	iters: 3500, epoch: 4 | loss: 2.0758886
	speed: 0.1147s/iter; left time: 5704.9877s
	iters: 3600, epoch: 4 | loss: 2.0817616
	speed: 0.1147s/iter; left time: 5692.4664s
	iters: 3700, epoch: 4 | loss: 2.2993848
	speed: 0.1148s/iter; left time: 5684.8913s
	iters: 3800, epoch: 4 | loss: 2.8563673
	speed: 0.1147s/iter; left time: 5668.3104s
	iters: 3900, epoch: 4 | loss: 2.0728989
	speed: 0.1147s/iter; left time: 5659.1868s
	iters: 4000, epoch: 4 | loss: 2.2312784
	speed: 0.1147s/iter; left time: 5646.9109s
	iters: 4100, epoch: 4 | loss: 2.6176646
	speed: 0.1147s/iter; left time: 5636.5500s
	iters: 4200, epoch: 4 | loss: 1.9836310
	speed: 0.1147s/iter; left time: 5621.9146s
	iters: 4300, epoch: 4 | loss: 1.6639140
	speed: 0.1146s/iter; left time: 5607.1582s
	iters: 4400, epoch: 4 | loss: 2.1298356
	speed: 0.1147s/iter; left time: 5602.2122s
	iters: 4500, epoch: 4 | loss: 2.3229468
	speed: 0.1147s/iter; left time: 5590.2527s
	iters: 4600, epoch: 4 | loss: 1.9726948
	speed: 0.1147s/iter; left time: 5577.8456s
	iters: 4700, epoch: 4 | loss: 1.7142330
	speed: 0.1147s/iter; left time: 5564.7200s
	iters: 4800, epoch: 4 | loss: 2.4498584
	speed: 0.1146s/iter; left time: 5551.5931s
	iters: 4900, epoch: 4 | loss: 2.3563991
	speed: 0.1148s/iter; left time: 5549.2836s
	iters: 5000, epoch: 4 | loss: 2.3498185
	speed: 0.1147s/iter; left time: 5530.9514s
	iters: 5100, epoch: 4 | loss: 2.2908111
	speed: 0.1146s/iter; left time: 5515.4630s
	iters: 5200, epoch: 4 | loss: 2.3453407
	speed: 0.1146s/iter; left time: 5505.9089s
	iters: 5300, epoch: 4 | loss: 2.6831083
	speed: 0.1147s/iter; left time: 5495.8837s
	iters: 5400, epoch: 4 | loss: 2.4952412
	speed: 0.1147s/iter; left time: 5484.2449s
	iters: 5500, epoch: 4 | loss: 2.0578587
	speed: 0.1147s/iter; left time: 5473.5347s
	iters: 5600, epoch: 4 | loss: 2.4113307
	speed: 0.1146s/iter; left time: 5458.7250s
	iters: 5700, epoch: 4 | loss: 2.0315046
	speed: 0.1147s/iter; left time: 5452.6485s
	iters: 5800, epoch: 4 | loss: 2.0851107
	speed: 0.1147s/iter; left time: 5439.9460s
	iters: 5900, epoch: 4 | loss: 1.8564472
	speed: 0.1147s/iter; left time: 5427.9367s
	iters: 6000, epoch: 4 | loss: 2.2344170
	speed: 0.1146s/iter; left time: 5414.6004s
	iters: 6100, epoch: 4 | loss: 1.6399807
	speed: 0.1147s/iter; left time: 5403.6448s
	iters: 6200, epoch: 4 | loss: 1.9284947
	speed: 0.1147s/iter; left time: 5395.3750s
	iters: 6300, epoch: 4 | loss: 2.5297925
	speed: 0.1147s/iter; left time: 5383.1903s
	iters: 6400, epoch: 4 | loss: 2.3312519
	speed: 0.1146s/iter; left time: 5367.6323s
	iters: 6500, epoch: 4 | loss: 2.3808780
	speed: 0.1146s/iter; left time: 5355.0662s
	iters: 6600, epoch: 4 | loss: 2.1092877
	speed: 0.1146s/iter; left time: 5344.5441s
	iters: 6700, epoch: 4 | loss: 1.8808993
	speed: 0.1146s/iter; left time: 5333.0991s
	iters: 6800, epoch: 4 | loss: 2.1221855
	speed: 0.1146s/iter; left time: 5318.6871s
	iters: 6900, epoch: 4 | loss: 2.2249203
	speed: 0.1146s/iter; left time: 5310.8869s
	iters: 7000, epoch: 4 | loss: 1.9058516
	speed: 0.1147s/iter; left time: 5302.3055s
	iters: 7100, epoch: 4 | loss: 2.5939424
	speed: 0.1146s/iter; left time: 5286.9867s
	iters: 7200, epoch: 4 | loss: 1.9744600
	speed: 0.1146s/iter; left time: 5273.5444s
	iters: 7300, epoch: 4 | loss: 2.1978776
	speed: 0.1145s/iter; left time: 5260.7496s
	iters: 7400, epoch: 4 | loss: 2.3174825
	speed: 0.1145s/iter; left time: 5248.5821s
	iters: 7500, epoch: 4 | loss: 2.0884585
	speed: 0.1145s/iter; left time: 5237.8674s
	iters: 7600, epoch: 4 | loss: 1.4865443
	speed: 0.1146s/iter; left time: 5228.1807s
Epoch: 4 cost time: 872.350916147232
Epoch: 4, Steps: 7604 | Train Loss: 2.1037050 Vali Loss: 1.9092801 Test Loss: 2.0141528
Validation loss decreased (1.909969 --> 1.909280).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 2.0442493
	speed: 2.6684s/iter; left time: 121478.7228s
	iters: 200, epoch: 5 | loss: 1.6435574
	speed: 0.1146s/iter; left time: 5204.0782s
	iters: 300, epoch: 5 | loss: 2.1981878
	speed: 0.1145s/iter; left time: 5187.5641s
	iters: 400, epoch: 5 | loss: 2.1440384
	speed: 0.1145s/iter; left time: 5180.3858s
	iters: 500, epoch: 5 | loss: 1.8854281
	speed: 0.1144s/iter; left time: 5163.8795s
	iters: 600, epoch: 5 | loss: 2.2084775
	speed: 0.1145s/iter; left time: 5154.3444s
	iters: 700, epoch: 5 | loss: 2.1153817
	speed: 0.1145s/iter; left time: 5144.0115s
	iters: 800, epoch: 5 | loss: 2.3299279
	speed: 0.1145s/iter; left time: 5131.8396s
	iters: 900, epoch: 5 | loss: 2.0807335
	speed: 0.1146s/iter; left time: 5125.8405s
	iters: 1000, epoch: 5 | loss: 2.3709416
	speed: 0.1147s/iter; left time: 5118.2279s
	iters: 1100, epoch: 5 | loss: 2.0032380
	speed: 0.1148s/iter; left time: 5109.6263s
	iters: 1200, epoch: 5 | loss: 1.9497038
	speed: 0.1145s/iter; left time: 5088.7294s
	iters: 1300, epoch: 5 | loss: 2.0916615
	speed: 0.1145s/iter; left time: 5076.4237s
	iters: 1400, epoch: 5 | loss: 2.3315234
	speed: 0.1145s/iter; left time: 5065.2577s
	iters: 1500, epoch: 5 | loss: 2.3321595
	speed: 0.1146s/iter; left time: 5058.4040s
	iters: 1600, epoch: 5 | loss: 2.1728303
	speed: 0.1146s/iter; left time: 5046.1485s
	iters: 1700, epoch: 5 | loss: 2.5579269
	speed: 0.1146s/iter; left time: 5032.9417s
	iters: 1800, epoch: 5 | loss: 2.4824126
	speed: 0.1146s/iter; left time: 5020.1761s
	iters: 1900, epoch: 5 | loss: 2.0374873
	speed: 0.1145s/iter; left time: 5007.4564s
	iters: 2000, epoch: 5 | loss: 2.4522102
	speed: 0.1145s/iter; left time: 4996.7128s
	iters: 2100, epoch: 5 | loss: 2.0349226
	speed: 0.1146s/iter; left time: 4989.0071s
	iters: 2200, epoch: 5 | loss: 1.8157341
	speed: 0.1145s/iter; left time: 4973.6627s
	iters: 2300, epoch: 5 | loss: 2.3080914
	speed: 0.1146s/iter; left time: 4966.8063s
	iters: 2400, epoch: 5 | loss: 2.0674422
	speed: 0.1146s/iter; left time: 4953.5497s
	iters: 2500, epoch: 5 | loss: 2.4591575
	speed: 0.1146s/iter; left time: 4943.5024s
	iters: 2600, epoch: 5 | loss: 1.6126312
	speed: 0.1145s/iter; left time: 4927.6520s
	iters: 2700, epoch: 5 | loss: 2.2696564
	speed: 0.1146s/iter; left time: 4919.0087s
	iters: 2800, epoch: 5 | loss: 2.1123824
	speed: 0.1146s/iter; left time: 4908.5810s
	iters: 2900, epoch: 5 | loss: 1.6829963
	speed: 0.1146s/iter; left time: 4896.2487s
	iters: 3000, epoch: 5 | loss: 2.3566678
	speed: 0.1145s/iter; left time: 4882.4665s
	iters: 3100, epoch: 5 | loss: 2.4622703
	speed: 0.1148s/iter; left time: 4881.0351s
	iters: 3200, epoch: 5 | loss: 2.2518601
	speed: 0.1146s/iter; left time: 4861.0464s
	iters: 3300, epoch: 5 | loss: 2.1580007
	speed: 0.1146s/iter; left time: 4851.4520s
	iters: 3400, epoch: 5 | loss: 2.1865132
	speed: 0.1146s/iter; left time: 4837.1765s
	iters: 3500, epoch: 5 | loss: 2.2575727
	speed: 0.1145s/iter; left time: 4822.6247s
	iters: 3600, epoch: 5 | loss: 2.2052867
	speed: 0.1145s/iter; left time: 4813.0127s
	iters: 3700, epoch: 5 | loss: 2.1348619
	speed: 0.1145s/iter; left time: 4799.6372s
	iters: 3800, epoch: 5 | loss: 2.0177722
	speed: 0.1145s/iter; left time: 4787.6474s
	iters: 3900, epoch: 5 | loss: 1.6001990
	speed: 0.1145s/iter; left time: 4776.3949s
	iters: 4000, epoch: 5 | loss: 2.3835402
	speed: 0.1145s/iter; left time: 4766.0774s
	iters: 4100, epoch: 5 | loss: 2.1905847
	speed: 0.1145s/iter; left time: 4753.4678s
	iters: 4200, epoch: 5 | loss: 1.9036335
	speed: 0.1145s/iter; left time: 4742.1803s
	iters: 4300, epoch: 5 | loss: 1.5107584
	speed: 0.1145s/iter; left time: 4730.3673s
	iters: 4400, epoch: 5 | loss: 2.5266657
	speed: 0.1145s/iter; left time: 4721.7436s
	iters: 4500, epoch: 5 | loss: 2.3188307
	speed: 0.1145s/iter; left time: 4707.0325s
	iters: 4600, epoch: 5 | loss: 1.8831717
	speed: 0.1147s/iter; left time: 4704.1107s
	iters: 4700, epoch: 5 | loss: 1.9230733
	speed: 0.1145s/iter; left time: 4686.9070s
	iters: 4800, epoch: 5 | loss: 2.0999320
	speed: 0.1146s/iter; left time: 4677.6071s
	iters: 4900, epoch: 5 | loss: 2.2846956
	speed: 0.1145s/iter; left time: 4662.8312s
	iters: 5000, epoch: 5 | loss: 2.1002045
	speed: 0.1145s/iter; left time: 4649.9496s
	iters: 5100, epoch: 5 | loss: 1.9837065
	speed: 0.1144s/iter; left time: 4638.0426s
	iters: 5200, epoch: 5 | loss: 2.0995531
	speed: 0.1145s/iter; left time: 4629.9714s
	iters: 5300, epoch: 5 | loss: 1.8560350
	speed: 0.1146s/iter; left time: 4620.1006s
	iters: 5400, epoch: 5 | loss: 2.3436141
	speed: 0.1146s/iter; left time: 4611.0003s
	iters: 5500, epoch: 5 | loss: 2.0506957
	speed: 0.1144s/iter; left time: 4590.2857s
	iters: 5600, epoch: 5 | loss: 2.1163404
	speed: 0.1141s/iter; left time: 4567.9411s
	iters: 5700, epoch: 5 | loss: 1.5948581
	speed: 0.1141s/iter; left time: 4557.0537s
	iters: 5800, epoch: 5 | loss: 2.1267090
	speed: 0.1141s/iter; left time: 4543.3538s
	iters: 5900, epoch: 5 | loss: 2.6755285
	speed: 0.1141s/iter; left time: 4531.5343s
	iters: 6000, epoch: 5 | loss: 2.8468316
	speed: 0.1141s/iter; left time: 4519.6804s
	iters: 6100, epoch: 5 | loss: 2.0348878
	speed: 0.1141s/iter; left time: 4508.7004s
	iters: 6200, epoch: 5 | loss: 1.7041633
	speed: 0.1141s/iter; left time: 4499.2484s
	iters: 6300, epoch: 5 | loss: 2.2207613
	speed: 0.1141s/iter; left time: 4488.2331s
	iters: 6400, epoch: 5 | loss: 1.8399699
	speed: 0.1142s/iter; left time: 4478.1396s
	iters: 6500, epoch: 5 | loss: 2.5107126
	speed: 0.1142s/iter; left time: 4466.9166s
	iters: 6600, epoch: 5 | loss: 2.0204933
	speed: 0.1141s/iter; left time: 4454.5088s
	iters: 6700, epoch: 5 | loss: 2.2123652
	speed: 0.1141s/iter; left time: 4440.3437s
	iters: 6800, epoch: 5 | loss: 2.1818116
	speed: 0.1141s/iter; left time: 4428.0495s
	iters: 6900, epoch: 5 | loss: 2.7114480
	speed: 0.1141s/iter; left time: 4416.9236s
	iters: 7000, epoch: 5 | loss: 2.1467054
	speed: 0.1141s/iter; left time: 4405.6381s
	iters: 7100, epoch: 5 | loss: 2.1485579
	speed: 0.1141s/iter; left time: 4393.8532s
	iters: 7200, epoch: 5 | loss: 2.1812181
	speed: 0.1141s/iter; left time: 4384.8506s
	iters: 7300, epoch: 5 | loss: 1.8769614
	speed: 0.1141s/iter; left time: 4373.8385s
	iters: 7400, epoch: 5 | loss: 2.0000660
	speed: 0.1141s/iter; left time: 4362.9620s
	iters: 7500, epoch: 5 | loss: 2.4303508
	speed: 0.1141s/iter; left time: 4349.5929s
	iters: 7600, epoch: 5 | loss: 2.0881538
	speed: 0.1141s/iter; left time: 4339.2307s
Epoch: 5 cost time: 870.4473526477814
Epoch: 5, Steps: 7604 | Train Loss: 2.1036815 Vali Loss: 1.9095712 Test Loss: 2.0140216
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 2.3978851
	speed: 2.7052s/iter; left time: 102584.1117s
	iters: 200, epoch: 6 | loss: 1.8951790
	speed: 0.1145s/iter; left time: 4328.6750s
	iters: 300, epoch: 6 | loss: 1.9980488
	speed: 0.1144s/iter; left time: 4315.9229s
	iters: 400, epoch: 6 | loss: 1.6595640
	speed: 0.1143s/iter; left time: 4301.6260s
	iters: 500, epoch: 6 | loss: 1.9968394
	speed: 0.1143s/iter; left time: 4290.0073s
	iters: 600, epoch: 6 | loss: 2.1245370
	speed: 0.1143s/iter; left time: 4277.8457s
	iters: 700, epoch: 6 | loss: 1.9331086
	speed: 0.1144s/iter; left time: 4269.8679s
	iters: 800, epoch: 6 | loss: 1.9706409
	speed: 0.1144s/iter; left time: 4259.6399s
	iters: 900, epoch: 6 | loss: 2.6270590
	speed: 0.1144s/iter; left time: 4245.5880s
	iters: 1000, epoch: 6 | loss: 1.8458403
	speed: 0.1143s/iter; left time: 4229.6577s
	iters: 1100, epoch: 6 | loss: 2.3851073
	speed: 0.1142s/iter; left time: 4215.1087s
	iters: 1200, epoch: 6 | loss: 2.2384472
	speed: 0.1142s/iter; left time: 4204.0196s
	iters: 1300, epoch: 6 | loss: 1.6391779
	speed: 0.1143s/iter; left time: 4197.1937s
	iters: 1400, epoch: 6 | loss: 2.1303856
	speed: 0.1148s/iter; left time: 4203.2495s
	iters: 1500, epoch: 6 | loss: 2.3374264
	speed: 0.1148s/iter; left time: 4192.6366s
	iters: 1600, epoch: 6 | loss: 2.2884667
	speed: 0.1148s/iter; left time: 4181.9292s
	iters: 1700, epoch: 6 | loss: 2.5089850
	speed: 0.1148s/iter; left time: 4169.0749s
	iters: 1800, epoch: 6 | loss: 2.0686667
	speed: 0.1147s/iter; left time: 4154.3348s
	iters: 1900, epoch: 6 | loss: 1.9801683
	speed: 0.1147s/iter; left time: 4142.0757s
	iters: 2000, epoch: 6 | loss: 2.2722073
	speed: 0.1147s/iter; left time: 4131.4941s
	iters: 2100, epoch: 6 | loss: 1.7845725
	speed: 0.1148s/iter; left time: 4122.8555s
	iters: 2200, epoch: 6 | loss: 2.1382513
	speed: 0.1147s/iter; left time: 4107.9129s
	iters: 2300, epoch: 6 | loss: 2.0880897
	speed: 0.1148s/iter; left time: 4099.9100s
	iters: 2400, epoch: 6 | loss: 1.9940464
	speed: 0.1148s/iter; left time: 4088.5066s
	iters: 2500, epoch: 6 | loss: 2.4757824
	speed: 0.1147s/iter; left time: 4075.2676s
	iters: 2600, epoch: 6 | loss: 2.3627458
	speed: 0.1147s/iter; left time: 4062.1913s
	iters: 2700, epoch: 6 | loss: 2.4353156
	speed: 0.1147s/iter; left time: 4049.9932s
	iters: 2800, epoch: 6 | loss: 2.2368677
	speed: 0.1147s/iter; left time: 4038.4930s
	iters: 2900, epoch: 6 | loss: 2.1023905
	speed: 0.1149s/iter; left time: 4035.4541s
	iters: 3000, epoch: 6 | loss: 2.2437234
	speed: 0.1149s/iter; left time: 4022.8249s
	iters: 3100, epoch: 6 | loss: 1.9773042
	speed: 0.1148s/iter; left time: 4007.5573s
	iters: 3200, epoch: 6 | loss: 1.7687653
	speed: 0.1148s/iter; left time: 3999.1058s
	iters: 3300, epoch: 6 | loss: 2.3109784
	speed: 0.1148s/iter; left time: 3986.2282s
	iters: 3400, epoch: 6 | loss: 2.2747710
	speed: 0.1149s/iter; left time: 3977.7509s
	iters: 3500, epoch: 6 | loss: 2.0529010
	speed: 0.1148s/iter; left time: 3962.4128s
	iters: 3600, epoch: 6 | loss: 2.0769398
	speed: 0.1147s/iter; left time: 3949.5849s
	iters: 3700, epoch: 6 | loss: 1.9969997
	speed: 0.1148s/iter; left time: 3940.0220s
	iters: 3800, epoch: 6 | loss: 1.9372640
	speed: 0.1148s/iter; left time: 3927.7929s
	iters: 3900, epoch: 6 | loss: 2.2790389
	speed: 0.1147s/iter; left time: 3913.1118s
	iters: 4000, epoch: 6 | loss: 2.5390615
	speed: 0.1147s/iter; left time: 3903.2566s
	iters: 4100, epoch: 6 | loss: 2.0905328
	speed: 0.1146s/iter; left time: 3888.4243s
	iters: 4200, epoch: 6 | loss: 2.2354221
	speed: 0.1147s/iter; left time: 3877.9885s
	iters: 4300, epoch: 6 | loss: 2.2163513
	speed: 0.1147s/iter; left time: 3866.3988s
	iters: 4400, epoch: 6 | loss: 1.8557289
	speed: 0.1147s/iter; left time: 3856.5900s
	iters: 4500, epoch: 6 | loss: 2.3647101
	speed: 0.1147s/iter; left time: 3845.6876s
	iters: 4600, epoch: 6 | loss: 1.9590501
	speed: 0.1147s/iter; left time: 3834.5513s
	iters: 4700, epoch: 6 | loss: 1.6245059
	speed: 0.1149s/iter; left time: 3827.1657s
	iters: 4800, epoch: 6 | loss: 1.7654301
	speed: 0.1147s/iter; left time: 3809.4278s
	iters: 4900, epoch: 6 | loss: 1.7606922
	speed: 0.1148s/iter; left time: 3800.8336s
	iters: 5000, epoch: 6 | loss: 2.0251205
	speed: 0.1148s/iter; left time: 3789.9709s
	iters: 5100, epoch: 6 | loss: 2.0478406
	speed: 0.1148s/iter; left time: 3779.9674s
	iters: 5200, epoch: 6 | loss: 1.7090231
	speed: 0.1148s/iter; left time: 3767.6405s
	iters: 5300, epoch: 6 | loss: 1.9415927
	speed: 0.1147s/iter; left time: 3753.6453s
	iters: 5400, epoch: 6 | loss: 1.9593443
	speed: 0.1147s/iter; left time: 3741.0178s
	iters: 5500, epoch: 6 | loss: 2.1029978
	speed: 0.1147s/iter; left time: 3731.3659s
	iters: 5600, epoch: 6 | loss: 2.2204676
	speed: 0.1148s/iter; left time: 3720.3675s
	iters: 5700, epoch: 6 | loss: 2.3851690
	speed: 0.1147s/iter; left time: 3706.9089s
	iters: 5800, epoch: 6 | loss: 2.1927202
	speed: 0.1147s/iter; left time: 3697.2655s
	iters: 5900, epoch: 6 | loss: 1.6065735
	speed: 0.1147s/iter; left time: 3684.7620s
	iters: 6000, epoch: 6 | loss: 2.5911560
	speed: 0.1148s/iter; left time: 3675.1397s
	iters: 6100, epoch: 6 | loss: 2.2664289
	speed: 0.1147s/iter; left time: 3662.5820s
	iters: 6200, epoch: 6 | loss: 2.4657285
	speed: 0.1146s/iter; left time: 3645.9122s
	iters: 6300, epoch: 6 | loss: 2.3247473
	speed: 0.1147s/iter; left time: 3637.1256s
	iters: 6400, epoch: 6 | loss: 2.1381550
	speed: 0.1146s/iter; left time: 3624.7902s
	iters: 6500, epoch: 6 | loss: 2.1764429
	speed: 0.1146s/iter; left time: 3613.7957s
	iters: 6600, epoch: 6 | loss: 1.7562208
	speed: 0.1147s/iter; left time: 3604.4538s
	iters: 6700, epoch: 6 | loss: 2.4929955
	speed: 0.1146s/iter; left time: 3590.5055s
	iters: 6800, epoch: 6 | loss: 2.0840373
	speed: 0.1146s/iter; left time: 3579.1192s
	iters: 6900, epoch: 6 | loss: 1.9195305
	speed: 0.1147s/iter; left time: 3569.4203s
	iters: 7000, epoch: 6 | loss: 1.8595068
	speed: 0.1146s/iter; left time: 3554.0201s
	iters: 7100, epoch: 6 | loss: 2.5798507
	speed: 0.1146s/iter; left time: 3543.6548s
	iters: 7200, epoch: 6 | loss: 2.1339855
	speed: 0.1146s/iter; left time: 3531.6412s
	iters: 7300, epoch: 6 | loss: 2.1929047
	speed: 0.1146s/iter; left time: 3520.7255s
	iters: 7400, epoch: 6 | loss: 2.3133066
	speed: 0.1147s/iter; left time: 3512.0337s
	iters: 7500, epoch: 6 | loss: 2.5414891
	speed: 0.1146s/iter; left time: 3496.2077s
	iters: 7600, epoch: 6 | loss: 1.8009428
	speed: 0.1147s/iter; left time: 3488.0064s
Epoch: 6 cost time: 872.2031490802765
Epoch: 6, Steps: 7604 | Train Loss: 2.1036706 Vali Loss: 1.9101884 Test Loss: 2.0142376
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 1.6129018
	speed: 2.6693s/iter; left time: 80925.3965s
	iters: 200, epoch: 7 | loss: 1.9157035
	speed: 0.1146s/iter; left time: 3462.6983s
	iters: 300, epoch: 7 | loss: 2.1900561
	speed: 0.1146s/iter; left time: 3450.4046s
	iters: 400, epoch: 7 | loss: 1.8180387
	speed: 0.1147s/iter; left time: 3442.5682s
	iters: 500, epoch: 7 | loss: 1.8483064
	speed: 0.1147s/iter; left time: 3432.4748s
	iters: 600, epoch: 7 | loss: 2.7342918
	speed: 0.1147s/iter; left time: 3421.1219s
	iters: 700, epoch: 7 | loss: 2.2327905
	speed: 0.1148s/iter; left time: 3410.4261s
	iters: 800, epoch: 7 | loss: 2.0248270
	speed: 0.1148s/iter; left time: 3399.7806s
	iters: 900, epoch: 7 | loss: 2.0635366
	speed: 0.1148s/iter; left time: 3389.0104s
	iters: 1000, epoch: 7 | loss: 2.1440403
	speed: 0.1147s/iter; left time: 3374.9628s
	iters: 1100, epoch: 7 | loss: 1.9430726
	speed: 0.1147s/iter; left time: 3363.4652s
	iters: 1200, epoch: 7 | loss: 2.0861759
	speed: 0.1147s/iter; left time: 3351.3997s
	iters: 1300, epoch: 7 | loss: 1.7343140
	speed: 0.1147s/iter; left time: 3340.6031s
	iters: 1400, epoch: 7 | loss: 1.9809554
	speed: 0.1147s/iter; left time: 3327.8826s
	iters: 1500, epoch: 7 | loss: 1.9718823
	speed: 0.1148s/iter; left time: 3318.7394s
	iters: 1600, epoch: 7 | loss: 1.9588065
	speed: 0.1148s/iter; left time: 3307.0945s
	iters: 1700, epoch: 7 | loss: 2.3247881
	speed: 0.1149s/iter; left time: 3298.7083s
	iters: 1800, epoch: 7 | loss: 2.1152842
	speed: 0.1147s/iter; left time: 3283.3608s
	iters: 1900, epoch: 7 | loss: 2.4474216
	speed: 0.1148s/iter; left time: 3274.4140s
	iters: 2000, epoch: 7 | loss: 2.4128714
	speed: 0.1148s/iter; left time: 3261.7153s
	iters: 2100, epoch: 7 | loss: 2.2653251
	speed: 0.1147s/iter; left time: 3249.0111s
	iters: 2200, epoch: 7 | loss: 2.4802470
	speed: 0.1148s/iter; left time: 3238.9166s
	iters: 2300, epoch: 7 | loss: 2.2124207
	speed: 0.1148s/iter; left time: 3227.6793s
	iters: 2400, epoch: 7 | loss: 1.8923994
	speed: 0.1147s/iter; left time: 3214.8723s
	iters: 2500, epoch: 7 | loss: 1.9088703
	speed: 0.1148s/iter; left time: 3204.6247s
	iters: 2600, epoch: 7 | loss: 2.5088325
	speed: 0.1148s/iter; left time: 3192.0763s
	iters: 2700, epoch: 7 | loss: 2.3006628
	speed: 0.1148s/iter; left time: 3181.7208s
	iters: 2800, epoch: 7 | loss: 1.9770730
	speed: 0.1147s/iter; left time: 3167.8843s
	iters: 2900, epoch: 7 | loss: 1.9803835
	speed: 0.1148s/iter; left time: 3157.9272s
	iters: 3000, epoch: 7 | loss: 1.9559362
	speed: 0.1147s/iter; left time: 3145.2175s
	iters: 3100, epoch: 7 | loss: 2.2817543
	speed: 0.1146s/iter; left time: 3131.0206s
	iters: 3200, epoch: 7 | loss: 2.3962524
	speed: 0.1147s/iter; left time: 3122.9448s
	iters: 3300, epoch: 7 | loss: 1.9400760
	speed: 0.1148s/iter; left time: 3113.3732s
	iters: 3400, epoch: 7 | loss: 2.0084734
	speed: 0.1148s/iter; left time: 3100.8200s
	iters: 3500, epoch: 7 | loss: 2.3002675
	speed: 0.1148s/iter; left time: 3090.7626s
	iters: 3600, epoch: 7 | loss: 2.0620265
	speed: 0.1148s/iter; left time: 3079.1555s
	iters: 3700, epoch: 7 | loss: 2.1041634
	speed: 0.1148s/iter; left time: 3067.2425s
	iters: 3800, epoch: 7 | loss: 1.8587703
	speed: 0.1148s/iter; left time: 3055.4836s
	iters: 3900, epoch: 7 | loss: 1.9389958
	speed: 0.1148s/iter; left time: 3044.7472s
	iters: 4000, epoch: 7 | loss: 2.2052081
	speed: 0.1147s/iter; left time: 3029.8859s
	iters: 4100, epoch: 7 | loss: 1.8803196
	speed: 0.1148s/iter; left time: 3020.0537s
	iters: 4200, epoch: 7 | loss: 2.0523174
	speed: 0.1147s/iter; left time: 3006.4688s
	iters: 4300, epoch: 7 | loss: 2.3881273
	speed: 0.1147s/iter; left time: 2995.2159s
	iters: 4400, epoch: 7 | loss: 2.5811722
	speed: 0.1148s/iter; left time: 2985.7020s
	iters: 4500, epoch: 7 | loss: 2.0565741
	speed: 0.1147s/iter; left time: 2971.9002s
	iters: 4600, epoch: 7 | loss: 2.3269787
	speed: 0.1148s/iter; left time: 2963.0445s
	iters: 4700, epoch: 7 | loss: 2.0832663
	speed: 0.1147s/iter; left time: 2949.6557s
	iters: 4800, epoch: 7 | loss: 2.1163595
	speed: 0.1147s/iter; left time: 2937.7711s
	iters: 4900, epoch: 7 | loss: 2.7550159
	speed: 0.1147s/iter; left time: 2927.1598s
	iters: 5000, epoch: 7 | loss: 2.1194193
	speed: 0.1148s/iter; left time: 2916.9833s
	iters: 5100, epoch: 7 | loss: 1.9345986
	speed: 0.1147s/iter; left time: 2904.6983s
	iters: 5200, epoch: 7 | loss: 1.8910483
	speed: 0.1147s/iter; left time: 2893.2788s
	iters: 5300, epoch: 7 | loss: 2.0637722
	speed: 0.1147s/iter; left time: 2881.7189s
	iters: 5400, epoch: 7 | loss: 1.8319055
	speed: 0.1147s/iter; left time: 2869.7860s
	iters: 5500, epoch: 7 | loss: 2.1973932
	speed: 0.1147s/iter; left time: 2858.4337s
	iters: 5600, epoch: 7 | loss: 2.2852066
	speed: 0.1147s/iter; left time: 2846.3413s
	iters: 5700, epoch: 7 | loss: 2.1001928
	speed: 0.1147s/iter; left time: 2836.0305s
	iters: 5800, epoch: 7 | loss: 1.9527396
	speed: 0.1147s/iter; left time: 2823.3027s
	iters: 5900, epoch: 7 | loss: 2.0519602
	speed: 0.1147s/iter; left time: 2811.3317s
	iters: 6000, epoch: 7 | loss: 2.4151757
	speed: 0.1146s/iter; left time: 2798.7213s
	iters: 6100, epoch: 7 | loss: 1.9871173
	speed: 0.1146s/iter; left time: 2787.2732s
	iters: 6200, epoch: 7 | loss: 2.2177498
	speed: 0.1146s/iter; left time: 2774.9207s
	iters: 6300, epoch: 7 | loss: 2.1803901
	speed: 0.1147s/iter; left time: 2765.5249s
	iters: 6400, epoch: 7 | loss: 2.1754625
	speed: 0.1147s/iter; left time: 2755.0890s
	iters: 6500, epoch: 7 | loss: 2.5480523
	speed: 0.1147s/iter; left time: 2742.4892s
	iters: 6600, epoch: 7 | loss: 2.2701495
	speed: 0.1147s/iter; left time: 2731.1953s
	iters: 6700, epoch: 7 | loss: 2.1056569
	speed: 0.1146s/iter; left time: 2717.5766s
	iters: 6800, epoch: 7 | loss: 1.7067572
	speed: 0.1147s/iter; left time: 2709.0042s
	iters: 6900, epoch: 7 | loss: 1.8692540
	speed: 0.1147s/iter; left time: 2696.9325s
	iters: 7000, epoch: 7 | loss: 2.2717712
	speed: 0.1147s/iter; left time: 2686.3419s
	iters: 7100, epoch: 7 | loss: 2.2249792
	speed: 0.1147s/iter; left time: 2674.0125s
	iters: 7200, epoch: 7 | loss: 1.9157002
	speed: 0.1146s/iter; left time: 2661.7556s
	iters: 7300, epoch: 7 | loss: 2.3389659
	speed: 0.1147s/iter; left time: 2651.8754s
	iters: 7400, epoch: 7 | loss: 2.2999785
	speed: 0.1147s/iter; left time: 2639.1130s
	iters: 7500, epoch: 7 | loss: 2.1121075
	speed: 0.1147s/iter; left time: 2627.6285s
	iters: 7600, epoch: 7 | loss: 2.6852269
	speed: 0.1147s/iter; left time: 2617.0921s
Epoch: 7 cost time: 872.7046911716461
Epoch: 7, Steps: 7604 | Train Loss: 2.1036526 Vali Loss: 1.9102679 Test Loss: 2.0142653
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 300299
test shape: (30029, 1, 96, 822) (30029, 1, 96, 822)
test shape: (30029, 96, 822) (30029, 96, 822)
mse:2.0141756534576416, mae:1.1931257247924805
>>>>>>>Overall time: 8771 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
