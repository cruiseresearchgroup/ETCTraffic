Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=822, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems04_all_common_flow.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems04_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1163600
val 247261
test 247259
	iters: 100, epoch: 1 | loss: 1.6272231
	speed: 0.1423s/iter; left time: 10331.4609s
	iters: 200, epoch: 1 | loss: 1.5940254
	speed: 0.1338s/iter; left time: 9703.7646s
	iters: 300, epoch: 1 | loss: 1.4906265
	speed: 0.1338s/iter; left time: 9692.8897s
	iters: 400, epoch: 1 | loss: 1.7528027
	speed: 0.1339s/iter; left time: 9680.2640s
	iters: 500, epoch: 1 | loss: 1.6518377
	speed: 0.1338s/iter; left time: 9665.2170s
	iters: 600, epoch: 1 | loss: 1.7707584
	speed: 0.1339s/iter; left time: 9654.3319s
	iters: 700, epoch: 1 | loss: 1.6666052
	speed: 0.1339s/iter; left time: 9641.7235s
	iters: 800, epoch: 1 | loss: 1.2553711
	speed: 0.1339s/iter; left time: 9631.9617s
	iters: 900, epoch: 1 | loss: 1.3102118
	speed: 0.1338s/iter; left time: 9611.3893s
	iters: 1000, epoch: 1 | loss: 1.4528116
	speed: 0.1339s/iter; left time: 9604.0591s
	iters: 1100, epoch: 1 | loss: 1.6448785
	speed: 0.1338s/iter; left time: 9585.1961s
	iters: 1200, epoch: 1 | loss: 1.6431985
	speed: 0.1339s/iter; left time: 9573.2770s
	iters: 1300, epoch: 1 | loss: 1.5409795
	speed: 0.1339s/iter; left time: 9559.7116s
	iters: 1400, epoch: 1 | loss: 1.3195459
	speed: 0.1339s/iter; left time: 9547.8767s
	iters: 1500, epoch: 1 | loss: 1.7898809
	speed: 0.1339s/iter; left time: 9533.6162s
	iters: 1600, epoch: 1 | loss: 1.6211252
	speed: 0.1339s/iter; left time: 9521.1467s
	iters: 1700, epoch: 1 | loss: 1.5068148
	speed: 0.1340s/iter; left time: 9515.3260s
	iters: 1800, epoch: 1 | loss: 1.6088501
	speed: 0.1338s/iter; left time: 9492.1910s
	iters: 1900, epoch: 1 | loss: 1.2348353
	speed: 0.1338s/iter; left time: 9477.0089s
	iters: 2000, epoch: 1 | loss: 1.5006546
	speed: 0.1339s/iter; left time: 9470.6607s
	iters: 2100, epoch: 1 | loss: 1.5257608
	speed: 0.1339s/iter; left time: 9455.8905s
	iters: 2200, epoch: 1 | loss: 1.5929270
	speed: 0.1338s/iter; left time: 9437.3857s
	iters: 2300, epoch: 1 | loss: 1.6058943
	speed: 0.1338s/iter; left time: 9422.1145s
	iters: 2400, epoch: 1 | loss: 1.5139989
	speed: 0.1338s/iter; left time: 9406.3039s
	iters: 2500, epoch: 1 | loss: 1.8198212
	speed: 0.1336s/iter; left time: 9382.5595s
	iters: 2600, epoch: 1 | loss: 1.7012615
	speed: 0.1335s/iter; left time: 9358.2522s
	iters: 2700, epoch: 1 | loss: 1.9883207
	speed: 0.1338s/iter; left time: 9366.4266s
	iters: 2800, epoch: 1 | loss: 1.5092232
	speed: 0.1337s/iter; left time: 9348.9401s
	iters: 2900, epoch: 1 | loss: 1.7881137
	speed: 0.1338s/iter; left time: 9339.6523s
	iters: 3000, epoch: 1 | loss: 1.9356138
	speed: 0.1337s/iter; left time: 9321.2545s
	iters: 3100, epoch: 1 | loss: 1.9432709
	speed: 0.1338s/iter; left time: 9312.9679s
	iters: 3200, epoch: 1 | loss: 1.5069181
	speed: 0.1337s/iter; left time: 9297.4503s
	iters: 3300, epoch: 1 | loss: 1.6665267
	speed: 0.1337s/iter; left time: 9280.9219s
	iters: 3400, epoch: 1 | loss: 1.6956162
	speed: 0.1337s/iter; left time: 9268.0165s
	iters: 3500, epoch: 1 | loss: 1.6339490
	speed: 0.1338s/iter; left time: 9258.3272s
	iters: 3600, epoch: 1 | loss: 1.4838009
	speed: 0.1337s/iter; left time: 9244.2698s
	iters: 3700, epoch: 1 | loss: 1.5893949
	speed: 0.1337s/iter; left time: 9225.1049s
	iters: 3800, epoch: 1 | loss: 1.7286494
	speed: 0.1337s/iter; left time: 9214.8982s
	iters: 3900, epoch: 1 | loss: 1.5994037
	speed: 0.1337s/iter; left time: 9202.6811s
	iters: 4000, epoch: 1 | loss: 1.7639730
	speed: 0.1339s/iter; left time: 9199.4434s
	iters: 4100, epoch: 1 | loss: 1.5729100
	speed: 0.1334s/iter; left time: 9151.8106s
	iters: 4200, epoch: 1 | loss: 1.5311520
	speed: 0.1336s/iter; left time: 9157.0553s
	iters: 4300, epoch: 1 | loss: 1.8623269
	speed: 0.1337s/iter; left time: 9146.8395s
	iters: 4400, epoch: 1 | loss: 1.6344308
	speed: 0.1338s/iter; left time: 9143.3407s
	iters: 4500, epoch: 1 | loss: 1.5362231
	speed: 0.1337s/iter; left time: 9118.1504s
	iters: 4600, epoch: 1 | loss: 1.8235743
	speed: 0.1337s/iter; left time: 9106.9144s
	iters: 4700, epoch: 1 | loss: 1.7955791
	speed: 0.1337s/iter; left time: 9093.1905s
	iters: 4800, epoch: 1 | loss: 1.5003673
	speed: 0.1338s/iter; left time: 9087.2545s
	iters: 4900, epoch: 1 | loss: 1.6593014
	speed: 0.1336s/iter; left time: 9060.9901s
	iters: 5000, epoch: 1 | loss: 1.5517623
	speed: 0.1336s/iter; left time: 9050.7922s
	iters: 5100, epoch: 1 | loss: 1.7458812
	speed: 0.1337s/iter; left time: 9039.3509s
	iters: 5200, epoch: 1 | loss: 1.5709221
	speed: 0.1336s/iter; left time: 9023.5683s
	iters: 5300, epoch: 1 | loss: 1.8766150
	speed: 0.1336s/iter; left time: 9009.8260s
	iters: 5400, epoch: 1 | loss: 1.4542246
	speed: 0.1337s/iter; left time: 8998.4773s
	iters: 5500, epoch: 1 | loss: 1.5500007
	speed: 0.1338s/iter; left time: 8991.1750s
	iters: 5600, epoch: 1 | loss: 1.5982631
	speed: 0.1336s/iter; left time: 8965.2005s
	iters: 5700, epoch: 1 | loss: 1.5486904
	speed: 0.1336s/iter; left time: 8951.3362s
	iters: 5800, epoch: 1 | loss: 1.5972822
	speed: 0.1334s/iter; left time: 8927.9543s
	iters: 5900, epoch: 1 | loss: 1.6814317
	speed: 0.1337s/iter; left time: 8930.8505s
	iters: 6000, epoch: 1 | loss: 1.8263426
	speed: 0.1336s/iter; left time: 8911.0752s
	iters: 6100, epoch: 1 | loss: 1.6225621
	speed: 0.1336s/iter; left time: 8899.3237s
	iters: 6200, epoch: 1 | loss: 1.6468874
	speed: 0.1335s/iter; left time: 8883.8245s
	iters: 6300, epoch: 1 | loss: 1.8109698
	speed: 0.1337s/iter; left time: 8878.3198s
	iters: 6400, epoch: 1 | loss: 1.6537073
	speed: 0.1336s/iter; left time: 8857.6740s
	iters: 6500, epoch: 1 | loss: 1.6353176
	speed: 0.1336s/iter; left time: 8847.1129s
	iters: 6600, epoch: 1 | loss: 1.7789221
	speed: 0.1335s/iter; left time: 8830.2652s
	iters: 6700, epoch: 1 | loss: 1.7449726
	speed: 0.1337s/iter; left time: 8825.9993s
	iters: 6800, epoch: 1 | loss: 1.6370486
	speed: 0.1336s/iter; left time: 8804.0215s
	iters: 6900, epoch: 1 | loss: 1.8006345
	speed: 0.1336s/iter; left time: 8792.4538s
	iters: 7000, epoch: 1 | loss: 1.6458191
	speed: 0.1336s/iter; left time: 8781.0711s
	iters: 7100, epoch: 1 | loss: 1.6215855
	speed: 0.1335s/iter; left time: 8762.6703s
	iters: 7200, epoch: 1 | loss: 1.5206811
	speed: 0.1335s/iter; left time: 8749.8779s
Epoch: 1 cost time: 973.4813697338104
Epoch: 1, Steps: 7272 | Train Loss: 1.6251893 Vali Loss: 1.7307369 Test Loss: 1.5706437
Validation loss decreased (inf --> 1.730737).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6771473
	speed: 4.7131s/iter; left time: 307997.2545s
	iters: 200, epoch: 2 | loss: 1.7745501
	speed: 0.1333s/iter; left time: 8695.8473s
	iters: 300, epoch: 2 | loss: 1.6489679
	speed: 0.1332s/iter; left time: 8679.3011s
	iters: 400, epoch: 2 | loss: 1.6357839
	speed: 0.1331s/iter; left time: 8658.0188s
	iters: 500, epoch: 2 | loss: 1.7367084
	speed: 0.1331s/iter; left time: 8646.0411s
	iters: 600, epoch: 2 | loss: 1.8849317
	speed: 0.1331s/iter; left time: 8633.6057s
	iters: 700, epoch: 2 | loss: 1.5708324
	speed: 0.1331s/iter; left time: 8615.0536s
	iters: 800, epoch: 2 | loss: 1.7128615
	speed: 0.1331s/iter; left time: 8602.1636s
	iters: 900, epoch: 2 | loss: 1.6387062
	speed: 0.1332s/iter; left time: 8595.6426s
	iters: 1000, epoch: 2 | loss: 1.6232961
	speed: 0.1332s/iter; left time: 8584.0193s
	iters: 1100, epoch: 2 | loss: 1.8260201
	speed: 0.1331s/iter; left time: 8565.3525s
	iters: 1200, epoch: 2 | loss: 1.6851532
	speed: 0.1331s/iter; left time: 8553.5184s
	iters: 1300, epoch: 2 | loss: 1.6942605
	speed: 0.1332s/iter; left time: 8541.4853s
	iters: 1400, epoch: 2 | loss: 1.6099924
	speed: 0.1333s/iter; left time: 8538.7264s
	iters: 1500, epoch: 2 | loss: 1.8226758
	speed: 0.1331s/iter; left time: 8511.5083s
	iters: 1600, epoch: 2 | loss: 1.7826668
	speed: 0.1332s/iter; left time: 8501.7182s
	iters: 1700, epoch: 2 | loss: 1.5088642
	speed: 0.1331s/iter; left time: 8485.7401s
	iters: 1800, epoch: 2 | loss: 1.7833987
	speed: 0.1333s/iter; left time: 8481.8451s
	iters: 1900, epoch: 2 | loss: 1.5117401
	speed: 0.1331s/iter; left time: 8458.7914s
	iters: 2000, epoch: 2 | loss: 1.9071907
	speed: 0.1331s/iter; left time: 8447.5152s
	iters: 2100, epoch: 2 | loss: 1.6396767
	speed: 0.1332s/iter; left time: 8437.3533s
	iters: 2200, epoch: 2 | loss: 1.5991145
	speed: 0.1331s/iter; left time: 8420.0727s
	iters: 2300, epoch: 2 | loss: 1.6669220
	speed: 0.1332s/iter; left time: 8410.7175s
	iters: 2400, epoch: 2 | loss: 1.6340578
	speed: 0.1332s/iter; left time: 8398.6362s
	iters: 2500, epoch: 2 | loss: 1.9590029
	speed: 0.1333s/iter; left time: 8389.3996s
	iters: 2600, epoch: 2 | loss: 1.6650805
	speed: 0.1331s/iter; left time: 8365.5503s
	iters: 2700, epoch: 2 | loss: 1.6814073
	speed: 0.1331s/iter; left time: 8352.3528s
	iters: 2800, epoch: 2 | loss: 1.6761582
	speed: 0.1331s/iter; left time: 8339.1980s
	iters: 2900, epoch: 2 | loss: 1.6349262
	speed: 0.1333s/iter; left time: 8337.7448s
	iters: 3000, epoch: 2 | loss: 1.7194557
	speed: 0.1332s/iter; left time: 8317.1194s
	iters: 3100, epoch: 2 | loss: 1.7999011
	speed: 0.1332s/iter; left time: 8307.5386s
	iters: 3200, epoch: 2 | loss: 1.6463869
	speed: 0.1333s/iter; left time: 8300.8944s
	iters: 3300, epoch: 2 | loss: 1.9744735
	speed: 0.1331s/iter; left time: 8274.1986s
	iters: 3400, epoch: 2 | loss: 1.6382529
	speed: 0.1332s/iter; left time: 8262.5639s
	iters: 3500, epoch: 2 | loss: 1.5545462
	speed: 0.1332s/iter; left time: 8252.0931s
	iters: 3600, epoch: 2 | loss: 1.6665974
	speed: 0.1333s/iter; left time: 8245.0664s
	iters: 3700, epoch: 2 | loss: 1.5709521
	speed: 0.1331s/iter; left time: 8216.5703s
	iters: 3800, epoch: 2 | loss: 1.8222682
	speed: 0.1331s/iter; left time: 8202.8478s
	iters: 3900, epoch: 2 | loss: 1.5096079
	speed: 0.1331s/iter; left time: 8191.1728s
	iters: 4000, epoch: 2 | loss: 1.4468423
	speed: 0.1332s/iter; left time: 8185.4136s
	iters: 4100, epoch: 2 | loss: 1.7099457
	speed: 0.1330s/iter; left time: 8159.1244s
	iters: 4200, epoch: 2 | loss: 1.4737763
	speed: 0.1331s/iter; left time: 8150.6759s
	iters: 4300, epoch: 2 | loss: 1.7560964
	speed: 0.1331s/iter; left time: 8136.1753s
	iters: 4400, epoch: 2 | loss: 1.5558325
	speed: 0.1332s/iter; left time: 8130.3958s
	iters: 4500, epoch: 2 | loss: 1.7240350
	speed: 0.1330s/iter; left time: 8103.5057s
	iters: 4600, epoch: 2 | loss: 1.5543666
	speed: 0.1330s/iter; left time: 8093.8632s
	iters: 4700, epoch: 2 | loss: 1.8978698
	speed: 0.1330s/iter; left time: 8076.8064s
	iters: 4800, epoch: 2 | loss: 1.6622413
	speed: 0.1331s/iter; left time: 8070.3459s
	iters: 4900, epoch: 2 | loss: 1.7092315
	speed: 0.1329s/iter; left time: 8049.6900s
	iters: 5000, epoch: 2 | loss: 1.4482476
	speed: 0.1330s/iter; left time: 8038.0743s
	iters: 5100, epoch: 2 | loss: 1.7081326
	speed: 0.1331s/iter; left time: 8034.6766s
	iters: 5200, epoch: 2 | loss: 1.5731229
	speed: 0.1333s/iter; left time: 8029.5462s
	iters: 5300, epoch: 2 | loss: 1.6898832
	speed: 0.1332s/iter; left time: 8011.5181s
	iters: 5400, epoch: 2 | loss: 1.5383112
	speed: 0.1330s/iter; left time: 7986.7382s
	iters: 5500, epoch: 2 | loss: 1.6023854
	speed: 0.1330s/iter; left time: 7974.4011s
	iters: 5600, epoch: 2 | loss: 1.6303155
	speed: 0.1329s/iter; left time: 7955.1285s
	iters: 5700, epoch: 2 | loss: 1.6709787
	speed: 0.1330s/iter; left time: 7945.3393s
	iters: 5800, epoch: 2 | loss: 1.4198433
	speed: 0.1329s/iter; left time: 7928.1441s
	iters: 5900, epoch: 2 | loss: 1.7649971
	speed: 0.1330s/iter; left time: 7919.9298s
	iters: 6000, epoch: 2 | loss: 1.7829925
	speed: 0.1332s/iter; left time: 7920.5530s
	iters: 6100, epoch: 2 | loss: 1.4577913
	speed: 0.1334s/iter; left time: 7914.7628s
	iters: 6200, epoch: 2 | loss: 1.6750350
	speed: 0.1335s/iter; left time: 7907.6628s
	iters: 6300, epoch: 2 | loss: 1.7938459
	speed: 0.1333s/iter; left time: 7882.7715s
	iters: 6400, epoch: 2 | loss: 1.7712029
	speed: 0.1333s/iter; left time: 7868.8295s
	iters: 6500, epoch: 2 | loss: 1.9681379
	speed: 0.1333s/iter; left time: 7858.3648s
	iters: 6600, epoch: 2 | loss: 1.6535329
	speed: 0.1333s/iter; left time: 7845.2853s
	iters: 6700, epoch: 2 | loss: 1.6812215
	speed: 0.1332s/iter; left time: 7826.9389s
	iters: 6800, epoch: 2 | loss: 1.7433441
	speed: 0.1333s/iter; left time: 7818.0820s
	iters: 6900, epoch: 2 | loss: 1.7199669
	speed: 0.1331s/iter; left time: 7789.9922s
	iters: 7000, epoch: 2 | loss: 1.8508892
	speed: 0.1334s/iter; left time: 7795.1568s
	iters: 7100, epoch: 2 | loss: 1.6966295
	speed: 0.1332s/iter; left time: 7770.9695s
	iters: 7200, epoch: 2 | loss: 1.4327559
	speed: 0.1334s/iter; left time: 7767.6003s
Epoch: 2 cost time: 968.8483734130859
Epoch: 2, Steps: 7272 | Train Loss: 1.6647799 Vali Loss: 1.7338667 Test Loss: 1.5696452
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.5436898
	speed: 4.7478s/iter; left time: 275736.7672s
	iters: 200, epoch: 3 | loss: 1.6484495
	speed: 0.1333s/iter; left time: 7728.9825s
	iters: 300, epoch: 3 | loss: 1.5460792
	speed: 0.1334s/iter; left time: 7718.7804s
	iters: 400, epoch: 3 | loss: 1.4095484
	speed: 0.1333s/iter; left time: 7703.1169s
	iters: 500, epoch: 3 | loss: 1.6700771
	speed: 0.1332s/iter; left time: 7683.0300s
	iters: 600, epoch: 3 | loss: 1.6610140
	speed: 0.1330s/iter; left time: 7660.5919s
	iters: 700, epoch: 3 | loss: 1.4752680
	speed: 0.1331s/iter; left time: 7648.1108s
	iters: 800, epoch: 3 | loss: 1.6648929
	speed: 0.1330s/iter; left time: 7633.2208s
	iters: 900, epoch: 3 | loss: 1.8941969
	speed: 0.1332s/iter; left time: 7629.6612s
	iters: 1000, epoch: 3 | loss: 1.6155361
	speed: 0.1332s/iter; left time: 7615.8335s
	iters: 1100, epoch: 3 | loss: 1.5701087
	speed: 0.1333s/iter; left time: 7605.6110s
	iters: 1200, epoch: 3 | loss: 1.7908719
	speed: 0.1332s/iter; left time: 7590.2663s
	iters: 1300, epoch: 3 | loss: 1.6010790
	speed: 0.1332s/iter; left time: 7576.8905s
	iters: 1400, epoch: 3 | loss: 1.9652097
	speed: 0.1332s/iter; left time: 7563.3079s
	iters: 1500, epoch: 3 | loss: 1.7652513
	speed: 0.1332s/iter; left time: 7549.9539s
	iters: 1600, epoch: 3 | loss: 1.6732039
	speed: 0.1333s/iter; left time: 7543.2654s
	iters: 1700, epoch: 3 | loss: 1.6955336
	speed: 0.1330s/iter; left time: 7513.2597s
	iters: 1800, epoch: 3 | loss: 1.6738113
	speed: 0.1330s/iter; left time: 7498.5523s
	iters: 1900, epoch: 3 | loss: 1.8976715
	speed: 0.1330s/iter; left time: 7487.4140s
	iters: 2000, epoch: 3 | loss: 1.9326879
	speed: 0.1332s/iter; left time: 7481.9606s
	iters: 2100, epoch: 3 | loss: 1.5426340
	speed: 0.1330s/iter; left time: 7457.7591s
	iters: 2200, epoch: 3 | loss: 1.5437534
	speed: 0.1331s/iter; left time: 7448.5356s
	iters: 2300, epoch: 3 | loss: 1.5346702
	speed: 0.1330s/iter; left time: 7432.1701s
	iters: 2400, epoch: 3 | loss: 1.7195092
	speed: 0.1331s/iter; left time: 7421.9951s
	iters: 2500, epoch: 3 | loss: 1.7458436
	speed: 0.1331s/iter; left time: 7411.6830s
	iters: 2600, epoch: 3 | loss: 1.6009052
	speed: 0.1333s/iter; left time: 7407.8031s
	iters: 2700, epoch: 3 | loss: 1.5228282
	speed: 0.1334s/iter; left time: 7400.3347s
	iters: 2800, epoch: 3 | loss: 1.5784699
	speed: 0.1332s/iter; left time: 7375.0067s
	iters: 2900, epoch: 3 | loss: 1.5729499
	speed: 0.1332s/iter; left time: 7360.6792s
	iters: 3000, epoch: 3 | loss: 1.4692333
	speed: 0.1332s/iter; left time: 7348.5092s
	iters: 3100, epoch: 3 | loss: 1.9369521
	speed: 0.1333s/iter; left time: 7343.8660s
	iters: 3200, epoch: 3 | loss: 1.5407122
	speed: 0.1331s/iter; left time: 7319.3328s
	iters: 3300, epoch: 3 | loss: 1.7592372
	speed: 0.1332s/iter; left time: 7307.5075s
	iters: 3400, epoch: 3 | loss: 1.6159965
	speed: 0.1331s/iter; left time: 7289.9426s
	iters: 3500, epoch: 3 | loss: 1.6615282
	speed: 0.1333s/iter; left time: 7287.8212s
	iters: 3600, epoch: 3 | loss: 1.5278033
	speed: 0.1331s/iter; left time: 7262.5422s
	iters: 3700, epoch: 3 | loss: 1.6414460
	speed: 0.1331s/iter; left time: 7251.8408s
	iters: 3800, epoch: 3 | loss: 1.5729754
	speed: 0.1332s/iter; left time: 7242.8101s
	iters: 3900, epoch: 3 | loss: 1.6576391
	speed: 0.1331s/iter; left time: 7226.1026s
	iters: 4000, epoch: 3 | loss: 1.6737280
	speed: 0.1331s/iter; left time: 7208.6333s
	iters: 4100, epoch: 3 | loss: 1.8582480
	speed: 0.1332s/iter; left time: 7201.7615s
	iters: 4200, epoch: 3 | loss: 1.6411356
	speed: 0.1332s/iter; left time: 7191.9603s
	iters: 4300, epoch: 3 | loss: 1.7988173
	speed: 0.1330s/iter; left time: 7168.1053s
	iters: 4400, epoch: 3 | loss: 1.7165247
	speed: 0.1331s/iter; left time: 7155.2990s
	iters: 4500, epoch: 3 | loss: 1.6427693
	speed: 0.1331s/iter; left time: 7143.1294s
	iters: 4600, epoch: 3 | loss: 1.5560244
	speed: 0.1332s/iter; left time: 7137.4032s
	iters: 4700, epoch: 3 | loss: 1.6005937
	speed: 0.1332s/iter; left time: 7121.4030s
	iters: 4800, epoch: 3 | loss: 1.5548222
	speed: 0.1332s/iter; left time: 7112.1185s
	iters: 4900, epoch: 3 | loss: 1.7752484
	speed: 0.1332s/iter; left time: 7095.2345s
	iters: 5000, epoch: 3 | loss: 1.5919485
	speed: 0.1333s/iter; left time: 7086.1981s
	iters: 5100, epoch: 3 | loss: 1.6724670
	speed: 0.1332s/iter; left time: 7067.9060s
	iters: 5200, epoch: 3 | loss: 1.8207446
	speed: 0.1332s/iter; left time: 7056.1631s
	iters: 5300, epoch: 3 | loss: 1.8327527
	speed: 0.1332s/iter; left time: 7043.9834s
	iters: 5400, epoch: 3 | loss: 1.5581545
	speed: 0.1332s/iter; left time: 7027.2840s
	iters: 5500, epoch: 3 | loss: 1.7883846
	speed: 0.1332s/iter; left time: 7014.7874s
	iters: 5600, epoch: 3 | loss: 1.6574231
	speed: 0.1332s/iter; left time: 7004.4425s
	iters: 5700, epoch: 3 | loss: 1.6570007
	speed: 0.1332s/iter; left time: 6988.2289s
	iters: 5800, epoch: 3 | loss: 1.6755149
	speed: 0.1330s/iter; left time: 6968.3111s
	iters: 5900, epoch: 3 | loss: 1.6818452
	speed: 0.1330s/iter; left time: 6955.4518s
	iters: 6000, epoch: 3 | loss: 1.5715328
	speed: 0.1331s/iter; left time: 6946.2989s
	iters: 6100, epoch: 3 | loss: 1.7938210
	speed: 0.1331s/iter; left time: 6932.6751s
	iters: 6200, epoch: 3 | loss: 1.7381746
	speed: 0.1330s/iter; left time: 6914.2992s
	iters: 6300, epoch: 3 | loss: 1.6157959
	speed: 0.1330s/iter; left time: 6900.7086s
	iters: 6400, epoch: 3 | loss: 1.6535094
	speed: 0.1330s/iter; left time: 6888.0690s
	iters: 6500, epoch: 3 | loss: 1.7328498
	speed: 0.1330s/iter; left time: 6875.3761s
	iters: 6600, epoch: 3 | loss: 1.7705539
	speed: 0.1330s/iter; left time: 6858.1891s
	iters: 6700, epoch: 3 | loss: 1.4701641
	speed: 0.1330s/iter; left time: 6847.2960s
	iters: 6800, epoch: 3 | loss: 1.6814240
	speed: 0.1331s/iter; left time: 6837.9157s
	iters: 6900, epoch: 3 | loss: 1.8536408
	speed: 0.1330s/iter; left time: 6819.7946s
	iters: 7000, epoch: 3 | loss: 1.4925978
	speed: 0.1330s/iter; left time: 6804.3214s
	iters: 7100, epoch: 3 | loss: 1.6594625
	speed: 0.1330s/iter; left time: 6793.2260s
	iters: 7200, epoch: 3 | loss: 1.7855194
	speed: 0.1331s/iter; left time: 6786.0393s
Epoch: 3 cost time: 968.7944891452789
Epoch: 3, Steps: 7272 | Train Loss: 1.6645033 Vali Loss: 1.7316035 Test Loss: 1.5692334
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.5252994
	speed: 4.7740s/iter; left time: 242541.2350s
	iters: 200, epoch: 4 | loss: 1.7106743
	speed: 0.1335s/iter; left time: 6768.9344s
	iters: 300, epoch: 4 | loss: 1.4580712
	speed: 0.1335s/iter; left time: 6758.2718s
	iters: 400, epoch: 4 | loss: 1.6652943
	speed: 0.1336s/iter; left time: 6746.8312s
	iters: 500, epoch: 4 | loss: 1.5191841
	speed: 0.1335s/iter; left time: 6729.6767s
	iters: 600, epoch: 4 | loss: 1.5104276
	speed: 0.1335s/iter; left time: 6718.2154s
	iters: 700, epoch: 4 | loss: 1.6371602
	speed: 0.1336s/iter; left time: 6705.5490s
	iters: 800, epoch: 4 | loss: 1.5509899
	speed: 0.1334s/iter; left time: 6683.5951s
	iters: 900, epoch: 4 | loss: 1.4694854
	speed: 0.1333s/iter; left time: 6668.1547s
	iters: 1000, epoch: 4 | loss: 1.4819628
	speed: 0.1334s/iter; left time: 6655.3134s
	iters: 1100, epoch: 4 | loss: 1.8950219
	speed: 0.1334s/iter; left time: 6646.1519s
	iters: 1200, epoch: 4 | loss: 1.6469401
	speed: 0.1333s/iter; left time: 6626.7154s
	iters: 1300, epoch: 4 | loss: 1.4845622
	speed: 0.1335s/iter; left time: 6623.2668s
	iters: 1400, epoch: 4 | loss: 1.6534849
	speed: 0.1336s/iter; left time: 6614.8285s
	iters: 1500, epoch: 4 | loss: 1.7012917
	speed: 0.1336s/iter; left time: 6600.8674s
	iters: 1600, epoch: 4 | loss: 1.7378151
	speed: 0.1335s/iter; left time: 6584.1457s
	iters: 1700, epoch: 4 | loss: 1.6320139
	speed: 0.1336s/iter; left time: 6572.8277s
	iters: 1800, epoch: 4 | loss: 1.7875521
	speed: 0.1337s/iter; left time: 6565.7912s
	iters: 1900, epoch: 4 | loss: 1.8114974
	speed: 0.1335s/iter; left time: 6542.7481s
	iters: 2000, epoch: 4 | loss: 1.6236428
	speed: 0.1335s/iter; left time: 6530.1030s
	iters: 2100, epoch: 4 | loss: 1.5432321
	speed: 0.1335s/iter; left time: 6516.9524s
	iters: 2200, epoch: 4 | loss: 1.5379782
	speed: 0.1335s/iter; left time: 6503.8390s
	iters: 2300, epoch: 4 | loss: 1.4835230
	speed: 0.1334s/iter; left time: 6484.1664s
	iters: 2400, epoch: 4 | loss: 1.6187056
	speed: 0.1336s/iter; left time: 6481.0248s
	iters: 2500, epoch: 4 | loss: 1.7810223
	speed: 0.1336s/iter; left time: 6467.4694s
	iters: 2600, epoch: 4 | loss: 1.4653851
	speed: 0.1337s/iter; left time: 6456.0668s
	iters: 2700, epoch: 4 | loss: 1.8205457
	speed: 0.1335s/iter; left time: 6436.7002s
	iters: 2800, epoch: 4 | loss: 1.5005381
	speed: 0.1335s/iter; left time: 6423.8642s
	iters: 2900, epoch: 4 | loss: 1.7540652
	speed: 0.1336s/iter; left time: 6412.7467s
	iters: 3000, epoch: 4 | loss: 1.6671512
	speed: 0.1335s/iter; left time: 6395.6415s
	iters: 3100, epoch: 4 | loss: 1.5344247
	speed: 0.1335s/iter; left time: 6381.1626s
	iters: 3200, epoch: 4 | loss: 1.6926427
	speed: 0.1334s/iter; left time: 6365.1213s
	iters: 3300, epoch: 4 | loss: 1.7080743
	speed: 0.1335s/iter; left time: 6357.3027s
	iters: 3400, epoch: 4 | loss: 1.5594665
	speed: 0.1333s/iter; left time: 6334.2725s
	iters: 3500, epoch: 4 | loss: 1.5953062
	speed: 0.1334s/iter; left time: 6323.7831s
	iters: 3600, epoch: 4 | loss: 1.6997564
	speed: 0.1334s/iter; left time: 6308.2330s
	iters: 3700, epoch: 4 | loss: 1.7834625
	speed: 0.1335s/iter; left time: 6302.4314s
	iters: 3800, epoch: 4 | loss: 1.7506725
	speed: 0.1333s/iter; left time: 6280.7615s
	iters: 3900, epoch: 4 | loss: 1.6384801
	speed: 0.1334s/iter; left time: 6272.3014s
	iters: 4000, epoch: 4 | loss: 1.7355803
	speed: 0.1334s/iter; left time: 6255.9206s
	iters: 4100, epoch: 4 | loss: 1.5837429
	speed: 0.1334s/iter; left time: 6246.0837s
	iters: 4200, epoch: 4 | loss: 1.7136816
	speed: 0.1333s/iter; left time: 6225.5183s
	iters: 4300, epoch: 4 | loss: 1.8006847
	speed: 0.1334s/iter; left time: 6217.0205s
	iters: 4400, epoch: 4 | loss: 1.7469785
	speed: 0.1334s/iter; left time: 6201.8151s
	iters: 4500, epoch: 4 | loss: 1.6000100
	speed: 0.1333s/iter; left time: 6185.4219s
	iters: 4600, epoch: 4 | loss: 1.8726310
	speed: 0.1333s/iter; left time: 6172.4230s
	iters: 4700, epoch: 4 | loss: 1.5551783
	speed: 0.1337s/iter; left time: 6176.3191s
	iters: 4800, epoch: 4 | loss: 1.7842202
	speed: 0.1337s/iter; left time: 6164.2280s
	iters: 4900, epoch: 4 | loss: 1.8075759
	speed: 0.1336s/iter; left time: 6145.0815s
	iters: 5000, epoch: 4 | loss: 1.7118309
	speed: 0.1336s/iter; left time: 6133.5110s
	iters: 5100, epoch: 4 | loss: 1.6933844
	speed: 0.1335s/iter; left time: 6117.0188s
	iters: 5200, epoch: 4 | loss: 1.5482180
	speed: 0.1336s/iter; left time: 6105.9440s
	iters: 5300, epoch: 4 | loss: 1.5468782
	speed: 0.1334s/iter; left time: 6082.7689s
	iters: 5400, epoch: 4 | loss: 1.5038047
	speed: 0.1333s/iter; left time: 6066.6521s
	iters: 5500, epoch: 4 | loss: 1.6818070
	speed: 0.1335s/iter; left time: 6060.1727s
	iters: 5600, epoch: 4 | loss: 1.7060163
	speed: 0.1333s/iter; left time: 6038.6243s
	iters: 5700, epoch: 4 | loss: 1.7404388
	speed: 0.1333s/iter; left time: 6025.1776s
	iters: 5800, epoch: 4 | loss: 1.5935439
	speed: 0.1334s/iter; left time: 6015.0008s
	iters: 5900, epoch: 4 | loss: 1.5599108
	speed: 0.1334s/iter; left time: 6005.3447s
	iters: 6000, epoch: 4 | loss: 1.7304138
	speed: 0.1333s/iter; left time: 5985.1370s
	iters: 6100, epoch: 4 | loss: 1.7974925
	speed: 0.1333s/iter; left time: 5974.1804s
	iters: 6200, epoch: 4 | loss: 1.5338368
	speed: 0.1333s/iter; left time: 5958.6768s
	iters: 6300, epoch: 4 | loss: 1.6821969
	speed: 0.1336s/iter; left time: 5957.9939s
	iters: 6400, epoch: 4 | loss: 1.7041334
	speed: 0.1336s/iter; left time: 5945.9567s
	iters: 6500, epoch: 4 | loss: 1.6675763
	speed: 0.1336s/iter; left time: 5933.6805s
	iters: 6600, epoch: 4 | loss: 1.6622732
	speed: 0.1336s/iter; left time: 5920.3936s
	iters: 6700, epoch: 4 | loss: 1.6831592
	speed: 0.1337s/iter; left time: 5911.2407s
	iters: 6800, epoch: 4 | loss: 2.0342982
	speed: 0.1336s/iter; left time: 5890.3204s
	iters: 6900, epoch: 4 | loss: 1.6343366
	speed: 0.1336s/iter; left time: 5880.2945s
	iters: 7000, epoch: 4 | loss: 1.6980174
	speed: 0.1336s/iter; left time: 5865.8443s
	iters: 7100, epoch: 4 | loss: 1.4933518
	speed: 0.1335s/iter; left time: 5849.6514s
	iters: 7200, epoch: 4 | loss: 1.7306874
	speed: 0.1336s/iter; left time: 5838.9652s
Epoch: 4 cost time: 971.3003134727478
Epoch: 4, Steps: 7272 | Train Loss: 1.6644036 Vali Loss: 1.7336282 Test Loss: 1.5691954
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247259
test shape: (24725, 1, 720, 822) (24725, 1, 720, 822)
test shape: (24725, 720, 822) (24725, 720, 822)
mse:1.5707623958587646, mae:1.0105992555618286
>>>>>>>Overall time: 7143 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
