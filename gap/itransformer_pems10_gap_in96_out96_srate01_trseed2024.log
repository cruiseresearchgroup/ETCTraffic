Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1125501
val 70617
test 246445
	iters: 100, epoch: 1 | loss: 1.6545858
	speed: 0.0326s/iter; left time: 2286.4523s
	iters: 200, epoch: 1 | loss: 1.9704688
	speed: 0.0297s/iter; left time: 2080.7669s
	iters: 300, epoch: 1 | loss: 2.2248330
	speed: 0.0302s/iter; left time: 2112.8175s
	iters: 400, epoch: 1 | loss: 2.2572732
	speed: 0.0312s/iter; left time: 2181.5505s
	iters: 500, epoch: 1 | loss: 1.8995494
	speed: 0.0315s/iter; left time: 2202.1433s
	iters: 600, epoch: 1 | loss: 2.3208828
	speed: 0.0304s/iter; left time: 2121.3828s
	iters: 700, epoch: 1 | loss: 2.1658218
	speed: 0.0304s/iter; left time: 2120.1423s
	iters: 800, epoch: 1 | loss: 2.0524566
	speed: 0.0304s/iter; left time: 2116.7854s
	iters: 900, epoch: 1 | loss: 1.7480844
	speed: 0.0298s/iter; left time: 2071.7659s
	iters: 1000, epoch: 1 | loss: 1.7589275
	speed: 0.0301s/iter; left time: 2083.7383s
	iters: 1100, epoch: 1 | loss: 2.1213541
	speed: 0.0273s/iter; left time: 1891.2784s
	iters: 1200, epoch: 1 | loss: 2.5227568
	speed: 0.0304s/iter; left time: 2099.6273s
	iters: 1300, epoch: 1 | loss: 1.9121375
	speed: 0.0303s/iter; left time: 2090.7293s
	iters: 1400, epoch: 1 | loss: 1.7522230
	speed: 0.0303s/iter; left time: 2086.7987s
	iters: 1500, epoch: 1 | loss: 1.8716141
	speed: 0.0304s/iter; left time: 2094.1758s
	iters: 1600, epoch: 1 | loss: 1.8405107
	speed: 0.0305s/iter; left time: 2097.4822s
	iters: 1700, epoch: 1 | loss: 1.8428870
	speed: 0.0305s/iter; left time: 2091.4539s
	iters: 1800, epoch: 1 | loss: 1.9760324
	speed: 0.0305s/iter; left time: 2093.3236s
	iters: 1900, epoch: 1 | loss: 1.8029361
	speed: 0.0306s/iter; left time: 2092.0887s
	iters: 2000, epoch: 1 | loss: 1.6540532
	speed: 0.0305s/iter; left time: 2086.9276s
	iters: 2100, epoch: 1 | loss: 1.9340236
	speed: 0.0307s/iter; left time: 2097.5724s
	iters: 2200, epoch: 1 | loss: 1.6075730
	speed: 0.0315s/iter; left time: 2145.8819s
	iters: 2300, epoch: 1 | loss: 1.9296207
	speed: 0.0310s/iter; left time: 2112.0787s
	iters: 2400, epoch: 1 | loss: 1.9280123
	speed: 0.0315s/iter; left time: 2142.9240s
	iters: 2500, epoch: 1 | loss: 1.8071200
	speed: 0.0316s/iter; left time: 2145.3789s
	iters: 2600, epoch: 1 | loss: 1.5187148
	speed: 0.0315s/iter; left time: 2133.1056s
	iters: 2700, epoch: 1 | loss: 1.9342345
	speed: 0.0316s/iter; left time: 2138.3555s
	iters: 2800, epoch: 1 | loss: 1.6053989
	speed: 0.0317s/iter; left time: 2140.9778s
	iters: 2900, epoch: 1 | loss: 1.6460710
	speed: 0.0321s/iter; left time: 2161.7972s
	iters: 3000, epoch: 1 | loss: 1.8711491
	speed: 0.0319s/iter; left time: 2145.8393s
	iters: 3100, epoch: 1 | loss: 2.0706801
	speed: 0.0317s/iter; left time: 2134.1628s
	iters: 3200, epoch: 1 | loss: 1.7551364
	speed: 0.0325s/iter; left time: 2183.1987s
	iters: 3300, epoch: 1 | loss: 1.4245067
	speed: 0.0304s/iter; left time: 2040.4260s
	iters: 3400, epoch: 1 | loss: 1.8680092
	speed: 0.0304s/iter; left time: 2036.2075s
	iters: 3500, epoch: 1 | loss: 2.0236013
	speed: 0.0305s/iter; left time: 2041.5314s
	iters: 3600, epoch: 1 | loss: 1.7486126
	speed: 0.0305s/iter; left time: 2037.4410s
	iters: 3700, epoch: 1 | loss: 1.8692880
	speed: 0.0314s/iter; left time: 2095.8574s
	iters: 3800, epoch: 1 | loss: 2.0756819
	speed: 0.0341s/iter; left time: 2267.8347s
	iters: 3900, epoch: 1 | loss: 1.8444831
	speed: 0.0348s/iter; left time: 2313.6539s
	iters: 4000, epoch: 1 | loss: 1.9171275
	speed: 0.0347s/iter; left time: 2300.9882s
	iters: 4100, epoch: 1 | loss: 1.7461247
	speed: 0.0344s/iter; left time: 2276.6015s
	iters: 4200, epoch: 1 | loss: 1.9625194
	speed: 0.0345s/iter; left time: 2281.4334s
	iters: 4300, epoch: 1 | loss: 2.0201941
	speed: 0.0346s/iter; left time: 2287.9046s
	iters: 4400, epoch: 1 | loss: 1.6650219
	speed: 0.0347s/iter; left time: 2288.1493s
	iters: 4500, epoch: 1 | loss: 2.1587973
	speed: 0.0343s/iter; left time: 2260.1219s
	iters: 4600, epoch: 1 | loss: 2.2649646
	speed: 0.0346s/iter; left time: 2272.9952s
	iters: 4700, epoch: 1 | loss: 1.6706173
	speed: 0.0347s/iter; left time: 2275.9013s
	iters: 4800, epoch: 1 | loss: 2.2071671
	speed: 0.0343s/iter; left time: 2248.5398s
	iters: 4900, epoch: 1 | loss: 2.0779645
	speed: 0.0307s/iter; left time: 2010.2257s
	iters: 5000, epoch: 1 | loss: 1.7134918
	speed: 0.0306s/iter; left time: 1997.4176s
	iters: 5100, epoch: 1 | loss: 2.6370652
	speed: 0.0307s/iter; left time: 2001.4872s
	iters: 5200, epoch: 1 | loss: 1.6202425
	speed: 0.0304s/iter; left time: 1983.5253s
	iters: 5300, epoch: 1 | loss: 1.8104042
	speed: 0.0305s/iter; left time: 1981.1594s
	iters: 5400, epoch: 1 | loss: 2.2135043
	speed: 0.0303s/iter; left time: 1969.2481s
	iters: 5500, epoch: 1 | loss: 1.7041161
	speed: 0.0303s/iter; left time: 1967.4971s
	iters: 5600, epoch: 1 | loss: 2.4802458
	speed: 0.0304s/iter; left time: 1965.2395s
	iters: 5700, epoch: 1 | loss: 2.0077605
	speed: 0.0300s/iter; left time: 1940.5466s
	iters: 5800, epoch: 1 | loss: 1.6909586
	speed: 0.0302s/iter; left time: 1948.1020s
	iters: 5900, epoch: 1 | loss: 2.1876280
	speed: 0.0303s/iter; left time: 1950.5147s
	iters: 6000, epoch: 1 | loss: 2.2253466
	speed: 0.0304s/iter; left time: 1953.3599s
	iters: 6100, epoch: 1 | loss: 2.5310678
	speed: 0.0304s/iter; left time: 1954.8420s
	iters: 6200, epoch: 1 | loss: 1.8388504
	speed: 0.0302s/iter; left time: 1936.2205s
	iters: 6300, epoch: 1 | loss: 1.4576880
	speed: 0.0304s/iter; left time: 1945.1648s
	iters: 6400, epoch: 1 | loss: 1.9020406
	speed: 0.0300s/iter; left time: 1919.7615s
	iters: 6500, epoch: 1 | loss: 1.8052076
	speed: 0.0303s/iter; left time: 1934.0120s
	iters: 6600, epoch: 1 | loss: 1.8701544
	speed: 0.0302s/iter; left time: 1924.5118s
	iters: 6700, epoch: 1 | loss: 1.9615272
	speed: 0.0302s/iter; left time: 1922.2750s
	iters: 6800, epoch: 1 | loss: 1.3302178
	speed: 0.0305s/iter; left time: 1938.6761s
	iters: 6900, epoch: 1 | loss: 1.9395561
	speed: 0.0303s/iter; left time: 1924.4875s
	iters: 7000, epoch: 1 | loss: 1.8117361
	speed: 0.0303s/iter; left time: 1922.0099s
Epoch: 1 cost time: 219.9508445262909
Epoch: 1, Steps: 7034 | Train Loss: 1.8928242 Vali Loss: 1.5973562 Test Loss: 0.8757654
Validation loss decreased (inf --> 1.597356).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 2.4432347
	speed: 1.1415s/iter; left time: 72152.6896s
	iters: 200, epoch: 2 | loss: 1.7817128
	speed: 0.0303s/iter; left time: 1915.2260s
	iters: 300, epoch: 2 | loss: 1.9505154
	speed: 0.0298s/iter; left time: 1878.0729s
	iters: 400, epoch: 2 | loss: 1.7059832
	speed: 0.0302s/iter; left time: 1899.0490s
	iters: 500, epoch: 2 | loss: 2.2672646
	speed: 0.0304s/iter; left time: 1910.2378s
	iters: 600, epoch: 2 | loss: 1.6213671
	speed: 0.0304s/iter; left time: 1905.5850s
	iters: 700, epoch: 2 | loss: 2.4479718
	speed: 0.0303s/iter; left time: 1898.5682s
	iters: 800, epoch: 2 | loss: 2.2555315
	speed: 0.0301s/iter; left time: 1881.1038s
	iters: 900, epoch: 2 | loss: 1.9002929
	speed: 0.0303s/iter; left time: 1891.0819s
	iters: 1000, epoch: 2 | loss: 1.5788569
	speed: 0.0304s/iter; left time: 1895.7888s
	iters: 1100, epoch: 2 | loss: 2.0276256
	speed: 0.0302s/iter; left time: 1881.6753s
	iters: 1200, epoch: 2 | loss: 1.9789648
	speed: 0.0305s/iter; left time: 1893.9583s
	iters: 1300, epoch: 2 | loss: 1.7946814
	speed: 0.0302s/iter; left time: 1871.5379s
	iters: 1400, epoch: 2 | loss: 1.6567867
	speed: 0.0302s/iter; left time: 1872.0070s
	iters: 1500, epoch: 2 | loss: 2.3797166
	speed: 0.0303s/iter; left time: 1873.1245s
	iters: 1600, epoch: 2 | loss: 2.3605926
	speed: 0.0300s/iter; left time: 1851.6484s
	iters: 1700, epoch: 2 | loss: 1.7947431
	speed: 0.0307s/iter; left time: 1888.4505s
	iters: 1800, epoch: 2 | loss: 1.7037840
	speed: 0.0305s/iter; left time: 1873.6161s
	iters: 1900, epoch: 2 | loss: 2.0556118
	speed: 0.0303s/iter; left time: 1858.9464s
	iters: 2000, epoch: 2 | loss: 2.1838257
	speed: 0.0302s/iter; left time: 1853.7143s
	iters: 2100, epoch: 2 | loss: 2.1807666
	speed: 0.0298s/iter; left time: 1826.2549s
	iters: 2200, epoch: 2 | loss: 2.0767841
	speed: 0.0300s/iter; left time: 1832.9392s
	iters: 2300, epoch: 2 | loss: 2.0129137
	speed: 0.0304s/iter; left time: 1854.8304s
	iters: 2400, epoch: 2 | loss: 1.7851985
	speed: 0.0297s/iter; left time: 1806.4362s
	iters: 2500, epoch: 2 | loss: 2.2226181
	speed: 0.0301s/iter; left time: 1830.2817s
	iters: 2600, epoch: 2 | loss: 2.2517259
	speed: 0.0299s/iter; left time: 1817.8939s
	iters: 2700, epoch: 2 | loss: 1.7372375
	speed: 0.0300s/iter; left time: 1818.1010s
	iters: 2800, epoch: 2 | loss: 1.9273210
	speed: 0.0296s/iter; left time: 1791.3898s
	iters: 2900, epoch: 2 | loss: 2.1318130
	speed: 0.0301s/iter; left time: 1819.9490s
	iters: 3000, epoch: 2 | loss: 1.9752961
	speed: 0.0304s/iter; left time: 1833.2735s
	iters: 3100, epoch: 2 | loss: 2.0067248
	speed: 0.0303s/iter; left time: 1823.4605s
	iters: 3200, epoch: 2 | loss: 1.8053685
	speed: 0.0304s/iter; left time: 1829.6676s
	iters: 3300, epoch: 2 | loss: 1.7806091
	speed: 0.0305s/iter; left time: 1828.0416s
	iters: 3400, epoch: 2 | loss: 2.2228546
	speed: 0.0298s/iter; left time: 1783.6432s
	iters: 3500, epoch: 2 | loss: 1.7637979
	speed: 0.0303s/iter; left time: 1810.2030s
	iters: 3600, epoch: 2 | loss: 1.9977920
	speed: 0.0301s/iter; left time: 1796.1123s
	iters: 3700, epoch: 2 | loss: 1.8919930
	speed: 0.0304s/iter; left time: 1809.8587s
	iters: 3800, epoch: 2 | loss: 2.0896001
	speed: 0.0304s/iter; left time: 1808.3285s
	iters: 3900, epoch: 2 | loss: 2.2018764
	speed: 0.0303s/iter; left time: 1801.7432s
	iters: 4000, epoch: 2 | loss: 2.2266643
	speed: 0.0304s/iter; left time: 1801.7117s
	iters: 4100, epoch: 2 | loss: 2.3780780
	speed: 0.0304s/iter; left time: 1801.8055s
	iters: 4200, epoch: 2 | loss: 1.8589505
	speed: 0.0304s/iter; left time: 1798.8098s
	iters: 4300, epoch: 2 | loss: 1.7731031
	speed: 0.0303s/iter; left time: 1786.6281s
	iters: 4400, epoch: 2 | loss: 1.9363590
	speed: 0.0303s/iter; left time: 1785.0002s
	iters: 4500, epoch: 2 | loss: 1.9780684
	speed: 0.0305s/iter; left time: 1796.4138s
	iters: 4600, epoch: 2 | loss: 1.8452629
	speed: 0.0302s/iter; left time: 1770.0843s
	iters: 4700, epoch: 2 | loss: 1.7558422
	speed: 0.0305s/iter; left time: 1785.2915s
	iters: 4800, epoch: 2 | loss: 2.2587693
	speed: 0.0301s/iter; left time: 1758.6161s
	iters: 4900, epoch: 2 | loss: 2.0271306
	speed: 0.0306s/iter; left time: 1784.5173s
	iters: 5000, epoch: 2 | loss: 1.7383169
	speed: 0.0305s/iter; left time: 1780.3069s
	iters: 5100, epoch: 2 | loss: 2.0696747
	speed: 0.0303s/iter; left time: 1761.8644s
	iters: 5200, epoch: 2 | loss: 2.5509434
	speed: 0.0300s/iter; left time: 1741.7948s
	iters: 5300, epoch: 2 | loss: 2.5027752
	speed: 0.0303s/iter; left time: 1759.4392s
	iters: 5400, epoch: 2 | loss: 1.8372159
	speed: 0.0301s/iter; left time: 1742.8200s
	iters: 5500, epoch: 2 | loss: 1.7416900
	speed: 0.0300s/iter; left time: 1735.9758s
	iters: 5600, epoch: 2 | loss: 2.0567870
	speed: 0.0303s/iter; left time: 1751.4032s
	iters: 5700, epoch: 2 | loss: 2.1478324
	speed: 0.0304s/iter; left time: 1752.3441s
	iters: 5800, epoch: 2 | loss: 1.8032764
	speed: 0.0304s/iter; left time: 1746.3557s
	iters: 5900, epoch: 2 | loss: 1.6003975
	speed: 0.0299s/iter; left time: 1717.0766s
	iters: 6000, epoch: 2 | loss: 1.9275628
	speed: 0.0301s/iter; left time: 1725.1896s
	iters: 6100, epoch: 2 | loss: 2.2759075
	speed: 0.0303s/iter; left time: 1732.7295s
	iters: 6200, epoch: 2 | loss: 2.2407091
	speed: 0.0303s/iter; left time: 1730.4997s
	iters: 6300, epoch: 2 | loss: 2.2983739
	speed: 0.0301s/iter; left time: 1716.5492s
	iters: 6400, epoch: 2 | loss: 1.4986873
	speed: 0.0304s/iter; left time: 1732.5200s
	iters: 6500, epoch: 2 | loss: 1.6545174
	speed: 0.0304s/iter; left time: 1726.9172s
	iters: 6600, epoch: 2 | loss: 2.1116035
	speed: 0.0303s/iter; left time: 1718.3417s
	iters: 6700, epoch: 2 | loss: 2.0971003
	speed: 0.0304s/iter; left time: 1719.6387s
	iters: 6800, epoch: 2 | loss: 2.0952687
	speed: 0.0254s/iter; left time: 1432.7397s
	iters: 6900, epoch: 2 | loss: 2.1790874
	speed: 0.0295s/iter; left time: 1666.4254s
	iters: 7000, epoch: 2 | loss: 1.6409261
	speed: 0.0305s/iter; left time: 1715.9155s
Epoch: 2 cost time: 212.38368225097656
Epoch: 2, Steps: 7034 | Train Loss: 1.9525840 Vali Loss: 1.5638014 Test Loss: 0.8816756
Validation loss decreased (1.597356 --> 1.563801).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6519837
	speed: 1.0582s/iter; left time: 59441.2916s
	iters: 200, epoch: 3 | loss: 1.9922007
	speed: 0.0302s/iter; left time: 1691.5951s
	iters: 300, epoch: 3 | loss: 1.9435784
	speed: 0.0305s/iter; left time: 1708.7437s
	iters: 400, epoch: 3 | loss: 1.8360705
	speed: 0.0301s/iter; left time: 1680.5267s
	iters: 500, epoch: 3 | loss: 1.7037332
	speed: 0.0301s/iter; left time: 1676.7388s
	iters: 600, epoch: 3 | loss: 2.1117842
	speed: 0.0303s/iter; left time: 1689.4103s
	iters: 700, epoch: 3 | loss: 1.6480401
	speed: 0.0304s/iter; left time: 1688.7611s
	iters: 800, epoch: 3 | loss: 1.9829924
	speed: 0.0303s/iter; left time: 1681.6383s
	iters: 900, epoch: 3 | loss: 1.6458918
	speed: 0.0302s/iter; left time: 1672.4585s
	iters: 1000, epoch: 3 | loss: 1.8646502
	speed: 0.0301s/iter; left time: 1664.7121s
	iters: 1100, epoch: 3 | loss: 2.2049685
	speed: 0.0302s/iter; left time: 1663.8513s
	iters: 1200, epoch: 3 | loss: 2.4759223
	speed: 0.0302s/iter; left time: 1660.6011s
	iters: 1300, epoch: 3 | loss: 1.7045487
	speed: 0.0301s/iter; left time: 1654.0434s
	iters: 1400, epoch: 3 | loss: 1.8081373
	speed: 0.0305s/iter; left time: 1671.1029s
	iters: 1500, epoch: 3 | loss: 2.5900085
	speed: 0.0304s/iter; left time: 1666.7941s
	iters: 1600, epoch: 3 | loss: 2.4385166
	speed: 0.0304s/iter; left time: 1663.8391s
	iters: 1700, epoch: 3 | loss: 1.4296540
	speed: 0.0302s/iter; left time: 1646.5462s
	iters: 1800, epoch: 3 | loss: 1.9125162
	speed: 0.0301s/iter; left time: 1637.3641s
	iters: 1900, epoch: 3 | loss: 2.0022435
	speed: 0.0300s/iter; left time: 1633.8031s
	iters: 2000, epoch: 3 | loss: 2.0603046
	speed: 0.0302s/iter; left time: 1639.1414s
	iters: 2100, epoch: 3 | loss: 2.1125393
	speed: 0.0303s/iter; left time: 1640.6618s
	iters: 2200, epoch: 3 | loss: 1.9970733
	speed: 0.0304s/iter; left time: 1645.7072s
	iters: 2300, epoch: 3 | loss: 2.0141904
	speed: 0.0305s/iter; left time: 1646.9114s
	iters: 2400, epoch: 3 | loss: 2.1219044
	speed: 0.0304s/iter; left time: 1638.5891s
	iters: 2500, epoch: 3 | loss: 2.3022873
	speed: 0.0301s/iter; left time: 1619.5129s
	iters: 2600, epoch: 3 | loss: 1.9252957
	speed: 0.0303s/iter; left time: 1626.2992s
	iters: 2700, epoch: 3 | loss: 2.2301228
	speed: 0.0304s/iter; left time: 1630.0138s
	iters: 2800, epoch: 3 | loss: 1.3491586
	speed: 0.0301s/iter; left time: 1610.1626s
	iters: 2900, epoch: 3 | loss: 2.2841115
	speed: 0.0299s/iter; left time: 1595.5929s
	iters: 3000, epoch: 3 | loss: 1.5305173
	speed: 0.0303s/iter; left time: 1613.8024s
	iters: 3100, epoch: 3 | loss: 2.1596706
	speed: 0.0301s/iter; left time: 1601.2629s
	iters: 3200, epoch: 3 | loss: 1.5702031
	speed: 0.0306s/iter; left time: 1623.7842s
	iters: 3300, epoch: 3 | loss: 1.7557160
	speed: 0.0304s/iter; left time: 1610.5168s
	iters: 3400, epoch: 3 | loss: 2.2821355
	speed: 0.0305s/iter; left time: 1614.5007s
	iters: 3500, epoch: 3 | loss: 1.7717606
	speed: 0.0304s/iter; left time: 1604.8412s
	iters: 3600, epoch: 3 | loss: 1.9513049
	speed: 0.0305s/iter; left time: 1607.9108s
	iters: 3700, epoch: 3 | loss: 1.9915782
	speed: 0.0305s/iter; left time: 1600.9589s
	iters: 3800, epoch: 3 | loss: 1.8704101
	speed: 0.0304s/iter; left time: 1596.4286s
	iters: 3900, epoch: 3 | loss: 1.9008372
	speed: 0.0301s/iter; left time: 1575.2861s
	iters: 4000, epoch: 3 | loss: 1.9364117
	speed: 0.0304s/iter; left time: 1589.4384s
	iters: 4100, epoch: 3 | loss: 1.9488245
	speed: 0.0304s/iter; left time: 1583.6691s
	iters: 4200, epoch: 3 | loss: 1.8837739
	speed: 0.0304s/iter; left time: 1585.1721s
	iters: 4300, epoch: 3 | loss: 1.7702012
	speed: 0.0304s/iter; left time: 1579.2669s
	iters: 4400, epoch: 3 | loss: 1.8941575
	speed: 0.0304s/iter; left time: 1577.6922s
	iters: 4500, epoch: 3 | loss: 1.7009678
	speed: 0.0303s/iter; left time: 1570.6529s
	iters: 4600, epoch: 3 | loss: 1.9033229
	speed: 0.0304s/iter; left time: 1573.0363s
	iters: 4700, epoch: 3 | loss: 2.0426123
	speed: 0.0306s/iter; left time: 1577.7794s
	iters: 4800, epoch: 3 | loss: 1.7136296
	speed: 0.0304s/iter; left time: 1565.0887s
	iters: 4900, epoch: 3 | loss: 2.3788202
	speed: 0.0303s/iter; left time: 1557.9366s
	iters: 5000, epoch: 3 | loss: 2.0980136
	speed: 0.0300s/iter; left time: 1536.7294s
	iters: 5100, epoch: 3 | loss: 1.5710611
	speed: 0.0304s/iter; left time: 1555.4004s
	iters: 5200, epoch: 3 | loss: 1.7071214
	speed: 0.0304s/iter; left time: 1551.5452s
	iters: 5300, epoch: 3 | loss: 1.7701929
	speed: 0.0304s/iter; left time: 1550.6416s
	iters: 5400, epoch: 3 | loss: 1.7383873
	speed: 0.0302s/iter; left time: 1536.6331s
	iters: 5500, epoch: 3 | loss: 1.6342590
	speed: 0.0304s/iter; left time: 1544.2992s
	iters: 5600, epoch: 3 | loss: 2.0803535
	speed: 0.0303s/iter; left time: 1536.9565s
	iters: 5700, epoch: 3 | loss: 1.8717729
	speed: 0.0301s/iter; left time: 1521.4280s
	iters: 5800, epoch: 3 | loss: 2.3079870
	speed: 0.0304s/iter; left time: 1534.8330s
	iters: 5900, epoch: 3 | loss: 1.6400709
	speed: 0.0305s/iter; left time: 1536.2660s
	iters: 6000, epoch: 3 | loss: 1.8942389
	speed: 0.0302s/iter; left time: 1518.7684s
	iters: 6100, epoch: 3 | loss: 1.6767639
	speed: 0.0300s/iter; left time: 1505.6913s
	iters: 6200, epoch: 3 | loss: 2.0188763
	speed: 0.0303s/iter; left time: 1518.1801s
	iters: 6300, epoch: 3 | loss: 1.9391996
	speed: 0.0304s/iter; left time: 1518.9373s
	iters: 6400, epoch: 3 | loss: 1.7299483
	speed: 0.0300s/iter; left time: 1496.9097s
	iters: 6500, epoch: 3 | loss: 2.0922544
	speed: 0.0304s/iter; left time: 1512.6391s
	iters: 6600, epoch: 3 | loss: 2.4126418
	speed: 0.0303s/iter; left time: 1506.0136s
	iters: 6700, epoch: 3 | loss: 1.8459228
	speed: 0.0302s/iter; left time: 1495.8493s
	iters: 6800, epoch: 3 | loss: 1.8858832
	speed: 0.0304s/iter; left time: 1503.6554s
	iters: 6900, epoch: 3 | loss: 1.7143860
	speed: 0.0303s/iter; left time: 1493.7391s
	iters: 7000, epoch: 3 | loss: 1.5711548
	speed: 0.0304s/iter; left time: 1497.1835s
Epoch: 3 cost time: 213.33122444152832
Epoch: 3, Steps: 7034 | Train Loss: 1.9519517 Vali Loss: 1.5858201 Test Loss: 0.8765239
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.9517769
	speed: 1.1743s/iter; left time: 57703.9748s
	iters: 200, epoch: 4 | loss: 2.2215071
	speed: 0.0304s/iter; left time: 1492.3248s
	iters: 300, epoch: 4 | loss: 1.8135442
	speed: 0.0302s/iter; left time: 1479.1221s
	iters: 400, epoch: 4 | loss: 1.9077351
	speed: 0.0303s/iter; left time: 1478.2424s
	iters: 500, epoch: 4 | loss: 1.7353578
	speed: 0.0305s/iter; left time: 1487.0249s
	iters: 600, epoch: 4 | loss: 2.1015007
	speed: 0.0304s/iter; left time: 1478.7346s
	iters: 700, epoch: 4 | loss: 1.8122786
	speed: 0.0300s/iter; left time: 1456.0265s
	iters: 800, epoch: 4 | loss: 1.5417569
	speed: 0.0303s/iter; left time: 1468.3011s
	iters: 900, epoch: 4 | loss: 1.5926484
	speed: 0.0301s/iter; left time: 1457.2503s
	iters: 1000, epoch: 4 | loss: 2.2484584
	speed: 0.0307s/iter; left time: 1479.2154s
	iters: 1100, epoch: 4 | loss: 1.7043135
	speed: 0.0301s/iter; left time: 1450.6169s
	iters: 1200, epoch: 4 | loss: 1.6155055
	speed: 0.0300s/iter; left time: 1443.3782s
	iters: 1300, epoch: 4 | loss: 1.9418709
	speed: 0.0297s/iter; left time: 1425.0296s
	iters: 1400, epoch: 4 | loss: 1.7916175
	speed: 0.0303s/iter; left time: 1450.3428s
	iters: 1500, epoch: 4 | loss: 1.7129537
	speed: 0.0302s/iter; left time: 1443.3292s
	iters: 1600, epoch: 4 | loss: 1.7886060
	speed: 0.0304s/iter; left time: 1449.0704s
	iters: 1700, epoch: 4 | loss: 1.9513206
	speed: 0.0304s/iter; left time: 1444.9859s
	iters: 1800, epoch: 4 | loss: 1.8922862
	speed: 0.0303s/iter; left time: 1435.0583s
	iters: 1900, epoch: 4 | loss: 1.6498169
	speed: 0.0301s/iter; left time: 1422.7289s
	iters: 2000, epoch: 4 | loss: 2.0413923
	speed: 0.0303s/iter; left time: 1432.7171s
	iters: 2100, epoch: 4 | loss: 1.8660423
	speed: 0.0302s/iter; left time: 1423.3937s
	iters: 2200, epoch: 4 | loss: 1.7444900
	speed: 0.0306s/iter; left time: 1437.1565s
	iters: 2300, epoch: 4 | loss: 2.5395312
	speed: 0.0304s/iter; left time: 1424.9737s
	iters: 2400, epoch: 4 | loss: 2.0016048
	speed: 0.0304s/iter; left time: 1425.6342s
	iters: 2500, epoch: 4 | loss: 1.9307119
	speed: 0.0303s/iter; left time: 1415.6460s
	iters: 2600, epoch: 4 | loss: 1.8141043
	speed: 0.0303s/iter; left time: 1414.2162s
	iters: 2700, epoch: 4 | loss: 1.9421005
	speed: 0.0301s/iter; left time: 1401.3822s
	iters: 2800, epoch: 4 | loss: 1.7867397
	speed: 0.0292s/iter; left time: 1357.0504s
	iters: 2900, epoch: 4 | loss: 1.8719219
	speed: 0.0304s/iter; left time: 1409.4962s
	iters: 3000, epoch: 4 | loss: 2.3890665
	speed: 0.0304s/iter; left time: 1406.9743s
	iters: 3100, epoch: 4 | loss: 1.4998927
	speed: 0.0304s/iter; left time: 1401.0251s
	iters: 3200, epoch: 4 | loss: 2.1128693
	speed: 0.0303s/iter; left time: 1393.6256s
	iters: 3300, epoch: 4 | loss: 2.1513317
	speed: 0.0304s/iter; left time: 1397.4681s
	iters: 3400, epoch: 4 | loss: 1.8656920
	speed: 0.0303s/iter; left time: 1390.9027s
	iters: 3500, epoch: 4 | loss: 2.0277963
	speed: 0.0302s/iter; left time: 1381.6257s
	iters: 3600, epoch: 4 | loss: 1.4170808
	speed: 0.0301s/iter; left time: 1375.8293s
	iters: 3700, epoch: 4 | loss: 2.1200681
	speed: 0.0303s/iter; left time: 1379.9830s
	iters: 3800, epoch: 4 | loss: 1.8091736
	speed: 0.0297s/iter; left time: 1348.7190s
	iters: 3900, epoch: 4 | loss: 1.7825798
	speed: 0.0305s/iter; left time: 1383.1089s
	iters: 4000, epoch: 4 | loss: 1.7320186
	speed: 0.0293s/iter; left time: 1325.0616s
	iters: 4100, epoch: 4 | loss: 1.7777212
	speed: 0.0304s/iter; left time: 1374.3055s
	iters: 4200, epoch: 4 | loss: 2.0693076
	speed: 0.0314s/iter; left time: 1414.6915s
	iters: 4300, epoch: 4 | loss: 1.6424341
	speed: 0.0351s/iter; left time: 1576.0334s
	iters: 4400, epoch: 4 | loss: 2.1514039
	speed: 0.0327s/iter; left time: 1464.8336s
	iters: 4500, epoch: 4 | loss: 2.0217905
	speed: 0.0325s/iter; left time: 1455.9950s
	iters: 4600, epoch: 4 | loss: 2.2761109
	speed: 0.0304s/iter; left time: 1356.5784s
	iters: 4700, epoch: 4 | loss: 1.8320965
	speed: 0.0302s/iter; left time: 1346.9064s
	iters: 4800, epoch: 4 | loss: 1.6953794
	speed: 0.0304s/iter; left time: 1351.8611s
	iters: 4900, epoch: 4 | loss: 1.8349835
	speed: 0.0328s/iter; left time: 1455.9069s
	iters: 5000, epoch: 4 | loss: 2.2547314
	speed: 0.0315s/iter; left time: 1395.5168s
	iters: 5100, epoch: 4 | loss: 2.0469272
	speed: 0.0300s/iter; left time: 1322.7682s
	iters: 5200, epoch: 4 | loss: 2.0017440
	speed: 0.0305s/iter; left time: 1343.2589s
	iters: 5300, epoch: 4 | loss: 2.0356014
	speed: 0.0304s/iter; left time: 1337.8867s
	iters: 5400, epoch: 4 | loss: 2.0655894
	speed: 0.0314s/iter; left time: 1377.4761s
	iters: 5500, epoch: 4 | loss: 2.1626768
	speed: 0.0333s/iter; left time: 1458.0896s
	iters: 5600, epoch: 4 | loss: 1.5948795
	speed: 0.0345s/iter; left time: 1505.7010s
	iters: 5700, epoch: 4 | loss: 1.9534571
	speed: 0.0349s/iter; left time: 1519.4269s
	iters: 5800, epoch: 4 | loss: 1.6148813
	speed: 0.0348s/iter; left time: 1510.9497s
	iters: 5900, epoch: 4 | loss: 2.3264711
	speed: 0.0351s/iter; left time: 1523.2184s
	iters: 6000, epoch: 4 | loss: 1.7839355
	speed: 0.0347s/iter; left time: 1498.2629s
	iters: 6100, epoch: 4 | loss: 2.1029232
	speed: 0.0347s/iter; left time: 1496.5085s
	iters: 6200, epoch: 4 | loss: 1.9602991
	speed: 0.0343s/iter; left time: 1475.7697s
	iters: 6300, epoch: 4 | loss: 1.8772060
	speed: 0.0353s/iter; left time: 1514.7796s
	iters: 6400, epoch: 4 | loss: 1.7569399
	speed: 0.0344s/iter; left time: 1472.2421s
	iters: 6500, epoch: 4 | loss: 2.0379190
	speed: 0.0344s/iter; left time: 1471.9961s
	iters: 6600, epoch: 4 | loss: 1.8076899
	speed: 0.0350s/iter; left time: 1491.4517s
	iters: 6700, epoch: 4 | loss: 1.7868564
	speed: 0.0347s/iter; left time: 1477.4887s
	iters: 6800, epoch: 4 | loss: 2.2262893
	speed: 0.0349s/iter; left time: 1480.0786s
	iters: 6900, epoch: 4 | loss: 2.1261799
	speed: 0.0345s/iter; left time: 1461.8775s
	iters: 7000, epoch: 4 | loss: 1.8206022
	speed: 0.0349s/iter; left time: 1473.5476s
Epoch: 4 cost time: 221.66247606277466
Epoch: 4, Steps: 7034 | Train Loss: 1.9518098 Vali Loss: 1.5826073 Test Loss: 0.8769639
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.8214324
	speed: 1.1768s/iter; left time: 49549.8351s
	iters: 200, epoch: 5 | loss: 1.7746783
	speed: 0.0304s/iter; left time: 1277.5197s
	iters: 300, epoch: 5 | loss: 1.8072294
	speed: 0.0304s/iter; left time: 1275.0364s
	iters: 400, epoch: 5 | loss: 1.6360844
	speed: 0.0304s/iter; left time: 1272.3410s
	iters: 500, epoch: 5 | loss: 1.8730952
	speed: 0.0300s/iter; left time: 1252.2110s
	iters: 600, epoch: 5 | loss: 1.8971958
	speed: 0.0301s/iter; left time: 1253.9847s
	iters: 700, epoch: 5 | loss: 1.9133989
	speed: 0.0306s/iter; left time: 1271.4093s
	iters: 800, epoch: 5 | loss: 2.3915212
	speed: 0.0304s/iter; left time: 1259.4063s
	iters: 900, epoch: 5 | loss: 1.9055734
	speed: 0.0305s/iter; left time: 1260.9477s
	iters: 1000, epoch: 5 | loss: 2.2691035
	speed: 0.0303s/iter; left time: 1250.4403s
	iters: 1100, epoch: 5 | loss: 2.0926127
	speed: 0.0296s/iter; left time: 1215.3304s
	iters: 1200, epoch: 5 | loss: 2.4618125
	speed: 0.0302s/iter; left time: 1238.1763s
	iters: 1300, epoch: 5 | loss: 2.0404091
	speed: 0.0301s/iter; left time: 1232.7233s
	iters: 1400, epoch: 5 | loss: 2.3185399
	speed: 0.0300s/iter; left time: 1224.8755s
	iters: 1500, epoch: 5 | loss: 1.6891460
	speed: 0.0304s/iter; left time: 1237.3311s
	iters: 1600, epoch: 5 | loss: 2.1249487
	speed: 0.0302s/iter; left time: 1226.2824s
	iters: 1700, epoch: 5 | loss: 1.9697216
	speed: 0.0299s/iter; left time: 1209.4465s
	iters: 1800, epoch: 5 | loss: 2.1811879
	speed: 0.0301s/iter; left time: 1217.5760s
	iters: 1900, epoch: 5 | loss: 1.7467847
	speed: 0.0302s/iter; left time: 1216.9909s
	iters: 2000, epoch: 5 | loss: 2.0544422
	speed: 0.0303s/iter; left time: 1216.7599s
	iters: 2100, epoch: 5 | loss: 1.6759489
	speed: 0.0302s/iter; left time: 1210.2218s
	iters: 2200, epoch: 5 | loss: 1.6823715
	speed: 0.0298s/iter; left time: 1193.0966s
	iters: 2300, epoch: 5 | loss: 1.7351600
	speed: 0.0297s/iter; left time: 1184.2994s
	iters: 2400, epoch: 5 | loss: 1.9318590
	speed: 0.0301s/iter; left time: 1197.6219s
	iters: 2500, epoch: 5 | loss: 1.9713691
	speed: 0.0303s/iter; left time: 1203.1702s
	iters: 2600, epoch: 5 | loss: 1.7085323
	speed: 0.0304s/iter; left time: 1204.7587s
	iters: 2700, epoch: 5 | loss: 1.7418884
	speed: 0.0305s/iter; left time: 1204.7753s
	iters: 2800, epoch: 5 | loss: 1.6957369
	speed: 0.0296s/iter; left time: 1165.3016s
	iters: 2900, epoch: 5 | loss: 1.6852565
	speed: 0.0303s/iter; left time: 1189.9060s
	iters: 3000, epoch: 5 | loss: 2.0627170
	speed: 0.0299s/iter; left time: 1174.1103s
	iters: 3100, epoch: 5 | loss: 2.0425248
	speed: 0.0298s/iter; left time: 1167.1801s
	iters: 3200, epoch: 5 | loss: 2.3925254
	speed: 0.0300s/iter; left time: 1171.8523s
	iters: 3300, epoch: 5 | loss: 2.0447035
	speed: 0.0302s/iter; left time: 1176.8407s
	iters: 3400, epoch: 5 | loss: 1.8491944
	speed: 0.0303s/iter; left time: 1175.9739s
	iters: 3500, epoch: 5 | loss: 1.7475826
	speed: 0.0302s/iter; left time: 1169.5005s
	iters: 3600, epoch: 5 | loss: 1.8601960
	speed: 0.0301s/iter; left time: 1162.1178s
	iters: 3700, epoch: 5 | loss: 2.4018621
	speed: 0.0304s/iter; left time: 1171.7127s
	iters: 3800, epoch: 5 | loss: 1.9014890
	speed: 0.0305s/iter; left time: 1171.0472s
	iters: 3900, epoch: 5 | loss: 2.1094823
	speed: 0.0303s/iter; left time: 1161.2087s
	iters: 4000, epoch: 5 | loss: 2.1032877
	speed: 0.0304s/iter; left time: 1159.8152s
	iters: 4100, epoch: 5 | loss: 1.9356290
	speed: 0.0306s/iter; left time: 1166.0185s
	iters: 4200, epoch: 5 | loss: 1.9076526
	speed: 0.0296s/iter; left time: 1123.3666s
	iters: 4300, epoch: 5 | loss: 2.2162457
	speed: 0.0303s/iter; left time: 1146.8593s
	iters: 4400, epoch: 5 | loss: 1.9632834
	speed: 0.0304s/iter; left time: 1148.0519s
	iters: 4500, epoch: 5 | loss: 2.2426891
	speed: 0.0303s/iter; left time: 1141.8061s
	iters: 4600, epoch: 5 | loss: 2.1631398
	speed: 0.0300s/iter; left time: 1127.1451s
	iters: 4700, epoch: 5 | loss: 1.8589441
	speed: 0.0306s/iter; left time: 1145.9370s
	iters: 4800, epoch: 5 | loss: 1.7568280
	speed: 0.0302s/iter; left time: 1130.4721s
	iters: 4900, epoch: 5 | loss: 1.8405517
	speed: 0.0301s/iter; left time: 1121.3910s
	iters: 5000, epoch: 5 | loss: 2.2381368
	speed: 0.0298s/iter; left time: 1110.1281s
	iters: 5100, epoch: 5 | loss: 2.0575120
	speed: 0.0297s/iter; left time: 1103.1600s
	iters: 5200, epoch: 5 | loss: 2.4589550
	speed: 0.0302s/iter; left time: 1117.9657s
	iters: 5300, epoch: 5 | loss: 1.9327314
	speed: 0.0301s/iter; left time: 1111.3309s
	iters: 5400, epoch: 5 | loss: 2.0723290
	speed: 0.0302s/iter; left time: 1111.7106s
	iters: 5500, epoch: 5 | loss: 1.9538581
	speed: 0.0301s/iter; left time: 1105.6737s
	iters: 5600, epoch: 5 | loss: 2.1566751
	speed: 0.0303s/iter; left time: 1109.9318s
	iters: 5700, epoch: 5 | loss: 2.1443470
	speed: 0.0299s/iter; left time: 1090.7575s
	iters: 5800, epoch: 5 | loss: 1.8195789
	speed: 0.0303s/iter; left time: 1101.4965s
	iters: 5900, epoch: 5 | loss: 1.7483778
	speed: 0.0300s/iter; left time: 1088.0193s
	iters: 6000, epoch: 5 | loss: 1.7401898
	speed: 0.0300s/iter; left time: 1086.9504s
	iters: 6100, epoch: 5 | loss: 2.1399682
	speed: 0.0298s/iter; left time: 1075.6366s
	iters: 6200, epoch: 5 | loss: 1.9321303
	speed: 0.0304s/iter; left time: 1094.4697s
	iters: 6300, epoch: 5 | loss: 2.0175946
	speed: 0.0303s/iter; left time: 1087.0621s
	iters: 6400, epoch: 5 | loss: 1.9007362
	speed: 0.0304s/iter; left time: 1088.3684s
	iters: 6500, epoch: 5 | loss: 1.8597214
	speed: 0.0301s/iter; left time: 1074.3731s
	iters: 6600, epoch: 5 | loss: 1.8700476
	speed: 0.0304s/iter; left time: 1081.7563s
	iters: 6700, epoch: 5 | loss: 1.7432975
	speed: 0.0301s/iter; left time: 1070.3135s
	iters: 6800, epoch: 5 | loss: 1.5263166
	speed: 0.0303s/iter; left time: 1074.1546s
	iters: 6900, epoch: 5 | loss: 2.1142941
	speed: 0.0303s/iter; left time: 1069.6214s
	iters: 7000, epoch: 5 | loss: 2.2719607
	speed: 0.0302s/iter; left time: 1063.4044s
Epoch: 5 cost time: 212.49896097183228
Epoch: 5, Steps: 7034 | Train Loss: 1.9517848 Vali Loss: 1.5903270 Test Loss: 0.8758325
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 246445
test shape: (24644, 1, 96, 107) (24644, 1, 96, 107)
test shape: (24644, 96, 107) (24644, 96, 107)
mse:0.8816747069358826, mae:0.6983705163002014
>>>>>>>Overall time: 1826 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
