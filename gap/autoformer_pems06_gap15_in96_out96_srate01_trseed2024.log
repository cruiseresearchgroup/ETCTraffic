Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 743094
val 142452
test 142450
	iters: 100, epoch: 1 | loss: 1.3854450
	speed: 0.1036s/iter; left time: 48082.6936s
	iters: 200, epoch: 1 | loss: 1.4401567
	speed: 0.1014s/iter; left time: 47086.0573s
	iters: 300, epoch: 1 | loss: 1.0573034
	speed: 0.1014s/iter; left time: 47066.1368s
	iters: 400, epoch: 1 | loss: 1.1160297
	speed: 0.1015s/iter; left time: 47089.8991s
	iters: 500, epoch: 1 | loss: 1.1007168
	speed: 0.1015s/iter; left time: 47107.9464s
	iters: 600, epoch: 1 | loss: 0.9062849
	speed: 0.1013s/iter; left time: 46988.5276s
	iters: 700, epoch: 1 | loss: 0.8726526
	speed: 0.1019s/iter; left time: 47229.3340s
	iters: 800, epoch: 1 | loss: 1.0841367
	speed: 0.1015s/iter; left time: 47037.8557s
	iters: 900, epoch: 1 | loss: 0.8256232
	speed: 0.1019s/iter; left time: 47236.9980s
	iters: 1000, epoch: 1 | loss: 0.8540019
	speed: 0.1017s/iter; left time: 47115.4228s
	iters: 1100, epoch: 1 | loss: 0.8137187
	speed: 0.1017s/iter; left time: 47133.3388s
	iters: 1200, epoch: 1 | loss: 0.7340105
	speed: 0.1019s/iter; left time: 47184.9586s
	iters: 1300, epoch: 1 | loss: 1.0193580
	speed: 0.1017s/iter; left time: 47104.4958s
	iters: 1400, epoch: 1 | loss: 0.8785848
	speed: 0.1014s/iter; left time: 46948.3273s
	iters: 1500, epoch: 1 | loss: 0.9919708
	speed: 0.1018s/iter; left time: 47106.8690s
	iters: 1600, epoch: 1 | loss: 0.7231537
	speed: 0.1013s/iter; left time: 46869.7842s
	iters: 1700, epoch: 1 | loss: 0.6816535
	speed: 0.1015s/iter; left time: 46972.0660s
	iters: 1800, epoch: 1 | loss: 0.9055791
	speed: 0.1016s/iter; left time: 46989.0816s
	iters: 1900, epoch: 1 | loss: 1.0141534
	speed: 0.1020s/iter; left time: 47154.6032s
	iters: 2000, epoch: 1 | loss: 0.6868743
	speed: 0.1014s/iter; left time: 46903.6712s
	iters: 2100, epoch: 1 | loss: 0.8533559
	speed: 0.1016s/iter; left time: 46978.9899s
	iters: 2200, epoch: 1 | loss: 0.7947887
	speed: 0.1014s/iter; left time: 46882.6051s
	iters: 2300, epoch: 1 | loss: 0.7627166
	speed: 0.1018s/iter; left time: 47037.5975s
Epoch: 1 cost time: 236.2279670238495
Epoch: 1, Steps: 2322 | Train Loss: 0.9422425 Vali Loss: 0.9830670 Test Loss: 1.0113684
Validation loss decreased (inf --> 0.983067).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7163752
	speed: 1.8500s/iter; left time: 854681.8582s
	iters: 200, epoch: 2 | loss: 0.6932793
	speed: 0.1001s/iter; left time: 46231.3767s
	iters: 300, epoch: 2 | loss: 0.6407536
	speed: 0.1006s/iter; left time: 46456.9258s
	iters: 400, epoch: 2 | loss: 0.6706543
	speed: 0.1001s/iter; left time: 46229.6916s
	iters: 500, epoch: 2 | loss: 0.6238028
	speed: 0.1001s/iter; left time: 46206.6572s
	iters: 600, epoch: 2 | loss: 0.7639672
	speed: 0.1003s/iter; left time: 46274.1946s
	iters: 700, epoch: 2 | loss: 0.7784998
	speed: 0.1003s/iter; left time: 46273.3556s
	iters: 800, epoch: 2 | loss: 0.9074216
	speed: 0.1004s/iter; left time: 46299.2680s
	iters: 900, epoch: 2 | loss: 0.7247678
	speed: 0.1000s/iter; left time: 46137.5850s
	iters: 1000, epoch: 2 | loss: 0.6775367
	speed: 0.1002s/iter; left time: 46220.7704s
	iters: 1100, epoch: 2 | loss: 0.7414265
	speed: 0.1003s/iter; left time: 46257.5263s
	iters: 1200, epoch: 2 | loss: 0.7118768
	speed: 0.1006s/iter; left time: 46342.3716s
	iters: 1300, epoch: 2 | loss: 0.7785014
	speed: 0.1001s/iter; left time: 46127.5977s
	iters: 1400, epoch: 2 | loss: 0.5757649
	speed: 0.1000s/iter; left time: 46075.4478s
	iters: 1500, epoch: 2 | loss: 0.6559998
	speed: 0.0999s/iter; left time: 46003.2934s
	iters: 1600, epoch: 2 | loss: 0.6230571
	speed: 0.1007s/iter; left time: 46349.7620s
	iters: 1700, epoch: 2 | loss: 0.5605856
	speed: 0.1002s/iter; left time: 46148.0087s
	iters: 1800, epoch: 2 | loss: 0.5859830
	speed: 0.1002s/iter; left time: 46136.4616s
	iters: 1900, epoch: 2 | loss: 0.6919333
	speed: 0.1005s/iter; left time: 46269.3530s
	iters: 2000, epoch: 2 | loss: 0.7773497
	speed: 0.1003s/iter; left time: 46145.6504s
	iters: 2100, epoch: 2 | loss: 0.7320901
	speed: 0.1001s/iter; left time: 46066.8359s
	iters: 2200, epoch: 2 | loss: 0.6767173
	speed: 0.1003s/iter; left time: 46142.5985s
	iters: 2300, epoch: 2 | loss: 0.7458696
	speed: 0.1001s/iter; left time: 46022.5471s
Epoch: 2 cost time: 232.95224952697754
Epoch: 2, Steps: 2322 | Train Loss: 0.6928378 Vali Loss: 1.0158340 Test Loss: 1.0440564
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.6605027
	speed: 1.8484s/iter; left time: 849609.2704s
	iters: 200, epoch: 3 | loss: 0.8210411
	speed: 0.1020s/iter; left time: 46861.4536s
	iters: 300, epoch: 3 | loss: 0.7804450
	speed: 0.1016s/iter; left time: 46681.7090s
	iters: 400, epoch: 3 | loss: 0.6707343
	speed: 0.1018s/iter; left time: 46771.8575s
	iters: 500, epoch: 3 | loss: 0.6991815
	speed: 0.1014s/iter; left time: 46586.9953s
	iters: 600, epoch: 3 | loss: 0.7180803
	speed: 0.1015s/iter; left time: 46612.4372s
	iters: 700, epoch: 3 | loss: 0.6575867
	speed: 0.1017s/iter; left time: 46680.3228s
	iters: 800, epoch: 3 | loss: 0.5424913
	speed: 0.1020s/iter; left time: 46824.2568s
	iters: 900, epoch: 3 | loss: 0.5719466
	speed: 0.1014s/iter; left time: 46510.1368s
	iters: 1000, epoch: 3 | loss: 0.5520859
	speed: 0.1020s/iter; left time: 46778.7394s
	iters: 1100, epoch: 3 | loss: 0.6776180
	speed: 0.1016s/iter; left time: 46607.6076s
	iters: 1200, epoch: 3 | loss: 0.6050986
	speed: 0.1018s/iter; left time: 46675.6354s
	iters: 1300, epoch: 3 | loss: 0.5076359
	speed: 0.1014s/iter; left time: 46502.3751s
	iters: 1400, epoch: 3 | loss: 0.5481022
	speed: 0.1014s/iter; left time: 46491.5106s
	iters: 1500, epoch: 3 | loss: 0.6283172
	speed: 0.1018s/iter; left time: 46631.3654s
	iters: 1600, epoch: 3 | loss: 0.5103086
	speed: 0.1013s/iter; left time: 46394.7591s
	iters: 1700, epoch: 3 | loss: 0.6422947
	speed: 0.1014s/iter; left time: 46447.5667s
	iters: 1800, epoch: 3 | loss: 0.6537035
	speed: 0.1012s/iter; left time: 46367.8394s
	iters: 1900, epoch: 3 | loss: 0.6118208
	speed: 0.1013s/iter; left time: 46378.9595s
	iters: 2000, epoch: 3 | loss: 0.6672072
	speed: 0.1018s/iter; left time: 46579.6339s
	iters: 2100, epoch: 3 | loss: 0.5051047
	speed: 0.1016s/iter; left time: 46491.4604s
	iters: 2200, epoch: 3 | loss: 0.5737008
	speed: 0.1020s/iter; left time: 46679.5720s
	iters: 2300, epoch: 3 | loss: 0.4991699
	speed: 0.1000s/iter; left time: 45754.9837s
Epoch: 3 cost time: 235.93403124809265
Epoch: 3, Steps: 2322 | Train Loss: 0.6079632 Vali Loss: 1.0300153 Test Loss: 0.9486842
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.5785535
	speed: 1.8498s/iter; left time: 845975.2573s
	iters: 200, epoch: 4 | loss: 0.5028664
	speed: 0.1008s/iter; left time: 46088.8767s
	iters: 300, epoch: 4 | loss: 0.5126857
	speed: 0.1000s/iter; left time: 45716.1234s
	iters: 400, epoch: 4 | loss: 0.5814381
	speed: 0.1005s/iter; left time: 45951.5319s
	iters: 500, epoch: 4 | loss: 0.6350517
	speed: 0.1005s/iter; left time: 45944.2088s
	iters: 600, epoch: 4 | loss: 0.5021299
	speed: 0.1003s/iter; left time: 45822.5534s
	iters: 700, epoch: 4 | loss: 0.6196306
	speed: 0.1002s/iter; left time: 45770.2241s
	iters: 800, epoch: 4 | loss: 0.5492671
	speed: 0.1001s/iter; left time: 45701.5578s
	iters: 900, epoch: 4 | loss: 0.5273499
	speed: 0.1007s/iter; left time: 45986.7910s
	iters: 1000, epoch: 4 | loss: 0.4880983
	speed: 0.1002s/iter; left time: 45732.5212s
	iters: 1100, epoch: 4 | loss: 0.5458807
	speed: 0.1000s/iter; left time: 45649.4347s
	iters: 1200, epoch: 4 | loss: 0.5874071
	speed: 0.1001s/iter; left time: 45686.8200s
	iters: 1300, epoch: 4 | loss: 0.5528125
	speed: 0.1008s/iter; left time: 45968.1851s
	iters: 1400, epoch: 4 | loss: 0.5479183
	speed: 0.1003s/iter; left time: 45745.4999s
	iters: 1500, epoch: 4 | loss: 0.4854169
	speed: 0.1002s/iter; left time: 45666.8693s
	iters: 1600, epoch: 4 | loss: 0.5173540
	speed: 0.1011s/iter; left time: 46091.4594s
	iters: 1700, epoch: 4 | loss: 0.5485786
	speed: 0.1003s/iter; left time: 45716.0976s
	iters: 1800, epoch: 4 | loss: 0.5534329
	speed: 0.1000s/iter; left time: 45569.9082s
	iters: 1900, epoch: 4 | loss: 0.4628066
	speed: 0.1004s/iter; left time: 45737.2419s
	iters: 2000, epoch: 4 | loss: 0.5567222
	speed: 0.1005s/iter; left time: 45765.2842s
	iters: 2100, epoch: 4 | loss: 0.5403796
	speed: 0.0999s/iter; left time: 45480.5454s
	iters: 2200, epoch: 4 | loss: 0.5452889
	speed: 0.0999s/iter; left time: 45499.5037s
	iters: 2300, epoch: 4 | loss: 0.5522043
	speed: 0.1002s/iter; left time: 45592.9410s
Epoch: 4 cost time: 233.10798287391663
Epoch: 4, Steps: 2322 | Train Loss: 0.5592695 Vali Loss: 0.9390259 Test Loss: 0.8879194
Validation loss decreased (0.983067 --> 0.939026).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.4851403
	speed: 1.8493s/iter; left time: 841443.5028s
	iters: 200, epoch: 5 | loss: 0.4864173
	speed: 0.1003s/iter; left time: 45607.0807s
	iters: 300, epoch: 5 | loss: 0.7565425
	speed: 0.1005s/iter; left time: 45721.5353s
	iters: 400, epoch: 5 | loss: 0.5858273
	speed: 0.1005s/iter; left time: 45707.1374s
	iters: 500, epoch: 5 | loss: 0.4734408
	speed: 0.1007s/iter; left time: 45763.4104s
	iters: 600, epoch: 5 | loss: 0.4734457
	speed: 0.1002s/iter; left time: 45544.2679s
	iters: 700, epoch: 5 | loss: 0.4996992
	speed: 0.1005s/iter; left time: 45682.6859s
	iters: 800, epoch: 5 | loss: 0.4943328
	speed: 0.1002s/iter; left time: 45517.1442s
	iters: 900, epoch: 5 | loss: 0.5786577
	speed: 0.1009s/iter; left time: 45833.3206s
	iters: 1000, epoch: 5 | loss: 0.4970028
	speed: 0.1001s/iter; left time: 45471.2063s
	iters: 1100, epoch: 5 | loss: 0.3967892
	speed: 0.1003s/iter; left time: 45531.1595s
	iters: 1200, epoch: 5 | loss: 0.6577550
	speed: 0.1007s/iter; left time: 45710.7238s
	iters: 1300, epoch: 5 | loss: 0.4470679
	speed: 0.1001s/iter; left time: 45421.2378s
	iters: 1400, epoch: 5 | loss: 0.4746762
	speed: 0.1000s/iter; left time: 45370.6629s
	iters: 1500, epoch: 5 | loss: 0.4351465
	speed: 0.1004s/iter; left time: 45522.5773s
	iters: 1600, epoch: 5 | loss: 0.6130472
	speed: 0.1005s/iter; left time: 45575.1012s
	iters: 1700, epoch: 5 | loss: 0.5089757
	speed: 0.1004s/iter; left time: 45506.1805s
	iters: 1800, epoch: 5 | loss: 0.5485020
	speed: 0.1009s/iter; left time: 45724.3989s
	iters: 1900, epoch: 5 | loss: 0.4668933
	speed: 0.1005s/iter; left time: 45539.7093s
	iters: 2000, epoch: 5 | loss: 0.4563069
	speed: 0.1005s/iter; left time: 45532.1253s
	iters: 2100, epoch: 5 | loss: 0.6433067
	speed: 0.1004s/iter; left time: 45466.7069s
	iters: 2200, epoch: 5 | loss: 0.4758993
	speed: 0.1000s/iter; left time: 45289.1447s
	iters: 2300, epoch: 5 | loss: 0.4551742
	speed: 0.1007s/iter; left time: 45601.7483s
Epoch: 5 cost time: 233.4609570503235
Epoch: 5, Steps: 2322 | Train Loss: 0.5225211 Vali Loss: 0.9658723 Test Loss: 0.9477226
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.5344971
	speed: 1.8505s/iter; left time: 837694.4473s
	iters: 200, epoch: 6 | loss: 0.5105349
	speed: 0.1005s/iter; left time: 45474.2615s
	iters: 300, epoch: 6 | loss: 0.5181370
	speed: 0.1002s/iter; left time: 45318.0465s
	iters: 400, epoch: 6 | loss: 0.4940954
	speed: 0.1002s/iter; left time: 45349.4575s
	iters: 500, epoch: 6 | loss: 0.4690627
	speed: 0.1007s/iter; left time: 45551.7562s
	iters: 600, epoch: 6 | loss: 0.5747463
	speed: 0.1005s/iter; left time: 45450.0425s
	iters: 700, epoch: 6 | loss: 0.4447521
	speed: 0.1002s/iter; left time: 45287.5926s
	iters: 800, epoch: 6 | loss: 0.4221954
	speed: 0.1002s/iter; left time: 45294.0845s
	iters: 900, epoch: 6 | loss: 0.4854434
	speed: 0.1002s/iter; left time: 45285.3661s
	iters: 1000, epoch: 6 | loss: 0.4231558
	speed: 0.1006s/iter; left time: 45429.1041s
	iters: 1100, epoch: 6 | loss: 0.5746136
	speed: 0.1008s/iter; left time: 45508.1818s
	iters: 1200, epoch: 6 | loss: 0.5454685
	speed: 0.1007s/iter; left time: 45467.6541s
	iters: 1300, epoch: 6 | loss: 0.5459581
	speed: 0.1003s/iter; left time: 45295.0317s
	iters: 1400, epoch: 6 | loss: 0.4984184
	speed: 0.1004s/iter; left time: 45297.1927s
	iters: 1500, epoch: 6 | loss: 0.4781972
	speed: 0.1006s/iter; left time: 45409.9981s
	iters: 1600, epoch: 6 | loss: 0.4302601
	speed: 0.1004s/iter; left time: 45295.1303s
	iters: 1700, epoch: 6 | loss: 0.4810212
	speed: 0.1007s/iter; left time: 45434.6632s
	iters: 1800, epoch: 6 | loss: 0.4075202
	speed: 0.1004s/iter; left time: 45288.4358s
	iters: 1900, epoch: 6 | loss: 0.5001641
	speed: 0.1006s/iter; left time: 45345.8517s
	iters: 2000, epoch: 6 | loss: 0.4772248
	speed: 0.1004s/iter; left time: 45271.8492s
	iters: 2100, epoch: 6 | loss: 0.5268267
	speed: 0.1004s/iter; left time: 45242.7861s
	iters: 2200, epoch: 6 | loss: 0.5308331
	speed: 0.1002s/iter; left time: 45159.7806s
	iters: 2300, epoch: 6 | loss: 0.4935249
	speed: 0.1003s/iter; left time: 45181.1399s
Epoch: 6 cost time: 233.4386146068573
Epoch: 6, Steps: 2322 | Train Loss: 0.4941631 Vali Loss: 0.9797767 Test Loss: 0.9315327
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 0.5756111
	speed: 1.8463s/iter; left time: 831528.1578s
	iters: 200, epoch: 7 | loss: 0.5343615
	speed: 0.1001s/iter; left time: 45060.3414s
	iters: 300, epoch: 7 | loss: 0.4194144
	speed: 0.0999s/iter; left time: 44974.8722s
	iters: 400, epoch: 7 | loss: 0.4107494
	speed: 0.0998s/iter; left time: 44896.5488s
	iters: 500, epoch: 7 | loss: 0.4976376
	speed: 0.1019s/iter; left time: 45856.0768s
	iters: 600, epoch: 7 | loss: 0.4002818
	speed: 0.1012s/iter; left time: 45546.0003s
	iters: 700, epoch: 7 | loss: 0.4365135
	speed: 0.1018s/iter; left time: 45768.5133s
	iters: 800, epoch: 7 | loss: 0.4828091
	speed: 0.1015s/iter; left time: 45621.2539s
	iters: 900, epoch: 7 | loss: 0.4523092
	speed: 0.1015s/iter; left time: 45624.5055s
	iters: 1000, epoch: 7 | loss: 0.4202100
	speed: 0.1013s/iter; left time: 45517.1785s
	iters: 1100, epoch: 7 | loss: 0.5130557
	speed: 0.1016s/iter; left time: 45647.7783s
	iters: 1200, epoch: 7 | loss: 0.4207666
	speed: 0.1018s/iter; left time: 45740.0908s
	iters: 1300, epoch: 7 | loss: 0.4559824
	speed: 0.1014s/iter; left time: 45544.7165s
	iters: 1400, epoch: 7 | loss: 0.4795171
	speed: 0.1014s/iter; left time: 45524.3637s
	iters: 1500, epoch: 7 | loss: 0.5185237
	speed: 0.1015s/iter; left time: 45592.6455s
	iters: 1600, epoch: 7 | loss: 0.4169266
	speed: 0.1015s/iter; left time: 45550.2790s
	iters: 1700, epoch: 7 | loss: 0.4271566
	speed: 0.1015s/iter; left time: 45559.3539s
	iters: 1800, epoch: 7 | loss: 0.4639446
	speed: 0.1016s/iter; left time: 45563.9596s
	iters: 1900, epoch: 7 | loss: 0.4590020
	speed: 0.1021s/iter; left time: 45797.0513s
	iters: 2000, epoch: 7 | loss: 0.4367206
	speed: 0.1015s/iter; left time: 45527.2949s
	iters: 2100, epoch: 7 | loss: 0.5073667
	speed: 0.1007s/iter; left time: 45159.5868s
	iters: 2200, epoch: 7 | loss: 0.5365916
	speed: 0.1006s/iter; left time: 45076.0966s
	iters: 2300, epoch: 7 | loss: 0.4370523
	speed: 0.0999s/iter; left time: 44780.6259s
Epoch: 7 cost time: 234.92207598686218
Epoch: 7, Steps: 2322 | Train Loss: 0.4708056 Vali Loss: 0.9244736 Test Loss: 0.8751857
Validation loss decreased (0.939026 --> 0.924474).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4935104
	speed: 1.8497s/iter; left time: 828772.5888s
	iters: 200, epoch: 8 | loss: 0.4570796
	speed: 0.1001s/iter; left time: 44854.6953s
	iters: 300, epoch: 8 | loss: 0.4519842
	speed: 0.1005s/iter; left time: 45022.9119s
	iters: 400, epoch: 8 | loss: 0.4824446
	speed: 0.1003s/iter; left time: 44891.2478s
	iters: 500, epoch: 8 | loss: 0.4409969
	speed: 0.1003s/iter; left time: 44908.8321s
	iters: 600, epoch: 8 | loss: 0.4714432
	speed: 0.1002s/iter; left time: 44847.1223s
	iters: 700, epoch: 8 | loss: 0.4547848
	speed: 0.1005s/iter; left time: 44952.2101s
	iters: 800, epoch: 8 | loss: 0.3846103
	speed: 0.1001s/iter; left time: 44759.1924s
	iters: 900, epoch: 8 | loss: 0.5504879
	speed: 0.1004s/iter; left time: 44891.8510s
	iters: 1000, epoch: 8 | loss: 0.4786970
	speed: 0.1007s/iter; left time: 45036.0426s
	iters: 1100, epoch: 8 | loss: 0.5035141
	speed: 0.1003s/iter; left time: 44834.4547s
	iters: 1200, epoch: 8 | loss: 0.3949691
	speed: 0.1004s/iter; left time: 44895.2010s
	iters: 1300, epoch: 8 | loss: 0.4794318
	speed: 0.1003s/iter; left time: 44810.9225s
	iters: 1400, epoch: 8 | loss: 0.4039913
	speed: 0.0999s/iter; left time: 44634.7460s
	iters: 1500, epoch: 8 | loss: 0.4180734
	speed: 0.1003s/iter; left time: 44819.5413s
	iters: 1600, epoch: 8 | loss: 0.5525179
	speed: 0.1004s/iter; left time: 44816.3023s
	iters: 1700, epoch: 8 | loss: 0.4244404
	speed: 0.1001s/iter; left time: 44697.5811s
	iters: 1800, epoch: 8 | loss: 0.4611257
	speed: 0.1004s/iter; left time: 44811.1241s
	iters: 1900, epoch: 8 | loss: 0.4501847
	speed: 0.1003s/iter; left time: 44772.5158s
	iters: 2000, epoch: 8 | loss: 0.4729262
	speed: 0.1002s/iter; left time: 44684.1796s
	iters: 2100, epoch: 8 | loss: 0.3994797
	speed: 0.1003s/iter; left time: 44745.7636s
	iters: 2200, epoch: 8 | loss: 0.4558655
	speed: 0.1004s/iter; left time: 44775.6537s
	iters: 2300, epoch: 8 | loss: 0.4454541
	speed: 0.1006s/iter; left time: 44855.6414s
Epoch: 8 cost time: 233.07390832901
Epoch: 8, Steps: 2322 | Train Loss: 0.4514617 Vali Loss: 0.9806588 Test Loss: 0.9091285
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 9 | loss: 0.5230936
	speed: 1.8517s/iter; left time: 825338.1848s
	iters: 200, epoch: 9 | loss: 0.4102249
	speed: 0.1013s/iter; left time: 45122.6198s
	iters: 300, epoch: 9 | loss: 0.4376158
	speed: 0.1018s/iter; left time: 45340.1553s
	iters: 400, epoch: 9 | loss: 0.3933428
	speed: 0.1017s/iter; left time: 45303.3198s
	iters: 500, epoch: 9 | loss: 0.4180542
	speed: 0.1012s/iter; left time: 45052.2375s
	iters: 600, epoch: 9 | loss: 0.4626390
	speed: 0.1009s/iter; left time: 44930.1337s
	iters: 700, epoch: 9 | loss: 0.5211422
	speed: 0.1000s/iter; left time: 44516.2123s
	iters: 800, epoch: 9 | loss: 0.3985150
	speed: 0.1004s/iter; left time: 44692.3986s
	iters: 900, epoch: 9 | loss: 0.4565856
	speed: 0.1000s/iter; left time: 44486.8598s
	iters: 1000, epoch: 9 | loss: 0.4520352
	speed: 0.1005s/iter; left time: 44720.9552s
	iters: 1100, epoch: 9 | loss: 0.4171042
	speed: 0.1004s/iter; left time: 44652.7108s
	iters: 1200, epoch: 9 | loss: 0.5329287
	speed: 0.1001s/iter; left time: 44487.2038s
	iters: 1300, epoch: 9 | loss: 0.3736721
	speed: 0.0999s/iter; left time: 44424.9741s
	iters: 1400, epoch: 9 | loss: 0.4098260
	speed: 0.1003s/iter; left time: 44566.9183s
	iters: 1500, epoch: 9 | loss: 0.3755211
	speed: 0.1003s/iter; left time: 44574.6409s
	iters: 1600, epoch: 9 | loss: 0.4293521
	speed: 0.0998s/iter; left time: 44312.2069s
	iters: 1700, epoch: 9 | loss: 0.3454864
	speed: 0.1000s/iter; left time: 44421.1531s
	iters: 1800, epoch: 9 | loss: 0.4110942
	speed: 0.1008s/iter; left time: 44767.8434s
	iters: 1900, epoch: 9 | loss: 0.3983039
	speed: 0.1003s/iter; left time: 44518.5713s
	iters: 2000, epoch: 9 | loss: 0.4412185
	speed: 0.1005s/iter; left time: 44600.9373s
	iters: 2100, epoch: 9 | loss: 0.4364182
	speed: 0.1003s/iter; left time: 44492.8652s
	iters: 2200, epoch: 9 | loss: 0.4674060
	speed: 0.1001s/iter; left time: 44412.7210s
	iters: 2300, epoch: 9 | loss: 0.4558761
	speed: 0.1003s/iter; left time: 44473.6949s
Epoch: 9 cost time: 233.62090754508972
Epoch: 9, Steps: 2322 | Train Loss: 0.4337615 Vali Loss: 0.8939231 Test Loss: 0.8852592
Validation loss decreased (0.924474 --> 0.893923).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.4070571
	speed: 1.8646s/iter; left time: 826757.0376s
	iters: 200, epoch: 10 | loss: 0.4503062
	speed: 0.1001s/iter; left time: 44392.7934s
	iters: 300, epoch: 10 | loss: 0.3914186
	speed: 0.1007s/iter; left time: 44644.4657s
	iters: 400, epoch: 10 | loss: 0.3796870
	speed: 0.1007s/iter; left time: 44634.8795s
	iters: 500, epoch: 10 | loss: 0.4189351
	speed: 0.1003s/iter; left time: 44443.0087s
	iters: 600, epoch: 10 | loss: 0.4400961
	speed: 0.1005s/iter; left time: 44532.4925s
	iters: 700, epoch: 10 | loss: 0.3848521
	speed: 0.1000s/iter; left time: 44293.9009s
	iters: 800, epoch: 10 | loss: 0.4362262
	speed: 0.1004s/iter; left time: 44434.3131s
	iters: 900, epoch: 10 | loss: 0.4442140
	speed: 0.1002s/iter; left time: 44354.5547s
	iters: 1000, epoch: 10 | loss: 0.4129586
	speed: 0.1005s/iter; left time: 44463.0342s
	iters: 1100, epoch: 10 | loss: 0.3821170
	speed: 0.1000s/iter; left time: 44262.0863s
	iters: 1200, epoch: 10 | loss: 0.5094032
	speed: 0.1002s/iter; left time: 44324.7387s
	iters: 1300, epoch: 10 | loss: 0.3604578
	speed: 0.1002s/iter; left time: 44317.3035s
	iters: 1400, epoch: 10 | loss: 0.4909239
	speed: 0.1005s/iter; left time: 44430.8042s
	iters: 1500, epoch: 10 | loss: 0.4133693
	speed: 0.1005s/iter; left time: 44418.1008s
	iters: 1600, epoch: 10 | loss: 0.4008430
	speed: 0.1002s/iter; left time: 44293.7825s
	iters: 1700, epoch: 10 | loss: 0.4538753
	speed: 0.1003s/iter; left time: 44322.5726s
	iters: 1800, epoch: 10 | loss: 0.3527843
	speed: 0.1001s/iter; left time: 44200.8368s
	iters: 1900, epoch: 10 | loss: 0.3892453
	speed: 0.1003s/iter; left time: 44312.6199s
	iters: 2000, epoch: 10 | loss: 0.4911754
	speed: 0.1000s/iter; left time: 44137.3727s
	iters: 2100, epoch: 10 | loss: 0.3501324
	speed: 0.1003s/iter; left time: 44256.0236s
	iters: 2200, epoch: 10 | loss: 0.4961628
	speed: 0.1004s/iter; left time: 44306.5832s
	iters: 2300, epoch: 10 | loss: 0.4408144
	speed: 0.1003s/iter; left time: 44244.3728s
Epoch: 10 cost time: 233.06856155395508
Epoch: 10, Steps: 2322 | Train Loss: 0.4179311 Vali Loss: 0.9824183 Test Loss: 0.9151658
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 11 | loss: 0.4649668
	speed: 1.8608s/iter; left time: 820782.2096s
	iters: 200, epoch: 11 | loss: 0.4438698
	speed: 0.1002s/iter; left time: 44174.2168s
	iters: 300, epoch: 11 | loss: 0.4494596
	speed: 0.1006s/iter; left time: 44348.2283s
	iters: 400, epoch: 11 | loss: 0.4294223
	speed: 0.1006s/iter; left time: 44357.3325s
	iters: 500, epoch: 11 | loss: 0.5615830
	speed: 0.1012s/iter; left time: 44596.4376s
	iters: 600, epoch: 11 | loss: 0.3639068
	speed: 0.1010s/iter; left time: 44480.9893s
	iters: 700, epoch: 11 | loss: 0.3430483
	speed: 0.1008s/iter; left time: 44408.6308s
	iters: 800, epoch: 11 | loss: 0.3410097
	speed: 0.1007s/iter; left time: 44333.3418s
	iters: 900, epoch: 11 | loss: 0.4223431
	speed: 0.1007s/iter; left time: 44316.0244s
	iters: 1000, epoch: 11 | loss: 0.4209731
	speed: 0.1003s/iter; left time: 44145.6593s
	iters: 1100, epoch: 11 | loss: 0.3845776
	speed: 0.1011s/iter; left time: 44500.9193s
	iters: 1200, epoch: 11 | loss: 0.4175264
	speed: 0.1009s/iter; left time: 44412.0130s
	iters: 1300, epoch: 11 | loss: 0.4308338
	speed: 0.1002s/iter; left time: 44067.4920s
	iters: 1400, epoch: 11 | loss: 0.4374549
	speed: 0.1006s/iter; left time: 44234.8772s
	iters: 1500, epoch: 11 | loss: 0.4838865
	speed: 0.1002s/iter; left time: 44069.9667s
	iters: 1600, epoch: 11 | loss: 0.4436849
	speed: 0.1010s/iter; left time: 44390.2238s
	iters: 1700, epoch: 11 | loss: 0.3870499
	speed: 0.1006s/iter; left time: 44226.2606s
	iters: 1800, epoch: 11 | loss: 0.3762071
	speed: 0.1008s/iter; left time: 44276.6681s
	iters: 1900, epoch: 11 | loss: 0.4477186
	speed: 0.1009s/iter; left time: 44315.3158s
	iters: 2000, epoch: 11 | loss: 0.4608028
	speed: 0.1010s/iter; left time: 44349.6881s
	iters: 2100, epoch: 11 | loss: 0.4183005
	speed: 0.1005s/iter; left time: 44139.3703s
	iters: 2200, epoch: 11 | loss: 0.3850802
	speed: 0.1005s/iter; left time: 44121.6825s
	iters: 2300, epoch: 11 | loss: 0.4064058
	speed: 0.1009s/iter; left time: 44282.4626s
Epoch: 11 cost time: 233.98729968070984
Epoch: 11, Steps: 2322 | Train Loss: 0.4078566 Vali Loss: 0.9207112 Test Loss: 0.8837050
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 12 | loss: 0.3942550
	speed: 1.8602s/iter; left time: 816191.2476s
	iters: 200, epoch: 12 | loss: 0.3774282
	speed: 0.1007s/iter; left time: 44172.4360s
	iters: 300, epoch: 12 | loss: 0.4479847
	speed: 0.1006s/iter; left time: 44128.0796s
	iters: 400, epoch: 12 | loss: 0.3792839
	speed: 0.1005s/iter; left time: 44086.4600s
	iters: 500, epoch: 12 | loss: 0.3398449
	speed: 0.1003s/iter; left time: 43948.0434s
	iters: 600, epoch: 12 | loss: 0.3677603
	speed: 0.1005s/iter; left time: 44037.6753s
	iters: 700, epoch: 12 | loss: 0.4912046
	speed: 0.1003s/iter; left time: 43965.0168s
	iters: 800, epoch: 12 | loss: 0.4112392
	speed: 0.1007s/iter; left time: 44090.8621s
	iters: 900, epoch: 12 | loss: 0.3625478
	speed: 0.1004s/iter; left time: 43960.5895s
	iters: 1000, epoch: 12 | loss: 0.3319633
	speed: 0.1003s/iter; left time: 43932.6556s
	iters: 1100, epoch: 12 | loss: 0.3630036
	speed: 0.1005s/iter; left time: 43977.3714s
	iters: 1200, epoch: 12 | loss: 0.3633097
	speed: 0.1003s/iter; left time: 43896.5538s
	iters: 1300, epoch: 12 | loss: 0.4417931
	speed: 0.1002s/iter; left time: 43825.2127s
	iters: 1400, epoch: 12 | loss: 0.3998476
	speed: 0.1008s/iter; left time: 44104.8616s
	iters: 1500, epoch: 12 | loss: 0.4416323
	speed: 0.1001s/iter; left time: 43783.8068s
	iters: 1600, epoch: 12 | loss: 0.4722862
	speed: 0.1002s/iter; left time: 43812.6105s
	iters: 1700, epoch: 12 | loss: 0.4021257
	speed: 0.1002s/iter; left time: 43820.4645s
	iters: 1800, epoch: 12 | loss: 0.3461595
	speed: 0.1006s/iter; left time: 43969.0886s
	iters: 1900, epoch: 12 | loss: 0.3400790
	speed: 0.1002s/iter; left time: 43778.7589s
	iters: 2000, epoch: 12 | loss: 0.4207695
	speed: 0.1004s/iter; left time: 43862.6276s
	iters: 2100, epoch: 12 | loss: 0.4569799
	speed: 0.1005s/iter; left time: 43905.4578s
	iters: 2200, epoch: 12 | loss: 0.4102902
	speed: 0.1005s/iter; left time: 43879.7204s
	iters: 2300, epoch: 12 | loss: 0.4213687
	speed: 0.1005s/iter; left time: 43877.0988s
Epoch: 12 cost time: 233.31007361412048
Epoch: 12, Steps: 2322 | Train Loss: 0.3962668 Vali Loss: 0.9653912 Test Loss: 0.9285319
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 13 | loss: 0.3748446
	speed: 1.8446s/iter; left time: 805057.3312s
	iters: 200, epoch: 13 | loss: 0.3916485
	speed: 0.1011s/iter; left time: 44093.2282s
	iters: 300, epoch: 13 | loss: 0.4022710
	speed: 0.1014s/iter; left time: 44232.1025s
	iters: 400, epoch: 13 | loss: 0.4216180
	speed: 0.1017s/iter; left time: 44338.7320s
	iters: 500, epoch: 13 | loss: 0.3821843
	speed: 0.1015s/iter; left time: 44255.5395s
	iters: 600, epoch: 13 | loss: 0.3788387
	speed: 0.1013s/iter; left time: 44160.9133s
	iters: 700, epoch: 13 | loss: 0.4887958
	speed: 0.1012s/iter; left time: 44125.3456s
	iters: 800, epoch: 13 | loss: 0.3672375
	speed: 0.1013s/iter; left time: 44160.8208s
	iters: 900, epoch: 13 | loss: 0.3474813
	speed: 0.1015s/iter; left time: 44234.1034s
	iters: 1000, epoch: 13 | loss: 0.3917670
	speed: 0.1013s/iter; left time: 44110.6008s
	iters: 1100, epoch: 13 | loss: 0.3687915
	speed: 0.1015s/iter; left time: 44215.7733s
	iters: 1200, epoch: 13 | loss: 0.4726610
	speed: 0.1017s/iter; left time: 44268.7123s
	iters: 1300, epoch: 13 | loss: 0.3934434
	speed: 0.1011s/iter; left time: 44023.4744s
	iters: 1400, epoch: 13 | loss: 0.3168505
	speed: 0.1012s/iter; left time: 44056.5361s
	iters: 1500, epoch: 13 | loss: 0.3511399
	speed: 0.1017s/iter; left time: 44231.1963s
	iters: 1600, epoch: 13 | loss: 0.4251307
	speed: 0.1016s/iter; left time: 44194.9172s
	iters: 1700, epoch: 13 | loss: 0.3988343
	speed: 0.1015s/iter; left time: 44128.0560s
	iters: 1800, epoch: 13 | loss: 0.4694918
	speed: 0.1015s/iter; left time: 44128.3764s
	iters: 1900, epoch: 13 | loss: 0.3595108
	speed: 0.1014s/iter; left time: 44092.9526s
	iters: 2000, epoch: 13 | loss: 0.4194391
	speed: 0.1015s/iter; left time: 44126.3102s
	iters: 2100, epoch: 13 | loss: 0.3573610
	speed: 0.1017s/iter; left time: 44170.3359s
	iters: 2200, epoch: 13 | loss: 0.4096009
	speed: 0.1016s/iter; left time: 44126.3117s
	iters: 2300, epoch: 13 | loss: 0.3453732
	speed: 0.1015s/iter; left time: 44074.5590s
Epoch: 13 cost time: 235.54526495933533
Epoch: 13, Steps: 2322 | Train Loss: 0.3934858 Vali Loss: 0.9484429 Test Loss: 0.9155875
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 14 | loss: 0.4545708
	speed: 1.8630s/iter; left time: 808748.1127s
	iters: 200, epoch: 14 | loss: 0.3865847
	speed: 0.1029s/iter; left time: 44664.2379s
	iters: 300, epoch: 14 | loss: 0.3345078
	speed: 0.1016s/iter; left time: 44104.7026s
	iters: 400, epoch: 14 | loss: 0.3490415
	speed: 0.1020s/iter; left time: 44228.3057s
	iters: 500, epoch: 14 | loss: 0.4123195
	speed: 0.1013s/iter; left time: 43938.7258s
	iters: 600, epoch: 14 | loss: 0.3999733
	speed: 0.1013s/iter; left time: 43921.8876s
	iters: 700, epoch: 14 | loss: 0.3959884
	speed: 0.1018s/iter; left time: 44126.2708s
	iters: 800, epoch: 14 | loss: 0.3243127
	speed: 0.1015s/iter; left time: 44005.0057s
	iters: 900, epoch: 14 | loss: 0.3716902
	speed: 0.1016s/iter; left time: 44011.2707s
	iters: 1000, epoch: 14 | loss: 0.3918172
	speed: 0.1015s/iter; left time: 43983.4880s
	iters: 1100, epoch: 14 | loss: 0.3557269
	speed: 0.1017s/iter; left time: 44053.5816s
	iters: 1200, epoch: 14 | loss: 0.3733297
	speed: 0.1013s/iter; left time: 43858.4683s
	iters: 1300, epoch: 14 | loss: 0.3645251
	speed: 0.1014s/iter; left time: 43880.0019s
	iters: 1400, epoch: 14 | loss: 0.4506697
	speed: 0.1014s/iter; left time: 43898.2311s
	iters: 1500, epoch: 14 | loss: 0.3411921
	speed: 0.1019s/iter; left time: 44084.9133s
	iters: 1600, epoch: 14 | loss: 0.3560776
	speed: 0.1016s/iter; left time: 43957.3336s
	iters: 1700, epoch: 14 | loss: 0.3269418
	speed: 0.1014s/iter; left time: 43871.8696s
	iters: 1800, epoch: 14 | loss: 0.4263163
	speed: 0.1019s/iter; left time: 44050.3812s
	iters: 1900, epoch: 14 | loss: 0.3206601
	speed: 0.1013s/iter; left time: 43813.4369s
	iters: 2000, epoch: 14 | loss: 0.3627744
	speed: 0.1013s/iter; left time: 43764.8932s
	iters: 2100, epoch: 14 | loss: 0.3562586
	speed: 0.1013s/iter; left time: 43765.3707s
	iters: 2200, epoch: 14 | loss: 0.4288556
	speed: 0.1013s/iter; left time: 43780.2139s
	iters: 2300, epoch: 14 | loss: 0.3835633
	speed: 0.1018s/iter; left time: 43981.4363s
Epoch: 14 cost time: 236.03202843666077
Epoch: 14, Steps: 2322 | Train Loss: 0.3808701 Vali Loss: 0.9787744 Test Loss: 0.9310659
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 142450
test shape: (14245, 1, 96, 130) (14245, 1, 96, 130)
test shape: (14245, 96, 130) (14245, 96, 130)
mse:0.8852570056915283, mae:0.7099311351776123
>>>>>>>Overall time: 5927 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
