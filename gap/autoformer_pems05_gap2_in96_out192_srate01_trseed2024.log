Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 548263
val 42500
test 42499
	iters: 100, epoch: 1 | loss: 1.1637567
	speed: 0.1290s/iter; left time: 44189.2886s
	iters: 200, epoch: 1 | loss: 1.0443928
	speed: 0.1261s/iter; left time: 43175.6049s
	iters: 300, epoch: 1 | loss: 0.9596242
	speed: 0.1266s/iter; left time: 43348.4095s
	iters: 400, epoch: 1 | loss: 0.8739479
	speed: 0.1270s/iter; left time: 43455.8859s
	iters: 500, epoch: 1 | loss: 0.7978904
	speed: 0.1266s/iter; left time: 43293.0120s
	iters: 600, epoch: 1 | loss: 0.7649056
	speed: 0.1265s/iter; left time: 43265.1922s
	iters: 700, epoch: 1 | loss: 0.7713044
	speed: 0.1264s/iter; left time: 43225.7328s
	iters: 800, epoch: 1 | loss: 0.7952905
	speed: 0.1258s/iter; left time: 43010.9930s
	iters: 900, epoch: 1 | loss: 0.7455059
	speed: 0.1270s/iter; left time: 43379.7491s
	iters: 1000, epoch: 1 | loss: 0.7383218
	speed: 0.1260s/iter; left time: 43040.6596s
	iters: 1100, epoch: 1 | loss: 0.8022258
	speed: 0.1269s/iter; left time: 43324.4342s
	iters: 1200, epoch: 1 | loss: 0.6570728
	speed: 0.1263s/iter; left time: 43113.7626s
	iters: 1300, epoch: 1 | loss: 0.7605129
	speed: 0.1265s/iter; left time: 43168.0385s
	iters: 1400, epoch: 1 | loss: 0.8370986
	speed: 0.1272s/iter; left time: 43397.2433s
	iters: 1500, epoch: 1 | loss: 0.8148807
	speed: 0.1267s/iter; left time: 43203.4831s
	iters: 1600, epoch: 1 | loss: 0.7330259
	speed: 0.1262s/iter; left time: 43017.3437s
	iters: 1700, epoch: 1 | loss: 0.7017543
	speed: 0.1268s/iter; left time: 43216.2426s
Epoch: 1 cost time: 217.1442699432373
Epoch: 1, Steps: 1713 | Train Loss: 0.8715238 Vali Loss: 1.0421216 Test Loss: 1.1197137
Validation loss decreased (inf --> 1.042122).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6559064
	speed: 0.6752s/iter; left time: 230115.2489s
	iters: 200, epoch: 2 | loss: 0.7404684
	speed: 0.1268s/iter; left time: 43188.8831s
	iters: 300, epoch: 2 | loss: 0.5799513
	speed: 0.1263s/iter; left time: 43016.5498s
	iters: 400, epoch: 2 | loss: 0.6502501
	speed: 0.1268s/iter; left time: 43168.1766s
	iters: 500, epoch: 2 | loss: 0.7028008
	speed: 0.1263s/iter; left time: 42996.8390s
	iters: 600, epoch: 2 | loss: 0.7778916
	speed: 0.1259s/iter; left time: 42846.9142s
	iters: 700, epoch: 2 | loss: 0.6002731
	speed: 0.1271s/iter; left time: 43233.8858s
	iters: 800, epoch: 2 | loss: 0.6735854
	speed: 0.1265s/iter; left time: 43019.6209s
	iters: 900, epoch: 2 | loss: 0.6071328
	speed: 0.1268s/iter; left time: 43114.8542s
	iters: 1000, epoch: 2 | loss: 0.5682367
	speed: 0.1264s/iter; left time: 42947.3933s
	iters: 1100, epoch: 2 | loss: 0.6623623
	speed: 0.1266s/iter; left time: 43019.3938s
	iters: 1200, epoch: 2 | loss: 0.6253192
	speed: 0.1269s/iter; left time: 43102.7176s
	iters: 1300, epoch: 2 | loss: 0.6039087
	speed: 0.1266s/iter; left time: 43007.7594s
	iters: 1400, epoch: 2 | loss: 0.5938435
	speed: 0.1265s/iter; left time: 42939.1505s
	iters: 1500, epoch: 2 | loss: 0.5869966
	speed: 0.1264s/iter; left time: 42907.3121s
	iters: 1600, epoch: 2 | loss: 0.5525216
	speed: 0.1268s/iter; left time: 43033.6301s
	iters: 1700, epoch: 2 | loss: 0.5726244
	speed: 0.1262s/iter; left time: 42793.4159s
Epoch: 2 cost time: 216.79392766952515
Epoch: 2, Steps: 1713 | Train Loss: 0.6637356 Vali Loss: 0.9303462 Test Loss: 1.1432776
Validation loss decreased (1.042122 --> 0.930346).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.6234471
	speed: 0.6763s/iter; left time: 229330.7173s
	iters: 200, epoch: 3 | loss: 0.5237321
	speed: 0.1260s/iter; left time: 42724.6962s
	iters: 300, epoch: 3 | loss: 0.5638362
	speed: 0.1264s/iter; left time: 42836.5401s
	iters: 400, epoch: 3 | loss: 0.6635820
	speed: 0.1262s/iter; left time: 42749.3265s
	iters: 500, epoch: 3 | loss: 0.5882707
	speed: 0.1264s/iter; left time: 42802.2706s
	iters: 600, epoch: 3 | loss: 0.6771817
	speed: 0.1264s/iter; left time: 42779.0424s
	iters: 700, epoch: 3 | loss: 0.5927725
	speed: 0.1261s/iter; left time: 42672.9147s
	iters: 800, epoch: 3 | loss: 0.5364018
	speed: 0.1265s/iter; left time: 42819.5982s
	iters: 900, epoch: 3 | loss: 0.5470123
	speed: 0.1264s/iter; left time: 42748.1508s
	iters: 1000, epoch: 3 | loss: 0.5985369
	speed: 0.1267s/iter; left time: 42834.1457s
	iters: 1100, epoch: 3 | loss: 0.5720600
	speed: 0.1267s/iter; left time: 42834.3591s
	iters: 1200, epoch: 3 | loss: 0.5820738
	speed: 0.1262s/iter; left time: 42663.8716s
	iters: 1300, epoch: 3 | loss: 0.6136212
	speed: 0.1266s/iter; left time: 42776.5518s
	iters: 1400, epoch: 3 | loss: 0.6069543
	speed: 0.1264s/iter; left time: 42679.9522s
	iters: 1500, epoch: 3 | loss: 0.5552906
	speed: 0.1260s/iter; left time: 42561.9139s
	iters: 1600, epoch: 3 | loss: 0.6416716
	speed: 0.1264s/iter; left time: 42676.1147s
	iters: 1700, epoch: 3 | loss: 0.6080273
	speed: 0.1260s/iter; left time: 42536.6568s
Epoch: 3 cost time: 216.53665256500244
Epoch: 3, Steps: 1713 | Train Loss: 0.5791609 Vali Loss: 0.9637793 Test Loss: 1.2174968
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.5675984
	speed: 0.6743s/iter; left time: 227476.3391s
	iters: 200, epoch: 4 | loss: 0.5300186
	speed: 0.1266s/iter; left time: 42696.7286s
	iters: 300, epoch: 4 | loss: 0.4911020
	speed: 0.1264s/iter; left time: 42605.6180s
	iters: 400, epoch: 4 | loss: 0.5076556
	speed: 0.1260s/iter; left time: 42467.7713s
	iters: 500, epoch: 4 | loss: 0.5743490
	speed: 0.1261s/iter; left time: 42491.5602s
	iters: 600, epoch: 4 | loss: 0.5642746
	speed: 0.1261s/iter; left time: 42475.7005s
	iters: 700, epoch: 4 | loss: 0.6402845
	speed: 0.1261s/iter; left time: 42482.1867s
	iters: 800, epoch: 4 | loss: 0.4906574
	speed: 0.1262s/iter; left time: 42486.9439s
	iters: 900, epoch: 4 | loss: 0.5228137
	speed: 0.1261s/iter; left time: 42427.4043s
	iters: 1000, epoch: 4 | loss: 0.6704917
	speed: 0.1261s/iter; left time: 42427.6019s
	iters: 1100, epoch: 4 | loss: 0.5336767
	speed: 0.1267s/iter; left time: 42621.6368s
	iters: 1200, epoch: 4 | loss: 0.5410923
	speed: 0.1264s/iter; left time: 42495.3261s
	iters: 1300, epoch: 4 | loss: 0.4938134
	speed: 0.1262s/iter; left time: 42421.8311s
	iters: 1400, epoch: 4 | loss: 0.4854484
	speed: 0.1263s/iter; left time: 42447.8103s
	iters: 1500, epoch: 4 | loss: 0.5556169
	speed: 0.1266s/iter; left time: 42523.6189s
	iters: 1600, epoch: 4 | loss: 0.5096996
	speed: 0.1260s/iter; left time: 42325.9562s
	iters: 1700, epoch: 4 | loss: 0.5101581
	speed: 0.1258s/iter; left time: 42235.8502s
Epoch: 4 cost time: 216.37489295005798
Epoch: 4, Steps: 1713 | Train Loss: 0.5413042 Vali Loss: 0.8920502 Test Loss: 1.0183091
Validation loss decreased (0.930346 --> 0.892050).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.5437918
	speed: 0.6732s/iter; left time: 225962.7310s
	iters: 200, epoch: 5 | loss: 0.5717139
	speed: 0.1252s/iter; left time: 41997.3049s
	iters: 300, epoch: 5 | loss: 0.5433965
	speed: 0.1249s/iter; left time: 41905.1020s
	iters: 400, epoch: 5 | loss: 0.5316988
	speed: 0.1249s/iter; left time: 41885.9400s
	iters: 500, epoch: 5 | loss: 0.5191424
	speed: 0.1251s/iter; left time: 41946.2840s
	iters: 600, epoch: 5 | loss: 0.6877417
	speed: 0.1249s/iter; left time: 41863.3775s
	iters: 700, epoch: 5 | loss: 0.5147008
	speed: 0.1246s/iter; left time: 41756.1841s
	iters: 800, epoch: 5 | loss: 0.4874786
	speed: 0.1246s/iter; left time: 41737.4046s
	iters: 900, epoch: 5 | loss: 0.5051593
	speed: 0.1248s/iter; left time: 41781.5966s
	iters: 1000, epoch: 5 | loss: 0.4991533
	speed: 0.1249s/iter; left time: 41821.2286s
	iters: 1100, epoch: 5 | loss: 0.5719102
	speed: 0.1250s/iter; left time: 41818.7597s
	iters: 1200, epoch: 5 | loss: 0.5042468
	speed: 0.1250s/iter; left time: 41822.8628s
	iters: 1300, epoch: 5 | loss: 0.5102363
	speed: 0.1245s/iter; left time: 41635.1585s
	iters: 1400, epoch: 5 | loss: 0.4961251
	speed: 0.1249s/iter; left time: 41746.8187s
	iters: 1500, epoch: 5 | loss: 0.5137842
	speed: 0.1250s/iter; left time: 41788.3227s
	iters: 1600, epoch: 5 | loss: 0.4865725
	speed: 0.1246s/iter; left time: 41639.2421s
	iters: 1700, epoch: 5 | loss: 0.4938145
	speed: 0.1251s/iter; left time: 41781.2270s
Epoch: 5 cost time: 214.0407576560974
Epoch: 5, Steps: 1713 | Train Loss: 0.5195992 Vali Loss: 0.9613522 Test Loss: 1.1748515
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.5290112
	speed: 0.6730s/iter; left time: 224749.9086s
	iters: 200, epoch: 6 | loss: 0.5162548
	speed: 0.1250s/iter; left time: 41726.3004s
	iters: 300, epoch: 6 | loss: 0.4468205
	speed: 0.1247s/iter; left time: 41603.6446s
	iters: 400, epoch: 6 | loss: 0.7825047
	speed: 0.1246s/iter; left time: 41555.8415s
	iters: 500, epoch: 6 | loss: 0.4892822
	speed: 0.1250s/iter; left time: 41681.5780s
	iters: 600, epoch: 6 | loss: 0.6230941
	speed: 0.1248s/iter; left time: 41622.3144s
	iters: 700, epoch: 6 | loss: 0.4612810
	speed: 0.1248s/iter; left time: 41589.4331s
	iters: 800, epoch: 6 | loss: 0.5455815
	speed: 0.1252s/iter; left time: 41733.1853s
	iters: 900, epoch: 6 | loss: 0.4866022
	speed: 0.1248s/iter; left time: 41569.7551s
	iters: 1000, epoch: 6 | loss: 0.4633982
	speed: 0.1243s/iter; left time: 41410.1100s
	iters: 1100, epoch: 6 | loss: 0.4960040
	speed: 0.1251s/iter; left time: 41666.3264s
	iters: 1200, epoch: 6 | loss: 0.4797556
	speed: 0.1246s/iter; left time: 41469.4914s
	iters: 1300, epoch: 6 | loss: 0.5154038
	speed: 0.1247s/iter; left time: 41479.6427s
	iters: 1400, epoch: 6 | loss: 0.5147405
	speed: 0.1248s/iter; left time: 41506.1374s
	iters: 1500, epoch: 6 | loss: 0.5933604
	speed: 0.1250s/iter; left time: 41551.3147s
	iters: 1600, epoch: 6 | loss: 0.4612692
	speed: 0.1245s/iter; left time: 41387.0901s
	iters: 1700, epoch: 6 | loss: 0.5318487
	speed: 0.1250s/iter; left time: 41543.2400s
Epoch: 6 cost time: 213.9547667503357
Epoch: 6, Steps: 1713 | Train Loss: 0.5028049 Vali Loss: 0.9912115 Test Loss: 1.1500325
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 0.5264313
	speed: 0.6713s/iter; left time: 223024.3997s
	iters: 200, epoch: 7 | loss: 0.5413503
	speed: 0.1218s/iter; left time: 40446.8154s
	iters: 300, epoch: 7 | loss: 0.4995467
	speed: 0.1224s/iter; left time: 40627.0865s
	iters: 400, epoch: 7 | loss: 0.5194237
	speed: 0.1214s/iter; left time: 40310.1158s
	iters: 500, epoch: 7 | loss: 0.4973846
	speed: 0.1223s/iter; left time: 40582.1618s
	iters: 600, epoch: 7 | loss: 0.4371676
	speed: 0.1225s/iter; left time: 40621.3158s
	iters: 700, epoch: 7 | loss: 0.5028494
	speed: 0.1217s/iter; left time: 40365.7799s
	iters: 800, epoch: 7 | loss: 0.4699997
	speed: 0.1217s/iter; left time: 40362.2983s
	iters: 900, epoch: 7 | loss: 0.5082364
	speed: 0.1220s/iter; left time: 40425.7605s
	iters: 1000, epoch: 7 | loss: 0.5455034
	speed: 0.1222s/iter; left time: 40489.7166s
	iters: 1100, epoch: 7 | loss: 0.6232812
	speed: 0.1225s/iter; left time: 40588.8362s
	iters: 1200, epoch: 7 | loss: 0.4680714
	speed: 0.1226s/iter; left time: 40583.8016s
	iters: 1300, epoch: 7 | loss: 0.4684312
	speed: 0.1224s/iter; left time: 40515.7607s
	iters: 1400, epoch: 7 | loss: 0.5084420
	speed: 0.1228s/iter; left time: 40634.9789s
	iters: 1500, epoch: 7 | loss: 0.4820380
	speed: 0.1220s/iter; left time: 40375.8505s
	iters: 1600, epoch: 7 | loss: 0.4930695
	speed: 0.1222s/iter; left time: 40415.2307s
	iters: 1700, epoch: 7 | loss: 0.4481833
	speed: 0.1224s/iter; left time: 40459.8350s
Epoch: 7 cost time: 209.39222931861877
Epoch: 7, Steps: 1713 | Train Loss: 0.4864820 Vali Loss: 0.9705681 Test Loss: 1.2766826
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 8 | loss: 0.4910305
	speed: 0.6697s/iter; left time: 221350.9779s
	iters: 200, epoch: 8 | loss: 0.4663967
	speed: 0.1217s/iter; left time: 40206.5236s
	iters: 300, epoch: 8 | loss: 0.5113326
	speed: 0.1216s/iter; left time: 40165.3576s
	iters: 400, epoch: 8 | loss: 0.4684976
	speed: 0.1223s/iter; left time: 40399.2509s
	iters: 500, epoch: 8 | loss: 0.4843562
	speed: 0.1219s/iter; left time: 40230.0029s
	iters: 600, epoch: 8 | loss: 0.4440161
	speed: 0.1225s/iter; left time: 40418.1508s
	iters: 700, epoch: 8 | loss: 0.4524418
	speed: 0.1218s/iter; left time: 40174.3616s
	iters: 800, epoch: 8 | loss: 0.4488170
	speed: 0.1225s/iter; left time: 40414.4439s
	iters: 900, epoch: 8 | loss: 0.4312655
	speed: 0.1227s/iter; left time: 40461.8896s
	iters: 1000, epoch: 8 | loss: 0.5016246
	speed: 0.1215s/iter; left time: 40052.4687s
	iters: 1100, epoch: 8 | loss: 0.4218056
	speed: 0.1221s/iter; left time: 40228.9076s
	iters: 1200, epoch: 8 | loss: 0.4495719
	speed: 0.1218s/iter; left time: 40132.1706s
	iters: 1300, epoch: 8 | loss: 0.4525361
	speed: 0.1217s/iter; left time: 40088.0686s
	iters: 1400, epoch: 8 | loss: 0.4375475
	speed: 0.1231s/iter; left time: 40541.1937s
	iters: 1500, epoch: 8 | loss: 0.4310087
	speed: 0.1222s/iter; left time: 40224.0498s
	iters: 1600, epoch: 8 | loss: 0.4727277
	speed: 0.1221s/iter; left time: 40170.9202s
	iters: 1700, epoch: 8 | loss: 0.4671143
	speed: 0.1219s/iter; left time: 40093.2478s
Epoch: 8 cost time: 209.27565550804138
Epoch: 8, Steps: 1713 | Train Loss: 0.4746844 Vali Loss: 0.9167053 Test Loss: 1.1619078
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 9 | loss: 0.4721504
	speed: 0.6701s/iter; left time: 220328.9455s
	iters: 200, epoch: 9 | loss: 0.4313120
	speed: 0.1222s/iter; left time: 40163.4374s
	iters: 300, epoch: 9 | loss: 0.4328966
	speed: 0.1231s/iter; left time: 40436.6971s
	iters: 400, epoch: 9 | loss: 0.4805766
	speed: 0.1217s/iter; left time: 39991.6541s
	iters: 500, epoch: 9 | loss: 0.4450801
	speed: 0.1224s/iter; left time: 40190.2542s
	iters: 600, epoch: 9 | loss: 0.4496842
	speed: 0.1224s/iter; left time: 40196.4184s
	iters: 700, epoch: 9 | loss: 0.4343880
	speed: 0.1223s/iter; left time: 40144.7875s
	iters: 800, epoch: 9 | loss: 0.4524776
	speed: 0.1221s/iter; left time: 40052.0344s
	iters: 900, epoch: 9 | loss: 0.4894153
	speed: 0.1220s/iter; left time: 40011.5544s
	iters: 1000, epoch: 9 | loss: 0.4276725
	speed: 0.1220s/iter; left time: 40002.5984s
	iters: 1100, epoch: 9 | loss: 0.4480871
	speed: 0.1215s/iter; left time: 39816.0372s
	iters: 1200, epoch: 9 | loss: 0.4855780
	speed: 0.1220s/iter; left time: 39975.7777s
	iters: 1300, epoch: 9 | loss: 0.4228732
	speed: 0.1224s/iter; left time: 40100.8377s
	iters: 1400, epoch: 9 | loss: 0.4515040
	speed: 0.1225s/iter; left time: 40116.4461s
	iters: 1500, epoch: 9 | loss: 0.4287417
	speed: 0.1224s/iter; left time: 40057.7798s
	iters: 1600, epoch: 9 | loss: 0.4495652
	speed: 0.1225s/iter; left time: 40099.6078s
	iters: 1700, epoch: 9 | loss: 0.4317756
	speed: 0.1218s/iter; left time: 39859.2038s
Epoch: 9 cost time: 209.45525932312012
Epoch: 9, Steps: 1713 | Train Loss: 0.4587423 Vali Loss: 0.9232940 Test Loss: 1.1203588
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 42499
test shape: (4249, 1, 192, 103) (4249, 1, 192, 103)
test shape: (4249, 192, 103) (4249, 192, 103)
mse:1.0183091163635254, mae:0.7721287608146667
>>>>>>>Overall time: 2503 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
