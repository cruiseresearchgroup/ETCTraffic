Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 843927
val 140703
test 140701
	iters: 100, epoch: 1 | loss: 1.6497235
	speed: 0.0335s/iter; left time: 1762.6942s
	iters: 200, epoch: 1 | loss: 1.4139292
	speed: 0.0304s/iter; left time: 1595.4468s
	iters: 300, epoch: 1 | loss: 1.3198406
	speed: 0.0304s/iter; left time: 1593.4468s
	iters: 400, epoch: 1 | loss: 1.7763990
	speed: 0.0304s/iter; left time: 1589.1340s
	iters: 500, epoch: 1 | loss: 1.3055772
	speed: 0.0304s/iter; left time: 1586.1451s
	iters: 600, epoch: 1 | loss: 1.8462106
	speed: 0.0304s/iter; left time: 1584.2403s
	iters: 700, epoch: 1 | loss: 1.3685561
	speed: 0.0304s/iter; left time: 1580.0659s
	iters: 800, epoch: 1 | loss: 1.6660734
	speed: 0.0304s/iter; left time: 1578.6359s
	iters: 900, epoch: 1 | loss: 1.5907766
	speed: 0.0303s/iter; left time: 1572.7426s
	iters: 1000, epoch: 1 | loss: 1.5551267
	speed: 0.0304s/iter; left time: 1571.5380s
	iters: 1100, epoch: 1 | loss: 1.5779537
	speed: 0.0304s/iter; left time: 1568.1372s
	iters: 1200, epoch: 1 | loss: 1.5541383
	speed: 0.0304s/iter; left time: 1565.3135s
	iters: 1300, epoch: 1 | loss: 1.4990332
	speed: 0.0304s/iter; left time: 1562.2933s
	iters: 1400, epoch: 1 | loss: 1.6527033
	speed: 0.0305s/iter; left time: 1565.1720s
	iters: 1500, epoch: 1 | loss: 1.6009192
	speed: 0.0304s/iter; left time: 1556.7313s
	iters: 1600, epoch: 1 | loss: 1.6898754
	speed: 0.0304s/iter; left time: 1554.2254s
	iters: 1700, epoch: 1 | loss: 1.4521565
	speed: 0.0304s/iter; left time: 1549.9715s
	iters: 1800, epoch: 1 | loss: 1.5699333
	speed: 0.0304s/iter; left time: 1547.5529s
	iters: 1900, epoch: 1 | loss: 1.5901026
	speed: 0.0304s/iter; left time: 1543.5820s
	iters: 2000, epoch: 1 | loss: 1.8399628
	speed: 0.0304s/iter; left time: 1541.4255s
	iters: 2100, epoch: 1 | loss: 1.5980703
	speed: 0.0304s/iter; left time: 1537.7333s
	iters: 2200, epoch: 1 | loss: 1.4040436
	speed: 0.0304s/iter; left time: 1535.7317s
	iters: 2300, epoch: 1 | loss: 1.5857295
	speed: 0.0304s/iter; left time: 1532.8878s
	iters: 2400, epoch: 1 | loss: 1.6270398
	speed: 0.0304s/iter; left time: 1528.9518s
	iters: 2500, epoch: 1 | loss: 1.4026697
	speed: 0.0304s/iter; left time: 1527.3483s
	iters: 2600, epoch: 1 | loss: 1.2448707
	speed: 0.0304s/iter; left time: 1522.0368s
	iters: 2700, epoch: 1 | loss: 1.6377572
	speed: 0.0304s/iter; left time: 1518.8581s
	iters: 2800, epoch: 1 | loss: 1.4469662
	speed: 0.0304s/iter; left time: 1517.9994s
	iters: 2900, epoch: 1 | loss: 1.5587296
	speed: 0.0304s/iter; left time: 1513.3442s
	iters: 3000, epoch: 1 | loss: 1.6789873
	speed: 0.0304s/iter; left time: 1511.3553s
	iters: 3100, epoch: 1 | loss: 1.6584928
	speed: 0.0304s/iter; left time: 1507.8463s
	iters: 3200, epoch: 1 | loss: 1.6343546
	speed: 0.0305s/iter; left time: 1511.4079s
	iters: 3300, epoch: 1 | loss: 1.6134046
	speed: 0.0304s/iter; left time: 1500.9033s
	iters: 3400, epoch: 1 | loss: 1.7545537
	speed: 0.0304s/iter; left time: 1498.5288s
	iters: 3500, epoch: 1 | loss: 1.5786686
	speed: 0.0305s/iter; left time: 1501.4632s
	iters: 3600, epoch: 1 | loss: 1.6184785
	speed: 0.0304s/iter; left time: 1492.9281s
	iters: 3700, epoch: 1 | loss: 1.8624582
	speed: 0.0304s/iter; left time: 1489.3582s
	iters: 3800, epoch: 1 | loss: 1.5208452
	speed: 0.0304s/iter; left time: 1485.9931s
	iters: 3900, epoch: 1 | loss: 1.5032516
	speed: 0.0304s/iter; left time: 1484.0610s
	iters: 4000, epoch: 1 | loss: 1.5605249
	speed: 0.0304s/iter; left time: 1480.6232s
	iters: 4100, epoch: 1 | loss: 1.5101656
	speed: 0.0304s/iter; left time: 1477.0139s
	iters: 4200, epoch: 1 | loss: 1.7496706
	speed: 0.0304s/iter; left time: 1476.0363s
	iters: 4300, epoch: 1 | loss: 1.4294289
	speed: 0.0304s/iter; left time: 1471.4975s
	iters: 4400, epoch: 1 | loss: 1.7166060
	speed: 0.0304s/iter; left time: 1467.8975s
	iters: 4500, epoch: 1 | loss: 1.4672084
	speed: 0.0304s/iter; left time: 1466.6513s
	iters: 4600, epoch: 1 | loss: 1.5345286
	speed: 0.0304s/iter; left time: 1463.5876s
	iters: 4700, epoch: 1 | loss: 1.5570611
	speed: 0.0304s/iter; left time: 1461.1727s
	iters: 4800, epoch: 1 | loss: 1.6071659
	speed: 0.0304s/iter; left time: 1456.8468s
	iters: 4900, epoch: 1 | loss: 1.5617961
	speed: 0.0304s/iter; left time: 1454.2231s
	iters: 5000, epoch: 1 | loss: 1.5014807
	speed: 0.0304s/iter; left time: 1450.6333s
	iters: 5100, epoch: 1 | loss: 1.4868600
	speed: 0.0304s/iter; left time: 1448.4989s
	iters: 5200, epoch: 1 | loss: 1.5392996
	speed: 0.0304s/iter; left time: 1443.7729s
Epoch: 1 cost time: 160.63460230827332
Epoch: 1, Steps: 5274 | Train Loss: 1.5822981 Vali Loss: 2.5318310 Test Loss: 1.8956732
Validation loss decreased (inf --> 2.531831).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.2752311
	speed: 0.8375s/iter; left time: 39671.5508s
	iters: 200, epoch: 2 | loss: 1.6027335
	speed: 0.0304s/iter; left time: 1436.2268s
	iters: 300, epoch: 2 | loss: 1.4965875
	speed: 0.0304s/iter; left time: 1432.8624s
	iters: 400, epoch: 2 | loss: 1.6368320
	speed: 0.0304s/iter; left time: 1430.9382s
	iters: 500, epoch: 2 | loss: 1.3706597
	speed: 0.0304s/iter; left time: 1427.4574s
	iters: 600, epoch: 2 | loss: 1.6119229
	speed: 0.0304s/iter; left time: 1423.6444s
	iters: 700, epoch: 2 | loss: 1.6746713
	speed: 0.0304s/iter; left time: 1420.7033s
	iters: 800, epoch: 2 | loss: 1.5091102
	speed: 0.0304s/iter; left time: 1416.8195s
	iters: 900, epoch: 2 | loss: 1.2412535
	speed: 0.0304s/iter; left time: 1414.4053s
	iters: 1000, epoch: 2 | loss: 1.5997571
	speed: 0.0304s/iter; left time: 1410.6013s
	iters: 1100, epoch: 2 | loss: 1.6613566
	speed: 0.0304s/iter; left time: 1408.1889s
	iters: 1200, epoch: 2 | loss: 1.5366962
	speed: 0.0303s/iter; left time: 1404.1629s
	iters: 1300, epoch: 2 | loss: 1.3911201
	speed: 0.0304s/iter; left time: 1401.4531s
	iters: 1400, epoch: 2 | loss: 1.4640415
	speed: 0.0304s/iter; left time: 1399.3743s
	iters: 1500, epoch: 2 | loss: 1.7574484
	speed: 0.0303s/iter; left time: 1394.6716s
	iters: 1600, epoch: 2 | loss: 1.4649010
	speed: 0.0304s/iter; left time: 1392.8036s
	iters: 1700, epoch: 2 | loss: 1.4778929
	speed: 0.0304s/iter; left time: 1390.9171s
	iters: 1800, epoch: 2 | loss: 1.5914972
	speed: 0.0304s/iter; left time: 1388.5772s
	iters: 1900, epoch: 2 | loss: 1.6528481
	speed: 0.0304s/iter; left time: 1384.7060s
	iters: 2000, epoch: 2 | loss: 1.4220414
	speed: 0.0304s/iter; left time: 1380.6348s
	iters: 2100, epoch: 2 | loss: 1.6556977
	speed: 0.0304s/iter; left time: 1379.2509s
	iters: 2200, epoch: 2 | loss: 1.8071862
	speed: 0.0304s/iter; left time: 1374.9954s
	iters: 2300, epoch: 2 | loss: 1.5698891
	speed: 0.0304s/iter; left time: 1373.1364s
	iters: 2400, epoch: 2 | loss: 1.6644355
	speed: 0.0304s/iter; left time: 1368.5285s
	iters: 2500, epoch: 2 | loss: 1.5615491
	speed: 0.0304s/iter; left time: 1365.2022s
	iters: 2600, epoch: 2 | loss: 1.5645195
	speed: 0.0304s/iter; left time: 1363.3946s
	iters: 2700, epoch: 2 | loss: 1.7366173
	speed: 0.0304s/iter; left time: 1360.5412s
	iters: 2800, epoch: 2 | loss: 1.5560362
	speed: 0.0304s/iter; left time: 1358.6185s
	iters: 2900, epoch: 2 | loss: 1.6580647
	speed: 0.0304s/iter; left time: 1355.3953s
	iters: 3000, epoch: 2 | loss: 1.5777918
	speed: 0.0304s/iter; left time: 1351.3270s
	iters: 3100, epoch: 2 | loss: 1.7264841
	speed: 0.0304s/iter; left time: 1348.5635s
	iters: 3200, epoch: 2 | loss: 1.7174611
	speed: 0.0304s/iter; left time: 1345.2347s
	iters: 3300, epoch: 2 | loss: 1.8640481
	speed: 0.0304s/iter; left time: 1341.2718s
	iters: 3400, epoch: 2 | loss: 1.7731740
	speed: 0.0304s/iter; left time: 1339.9173s
	iters: 3500, epoch: 2 | loss: 1.6781305
	speed: 0.0304s/iter; left time: 1336.0576s
	iters: 3600, epoch: 2 | loss: 1.5280473
	speed: 0.0304s/iter; left time: 1333.2474s
	iters: 3700, epoch: 2 | loss: 1.5485190
	speed: 0.0304s/iter; left time: 1330.0455s
	iters: 3800, epoch: 2 | loss: 1.4413365
	speed: 0.0304s/iter; left time: 1326.1387s
	iters: 3900, epoch: 2 | loss: 1.6569995
	speed: 0.0304s/iter; left time: 1324.8692s
	iters: 4000, epoch: 2 | loss: 1.3514593
	speed: 0.0304s/iter; left time: 1321.2546s
	iters: 4100, epoch: 2 | loss: 1.5627986
	speed: 0.0304s/iter; left time: 1317.8114s
	iters: 4200, epoch: 2 | loss: 1.4816312
	speed: 0.0304s/iter; left time: 1314.7537s
	iters: 4300, epoch: 2 | loss: 1.5390236
	speed: 0.0304s/iter; left time: 1312.7568s
	iters: 4400, epoch: 2 | loss: 1.5247654
	speed: 0.0304s/iter; left time: 1307.1554s
	iters: 4500, epoch: 2 | loss: 1.7131052
	speed: 0.0304s/iter; left time: 1305.3381s
	iters: 4600, epoch: 2 | loss: 1.5494467
	speed: 0.0304s/iter; left time: 1301.2971s
	iters: 4700, epoch: 2 | loss: 1.6876608
	speed: 0.0304s/iter; left time: 1298.2122s
	iters: 4800, epoch: 2 | loss: 1.5161283
	speed: 0.0304s/iter; left time: 1295.7518s
	iters: 4900, epoch: 2 | loss: 1.6698682
	speed: 0.0304s/iter; left time: 1294.0886s
	iters: 5000, epoch: 2 | loss: 1.7047433
	speed: 0.0304s/iter; left time: 1289.5435s
	iters: 5100, epoch: 2 | loss: 1.7541569
	speed: 0.0304s/iter; left time: 1287.4673s
	iters: 5200, epoch: 2 | loss: 1.5916965
	speed: 0.0304s/iter; left time: 1285.3588s
Epoch: 2 cost time: 160.37861347198486
Epoch: 2, Steps: 5274 | Train Loss: 1.6104345 Vali Loss: 2.4049201 Test Loss: 2.0380893
Validation loss decreased (2.531831 --> 2.404920).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.5847200
	speed: 0.8272s/iter; left time: 34819.3743s
	iters: 200, epoch: 3 | loss: 1.6127578
	speed: 0.0304s/iter; left time: 1276.5851s
	iters: 300, epoch: 3 | loss: 1.7458727
	speed: 0.0304s/iter; left time: 1273.8265s
	iters: 400, epoch: 3 | loss: 1.7369987
	speed: 0.0304s/iter; left time: 1270.1562s
	iters: 500, epoch: 3 | loss: 1.8113594
	speed: 0.0304s/iter; left time: 1266.1521s
	iters: 600, epoch: 3 | loss: 1.4814132
	speed: 0.0304s/iter; left time: 1264.0386s
	iters: 700, epoch: 3 | loss: 1.7984964
	speed: 0.0304s/iter; left time: 1260.6995s
	iters: 800, epoch: 3 | loss: 1.7776691
	speed: 0.0304s/iter; left time: 1258.8398s
	iters: 900, epoch: 3 | loss: 1.7427543
	speed: 0.0304s/iter; left time: 1256.0138s
	iters: 1000, epoch: 3 | loss: 1.6139342
	speed: 0.0304s/iter; left time: 1250.8448s
	iters: 1100, epoch: 3 | loss: 1.5097991
	speed: 0.0304s/iter; left time: 1249.2753s
	iters: 1200, epoch: 3 | loss: 1.3652602
	speed: 0.0304s/iter; left time: 1245.2278s
	iters: 1300, epoch: 3 | loss: 1.6710807
	speed: 0.0304s/iter; left time: 1244.0348s
	iters: 1400, epoch: 3 | loss: 1.6023231
	speed: 0.0304s/iter; left time: 1240.3542s
	iters: 1500, epoch: 3 | loss: 1.7065957
	speed: 0.0304s/iter; left time: 1237.4196s
	iters: 1600, epoch: 3 | loss: 1.6039624
	speed: 0.0304s/iter; left time: 1234.1568s
	iters: 1700, epoch: 3 | loss: 1.6690087
	speed: 0.0304s/iter; left time: 1231.8767s
	iters: 1800, epoch: 3 | loss: 1.5198627
	speed: 0.0304s/iter; left time: 1228.2486s
	iters: 1900, epoch: 3 | loss: 1.6823448
	speed: 0.0304s/iter; left time: 1224.0999s
	iters: 2000, epoch: 3 | loss: 1.7979729
	speed: 0.0304s/iter; left time: 1222.0034s
	iters: 2100, epoch: 3 | loss: 1.6648614
	speed: 0.0304s/iter; left time: 1218.7273s
	iters: 2200, epoch: 3 | loss: 1.6692603
	speed: 0.0304s/iter; left time: 1216.8998s
	iters: 2300, epoch: 3 | loss: 1.8395069
	speed: 0.0304s/iter; left time: 1213.4275s
	iters: 2400, epoch: 3 | loss: 1.5962230
	speed: 0.0304s/iter; left time: 1209.2507s
	iters: 2500, epoch: 3 | loss: 1.7690618
	speed: 0.0304s/iter; left time: 1207.2419s
	iters: 2600, epoch: 3 | loss: 1.6954877
	speed: 0.0304s/iter; left time: 1203.9732s
	iters: 2700, epoch: 3 | loss: 1.6319993
	speed: 0.0304s/iter; left time: 1200.7930s
	iters: 2800, epoch: 3 | loss: 1.7540146
	speed: 0.0304s/iter; left time: 1198.7227s
	iters: 2900, epoch: 3 | loss: 1.7590787
	speed: 0.0304s/iter; left time: 1194.9247s
	iters: 3000, epoch: 3 | loss: 1.7327663
	speed: 0.0304s/iter; left time: 1192.4398s
	iters: 3100, epoch: 3 | loss: 1.6301839
	speed: 0.0304s/iter; left time: 1190.1606s
	iters: 3200, epoch: 3 | loss: 1.6139396
	speed: 0.0304s/iter; left time: 1185.8569s
	iters: 3300, epoch: 3 | loss: 1.7167968
	speed: 0.0304s/iter; left time: 1182.8309s
	iters: 3400, epoch: 3 | loss: 1.6009003
	speed: 0.0304s/iter; left time: 1180.3184s
	iters: 3500, epoch: 3 | loss: 1.6478926
	speed: 0.0304s/iter; left time: 1175.0501s
	iters: 3600, epoch: 3 | loss: 1.7790563
	speed: 0.0304s/iter; left time: 1172.5418s
	iters: 3700, epoch: 3 | loss: 1.4991013
	speed: 0.0304s/iter; left time: 1171.6171s
	iters: 3800, epoch: 3 | loss: 1.5103518
	speed: 0.0304s/iter; left time: 1167.6508s
	iters: 3900, epoch: 3 | loss: 1.8242303
	speed: 0.0304s/iter; left time: 1162.9430s
	iters: 4000, epoch: 3 | loss: 1.8532467
	speed: 0.0304s/iter; left time: 1160.7470s
	iters: 4100, epoch: 3 | loss: 1.4395330
	speed: 0.0304s/iter; left time: 1158.6191s
	iters: 4200, epoch: 3 | loss: 1.5756476
	speed: 0.0304s/iter; left time: 1155.8792s
	iters: 4300, epoch: 3 | loss: 1.7764508
	speed: 0.0304s/iter; left time: 1153.1592s
	iters: 4400, epoch: 3 | loss: 1.9073907
	speed: 0.0304s/iter; left time: 1149.0971s
	iters: 4500, epoch: 3 | loss: 1.7102489
	speed: 0.0306s/iter; left time: 1153.1235s
	iters: 4600, epoch: 3 | loss: 1.5669091
	speed: 0.0304s/iter; left time: 1143.2889s
	iters: 4700, epoch: 3 | loss: 1.6545770
	speed: 0.0304s/iter; left time: 1139.2282s
	iters: 4800, epoch: 3 | loss: 1.5758880
	speed: 0.0304s/iter; left time: 1137.0850s
	iters: 4900, epoch: 3 | loss: 1.5877091
	speed: 0.0304s/iter; left time: 1132.4247s
	iters: 5000, epoch: 3 | loss: 1.6277009
	speed: 0.0304s/iter; left time: 1131.1705s
	iters: 5100, epoch: 3 | loss: 1.7661527
	speed: 0.0304s/iter; left time: 1127.6810s
	iters: 5200, epoch: 3 | loss: 1.7071724
	speed: 0.0304s/iter; left time: 1124.2503s
Epoch: 3 cost time: 160.51452231407166
Epoch: 3, Steps: 5274 | Train Loss: 1.6275359 Vali Loss: 2.4075370 Test Loss: 2.0394945
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.5705119
	speed: 0.8303s/iter; left time: 30571.4811s
	iters: 200, epoch: 4 | loss: 1.7773345
	speed: 0.0304s/iter; left time: 1117.3051s
	iters: 300, epoch: 4 | loss: 1.6439229
	speed: 0.0305s/iter; left time: 1117.4729s
	iters: 400, epoch: 4 | loss: 1.7610903
	speed: 0.0304s/iter; left time: 1110.7526s
	iters: 500, epoch: 4 | loss: 1.5910273
	speed: 0.0304s/iter; left time: 1107.5176s
	iters: 600, epoch: 4 | loss: 1.7405345
	speed: 0.0304s/iter; left time: 1104.3097s
	iters: 700, epoch: 4 | loss: 1.4265468
	speed: 0.0304s/iter; left time: 1100.7328s
	iters: 800, epoch: 4 | loss: 1.7068702
	speed: 0.0304s/iter; left time: 1098.3378s
	iters: 900, epoch: 4 | loss: 1.6605295
	speed: 0.0304s/iter; left time: 1094.3299s
	iters: 1000, epoch: 4 | loss: 1.5233049
	speed: 0.0304s/iter; left time: 1091.8656s
	iters: 1100, epoch: 4 | loss: 1.5777017
	speed: 0.0304s/iter; left time: 1089.6153s
	iters: 1200, epoch: 4 | loss: 1.6267811
	speed: 0.0304s/iter; left time: 1085.6357s
	iters: 1300, epoch: 4 | loss: 1.6873728
	speed: 0.0304s/iter; left time: 1083.9117s
	iters: 1400, epoch: 4 | loss: 1.5787051
	speed: 0.0304s/iter; left time: 1081.2717s
	iters: 1500, epoch: 4 | loss: 1.7029279
	speed: 0.0304s/iter; left time: 1077.1358s
	iters: 1600, epoch: 4 | loss: 1.6615367
	speed: 0.0304s/iter; left time: 1073.8784s
	iters: 1700, epoch: 4 | loss: 1.6216444
	speed: 0.0304s/iter; left time: 1070.9700s
	iters: 1800, epoch: 4 | loss: 1.6587676
	speed: 0.0304s/iter; left time: 1067.7320s
	iters: 1900, epoch: 4 | loss: 1.9421754
	speed: 0.0304s/iter; left time: 1064.2844s
	iters: 2000, epoch: 4 | loss: 1.6309325
	speed: 0.0305s/iter; left time: 1065.5237s
	iters: 2100, epoch: 4 | loss: 1.7322710
	speed: 0.0304s/iter; left time: 1059.8849s
	iters: 2200, epoch: 4 | loss: 1.5473521
	speed: 0.0304s/iter; left time: 1055.9403s
	iters: 2300, epoch: 4 | loss: 1.6795752
	speed: 0.0304s/iter; left time: 1053.3560s
	iters: 2400, epoch: 4 | loss: 1.6936048
	speed: 0.0304s/iter; left time: 1050.6964s
	iters: 2500, epoch: 4 | loss: 1.5670719
	speed: 0.0305s/iter; left time: 1048.1094s
	iters: 2600, epoch: 4 | loss: 1.5541170
	speed: 0.0304s/iter; left time: 1044.6356s
	iters: 2700, epoch: 4 | loss: 1.3079909
	speed: 0.0304s/iter; left time: 1041.6368s
	iters: 2800, epoch: 4 | loss: 1.7436768
	speed: 0.0304s/iter; left time: 1037.0960s
	iters: 2900, epoch: 4 | loss: 1.6500406
	speed: 0.0305s/iter; left time: 1039.0177s
	iters: 3000, epoch: 4 | loss: 1.5021844
	speed: 0.0304s/iter; left time: 1031.9259s
	iters: 3100, epoch: 4 | loss: 1.6487550
	speed: 0.0304s/iter; left time: 1028.8092s
	iters: 3200, epoch: 4 | loss: 1.6687442
	speed: 0.0304s/iter; left time: 1025.6233s
	iters: 3300, epoch: 4 | loss: 1.6720502
	speed: 0.0304s/iter; left time: 1022.5572s
	iters: 3400, epoch: 4 | loss: 1.4683362
	speed: 0.0304s/iter; left time: 1020.2017s
	iters: 3500, epoch: 4 | loss: 1.7550832
	speed: 0.0304s/iter; left time: 1016.9265s
	iters: 3600, epoch: 4 | loss: 1.5368323
	speed: 0.0304s/iter; left time: 1013.7141s
	iters: 3700, epoch: 4 | loss: 1.5785156
	speed: 0.0304s/iter; left time: 1010.4670s
	iters: 3800, epoch: 4 | loss: 1.4541405
	speed: 0.0305s/iter; left time: 1009.9582s
	iters: 3900, epoch: 4 | loss: 1.7303776
	speed: 0.0304s/iter; left time: 1003.1412s
	iters: 4000, epoch: 4 | loss: 1.5347058
	speed: 0.0304s/iter; left time: 1002.0493s
	iters: 4100, epoch: 4 | loss: 1.4680883
	speed: 0.0304s/iter; left time: 997.9081s
	iters: 4200, epoch: 4 | loss: 1.5858158
	speed: 0.0304s/iter; left time: 995.1624s
	iters: 4300, epoch: 4 | loss: 1.5400721
	speed: 0.0304s/iter; left time: 992.5892s
	iters: 4400, epoch: 4 | loss: 1.7165004
	speed: 0.0304s/iter; left time: 989.6494s
	iters: 4500, epoch: 4 | loss: 1.4214852
	speed: 0.0304s/iter; left time: 985.9284s
	iters: 4600, epoch: 4 | loss: 1.6861529
	speed: 0.0304s/iter; left time: 982.3698s
	iters: 4700, epoch: 4 | loss: 1.6085639
	speed: 0.0304s/iter; left time: 980.0120s
	iters: 4800, epoch: 4 | loss: 1.5582513
	speed: 0.0304s/iter; left time: 976.2819s
	iters: 4900, epoch: 4 | loss: 1.5462333
	speed: 0.0304s/iter; left time: 974.0134s
	iters: 5000, epoch: 4 | loss: 1.5687772
	speed: 0.0304s/iter; left time: 970.3988s
	iters: 5100, epoch: 4 | loss: 1.5446026
	speed: 0.0304s/iter; left time: 968.1543s
	iters: 5200, epoch: 4 | loss: 1.4712938
	speed: 0.0304s/iter; left time: 964.9845s
Epoch: 4 cost time: 160.6091411113739
Epoch: 4, Steps: 5274 | Train Loss: 1.6010986 Vali Loss: 2.5167525 Test Loss: 1.8489242
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.5596849
	speed: 0.8323s/iter; left time: 26256.2792s
	iters: 200, epoch: 5 | loss: 1.2147251
	speed: 0.0304s/iter; left time: 954.9539s
	iters: 300, epoch: 5 | loss: 1.4154916
	speed: 0.0304s/iter; left time: 954.0422s
	iters: 400, epoch: 5 | loss: 1.1246175
	speed: 0.0303s/iter; left time: 946.7820s
	iters: 500, epoch: 5 | loss: 1.5475733
	speed: 0.0304s/iter; left time: 946.9985s
	iters: 600, epoch: 5 | loss: 1.7243644
	speed: 0.0306s/iter; left time: 950.0848s
	iters: 700, epoch: 5 | loss: 1.2693107
	speed: 0.0304s/iter; left time: 940.1450s
	iters: 800, epoch: 5 | loss: 1.3141717
	speed: 0.0304s/iter; left time: 937.8751s
	iters: 900, epoch: 5 | loss: 1.3203163
	speed: 0.0304s/iter; left time: 934.3463s
	iters: 1000, epoch: 5 | loss: 1.3037809
	speed: 0.0304s/iter; left time: 931.6402s
	iters: 1100, epoch: 5 | loss: 1.4177543
	speed: 0.0304s/iter; left time: 927.9452s
	iters: 1200, epoch: 5 | loss: 1.7279214
	speed: 0.0304s/iter; left time: 925.3777s
	iters: 1300, epoch: 5 | loss: 1.2903044
	speed: 0.0305s/iter; left time: 925.5037s
	iters: 1400, epoch: 5 | loss: 1.3331790
	speed: 0.0304s/iter; left time: 919.2660s
	iters: 1500, epoch: 5 | loss: 1.4560022
	speed: 0.0304s/iter; left time: 916.7986s
	iters: 1600, epoch: 5 | loss: 1.2920479
	speed: 0.0304s/iter; left time: 912.7613s
	iters: 1700, epoch: 5 | loss: 1.3680727
	speed: 0.0304s/iter; left time: 911.2925s
	iters: 1800, epoch: 5 | loss: 1.6518464
	speed: 0.0304s/iter; left time: 906.6950s
	iters: 1900, epoch: 5 | loss: 1.4251190
	speed: 0.0304s/iter; left time: 903.9995s
	iters: 2000, epoch: 5 | loss: 1.3644267
	speed: 0.0304s/iter; left time: 900.5767s
	iters: 2100, epoch: 5 | loss: 1.4253012
	speed: 0.0304s/iter; left time: 898.2570s
	iters: 2200, epoch: 5 | loss: 1.4798355
	speed: 0.0304s/iter; left time: 894.7942s
	iters: 2300, epoch: 5 | loss: 1.3075625
	speed: 0.0304s/iter; left time: 892.1348s
	iters: 2400, epoch: 5 | loss: 1.3245670
	speed: 0.0304s/iter; left time: 888.8194s
	iters: 2500, epoch: 5 | loss: 1.2943561
	speed: 0.0304s/iter; left time: 886.6400s
	iters: 2600, epoch: 5 | loss: 1.3423613
	speed: 0.0304s/iter; left time: 883.7251s
	iters: 2700, epoch: 5 | loss: 1.2163152
	speed: 0.0304s/iter; left time: 880.4511s
	iters: 2800, epoch: 5 | loss: 1.5467081
	speed: 0.0304s/iter; left time: 877.9440s
	iters: 2900, epoch: 5 | loss: 1.4300678
	speed: 0.0304s/iter; left time: 874.4604s
	iters: 3000, epoch: 5 | loss: 1.4845750
	speed: 0.0304s/iter; left time: 870.2229s
	iters: 3100, epoch: 5 | loss: 1.1221353
	speed: 0.0304s/iter; left time: 868.1845s
	iters: 3200, epoch: 5 | loss: 1.1720760
	speed: 0.0304s/iter; left time: 864.6501s
	iters: 3300, epoch: 5 | loss: 1.3237895
	speed: 0.0305s/iter; left time: 863.1691s
	iters: 3400, epoch: 5 | loss: 1.3103329
	speed: 0.0304s/iter; left time: 859.4553s
	iters: 3500, epoch: 5 | loss: 1.2855471
	speed: 0.0304s/iter; left time: 856.0878s
	iters: 3600, epoch: 5 | loss: 1.4126525
	speed: 0.0304s/iter; left time: 853.3093s
	iters: 3700, epoch: 5 | loss: 1.1369454
	speed: 0.0304s/iter; left time: 849.9185s
	iters: 3800, epoch: 5 | loss: 1.4518335
	speed: 0.0304s/iter; left time: 846.5955s
	iters: 3900, epoch: 5 | loss: 1.3442693
	speed: 0.0304s/iter; left time: 843.8029s
	iters: 4000, epoch: 5 | loss: 1.1377295
	speed: 0.0304s/iter; left time: 841.1347s
	iters: 4100, epoch: 5 | loss: 1.4534141
	speed: 0.0304s/iter; left time: 837.5701s
	iters: 4200, epoch: 5 | loss: 1.2358121
	speed: 0.0304s/iter; left time: 834.8800s
	iters: 4300, epoch: 5 | loss: 1.6168078
	speed: 0.0304s/iter; left time: 832.3339s
	iters: 4400, epoch: 5 | loss: 1.2009116
	speed: 0.0305s/iter; left time: 832.0030s
	iters: 4500, epoch: 5 | loss: 1.3630811
	speed: 0.0305s/iter; left time: 827.1105s
	iters: 4600, epoch: 5 | loss: 1.5414793
	speed: 0.0304s/iter; left time: 822.7816s
	iters: 4700, epoch: 5 | loss: 1.4773216
	speed: 0.0304s/iter; left time: 819.9535s
	iters: 4800, epoch: 5 | loss: 1.5143418
	speed: 0.0305s/iter; left time: 817.6088s
	iters: 4900, epoch: 5 | loss: 1.3271673
	speed: 0.0304s/iter; left time: 813.2067s
	iters: 5000, epoch: 5 | loss: 1.6095102
	speed: 0.0304s/iter; left time: 810.2600s
	iters: 5100, epoch: 5 | loss: 1.4234266
	speed: 0.0304s/iter; left time: 806.8068s
	iters: 5200, epoch: 5 | loss: 1.3966994
	speed: 0.0305s/iter; left time: 805.6142s
Epoch: 5 cost time: 160.54156804084778
Epoch: 5, Steps: 5274 | Train Loss: 1.4161940 Vali Loss: 2.5341120 Test Loss: 1.6209069
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 140701
test shape: (14070, 1, 720, 107) (14070, 1, 720, 107)
test shape: (14070, 720, 107) (14070, 720, 107)
mse:2.0381014347076416, mae:1.1277880668640137
>>>>>>>Overall time: 1342 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
