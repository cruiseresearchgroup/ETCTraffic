Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 844311
val 141087
test 141085
	iters: 100, epoch: 1 | loss: 1.6146667
	speed: 0.0333s/iter; left time: 1752.7202s
	iters: 200, epoch: 1 | loss: 1.7571551
	speed: 0.0303s/iter; left time: 1594.6184s
	iters: 300, epoch: 1 | loss: 1.4535865
	speed: 0.0305s/iter; left time: 1600.8194s
	iters: 400, epoch: 1 | loss: 1.8022879
	speed: 0.0302s/iter; left time: 1583.2226s
	iters: 500, epoch: 1 | loss: 1.7994171
	speed: 0.0304s/iter; left time: 1587.8653s
	iters: 600, epoch: 1 | loss: 1.5532314
	speed: 0.0304s/iter; left time: 1584.0129s
	iters: 700, epoch: 1 | loss: 1.5581985
	speed: 0.0304s/iter; left time: 1582.1795s
	iters: 800, epoch: 1 | loss: 1.5416085
	speed: 0.0304s/iter; left time: 1577.4641s
	iters: 900, epoch: 1 | loss: 1.7560781
	speed: 0.0304s/iter; left time: 1574.9756s
	iters: 1000, epoch: 1 | loss: 1.5379099
	speed: 0.0303s/iter; left time: 1565.7850s
	iters: 1100, epoch: 1 | loss: 1.6796019
	speed: 0.0304s/iter; left time: 1569.3140s
	iters: 1200, epoch: 1 | loss: 1.6418310
	speed: 0.0304s/iter; left time: 1566.4825s
	iters: 1300, epoch: 1 | loss: 1.6900831
	speed: 0.0304s/iter; left time: 1566.5361s
	iters: 1400, epoch: 1 | loss: 1.7427945
	speed: 0.0302s/iter; left time: 1552.6376s
	iters: 1500, epoch: 1 | loss: 1.5905710
	speed: 0.0302s/iter; left time: 1546.3307s
	iters: 1600, epoch: 1 | loss: 1.7204690
	speed: 0.0302s/iter; left time: 1543.6808s
	iters: 1700, epoch: 1 | loss: 1.4811641
	speed: 0.0304s/iter; left time: 1554.7492s
	iters: 1800, epoch: 1 | loss: 1.7823790
	speed: 0.0304s/iter; left time: 1548.8419s
	iters: 1900, epoch: 1 | loss: 1.6509397
	speed: 0.0304s/iter; left time: 1547.3699s
	iters: 2000, epoch: 1 | loss: 1.5529395
	speed: 0.0304s/iter; left time: 1542.3252s
	iters: 2100, epoch: 1 | loss: 1.7365758
	speed: 0.0303s/iter; left time: 1533.0718s
	iters: 2200, epoch: 1 | loss: 1.5681558
	speed: 0.0303s/iter; left time: 1530.3556s
	iters: 2300, epoch: 1 | loss: 1.8908496
	speed: 0.0304s/iter; left time: 1534.1517s
	iters: 2400, epoch: 1 | loss: 1.5986593
	speed: 0.0304s/iter; left time: 1528.8071s
	iters: 2500, epoch: 1 | loss: 1.7405566
	speed: 0.0305s/iter; left time: 1532.3509s
	iters: 2600, epoch: 1 | loss: 1.4282308
	speed: 0.0304s/iter; left time: 1524.3559s
	iters: 2700, epoch: 1 | loss: 1.6076940
	speed: 0.0304s/iter; left time: 1519.6572s
	iters: 2800, epoch: 1 | loss: 1.6753081
	speed: 0.0304s/iter; left time: 1520.6588s
	iters: 2900, epoch: 1 | loss: 1.6144894
	speed: 0.0304s/iter; left time: 1515.2996s
	iters: 3000, epoch: 1 | loss: 1.5882390
	speed: 0.0304s/iter; left time: 1512.3158s
	iters: 3100, epoch: 1 | loss: 1.6507200
	speed: 0.0303s/iter; left time: 1505.5661s
	iters: 3200, epoch: 1 | loss: 1.6043819
	speed: 0.0304s/iter; left time: 1507.7786s
	iters: 3300, epoch: 1 | loss: 1.5092447
	speed: 0.0303s/iter; left time: 1499.8256s
	iters: 3400, epoch: 1 | loss: 1.6014241
	speed: 0.0304s/iter; left time: 1500.3138s
	iters: 3500, epoch: 1 | loss: 1.7847240
	speed: 0.0304s/iter; left time: 1498.2972s
	iters: 3600, epoch: 1 | loss: 1.6229768
	speed: 0.0304s/iter; left time: 1495.9434s
	iters: 3700, epoch: 1 | loss: 1.6572597
	speed: 0.0305s/iter; left time: 1495.4130s
	iters: 3800, epoch: 1 | loss: 1.4761374
	speed: 0.0304s/iter; left time: 1488.2573s
	iters: 3900, epoch: 1 | loss: 1.6035267
	speed: 0.0304s/iter; left time: 1485.2734s
	iters: 4000, epoch: 1 | loss: 1.6148858
	speed: 0.0305s/iter; left time: 1485.1121s
	iters: 4100, epoch: 1 | loss: 1.7030978
	speed: 0.0303s/iter; left time: 1475.4557s
	iters: 4200, epoch: 1 | loss: 1.6789492
	speed: 0.0303s/iter; left time: 1471.0228s
	iters: 4300, epoch: 1 | loss: 1.5612439
	speed: 0.0302s/iter; left time: 1463.1321s
	iters: 4400, epoch: 1 | loss: 1.7035804
	speed: 0.0303s/iter; left time: 1463.5208s
	iters: 4500, epoch: 1 | loss: 1.6352242
	speed: 0.0304s/iter; left time: 1465.9962s
	iters: 4600, epoch: 1 | loss: 1.6802514
	speed: 0.0304s/iter; left time: 1462.6475s
	iters: 4700, epoch: 1 | loss: 1.5641562
	speed: 0.0304s/iter; left time: 1461.6798s
	iters: 4800, epoch: 1 | loss: 1.8190897
	speed: 0.0304s/iter; left time: 1458.8022s
	iters: 4900, epoch: 1 | loss: 1.6606417
	speed: 0.0304s/iter; left time: 1455.3564s
	iters: 5000, epoch: 1 | loss: 1.8769188
	speed: 0.0304s/iter; left time: 1452.0943s
	iters: 5100, epoch: 1 | loss: 1.8475953
	speed: 0.0304s/iter; left time: 1448.6990s
	iters: 5200, epoch: 1 | loss: 1.7139738
	speed: 0.0304s/iter; left time: 1447.5170s
Epoch: 1 cost time: 160.59423685073853
Epoch: 1, Steps: 5276 | Train Loss: 1.6362114 Vali Loss: 2.4339252 Test Loss: 2.1571856
Validation loss decreased (inf --> 2.433925).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.4778476
	speed: 0.7369s/iter; left time: 34916.1189s
	iters: 200, epoch: 2 | loss: 1.7414666
	speed: 0.0305s/iter; left time: 1440.9148s
	iters: 300, epoch: 2 | loss: 1.8129811
	speed: 0.0304s/iter; left time: 1433.6133s
	iters: 400, epoch: 2 | loss: 1.4647849
	speed: 0.0303s/iter; left time: 1425.3242s
	iters: 500, epoch: 2 | loss: 1.6742462
	speed: 0.0304s/iter; left time: 1427.4100s
	iters: 600, epoch: 2 | loss: 1.7115202
	speed: 0.0304s/iter; left time: 1423.8574s
	iters: 700, epoch: 2 | loss: 1.7484108
	speed: 0.0306s/iter; left time: 1431.7321s
	iters: 800, epoch: 2 | loss: 1.7096252
	speed: 0.0304s/iter; left time: 1418.2118s
	iters: 900, epoch: 2 | loss: 1.6930959
	speed: 0.0303s/iter; left time: 1410.9714s
	iters: 1000, epoch: 2 | loss: 1.9517518
	speed: 0.0304s/iter; left time: 1412.3146s
	iters: 1100, epoch: 2 | loss: 1.5176492
	speed: 0.0304s/iter; left time: 1409.3414s
	iters: 1200, epoch: 2 | loss: 1.5733088
	speed: 0.0304s/iter; left time: 1406.3212s
	iters: 1300, epoch: 2 | loss: 1.5673215
	speed: 0.0303s/iter; left time: 1399.5513s
	iters: 1400, epoch: 2 | loss: 1.6349914
	speed: 0.0304s/iter; left time: 1402.3215s
	iters: 1500, epoch: 2 | loss: 1.8016162
	speed: 0.0304s/iter; left time: 1397.5674s
	iters: 1600, epoch: 2 | loss: 1.7956688
	speed: 0.0303s/iter; left time: 1388.7109s
	iters: 1700, epoch: 2 | loss: 1.4916148
	speed: 0.0304s/iter; left time: 1392.8814s
	iters: 1800, epoch: 2 | loss: 1.5781372
	speed: 0.0305s/iter; left time: 1392.3995s
	iters: 1900, epoch: 2 | loss: 1.7441847
	speed: 0.0304s/iter; left time: 1385.9667s
	iters: 2000, epoch: 2 | loss: 1.4949789
	speed: 0.0304s/iter; left time: 1381.3109s
	iters: 2100, epoch: 2 | loss: 1.6011868
	speed: 0.0303s/iter; left time: 1374.8140s
	iters: 2200, epoch: 2 | loss: 1.7541252
	speed: 0.0304s/iter; left time: 1376.9913s
	iters: 2300, epoch: 2 | loss: 1.6862587
	speed: 0.0303s/iter; left time: 1370.1590s
	iters: 2400, epoch: 2 | loss: 1.6729475
	speed: 0.0303s/iter; left time: 1368.3123s
	iters: 2500, epoch: 2 | loss: 1.7345370
	speed: 0.0304s/iter; left time: 1368.7879s
	iters: 2600, epoch: 2 | loss: 1.7374693
	speed: 0.0304s/iter; left time: 1365.1660s
	iters: 2700, epoch: 2 | loss: 1.7437742
	speed: 0.0304s/iter; left time: 1361.3883s
	iters: 2800, epoch: 2 | loss: 1.5682436
	speed: 0.0304s/iter; left time: 1359.1302s
	iters: 2900, epoch: 2 | loss: 1.5087773
	speed: 0.0304s/iter; left time: 1356.6904s
	iters: 3000, epoch: 2 | loss: 1.6187238
	speed: 0.0304s/iter; left time: 1352.2185s
	iters: 3100, epoch: 2 | loss: 1.7472306
	speed: 0.0304s/iter; left time: 1349.4026s
	iters: 3200, epoch: 2 | loss: 1.9191810
	speed: 0.0304s/iter; left time: 1345.1769s
	iters: 3300, epoch: 2 | loss: 1.6476458
	speed: 0.0304s/iter; left time: 1342.5029s
	iters: 3400, epoch: 2 | loss: 1.4113650
	speed: 0.0305s/iter; left time: 1345.4277s
	iters: 3500, epoch: 2 | loss: 1.4491199
	speed: 0.0304s/iter; left time: 1337.1448s
	iters: 3600, epoch: 2 | loss: 1.5194904
	speed: 0.0304s/iter; left time: 1333.5682s
	iters: 3700, epoch: 2 | loss: 1.5726953
	speed: 0.0304s/iter; left time: 1329.4037s
	iters: 3800, epoch: 2 | loss: 1.7028795
	speed: 0.0302s/iter; left time: 1318.4228s
	iters: 3900, epoch: 2 | loss: 1.7364697
	speed: 0.0304s/iter; left time: 1324.8970s
	iters: 4000, epoch: 2 | loss: 1.5283750
	speed: 0.0303s/iter; left time: 1318.8010s
	iters: 4100, epoch: 2 | loss: 1.5732007
	speed: 0.0304s/iter; left time: 1318.0896s
	iters: 4200, epoch: 2 | loss: 1.7597718
	speed: 0.0303s/iter; left time: 1311.2835s
	iters: 4300, epoch: 2 | loss: 1.5403311
	speed: 0.0304s/iter; left time: 1313.0592s
	iters: 4400, epoch: 2 | loss: 1.3767744
	speed: 0.0304s/iter; left time: 1310.9003s
	iters: 4500, epoch: 2 | loss: 1.8259919
	speed: 0.0301s/iter; left time: 1295.7958s
	iters: 4600, epoch: 2 | loss: 1.4958682
	speed: 0.0304s/iter; left time: 1305.0809s
	iters: 4700, epoch: 2 | loss: 1.5715117
	speed: 0.0304s/iter; left time: 1299.1375s
	iters: 4800, epoch: 2 | loss: 1.6080300
	speed: 0.0304s/iter; left time: 1296.2607s
	iters: 4900, epoch: 2 | loss: 1.6845846
	speed: 0.0303s/iter; left time: 1290.3901s
	iters: 5000, epoch: 2 | loss: 1.5504414
	speed: 0.0304s/iter; left time: 1291.4146s
	iters: 5100, epoch: 2 | loss: 1.6085083
	speed: 0.0304s/iter; left time: 1288.0270s
	iters: 5200, epoch: 2 | loss: 1.7553234
	speed: 0.0306s/iter; left time: 1294.2775s
Epoch: 2 cost time: 160.42490911483765
Epoch: 2, Steps: 5276 | Train Loss: 1.6386283 Vali Loss: 2.4352150 Test Loss: 2.1559844
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.5969093
	speed: 0.7333s/iter; left time: 30878.5451s
	iters: 200, epoch: 3 | loss: 1.7632955
	speed: 0.0304s/iter; left time: 1275.4475s
	iters: 300, epoch: 3 | loss: 1.5555478
	speed: 0.0304s/iter; left time: 1272.5531s
	iters: 400, epoch: 3 | loss: 1.6407669
	speed: 0.0304s/iter; left time: 1271.2763s
	iters: 500, epoch: 3 | loss: 1.6338017
	speed: 0.0304s/iter; left time: 1266.8450s
	iters: 600, epoch: 3 | loss: 1.6294172
	speed: 0.0305s/iter; left time: 1269.0976s
	iters: 700, epoch: 3 | loss: 1.4326445
	speed: 0.0304s/iter; left time: 1260.0792s
	iters: 800, epoch: 3 | loss: 1.5525240
	speed: 0.0303s/iter; left time: 1254.7865s
	iters: 900, epoch: 3 | loss: 1.4754964
	speed: 0.0305s/iter; left time: 1257.9525s
	iters: 1000, epoch: 3 | loss: 1.4514691
	speed: 0.0304s/iter; left time: 1252.3981s
	iters: 1100, epoch: 3 | loss: 1.6943655
	speed: 0.0304s/iter; left time: 1249.4015s
	iters: 1200, epoch: 3 | loss: 1.8130517
	speed: 0.0304s/iter; left time: 1245.5701s
	iters: 1300, epoch: 3 | loss: 1.5948975
	speed: 0.0304s/iter; left time: 1244.4186s
	iters: 1400, epoch: 3 | loss: 1.6388528
	speed: 0.0303s/iter; left time: 1235.6374s
	iters: 1500, epoch: 3 | loss: 1.4342748
	speed: 0.0303s/iter; left time: 1235.3889s
	iters: 1600, epoch: 3 | loss: 1.6579700
	speed: 0.0304s/iter; left time: 1232.6552s
	iters: 1700, epoch: 3 | loss: 1.5654997
	speed: 0.0305s/iter; left time: 1233.5316s
	iters: 1800, epoch: 3 | loss: 1.5593323
	speed: 0.0304s/iter; left time: 1229.3049s
	iters: 1900, epoch: 3 | loss: 1.8288711
	speed: 0.0304s/iter; left time: 1224.7452s
	iters: 2000, epoch: 3 | loss: 1.6525518
	speed: 0.0304s/iter; left time: 1223.9543s
	iters: 2100, epoch: 3 | loss: 1.6923721
	speed: 0.0304s/iter; left time: 1218.5768s
	iters: 2200, epoch: 3 | loss: 1.5972712
	speed: 0.0304s/iter; left time: 1216.9107s
	iters: 2300, epoch: 3 | loss: 1.7191309
	speed: 0.0302s/iter; left time: 1204.7657s
	iters: 2400, epoch: 3 | loss: 1.7179362
	speed: 0.0303s/iter; left time: 1206.5711s
	iters: 2500, epoch: 3 | loss: 1.5678735
	speed: 0.0303s/iter; left time: 1202.8390s
	iters: 2600, epoch: 3 | loss: 1.5396845
	speed: 0.0304s/iter; left time: 1204.4527s
	iters: 2700, epoch: 3 | loss: 1.6789290
	speed: 0.0304s/iter; left time: 1200.9156s
	iters: 2800, epoch: 3 | loss: 1.6781646
	speed: 0.0304s/iter; left time: 1198.8751s
	iters: 2900, epoch: 3 | loss: 1.4686137
	speed: 0.0303s/iter; left time: 1190.7020s
	iters: 3000, epoch: 3 | loss: 1.4629230
	speed: 0.0304s/iter; left time: 1191.2679s
	iters: 3100, epoch: 3 | loss: 1.5506294
	speed: 0.0305s/iter; left time: 1191.5757s
	iters: 3200, epoch: 3 | loss: 1.7070101
	speed: 0.0304s/iter; left time: 1187.3322s
	iters: 3300, epoch: 3 | loss: 1.8196298
	speed: 0.0304s/iter; left time: 1182.7949s
	iters: 3400, epoch: 3 | loss: 1.7188373
	speed: 0.0304s/iter; left time: 1179.5619s
	iters: 3500, epoch: 3 | loss: 1.5232373
	speed: 0.0304s/iter; left time: 1175.7107s
	iters: 3600, epoch: 3 | loss: 1.7454679
	speed: 0.0304s/iter; left time: 1173.6591s
	iters: 3700, epoch: 3 | loss: 1.4233793
	speed: 0.0305s/iter; left time: 1173.8126s
	iters: 3800, epoch: 3 | loss: 1.6418890
	speed: 0.0305s/iter; left time: 1171.7183s
	iters: 3900, epoch: 3 | loss: 1.5493785
	speed: 0.0304s/iter; left time: 1163.4455s
	iters: 4000, epoch: 3 | loss: 1.7119083
	speed: 0.0304s/iter; left time: 1160.6656s
	iters: 4100, epoch: 3 | loss: 1.5368617
	speed: 0.0303s/iter; left time: 1155.4395s
	iters: 4200, epoch: 3 | loss: 1.7768828
	speed: 0.0304s/iter; left time: 1155.1401s
	iters: 4300, epoch: 3 | loss: 1.5674777
	speed: 0.0304s/iter; left time: 1152.3109s
	iters: 4400, epoch: 3 | loss: 1.7892262
	speed: 0.0304s/iter; left time: 1150.0992s
	iters: 4500, epoch: 3 | loss: 1.6845864
	speed: 0.0303s/iter; left time: 1141.2885s
	iters: 4600, epoch: 3 | loss: 1.7298208
	speed: 0.0305s/iter; left time: 1146.1641s
	iters: 4700, epoch: 3 | loss: 1.4799393
	speed: 0.0303s/iter; left time: 1137.2217s
	iters: 4800, epoch: 3 | loss: 1.5762702
	speed: 0.0304s/iter; left time: 1136.2381s
	iters: 4900, epoch: 3 | loss: 1.5850630
	speed: 0.0304s/iter; left time: 1134.6415s
	iters: 5000, epoch: 3 | loss: 1.6630700
	speed: 0.0304s/iter; left time: 1131.2668s
	iters: 5100, epoch: 3 | loss: 1.5361259
	speed: 0.0303s/iter; left time: 1125.0240s
	iters: 5200, epoch: 3 | loss: 1.6386878
	speed: 0.0304s/iter; left time: 1125.7759s
Epoch: 3 cost time: 160.41923451423645
Epoch: 3, Steps: 5276 | Train Loss: 1.6381493 Vali Loss: 2.4390333 Test Loss: 2.1589482
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.3995181
	speed: 0.7328s/iter; left time: 26991.0769s
	iters: 200, epoch: 4 | loss: 1.4978238
	speed: 0.0304s/iter; left time: 1115.7558s
	iters: 300, epoch: 4 | loss: 1.4803499
	speed: 0.0303s/iter; left time: 1108.5031s
	iters: 400, epoch: 4 | loss: 1.6416636
	speed: 0.0303s/iter; left time: 1107.2985s
	iters: 500, epoch: 4 | loss: 1.5663406
	speed: 0.0304s/iter; left time: 1106.4896s
	iters: 600, epoch: 4 | loss: 1.5941761
	speed: 0.0303s/iter; left time: 1100.8400s
	iters: 700, epoch: 4 | loss: 1.8207330
	speed: 0.0304s/iter; left time: 1101.0545s
	iters: 800, epoch: 4 | loss: 1.7950603
	speed: 0.0304s/iter; left time: 1097.5283s
	iters: 900, epoch: 4 | loss: 1.7332107
	speed: 0.0303s/iter; left time: 1093.4967s
	iters: 1000, epoch: 4 | loss: 1.4106922
	speed: 0.0303s/iter; left time: 1088.4050s
	iters: 1100, epoch: 4 | loss: 1.6409025
	speed: 0.0304s/iter; left time: 1089.8173s
	iters: 1200, epoch: 4 | loss: 1.5200299
	speed: 0.0302s/iter; left time: 1077.6321s
	iters: 1300, epoch: 4 | loss: 1.5606935
	speed: 0.0305s/iter; left time: 1087.8092s
	iters: 1400, epoch: 4 | loss: 1.7056026
	speed: 0.0305s/iter; left time: 1082.2524s
	iters: 1500, epoch: 4 | loss: 1.6954881
	speed: 0.0304s/iter; left time: 1076.3330s
	iters: 1600, epoch: 4 | loss: 1.5321542
	speed: 0.0304s/iter; left time: 1073.3146s
	iters: 1700, epoch: 4 | loss: 1.6350422
	speed: 0.0302s/iter; left time: 1063.4705s
	iters: 1800, epoch: 4 | loss: 1.5971410
	speed: 0.0304s/iter; left time: 1068.0232s
	iters: 1900, epoch: 4 | loss: 1.6456858
	speed: 0.0304s/iter; left time: 1063.5366s
	iters: 2000, epoch: 4 | loss: 1.4675591
	speed: 0.0304s/iter; left time: 1061.5904s
	iters: 2100, epoch: 4 | loss: 1.6527108
	speed: 0.0304s/iter; left time: 1058.2752s
	iters: 2200, epoch: 4 | loss: 1.6689028
	speed: 0.0303s/iter; left time: 1052.3237s
	iters: 2300, epoch: 4 | loss: 1.5787251
	speed: 0.0304s/iter; left time: 1052.5482s
	iters: 2400, epoch: 4 | loss: 1.4858301
	speed: 0.0301s/iter; left time: 1038.3570s
	iters: 2500, epoch: 4 | loss: 1.5171641
	speed: 0.0304s/iter; left time: 1047.5703s
	iters: 2600, epoch: 4 | loss: 1.3013219
	speed: 0.0305s/iter; left time: 1045.8821s
	iters: 2700, epoch: 4 | loss: 1.4540352
	speed: 0.0304s/iter; left time: 1039.7733s
	iters: 2800, epoch: 4 | loss: 1.3666072
	speed: 0.0304s/iter; left time: 1037.0988s
	iters: 2900, epoch: 4 | loss: 1.6962887
	speed: 0.0304s/iter; left time: 1035.9378s
	iters: 3000, epoch: 4 | loss: 1.7840633
	speed: 0.0305s/iter; left time: 1034.1267s
	iters: 3100, epoch: 4 | loss: 1.8044671
	speed: 0.0304s/iter; left time: 1028.3822s
	iters: 3200, epoch: 4 | loss: 1.5068631
	speed: 0.0304s/iter; left time: 1025.0682s
	iters: 3300, epoch: 4 | loss: 1.6947546
	speed: 0.0304s/iter; left time: 1022.8654s
	iters: 3400, epoch: 4 | loss: 1.7327651
	speed: 0.0304s/iter; left time: 1019.1508s
	iters: 3500, epoch: 4 | loss: 1.5440072
	speed: 0.0304s/iter; left time: 1016.0402s
	iters: 3600, epoch: 4 | loss: 1.6752886
	speed: 0.0302s/iter; left time: 1006.4306s
	iters: 3700, epoch: 4 | loss: 1.3823498
	speed: 0.0303s/iter; left time: 1007.0938s
	iters: 3800, epoch: 4 | loss: 1.6627278
	speed: 0.0304s/iter; left time: 1006.3879s
	iters: 3900, epoch: 4 | loss: 1.5134345
	speed: 0.0304s/iter; left time: 1003.1389s
	iters: 4000, epoch: 4 | loss: 1.4059269
	speed: 0.0304s/iter; left time: 1002.0225s
	iters: 4100, epoch: 4 | loss: 1.5831469
	speed: 0.0303s/iter; left time: 994.6161s
	iters: 4200, epoch: 4 | loss: 1.5968400
	speed: 0.0303s/iter; left time: 990.7211s
	iters: 4300, epoch: 4 | loss: 1.5657291
	speed: 0.0304s/iter; left time: 992.2246s
	iters: 4400, epoch: 4 | loss: 1.7378569
	speed: 0.0304s/iter; left time: 989.2873s
	iters: 4500, epoch: 4 | loss: 1.7933991
	speed: 0.0304s/iter; left time: 986.0956s
	iters: 4600, epoch: 4 | loss: 1.3880297
	speed: 0.0304s/iter; left time: 983.9700s
	iters: 4700, epoch: 4 | loss: 1.7246822
	speed: 0.0304s/iter; left time: 979.6810s
	iters: 4800, epoch: 4 | loss: 1.6383806
	speed: 0.0304s/iter; left time: 975.9066s
	iters: 4900, epoch: 4 | loss: 1.4503182
	speed: 0.0305s/iter; left time: 976.7668s
	iters: 5000, epoch: 4 | loss: 1.5630370
	speed: 0.0304s/iter; left time: 971.5787s
	iters: 5100, epoch: 4 | loss: 1.5310917
	speed: 0.0304s/iter; left time: 967.1667s
	iters: 5200, epoch: 4 | loss: 1.4918894
	speed: 0.0304s/iter; left time: 964.6613s
Epoch: 4 cost time: 160.33673787117004
Epoch: 4, Steps: 5276 | Train Loss: 1.6344583 Vali Loss: 2.4374464 Test Loss: 2.1579254
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141085
test shape: (14108, 1, 336, 107) (14108, 1, 336, 107)
test shape: (14108, 336, 107) (14108, 336, 107)
mse:2.1571884155273438, mae:1.1683852672576904
>>>>>>>Overall time: 1050 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
