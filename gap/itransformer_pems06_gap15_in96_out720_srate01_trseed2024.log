Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 742470
val 141828
test 141826
	iters: 100, epoch: 1 | loss: 1.3988602
	speed: 0.0335s/iter; left time: 1550.0890s
	iters: 200, epoch: 1 | loss: 1.8324382
	speed: 0.0304s/iter; left time: 1404.1250s
	iters: 300, epoch: 1 | loss: 1.4269152
	speed: 0.0304s/iter; left time: 1402.1566s
	iters: 400, epoch: 1 | loss: 1.7309190
	speed: 0.0304s/iter; left time: 1399.7968s
	iters: 500, epoch: 1 | loss: 1.4252919
	speed: 0.0304s/iter; left time: 1396.1109s
	iters: 600, epoch: 1 | loss: 1.7388084
	speed: 0.0305s/iter; left time: 1396.3157s
	iters: 700, epoch: 1 | loss: 1.4255692
	speed: 0.0304s/iter; left time: 1390.3408s
	iters: 800, epoch: 1 | loss: 1.4763266
	speed: 0.0304s/iter; left time: 1385.7942s
	iters: 900, epoch: 1 | loss: 1.3481333
	speed: 0.0304s/iter; left time: 1384.4066s
	iters: 1000, epoch: 1 | loss: 1.3963977
	speed: 0.0304s/iter; left time: 1379.2759s
	iters: 1100, epoch: 1 | loss: 1.5445272
	speed: 0.0304s/iter; left time: 1376.8913s
	iters: 1200, epoch: 1 | loss: 1.9466797
	speed: 0.0306s/iter; left time: 1381.7566s
	iters: 1300, epoch: 1 | loss: 1.6001239
	speed: 0.0304s/iter; left time: 1371.3983s
	iters: 1400, epoch: 1 | loss: 1.3762573
	speed: 0.0306s/iter; left time: 1377.2534s
	iters: 1500, epoch: 1 | loss: 1.6421521
	speed: 0.0304s/iter; left time: 1365.6533s
	iters: 1600, epoch: 1 | loss: 1.4398056
	speed: 0.0304s/iter; left time: 1362.5915s
	iters: 1700, epoch: 1 | loss: 1.6467367
	speed: 0.0306s/iter; left time: 1368.2655s
	iters: 1800, epoch: 1 | loss: 1.3447784
	speed: 0.0305s/iter; left time: 1360.7024s
	iters: 1900, epoch: 1 | loss: 1.8494254
	speed: 0.0305s/iter; left time: 1355.5953s
	iters: 2000, epoch: 1 | loss: 1.3740374
	speed: 0.0308s/iter; left time: 1368.4764s
	iters: 2100, epoch: 1 | loss: 1.9989280
	speed: 0.0304s/iter; left time: 1347.6550s
	iters: 2200, epoch: 1 | loss: 1.9022846
	speed: 0.0304s/iter; left time: 1343.9462s
	iters: 2300, epoch: 1 | loss: 1.4727210
	speed: 0.0304s/iter; left time: 1341.8193s
	iters: 2400, epoch: 1 | loss: 1.6917187
	speed: 0.0304s/iter; left time: 1337.0304s
	iters: 2500, epoch: 1 | loss: 1.5338962
	speed: 0.0304s/iter; left time: 1336.3969s
	iters: 2600, epoch: 1 | loss: 1.3921026
	speed: 0.0305s/iter; left time: 1338.0234s
	iters: 2700, epoch: 1 | loss: 1.6000456
	speed: 0.0305s/iter; left time: 1330.7229s
	iters: 2800, epoch: 1 | loss: 1.3659219
	speed: 0.0304s/iter; left time: 1325.6554s
	iters: 2900, epoch: 1 | loss: 1.7216017
	speed: 0.0304s/iter; left time: 1323.0115s
	iters: 3000, epoch: 1 | loss: 1.3793241
	speed: 0.0304s/iter; left time: 1319.4879s
	iters: 3100, epoch: 1 | loss: 1.3242704
	speed: 0.0304s/iter; left time: 1316.4681s
	iters: 3200, epoch: 1 | loss: 1.5444328
	speed: 0.0304s/iter; left time: 1312.7315s
	iters: 3300, epoch: 1 | loss: 1.2391299
	speed: 0.0304s/iter; left time: 1309.9079s
	iters: 3400, epoch: 1 | loss: 1.8130232
	speed: 0.0304s/iter; left time: 1307.3208s
	iters: 3500, epoch: 1 | loss: 2.0188296
	speed: 0.0304s/iter; left time: 1303.6516s
	iters: 3600, epoch: 1 | loss: 1.8163188
	speed: 0.0304s/iter; left time: 1301.9510s
	iters: 3700, epoch: 1 | loss: 1.6574763
	speed: 0.0304s/iter; left time: 1298.3376s
	iters: 3800, epoch: 1 | loss: 1.8369187
	speed: 0.0306s/iter; left time: 1303.2816s
	iters: 3900, epoch: 1 | loss: 1.7627282
	speed: 0.0305s/iter; left time: 1296.1042s
	iters: 4000, epoch: 1 | loss: 1.8981614
	speed: 0.0304s/iter; left time: 1290.2056s
	iters: 4100, epoch: 1 | loss: 1.5011979
	speed: 0.0308s/iter; left time: 1303.3463s
	iters: 4200, epoch: 1 | loss: 1.5318091
	speed: 0.0305s/iter; left time: 1288.0159s
	iters: 4300, epoch: 1 | loss: 1.4424955
	speed: 0.0304s/iter; left time: 1281.4666s
	iters: 4400, epoch: 1 | loss: 1.7552770
	speed: 0.0304s/iter; left time: 1276.6909s
	iters: 4500, epoch: 1 | loss: 1.4020402
	speed: 0.0304s/iter; left time: 1274.8100s
	iters: 4600, epoch: 1 | loss: 1.3235101
	speed: 0.0304s/iter; left time: 1270.5962s
Epoch: 1 cost time: 141.6923942565918
Epoch: 1, Steps: 4640 | Train Loss: 1.5864623 Vali Loss: 1.2546911 Test Loss: 1.3360227
Validation loss decreased (inf --> 1.254691).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.4994805
	speed: 0.8464s/iter; left time: 35262.5130s
	iters: 200, epoch: 2 | loss: 1.3917984
	speed: 0.0304s/iter; left time: 1263.5308s
	iters: 300, epoch: 2 | loss: 1.6398045
	speed: 0.0304s/iter; left time: 1260.2582s
	iters: 400, epoch: 2 | loss: 1.6523213
	speed: 0.0304s/iter; left time: 1257.4622s
	iters: 500, epoch: 2 | loss: 1.5764585
	speed: 0.0304s/iter; left time: 1254.6738s
	iters: 600, epoch: 2 | loss: 1.7049505
	speed: 0.0305s/iter; left time: 1254.9503s
	iters: 700, epoch: 2 | loss: 1.5412390
	speed: 0.0304s/iter; left time: 1247.5451s
	iters: 800, epoch: 2 | loss: 1.6065571
	speed: 0.0307s/iter; left time: 1257.8858s
	iters: 900, epoch: 2 | loss: 1.6983720
	speed: 0.0304s/iter; left time: 1242.2012s
	iters: 1000, epoch: 2 | loss: 1.7654046
	speed: 0.0304s/iter; left time: 1237.9693s
	iters: 1100, epoch: 2 | loss: 1.6522334
	speed: 0.0305s/iter; left time: 1240.3228s
	iters: 1200, epoch: 2 | loss: 1.3248397
	speed: 0.0311s/iter; left time: 1260.4342s
	iters: 1300, epoch: 2 | loss: 1.7238982
	speed: 0.0304s/iter; left time: 1229.9803s
	iters: 1400, epoch: 2 | loss: 1.5587757
	speed: 0.0304s/iter; left time: 1226.7146s
	iters: 1500, epoch: 2 | loss: 1.5153636
	speed: 0.0304s/iter; left time: 1224.1112s
	iters: 1600, epoch: 2 | loss: 1.7088104
	speed: 0.0304s/iter; left time: 1222.1444s
	iters: 1700, epoch: 2 | loss: 1.9772959
	speed: 0.0304s/iter; left time: 1217.0697s
	iters: 1800, epoch: 2 | loss: 1.1832401
	speed: 0.0304s/iter; left time: 1214.5348s
	iters: 1900, epoch: 2 | loss: 1.6169103
	speed: 0.0304s/iter; left time: 1210.3265s
	iters: 2000, epoch: 2 | loss: 1.6892521
	speed: 0.0306s/iter; left time: 1215.0282s
	iters: 2100, epoch: 2 | loss: 1.6046120
	speed: 0.0304s/iter; left time: 1207.3676s
	iters: 2200, epoch: 2 | loss: 1.9032029
	speed: 0.0304s/iter; left time: 1201.6352s
	iters: 2300, epoch: 2 | loss: 1.5586109
	speed: 0.0304s/iter; left time: 1199.2004s
	iters: 2400, epoch: 2 | loss: 1.6142782
	speed: 0.0304s/iter; left time: 1196.2146s
	iters: 2500, epoch: 2 | loss: 1.7882015
	speed: 0.0304s/iter; left time: 1193.2957s
	iters: 2600, epoch: 2 | loss: 1.5369380
	speed: 0.0304s/iter; left time: 1189.3652s
	iters: 2700, epoch: 2 | loss: 1.6976509
	speed: 0.0304s/iter; left time: 1187.1901s
	iters: 2800, epoch: 2 | loss: 1.4387180
	speed: 0.0304s/iter; left time: 1182.9895s
	iters: 2900, epoch: 2 | loss: 1.8446546
	speed: 0.0304s/iter; left time: 1180.6129s
	iters: 3000, epoch: 2 | loss: 1.7710227
	speed: 0.0304s/iter; left time: 1178.0540s
	iters: 3100, epoch: 2 | loss: 1.5881875
	speed: 0.0304s/iter; left time: 1175.5936s
	iters: 3200, epoch: 2 | loss: 1.6551943
	speed: 0.0304s/iter; left time: 1172.2012s
	iters: 3300, epoch: 2 | loss: 1.6817795
	speed: 0.0304s/iter; left time: 1169.4450s
	iters: 3400, epoch: 2 | loss: 1.8284408
	speed: 0.0304s/iter; left time: 1165.5205s
	iters: 3500, epoch: 2 | loss: 1.5025649
	speed: 0.0304s/iter; left time: 1162.6786s
	iters: 3600, epoch: 2 | loss: 1.8056577
	speed: 0.0304s/iter; left time: 1158.7764s
	iters: 3700, epoch: 2 | loss: 1.5407059
	speed: 0.0307s/iter; left time: 1169.2514s
	iters: 3800, epoch: 2 | loss: 2.0917609
	speed: 0.0306s/iter; left time: 1162.2755s
	iters: 3900, epoch: 2 | loss: 1.8306522
	speed: 0.0310s/iter; left time: 1173.3083s
	iters: 4000, epoch: 2 | loss: 1.4790785
	speed: 0.0306s/iter; left time: 1155.8170s
	iters: 4100, epoch: 2 | loss: 1.6027827
	speed: 0.0304s/iter; left time: 1145.1503s
	iters: 4200, epoch: 2 | loss: 1.6758884
	speed: 0.0304s/iter; left time: 1141.3577s
	iters: 4300, epoch: 2 | loss: 1.6271429
	speed: 0.0304s/iter; left time: 1137.6845s
	iters: 4400, epoch: 2 | loss: 1.2877311
	speed: 0.0304s/iter; left time: 1134.8957s
	iters: 4500, epoch: 2 | loss: 1.6185253
	speed: 0.0304s/iter; left time: 1132.6403s
	iters: 4600, epoch: 2 | loss: 1.3486438
	speed: 0.0304s/iter; left time: 1129.4067s
Epoch: 2 cost time: 141.44058084487915
Epoch: 2, Steps: 4640 | Train Loss: 1.6159933 Vali Loss: 1.2523898 Test Loss: 1.3346164
Validation loss decreased (1.254691 --> 1.252390).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6610279
	speed: 0.8460s/iter; left time: 31319.1394s
	iters: 200, epoch: 3 | loss: 1.4815478
	speed: 0.0304s/iter; left time: 1120.8671s
	iters: 300, epoch: 3 | loss: 1.4983447
	speed: 0.0304s/iter; left time: 1118.4759s
	iters: 400, epoch: 3 | loss: 1.7567338
	speed: 0.0304s/iter; left time: 1115.8290s
	iters: 500, epoch: 3 | loss: 1.7391950
	speed: 0.0306s/iter; left time: 1120.3966s
	iters: 600, epoch: 3 | loss: 1.4653041
	speed: 0.0304s/iter; left time: 1109.4014s
	iters: 700, epoch: 3 | loss: 1.6935930
	speed: 0.0306s/iter; left time: 1112.7340s
	iters: 800, epoch: 3 | loss: 1.4735490
	speed: 0.0305s/iter; left time: 1107.2870s
	iters: 900, epoch: 3 | loss: 1.6588855
	speed: 0.0304s/iter; left time: 1100.6546s
	iters: 1000, epoch: 3 | loss: 1.4872965
	speed: 0.0306s/iter; left time: 1105.6014s
	iters: 1100, epoch: 3 | loss: 1.7703582
	speed: 0.0304s/iter; left time: 1094.7007s
	iters: 1200, epoch: 3 | loss: 1.8095645
	speed: 0.0304s/iter; left time: 1092.4565s
	iters: 1300, epoch: 3 | loss: 1.4890040
	speed: 0.0304s/iter; left time: 1088.6546s
	iters: 1400, epoch: 3 | loss: 1.5054437
	speed: 0.0304s/iter; left time: 1085.5447s
	iters: 1500, epoch: 3 | loss: 1.6426015
	speed: 0.0304s/iter; left time: 1082.7672s
	iters: 1600, epoch: 3 | loss: 1.5038635
	speed: 0.0304s/iter; left time: 1080.5830s
	iters: 1700, epoch: 3 | loss: 1.5071100
	speed: 0.0306s/iter; left time: 1082.7554s
	iters: 1800, epoch: 3 | loss: 1.7937193
	speed: 0.0304s/iter; left time: 1072.9176s
	iters: 1900, epoch: 3 | loss: 1.6674099
	speed: 0.0305s/iter; left time: 1074.5642s
	iters: 2000, epoch: 3 | loss: 1.7518777
	speed: 0.0304s/iter; left time: 1066.5854s
	iters: 2100, epoch: 3 | loss: 1.2555978
	speed: 0.0306s/iter; left time: 1071.3301s
	iters: 2200, epoch: 3 | loss: 1.3279153
	speed: 0.0306s/iter; left time: 1068.8896s
	iters: 2300, epoch: 3 | loss: 1.5753158
	speed: 0.0305s/iter; left time: 1061.6014s
	iters: 2400, epoch: 3 | loss: 1.4272535
	speed: 0.0307s/iter; left time: 1064.6171s
	iters: 2500, epoch: 3 | loss: 1.6002817
	speed: 0.0308s/iter; left time: 1066.4335s
	iters: 2600, epoch: 3 | loss: 1.5454923
	speed: 0.0304s/iter; left time: 1050.5137s
	iters: 2700, epoch: 3 | loss: 1.3894895
	speed: 0.0304s/iter; left time: 1047.2439s
	iters: 2800, epoch: 3 | loss: 2.0538387
	speed: 0.0304s/iter; left time: 1042.4607s
	iters: 2900, epoch: 3 | loss: 1.4829167
	speed: 0.0304s/iter; left time: 1040.6837s
	iters: 3000, epoch: 3 | loss: 1.7966204
	speed: 0.0307s/iter; left time: 1047.5776s
	iters: 3100, epoch: 3 | loss: 1.4962168
	speed: 0.0305s/iter; left time: 1036.1046s
	iters: 3200, epoch: 3 | loss: 1.4462969
	speed: 0.0304s/iter; left time: 1031.9018s
	iters: 3300, epoch: 3 | loss: 1.9231881
	speed: 0.0308s/iter; left time: 1042.6768s
	iters: 3400, epoch: 3 | loss: 1.4316748
	speed: 0.0308s/iter; left time: 1038.9338s
	iters: 3500, epoch: 3 | loss: 1.9372813
	speed: 0.0308s/iter; left time: 1034.8762s
	iters: 3600, epoch: 3 | loss: 1.7185336
	speed: 0.0306s/iter; left time: 1024.9282s
	iters: 3700, epoch: 3 | loss: 1.4032779
	speed: 0.0306s/iter; left time: 1021.9164s
	iters: 3800, epoch: 3 | loss: 1.5982358
	speed: 0.0306s/iter; left time: 1020.0146s
	iters: 3900, epoch: 3 | loss: 1.2485602
	speed: 0.0305s/iter; left time: 1013.7227s
	iters: 4000, epoch: 3 | loss: 1.3936929
	speed: 0.0308s/iter; left time: 1020.4160s
	iters: 4100, epoch: 3 | loss: 1.3606293
	speed: 0.0307s/iter; left time: 1012.9852s
	iters: 4200, epoch: 3 | loss: 1.5020673
	speed: 0.0307s/iter; left time: 1009.7230s
	iters: 4300, epoch: 3 | loss: 1.6195803
	speed: 0.0304s/iter; left time: 997.7247s
	iters: 4400, epoch: 3 | loss: 1.8176649
	speed: 0.0304s/iter; left time: 994.2699s
	iters: 4500, epoch: 3 | loss: 1.5139902
	speed: 0.0304s/iter; left time: 991.0144s
	iters: 4600, epoch: 3 | loss: 1.4530717
	speed: 0.0305s/iter; left time: 993.1770s
Epoch: 3 cost time: 141.7613525390625
Epoch: 3, Steps: 4640 | Train Loss: 1.6155680 Vali Loss: 1.2525765 Test Loss: 1.3365095
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.3778834
	speed: 0.8542s/iter; left time: 27658.5904s
	iters: 200, epoch: 4 | loss: 1.5118710
	speed: 0.0311s/iter; left time: 1005.3106s
	iters: 300, epoch: 4 | loss: 1.4191756
	speed: 0.0308s/iter; left time: 992.6643s
	iters: 400, epoch: 4 | loss: 1.3893982
	speed: 0.0312s/iter; left time: 999.5648s
	iters: 500, epoch: 4 | loss: 1.6087608
	speed: 0.0310s/iter; left time: 992.4451s
	iters: 600, epoch: 4 | loss: 1.7004389
	speed: 0.0312s/iter; left time: 995.8651s
	iters: 700, epoch: 4 | loss: 1.5286305
	speed: 0.0311s/iter; left time: 988.3528s
	iters: 800, epoch: 4 | loss: 1.6650792
	speed: 0.0314s/iter; left time: 995.4502s
	iters: 900, epoch: 4 | loss: 1.4740975
	speed: 0.0311s/iter; left time: 981.2432s
	iters: 1000, epoch: 4 | loss: 1.7061418
	speed: 0.0315s/iter; left time: 991.6115s
	iters: 1100, epoch: 4 | loss: 1.4023049
	speed: 0.0311s/iter; left time: 975.8430s
	iters: 1200, epoch: 4 | loss: 1.5817474
	speed: 0.0311s/iter; left time: 972.0085s
	iters: 1300, epoch: 4 | loss: 2.0284762
	speed: 0.0310s/iter; left time: 967.7633s
	iters: 1400, epoch: 4 | loss: 1.4364328
	speed: 0.0310s/iter; left time: 964.2373s
	iters: 1500, epoch: 4 | loss: 1.5406587
	speed: 0.0310s/iter; left time: 960.4879s
	iters: 1600, epoch: 4 | loss: 1.4329162
	speed: 0.0309s/iter; left time: 955.0707s
	iters: 1700, epoch: 4 | loss: 1.4615923
	speed: 0.0313s/iter; left time: 963.2962s
	iters: 1800, epoch: 4 | loss: 1.4784732
	speed: 0.0309s/iter; left time: 946.9747s
	iters: 1900, epoch: 4 | loss: 1.9583284
	speed: 0.0310s/iter; left time: 949.3994s
	iters: 2000, epoch: 4 | loss: 1.8676395
	speed: 0.0310s/iter; left time: 943.4495s
	iters: 2100, epoch: 4 | loss: 1.3424885
	speed: 0.0312s/iter; left time: 948.2932s
	iters: 2200, epoch: 4 | loss: 1.7372563
	speed: 0.0311s/iter; left time: 940.4731s
	iters: 2300, epoch: 4 | loss: 1.7580515
	speed: 0.0308s/iter; left time: 929.9656s
	iters: 2400, epoch: 4 | loss: 1.2709889
	speed: 0.0307s/iter; left time: 924.4238s
	iters: 2500, epoch: 4 | loss: 1.7211038
	speed: 0.0309s/iter; left time: 926.1670s
	iters: 2600, epoch: 4 | loss: 1.3309726
	speed: 0.0306s/iter; left time: 914.9962s
	iters: 2700, epoch: 4 | loss: 1.4700131
	speed: 0.0309s/iter; left time: 918.9775s
	iters: 2800, epoch: 4 | loss: 1.4391451
	speed: 0.0311s/iter; left time: 922.3836s
	iters: 2900, epoch: 4 | loss: 1.5662950
	speed: 0.0310s/iter; left time: 916.2005s
	iters: 3000, epoch: 4 | loss: 1.6368414
	speed: 0.0311s/iter; left time: 916.4546s
	iters: 3100, epoch: 4 | loss: 1.4678403
	speed: 0.0308s/iter; left time: 905.7300s
	iters: 3200, epoch: 4 | loss: 1.5166941
	speed: 0.0314s/iter; left time: 918.4907s
	iters: 3300, epoch: 4 | loss: 1.7101419
	speed: 0.0307s/iter; left time: 895.9395s
	iters: 3400, epoch: 4 | loss: 1.6198955
	speed: 0.0309s/iter; left time: 898.4087s
	iters: 3500, epoch: 4 | loss: 1.6102340
	speed: 0.0310s/iter; left time: 897.8245s
	iters: 3600, epoch: 4 | loss: 1.7669561
	speed: 0.0311s/iter; left time: 898.3793s
	iters: 3700, epoch: 4 | loss: 1.6123885
	speed: 0.0310s/iter; left time: 890.8925s
	iters: 3800, epoch: 4 | loss: 1.8335109
	speed: 0.0310s/iter; left time: 889.7975s
	iters: 3900, epoch: 4 | loss: 1.6235386
	speed: 0.0310s/iter; left time: 885.5431s
	iters: 4000, epoch: 4 | loss: 1.6319915
	speed: 0.0310s/iter; left time: 882.1191s
	iters: 4100, epoch: 4 | loss: 1.7063909
	speed: 0.0308s/iter; left time: 874.0024s
	iters: 4200, epoch: 4 | loss: 1.8253994
	speed: 0.0312s/iter; left time: 882.4380s
	iters: 4300, epoch: 4 | loss: 2.0272312
	speed: 0.0310s/iter; left time: 873.4813s
	iters: 4400, epoch: 4 | loss: 1.4620075
	speed: 0.0314s/iter; left time: 880.9212s
	iters: 4500, epoch: 4 | loss: 1.4170647
	speed: 0.0311s/iter; left time: 869.5164s
	iters: 4600, epoch: 4 | loss: 1.6248740
	speed: 0.0305s/iter; left time: 850.7705s
Epoch: 4 cost time: 144.08150959014893
Epoch: 4, Steps: 4640 | Train Loss: 1.6153263 Vali Loss: 1.2562857 Test Loss: 1.3343356
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.6149392
	speed: 0.8541s/iter; left time: 23694.8292s
	iters: 200, epoch: 5 | loss: 1.5605572
	speed: 0.0310s/iter; left time: 857.0915s
	iters: 300, epoch: 5 | loss: 1.6584524
	speed: 0.0311s/iter; left time: 855.7448s
	iters: 400, epoch: 5 | loss: 1.6387924
	speed: 0.0309s/iter; left time: 847.7932s
	iters: 500, epoch: 5 | loss: 1.8488402
	speed: 0.0313s/iter; left time: 856.4453s
	iters: 600, epoch: 5 | loss: 1.7551352
	speed: 0.0310s/iter; left time: 844.0025s
	iters: 700, epoch: 5 | loss: 1.5274109
	speed: 0.0308s/iter; left time: 836.8912s
	iters: 800, epoch: 5 | loss: 1.5132933
	speed: 0.0310s/iter; left time: 837.9170s
	iters: 900, epoch: 5 | loss: 1.6354353
	speed: 0.0312s/iter; left time: 841.8504s
	iters: 1000, epoch: 5 | loss: 1.5384082
	speed: 0.0306s/iter; left time: 821.9474s
	iters: 1100, epoch: 5 | loss: 1.7639443
	speed: 0.0308s/iter; left time: 824.6078s
	iters: 1200, epoch: 5 | loss: 1.5957595
	speed: 0.0311s/iter; left time: 827.2094s
	iters: 1300, epoch: 5 | loss: 1.7169300
	speed: 0.0307s/iter; left time: 815.2080s
	iters: 1400, epoch: 5 | loss: 1.6498394
	speed: 0.0310s/iter; left time: 819.1958s
	iters: 1500, epoch: 5 | loss: 1.5283421
	speed: 0.0305s/iter; left time: 803.7256s
	iters: 1600, epoch: 5 | loss: 1.7821503
	speed: 0.0308s/iter; left time: 807.9603s
	iters: 1700, epoch: 5 | loss: 1.5761715
	speed: 0.0308s/iter; left time: 803.8670s
	iters: 1800, epoch: 5 | loss: 1.7520576
	speed: 0.0309s/iter; left time: 803.4405s
	iters: 1900, epoch: 5 | loss: 2.0621138
	speed: 0.0310s/iter; left time: 803.5888s
	iters: 2000, epoch: 5 | loss: 1.6828374
	speed: 0.0304s/iter; left time: 786.2365s
	iters: 2100, epoch: 5 | loss: 1.7493255
	speed: 0.0306s/iter; left time: 788.3016s
	iters: 2200, epoch: 5 | loss: 1.7180082
	speed: 0.0310s/iter; left time: 793.6981s
	iters: 2300, epoch: 5 | loss: 1.6197677
	speed: 0.0308s/iter; left time: 787.7136s
	iters: 2400, epoch: 5 | loss: 1.3845348
	speed: 0.0308s/iter; left time: 783.8416s
	iters: 2500, epoch: 5 | loss: 1.5589381
	speed: 0.0309s/iter; left time: 781.8973s
	iters: 2600, epoch: 5 | loss: 1.5759184
	speed: 0.0308s/iter; left time: 777.1376s
	iters: 2700, epoch: 5 | loss: 1.8352698
	speed: 0.0309s/iter; left time: 777.1626s
	iters: 2800, epoch: 5 | loss: 1.4841310
	speed: 0.0313s/iter; left time: 783.9411s
	iters: 2900, epoch: 5 | loss: 1.7226833
	speed: 0.0309s/iter; left time: 771.1858s
	iters: 3000, epoch: 5 | loss: 1.7357695
	speed: 0.0308s/iter; left time: 764.9853s
	iters: 3100, epoch: 5 | loss: 1.4512560
	speed: 0.0307s/iter; left time: 758.9385s
	iters: 3200, epoch: 5 | loss: 1.3520715
	speed: 0.0308s/iter; left time: 758.6987s
	iters: 3300, epoch: 5 | loss: 1.6574413
	speed: 0.0311s/iter; left time: 763.0906s
	iters: 3400, epoch: 5 | loss: 1.5078504
	speed: 0.0314s/iter; left time: 767.6578s
	iters: 3500, epoch: 5 | loss: 1.5230063
	speed: 0.0310s/iter; left time: 753.3766s
	iters: 3600, epoch: 5 | loss: 1.2726673
	speed: 0.0311s/iter; left time: 754.5263s
	iters: 3700, epoch: 5 | loss: 1.6775197
	speed: 0.0312s/iter; left time: 752.2572s
	iters: 3800, epoch: 5 | loss: 1.8369161
	speed: 0.0311s/iter; left time: 747.2022s
	iters: 3900, epoch: 5 | loss: 1.9746398
	speed: 0.0309s/iter; left time: 739.8124s
	iters: 4000, epoch: 5 | loss: 1.5576473
	speed: 0.0310s/iter; left time: 738.3492s
	iters: 4100, epoch: 5 | loss: 1.6440771
	speed: 0.0309s/iter; left time: 733.5631s
	iters: 4200, epoch: 5 | loss: 1.6814016
	speed: 0.0307s/iter; left time: 725.8225s
	iters: 4300, epoch: 5 | loss: 1.6315612
	speed: 0.0313s/iter; left time: 736.2895s
	iters: 4400, epoch: 5 | loss: 1.5732596
	speed: 0.0311s/iter; left time: 729.4285s
	iters: 4500, epoch: 5 | loss: 1.6355516
	speed: 0.0309s/iter; left time: 721.2820s
	iters: 4600, epoch: 5 | loss: 1.5853451
	speed: 0.0305s/iter; left time: 709.4274s
Epoch: 5 cost time: 143.60618901252747
Epoch: 5, Steps: 4640 | Train Loss: 1.6153360 Vali Loss: 1.2528049 Test Loss: 1.3347108
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 141826
test shape: (14182, 1, 720, 130) (14182, 1, 720, 130)
test shape: (14182, 720, 130) (14182, 720, 130)
mse:1.334617018699646, mae:0.8830282688140869
>>>>>>>Overall time: 1266 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
