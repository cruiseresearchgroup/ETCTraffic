Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 548359
val 42596
test 42595
	iters: 100, epoch: 1 | loss: 1.3383877
	speed: 0.1037s/iter; left time: 35527.5761s
	iters: 200, epoch: 1 | loss: 1.1133729
	speed: 0.1014s/iter; left time: 34712.1097s
	iters: 300, epoch: 1 | loss: 1.1106400
	speed: 0.1016s/iter; left time: 34785.9552s
	iters: 400, epoch: 1 | loss: 0.8879239
	speed: 0.1016s/iter; left time: 34760.9938s
	iters: 500, epoch: 1 | loss: 0.8598340
	speed: 0.1018s/iter; left time: 34822.7467s
	iters: 600, epoch: 1 | loss: 1.0329393
	speed: 0.1013s/iter; left time: 34639.0918s
	iters: 700, epoch: 1 | loss: 0.8931003
	speed: 0.1014s/iter; left time: 34662.6049s
	iters: 800, epoch: 1 | loss: 0.8163778
	speed: 0.1020s/iter; left time: 34870.6086s
	iters: 900, epoch: 1 | loss: 0.8224060
	speed: 0.1017s/iter; left time: 34733.9611s
	iters: 1000, epoch: 1 | loss: 0.7590116
	speed: 0.1014s/iter; left time: 34624.3692s
	iters: 1100, epoch: 1 | loss: 0.9192343
	speed: 0.1011s/iter; left time: 34514.4985s
	iters: 1200, epoch: 1 | loss: 0.7374162
	speed: 0.1016s/iter; left time: 34683.9244s
	iters: 1300, epoch: 1 | loss: 0.7437419
	speed: 0.1018s/iter; left time: 34736.8109s
	iters: 1400, epoch: 1 | loss: 0.8604791
	speed: 0.1017s/iter; left time: 34699.2610s
	iters: 1500, epoch: 1 | loss: 0.6633137
	speed: 0.1012s/iter; left time: 34521.8394s
	iters: 1600, epoch: 1 | loss: 0.7158641
	speed: 0.1017s/iter; left time: 34666.9247s
	iters: 1700, epoch: 1 | loss: 0.6722265
	speed: 0.1018s/iter; left time: 34707.0568s
Epoch: 1 cost time: 174.31648802757263
Epoch: 1, Steps: 1713 | Train Loss: 0.8779148 Vali Loss: 1.1382730 Test Loss: 0.9274086
Validation loss decreased (inf --> 1.138273).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.6757068
	speed: 0.6269s/iter; left time: 213649.1324s
	iters: 200, epoch: 2 | loss: 0.6801677
	speed: 0.1014s/iter; left time: 34549.1913s
	iters: 300, epoch: 2 | loss: 0.9755014
	speed: 0.1012s/iter; left time: 34474.2637s
	iters: 400, epoch: 2 | loss: 0.6722612
	speed: 0.1015s/iter; left time: 34560.5909s
	iters: 500, epoch: 2 | loss: 0.6567129
	speed: 0.1010s/iter; left time: 34393.0246s
	iters: 600, epoch: 2 | loss: 0.5618385
	speed: 0.1018s/iter; left time: 34636.1198s
	iters: 700, epoch: 2 | loss: 0.6821417
	speed: 0.1012s/iter; left time: 34424.2108s
	iters: 800, epoch: 2 | loss: 0.5838259
	speed: 0.1015s/iter; left time: 34510.7551s
	iters: 900, epoch: 2 | loss: 0.5484242
	speed: 0.1011s/iter; left time: 34375.8472s
	iters: 1000, epoch: 2 | loss: 0.7431597
	speed: 0.1016s/iter; left time: 34522.7688s
	iters: 1100, epoch: 2 | loss: 0.5721105
	speed: 0.1014s/iter; left time: 34456.3531s
	iters: 1200, epoch: 2 | loss: 0.5304310
	speed: 0.1013s/iter; left time: 34413.7623s
	iters: 1300, epoch: 2 | loss: 0.6251264
	speed: 0.1013s/iter; left time: 34416.3119s
	iters: 1400, epoch: 2 | loss: 0.5297835
	speed: 0.1012s/iter; left time: 34364.1101s
	iters: 1500, epoch: 2 | loss: 0.4768562
	speed: 0.1012s/iter; left time: 34340.6810s
	iters: 1600, epoch: 2 | loss: 0.5551669
	speed: 0.1006s/iter; left time: 34143.0706s
	iters: 1700, epoch: 2 | loss: 0.4845678
	speed: 0.1009s/iter; left time: 34229.9206s
Epoch: 2 cost time: 173.58691120147705
Epoch: 2, Steps: 1713 | Train Loss: 0.6156290 Vali Loss: 1.0592524 Test Loss: 0.9899425
Validation loss decreased (1.138273 --> 1.059252).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.5984339
	speed: 0.6246s/iter; left time: 211775.5958s
	iters: 200, epoch: 3 | loss: 0.5120492
	speed: 0.0996s/iter; left time: 33777.9315s
	iters: 300, epoch: 3 | loss: 0.5877954
	speed: 0.0995s/iter; left time: 33704.0901s
	iters: 400, epoch: 3 | loss: 0.6183297
	speed: 0.0999s/iter; left time: 33828.2382s
	iters: 500, epoch: 3 | loss: 0.5656992
	speed: 0.0994s/iter; left time: 33656.4022s
	iters: 600, epoch: 3 | loss: 0.5368453
	speed: 0.0998s/iter; left time: 33782.6129s
	iters: 700, epoch: 3 | loss: 0.5524966
	speed: 0.0995s/iter; left time: 33674.6683s
	iters: 800, epoch: 3 | loss: 0.5244704
	speed: 0.0998s/iter; left time: 33759.7012s
	iters: 900, epoch: 3 | loss: 0.5683115
	speed: 0.0996s/iter; left time: 33695.2073s
	iters: 1000, epoch: 3 | loss: 0.4822920
	speed: 0.0997s/iter; left time: 33718.4575s
	iters: 1100, epoch: 3 | loss: 0.5277078
	speed: 0.0996s/iter; left time: 33683.3603s
	iters: 1200, epoch: 3 | loss: 0.5761662
	speed: 0.0989s/iter; left time: 33420.2493s
	iters: 1300, epoch: 3 | loss: 0.5634195
	speed: 0.0998s/iter; left time: 33730.9982s
	iters: 1400, epoch: 3 | loss: 0.5057697
	speed: 0.1000s/iter; left time: 33773.1110s
	iters: 1500, epoch: 3 | loss: 0.5088875
	speed: 0.0993s/iter; left time: 33536.8317s
	iters: 1600, epoch: 3 | loss: 0.4801720
	speed: 0.0997s/iter; left time: 33665.6265s
	iters: 1700, epoch: 3 | loss: 0.4707406
	speed: 0.0995s/iter; left time: 33583.9507s
Epoch: 3 cost time: 170.73423194885254
Epoch: 3, Steps: 1713 | Train Loss: 0.5188527 Vali Loss: 1.0127912 Test Loss: 0.9124090
Validation loss decreased (1.059252 --> 1.012791).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.5145236
	speed: 0.6257s/iter; left time: 211099.8076s
	iters: 200, epoch: 4 | loss: 0.4266774
	speed: 0.1015s/iter; left time: 34217.3800s
	iters: 300, epoch: 4 | loss: 0.4253348
	speed: 0.1016s/iter; left time: 34243.7021s
	iters: 400, epoch: 4 | loss: 0.5050345
	speed: 0.1008s/iter; left time: 33973.6635s
	iters: 500, epoch: 4 | loss: 0.4137472
	speed: 0.0998s/iter; left time: 33630.6000s
	iters: 600, epoch: 4 | loss: 0.4705940
	speed: 0.0995s/iter; left time: 33509.2767s
	iters: 700, epoch: 4 | loss: 0.5153370
	speed: 0.1000s/iter; left time: 33687.1484s
	iters: 800, epoch: 4 | loss: 0.4411857
	speed: 0.0996s/iter; left time: 33535.8521s
	iters: 900, epoch: 4 | loss: 0.4788993
	speed: 0.1000s/iter; left time: 33657.8369s
	iters: 1000, epoch: 4 | loss: 0.4679239
	speed: 0.1006s/iter; left time: 33857.1193s
	iters: 1100, epoch: 4 | loss: 0.4515375
	speed: 0.0998s/iter; left time: 33572.3584s
	iters: 1200, epoch: 4 | loss: 0.4746966
	speed: 0.0995s/iter; left time: 33456.0994s
	iters: 1300, epoch: 4 | loss: 0.3985801
	speed: 0.0999s/iter; left time: 33573.6170s
	iters: 1400, epoch: 4 | loss: 0.5444267
	speed: 0.0999s/iter; left time: 33558.9536s
	iters: 1500, epoch: 4 | loss: 0.4904243
	speed: 0.0998s/iter; left time: 33519.3268s
	iters: 1600, epoch: 4 | loss: 0.4188591
	speed: 0.1000s/iter; left time: 33578.4110s
	iters: 1700, epoch: 4 | loss: 0.4058961
	speed: 0.0997s/iter; left time: 33468.2356s
Epoch: 4 cost time: 171.7767767906189
Epoch: 4, Steps: 1713 | Train Loss: 0.4704494 Vali Loss: 0.9317402 Test Loss: 0.8334081
Validation loss decreased (1.012791 --> 0.931740).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.3818958
	speed: 0.6294s/iter; left time: 211254.0101s
	iters: 200, epoch: 5 | loss: 0.4504273
	speed: 0.1055s/iter; left time: 35385.3791s
	iters: 300, epoch: 5 | loss: 0.4378678
	speed: 0.1053s/iter; left time: 35317.5379s
	iters: 400, epoch: 5 | loss: 0.4720299
	speed: 0.1050s/iter; left time: 35218.6025s
	iters: 500, epoch: 5 | loss: 0.4421072
	speed: 0.1048s/iter; left time: 35143.1577s
	iters: 600, epoch: 5 | loss: 0.3785184
	speed: 0.1049s/iter; left time: 35151.2195s
	iters: 700, epoch: 5 | loss: 0.4324608
	speed: 0.1050s/iter; left time: 35171.9012s
	iters: 800, epoch: 5 | loss: 0.4765925
	speed: 0.1055s/iter; left time: 35353.8664s
	iters: 900, epoch: 5 | loss: 0.4303510
	speed: 0.1054s/iter; left time: 35278.3064s
	iters: 1000, epoch: 5 | loss: 0.3637250
	speed: 0.1059s/iter; left time: 35443.2012s
	iters: 1100, epoch: 5 | loss: 0.3923348
	speed: 0.1051s/iter; left time: 35183.2771s
	iters: 1200, epoch: 5 | loss: 0.3905675
	speed: 0.1051s/iter; left time: 35162.9232s
	iters: 1300, epoch: 5 | loss: 0.4173924
	speed: 0.1048s/iter; left time: 35043.1242s
	iters: 1400, epoch: 5 | loss: 0.4397904
	speed: 0.1055s/iter; left time: 35271.2772s
	iters: 1500, epoch: 5 | loss: 0.3952643
	speed: 0.1053s/iter; left time: 35202.4554s
	iters: 1600, epoch: 5 | loss: 0.4569754
	speed: 0.1054s/iter; left time: 35210.7944s
	iters: 1700, epoch: 5 | loss: 0.3802215
	speed: 0.1052s/iter; left time: 35140.7943s
Epoch: 5 cost time: 180.387836933136
Epoch: 5, Steps: 1713 | Train Loss: 0.4351365 Vali Loss: 0.9143243 Test Loss: 0.8682841
Validation loss decreased (0.931740 --> 0.914324).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.4065433
	speed: 0.6300s/iter; left time: 210370.9684s
	iters: 200, epoch: 6 | loss: 0.4101442
	speed: 0.1051s/iter; left time: 35071.8759s
	iters: 300, epoch: 6 | loss: 0.3710270
	speed: 0.1049s/iter; left time: 35013.1594s
	iters: 400, epoch: 6 | loss: 0.3570368
	speed: 0.1054s/iter; left time: 35149.9759s
	iters: 500, epoch: 6 | loss: 0.3886204
	speed: 0.1052s/iter; left time: 35080.3945s
	iters: 600, epoch: 6 | loss: 0.3654744
	speed: 0.1056s/iter; left time: 35227.0136s
	iters: 700, epoch: 6 | loss: 0.4677943
	speed: 0.1050s/iter; left time: 34995.9956s
	iters: 800, epoch: 6 | loss: 0.4161218
	speed: 0.1052s/iter; left time: 35042.8738s
	iters: 900, epoch: 6 | loss: 0.3947916
	speed: 0.1051s/iter; left time: 35007.8137s
	iters: 1000, epoch: 6 | loss: 0.4133381
	speed: 0.1051s/iter; left time: 34990.5663s
	iters: 1100, epoch: 6 | loss: 0.3986908
	speed: 0.1054s/iter; left time: 35078.8855s
	iters: 1200, epoch: 6 | loss: 0.4089111
	speed: 0.1059s/iter; left time: 35244.2333s
	iters: 1300, epoch: 6 | loss: 0.4066061
	speed: 0.1051s/iter; left time: 34966.5831s
	iters: 1400, epoch: 6 | loss: 0.4293095
	speed: 0.1052s/iter; left time: 35003.7312s
	iters: 1500, epoch: 6 | loss: 0.3757625
	speed: 0.1052s/iter; left time: 34986.6014s
	iters: 1600, epoch: 6 | loss: 0.4024431
	speed: 0.1050s/iter; left time: 34889.1760s
	iters: 1700, epoch: 6 | loss: 0.3801671
	speed: 0.1051s/iter; left time: 34917.9373s
Epoch: 6 cost time: 180.3372781276703
Epoch: 6, Steps: 1713 | Train Loss: 0.4101985 Vali Loss: 0.9748332 Test Loss: 0.8258660
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.4204883
	speed: 0.6294s/iter; left time: 209090.4981s
	iters: 200, epoch: 7 | loss: 0.3864545
	speed: 0.1054s/iter; left time: 35011.6633s
	iters: 300, epoch: 7 | loss: 0.3493051
	speed: 0.1054s/iter; left time: 34984.6174s
	iters: 400, epoch: 7 | loss: 0.3839456
	speed: 0.1054s/iter; left time: 34982.7840s
	iters: 500, epoch: 7 | loss: 0.3511680
	speed: 0.1049s/iter; left time: 34798.0905s
	iters: 600, epoch: 7 | loss: 0.3629018
	speed: 0.1050s/iter; left time: 34822.6004s
	iters: 700, epoch: 7 | loss: 0.3066970
	speed: 0.1050s/iter; left time: 34835.3710s
	iters: 800, epoch: 7 | loss: 0.4569541
	speed: 0.1052s/iter; left time: 34876.1389s
	iters: 900, epoch: 7 | loss: 0.3889556
	speed: 0.1055s/iter; left time: 34961.5903s
	iters: 1000, epoch: 7 | loss: 0.3284087
	speed: 0.1056s/iter; left time: 35003.1771s
	iters: 1100, epoch: 7 | loss: 0.3683166
	speed: 0.1053s/iter; left time: 34874.9673s
	iters: 1200, epoch: 7 | loss: 0.4478415
	speed: 0.1052s/iter; left time: 34847.9503s
	iters: 1300, epoch: 7 | loss: 0.3737014
	speed: 0.1045s/iter; left time: 34601.1541s
	iters: 1400, epoch: 7 | loss: 0.3747468
	speed: 0.1017s/iter; left time: 33670.5306s
	iters: 1500, epoch: 7 | loss: 0.3611811
	speed: 0.1013s/iter; left time: 33526.7980s
	iters: 1600, epoch: 7 | loss: 0.3738075
	speed: 0.1012s/iter; left time: 33477.5254s
	iters: 1700, epoch: 7 | loss: 0.4122175
	speed: 0.1013s/iter; left time: 33488.1382s
Epoch: 7 cost time: 178.7913317680359
Epoch: 7, Steps: 1713 | Train Loss: 0.3897624 Vali Loss: 0.9045386 Test Loss: 0.8678418
Validation loss decreased (0.914324 --> 0.904539).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.4054914
	speed: 0.6249s/iter; left time: 206531.5865s
	iters: 200, epoch: 8 | loss: 0.3657842
	speed: 0.1013s/iter; left time: 33454.6254s
	iters: 300, epoch: 8 | loss: 0.3635983
	speed: 0.1013s/iter; left time: 33473.9629s
	iters: 400, epoch: 8 | loss: 0.3722019
	speed: 0.1014s/iter; left time: 33476.8150s
	iters: 500, epoch: 8 | loss: 0.3479574
	speed: 0.1015s/iter; left time: 33494.1967s
	iters: 600, epoch: 8 | loss: 0.3431894
	speed: 0.1019s/iter; left time: 33638.6348s
	iters: 700, epoch: 8 | loss: 0.3395292
	speed: 0.1012s/iter; left time: 33381.3597s
	iters: 800, epoch: 8 | loss: 0.4077367
	speed: 0.1017s/iter; left time: 33551.6062s
	iters: 900, epoch: 8 | loss: 0.3528106
	speed: 0.1014s/iter; left time: 33421.6512s
	iters: 1000, epoch: 8 | loss: 0.3272168
	speed: 0.1013s/iter; left time: 33375.1445s
	iters: 1100, epoch: 8 | loss: 0.3493644
	speed: 0.1011s/iter; left time: 33321.7473s
	iters: 1200, epoch: 8 | loss: 0.3888204
	speed: 0.1009s/iter; left time: 33245.9751s
	iters: 1300, epoch: 8 | loss: 0.3697051
	speed: 0.1012s/iter; left time: 33337.4831s
	iters: 1400, epoch: 8 | loss: 0.3463042
	speed: 0.1016s/iter; left time: 33460.9163s
	iters: 1500, epoch: 8 | loss: 0.3761826
	speed: 0.1014s/iter; left time: 33361.3655s
	iters: 1600, epoch: 8 | loss: 0.3712933
	speed: 0.1013s/iter; left time: 33336.7027s
	iters: 1700, epoch: 8 | loss: 0.3853048
	speed: 0.1009s/iter; left time: 33181.9717s
Epoch: 8 cost time: 173.70446920394897
Epoch: 8, Steps: 1713 | Train Loss: 0.3706215 Vali Loss: 0.8839146 Test Loss: 0.8791451
Validation loss decreased (0.904539 --> 0.883915).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.3015179
	speed: 0.6263s/iter; left time: 205909.9420s
	iters: 200, epoch: 9 | loss: 0.3953691
	speed: 0.1016s/iter; left time: 33406.0039s
	iters: 300, epoch: 9 | loss: 0.3473533
	speed: 0.1019s/iter; left time: 33498.3110s
	iters: 400, epoch: 9 | loss: 0.4157602
	speed: 0.1011s/iter; left time: 33222.3761s
	iters: 500, epoch: 9 | loss: 0.3504481
	speed: 0.1012s/iter; left time: 33244.3937s
	iters: 600, epoch: 9 | loss: 0.4006174
	speed: 0.1013s/iter; left time: 33252.5416s
	iters: 700, epoch: 9 | loss: 0.3208354
	speed: 0.1014s/iter; left time: 33283.5627s
	iters: 800, epoch: 9 | loss: 0.3506702
	speed: 0.1017s/iter; left time: 33351.4401s
	iters: 900, epoch: 9 | loss: 0.3812740
	speed: 0.1016s/iter; left time: 33328.6816s
	iters: 1000, epoch: 9 | loss: 0.3296574
	speed: 0.1016s/iter; left time: 33319.7555s
	iters: 1100, epoch: 9 | loss: 0.3883466
	speed: 0.1020s/iter; left time: 33422.2090s
	iters: 1200, epoch: 9 | loss: 0.3764014
	speed: 0.1015s/iter; left time: 33247.2068s
	iters: 1300, epoch: 9 | loss: 0.3764912
	speed: 0.1018s/iter; left time: 33355.5350s
	iters: 1400, epoch: 9 | loss: 0.3050669
	speed: 0.1016s/iter; left time: 33272.7171s
	iters: 1500, epoch: 9 | loss: 0.3237760
	speed: 0.1013s/iter; left time: 33158.8119s
	iters: 1600, epoch: 9 | loss: 0.3799703
	speed: 0.1015s/iter; left time: 33216.6076s
	iters: 1700, epoch: 9 | loss: 0.3459781
	speed: 0.1012s/iter; left time: 33102.3960s
Epoch: 9 cost time: 174.04111576080322
Epoch: 9, Steps: 1713 | Train Loss: 0.3562073 Vali Loss: 0.8629711 Test Loss: 0.8283059
Validation loss decreased (0.883915 --> 0.862971).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.3286815
	speed: 0.6241s/iter; left time: 204135.6388s
	iters: 200, epoch: 10 | loss: 0.3149737
	speed: 0.0995s/iter; left time: 32524.6955s
	iters: 300, epoch: 10 | loss: 0.3169968
	speed: 0.0996s/iter; left time: 32571.5050s
	iters: 400, epoch: 10 | loss: 0.3377005
	speed: 0.0993s/iter; left time: 32452.4523s
	iters: 500, epoch: 10 | loss: 0.3911974
	speed: 0.1002s/iter; left time: 32733.5241s
	iters: 600, epoch: 10 | loss: 0.3384578
	speed: 0.0996s/iter; left time: 32532.4376s
	iters: 700, epoch: 10 | loss: 0.3854085
	speed: 0.0997s/iter; left time: 32552.8539s
	iters: 800, epoch: 10 | loss: 0.3414873
	speed: 0.0992s/iter; left time: 32366.3708s
	iters: 900, epoch: 10 | loss: 0.3439442
	speed: 0.0998s/iter; left time: 32563.1969s
	iters: 1000, epoch: 10 | loss: 0.3808679
	speed: 0.0998s/iter; left time: 32567.3723s
	iters: 1100, epoch: 10 | loss: 0.3956993
	speed: 0.0998s/iter; left time: 32557.5054s
	iters: 1200, epoch: 10 | loss: 0.3129196
	speed: 0.0997s/iter; left time: 32492.5064s
	iters: 1300, epoch: 10 | loss: 0.3520452
	speed: 0.0996s/iter; left time: 32469.4159s
	iters: 1400, epoch: 10 | loss: 0.3270125
	speed: 0.0996s/iter; left time: 32439.2683s
	iters: 1500, epoch: 10 | loss: 0.4002142
	speed: 0.1039s/iter; left time: 33845.2955s
	iters: 1600, epoch: 10 | loss: 0.3345102
	speed: 0.1014s/iter; left time: 33027.5384s
	iters: 1700, epoch: 10 | loss: 0.3785972
	speed: 0.1043s/iter; left time: 33958.8309s
Epoch: 10 cost time: 172.02994298934937
Epoch: 10, Steps: 1713 | Train Loss: 0.3418859 Vali Loss: 0.9281552 Test Loss: 0.8758799
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 11 | loss: 0.3285292
	speed: 0.6272s/iter; left time: 204063.1535s
	iters: 200, epoch: 11 | loss: 0.3407670
	speed: 0.1008s/iter; left time: 32790.8978s
	iters: 300, epoch: 11 | loss: 0.2777655
	speed: 0.1009s/iter; left time: 32820.0027s
	iters: 400, epoch: 11 | loss: 0.3107375
	speed: 0.1013s/iter; left time: 32925.1719s
	iters: 500, epoch: 11 | loss: 0.3331156
	speed: 0.1013s/iter; left time: 32917.6311s
	iters: 600, epoch: 11 | loss: 0.2992176
	speed: 0.1011s/iter; left time: 32836.7533s
	iters: 700, epoch: 11 | loss: 0.3050386
	speed: 0.1011s/iter; left time: 32850.3389s
	iters: 800, epoch: 11 | loss: 0.3295161
	speed: 0.1015s/iter; left time: 32948.3879s
	iters: 900, epoch: 11 | loss: 0.2952449
	speed: 0.1011s/iter; left time: 32815.9556s
	iters: 1000, epoch: 11 | loss: 0.3202591
	speed: 0.1011s/iter; left time: 32800.8607s
	iters: 1100, epoch: 11 | loss: 0.2851900
	speed: 0.1011s/iter; left time: 32780.1365s
	iters: 1200, epoch: 11 | loss: 0.3530716
	speed: 0.1010s/iter; left time: 32765.8830s
	iters: 1300, epoch: 11 | loss: 0.3572643
	speed: 0.1013s/iter; left time: 32825.2206s
	iters: 1400, epoch: 11 | loss: 0.3140318
	speed: 0.1012s/iter; left time: 32803.9068s
	iters: 1500, epoch: 11 | loss: 0.3294235
	speed: 0.1013s/iter; left time: 32814.9637s
	iters: 1600, epoch: 11 | loss: 0.3426568
	speed: 0.1010s/iter; left time: 32724.7207s
	iters: 1700, epoch: 11 | loss: 0.3293623
	speed: 0.1012s/iter; left time: 32751.5888s
Epoch: 11 cost time: 173.44105911254883
Epoch: 11, Steps: 1713 | Train Loss: 0.3296574 Vali Loss: 0.9236247 Test Loss: 0.8891678
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 12 | loss: 0.3508238
	speed: 0.6276s/iter; left time: 203119.2632s
	iters: 200, epoch: 12 | loss: 0.3372453
	speed: 0.1001s/iter; left time: 32372.4180s
	iters: 300, epoch: 12 | loss: 0.3485574
	speed: 0.0997s/iter; left time: 32259.4174s
	iters: 400, epoch: 12 | loss: 0.2867367
	speed: 0.0995s/iter; left time: 32188.9873s
	iters: 500, epoch: 12 | loss: 0.3086560
	speed: 0.1000s/iter; left time: 32330.1691s
	iters: 600, epoch: 12 | loss: 0.3402690
	speed: 0.0999s/iter; left time: 32285.7194s
	iters: 700, epoch: 12 | loss: 0.3286852
	speed: 0.1001s/iter; left time: 32323.5785s
	iters: 800, epoch: 12 | loss: 0.3333629
	speed: 0.0997s/iter; left time: 32205.1989s
	iters: 900, epoch: 12 | loss: 0.3116254
	speed: 0.1005s/iter; left time: 32434.7242s
	iters: 1000, epoch: 12 | loss: 0.3043356
	speed: 0.0996s/iter; left time: 32162.6444s
	iters: 1100, epoch: 12 | loss: 0.3155787
	speed: 0.0996s/iter; left time: 32139.2902s
	iters: 1200, epoch: 12 | loss: 0.3010376
	speed: 0.0998s/iter; left time: 32196.3234s
	iters: 1300, epoch: 12 | loss: 0.3218100
	speed: 0.1005s/iter; left time: 32415.2904s
	iters: 1400, epoch: 12 | loss: 0.2638534
	speed: 0.0998s/iter; left time: 32176.1174s
	iters: 1500, epoch: 12 | loss: 0.2521488
	speed: 0.1001s/iter; left time: 32261.3734s
	iters: 1600, epoch: 12 | loss: 0.3392135
	speed: 0.0996s/iter; left time: 32074.9441s
	iters: 1700, epoch: 12 | loss: 0.3520696
	speed: 0.0998s/iter; left time: 32145.7959s
Epoch: 12 cost time: 171.40510630607605
Epoch: 12, Steps: 1713 | Train Loss: 0.3172808 Vali Loss: 0.9208375 Test Loss: 0.8732243
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 13 | loss: 0.2757758
	speed: 0.6281s/iter; left time: 202214.3436s
	iters: 200, epoch: 13 | loss: 0.3175303
	speed: 0.1017s/iter; left time: 32717.8323s
	iters: 300, epoch: 13 | loss: 0.3343801
	speed: 0.1015s/iter; left time: 32669.7573s
	iters: 400, epoch: 13 | loss: 0.2952954
	speed: 0.0996s/iter; left time: 32019.7925s
	iters: 500, epoch: 13 | loss: 0.2933916
	speed: 0.0996s/iter; left time: 32038.9047s
	iters: 600, epoch: 13 | loss: 0.2760165
	speed: 0.0994s/iter; left time: 31963.3052s
	iters: 700, epoch: 13 | loss: 0.2863938
	speed: 0.0996s/iter; left time: 31999.8222s
	iters: 800, epoch: 13 | loss: 0.3250223
	speed: 0.0999s/iter; left time: 32106.7738s
	iters: 900, epoch: 13 | loss: 0.3135915
	speed: 0.0994s/iter; left time: 31935.3035s
	iters: 1000, epoch: 13 | loss: 0.3217471
	speed: 0.0992s/iter; left time: 31863.6434s
	iters: 1100, epoch: 13 | loss: 0.3462866
	speed: 0.0996s/iter; left time: 31962.8173s
	iters: 1200, epoch: 13 | loss: 0.3372900
	speed: 0.0995s/iter; left time: 31917.0860s
	iters: 1300, epoch: 13 | loss: 0.3246977
	speed: 0.0998s/iter; left time: 31996.0861s
	iters: 1400, epoch: 13 | loss: 0.2619237
	speed: 0.0992s/iter; left time: 31811.2562s
	iters: 1500, epoch: 13 | loss: 0.2780212
	speed: 0.0995s/iter; left time: 31898.4485s
	iters: 1600, epoch: 13 | loss: 0.3068520
	speed: 0.0994s/iter; left time: 31839.5653s
	iters: 1700, epoch: 13 | loss: 0.2865434
	speed: 0.0996s/iter; left time: 31911.0257s
Epoch: 13 cost time: 171.24069547653198
Epoch: 13, Steps: 1713 | Train Loss: 0.3058221 Vali Loss: 0.9235125 Test Loss: 0.9401962
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 14 | loss: 0.3315074
	speed: 0.6266s/iter; left time: 200662.9534s
	iters: 200, epoch: 14 | loss: 0.3033433
	speed: 0.0997s/iter; left time: 31918.0115s
	iters: 300, epoch: 14 | loss: 0.2640465
	speed: 0.0997s/iter; left time: 31893.5111s
	iters: 400, epoch: 14 | loss: 0.2996603
	speed: 0.0996s/iter; left time: 31855.1449s
	iters: 500, epoch: 14 | loss: 0.3108900
	speed: 0.0996s/iter; left time: 31847.8615s
	iters: 600, epoch: 14 | loss: 0.2910634
	speed: 0.0995s/iter; left time: 31812.8638s
	iters: 700, epoch: 14 | loss: 0.3220557
	speed: 0.0997s/iter; left time: 31865.0037s
	iters: 800, epoch: 14 | loss: 0.3160382
	speed: 0.0995s/iter; left time: 31797.2989s
	iters: 900, epoch: 14 | loss: 0.2927716
	speed: 0.0993s/iter; left time: 31734.5348s
	iters: 1000, epoch: 14 | loss: 0.3138747
	speed: 0.1002s/iter; left time: 32001.4022s
	iters: 1100, epoch: 14 | loss: 0.3066209
	speed: 0.1044s/iter; left time: 33319.1360s
	iters: 1200, epoch: 14 | loss: 0.2724965
	speed: 0.0996s/iter; left time: 31793.6574s
	iters: 1300, epoch: 14 | loss: 0.2858709
	speed: 0.0994s/iter; left time: 31705.9918s
	iters: 1400, epoch: 14 | loss: 0.2710527
	speed: 0.0996s/iter; left time: 31780.3812s
	iters: 1500, epoch: 14 | loss: 0.3109698
	speed: 0.0998s/iter; left time: 31810.0830s
	iters: 1600, epoch: 14 | loss: 0.3136159
	speed: 0.0996s/iter; left time: 31732.1086s
	iters: 1700, epoch: 14 | loss: 0.3029623
	speed: 0.0995s/iter; left time: 31694.9587s
Epoch: 14 cost time: 171.2324104309082
Epoch: 14, Steps: 1713 | Train Loss: 0.2954741 Vali Loss: 0.9251576 Test Loss: 0.9123017
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 42595
test shape: (4259, 1, 96, 103) (4259, 1, 96, 103)
test shape: (4259, 96, 103) (4259, 96, 103)
mse:0.8283065557479858, mae:0.6715326905250549
>>>>>>>Overall time: 3253 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
