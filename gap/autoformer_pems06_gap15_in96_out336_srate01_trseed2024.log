Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_all_common_flow.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 742854
val 142212
test 142210
	iters: 100, epoch: 1 | loss: 1.3476455
	speed: 0.1722s/iter; left time: 79939.5058s
	iters: 200, epoch: 1 | loss: 1.3259118
	speed: 0.1704s/iter; left time: 79060.3894s
	iters: 300, epoch: 1 | loss: 1.3402243
	speed: 0.1711s/iter; left time: 79363.1005s
	iters: 400, epoch: 1 | loss: 1.3209074
	speed: 0.1699s/iter; left time: 78811.2791s
	iters: 500, epoch: 1 | loss: 1.1695923
	speed: 0.1703s/iter; left time: 78948.7761s
	iters: 600, epoch: 1 | loss: 1.3841717
	speed: 0.1710s/iter; left time: 79298.2360s
	iters: 700, epoch: 1 | loss: 1.2361935
	speed: 0.1709s/iter; left time: 79192.5673s
	iters: 800, epoch: 1 | loss: 1.1664761
	speed: 0.1707s/iter; left time: 79090.5640s
	iters: 900, epoch: 1 | loss: 1.0250466
	speed: 0.1712s/iter; left time: 79337.3768s
	iters: 1000, epoch: 1 | loss: 1.0413707
	speed: 0.1710s/iter; left time: 79197.0559s
	iters: 1100, epoch: 1 | loss: 1.1465999
	speed: 0.1699s/iter; left time: 78696.9149s
	iters: 1200, epoch: 1 | loss: 0.9785410
	speed: 0.1715s/iter; left time: 79405.1532s
	iters: 1300, epoch: 1 | loss: 1.1934659
	speed: 0.1708s/iter; left time: 79073.1870s
	iters: 1400, epoch: 1 | loss: 1.0164593
	speed: 0.1706s/iter; left time: 78941.0376s
	iters: 1500, epoch: 1 | loss: 1.0140646
	speed: 0.1708s/iter; left time: 79037.8888s
	iters: 1600, epoch: 1 | loss: 1.1030383
	speed: 0.1701s/iter; left time: 78710.7765s
	iters: 1700, epoch: 1 | loss: 0.9527121
	speed: 0.1706s/iter; left time: 78918.8975s
	iters: 1800, epoch: 1 | loss: 0.9127453
	speed: 0.1708s/iter; left time: 78991.4444s
	iters: 1900, epoch: 1 | loss: 1.0433887
	speed: 0.1713s/iter; left time: 79179.7322s
	iters: 2000, epoch: 1 | loss: 1.0288923
	speed: 0.1713s/iter; left time: 79164.3614s
	iters: 2100, epoch: 1 | loss: 1.0696222
	speed: 0.1713s/iter; left time: 79149.4405s
	iters: 2200, epoch: 1 | loss: 1.0203096
	speed: 0.1710s/iter; left time: 78988.1309s
	iters: 2300, epoch: 1 | loss: 1.0470872
	speed: 0.1709s/iter; left time: 78923.5995s
Epoch: 1 cost time: 396.7339081764221
Epoch: 1, Steps: 2321 | Train Loss: 1.1496773 Vali Loss: 0.9385801 Test Loss: 1.0020882
Validation loss decreased (inf --> 0.938580).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0550468
	speed: 2.1104s/iter; left time: 974532.8436s
	iters: 200, epoch: 2 | loss: 0.9474561
	speed: 0.1708s/iter; left time: 78841.2781s
	iters: 300, epoch: 2 | loss: 0.9063964
	speed: 0.1709s/iter; left time: 78903.9262s
	iters: 400, epoch: 2 | loss: 1.0883509
	speed: 0.1710s/iter; left time: 78906.2360s
	iters: 500, epoch: 2 | loss: 0.8181132
	speed: 0.1713s/iter; left time: 79016.0661s
	iters: 600, epoch: 2 | loss: 1.0541319
	speed: 0.1716s/iter; left time: 79169.4957s
	iters: 700, epoch: 2 | loss: 0.9211708
	speed: 0.1712s/iter; left time: 78962.7480s
	iters: 800, epoch: 2 | loss: 1.0361323
	speed: 0.1718s/iter; left time: 79197.6220s
	iters: 900, epoch: 2 | loss: 0.8167503
	speed: 0.1717s/iter; left time: 79169.4230s
	iters: 1000, epoch: 2 | loss: 0.7960611
	speed: 0.1711s/iter; left time: 78851.7525s
	iters: 1100, epoch: 2 | loss: 1.1617700
	speed: 0.1713s/iter; left time: 78931.2937s
	iters: 1200, epoch: 2 | loss: 0.8493595
	speed: 0.1715s/iter; left time: 79011.0226s
	iters: 1300, epoch: 2 | loss: 0.9262289
	speed: 0.1716s/iter; left time: 79018.0751s
	iters: 1400, epoch: 2 | loss: 1.1332799
	speed: 0.1715s/iter; left time: 78965.0888s
	iters: 1500, epoch: 2 | loss: 0.9113566
	speed: 0.1712s/iter; left time: 78824.7817s
	iters: 1600, epoch: 2 | loss: 0.9813424
	speed: 0.1708s/iter; left time: 78626.8107s
	iters: 1700, epoch: 2 | loss: 1.0615529
	speed: 0.1712s/iter; left time: 78801.2301s
	iters: 1800, epoch: 2 | loss: 0.8300948
	speed: 0.1711s/iter; left time: 78720.1965s
	iters: 1900, epoch: 2 | loss: 0.9756060
	speed: 0.1710s/iter; left time: 78660.9750s
	iters: 2000, epoch: 2 | loss: 0.8126535
	speed: 0.1709s/iter; left time: 78571.5530s
	iters: 2100, epoch: 2 | loss: 0.8715938
	speed: 0.1716s/iter; left time: 78906.6727s
	iters: 2200, epoch: 2 | loss: 0.8642034
	speed: 0.1716s/iter; left time: 78867.2190s
	iters: 2300, epoch: 2 | loss: 0.9992486
	speed: 0.1713s/iter; left time: 78713.7550s
Epoch: 2 cost time: 397.5925245285034
Epoch: 2, Steps: 2321 | Train Loss: 0.9556859 Vali Loss: 0.9453420 Test Loss: 1.0226448
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.8883167
	speed: 2.1125s/iter; left time: 970599.4530s
	iters: 200, epoch: 3 | loss: 0.8150032
	speed: 0.1719s/iter; left time: 78972.3100s
	iters: 300, epoch: 3 | loss: 0.9372115
	speed: 0.1712s/iter; left time: 78621.5795s
	iters: 400, epoch: 3 | loss: 0.9327855
	speed: 0.1716s/iter; left time: 78778.1781s
	iters: 500, epoch: 3 | loss: 0.9117277
	speed: 0.1716s/iter; left time: 78781.8918s
	iters: 600, epoch: 3 | loss: 0.9330856
	speed: 0.1716s/iter; left time: 78774.3343s
	iters: 700, epoch: 3 | loss: 0.9276338
	speed: 0.1717s/iter; left time: 78782.0746s
	iters: 800, epoch: 3 | loss: 0.9528137
	speed: 0.1677s/iter; left time: 76938.7504s
	iters: 900, epoch: 3 | loss: 0.8748935
	speed: 0.1672s/iter; left time: 76666.9040s
	iters: 1000, epoch: 3 | loss: 1.0273869
	speed: 0.1679s/iter; left time: 76987.5286s
	iters: 1100, epoch: 3 | loss: 0.8086851
	speed: 0.1678s/iter; left time: 76912.7860s
	iters: 1200, epoch: 3 | loss: 0.8768378
	speed: 0.1673s/iter; left time: 76682.3800s
	iters: 1300, epoch: 3 | loss: 0.9488285
	speed: 0.1672s/iter; left time: 76638.0332s
	iters: 1400, epoch: 3 | loss: 0.8282336
	speed: 0.1675s/iter; left time: 76746.6769s
	iters: 1500, epoch: 3 | loss: 0.7702583
	speed: 0.1669s/iter; left time: 76471.1380s
	iters: 1600, epoch: 3 | loss: 0.9359795
	speed: 0.1672s/iter; left time: 76574.0129s
	iters: 1700, epoch: 3 | loss: 0.7185860
	speed: 0.1675s/iter; left time: 76677.2646s
	iters: 1800, epoch: 3 | loss: 0.9654523
	speed: 0.1676s/iter; left time: 76724.8721s
	iters: 1900, epoch: 3 | loss: 0.8099274
	speed: 0.1678s/iter; left time: 76814.4628s
	iters: 2000, epoch: 3 | loss: 1.0014189
	speed: 0.1675s/iter; left time: 76663.9204s
	iters: 2100, epoch: 3 | loss: 0.8033547
	speed: 0.1674s/iter; left time: 76579.3630s
	iters: 2200, epoch: 3 | loss: 0.8016918
	speed: 0.1673s/iter; left time: 76512.3879s
	iters: 2300, epoch: 3 | loss: 0.7838688
	speed: 0.1675s/iter; left time: 76573.2181s
Epoch: 3 cost time: 391.720739364624
Epoch: 3, Steps: 2321 | Train Loss: 0.8903068 Vali Loss: 1.0465934 Test Loss: 1.1144994
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.7450854
	speed: 2.1071s/iter; left time: 963216.9843s
	iters: 200, epoch: 4 | loss: 0.7858011
	speed: 0.1677s/iter; left time: 76666.0982s
	iters: 300, epoch: 4 | loss: 0.8262557
	speed: 0.1679s/iter; left time: 76716.6642s
	iters: 400, epoch: 4 | loss: 0.6752244
	speed: 0.1676s/iter; left time: 76554.0928s
	iters: 500, epoch: 4 | loss: 0.9358028
	speed: 0.1674s/iter; left time: 76464.2953s
	iters: 600, epoch: 4 | loss: 0.8404001
	speed: 0.1677s/iter; left time: 76558.7253s
	iters: 700, epoch: 4 | loss: 0.9144273
	speed: 0.1681s/iter; left time: 76734.9717s
	iters: 800, epoch: 4 | loss: 0.9147474
	speed: 0.1674s/iter; left time: 76425.3876s
	iters: 900, epoch: 4 | loss: 1.1285177
	speed: 0.1675s/iter; left time: 76418.5325s
	iters: 1000, epoch: 4 | loss: 0.7920547
	speed: 0.1676s/iter; left time: 76453.4723s
	iters: 1100, epoch: 4 | loss: 0.7441545
	speed: 0.1680s/iter; left time: 76645.2519s
	iters: 1200, epoch: 4 | loss: 0.7161447
	speed: 0.1675s/iter; left time: 76400.6399s
	iters: 1300, epoch: 4 | loss: 0.9174735
	speed: 0.1681s/iter; left time: 76635.5704s
	iters: 1400, epoch: 4 | loss: 0.9201272
	speed: 0.1675s/iter; left time: 76359.9499s
	iters: 1500, epoch: 4 | loss: 0.8830795
	speed: 0.1670s/iter; left time: 76124.9130s
	iters: 1600, epoch: 4 | loss: 0.8889026
	speed: 0.1674s/iter; left time: 76262.4144s
	iters: 1700, epoch: 4 | loss: 0.7114953
	speed: 0.1674s/iter; left time: 76272.7302s
	iters: 1800, epoch: 4 | loss: 0.7094820
	speed: 0.1677s/iter; left time: 76389.9045s
	iters: 1900, epoch: 4 | loss: 0.8159749
	speed: 0.1675s/iter; left time: 76248.6523s
	iters: 2000, epoch: 4 | loss: 0.9356732
	speed: 0.1677s/iter; left time: 76353.3654s
	iters: 2100, epoch: 4 | loss: 0.8289868
	speed: 0.1670s/iter; left time: 76013.2625s
	iters: 2200, epoch: 4 | loss: 0.8366495
	speed: 0.1682s/iter; left time: 76521.2264s
	iters: 2300, epoch: 4 | loss: 0.7511402
	speed: 0.1676s/iter; left time: 76244.2572s
Epoch: 4 cost time: 389.2075436115265
Epoch: 4, Steps: 2321 | Train Loss: 0.8432301 Vali Loss: 1.0543844 Test Loss: 1.0792643
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.7949721
	speed: 2.1060s/iter; left time: 957866.9569s
	iters: 200, epoch: 5 | loss: 0.7568726
	speed: 0.1674s/iter; left time: 76098.5428s
	iters: 300, epoch: 5 | loss: 0.9033937
	speed: 0.1671s/iter; left time: 75955.7573s
	iters: 400, epoch: 5 | loss: 0.7639046
	speed: 0.1673s/iter; left time: 76036.8385s
	iters: 500, epoch: 5 | loss: 0.8246258
	speed: 0.1672s/iter; left time: 75993.0175s
	iters: 600, epoch: 5 | loss: 0.7253131
	speed: 0.1675s/iter; left time: 76095.0202s
	iters: 700, epoch: 5 | loss: 0.7694827
	speed: 0.1677s/iter; left time: 76193.2031s
	iters: 800, epoch: 5 | loss: 0.7435262
	speed: 0.1673s/iter; left time: 75955.3889s
	iters: 900, epoch: 5 | loss: 0.8817270
	speed: 0.1674s/iter; left time: 76000.7507s
	iters: 1000, epoch: 5 | loss: 0.8222640
	speed: 0.1672s/iter; left time: 75913.4480s
	iters: 1100, epoch: 5 | loss: 0.7818776
	speed: 0.1671s/iter; left time: 75812.3454s
	iters: 1200, epoch: 5 | loss: 0.6889677
	speed: 0.1676s/iter; left time: 76047.7299s
	iters: 1300, epoch: 5 | loss: 0.8632079
	speed: 0.1676s/iter; left time: 76005.5697s
	iters: 1400, epoch: 5 | loss: 0.7682337
	speed: 0.1673s/iter; left time: 75890.3312s
	iters: 1500, epoch: 5 | loss: 0.7958640
	speed: 0.1672s/iter; left time: 75825.9543s
	iters: 1600, epoch: 5 | loss: 0.7624164
	speed: 0.1674s/iter; left time: 75907.5982s
	iters: 1700, epoch: 5 | loss: 0.5735077
	speed: 0.1673s/iter; left time: 75823.0832s
	iters: 1800, epoch: 5 | loss: 0.8929555
	speed: 0.1676s/iter; left time: 75955.2757s
	iters: 1900, epoch: 5 | loss: 0.7406929
	speed: 0.1669s/iter; left time: 75604.1416s
	iters: 2000, epoch: 5 | loss: 0.7959437
	speed: 0.1670s/iter; left time: 75641.7901s
	iters: 2100, epoch: 5 | loss: 0.9072421
	speed: 0.1674s/iter; left time: 75791.0711s
	iters: 2200, epoch: 5 | loss: 0.7906629
	speed: 0.1667s/iter; left time: 75489.4737s
	iters: 2300, epoch: 5 | loss: 0.8950322
	speed: 0.1670s/iter; left time: 75587.2950s
Epoch: 5 cost time: 388.45953154563904
Epoch: 5, Steps: 2321 | Train Loss: 0.8163224 Vali Loss: 1.0429230 Test Loss: 1.0897952
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 1.1387098
	speed: 2.1136s/iter; left time: 956378.1878s
	iters: 200, epoch: 6 | loss: 0.8505083
	speed: 0.1708s/iter; left time: 77253.3541s
	iters: 300, epoch: 6 | loss: 0.7280216
	speed: 0.1670s/iter; left time: 75548.1097s
	iters: 400, epoch: 6 | loss: 0.8216909
	speed: 0.1669s/iter; left time: 75480.6594s
	iters: 500, epoch: 6 | loss: 0.8851970
	speed: 0.1670s/iter; left time: 75498.1254s
	iters: 600, epoch: 6 | loss: 0.7964255
	speed: 0.1666s/iter; left time: 75317.5628s
	iters: 700, epoch: 6 | loss: 0.8425941
	speed: 0.1669s/iter; left time: 75404.3130s
	iters: 800, epoch: 6 | loss: 0.7670718
	speed: 0.1673s/iter; left time: 75588.8079s
	iters: 900, epoch: 6 | loss: 0.7428370
	speed: 0.1670s/iter; left time: 75436.4533s
	iters: 1000, epoch: 6 | loss: 0.7068133
	speed: 0.1671s/iter; left time: 75464.5644s
	iters: 1100, epoch: 6 | loss: 0.8234459
	speed: 0.1670s/iter; left time: 75417.3170s
	iters: 1200, epoch: 6 | loss: 0.8163149
	speed: 0.1670s/iter; left time: 75364.3071s
	iters: 1300, epoch: 6 | loss: 0.6681612
	speed: 0.1669s/iter; left time: 75328.9679s
	iters: 1400, epoch: 6 | loss: 1.0864367
	speed: 0.1661s/iter; left time: 74940.9453s
	iters: 1500, epoch: 6 | loss: 0.8777657
	speed: 0.1664s/iter; left time: 75062.7083s
	iters: 1600, epoch: 6 | loss: 0.7024928
	speed: 0.1670s/iter; left time: 75311.0462s
	iters: 1700, epoch: 6 | loss: 0.8440609
	speed: 0.1667s/iter; left time: 75148.4995s
	iters: 1800, epoch: 6 | loss: 0.7702445
	speed: 0.1669s/iter; left time: 75237.0702s
	iters: 1900, epoch: 6 | loss: 0.9638285
	speed: 0.1666s/iter; left time: 75108.4861s
	iters: 2000, epoch: 6 | loss: 0.8225021
	speed: 0.1668s/iter; left time: 75154.2822s
	iters: 2100, epoch: 6 | loss: 1.0282556
	speed: 0.1662s/iter; left time: 74860.6618s
	iters: 2200, epoch: 6 | loss: 0.6726950
	speed: 0.1668s/iter; left time: 75123.4319s
	iters: 2300, epoch: 6 | loss: 0.9240728
	speed: 0.1670s/iter; left time: 75218.1352s
Epoch: 6 cost time: 388.5011713504791
Epoch: 6, Steps: 2321 | Train Loss: 0.7966346 Vali Loss: 1.0064187 Test Loss: 1.0307961
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_all_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 142210
test shape: (14221, 1, 336, 130) (14221, 1, 336, 130)
test shape: (14221, 336, 130) (14221, 336, 130)
mse:1.0020880699157715, mae:0.7684490084648132
>>>>>>>Overall time: 3741 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
