Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1125405
val 70521
test 246349
	iters: 100, epoch: 1 | loss: 1.9755371
	speed: 0.0331s/iter; left time: 2327.0767s
	iters: 200, epoch: 1 | loss: 1.4154338
	speed: 0.0305s/iter; left time: 2136.9415s
	iters: 300, epoch: 1 | loss: 1.6412725
	speed: 0.0304s/iter; left time: 2126.8408s
	iters: 400, epoch: 1 | loss: 1.4840603
	speed: 0.0303s/iter; left time: 2117.1296s
	iters: 500, epoch: 1 | loss: 1.6691716
	speed: 0.0304s/iter; left time: 2124.2637s
	iters: 600, epoch: 1 | loss: 1.5798382
	speed: 0.0304s/iter; left time: 2121.2759s
	iters: 700, epoch: 1 | loss: 1.7880775
	speed: 0.0303s/iter; left time: 2111.8622s
	iters: 800, epoch: 1 | loss: 1.7957714
	speed: 0.0305s/iter; left time: 2117.4194s
	iters: 900, epoch: 1 | loss: 1.7106631
	speed: 0.0305s/iter; left time: 2114.6660s
	iters: 1000, epoch: 1 | loss: 1.6307038
	speed: 0.0303s/iter; left time: 2103.5112s
	iters: 1100, epoch: 1 | loss: 1.7745605
	speed: 0.0303s/iter; left time: 2096.1492s
	iters: 1200, epoch: 1 | loss: 1.6056801
	speed: 0.0302s/iter; left time: 2090.1655s
	iters: 1300, epoch: 1 | loss: 1.6270858
	speed: 0.0305s/iter; left time: 2104.5338s
	iters: 1400, epoch: 1 | loss: 1.7523280
	speed: 0.0306s/iter; left time: 2107.1646s
	iters: 1500, epoch: 1 | loss: 2.1681809
	speed: 0.0305s/iter; left time: 2097.2395s
	iters: 1600, epoch: 1 | loss: 1.5013423
	speed: 0.0304s/iter; left time: 2091.1620s
	iters: 1700, epoch: 1 | loss: 1.7019955
	speed: 0.0302s/iter; left time: 2070.2731s
	iters: 1800, epoch: 1 | loss: 1.9945463
	speed: 0.0304s/iter; left time: 2086.0872s
	iters: 1900, epoch: 1 | loss: 1.7848402
	speed: 0.0305s/iter; left time: 2084.9839s
	iters: 2000, epoch: 1 | loss: 1.6312662
	speed: 0.0305s/iter; left time: 2086.3407s
	iters: 2100, epoch: 1 | loss: 2.2196441
	speed: 0.0305s/iter; left time: 2084.3823s
	iters: 2200, epoch: 1 | loss: 1.9002464
	speed: 0.0305s/iter; left time: 2075.8862s
	iters: 2300, epoch: 1 | loss: 1.7489605
	speed: 0.0305s/iter; left time: 2075.8199s
	iters: 2400, epoch: 1 | loss: 1.5189142
	speed: 0.0305s/iter; left time: 2069.0348s
	iters: 2500, epoch: 1 | loss: 1.7682973
	speed: 0.0305s/iter; left time: 2067.4691s
	iters: 2600, epoch: 1 | loss: 1.7381985
	speed: 0.0303s/iter; left time: 2051.8212s
	iters: 2700, epoch: 1 | loss: 1.7639000
	speed: 0.0304s/iter; left time: 2052.6981s
	iters: 2800, epoch: 1 | loss: 1.6631688
	speed: 0.0304s/iter; left time: 2050.1211s
	iters: 2900, epoch: 1 | loss: 1.8417236
	speed: 0.0304s/iter; left time: 2047.8032s
	iters: 3000, epoch: 1 | loss: 2.0617180
	speed: 0.0304s/iter; left time: 2049.9678s
	iters: 3100, epoch: 1 | loss: 1.8066037
	speed: 0.0305s/iter; left time: 2047.4443s
	iters: 3200, epoch: 1 | loss: 1.6714144
	speed: 0.0304s/iter; left time: 2043.2742s
	iters: 3300, epoch: 1 | loss: 1.5970044
	speed: 0.0304s/iter; left time: 2039.8609s
	iters: 3400, epoch: 1 | loss: 1.5320033
	speed: 0.0303s/iter; left time: 2027.9983s
	iters: 3500, epoch: 1 | loss: 1.9240646
	speed: 0.0304s/iter; left time: 2033.3595s
	iters: 3600, epoch: 1 | loss: 1.7933296
	speed: 0.0304s/iter; left time: 2030.6192s
	iters: 3700, epoch: 1 | loss: 1.9423504
	speed: 0.0304s/iter; left time: 2026.7967s
	iters: 3800, epoch: 1 | loss: 2.0319970
	speed: 0.0304s/iter; left time: 2022.5438s
	iters: 3900, epoch: 1 | loss: 1.7652534
	speed: 0.0304s/iter; left time: 2019.6112s
	iters: 4000, epoch: 1 | loss: 1.8484240
	speed: 0.0304s/iter; left time: 2018.6835s
	iters: 4100, epoch: 1 | loss: 1.5721980
	speed: 0.0304s/iter; left time: 2012.5019s
	iters: 4200, epoch: 1 | loss: 2.0254157
	speed: 0.0304s/iter; left time: 2011.7566s
	iters: 4300, epoch: 1 | loss: 1.9572266
	speed: 0.0304s/iter; left time: 2008.8217s
	iters: 4400, epoch: 1 | loss: 1.5780714
	speed: 0.0305s/iter; left time: 2010.1986s
	iters: 4500, epoch: 1 | loss: 1.5583801
	speed: 0.0302s/iter; left time: 1989.9481s
	iters: 4600, epoch: 1 | loss: 1.4763134
	speed: 0.0303s/iter; left time: 1992.3435s
	iters: 4700, epoch: 1 | loss: 1.7920421
	speed: 0.0303s/iter; left time: 1990.0079s
	iters: 4800, epoch: 1 | loss: 1.9051425
	speed: 0.0304s/iter; left time: 1990.0205s
	iters: 4900, epoch: 1 | loss: 1.7421358
	speed: 0.0304s/iter; left time: 1986.7633s
	iters: 5000, epoch: 1 | loss: 1.6408587
	speed: 0.0304s/iter; left time: 1987.4740s
	iters: 5100, epoch: 1 | loss: 1.8846669
	speed: 0.0304s/iter; left time: 1982.6266s
	iters: 5200, epoch: 1 | loss: 1.5102161
	speed: 0.0304s/iter; left time: 1979.2351s
	iters: 5300, epoch: 1 | loss: 1.5802156
	speed: 0.0305s/iter; left time: 1982.7864s
	iters: 5400, epoch: 1 | loss: 2.0422416
	speed: 0.0303s/iter; left time: 1967.6534s
	iters: 5500, epoch: 1 | loss: 1.6427690
	speed: 0.0302s/iter; left time: 1959.2742s
	iters: 5600, epoch: 1 | loss: 1.5872943
	speed: 0.0303s/iter; left time: 1964.4178s
	iters: 5700, epoch: 1 | loss: 1.7891572
	speed: 0.0304s/iter; left time: 1964.4411s
	iters: 5800, epoch: 1 | loss: 1.7137721
	speed: 0.0304s/iter; left time: 1961.4424s
	iters: 5900, epoch: 1 | loss: 1.8492275
	speed: 0.0304s/iter; left time: 1961.5002s
	iters: 6000, epoch: 1 | loss: 1.6561236
	speed: 0.0306s/iter; left time: 1970.0013s
	iters: 6100, epoch: 1 | loss: 1.6879704
	speed: 0.0309s/iter; left time: 1987.2544s
	iters: 6200, epoch: 1 | loss: 2.0169559
	speed: 0.0305s/iter; left time: 1955.3033s
	iters: 6300, epoch: 1 | loss: 1.9364583
	speed: 0.0301s/iter; left time: 1925.3494s
	iters: 6400, epoch: 1 | loss: 1.9614661
	speed: 0.0303s/iter; left time: 1939.1508s
	iters: 6500, epoch: 1 | loss: 1.4077735
	speed: 0.0305s/iter; left time: 1943.7427s
	iters: 6600, epoch: 1 | loss: 1.5984454
	speed: 0.0304s/iter; left time: 1940.2606s
	iters: 6700, epoch: 1 | loss: 1.6523042
	speed: 0.0303s/iter; left time: 1925.9506s
	iters: 6800, epoch: 1 | loss: 1.6494813
	speed: 0.0304s/iter; left time: 1933.4445s
	iters: 6900, epoch: 1 | loss: 1.8369981
	speed: 0.0304s/iter; left time: 1928.2777s
	iters: 7000, epoch: 1 | loss: 1.8807878
	speed: 0.0305s/iter; left time: 1932.7658s
Epoch: 1 cost time: 214.22621607780457
Epoch: 1, Steps: 7033 | Train Loss: 1.7790214 Vali Loss: 1.5151688 Test Loss: 1.6064229
Validation loss decreased (inf --> 1.515169).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.8955814
	speed: 1.1025s/iter; left time: 69677.4357s
	iters: 200, epoch: 2 | loss: 1.9064028
	speed: 0.0298s/iter; left time: 1880.7996s
	iters: 300, epoch: 2 | loss: 1.7974349
	speed: 0.0304s/iter; left time: 1912.7961s
	iters: 400, epoch: 2 | loss: 1.7754639
	speed: 0.0302s/iter; left time: 1900.2782s
	iters: 500, epoch: 2 | loss: 1.5719841
	speed: 0.0302s/iter; left time: 1894.1190s
	iters: 600, epoch: 2 | loss: 1.7004492
	speed: 0.0303s/iter; left time: 1899.3431s
	iters: 700, epoch: 2 | loss: 1.6456937
	speed: 0.0300s/iter; left time: 1879.2525s
	iters: 800, epoch: 2 | loss: 1.7702800
	speed: 0.0303s/iter; left time: 1895.5685s
	iters: 900, epoch: 2 | loss: 1.7513720
	speed: 0.0305s/iter; left time: 1901.7807s
	iters: 1000, epoch: 2 | loss: 1.6834357
	speed: 0.0304s/iter; left time: 1892.8817s
	iters: 1100, epoch: 2 | loss: 2.0623512
	speed: 0.0301s/iter; left time: 1873.2119s
	iters: 1200, epoch: 2 | loss: 1.6056467
	speed: 0.0301s/iter; left time: 1871.4422s
	iters: 1300, epoch: 2 | loss: 1.8559874
	speed: 0.0305s/iter; left time: 1888.7784s
	iters: 1400, epoch: 2 | loss: 2.0774450
	speed: 0.0304s/iter; left time: 1882.5367s
	iters: 1500, epoch: 2 | loss: 1.6440315
	speed: 0.0301s/iter; left time: 1857.2517s
	iters: 1600, epoch: 2 | loss: 1.7153027
	speed: 0.0304s/iter; left time: 1874.1742s
	iters: 1700, epoch: 2 | loss: 1.7853482
	speed: 0.0304s/iter; left time: 1872.9450s
	iters: 1800, epoch: 2 | loss: 1.9482446
	speed: 0.0303s/iter; left time: 1864.0801s
	iters: 1900, epoch: 2 | loss: 1.5052577
	speed: 0.0302s/iter; left time: 1855.2190s
	iters: 2000, epoch: 2 | loss: 1.7212617
	speed: 0.0303s/iter; left time: 1856.6989s
	iters: 2100, epoch: 2 | loss: 2.0191185
	speed: 0.0301s/iter; left time: 1843.7074s
	iters: 2200, epoch: 2 | loss: 2.0322189
	speed: 0.0303s/iter; left time: 1853.3590s
	iters: 2300, epoch: 2 | loss: 1.7241173
	speed: 0.0304s/iter; left time: 1852.5462s
	iters: 2400, epoch: 2 | loss: 1.6884179
	speed: 0.0298s/iter; left time: 1813.5379s
	iters: 2500, epoch: 2 | loss: 1.5769352
	speed: 0.0304s/iter; left time: 1845.2698s
	iters: 2600, epoch: 2 | loss: 2.0314364
	speed: 0.0304s/iter; left time: 1842.7030s
	iters: 2700, epoch: 2 | loss: 1.6048013
	speed: 0.0301s/iter; left time: 1824.0319s
	iters: 2800, epoch: 2 | loss: 1.5945500
	speed: 0.0304s/iter; left time: 1840.6978s
	iters: 2900, epoch: 2 | loss: 1.8568299
	speed: 0.0303s/iter; left time: 1829.9368s
	iters: 3000, epoch: 2 | loss: 1.4474431
	speed: 0.0304s/iter; left time: 1833.5843s
	iters: 3100, epoch: 2 | loss: 1.9254496
	speed: 0.0304s/iter; left time: 1828.9623s
	iters: 3200, epoch: 2 | loss: 1.8473741
	speed: 0.0304s/iter; left time: 1824.0143s
	iters: 3300, epoch: 2 | loss: 1.6412836
	speed: 0.0301s/iter; left time: 1805.1133s
	iters: 3400, epoch: 2 | loss: 1.9950818
	speed: 0.0304s/iter; left time: 1818.8345s
	iters: 3500, epoch: 2 | loss: 1.7133020
	speed: 0.0303s/iter; left time: 1813.0899s
	iters: 3600, epoch: 2 | loss: 1.6557730
	speed: 0.0303s/iter; left time: 1809.8974s
	iters: 3700, epoch: 2 | loss: 1.7950450
	speed: 0.0304s/iter; left time: 1811.2644s
	iters: 3800, epoch: 2 | loss: 1.7218022
	speed: 0.0305s/iter; left time: 1811.8266s
	iters: 3900, epoch: 2 | loss: 1.9652886
	speed: 0.0303s/iter; left time: 1796.9816s
	iters: 4000, epoch: 2 | loss: 1.7016605
	speed: 0.0304s/iter; left time: 1802.1043s
	iters: 4100, epoch: 2 | loss: 2.2151396
	speed: 0.0303s/iter; left time: 1792.6819s
	iters: 4200, epoch: 2 | loss: 1.7081829
	speed: 0.0304s/iter; left time: 1794.0714s
	iters: 4300, epoch: 2 | loss: 1.7293140
	speed: 0.0304s/iter; left time: 1793.2777s
	iters: 4400, epoch: 2 | loss: 1.9202677
	speed: 0.0300s/iter; left time: 1765.2090s
	iters: 4500, epoch: 2 | loss: 2.0002587
	speed: 0.0303s/iter; left time: 1780.5600s
	iters: 4600, epoch: 2 | loss: 1.8599994
	speed: 0.0301s/iter; left time: 1765.0869s
	iters: 4700, epoch: 2 | loss: 1.6335491
	speed: 0.0305s/iter; left time: 1786.1423s
	iters: 4800, epoch: 2 | loss: 1.9026158
	speed: 0.0305s/iter; left time: 1784.1336s
	iters: 4900, epoch: 2 | loss: 1.7896901
	speed: 0.0295s/iter; left time: 1721.5546s
	iters: 5000, epoch: 2 | loss: 1.6763978
	speed: 0.0298s/iter; left time: 1738.8654s
	iters: 5100, epoch: 2 | loss: 1.8395258
	speed: 0.0300s/iter; left time: 1743.2086s
	iters: 5200, epoch: 2 | loss: 1.8863460
	speed: 0.0304s/iter; left time: 1765.9135s
	iters: 5300, epoch: 2 | loss: 1.7828836
	speed: 0.0302s/iter; left time: 1751.6201s
	iters: 5400, epoch: 2 | loss: 1.9142294
	speed: 0.0303s/iter; left time: 1754.1947s
	iters: 5500, epoch: 2 | loss: 1.9336427
	speed: 0.0298s/iter; left time: 1722.0077s
	iters: 5600, epoch: 2 | loss: 1.9395274
	speed: 0.0304s/iter; left time: 1755.4502s
	iters: 5700, epoch: 2 | loss: 1.8079689
	speed: 0.0303s/iter; left time: 1747.1421s
	iters: 5800, epoch: 2 | loss: 1.6055388
	speed: 0.0305s/iter; left time: 1751.3437s
	iters: 5900, epoch: 2 | loss: 1.4924452
	speed: 0.0304s/iter; left time: 1743.0430s
	iters: 6000, epoch: 2 | loss: 1.7620295
	speed: 0.0304s/iter; left time: 1739.3782s
	iters: 6100, epoch: 2 | loss: 1.7720597
	speed: 0.0302s/iter; left time: 1725.9057s
	iters: 6200, epoch: 2 | loss: 1.7966609
	speed: 0.0304s/iter; left time: 1736.7848s
	iters: 6300, epoch: 2 | loss: 1.8974220
	speed: 0.0302s/iter; left time: 1723.8086s
	iters: 6400, epoch: 2 | loss: 1.8803079
	speed: 0.0301s/iter; left time: 1713.4014s
	iters: 6500, epoch: 2 | loss: 1.6023573
	speed: 0.0304s/iter; left time: 1724.6692s
	iters: 6600, epoch: 2 | loss: 1.7327970
	speed: 0.0304s/iter; left time: 1724.1999s
	iters: 6700, epoch: 2 | loss: 1.8835783
	speed: 0.0302s/iter; left time: 1711.0488s
	iters: 6800, epoch: 2 | loss: 1.6439319
	speed: 0.0303s/iter; left time: 1709.3639s
	iters: 6900, epoch: 2 | loss: 2.1237051
	speed: 0.0300s/iter; left time: 1689.9603s
	iters: 7000, epoch: 2 | loss: 1.5093524
	speed: 0.0298s/iter; left time: 1676.2231s
Epoch: 2 cost time: 212.95622491836548
Epoch: 2, Steps: 7033 | Train Loss: 1.7824824 Vali Loss: 1.5252805 Test Loss: 1.6049488
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.8124681
	speed: 1.1008s/iter; left time: 61828.2629s
	iters: 200, epoch: 3 | loss: 1.6006886
	speed: 0.0291s/iter; left time: 1631.0019s
	iters: 300, epoch: 3 | loss: 1.6844863
	speed: 0.0299s/iter; left time: 1675.8689s
	iters: 400, epoch: 3 | loss: 1.7546151
	speed: 0.0298s/iter; left time: 1666.7216s
	iters: 500, epoch: 3 | loss: 1.4977163
	speed: 0.0305s/iter; left time: 1701.8190s
	iters: 600, epoch: 3 | loss: 1.9686425
	speed: 0.0303s/iter; left time: 1685.7708s
	iters: 700, epoch: 3 | loss: 1.6919006
	speed: 0.0307s/iter; left time: 1706.3193s
	iters: 800, epoch: 3 | loss: 2.0884027
	speed: 0.0304s/iter; left time: 1687.2760s
	iters: 900, epoch: 3 | loss: 2.0912657
	speed: 0.0305s/iter; left time: 1687.0762s
	iters: 1000, epoch: 3 | loss: 2.0513873
	speed: 0.0302s/iter; left time: 1669.6506s
	iters: 1100, epoch: 3 | loss: 1.8199246
	speed: 0.0295s/iter; left time: 1627.1049s
	iters: 1200, epoch: 3 | loss: 1.5478674
	speed: 0.0300s/iter; left time: 1651.9602s
	iters: 1300, epoch: 3 | loss: 1.9927495
	speed: 0.0304s/iter; left time: 1670.5076s
	iters: 1400, epoch: 3 | loss: 1.6944275
	speed: 0.0304s/iter; left time: 1668.0481s
	iters: 1500, epoch: 3 | loss: 1.5766733
	speed: 0.0301s/iter; left time: 1649.9556s
	iters: 1600, epoch: 3 | loss: 1.8019384
	speed: 0.0303s/iter; left time: 1657.3904s
	iters: 1700, epoch: 3 | loss: 1.5338572
	speed: 0.0304s/iter; left time: 1660.8329s
	iters: 1800, epoch: 3 | loss: 1.6162359
	speed: 0.0303s/iter; left time: 1650.8347s
	iters: 1900, epoch: 3 | loss: 2.0331564
	speed: 0.0305s/iter; left time: 1655.7265s
	iters: 2000, epoch: 3 | loss: 1.5323557
	speed: 0.0302s/iter; left time: 1639.0774s
	iters: 2100, epoch: 3 | loss: 1.5770735
	speed: 0.0304s/iter; left time: 1644.9091s
	iters: 2200, epoch: 3 | loss: 1.7314736
	speed: 0.0305s/iter; left time: 1647.3248s
	iters: 2300, epoch: 3 | loss: 1.7105151
	speed: 0.0303s/iter; left time: 1636.0662s
	iters: 2400, epoch: 3 | loss: 1.6799308
	speed: 0.0304s/iter; left time: 1638.8634s
	iters: 2500, epoch: 3 | loss: 1.8844823
	speed: 0.0304s/iter; left time: 1635.5558s
	iters: 2600, epoch: 3 | loss: 1.8900869
	speed: 0.0302s/iter; left time: 1620.9116s
	iters: 2700, epoch: 3 | loss: 1.7889037
	speed: 0.0304s/iter; left time: 1627.9909s
	iters: 2800, epoch: 3 | loss: 1.7756140
	speed: 0.0299s/iter; left time: 1600.4203s
	iters: 2900, epoch: 3 | loss: 1.5627843
	speed: 0.0303s/iter; left time: 1618.3753s
	iters: 3000, epoch: 3 | loss: 1.8605804
	speed: 0.0304s/iter; left time: 1618.3763s
	iters: 3100, epoch: 3 | loss: 1.5257950
	speed: 0.0304s/iter; left time: 1615.3648s
	iters: 3200, epoch: 3 | loss: 1.7733219
	speed: 0.0306s/iter; left time: 1621.2135s
	iters: 3300, epoch: 3 | loss: 1.5870328
	speed: 0.0299s/iter; left time: 1581.2436s
	iters: 3400, epoch: 3 | loss: 2.1205840
	speed: 0.0304s/iter; left time: 1605.7470s
	iters: 3500, epoch: 3 | loss: 1.6193279
	speed: 0.0300s/iter; left time: 1581.5549s
	iters: 3600, epoch: 3 | loss: 1.6582614
	speed: 0.0304s/iter; left time: 1598.5760s
	iters: 3700, epoch: 3 | loss: 1.6049603
	speed: 0.0304s/iter; left time: 1597.6459s
	iters: 3800, epoch: 3 | loss: 1.8872224
	speed: 0.0298s/iter; left time: 1564.7798s
	iters: 3900, epoch: 3 | loss: 1.9429492
	speed: 0.0301s/iter; left time: 1577.1914s
	iters: 4000, epoch: 3 | loss: 1.9702018
	speed: 0.0302s/iter; left time: 1579.6858s
	iters: 4100, epoch: 3 | loss: 1.6354942
	speed: 0.0303s/iter; left time: 1583.0628s
	iters: 4200, epoch: 3 | loss: 1.7749050
	speed: 0.0302s/iter; left time: 1572.6322s
	iters: 4300, epoch: 3 | loss: 1.7115972
	speed: 0.0303s/iter; left time: 1574.5172s
	iters: 4400, epoch: 3 | loss: 2.1084445
	speed: 0.0304s/iter; left time: 1574.1971s
	iters: 4500, epoch: 3 | loss: 1.4803022
	speed: 0.0303s/iter; left time: 1568.2557s
	iters: 4600, epoch: 3 | loss: 1.6262739
	speed: 0.0305s/iter; left time: 1576.3380s
	iters: 4700, epoch: 3 | loss: 1.8346913
	speed: 0.0304s/iter; left time: 1566.3962s
	iters: 4800, epoch: 3 | loss: 1.9285790
	speed: 0.0304s/iter; left time: 1566.6455s
	iters: 4900, epoch: 3 | loss: 1.8814828
	speed: 0.0302s/iter; left time: 1550.6684s
	iters: 5000, epoch: 3 | loss: 1.6893350
	speed: 0.0304s/iter; left time: 1560.4569s
	iters: 5100, epoch: 3 | loss: 1.7369229
	speed: 0.0304s/iter; left time: 1555.4073s
	iters: 5200, epoch: 3 | loss: 1.6919880
	speed: 0.0305s/iter; left time: 1556.6178s
	iters: 5300, epoch: 3 | loss: 1.7048925
	speed: 0.0300s/iter; left time: 1530.6628s
	iters: 5400, epoch: 3 | loss: 1.8364006
	speed: 0.0300s/iter; left time: 1526.2541s
	iters: 5500, epoch: 3 | loss: 1.8643719
	speed: 0.0303s/iter; left time: 1536.3711s
	iters: 5600, epoch: 3 | loss: 1.8754536
	speed: 0.0304s/iter; left time: 1540.7474s
	iters: 5700, epoch: 3 | loss: 1.5371747
	speed: 0.0303s/iter; left time: 1531.5155s
	iters: 5800, epoch: 3 | loss: 1.7669196
	speed: 0.0302s/iter; left time: 1525.0450s
	iters: 5900, epoch: 3 | loss: 1.8008535
	speed: 0.0305s/iter; left time: 1535.5583s
	iters: 6000, epoch: 3 | loss: 1.7926641
	speed: 0.0302s/iter; left time: 1518.0866s
	iters: 6100, epoch: 3 | loss: 1.7694304
	speed: 0.0304s/iter; left time: 1525.2510s
	iters: 6200, epoch: 3 | loss: 1.7779791
	speed: 0.0303s/iter; left time: 1516.4517s
	iters: 6300, epoch: 3 | loss: 1.6916227
	speed: 0.0303s/iter; left time: 1514.4427s
	iters: 6400, epoch: 3 | loss: 1.9532750
	speed: 0.0297s/iter; left time: 1483.1354s
	iters: 6500, epoch: 3 | loss: 1.8370535
	speed: 0.0302s/iter; left time: 1503.9254s
	iters: 6600, epoch: 3 | loss: 1.6647226
	speed: 0.0302s/iter; left time: 1501.8181s
	iters: 6700, epoch: 3 | loss: 1.8103735
	speed: 0.0305s/iter; left time: 1512.4277s
	iters: 6800, epoch: 3 | loss: 2.0472901
	speed: 0.0301s/iter; left time: 1490.1639s
	iters: 6900, epoch: 3 | loss: 2.0204329
	speed: 0.0304s/iter; left time: 1500.8339s
	iters: 7000, epoch: 3 | loss: 1.7159441
	speed: 0.0304s/iter; left time: 1498.3354s
Epoch: 3 cost time: 213.02303051948547
Epoch: 3, Steps: 7033 | Train Loss: 1.7821235 Vali Loss: 1.5229481 Test Loss: 1.6061038
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.5153109
	speed: 1.0940s/iter; left time: 53749.4290s
	iters: 200, epoch: 4 | loss: 2.0495954
	speed: 0.0304s/iter; left time: 1488.2905s
	iters: 300, epoch: 4 | loss: 2.0166328
	speed: 0.0301s/iter; left time: 1473.6862s
	iters: 400, epoch: 4 | loss: 1.9176499
	speed: 0.0294s/iter; left time: 1437.1495s
	iters: 500, epoch: 4 | loss: 1.6416854
	speed: 0.0301s/iter; left time: 1464.9418s
	iters: 600, epoch: 4 | loss: 2.1680655
	speed: 0.0305s/iter; left time: 1481.7471s
	iters: 700, epoch: 4 | loss: 1.8566164
	speed: 0.0304s/iter; left time: 1476.3125s
	iters: 800, epoch: 4 | loss: 1.6506972
	speed: 0.0301s/iter; left time: 1455.4624s
	iters: 900, epoch: 4 | loss: 1.6504662
	speed: 0.0302s/iter; left time: 1459.4549s
	iters: 1000, epoch: 4 | loss: 1.5060601
	speed: 0.0296s/iter; left time: 1427.8677s
	iters: 1100, epoch: 4 | loss: 1.6875319
	speed: 0.0302s/iter; left time: 1453.7643s
	iters: 1200, epoch: 4 | loss: 1.8554497
	speed: 0.0300s/iter; left time: 1441.7511s
	iters: 1300, epoch: 4 | loss: 1.8393090
	speed: 0.0301s/iter; left time: 1441.5970s
	iters: 1400, epoch: 4 | loss: 1.9608030
	speed: 0.0303s/iter; left time: 1448.5795s
	iters: 1500, epoch: 4 | loss: 2.1658068
	speed: 0.0302s/iter; left time: 1443.7131s
	iters: 1600, epoch: 4 | loss: 2.1997614
	speed: 0.0300s/iter; left time: 1427.9760s
	iters: 1700, epoch: 4 | loss: 1.4853139
	speed: 0.0304s/iter; left time: 1444.7153s
	iters: 1800, epoch: 4 | loss: 1.9776297
	speed: 0.0303s/iter; left time: 1436.5975s
	iters: 1900, epoch: 4 | loss: 1.6744041
	speed: 0.0301s/iter; left time: 1423.4870s
	iters: 2000, epoch: 4 | loss: 1.2051005
	speed: 0.0304s/iter; left time: 1436.0728s
	iters: 2100, epoch: 4 | loss: 1.9922602
	speed: 0.0303s/iter; left time: 1427.4808s
	iters: 2200, epoch: 4 | loss: 1.8086686
	speed: 0.0302s/iter; left time: 1419.9779s
	iters: 2300, epoch: 4 | loss: 1.5534619
	speed: 0.0301s/iter; left time: 1412.1922s
	iters: 2400, epoch: 4 | loss: 1.6156656
	speed: 0.0302s/iter; left time: 1413.4612s
	iters: 2500, epoch: 4 | loss: 1.8242202
	speed: 0.0304s/iter; left time: 1419.0856s
	iters: 2600, epoch: 4 | loss: 1.7219716
	speed: 0.0305s/iter; left time: 1420.1579s
	iters: 2700, epoch: 4 | loss: 1.8347745
	speed: 0.0304s/iter; left time: 1412.4457s
	iters: 2800, epoch: 4 | loss: 2.0996261
	speed: 0.0304s/iter; left time: 1411.3555s
	iters: 2900, epoch: 4 | loss: 1.7340825
	speed: 0.0298s/iter; left time: 1380.0123s
	iters: 3000, epoch: 4 | loss: 1.7504247
	speed: 0.0299s/iter; left time: 1384.0004s
	iters: 3100, epoch: 4 | loss: 1.7794471
	speed: 0.0301s/iter; left time: 1390.1507s
	iters: 3200, epoch: 4 | loss: 2.1771441
	speed: 0.0299s/iter; left time: 1378.3369s
	iters: 3300, epoch: 4 | loss: 1.8372188
	speed: 0.0303s/iter; left time: 1389.5303s
	iters: 3400, epoch: 4 | loss: 1.9497138
	speed: 0.0302s/iter; left time: 1382.8233s
	iters: 3500, epoch: 4 | loss: 1.8668475
	speed: 0.0304s/iter; left time: 1390.5608s
	iters: 3600, epoch: 4 | loss: 1.7916996
	speed: 0.0303s/iter; left time: 1383.9663s
	iters: 3700, epoch: 4 | loss: 1.7392825
	speed: 0.0304s/iter; left time: 1384.0134s
	iters: 3800, epoch: 4 | loss: 1.7794166
	speed: 0.0304s/iter; left time: 1381.6773s
	iters: 3900, epoch: 4 | loss: 1.7035029
	speed: 0.0305s/iter; left time: 1381.2296s
	iters: 4000, epoch: 4 | loss: 1.9687891
	speed: 0.0303s/iter; left time: 1369.3192s
	iters: 4100, epoch: 4 | loss: 1.6875273
	speed: 0.0304s/iter; left time: 1370.7380s
	iters: 4200, epoch: 4 | loss: 1.7477887
	speed: 0.0304s/iter; left time: 1367.5284s
	iters: 4300, epoch: 4 | loss: 1.8126391
	speed: 0.0302s/iter; left time: 1356.6823s
	iters: 4400, epoch: 4 | loss: 1.7173476
	speed: 0.0301s/iter; left time: 1351.4274s
	iters: 4500, epoch: 4 | loss: 1.7522546
	speed: 0.0301s/iter; left time: 1346.8785s
	iters: 4600, epoch: 4 | loss: 1.5396971
	speed: 0.0304s/iter; left time: 1355.2623s
	iters: 4700, epoch: 4 | loss: 1.5012197
	speed: 0.0305s/iter; left time: 1356.6087s
	iters: 4800, epoch: 4 | loss: 1.6332133
	speed: 0.0303s/iter; left time: 1347.9390s
	iters: 4900, epoch: 4 | loss: 1.5962963
	speed: 0.0302s/iter; left time: 1339.3534s
	iters: 5000, epoch: 4 | loss: 2.0797539
	speed: 0.0304s/iter; left time: 1344.5659s
	iters: 5100, epoch: 4 | loss: 1.8592932
	speed: 0.0303s/iter; left time: 1339.3410s
	iters: 5200, epoch: 4 | loss: 1.7690718
	speed: 0.0304s/iter; left time: 1340.5876s
	iters: 5300, epoch: 4 | loss: 2.0546391
	speed: 0.0302s/iter; left time: 1324.7055s
	iters: 5400, epoch: 4 | loss: 1.9820430
	speed: 0.0304s/iter; left time: 1330.6926s
	iters: 5500, epoch: 4 | loss: 1.5371183
	speed: 0.0304s/iter; left time: 1331.3596s
	iters: 5600, epoch: 4 | loss: 1.6166229
	speed: 0.0303s/iter; left time: 1322.4214s
	iters: 5700, epoch: 4 | loss: 1.7152206
	speed: 0.0301s/iter; left time: 1310.3755s
	iters: 5800, epoch: 4 | loss: 1.9436997
	speed: 0.0302s/iter; left time: 1313.2819s
	iters: 5900, epoch: 4 | loss: 1.7496835
	speed: 0.0304s/iter; left time: 1316.5185s
	iters: 6000, epoch: 4 | loss: 1.6951845
	speed: 0.0304s/iter; left time: 1313.8636s
	iters: 6100, epoch: 4 | loss: 1.5567467
	speed: 0.0304s/iter; left time: 1312.9333s
	iters: 6200, epoch: 4 | loss: 1.7103701
	speed: 0.0304s/iter; left time: 1308.0667s
	iters: 6300, epoch: 4 | loss: 1.6477813
	speed: 0.0305s/iter; left time: 1307.9706s
	iters: 6400, epoch: 4 | loss: 2.2063751
	speed: 0.0304s/iter; left time: 1301.2841s
	iters: 6500, epoch: 4 | loss: 1.9747782
	speed: 0.0303s/iter; left time: 1293.1752s
	iters: 6600, epoch: 4 | loss: 1.9041477
	speed: 0.0303s/iter; left time: 1291.2711s
	iters: 6700, epoch: 4 | loss: 1.7939758
	speed: 0.0300s/iter; left time: 1277.3587s
	iters: 6800, epoch: 4 | loss: 1.4451051
	speed: 0.0299s/iter; left time: 1268.4607s
	iters: 6900, epoch: 4 | loss: 1.5761859
	speed: 0.0303s/iter; left time: 1283.9505s
	iters: 7000, epoch: 4 | loss: 1.7178001
	speed: 0.0304s/iter; left time: 1285.7878s
Epoch: 4 cost time: 212.94844722747803
Epoch: 4, Steps: 7033 | Train Loss: 1.7820690 Vali Loss: 1.5232999 Test Loss: 1.6053396
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 246349
test shape: (24634, 1, 192, 107) (24634, 1, 192, 107)
test shape: (24634, 192, 107) (24634, 192, 107)
mse:1.6064203977584839, mae:0.9927990436553955
>>>>>>>Overall time: 1472 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
