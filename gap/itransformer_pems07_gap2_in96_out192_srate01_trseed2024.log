Traceback (most recent call last):
  File "run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 2, in <module>
    from exp.exp_basic import Exp_Basic
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_basic.py", line 3, in <module>
    from models import Autoformer, Transformer, TimesNet, Nonstationary_Transformer, DLinear, FEDformer, \
  File "/g/data/hn98/du/exlts/ddd2/models/Mamba.py", line 7, in <module>
    from mamba_ssm import Mamba
ModuleNotFoundError: No module named 'mamba_ssm'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems07_all_filter10.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems07_all_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164241
val 247825
test 247825
	iters: 100, epoch: 1 | loss: 1.5457019
	speed: 0.3509s/iter; left time: 25493.3591s
	iters: 200, epoch: 1 | loss: 1.8458484
	speed: 0.3268s/iter; left time: 23709.9529s
	iters: 300, epoch: 1 | loss: 1.2768149
	speed: 0.3263s/iter; left time: 23641.3563s
	iters: 400, epoch: 1 | loss: 1.8193059
	speed: 0.3260s/iter; left time: 23587.3992s
	iters: 500, epoch: 1 | loss: 1.8289638
	speed: 0.3255s/iter; left time: 23519.3131s
	iters: 600, epoch: 1 | loss: 1.6755064
	speed: 0.3252s/iter; left time: 23465.7356s
	iters: 700, epoch: 1 | loss: 1.9366778
	speed: 0.3254s/iter; left time: 23446.3882s
	iters: 800, epoch: 1 | loss: 1.8146533
	speed: 0.3254s/iter; left time: 23418.1466s
	iters: 900, epoch: 1 | loss: 1.8066717
	speed: 0.3256s/iter; left time: 23395.6918s
	iters: 1000, epoch: 1 | loss: 1.6968361
	speed: 0.3255s/iter; left time: 23359.8189s
	iters: 1100, epoch: 1 | loss: 1.9572663
	speed: 0.3254s/iter; left time: 23320.2466s
	iters: 1200, epoch: 1 | loss: 1.9385147
	speed: 0.3258s/iter; left time: 23317.5218s
	iters: 1300, epoch: 1 | loss: 1.7439991
	speed: 0.3257s/iter; left time: 23274.6863s
	iters: 1400, epoch: 1 | loss: 1.9435548
	speed: 0.3258s/iter; left time: 23252.9737s
	iters: 1500, epoch: 1 | loss: 1.6891979
	speed: 0.3257s/iter; left time: 23208.1770s
	iters: 1600, epoch: 1 | loss: 1.8706274
	speed: 0.3260s/iter; left time: 23196.2868s
	iters: 1700, epoch: 1 | loss: 1.8209389
	speed: 0.3259s/iter; left time: 23156.9284s
	iters: 1800, epoch: 1 | loss: 1.9182332
	speed: 0.3258s/iter; left time: 23121.6095s
	iters: 1900, epoch: 1 | loss: 1.6296097
	speed: 0.3258s/iter; left time: 23088.3696s
	iters: 2000, epoch: 1 | loss: 1.6281496
	speed: 0.3254s/iter; left time: 23026.3192s
	iters: 2100, epoch: 1 | loss: 1.7647748
	speed: 0.3257s/iter; left time: 23011.4361s
	iters: 2200, epoch: 1 | loss: 1.8006266
	speed: 0.3260s/iter; left time: 23002.0160s
	iters: 2300, epoch: 1 | loss: 1.6836395
	speed: 0.3259s/iter; left time: 22961.0615s
	iters: 2400, epoch: 1 | loss: 1.7579284
	speed: 0.3258s/iter; left time: 22926.8034s
	iters: 2500, epoch: 1 | loss: 1.8198447
	speed: 0.3257s/iter; left time: 22880.6738s
	iters: 2600, epoch: 1 | loss: 1.9031776
	speed: 0.3259s/iter; left time: 22866.1227s
	iters: 2700, epoch: 1 | loss: 1.8694024
	speed: 0.3258s/iter; left time: 22826.7278s
	iters: 2800, epoch: 1 | loss: 1.4903651
	speed: 0.3258s/iter; left time: 22795.2275s
	iters: 2900, epoch: 1 | loss: 1.6981431
	speed: 0.3257s/iter; left time: 22753.1517s
	iters: 3000, epoch: 1 | loss: 1.8246691
	speed: 0.3259s/iter; left time: 22734.5868s
	iters: 3100, epoch: 1 | loss: 1.6419457
	speed: 0.3257s/iter; left time: 22689.6458s
	iters: 3200, epoch: 1 | loss: 1.8690478
	speed: 0.3257s/iter; left time: 22656.3440s
	iters: 3300, epoch: 1 | loss: 1.9194456
	speed: 0.3257s/iter; left time: 22624.3330s
	iters: 3400, epoch: 1 | loss: 1.5580215
	speed: 0.3258s/iter; left time: 22600.1121s
	iters: 3500, epoch: 1 | loss: 1.6615112
	speed: 0.3258s/iter; left time: 22562.0817s
	iters: 3600, epoch: 1 | loss: 1.8683057
	speed: 0.3258s/iter; left time: 22531.9130s
	iters: 3700, epoch: 1 | loss: 1.8262084
	speed: 0.3256s/iter; left time: 22486.2061s
	iters: 3800, epoch: 1 | loss: 1.7138504
	speed: 0.3258s/iter; left time: 22470.0450s
	iters: 3900, epoch: 1 | loss: 1.7957383
	speed: 0.3258s/iter; left time: 22438.0091s
	iters: 4000, epoch: 1 | loss: 1.8054072
	speed: 0.3260s/iter; left time: 22417.7960s
	iters: 4100, epoch: 1 | loss: 1.5598648
	speed: 0.3258s/iter; left time: 22368.0069s
	iters: 4200, epoch: 1 | loss: 1.8680730
	speed: 0.3256s/iter; left time: 22326.7658s
	iters: 4300, epoch: 1 | loss: 1.5453194
	speed: 0.3258s/iter; left time: 22305.4361s
	iters: 4400, epoch: 1 | loss: 1.6410804
	speed: 0.3258s/iter; left time: 22271.2164s
	iters: 4500, epoch: 1 | loss: 1.7402344
	speed: 0.3258s/iter; left time: 22239.0280s
	iters: 4600, epoch: 1 | loss: 1.8657143
	speed: 0.3260s/iter; left time: 22217.6913s
	iters: 4700, epoch: 1 | loss: 2.1617553
	speed: 0.3259s/iter; left time: 22181.8694s
	iters: 4800, epoch: 1 | loss: 1.8208061
	speed: 0.3258s/iter; left time: 22144.1717s
	iters: 4900, epoch: 1 | loss: 1.9431119
	speed: 0.3258s/iter; left time: 22109.4750s
	iters: 5000, epoch: 1 | loss: 1.6566557
	speed: 0.3256s/iter; left time: 22059.9602s
	iters: 5100, epoch: 1 | loss: 1.5924770
	speed: 0.3255s/iter; left time: 22024.0492s
	iters: 5200, epoch: 1 | loss: 1.5379410
	speed: 0.3257s/iter; left time: 22001.4557s
	iters: 5300, epoch: 1 | loss: 1.9092135
	speed: 0.3259s/iter; left time: 21983.1657s
	iters: 5400, epoch: 1 | loss: 1.7135081
	speed: 0.3258s/iter; left time: 21947.4854s
	iters: 5500, epoch: 1 | loss: 1.6475184
	speed: 0.3259s/iter; left time: 21918.3295s
	iters: 5600, epoch: 1 | loss: 1.5925088
	speed: 0.3258s/iter; left time: 21880.1334s
	iters: 5700, epoch: 1 | loss: 1.7267370
	speed: 0.3259s/iter; left time: 21853.7153s
	iters: 5800, epoch: 1 | loss: 1.7822042
	speed: 0.3259s/iter; left time: 21819.4711s
	iters: 5900, epoch: 1 | loss: 1.7042055
	speed: 0.3259s/iter; left time: 21787.6085s
	iters: 6000, epoch: 1 | loss: 1.8448300
	speed: 0.3259s/iter; left time: 21757.3529s
	iters: 6100, epoch: 1 | loss: 1.8414259
	speed: 0.3260s/iter; left time: 21730.6908s
	iters: 6200, epoch: 1 | loss: 1.6247610
	speed: 0.3258s/iter; left time: 21686.9925s
	iters: 6300, epoch: 1 | loss: 1.9964864
	speed: 0.3260s/iter; left time: 21666.8763s
	iters: 6400, epoch: 1 | loss: 1.6917738
	speed: 0.3258s/iter; left time: 21617.6793s
	iters: 6500, epoch: 1 | loss: 1.7030300
	speed: 0.3258s/iter; left time: 21587.2290s
	iters: 6600, epoch: 1 | loss: 1.7995546
	speed: 0.3258s/iter; left time: 21552.4561s
	iters: 6700, epoch: 1 | loss: 1.6136197
	speed: 0.3259s/iter; left time: 21529.5588s
	iters: 6800, epoch: 1 | loss: 1.7135509
	speed: 0.3258s/iter; left time: 21490.8310s
	iters: 6900, epoch: 1 | loss: 1.8179586
	speed: 0.3259s/iter; left time: 21466.3486s
	iters: 7000, epoch: 1 | loss: 1.8963403
	speed: 0.3257s/iter; left time: 21418.4588s
	iters: 7100, epoch: 1 | loss: 1.8084698
	speed: 0.3256s/iter; left time: 21380.2983s
	iters: 7200, epoch: 1 | loss: 2.0018742
	speed: 0.3255s/iter; left time: 21340.9026s
Epoch: 1 cost time: 2373.2526948451996
Epoch: 1, Steps: 7276 | Train Loss: 1.7553206 Vali Loss: 1.8326366 Test Loss: 2.0057313
Validation loss decreased (inf --> 1.832637).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.5696304
	speed: 6.2431s/iter; left time: 408206.6639s
	iters: 200, epoch: 2 | loss: 1.8837157
	speed: 0.3253s/iter; left time: 21240.3794s
	iters: 300, epoch: 2 | loss: 1.9070332
	speed: 0.3255s/iter; left time: 21220.2958s
	iters: 400, epoch: 2 | loss: 1.7794507
	speed: 0.3257s/iter; left time: 21199.4344s
	iters: 500, epoch: 2 | loss: 1.7529489
	speed: 0.3256s/iter; left time: 21158.5128s
	iters: 600, epoch: 2 | loss: 1.5695846
	speed: 0.3257s/iter; left time: 21135.5639s
	iters: 700, epoch: 2 | loss: 1.8386413
	speed: 0.3256s/iter; left time: 21095.6209s
	iters: 800, epoch: 2 | loss: 1.9455603
	speed: 0.3258s/iter; left time: 21076.3297s
	iters: 900, epoch: 2 | loss: 1.6225916
	speed: 0.3258s/iter; left time: 21039.2929s
	iters: 1000, epoch: 2 | loss: 1.8546413
	speed: 0.3257s/iter; left time: 21005.7145s
	iters: 1100, epoch: 2 | loss: 1.7496663
	speed: 0.3258s/iter; left time: 20976.1608s
	iters: 1200, epoch: 2 | loss: 1.6952152
	speed: 0.3259s/iter; left time: 20948.2637s
	iters: 1300, epoch: 2 | loss: 1.7915641
	speed: 0.3257s/iter; left time: 20901.8946s
	iters: 1400, epoch: 2 | loss: 1.9120078
	speed: 0.3257s/iter; left time: 20874.8808s
	iters: 1500, epoch: 2 | loss: 1.8963399
	speed: 0.3258s/iter; left time: 20844.1194s
	iters: 1600, epoch: 2 | loss: 1.5471170
	speed: 0.3258s/iter; left time: 20815.6221s
	iters: 1700, epoch: 2 | loss: 1.7878661
	speed: 0.3258s/iter; left time: 20779.7610s
	iters: 1800, epoch: 2 | loss: 1.7859747
	speed: 0.3258s/iter; left time: 20751.5916s
	iters: 1900, epoch: 2 | loss: 1.8141904
	speed: 0.3256s/iter; left time: 20700.5755s
	iters: 2000, epoch: 2 | loss: 1.4790307
	speed: 0.3260s/iter; left time: 20699.1113s
	iters: 2100, epoch: 2 | loss: 1.4751514
	speed: 0.3258s/iter; left time: 20649.0290s
	iters: 2200, epoch: 2 | loss: 1.6660763
	speed: 0.3260s/iter; left time: 20631.6346s
	iters: 2300, epoch: 2 | loss: 1.5980746
	speed: 0.3259s/iter; left time: 20593.2671s
	iters: 2400, epoch: 2 | loss: 1.8437189
	speed: 0.3258s/iter; left time: 20552.5762s
	iters: 2500, epoch: 2 | loss: 2.0677655
	speed: 0.3257s/iter; left time: 20517.0728s
	iters: 2600, epoch: 2 | loss: 1.8561177
	speed: 0.3259s/iter; left time: 20494.2075s
	iters: 2700, epoch: 2 | loss: 1.7501150
	speed: 0.3258s/iter; left time: 20457.0811s
	iters: 2800, epoch: 2 | loss: 1.6330341
	speed: 0.3258s/iter; left time: 20420.3351s
	iters: 2900, epoch: 2 | loss: 1.7826213
	speed: 0.3251s/iter; left time: 20348.7845s
	iters: 3000, epoch: 2 | loss: 1.7835293
	speed: 0.3253s/iter; left time: 20323.5900s
	iters: 3100, epoch: 2 | loss: 1.6101527
	speed: 0.3259s/iter; left time: 20328.6157s
	iters: 3200, epoch: 2 | loss: 1.8900847
	speed: 0.3258s/iter; left time: 20289.6738s
	iters: 3300, epoch: 2 | loss: 2.0229831
	speed: 0.3257s/iter; left time: 20255.1535s
	iters: 3400, epoch: 2 | loss: 1.7533847
	speed: 0.3256s/iter; left time: 20213.1450s
	iters: 3500, epoch: 2 | loss: 1.7308221
	speed: 0.3258s/iter; left time: 20194.4737s
	iters: 3600, epoch: 2 | loss: 1.8736075
	speed: 0.3257s/iter; left time: 20156.5460s
	iters: 3700, epoch: 2 | loss: 1.6738231
	speed: 0.3258s/iter; left time: 20128.6746s
	iters: 3800, epoch: 2 | loss: 1.7789756
	speed: 0.3257s/iter; left time: 20093.3774s
	iters: 3900, epoch: 2 | loss: 1.6226739
	speed: 0.3259s/iter; left time: 20073.0285s
	iters: 4000, epoch: 2 | loss: 1.6887461
	speed: 0.3257s/iter; left time: 20027.0272s
	iters: 4100, epoch: 2 | loss: 1.7856406
	speed: 0.3259s/iter; left time: 20003.9406s
	iters: 4200, epoch: 2 | loss: 1.8188347
	speed: 0.3258s/iter; left time: 19965.5625s
	iters: 4300, epoch: 2 | loss: 1.6678618
	speed: 0.3259s/iter; left time: 19937.3285s
	iters: 4400, epoch: 2 | loss: 1.8922038
	speed: 0.3259s/iter; left time: 19906.2636s
	iters: 4500, epoch: 2 | loss: 1.7670813
	speed: 0.3257s/iter; left time: 19864.3739s
	iters: 4600, epoch: 2 | loss: 1.5067123
	speed: 0.3257s/iter; left time: 19832.3217s
	iters: 4700, epoch: 2 | loss: 1.7860233
	speed: 0.3259s/iter; left time: 19809.3158s
	iters: 4800, epoch: 2 | loss: 1.6270976
	speed: 0.3257s/iter; left time: 19767.9851s
	iters: 4900, epoch: 2 | loss: 1.6683911
	speed: 0.3259s/iter; left time: 19743.1860s
	iters: 5000, epoch: 2 | loss: 1.7671727
	speed: 0.3257s/iter; left time: 19701.9314s
	iters: 5100, epoch: 2 | loss: 1.3828262
	speed: 0.3258s/iter; left time: 19670.4846s
	iters: 5200, epoch: 2 | loss: 1.9749932
	speed: 0.3257s/iter; left time: 19634.3608s
	iters: 5300, epoch: 2 | loss: 1.7446020
	speed: 0.3257s/iter; left time: 19602.4424s
	iters: 5400, epoch: 2 | loss: 1.9024588
	speed: 0.3256s/iter; left time: 19564.7848s
	iters: 5500, epoch: 2 | loss: 1.7530962
	speed: 0.3252s/iter; left time: 19509.5420s
	iters: 5600, epoch: 2 | loss: 1.7852588
	speed: 0.3254s/iter; left time: 19486.8263s
	iters: 5700, epoch: 2 | loss: 1.6955514
	speed: 0.3259s/iter; left time: 19484.2784s
	iters: 5800, epoch: 2 | loss: 1.7504894
	speed: 0.3257s/iter; left time: 19439.8869s
	iters: 5900, epoch: 2 | loss: 1.6686893
	speed: 0.3259s/iter; left time: 19420.7314s
	iters: 6000, epoch: 2 | loss: 1.6647912
	speed: 0.3256s/iter; left time: 19370.7010s
	iters: 6100, epoch: 2 | loss: 1.8576089
	speed: 0.3258s/iter; left time: 19348.3001s
	iters: 6200, epoch: 2 | loss: 1.6417553
	speed: 0.3259s/iter; left time: 19319.7848s
	iters: 6300, epoch: 2 | loss: 1.8575494
	speed: 0.3258s/iter; left time: 19284.9766s
	iters: 6400, epoch: 2 | loss: 1.5660000
	speed: 0.3258s/iter; left time: 19251.0057s
	iters: 6500, epoch: 2 | loss: 1.6751891
	speed: 0.3259s/iter; left time: 19220.3029s
	iters: 6600, epoch: 2 | loss: 1.7112579
	speed: 0.3259s/iter; left time: 19188.3123s
	iters: 6700, epoch: 2 | loss: 1.6620317
	speed: 0.3258s/iter; left time: 19154.7339s
	iters: 6800, epoch: 2 | loss: 2.0790839
	speed: 0.3257s/iter; left time: 19115.3450s
	iters: 6900, epoch: 2 | loss: 2.0243347
	speed: 0.3268s/iter; left time: 19146.1638s
	iters: 7000, epoch: 2 | loss: 1.8437431
	speed: 0.3258s/iter; left time: 19053.4267s
	iters: 7100, epoch: 2 | loss: 1.7744805
	speed: 0.3257s/iter; left time: 19016.6562s
	iters: 7200, epoch: 2 | loss: 1.5806594
	speed: 0.3258s/iter; left time: 18991.3045s
Epoch: 2 cost time: 2370.852212905884
Epoch: 2, Steps: 7276 | Train Loss: 1.7711197 Vali Loss: 1.8348916 Test Loss: 2.0027916
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.7707320
	speed: 6.2439s/iter; left time: 362828.2345s
	iters: 200, epoch: 3 | loss: 1.7648500
	speed: 0.3255s/iter; left time: 18884.7112s
	iters: 300, epoch: 3 | loss: 1.8494263
	speed: 0.3260s/iter; left time: 18876.4054s
	iters: 400, epoch: 3 | loss: 1.7047697
	speed: 0.3260s/iter; left time: 18844.8884s
	iters: 500, epoch: 3 | loss: 1.5564656
	speed: 0.3258s/iter; left time: 18804.1605s
	iters: 600, epoch: 3 | loss: 1.8405771
	speed: 0.3256s/iter; left time: 18758.6892s
	iters: 700, epoch: 3 | loss: 1.5763617
	speed: 0.3255s/iter; left time: 18719.9399s
	iters: 800, epoch: 3 | loss: 1.7752060
	speed: 0.3257s/iter; left time: 18695.8615s
	iters: 900, epoch: 3 | loss: 1.9095260
	speed: 0.3258s/iter; left time: 18669.6451s
	iters: 1000, epoch: 3 | loss: 2.0972023
	speed: 0.3260s/iter; left time: 18650.9432s
	iters: 1100, epoch: 3 | loss: 1.8623396
	speed: 0.3258s/iter; left time: 18608.0703s
	iters: 1200, epoch: 3 | loss: 1.7146611
	speed: 0.3258s/iter; left time: 18574.2555s
	iters: 1300, epoch: 3 | loss: 1.9262394
	speed: 0.3259s/iter; left time: 18547.4809s
	iters: 1400, epoch: 3 | loss: 1.8684193
	speed: 0.3260s/iter; left time: 18519.1972s
	iters: 1500, epoch: 3 | loss: 1.7349292
	speed: 0.3258s/iter; left time: 18478.3135s
	iters: 1600, epoch: 3 | loss: 1.5907140
	speed: 0.3260s/iter; left time: 18451.8437s
	iters: 1700, epoch: 3 | loss: 1.4964293
	speed: 0.3259s/iter; left time: 18418.7676s
	iters: 1800, epoch: 3 | loss: 1.8569781
	speed: 0.3259s/iter; left time: 18385.2434s
	iters: 1900, epoch: 3 | loss: 1.4790972
	speed: 0.3259s/iter; left time: 18348.3470s
	iters: 2000, epoch: 3 | loss: 1.6543044
	speed: 0.3260s/iter; left time: 18324.0052s
	iters: 2100, epoch: 3 | loss: 1.7458835
	speed: 0.3261s/iter; left time: 18299.2308s
	iters: 2200, epoch: 3 | loss: 1.7026649
	speed: 0.3259s/iter; left time: 18252.5204s
	iters: 2300, epoch: 3 | loss: 1.6924175
	speed: 0.3259s/iter; left time: 18223.1925s
	iters: 2400, epoch: 3 | loss: 1.7553453
	speed: 0.3259s/iter; left time: 18185.9596s
	iters: 2500, epoch: 3 | loss: 1.6127226
	speed: 0.3259s/iter; left time: 18156.7728s
	iters: 2600, epoch: 3 | loss: 1.7226722
	speed: 0.3260s/iter; left time: 18125.7605s
	iters: 2700, epoch: 3 | loss: 1.6570987
	speed: 0.3261s/iter; left time: 18101.1750s
	iters: 2800, epoch: 3 | loss: 1.6324030
	speed: 0.3258s/iter; left time: 18051.4966s
	iters: 2900, epoch: 3 | loss: 1.6623812
	speed: 0.3259s/iter; left time: 18024.9056s
	iters: 3000, epoch: 3 | loss: 1.7439045
	speed: 0.3258s/iter; left time: 17987.3005s
	iters: 3100, epoch: 3 | loss: 1.7464488
	speed: 0.3260s/iter; left time: 17965.7226s
	iters: 3200, epoch: 3 | loss: 1.6248502
	speed: 0.3256s/iter; left time: 17911.7266s
	iters: 3300, epoch: 3 | loss: 1.7743392
	speed: 0.3256s/iter; left time: 17878.5019s
	iters: 3400, epoch: 3 | loss: 2.0450013
	speed: 0.3259s/iter; left time: 17860.0407s
	iters: 3500, epoch: 3 | loss: 1.9343485
	speed: 0.3260s/iter; left time: 17834.9777s
	iters: 3600, epoch: 3 | loss: 1.6376362
	speed: 0.3259s/iter; left time: 17798.9664s
	iters: 3700, epoch: 3 | loss: 1.7929187
	speed: 0.3261s/iter; left time: 17773.3276s
	iters: 3800, epoch: 3 | loss: 2.0836024
	speed: 0.3259s/iter; left time: 17732.0234s
	iters: 3900, epoch: 3 | loss: 1.7138314
	speed: 0.3260s/iter; left time: 17706.8619s
	iters: 4000, epoch: 3 | loss: 1.5468423
	speed: 0.3258s/iter; left time: 17662.5920s
	iters: 4100, epoch: 3 | loss: 1.9347824
	speed: 0.3259s/iter; left time: 17636.6798s
	iters: 4200, epoch: 3 | loss: 1.7959535
	speed: 0.3259s/iter; left time: 17601.3760s
	iters: 4300, epoch: 3 | loss: 1.7131455
	speed: 0.3260s/iter; left time: 17572.5631s
	iters: 4400, epoch: 3 | loss: 1.8669564
	speed: 0.3256s/iter; left time: 17522.8416s
	iters: 4500, epoch: 3 | loss: 1.7299430
	speed: 0.3256s/iter; left time: 17486.4445s
	iters: 4600, epoch: 3 | loss: 1.7164751
	speed: 0.3255s/iter; left time: 17449.4002s
	iters: 4700, epoch: 3 | loss: 1.7478116
	speed: 0.3257s/iter; left time: 17428.8959s
	iters: 4800, epoch: 3 | loss: 1.7542436
	speed: 0.3257s/iter; left time: 17393.3331s
	iters: 4900, epoch: 3 | loss: 1.9396966
	speed: 0.3258s/iter; left time: 17366.8727s
	iters: 5000, epoch: 3 | loss: 1.4928530
	speed: 0.3258s/iter; left time: 17333.2155s
	iters: 5100, epoch: 3 | loss: 1.9112688
	speed: 0.3259s/iter; left time: 17309.0693s
	iters: 5200, epoch: 3 | loss: 1.8867543
	speed: 0.3259s/iter; left time: 17274.2272s
	iters: 5300, epoch: 3 | loss: 1.5090778
	speed: 0.3260s/iter; left time: 17247.0151s
	iters: 5400, epoch: 3 | loss: 1.8548149
	speed: 0.3259s/iter; left time: 17208.7691s
	iters: 5500, epoch: 3 | loss: 1.3767551
	speed: 0.3260s/iter; left time: 17185.2288s
	iters: 5600, epoch: 3 | loss: 1.8884531
	speed: 0.3259s/iter; left time: 17145.8120s
	iters: 5700, epoch: 3 | loss: 1.8585589
	speed: 0.3259s/iter; left time: 17113.7358s
	iters: 5800, epoch: 3 | loss: 1.7569504
	speed: 0.3261s/iter; left time: 17088.1773s
	iters: 5900, epoch: 3 | loss: 1.6737075
	speed: 0.3258s/iter; left time: 17041.3761s
	iters: 6000, epoch: 3 | loss: 1.8158313
	speed: 0.3258s/iter; left time: 17008.8343s
	iters: 6100, epoch: 3 | loss: 1.9685401
	speed: 0.3260s/iter; left time: 16985.6231s
	iters: 6200, epoch: 3 | loss: 1.6614541
	speed: 0.3257s/iter; left time: 16938.7172s
	iters: 6300, epoch: 3 | loss: 1.6749661
	speed: 0.3258s/iter; left time: 16913.4698s
	iters: 6400, epoch: 3 | loss: 1.8763212
	speed: 0.3257s/iter; left time: 16876.4602s
	iters: 6500, epoch: 3 | loss: 1.7598611
	speed: 0.3259s/iter; left time: 16853.5874s
	iters: 6600, epoch: 3 | loss: 1.5792692
	speed: 0.3260s/iter; left time: 16824.4833s
	iters: 6700, epoch: 3 | loss: 1.7779143
	speed: 0.3258s/iter; left time: 16782.5597s
	iters: 6800, epoch: 3 | loss: 1.7604920
	speed: 0.3258s/iter; left time: 16749.8617s
	iters: 6900, epoch: 3 | loss: 1.4316169
	speed: 0.3258s/iter; left time: 16715.7646s
	iters: 7000, epoch: 3 | loss: 1.8163955
	speed: 0.3258s/iter; left time: 16686.0700s
	iters: 7100, epoch: 3 | loss: 1.6600927
	speed: 0.3258s/iter; left time: 16649.7378s
	iters: 7200, epoch: 3 | loss: 1.6068190
	speed: 0.3255s/iter; left time: 16604.0705s
Epoch: 3 cost time: 2371.4562253952026
Epoch: 3, Steps: 7276 | Train Loss: 1.7703700 Vali Loss: 1.8333460 Test Loss: 2.0021265
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6942451
	speed: 6.2403s/iter; left time: 317214.3967s
	iters: 200, epoch: 4 | loss: 1.7025250
	speed: 0.3255s/iter; left time: 16515.1441s
	iters: 300, epoch: 4 | loss: 1.8463316
	speed: 0.3257s/iter; left time: 16490.3844s
	iters: 400, epoch: 4 | loss: 1.7862263
	speed: 0.3256s/iter; left time: 16451.3729s
	iters: 500, epoch: 4 | loss: 1.6371751
	speed: 0.3256s/iter; left time: 16422.8663s
	iters: 600, epoch: 4 | loss: 1.5402943
	speed: 0.3256s/iter; left time: 16390.2278s
	iters: 700, epoch: 4 | loss: 1.7476243
	speed: 0.3255s/iter; left time: 16351.7079s
	iters: 800, epoch: 4 | loss: 1.7783672
	speed: 0.3258s/iter; left time: 16332.1587s
	iters: 900, epoch: 4 | loss: 1.7706888
	speed: 0.3259s/iter; left time: 16303.5130s
	iters: 1000, epoch: 4 | loss: 1.8980730
	speed: 0.3256s/iter; left time: 16259.3329s
	iters: 1100, epoch: 4 | loss: 1.5821021
	speed: 0.3257s/iter; left time: 16229.6766s
	iters: 1200, epoch: 4 | loss: 1.8034552
	speed: 0.3259s/iter; left time: 16206.7746s
	iters: 1300, epoch: 4 | loss: 1.8651383
	speed: 0.3258s/iter; left time: 16172.7364s
	iters: 1400, epoch: 4 | loss: 1.8711728
	speed: 0.3257s/iter; left time: 16134.5207s
	iters: 1500, epoch: 4 | loss: 1.8211228
	speed: 0.3258s/iter; left time: 16105.4493s
	iters: 1600, epoch: 4 | loss: 1.6058480
	speed: 0.3257s/iter; left time: 16069.2869s
	iters: 1700, epoch: 4 | loss: 1.3515135
	speed: 0.3257s/iter; left time: 16035.2086s
	iters: 1800, epoch: 4 | loss: 1.6044304
	speed: 0.3256s/iter; left time: 16000.0968s
	iters: 1900, epoch: 4 | loss: 1.9102268
	speed: 0.3258s/iter; left time: 15973.4562s
	iters: 2000, epoch: 4 | loss: 1.7800204
	speed: 0.3257s/iter; left time: 15936.9695s
	iters: 2100, epoch: 4 | loss: 1.9116548
	speed: 0.3258s/iter; left time: 15911.9854s
	iters: 2200, epoch: 4 | loss: 1.7163751
	speed: 0.3259s/iter; left time: 15884.3644s
	iters: 2300, epoch: 4 | loss: 1.5811517
	speed: 0.3257s/iter; left time: 15842.0377s
	iters: 2400, epoch: 4 | loss: 1.8069296
	speed: 0.3256s/iter; left time: 15803.6809s
	iters: 2500, epoch: 4 | loss: 1.8175255
	speed: 0.3257s/iter; left time: 15773.4812s
	iters: 2600, epoch: 4 | loss: 2.1129887
	speed: 0.3258s/iter; left time: 15745.2958s
	iters: 2700, epoch: 4 | loss: 1.7362862
	speed: 0.3258s/iter; left time: 15713.0385s
	iters: 2800, epoch: 4 | loss: 1.6020162
	speed: 0.3257s/iter; left time: 15677.5984s
	iters: 2900, epoch: 4 | loss: 1.8575716
	speed: 0.3259s/iter; left time: 15653.1070s
	iters: 3000, epoch: 4 | loss: 1.4170753
	speed: 0.3258s/iter; left time: 15618.7052s
	iters: 3100, epoch: 4 | loss: 1.7300385
	speed: 0.3258s/iter; left time: 15583.1260s
	iters: 3200, epoch: 4 | loss: 1.9167004
	speed: 0.3258s/iter; left time: 15551.2229s
	iters: 3300, epoch: 4 | loss: 1.8762678
	speed: 0.3259s/iter; left time: 15521.8824s
	iters: 3400, epoch: 4 | loss: 1.7572442
	speed: 0.3258s/iter; left time: 15485.1684s
	iters: 3500, epoch: 4 | loss: 1.9449036
	speed: 0.3258s/iter; left time: 15454.6373s
	iters: 3600, epoch: 4 | loss: 1.9522818
	speed: 0.3259s/iter; left time: 15425.2522s
	iters: 3700, epoch: 4 | loss: 2.0207586
	speed: 0.3259s/iter; left time: 15393.2459s
	iters: 3800, epoch: 4 | loss: 1.9066596
	speed: 0.3258s/iter; left time: 15354.9327s
	iters: 3900, epoch: 4 | loss: 1.6333054
	speed: 0.3257s/iter; left time: 15319.5809s
	iters: 4000, epoch: 4 | loss: 1.7589446
	speed: 0.3258s/iter; left time: 15291.6086s
	iters: 4100, epoch: 4 | loss: 1.8889812
	speed: 0.3259s/iter; left time: 15263.5860s
	iters: 4200, epoch: 4 | loss: 2.1282434
	speed: 0.3257s/iter; left time: 15223.0448s
	iters: 4300, epoch: 4 | loss: 1.4810802
	speed: 0.3258s/iter; left time: 15194.7000s
	iters: 4400, epoch: 4 | loss: 1.6722161
	speed: 0.3259s/iter; left time: 15163.1892s
	iters: 4500, epoch: 4 | loss: 1.5287292
	speed: 0.3254s/iter; left time: 15107.7387s
	iters: 4600, epoch: 4 | loss: 1.6171577
	speed: 0.3252s/iter; left time: 15067.3887s
	iters: 4700, epoch: 4 | loss: 1.7618396
	speed: 0.3252s/iter; left time: 15035.8619s
	iters: 4800, epoch: 4 | loss: 1.7143850
	speed: 0.3256s/iter; left time: 15019.1033s
	iters: 4900, epoch: 4 | loss: 1.8629833
	speed: 0.3257s/iter; left time: 14991.8823s
	iters: 5000, epoch: 4 | loss: 1.6976000
	speed: 0.3258s/iter; left time: 14966.3636s
	iters: 5100, epoch: 4 | loss: 1.9158549
	speed: 0.3256s/iter; left time: 14922.0977s
	iters: 5200, epoch: 4 | loss: 1.5644224
	speed: 0.3257s/iter; left time: 14893.9885s
	iters: 5300, epoch: 4 | loss: 2.1313612
	speed: 0.3257s/iter; left time: 14863.3780s
	iters: 5400, epoch: 4 | loss: 1.8871018
	speed: 0.3257s/iter; left time: 14830.4920s
	iters: 5500, epoch: 4 | loss: 1.5928012
	speed: 0.3255s/iter; left time: 14790.7113s
	iters: 5600, epoch: 4 | loss: 1.8179505
	speed: 0.3259s/iter; left time: 14774.2772s
	iters: 5700, epoch: 4 | loss: 1.7858262
	speed: 0.3257s/iter; left time: 14734.6221s
	iters: 5800, epoch: 4 | loss: 1.8736832
	speed: 0.3258s/iter; left time: 14704.7990s
	iters: 5900, epoch: 4 | loss: 1.6795896
	speed: 0.3259s/iter; left time: 14674.2668s
	iters: 6000, epoch: 4 | loss: 1.5591305
	speed: 0.3257s/iter; left time: 14635.9966s
	iters: 6100, epoch: 4 | loss: 1.7574884
	speed: 0.3257s/iter; left time: 14603.0588s
	iters: 6200, epoch: 4 | loss: 2.0087473
	speed: 0.3258s/iter; left time: 14575.9744s
	iters: 6300, epoch: 4 | loss: 1.8279209
	speed: 0.3257s/iter; left time: 14535.7655s
	iters: 6400, epoch: 4 | loss: 1.7759347
	speed: 0.3259s/iter; left time: 14511.5597s
	iters: 6500, epoch: 4 | loss: 1.8579216
	speed: 0.3257s/iter; left time: 14470.3362s
	iters: 6600, epoch: 4 | loss: 1.8394651
	speed: 0.3258s/iter; left time: 14442.0679s
	iters: 6700, epoch: 4 | loss: 1.8822329
	speed: 0.3258s/iter; left time: 14410.4106s
	iters: 6800, epoch: 4 | loss: 1.4096792
	speed: 0.3257s/iter; left time: 14373.6295s
	iters: 6900, epoch: 4 | loss: 1.7826151
	speed: 0.3258s/iter; left time: 14345.0824s
	iters: 7000, epoch: 4 | loss: 2.0889482
	speed: 0.3258s/iter; left time: 14313.5569s
	iters: 7100, epoch: 4 | loss: 1.7034979
	speed: 0.3257s/iter; left time: 14274.2758s
	iters: 7200, epoch: 4 | loss: 1.6493676
	speed: 0.3258s/iter; left time: 14248.0802s
Epoch: 4 cost time: 2370.640791654587
Epoch: 4, Steps: 7276 | Train Loss: 1.7704305 Vali Loss: 1.8351729 Test Loss: 2.0045958
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems07_all_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247825
test shape: (24782, 1, 192, 1613) (24782, 1, 192, 1613)
test shape: (24782, 192, 1613) (24782, 192, 1613)
mse:2.005707025527954, mae:1.1282539367675781
>>>>>>>Overall time: 14480 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
