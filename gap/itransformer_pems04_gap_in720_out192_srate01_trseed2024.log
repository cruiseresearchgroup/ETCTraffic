Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=822, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems04_all_common_flow.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems04_all_720_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=720, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_all_720_192_iTransformer_custom_ftM_sl720_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1497734
val 123799
test 352907
	iters: 100, epoch: 1 | loss: 1.1360507
	speed: 0.1324s/iter; left time: 12375.2255s
	iters: 200, epoch: 1 | loss: 1.2903671
	speed: 0.1220s/iter; left time: 11398.3049s
	iters: 300, epoch: 1 | loss: 0.9890711
	speed: 0.1208s/iter; left time: 11273.8601s
	iters: 400, epoch: 1 | loss: 0.9128574
	speed: 0.1210s/iter; left time: 11281.6858s
	iters: 500, epoch: 1 | loss: 1.0385119
	speed: 0.1248s/iter; left time: 11620.1109s
	iters: 600, epoch: 1 | loss: 0.9641541
	speed: 0.1229s/iter; left time: 11432.7945s
	iters: 700, epoch: 1 | loss: 1.1843858
	speed: 0.1210s/iter; left time: 11238.2678s
	iters: 800, epoch: 1 | loss: 1.0609075
	speed: 0.1213s/iter; left time: 11257.2672s
	iters: 900, epoch: 1 | loss: 1.0944180
	speed: 0.1206s/iter; left time: 11177.0881s
	iters: 1000, epoch: 1 | loss: 1.0992267
	speed: 0.1371s/iter; left time: 12695.7974s
	iters: 1100, epoch: 1 | loss: 0.9832020
	speed: 0.2534s/iter; left time: 23442.2467s
	iters: 1200, epoch: 1 | loss: 0.8223189
	speed: 0.2297s/iter; left time: 21221.2563s
	iters: 1300, epoch: 1 | loss: 1.1339537
	speed: 0.2654s/iter; left time: 24501.0191s
	iters: 1400, epoch: 1 | loss: 1.1190584
	speed: 0.1251s/iter; left time: 11534.4856s
	iters: 1500, epoch: 1 | loss: 1.0778985
	speed: 0.1295s/iter; left time: 11925.4823s
	iters: 1600, epoch: 1 | loss: 1.1241795
	speed: 0.1233s/iter; left time: 11342.5967s
	iters: 1700, epoch: 1 | loss: 1.2467791
	speed: 0.1284s/iter; left time: 11799.0116s
	iters: 1800, epoch: 1 | loss: 1.1800567
	speed: 0.1303s/iter; left time: 11960.4286s
	iters: 1900, epoch: 1 | loss: 1.1747195
	speed: 0.1278s/iter; left time: 11722.5295s
	iters: 2000, epoch: 1 | loss: 1.0934609
	speed: 0.1246s/iter; left time: 11411.9017s
	iters: 2100, epoch: 1 | loss: 1.1659135
	speed: 0.1243s/iter; left time: 11376.3835s
	iters: 2200, epoch: 1 | loss: 1.1793587
	speed: 0.1211s/iter; left time: 11067.4814s
	iters: 2300, epoch: 1 | loss: 1.1949756
	speed: 0.1215s/iter; left time: 11090.8746s
	iters: 2400, epoch: 1 | loss: 1.0301049
	speed: 0.1220s/iter; left time: 11126.8660s
	iters: 2500, epoch: 1 | loss: 1.1046365
	speed: 0.1227s/iter; left time: 11173.9669s
	iters: 2600, epoch: 1 | loss: 0.9110431
	speed: 0.1222s/iter; left time: 11120.2211s
	iters: 2700, epoch: 1 | loss: 1.1312187
	speed: 0.1219s/iter; left time: 11079.8142s
	iters: 2800, epoch: 1 | loss: 1.1504700
	speed: 0.1220s/iter; left time: 11078.3624s
	iters: 2900, epoch: 1 | loss: 1.1164447
	speed: 0.1217s/iter; left time: 11042.7613s
	iters: 3000, epoch: 1 | loss: 1.1242000
	speed: 0.1218s/iter; left time: 11037.7590s
	iters: 3100, epoch: 1 | loss: 1.1557564
	speed: 0.1216s/iter; left time: 11007.6257s
	iters: 3200, epoch: 1 | loss: 0.9563625
	speed: 0.1219s/iter; left time: 11020.0557s
	iters: 3300, epoch: 1 | loss: 1.1088459
	speed: 0.1218s/iter; left time: 11000.1584s
	iters: 3400, epoch: 1 | loss: 1.1529036
	speed: 0.1221s/iter; left time: 11009.8513s
	iters: 3500, epoch: 1 | loss: 1.0004687
	speed: 0.1217s/iter; left time: 10962.2384s
	iters: 3600, epoch: 1 | loss: 1.1133687
	speed: 0.1219s/iter; left time: 10968.6341s
	iters: 3700, epoch: 1 | loss: 1.1216587
	speed: 0.1216s/iter; left time: 10933.7068s
	iters: 3800, epoch: 1 | loss: 1.1590213
	speed: 0.1223s/iter; left time: 10985.7752s
	iters: 3900, epoch: 1 | loss: 1.1162382
	speed: 0.1218s/iter; left time: 10925.1353s
	iters: 4000, epoch: 1 | loss: 1.1665004
	speed: 0.1214s/iter; left time: 10879.5873s
	iters: 4100, epoch: 1 | loss: 1.2281404
	speed: 0.1219s/iter; left time: 10906.0397s
	iters: 4200, epoch: 1 | loss: 1.1106554
	speed: 0.1216s/iter; left time: 10870.7183s
	iters: 4300, epoch: 1 | loss: 1.1531733
	speed: 0.1214s/iter; left time: 10839.8408s
	iters: 4400, epoch: 1 | loss: 1.1310227
	speed: 0.1217s/iter; left time: 10859.1777s
	iters: 4500, epoch: 1 | loss: 1.1309807
	speed: 0.1218s/iter; left time: 10854.4902s
	iters: 4600, epoch: 1 | loss: 1.1119970
	speed: 0.1215s/iter; left time: 10817.7878s
	iters: 4700, epoch: 1 | loss: 1.1614714
	speed: 0.1224s/iter; left time: 10884.3290s
	iters: 4800, epoch: 1 | loss: 1.0865467
	speed: 0.1215s/iter; left time: 10785.4920s
	iters: 4900, epoch: 1 | loss: 1.1402661
	speed: 0.1211s/iter; left time: 10743.2494s
	iters: 5000, epoch: 1 | loss: 1.1340151
	speed: 0.1210s/iter; left time: 10718.9587s
	iters: 5100, epoch: 1 | loss: 1.1166434
	speed: 0.1210s/iter; left time: 10711.9839s
	iters: 5200, epoch: 1 | loss: 1.0442241
	speed: 0.1212s/iter; left time: 10710.9549s
	iters: 5300, epoch: 1 | loss: 1.1251817
	speed: 0.1223s/iter; left time: 10798.0654s
	iters: 5400, epoch: 1 | loss: 1.1399530
	speed: 0.1218s/iter; left time: 10738.9160s
	iters: 5500, epoch: 1 | loss: 1.0905465
	speed: 0.1214s/iter; left time: 10692.4183s
	iters: 5600, epoch: 1 | loss: 1.0893947
	speed: 0.1215s/iter; left time: 10690.0986s
	iters: 5700, epoch: 1 | loss: 1.1278749
	speed: 0.1216s/iter; left time: 10687.2433s
	iters: 5800, epoch: 1 | loss: 1.0818257
	speed: 0.1217s/iter; left time: 10689.3319s
	iters: 5900, epoch: 1 | loss: 1.0262026
	speed: 0.1218s/iter; left time: 10685.7307s
	iters: 6000, epoch: 1 | loss: 1.0807067
	speed: 0.1220s/iter; left time: 10687.9119s
	iters: 6100, epoch: 1 | loss: 1.1800240
	speed: 0.1216s/iter; left time: 10642.1517s
	iters: 6200, epoch: 1 | loss: 1.1441432
	speed: 0.1221s/iter; left time: 10672.4686s
	iters: 6300, epoch: 1 | loss: 1.0311964
	speed: 0.1217s/iter; left time: 10623.7365s
	iters: 6400, epoch: 1 | loss: 1.0947911
	speed: 0.1214s/iter; left time: 10584.4137s
	iters: 6500, epoch: 1 | loss: 1.1056477
	speed: 0.1214s/iter; left time: 10571.1149s
	iters: 6600, epoch: 1 | loss: 1.0174171
	speed: 0.1208s/iter; left time: 10505.9663s
	iters: 6700, epoch: 1 | loss: 1.0752861
	speed: 0.1208s/iter; left time: 10500.4964s
	iters: 6800, epoch: 1 | loss: 1.2809278
	speed: 0.1211s/iter; left time: 10509.7029s
	iters: 6900, epoch: 1 | loss: 1.1401023
	speed: 0.1213s/iter; left time: 10517.3657s
	iters: 7000, epoch: 1 | loss: 1.0801927
	speed: 0.1215s/iter; left time: 10526.2551s
	iters: 7100, epoch: 1 | loss: 1.0307319
	speed: 0.1218s/iter; left time: 10537.4928s
	iters: 7200, epoch: 1 | loss: 1.1118201
	speed: 0.1216s/iter; left time: 10502.1773s
	iters: 7300, epoch: 1 | loss: 1.4624408
	speed: 0.1216s/iter; left time: 10491.5246s
	iters: 7400, epoch: 1 | loss: 1.1811725
	speed: 0.1218s/iter; left time: 10499.9913s
	iters: 7500, epoch: 1 | loss: 1.1485517
	speed: 0.1216s/iter; left time: 10469.9989s
	iters: 7600, epoch: 1 | loss: 1.0770001
	speed: 0.1215s/iter; left time: 10452.4578s
	iters: 7700, epoch: 1 | loss: 1.1170003
	speed: 0.1217s/iter; left time: 10453.0272s
	iters: 7800, epoch: 1 | loss: 1.1080139
	speed: 0.1218s/iter; left time: 10450.4551s
	iters: 7900, epoch: 1 | loss: 1.0834962
	speed: 0.1216s/iter; left time: 10417.5687s
	iters: 8000, epoch: 1 | loss: 1.0809777
	speed: 0.1218s/iter; left time: 10427.2231s
	iters: 8100, epoch: 1 | loss: 1.0584087
	speed: 0.1219s/iter; left time: 10420.4376s
	iters: 8200, epoch: 1 | loss: 1.1172676
	speed: 0.1216s/iter; left time: 10384.4666s
	iters: 8300, epoch: 1 | loss: 1.0002112
	speed: 0.1223s/iter; left time: 10435.9675s
	iters: 8400, epoch: 1 | loss: 1.1508824
	speed: 0.1217s/iter; left time: 10368.2159s
	iters: 8500, epoch: 1 | loss: 1.0149624
	speed: 0.1211s/iter; left time: 10308.8976s
	iters: 8600, epoch: 1 | loss: 1.1370565
	speed: 0.1222s/iter; left time: 10385.1400s
	iters: 8700, epoch: 1 | loss: 1.0934744
	speed: 0.1222s/iter; left time: 10378.7537s
	iters: 8800, epoch: 1 | loss: 1.2032577
	speed: 0.1214s/iter; left time: 10293.3039s
	iters: 8900, epoch: 1 | loss: 1.0383414
	speed: 0.1218s/iter; left time: 10315.4570s
	iters: 9000, epoch: 1 | loss: 1.2098652
	speed: 0.1220s/iter; left time: 10319.3185s
	iters: 9100, epoch: 1 | loss: 1.2126799
	speed: 0.1218s/iter; left time: 10296.4238s
	iters: 9200, epoch: 1 | loss: 1.0734352
	speed: 0.1220s/iter; left time: 10293.3257s
	iters: 9300, epoch: 1 | loss: 1.0649028
	speed: 0.1217s/iter; left time: 10261.3826s
Epoch: 1 cost time: 1184.387847661972
Epoch: 1, Steps: 9360 | Train Loss: 1.0887278 Vali Loss: 1.1208783 Test Loss: 0.9760404
Validation loss decreased (inf --> 1.120878).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.2180744
	speed: 4.2588s/iter; left time: 358342.5036s
	iters: 200, epoch: 2 | loss: 1.2343831
	speed: 0.1223s/iter; left time: 10280.1122s
	iters: 300, epoch: 2 | loss: 1.2804526
	speed: 0.1216s/iter; left time: 10209.7823s
	iters: 400, epoch: 2 | loss: 1.1141570
	speed: 0.1218s/iter; left time: 10214.0113s
	iters: 500, epoch: 2 | loss: 1.1532099
	speed: 0.1220s/iter; left time: 10218.7586s
	iters: 600, epoch: 2 | loss: 1.2781394
	speed: 0.1216s/iter; left time: 10174.5764s
	iters: 700, epoch: 2 | loss: 1.0764736
	speed: 0.1215s/iter; left time: 10148.3310s
	iters: 800, epoch: 2 | loss: 1.0922778
	speed: 0.1217s/iter; left time: 10157.9816s
	iters: 900, epoch: 2 | loss: 1.0194337
	speed: 0.1218s/iter; left time: 10149.6892s
	iters: 1000, epoch: 2 | loss: 1.0243454
	speed: 0.1216s/iter; left time: 10125.0957s
	iters: 1100, epoch: 2 | loss: 1.0863767
	speed: 0.1214s/iter; left time: 10095.4526s
	iters: 1200, epoch: 2 | loss: 0.9992735
	speed: 0.1233s/iter; left time: 10239.0717s
	iters: 1300, epoch: 2 | loss: 1.0676529
	speed: 0.1224s/iter; left time: 10152.5554s
	iters: 1400, epoch: 2 | loss: 1.0952284
	speed: 0.1220s/iter; left time: 10107.4561s
	iters: 1500, epoch: 2 | loss: 1.0505449
	speed: 0.1224s/iter; left time: 10128.1030s
	iters: 1600, epoch: 2 | loss: 1.2236106
	speed: 0.1210s/iter; left time: 10002.8005s
	iters: 1700, epoch: 2 | loss: 1.0286244
	speed: 0.1213s/iter; left time: 10015.8981s
	iters: 1800, epoch: 2 | loss: 1.0796331
	speed: 0.1221s/iter; left time: 10064.6911s
	iters: 1900, epoch: 2 | loss: 1.0800751
	speed: 0.1216s/iter; left time: 10009.1483s
	iters: 2000, epoch: 2 | loss: 1.1284629
	speed: 0.1215s/iter; left time: 9995.5433s
	iters: 2100, epoch: 2 | loss: 1.1257435
	speed: 0.1214s/iter; left time: 9973.9147s
	iters: 2200, epoch: 2 | loss: 1.2911429
	speed: 0.1219s/iter; left time: 10000.0195s
	iters: 2300, epoch: 2 | loss: 1.2177163
	speed: 0.1216s/iter; left time: 9963.8293s
	iters: 2400, epoch: 2 | loss: 1.0272089
	speed: 0.1232s/iter; left time: 10084.4806s
	iters: 2500, epoch: 2 | loss: 1.0754408
	speed: 0.1233s/iter; left time: 10077.3743s
	iters: 2600, epoch: 2 | loss: 1.1252929
	speed: 0.1223s/iter; left time: 9986.7580s
	iters: 2700, epoch: 2 | loss: 1.1159992
	speed: 0.1216s/iter; left time: 9914.9498s
	iters: 2800, epoch: 2 | loss: 1.0448898
	speed: 0.1216s/iter; left time: 9907.0304s
	iters: 2900, epoch: 2 | loss: 1.1228611
	speed: 0.1216s/iter; left time: 9891.2875s
	iters: 3000, epoch: 2 | loss: 1.0876548
	speed: 0.1216s/iter; left time: 9878.2523s
	iters: 3100, epoch: 2 | loss: 1.0737264
	speed: 0.1218s/iter; left time: 9884.9243s
	iters: 3200, epoch: 2 | loss: 1.0698833
	speed: 0.1219s/iter; left time: 9879.3570s
	iters: 3300, epoch: 2 | loss: 1.1789992
	speed: 0.1221s/iter; left time: 9885.0994s
	iters: 3400, epoch: 2 | loss: 1.1342183
	speed: 0.1221s/iter; left time: 9869.4449s
	iters: 3500, epoch: 2 | loss: 1.2074180
	speed: 0.1217s/iter; left time: 9824.8297s
	iters: 3600, epoch: 2 | loss: 1.0651249
	speed: 0.1219s/iter; left time: 9827.1484s
	iters: 3700, epoch: 2 | loss: 1.0773963
	speed: 0.1216s/iter; left time: 9796.1049s
	iters: 3800, epoch: 2 | loss: 1.0789437
	speed: 0.1218s/iter; left time: 9794.6445s
	iters: 3900, epoch: 2 | loss: 1.1621078
	speed: 0.1217s/iter; left time: 9774.4281s
	iters: 4000, epoch: 2 | loss: 1.1430287
	speed: 0.1218s/iter; left time: 9776.8016s
	iters: 4100, epoch: 2 | loss: 1.2197081
	speed: 0.1217s/iter; left time: 9752.2785s
	iters: 4200, epoch: 2 | loss: 1.1969526
	speed: 0.1219s/iter; left time: 9753.0309s
	iters: 4300, epoch: 2 | loss: 1.2480714
	speed: 0.1219s/iter; left time: 9742.9401s
	iters: 4400, epoch: 2 | loss: 1.0553082
	speed: 0.1215s/iter; left time: 9701.4780s
	iters: 4500, epoch: 2 | loss: 1.0996737
	speed: 0.1219s/iter; left time: 9720.3694s
	iters: 4600, epoch: 2 | loss: 1.0344132
	speed: 0.1219s/iter; left time: 9710.7392s
	iters: 4700, epoch: 2 | loss: 1.1558793
	speed: 0.1219s/iter; left time: 9696.8238s
	iters: 4800, epoch: 2 | loss: 1.2724880
	speed: 0.1217s/iter; left time: 9669.0369s
	iters: 4900, epoch: 2 | loss: 1.1112931
	speed: 0.1216s/iter; left time: 9649.1056s
	iters: 5000, epoch: 2 | loss: 1.1533140
	speed: 0.1214s/iter; left time: 9620.2404s
	iters: 5100, epoch: 2 | loss: 1.1485751
	speed: 0.1221s/iter; left time: 9663.7860s
	iters: 5200, epoch: 2 | loss: 1.3085591
	speed: 0.1218s/iter; left time: 9623.2530s
	iters: 5300, epoch: 2 | loss: 1.1080498
	speed: 0.1215s/iter; left time: 9588.0170s
	iters: 5400, epoch: 2 | loss: 1.1169649
	speed: 0.1219s/iter; left time: 9607.0664s
	iters: 5500, epoch: 2 | loss: 1.0279740
	speed: 0.1222s/iter; left time: 9621.3426s
	iters: 5600, epoch: 2 | loss: 1.1025981
	speed: 0.1217s/iter; left time: 9572.0475s
	iters: 5700, epoch: 2 | loss: 1.0559623
	speed: 0.1222s/iter; left time: 9596.4530s
	iters: 5800, epoch: 2 | loss: 1.1123363
	speed: 0.1217s/iter; left time: 9545.3999s
	iters: 5900, epoch: 2 | loss: 1.1347332
	speed: 0.1221s/iter; left time: 9569.0815s
	iters: 6000, epoch: 2 | loss: 1.2246059
	speed: 0.1218s/iter; left time: 9532.0272s
	iters: 6100, epoch: 2 | loss: 0.9735870
	speed: 0.1216s/iter; left time: 9499.3132s
	iters: 6200, epoch: 2 | loss: 1.1759946
	speed: 0.1222s/iter; left time: 9535.9142s
	iters: 6300, epoch: 2 | loss: 1.2113885
	speed: 0.1225s/iter; left time: 9551.1636s
	iters: 6400, epoch: 2 | loss: 1.0933377
	speed: 0.1222s/iter; left time: 9513.1538s
	iters: 6500, epoch: 2 | loss: 1.0605580
	speed: 0.1217s/iter; left time: 9459.7134s
	iters: 6600, epoch: 2 | loss: 1.0154718
	speed: 0.1219s/iter; left time: 9461.1765s
	iters: 6700, epoch: 2 | loss: 1.0921860
	speed: 0.1215s/iter; left time: 9424.5574s
	iters: 6800, epoch: 2 | loss: 1.0312817
	speed: 0.1216s/iter; left time: 9420.1858s
	iters: 6900, epoch: 2 | loss: 1.0124294
	speed: 0.1218s/iter; left time: 9418.8080s
	iters: 7000, epoch: 2 | loss: 1.0273649
	speed: 0.1221s/iter; left time: 9430.6621s
	iters: 7100, epoch: 2 | loss: 1.1019188
	speed: 0.1220s/iter; left time: 9409.4920s
	iters: 7200, epoch: 2 | loss: 1.0067080
	speed: 0.1219s/iter; left time: 9392.6869s
	iters: 7300, epoch: 2 | loss: 1.1526223
	speed: 0.1220s/iter; left time: 9384.3314s
	iters: 7400, epoch: 2 | loss: 1.1455941
	speed: 0.1221s/iter; left time: 9382.5723s
	iters: 7500, epoch: 2 | loss: 1.0146191
	speed: 0.1228s/iter; left time: 9421.4323s
	iters: 7600, epoch: 2 | loss: 1.1033398
	speed: 0.1224s/iter; left time: 9377.5774s
	iters: 7700, epoch: 2 | loss: 1.1009337
	speed: 0.1242s/iter; left time: 9502.5750s
	iters: 7800, epoch: 2 | loss: 1.0548987
	speed: 0.1223s/iter; left time: 9348.6251s
	iters: 7900, epoch: 2 | loss: 1.2148123
	speed: 0.1258s/iter; left time: 9600.1924s
	iters: 8000, epoch: 2 | loss: 1.0672058
	speed: 0.1252s/iter; left time: 9546.3246s
	iters: 8100, epoch: 2 | loss: 1.0978876
	speed: 0.1223s/iter; left time: 9314.4856s
	iters: 8200, epoch: 2 | loss: 1.0376726
	speed: 0.1221s/iter; left time: 9286.4717s
	iters: 8300, epoch: 2 | loss: 1.1167021
	speed: 0.1221s/iter; left time: 9270.1414s
	iters: 8400, epoch: 2 | loss: 1.0861934
	speed: 0.1228s/iter; left time: 9313.5265s
	iters: 8500, epoch: 2 | loss: 1.1290848
	speed: 0.1225s/iter; left time: 9280.4073s
	iters: 8600, epoch: 2 | loss: 1.1268306
	speed: 0.1219s/iter; left time: 9217.2239s
	iters: 8700, epoch: 2 | loss: 1.1183965
	speed: 0.1229s/iter; left time: 9282.0398s
	iters: 8800, epoch: 2 | loss: 1.1581969
	speed: 0.1226s/iter; left time: 9251.3005s
	iters: 8900, epoch: 2 | loss: 0.9987915
	speed: 0.1221s/iter; left time: 9202.7958s
	iters: 9000, epoch: 2 | loss: 1.0270349
	speed: 0.1221s/iter; left time: 9185.6991s
	iters: 9100, epoch: 2 | loss: 1.1218181
	speed: 0.1226s/iter; left time: 9210.4740s
	iters: 9200, epoch: 2 | loss: 1.0518186
	speed: 0.1234s/iter; left time: 9259.9180s
	iters: 9300, epoch: 2 | loss: 1.1268501
	speed: 0.1215s/iter; left time: 9101.8742s
Epoch: 2 cost time: 1143.3366940021515
Epoch: 2, Steps: 9360 | Train Loss: 1.1057820 Vali Loss: 1.1225893 Test Loss: 0.9719992
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.0581703
	speed: 4.1028s/iter; left time: 306810.8706s
	iters: 200, epoch: 3 | loss: 1.0276184
	speed: 0.1228s/iter; left time: 9172.3988s
	iters: 300, epoch: 3 | loss: 1.0868742
	speed: 0.1222s/iter; left time: 9112.4042s
	iters: 400, epoch: 3 | loss: 1.0714476
	speed: 0.1217s/iter; left time: 9066.0824s
	iters: 500, epoch: 3 | loss: 1.1716747
	speed: 0.1218s/iter; left time: 9061.7942s
	iters: 600, epoch: 3 | loss: 1.0204878
	speed: 0.1216s/iter; left time: 9035.9353s
	iters: 700, epoch: 3 | loss: 1.2153308
	speed: 0.1217s/iter; left time: 9030.0192s
	iters: 800, epoch: 3 | loss: 1.1057360
	speed: 0.1217s/iter; left time: 9016.5815s
	iters: 900, epoch: 3 | loss: 1.0947822
	speed: 0.1217s/iter; left time: 9003.1510s
	iters: 1000, epoch: 3 | loss: 1.0621111
	speed: 0.1218s/iter; left time: 8996.2444s
	iters: 1100, epoch: 3 | loss: 1.0962856
	speed: 0.1220s/iter; left time: 8998.6461s
	iters: 1200, epoch: 3 | loss: 1.0810760
	speed: 0.1226s/iter; left time: 9030.7153s
	iters: 1300, epoch: 3 | loss: 1.0399604
	speed: 0.1243s/iter; left time: 9149.7385s
	iters: 1400, epoch: 3 | loss: 1.0367186
	speed: 0.1217s/iter; left time: 8939.7026s
	iters: 1500, epoch: 3 | loss: 1.0266217
	speed: 0.1218s/iter; left time: 8936.8077s
	iters: 1600, epoch: 3 | loss: 1.0794623
	speed: 0.1218s/iter; left time: 8922.5659s
	iters: 1700, epoch: 3 | loss: 1.1317641
	speed: 0.1218s/iter; left time: 8912.7446s
	iters: 1800, epoch: 3 | loss: 1.0855476
	speed: 0.1221s/iter; left time: 8919.6888s
	iters: 1900, epoch: 3 | loss: 1.0789034
	speed: 0.1224s/iter; left time: 8931.1384s
	iters: 2000, epoch: 3 | loss: 1.0906637
	speed: 0.1219s/iter; left time: 8886.9512s
	iters: 2100, epoch: 3 | loss: 1.0011361
	speed: 0.1220s/iter; left time: 8878.6950s
	iters: 2200, epoch: 3 | loss: 1.0226098
	speed: 0.1219s/iter; left time: 8862.5752s
	iters: 2300, epoch: 3 | loss: 1.1884508
	speed: 0.1225s/iter; left time: 8890.5890s
	iters: 2400, epoch: 3 | loss: 1.0451195
	speed: 0.1217s/iter; left time: 8817.9064s
	iters: 2500, epoch: 3 | loss: 0.9644122
	speed: 0.1219s/iter; left time: 8824.1282s
	iters: 2600, epoch: 3 | loss: 0.9857713
	speed: 0.1217s/iter; left time: 8796.1812s
	iters: 2700, epoch: 3 | loss: 1.0508040
	speed: 0.1214s/iter; left time: 8759.9666s
	iters: 2800, epoch: 3 | loss: 1.1370457
	speed: 0.1231s/iter; left time: 8873.8743s
	iters: 2900, epoch: 3 | loss: 1.1058571
	speed: 0.1217s/iter; left time: 8758.3249s
	iters: 3000, epoch: 3 | loss: 1.1230201
	speed: 0.1220s/iter; left time: 8766.7832s
	iters: 3100, epoch: 3 | loss: 1.1492378
	speed: 0.1220s/iter; left time: 8758.8933s
	iters: 3200, epoch: 3 | loss: 1.1437480
	speed: 0.1219s/iter; left time: 8740.0307s
	iters: 3300, epoch: 3 | loss: 1.1139374
	speed: 0.1223s/iter; left time: 8754.1428s
	iters: 3400, epoch: 3 | loss: 1.1089242
	speed: 0.1244s/iter; left time: 8891.6708s
	iters: 3500, epoch: 3 | loss: 1.1346191
	speed: 0.1271s/iter; left time: 9072.1630s
	iters: 3600, epoch: 3 | loss: 1.0535575
	speed: 0.1222s/iter; left time: 8711.8395s
	iters: 3700, epoch: 3 | loss: 1.1366124
	speed: 0.1217s/iter; left time: 8666.2097s
	iters: 3800, epoch: 3 | loss: 1.0981886
	speed: 0.1220s/iter; left time: 8674.0307s
	iters: 3900, epoch: 3 | loss: 1.0319239
	speed: 0.1244s/iter; left time: 8828.3656s
	iters: 4000, epoch: 3 | loss: 1.1761311
	speed: 0.1246s/iter; left time: 8834.4843s
	iters: 4100, epoch: 3 | loss: 1.2037035
	speed: 0.1282s/iter; left time: 9071.3657s
	iters: 4200, epoch: 3 | loss: 1.0729713
	speed: 0.1278s/iter; left time: 9034.0715s
	iters: 4300, epoch: 3 | loss: 1.1710407
	speed: 0.1274s/iter; left time: 8991.3683s
	iters: 4400, epoch: 3 | loss: 1.0745609
	speed: 0.1217s/iter; left time: 8580.5670s
	iters: 4500, epoch: 3 | loss: 1.0254843
	speed: 0.1220s/iter; left time: 8586.4971s
	iters: 4600, epoch: 3 | loss: 1.0133058
	speed: 0.1231s/iter; left time: 8648.8868s
	iters: 4700, epoch: 3 | loss: 1.3600800
	speed: 0.1231s/iter; left time: 8639.0416s
	iters: 4800, epoch: 3 | loss: 1.1122116
	speed: 0.1226s/iter; left time: 8591.3184s
	iters: 4900, epoch: 3 | loss: 1.0323762
	speed: 0.1237s/iter; left time: 8659.4662s
	iters: 5000, epoch: 3 | loss: 1.0842872
	speed: 0.1224s/iter; left time: 8554.6060s
	iters: 5100, epoch: 3 | loss: 1.1098870
	speed: 0.1228s/iter; left time: 8566.9624s
	iters: 5200, epoch: 3 | loss: 1.1226288
	speed: 0.1226s/iter; left time: 8543.8779s
	iters: 5300, epoch: 3 | loss: 1.1480563
	speed: 0.1230s/iter; left time: 8561.5166s
	iters: 5400, epoch: 3 | loss: 1.1800135
	speed: 0.1226s/iter; left time: 8518.1657s
	iters: 5500, epoch: 3 | loss: 1.0871364
	speed: 0.1225s/iter; left time: 8495.8833s
	iters: 5600, epoch: 3 | loss: 1.1366092
	speed: 0.1234s/iter; left time: 8551.5272s
	iters: 5700, epoch: 3 | loss: 1.0522145
	speed: 0.1225s/iter; left time: 8472.8273s
	iters: 5800, epoch: 3 | loss: 1.0089077
	speed: 0.1231s/iter; left time: 8506.4299s
	iters: 5900, epoch: 3 | loss: 1.0791262
	speed: 0.1254s/iter; left time: 8652.6935s
	iters: 6000, epoch: 3 | loss: 1.0885853
	speed: 0.1238s/iter; left time: 8527.4600s
	iters: 6100, epoch: 3 | loss: 1.1287978
	speed: 0.1234s/iter; left time: 8489.6681s
	iters: 6200, epoch: 3 | loss: 1.2704023
	speed: 0.1234s/iter; left time: 8476.3544s
	iters: 6300, epoch: 3 | loss: 1.0522130
	speed: 0.1232s/iter; left time: 8452.2363s
	iters: 6400, epoch: 3 | loss: 1.1393882
	speed: 0.1265s/iter; left time: 8665.2578s
	iters: 6500, epoch: 3 | loss: 1.0727746
	speed: 0.1275s/iter; left time: 8718.0682s
	iters: 6600, epoch: 3 | loss: 1.0848579
	speed: 0.1272s/iter; left time: 8687.8188s
	iters: 6700, epoch: 3 | loss: 1.0995878
	speed: 0.1252s/iter; left time: 8538.8192s
	iters: 6800, epoch: 3 | loss: 1.0893956
	speed: 0.1234s/iter; left time: 8402.6153s
	iters: 6900, epoch: 3 | loss: 1.0135864
	speed: 0.1233s/iter; left time: 8381.9657s
	iters: 7000, epoch: 3 | loss: 1.0117658
	speed: 0.1228s/iter; left time: 8336.2043s
	iters: 7100, epoch: 3 | loss: 1.0488317
	speed: 0.1214s/iter; left time: 8228.4225s
	iters: 7200, epoch: 3 | loss: 1.1197035
	speed: 0.1221s/iter; left time: 8263.0820s
	iters: 7300, epoch: 3 | loss: 1.0949317
	speed: 0.1213s/iter; left time: 8198.3833s
	iters: 7400, epoch: 3 | loss: 1.0882628
	speed: 0.1216s/iter; left time: 8204.5686s
	iters: 7500, epoch: 3 | loss: 1.0160631
	speed: 0.1220s/iter; left time: 8222.5154s
	iters: 7600, epoch: 3 | loss: 1.1071953
	speed: 0.1222s/iter; left time: 8221.7920s
	iters: 7700, epoch: 3 | loss: 1.0834446
	speed: 0.1220s/iter; left time: 8193.5465s
	iters: 7800, epoch: 3 | loss: 1.3035959
	speed: 0.1232s/iter; left time: 8262.4990s
	iters: 7900, epoch: 3 | loss: 1.1153866
	speed: 0.1221s/iter; left time: 8177.3929s
	iters: 8000, epoch: 3 | loss: 1.0444449
	speed: 0.1226s/iter; left time: 8201.4960s
	iters: 8100, epoch: 3 | loss: 1.3214862
	speed: 0.1220s/iter; left time: 8145.2108s
	iters: 8200, epoch: 3 | loss: 1.0742415
	speed: 0.1226s/iter; left time: 8175.9073s
	iters: 8300, epoch: 3 | loss: 1.0752244
	speed: 0.1216s/iter; left time: 8095.7625s
	iters: 8400, epoch: 3 | loss: 1.0439576
	speed: 0.1230s/iter; left time: 8174.8964s
	iters: 8500, epoch: 3 | loss: 1.0794845
	speed: 0.1226s/iter; left time: 8138.5159s
	iters: 8600, epoch: 3 | loss: 1.1677660
	speed: 0.1234s/iter; left time: 8176.0732s
	iters: 8700, epoch: 3 | loss: 1.1061109
	speed: 0.1236s/iter; left time: 8179.8453s
	iters: 8800, epoch: 3 | loss: 1.0594023
	speed: 0.1237s/iter; left time: 8176.6998s
	iters: 8900, epoch: 3 | loss: 1.1226146
	speed: 0.1233s/iter; left time: 8132.6548s
	iters: 9000, epoch: 3 | loss: 1.0496395
	speed: 0.1280s/iter; left time: 8432.4164s
	iters: 9100, epoch: 3 | loss: 1.1124357
	speed: 0.1280s/iter; left time: 8420.8776s
	iters: 9200, epoch: 3 | loss: 1.0656610
	speed: 0.1275s/iter; left time: 8375.6769s
	iters: 9300, epoch: 3 | loss: 1.4246961
	speed: 0.1249s/iter; left time: 8191.6179s
Epoch: 3 cost time: 1153.0302786827087
Epoch: 3, Steps: 9360 | Train Loss: 1.1055704 Vali Loss: 1.1215582 Test Loss: 0.9716617
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.1014385
	speed: 4.1215s/iter; left time: 269633.0501s
	iters: 200, epoch: 4 | loss: 1.0715618
	speed: 0.1217s/iter; left time: 7949.1395s
	iters: 300, epoch: 4 | loss: 1.2526333
	speed: 0.1219s/iter; left time: 7952.7696s
	iters: 400, epoch: 4 | loss: 1.1305338
	speed: 0.1217s/iter; left time: 7925.8806s
	iters: 500, epoch: 4 | loss: 1.1591600
	speed: 0.1224s/iter; left time: 7955.4304s
	iters: 600, epoch: 4 | loss: 1.0390766
	speed: 0.1235s/iter; left time: 8018.5437s
	iters: 700, epoch: 4 | loss: 1.2695837
	speed: 0.1227s/iter; left time: 7953.2471s
	iters: 800, epoch: 4 | loss: 1.0686893
	speed: 0.1216s/iter; left time: 7868.2740s
	iters: 900, epoch: 4 | loss: 1.2056420
	speed: 0.1224s/iter; left time: 7911.1006s
	iters: 1000, epoch: 4 | loss: 1.0426642
	speed: 0.1237s/iter; left time: 7982.2032s
	iters: 1100, epoch: 4 | loss: 1.0871360
	speed: 0.1220s/iter; left time: 7861.6759s
	iters: 1200, epoch: 4 | loss: 1.0696858
	speed: 0.1225s/iter; left time: 7879.0478s
	iters: 1300, epoch: 4 | loss: 1.1004195
	speed: 0.1221s/iter; left time: 7840.6602s
	iters: 1400, epoch: 4 | loss: 0.9644517
	speed: 0.1224s/iter; left time: 7849.4572s
	iters: 1500, epoch: 4 | loss: 0.9699333
	speed: 0.1226s/iter; left time: 7846.7136s
	iters: 1600, epoch: 4 | loss: 1.0813638
	speed: 0.1234s/iter; left time: 7888.7961s
	iters: 1700, epoch: 4 | loss: 1.0291855
	speed: 0.1226s/iter; left time: 7822.8099s
	iters: 1800, epoch: 4 | loss: 1.0982680
	speed: 0.1217s/iter; left time: 7757.2900s
	iters: 1900, epoch: 4 | loss: 0.9926972
	speed: 0.1251s/iter; left time: 7959.4836s
	iters: 2000, epoch: 4 | loss: 1.3561547
	speed: 0.1226s/iter; left time: 7784.8026s
	iters: 2100, epoch: 4 | loss: 0.9833061
	speed: 0.1236s/iter; left time: 7837.5997s
	iters: 2200, epoch: 4 | loss: 1.1505212
	speed: 0.1230s/iter; left time: 7789.9454s
	iters: 2300, epoch: 4 | loss: 1.1379962
	speed: 0.1226s/iter; left time: 7753.1254s
	iters: 2400, epoch: 4 | loss: 1.1575053
	speed: 0.1224s/iter; left time: 7728.0262s
	iters: 2500, epoch: 4 | loss: 1.0875660
	speed: 0.1224s/iter; left time: 7713.3679s
	iters: 2600, epoch: 4 | loss: 1.0765300
	speed: 0.1223s/iter; left time: 7694.8067s
	iters: 2700, epoch: 4 | loss: 1.0778725
	speed: 0.1223s/iter; left time: 7682.9235s
	iters: 2800, epoch: 4 | loss: 1.1085323
	speed: 0.1240s/iter; left time: 7780.1394s
	iters: 2900, epoch: 4 | loss: 0.9701518
	speed: 0.1273s/iter; left time: 7974.5367s
	iters: 3000, epoch: 4 | loss: 1.0411378
	speed: 0.1262s/iter; left time: 7891.4968s
	iters: 3100, epoch: 4 | loss: 1.1617317
	speed: 0.1244s/iter; left time: 7767.1262s
	iters: 3200, epoch: 4 | loss: 1.1363142
	speed: 0.1251s/iter; left time: 7794.2062s
	iters: 3300, epoch: 4 | loss: 1.0436796
	speed: 0.1261s/iter; left time: 7845.3122s
	iters: 3400, epoch: 4 | loss: 1.1746012
	speed: 0.1266s/iter; left time: 7867.2117s
	iters: 3500, epoch: 4 | loss: 1.0058548
	speed: 0.1265s/iter; left time: 7843.8895s
	iters: 3600, epoch: 4 | loss: 1.1538767
	speed: 0.1266s/iter; left time: 7841.9155s
	iters: 3700, epoch: 4 | loss: 1.1052953
	speed: 0.1267s/iter; left time: 7833.7092s
	iters: 3800, epoch: 4 | loss: 1.0663882
	speed: 0.1269s/iter; left time: 7833.5603s
	iters: 3900, epoch: 4 | loss: 1.0484308
	speed: 0.1270s/iter; left time: 7827.2414s
	iters: 4000, epoch: 4 | loss: 1.0733366
	speed: 0.1268s/iter; left time: 7797.9407s
	iters: 4100, epoch: 4 | loss: 1.0801234
	speed: 0.1261s/iter; left time: 7743.8084s
	iters: 4200, epoch: 4 | loss: 1.1195661
	speed: 0.1235s/iter; left time: 7571.4538s
	iters: 4300, epoch: 4 | loss: 1.1423520
	speed: 0.1225s/iter; left time: 7498.9748s
	iters: 4400, epoch: 4 | loss: 1.0430865
	speed: 0.1219s/iter; left time: 7448.5288s
	iters: 4500, epoch: 4 | loss: 1.2008814
	speed: 0.1233s/iter; left time: 7523.9610s
	iters: 4600, epoch: 4 | loss: 1.1849103
	speed: 0.1242s/iter; left time: 7567.0311s
	iters: 4700, epoch: 4 | loss: 1.0610199
	speed: 0.1226s/iter; left time: 7458.9030s
	iters: 4800, epoch: 4 | loss: 1.0838835
	speed: 0.1238s/iter; left time: 7518.9050s
	iters: 4900, epoch: 4 | loss: 1.3453399
	speed: 0.1269s/iter; left time: 7691.6441s
	iters: 5000, epoch: 4 | loss: 1.0955642
	speed: 0.1259s/iter; left time: 7617.5419s
	iters: 5100, epoch: 4 | loss: 1.0959018
	speed: 0.1275s/iter; left time: 7705.0138s
	iters: 5200, epoch: 4 | loss: 1.0271963
	speed: 0.1267s/iter; left time: 7643.1551s
	iters: 5300, epoch: 4 | loss: 1.1839633
	speed: 0.1276s/iter; left time: 7686.3257s
	iters: 5400, epoch: 4 | loss: 1.0801611
	speed: 0.1277s/iter; left time: 7676.0408s
	iters: 5500, epoch: 4 | loss: 1.1105565
	speed: 0.1279s/iter; left time: 7675.3646s
	iters: 5600, epoch: 4 | loss: 1.2650088
	speed: 0.1277s/iter; left time: 7649.9462s
	iters: 5700, epoch: 4 | loss: 1.0494193
	speed: 0.1260s/iter; left time: 7536.4978s
	iters: 5800, epoch: 4 | loss: 1.0208194
	speed: 0.1239s/iter; left time: 7399.7257s
	iters: 5900, epoch: 4 | loss: 1.0188382
	speed: 0.1258s/iter; left time: 7502.2204s
	iters: 6000, epoch: 4 | loss: 1.1365005
	speed: 0.1226s/iter; left time: 7299.2643s
	iters: 6100, epoch: 4 | loss: 1.1065100
	speed: 0.1268s/iter; left time: 7536.1958s
	iters: 6200, epoch: 4 | loss: 1.1306148
	speed: 0.1250s/iter; left time: 7413.4237s
	iters: 6300, epoch: 4 | loss: 1.1039369
	speed: 0.1281s/iter; left time: 7583.7479s
	iters: 6400, epoch: 4 | loss: 1.1155498
	speed: 0.1278s/iter; left time: 7556.9497s
	iters: 6500, epoch: 4 | loss: 1.1528651
	speed: 0.1269s/iter; left time: 7490.2691s
	iters: 6600, epoch: 4 | loss: 1.0412692
	speed: 0.1274s/iter; left time: 7504.8849s
	iters: 6700, epoch: 4 | loss: 1.1782798
	speed: 0.1267s/iter; left time: 7454.8928s
	iters: 6800, epoch: 4 | loss: 0.9725052
	speed: 0.1261s/iter; left time: 7403.1556s
	iters: 6900, epoch: 4 | loss: 1.1068350
	speed: 0.1236s/iter; left time: 7245.5388s
	iters: 7000, epoch: 4 | loss: 1.0977159
	speed: 0.1243s/iter; left time: 7271.6093s
	iters: 7100, epoch: 4 | loss: 1.1073934
	speed: 0.1238s/iter; left time: 7231.8964s
	iters: 7200, epoch: 4 | loss: 1.1369529
	speed: 0.1229s/iter; left time: 7165.4016s
	iters: 7300, epoch: 4 | loss: 1.3182424
	speed: 0.1226s/iter; left time: 7136.0624s
	iters: 7400, epoch: 4 | loss: 1.1272540
	speed: 0.1220s/iter; left time: 7093.2833s
	iters: 7500, epoch: 4 | loss: 1.0873041
	speed: 0.1276s/iter; left time: 7402.5405s
	iters: 7600, epoch: 4 | loss: 1.1083081
	speed: 0.1279s/iter; left time: 7410.8466s
	iters: 7700, epoch: 4 | loss: 1.1675379
	speed: 0.1232s/iter; left time: 7122.7629s
	iters: 7800, epoch: 4 | loss: 1.0687678
	speed: 0.1222s/iter; left time: 7051.4082s
	iters: 7900, epoch: 4 | loss: 1.0559125
	speed: 0.1221s/iter; left time: 7033.8956s
	iters: 8000, epoch: 4 | loss: 1.0801122
	speed: 0.1226s/iter; left time: 7052.4351s
	iters: 8100, epoch: 4 | loss: 1.0263880
	speed: 0.1231s/iter; left time: 7066.5800s
	iters: 8200, epoch: 4 | loss: 1.0564977
	speed: 0.1220s/iter; left time: 6991.3128s
	iters: 8300, epoch: 4 | loss: 0.9768534
	speed: 0.1212s/iter; left time: 6934.8524s
	iters: 8400, epoch: 4 | loss: 1.0949101
	speed: 0.1225s/iter; left time: 6994.9977s
	iters: 8500, epoch: 4 | loss: 1.2159522
	speed: 0.1227s/iter; left time: 6995.4840s
	iters: 8600, epoch: 4 | loss: 1.0990118
	speed: 0.1240s/iter; left time: 7058.3674s
	iters: 8700, epoch: 4 | loss: 1.0646763
	speed: 0.1224s/iter; left time: 6955.4823s
	iters: 8800, epoch: 4 | loss: 1.0739712
	speed: 0.1219s/iter; left time: 6913.3860s
	iters: 8900, epoch: 4 | loss: 1.2152408
	speed: 0.1220s/iter; left time: 6906.6117s
	iters: 9000, epoch: 4 | loss: 1.1823003
	speed: 0.1224s/iter; left time: 6920.0639s
	iters: 9100, epoch: 4 | loss: 1.0870397
	speed: 0.1223s/iter; left time: 6898.0615s
	iters: 9200, epoch: 4 | loss: 1.1242568
	speed: 0.1249s/iter; left time: 7031.8097s
	iters: 9300, epoch: 4 | loss: 1.1631584
	speed: 0.1269s/iter; left time: 7132.7568s
Epoch: 4 cost time: 1163.2261316776276
Epoch: 4, Steps: 9360 | Train Loss: 1.1054997 Vali Loss: 1.1211578 Test Loss: 0.9725699
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_all_720_192_iTransformer_custom_ftM_sl720_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 352907
test shape: (35290, 1, 192, 822) (35290, 1, 192, 822)
test shape: (35290, 192, 822) (35290, 192, 822)
