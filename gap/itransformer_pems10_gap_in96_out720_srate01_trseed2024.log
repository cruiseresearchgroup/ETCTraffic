Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_all_common_flow.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1124877
val 69993
test 245821
	iters: 100, epoch: 1 | loss: 1.4822420
	speed: 0.0344s/iter; left time: 2412.4462s
	iters: 200, epoch: 1 | loss: 1.4828953
	speed: 0.0303s/iter; left time: 2126.8915s
	iters: 300, epoch: 1 | loss: 1.7043390
	speed: 0.0304s/iter; left time: 2126.7905s
	iters: 400, epoch: 1 | loss: 1.3989922
	speed: 0.0307s/iter; left time: 2145.3029s
	iters: 500, epoch: 1 | loss: 1.6048632
	speed: 0.0304s/iter; left time: 2123.0093s
	iters: 600, epoch: 1 | loss: 1.8972691
	speed: 0.0304s/iter; left time: 2120.5047s
	iters: 700, epoch: 1 | loss: 1.6330514
	speed: 0.0304s/iter; left time: 2118.2561s
	iters: 800, epoch: 1 | loss: 1.7085196
	speed: 0.0305s/iter; left time: 2117.7102s
	iters: 900, epoch: 1 | loss: 1.6098962
	speed: 0.0305s/iter; left time: 2120.1387s
	iters: 1000, epoch: 1 | loss: 1.6064559
	speed: 0.0306s/iter; left time: 2117.9149s
	iters: 1100, epoch: 1 | loss: 1.7135001
	speed: 0.0304s/iter; left time: 2100.7251s
	iters: 1200, epoch: 1 | loss: 1.5636027
	speed: 0.0305s/iter; left time: 2105.0469s
	iters: 1300, epoch: 1 | loss: 1.7327342
	speed: 0.0305s/iter; left time: 2102.8962s
	iters: 1400, epoch: 1 | loss: 1.3268224
	speed: 0.0306s/iter; left time: 2105.6440s
	iters: 1500, epoch: 1 | loss: 1.4779372
	speed: 0.0308s/iter; left time: 2116.1278s
	iters: 1600, epoch: 1 | loss: 1.8305414
	speed: 0.0304s/iter; left time: 2090.8923s
	iters: 1700, epoch: 1 | loss: 1.7950054
	speed: 0.0303s/iter; left time: 2078.9449s
	iters: 1800, epoch: 1 | loss: 1.6427118
	speed: 0.0305s/iter; left time: 2091.6832s
	iters: 1900, epoch: 1 | loss: 1.4811740
	speed: 0.0305s/iter; left time: 2085.2990s
	iters: 2000, epoch: 1 | loss: 1.5022519
	speed: 0.0305s/iter; left time: 2086.5178s
	iters: 2100, epoch: 1 | loss: 1.5427613
	speed: 0.0305s/iter; left time: 2081.4365s
	iters: 2200, epoch: 1 | loss: 1.4801086
	speed: 0.0305s/iter; left time: 2074.9204s
	iters: 2300, epoch: 1 | loss: 1.6644392
	speed: 0.0307s/iter; left time: 2087.2897s
	iters: 2400, epoch: 1 | loss: 1.3403128
	speed: 0.0305s/iter; left time: 2068.9070s
	iters: 2500, epoch: 1 | loss: 1.7304306
	speed: 0.0308s/iter; left time: 2088.1416s
	iters: 2600, epoch: 1 | loss: 1.6284993
	speed: 0.0305s/iter; left time: 2063.3606s
	iters: 2700, epoch: 1 | loss: 1.6855466
	speed: 0.0305s/iter; left time: 2058.7197s
	iters: 2800, epoch: 1 | loss: 1.4649251
	speed: 0.0304s/iter; left time: 2052.9084s
	iters: 2900, epoch: 1 | loss: 1.5727876
	speed: 0.0304s/iter; left time: 2049.1610s
	iters: 3000, epoch: 1 | loss: 1.8380468
	speed: 0.0305s/iter; left time: 2050.1306s
	iters: 3100, epoch: 1 | loss: 1.5515453
	speed: 0.0304s/iter; left time: 2044.9500s
	iters: 3200, epoch: 1 | loss: 1.6764224
	speed: 0.0304s/iter; left time: 2042.2394s
	iters: 3300, epoch: 1 | loss: 1.6478034
	speed: 0.0309s/iter; left time: 2072.4251s
	iters: 3400, epoch: 1 | loss: 1.7055799
	speed: 0.0304s/iter; left time: 2034.3064s
	iters: 3500, epoch: 1 | loss: 1.7048656
	speed: 0.0304s/iter; left time: 2032.1005s
	iters: 3600, epoch: 1 | loss: 1.5323099
	speed: 0.0304s/iter; left time: 2029.6036s
	iters: 3700, epoch: 1 | loss: 1.4768025
	speed: 0.0304s/iter; left time: 2024.9498s
	iters: 3800, epoch: 1 | loss: 1.3504149
	speed: 0.0304s/iter; left time: 2021.7020s
	iters: 3900, epoch: 1 | loss: 1.7483230
	speed: 0.0304s/iter; left time: 2019.8412s
	iters: 4000, epoch: 1 | loss: 1.5634212
	speed: 0.0304s/iter; left time: 2016.0749s
	iters: 4100, epoch: 1 | loss: 1.7940954
	speed: 0.0304s/iter; left time: 2013.5163s
	iters: 4200, epoch: 1 | loss: 1.7953894
	speed: 0.0304s/iter; left time: 2010.8514s
	iters: 4300, epoch: 1 | loss: 1.5487301
	speed: 0.0304s/iter; left time: 2007.2252s
	iters: 4400, epoch: 1 | loss: 1.4680033
	speed: 0.0304s/iter; left time: 2004.2228s
	iters: 4500, epoch: 1 | loss: 1.6270251
	speed: 0.0304s/iter; left time: 2001.6114s
	iters: 4600, epoch: 1 | loss: 1.6138723
	speed: 0.0304s/iter; left time: 1998.0140s
	iters: 4700, epoch: 1 | loss: 1.4846309
	speed: 0.0304s/iter; left time: 1997.2041s
	iters: 4800, epoch: 1 | loss: 1.5823318
	speed: 0.0305s/iter; left time: 1996.2483s
	iters: 4900, epoch: 1 | loss: 1.5902700
	speed: 0.0305s/iter; left time: 1992.1845s
	iters: 5000, epoch: 1 | loss: 1.5612510
	speed: 0.0304s/iter; left time: 1988.2776s
	iters: 5100, epoch: 1 | loss: 1.3168635
	speed: 0.0305s/iter; left time: 1988.1756s
	iters: 5200, epoch: 1 | loss: 1.5608860
	speed: 0.0305s/iter; left time: 1984.6481s
	iters: 5300, epoch: 1 | loss: 1.5415667
	speed: 0.0305s/iter; left time: 1980.7810s
	iters: 5400, epoch: 1 | loss: 1.6237830
	speed: 0.0305s/iter; left time: 1977.9317s
	iters: 5500, epoch: 1 | loss: 1.5817664
	speed: 0.0305s/iter; left time: 1973.7958s
	iters: 5600, epoch: 1 | loss: 1.4805653
	speed: 0.0304s/iter; left time: 1966.5722s
	iters: 5700, epoch: 1 | loss: 1.5225673
	speed: 0.0304s/iter; left time: 1964.3592s
	iters: 5800, epoch: 1 | loss: 1.6537042
	speed: 0.0304s/iter; left time: 1960.8854s
	iters: 5900, epoch: 1 | loss: 1.7615374
	speed: 0.0304s/iter; left time: 1960.1863s
	iters: 6000, epoch: 1 | loss: 1.2723541
	speed: 0.0304s/iter; left time: 1956.4278s
	iters: 6100, epoch: 1 | loss: 1.5260128
	speed: 0.0305s/iter; left time: 1956.0276s
	iters: 6200, epoch: 1 | loss: 1.3683350
	speed: 0.0305s/iter; left time: 1952.6028s
	iters: 6300, epoch: 1 | loss: 1.4304149
	speed: 0.0305s/iter; left time: 1950.4242s
	iters: 6400, epoch: 1 | loss: 1.4322244
	speed: 0.0308s/iter; left time: 1970.7034s
	iters: 6500, epoch: 1 | loss: 1.7070171
	speed: 0.0304s/iter; left time: 1942.4042s
	iters: 6600, epoch: 1 | loss: 1.7411678
	speed: 0.0304s/iter; left time: 1937.2798s
	iters: 6700, epoch: 1 | loss: 1.4370427
	speed: 0.0304s/iter; left time: 1934.4941s
	iters: 6800, epoch: 1 | loss: 1.6787312
	speed: 0.0304s/iter; left time: 1930.8475s
	iters: 6900, epoch: 1 | loss: 1.5387801
	speed: 0.0304s/iter; left time: 1927.3987s
	iters: 7000, epoch: 1 | loss: 1.4794236
	speed: 0.0304s/iter; left time: 1926.0493s
Epoch: 1 cost time: 214.70395421981812
Epoch: 1, Steps: 7030 | Train Loss: 1.5825147 Vali Loss: 1.8725743 Test Loss: 1.7438648
Validation loss decreased (inf --> 1.872574).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6549681
	speed: 1.2624s/iter; left time: 79749.3946s
	iters: 200, epoch: 2 | loss: 1.8349754
	speed: 0.0304s/iter; left time: 1918.2919s
	iters: 300, epoch: 2 | loss: 1.5563158
	speed: 0.0304s/iter; left time: 1915.4390s
	iters: 400, epoch: 2 | loss: 1.4648902
	speed: 0.0304s/iter; left time: 1910.0978s
	iters: 500, epoch: 2 | loss: 1.7225617
	speed: 0.0304s/iter; left time: 1908.9822s
	iters: 600, epoch: 2 | loss: 1.3039966
	speed: 0.0304s/iter; left time: 1904.2656s
	iters: 700, epoch: 2 | loss: 1.3931986
	speed: 0.0326s/iter; left time: 2037.0233s
	iters: 800, epoch: 2 | loss: 1.1418647
	speed: 0.0320s/iter; left time: 1999.2237s
	iters: 900, epoch: 2 | loss: 1.3637927
	speed: 0.0316s/iter; left time: 1971.7421s
	iters: 1000, epoch: 2 | loss: 1.5047231
	speed: 0.0312s/iter; left time: 1945.3247s
	iters: 1100, epoch: 2 | loss: 1.2306758
	speed: 0.0309s/iter; left time: 1919.2990s
	iters: 1200, epoch: 2 | loss: 1.4614186
	speed: 0.0322s/iter; left time: 1996.6764s
	iters: 1300, epoch: 2 | loss: 1.3823653
	speed: 0.0313s/iter; left time: 1942.0920s
	iters: 1400, epoch: 2 | loss: 1.7100849
	speed: 0.0307s/iter; left time: 1901.1897s
	iters: 1500, epoch: 2 | loss: 1.8553189
	speed: 0.0313s/iter; left time: 1931.6822s
	iters: 1600, epoch: 2 | loss: 1.7211623
	speed: 0.0311s/iter; left time: 1915.8832s
	iters: 1700, epoch: 2 | loss: 1.5115715
	speed: 0.0313s/iter; left time: 1927.0590s
	iters: 1800, epoch: 2 | loss: 1.3078961
	speed: 0.0317s/iter; left time: 1946.1182s
	iters: 1900, epoch: 2 | loss: 1.8414903
	speed: 0.0320s/iter; left time: 1965.9198s
	iters: 2000, epoch: 2 | loss: 1.6299458
	speed: 0.0324s/iter; left time: 1983.5872s
	iters: 2100, epoch: 2 | loss: 1.6361800
	speed: 0.0314s/iter; left time: 1923.0331s
	iters: 2200, epoch: 2 | loss: 1.6809797
	speed: 0.0317s/iter; left time: 1936.9666s
	iters: 2300, epoch: 2 | loss: 1.6411322
	speed: 0.0321s/iter; left time: 1959.7776s
	iters: 2400, epoch: 2 | loss: 1.6362499
	speed: 0.0310s/iter; left time: 1887.7684s
	iters: 2500, epoch: 2 | loss: 1.9379426
	speed: 0.0310s/iter; left time: 1885.5773s
	iters: 2600, epoch: 2 | loss: 1.5951072
	speed: 0.0304s/iter; left time: 1843.2802s
	iters: 2700, epoch: 2 | loss: 1.5418644
	speed: 0.0308s/iter; left time: 1866.5279s
	iters: 2800, epoch: 2 | loss: 1.5550649
	speed: 0.0306s/iter; left time: 1851.2319s
	iters: 2900, epoch: 2 | loss: 1.5462500
	speed: 0.0305s/iter; left time: 1843.6128s
	iters: 3000, epoch: 2 | loss: 1.6474736
	speed: 0.0305s/iter; left time: 1841.0804s
	iters: 3100, epoch: 2 | loss: 1.6679525
	speed: 0.0309s/iter; left time: 1857.6711s
	iters: 3200, epoch: 2 | loss: 1.7219546
	speed: 0.0307s/iter; left time: 1841.6376s
	iters: 3300, epoch: 2 | loss: 1.6976053
	speed: 0.0304s/iter; left time: 1821.8507s
	iters: 3400, epoch: 2 | loss: 1.5230570
	speed: 0.0304s/iter; left time: 1818.7550s
	iters: 3500, epoch: 2 | loss: 1.7356333
	speed: 0.0304s/iter; left time: 1814.3584s
	iters: 3600, epoch: 2 | loss: 1.7344875
	speed: 0.0304s/iter; left time: 1813.3054s
	iters: 3700, epoch: 2 | loss: 1.5309218
	speed: 0.0308s/iter; left time: 1835.1732s
	iters: 3800, epoch: 2 | loss: 1.7966460
	speed: 0.0304s/iter; left time: 1806.2823s
	iters: 3900, epoch: 2 | loss: 1.6047548
	speed: 0.0319s/iter; left time: 1892.0207s
	iters: 4000, epoch: 2 | loss: 1.7659954
	speed: 0.0307s/iter; left time: 1819.3923s
	iters: 4100, epoch: 2 | loss: 1.5156927
	speed: 0.0304s/iter; left time: 1799.8484s
	iters: 4200, epoch: 2 | loss: 1.5618396
	speed: 0.0304s/iter; left time: 1796.3876s
	iters: 4300, epoch: 2 | loss: 1.7823581
	speed: 0.0304s/iter; left time: 1793.3159s
	iters: 4400, epoch: 2 | loss: 1.6234938
	speed: 0.0304s/iter; left time: 1788.0602s
	iters: 4500, epoch: 2 | loss: 1.5362018
	speed: 0.0304s/iter; left time: 1785.7600s
	iters: 4600, epoch: 2 | loss: 1.7505205
	speed: 0.0304s/iter; left time: 1782.9875s
	iters: 4700, epoch: 2 | loss: 1.7178292
	speed: 0.0304s/iter; left time: 1780.7769s
	iters: 4800, epoch: 2 | loss: 1.5947076
	speed: 0.0305s/iter; left time: 1784.5910s
	iters: 4900, epoch: 2 | loss: 1.5857477
	speed: 0.0304s/iter; left time: 1774.8676s
	iters: 5000, epoch: 2 | loss: 1.5610563
	speed: 0.0305s/iter; left time: 1778.2409s
	iters: 5100, epoch: 2 | loss: 1.4400485
	speed: 0.0299s/iter; left time: 1736.6399s
	iters: 5200, epoch: 2 | loss: 1.7250547
	speed: 0.0304s/iter; left time: 1764.0443s
	iters: 5300, epoch: 2 | loss: 1.6144645
	speed: 0.0305s/iter; left time: 1767.0431s
	iters: 5400, epoch: 2 | loss: 1.3353499
	speed: 0.0304s/iter; left time: 1759.3697s
	iters: 5500, epoch: 2 | loss: 1.7442634
	speed: 0.0304s/iter; left time: 1754.4507s
	iters: 5600, epoch: 2 | loss: 1.4533474
	speed: 0.0304s/iter; left time: 1752.5536s
	iters: 5700, epoch: 2 | loss: 1.5572007
	speed: 0.0308s/iter; left time: 1774.2190s
	iters: 5800, epoch: 2 | loss: 1.5973543
	speed: 0.0306s/iter; left time: 1756.2170s
	iters: 5900, epoch: 2 | loss: 1.5752282
	speed: 0.0304s/iter; left time: 1745.7581s
	iters: 6000, epoch: 2 | loss: 1.6758729
	speed: 0.0305s/iter; left time: 1747.1530s
	iters: 6100, epoch: 2 | loss: 1.7442640
	speed: 0.0302s/iter; left time: 1729.3487s
	iters: 6200, epoch: 2 | loss: 1.6313385
	speed: 0.0305s/iter; left time: 1739.0222s
	iters: 6300, epoch: 2 | loss: 1.5316947
	speed: 0.0307s/iter; left time: 1746.4398s
	iters: 6400, epoch: 2 | loss: 1.6940805
	speed: 0.0307s/iter; left time: 1747.9662s
	iters: 6500, epoch: 2 | loss: 1.6289792
	speed: 0.0309s/iter; left time: 1754.7418s
	iters: 6600, epoch: 2 | loss: 1.6386583
	speed: 0.0304s/iter; left time: 1725.1669s
	iters: 6700, epoch: 2 | loss: 1.7443910
	speed: 0.0305s/iter; left time: 1723.5747s
	iters: 6800, epoch: 2 | loss: 1.6074412
	speed: 0.0306s/iter; left time: 1727.6535s
	iters: 6900, epoch: 2 | loss: 1.7002062
	speed: 0.0314s/iter; left time: 1770.8346s
	iters: 7000, epoch: 2 | loss: 1.6020361
	speed: 0.0312s/iter; left time: 1757.4973s
Epoch: 2 cost time: 216.8416051864624
Epoch: 2, Steps: 7030 | Train Loss: 1.6032863 Vali Loss: 1.7947214 Test Loss: 1.7068771
Validation loss decreased (1.872574 --> 1.794721).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.4514662
	speed: 1.2627s/iter; left time: 70891.3873s
	iters: 200, epoch: 3 | loss: 1.6022787
	speed: 0.0304s/iter; left time: 1705.5981s
	iters: 300, epoch: 3 | loss: 1.5267444
	speed: 0.0304s/iter; left time: 1702.7091s
	iters: 400, epoch: 3 | loss: 1.5699667
	speed: 0.0304s/iter; left time: 1699.2781s
	iters: 500, epoch: 3 | loss: 1.4855924
	speed: 0.0304s/iter; left time: 1694.3450s
	iters: 600, epoch: 3 | loss: 1.4510955
	speed: 0.0303s/iter; left time: 1688.5825s
	iters: 700, epoch: 3 | loss: 1.7774754
	speed: 0.0305s/iter; left time: 1691.4681s
	iters: 800, epoch: 3 | loss: 1.6994147
	speed: 0.0304s/iter; left time: 1686.8986s
	iters: 900, epoch: 3 | loss: 1.6187372
	speed: 0.0303s/iter; left time: 1674.1550s
	iters: 1000, epoch: 3 | loss: 1.4265704
	speed: 0.0305s/iter; left time: 1685.4579s
	iters: 1100, epoch: 3 | loss: 1.6678882
	speed: 0.0305s/iter; left time: 1679.8500s
	iters: 1200, epoch: 3 | loss: 1.5491588
	speed: 0.0304s/iter; left time: 1674.4501s
	iters: 1300, epoch: 3 | loss: 1.4427733
	speed: 0.0304s/iter; left time: 1670.8815s
	iters: 1400, epoch: 3 | loss: 1.6507436
	speed: 0.0304s/iter; left time: 1667.4102s
	iters: 1500, epoch: 3 | loss: 1.6148623
	speed: 0.0304s/iter; left time: 1666.1983s
	iters: 1600, epoch: 3 | loss: 1.5195193
	speed: 0.0304s/iter; left time: 1661.4186s
	iters: 1700, epoch: 3 | loss: 1.6947778
	speed: 0.0304s/iter; left time: 1658.3019s
	iters: 1800, epoch: 3 | loss: 1.6384859
	speed: 0.0304s/iter; left time: 1654.7820s
	iters: 1900, epoch: 3 | loss: 1.7052481
	speed: 0.0301s/iter; left time: 1638.1021s
	iters: 2000, epoch: 3 | loss: 1.4970063
	speed: 0.0304s/iter; left time: 1646.8779s
	iters: 2100, epoch: 3 | loss: 1.5659444
	speed: 0.0304s/iter; left time: 1648.5793s
	iters: 2200, epoch: 3 | loss: 1.6141565
	speed: 0.0304s/iter; left time: 1644.0739s
	iters: 2300, epoch: 3 | loss: 1.5810034
	speed: 0.0304s/iter; left time: 1640.7960s
	iters: 2400, epoch: 3 | loss: 1.4656329
	speed: 0.0304s/iter; left time: 1637.1404s
	iters: 2500, epoch: 3 | loss: 1.7333449
	speed: 0.0304s/iter; left time: 1634.5821s
	iters: 2600, epoch: 3 | loss: 1.4462310
	speed: 0.0304s/iter; left time: 1632.0882s
	iters: 2700, epoch: 3 | loss: 1.8281512
	speed: 0.0306s/iter; left time: 1637.7902s
	iters: 2800, epoch: 3 | loss: 1.5083624
	speed: 0.0304s/iter; left time: 1624.4630s
	iters: 2900, epoch: 3 | loss: 1.7959785
	speed: 0.0298s/iter; left time: 1588.7634s
	iters: 3000, epoch: 3 | loss: 1.5656651
	speed: 0.0304s/iter; left time: 1618.4288s
	iters: 3100, epoch: 3 | loss: 1.8374834
	speed: 0.0304s/iter; left time: 1615.0233s
	iters: 3200, epoch: 3 | loss: 1.6631367
	speed: 0.0304s/iter; left time: 1611.2627s
	iters: 3300, epoch: 3 | loss: 1.6897484
	speed: 0.0306s/iter; left time: 1618.7369s
	iters: 3400, epoch: 3 | loss: 1.6337430
	speed: 0.0304s/iter; left time: 1608.0903s
	iters: 3500, epoch: 3 | loss: 1.5923841
	speed: 0.0304s/iter; left time: 1603.4785s
	iters: 3600, epoch: 3 | loss: 1.6331940
	speed: 0.0304s/iter; left time: 1600.2765s
	iters: 3700, epoch: 3 | loss: 1.5291889
	speed: 0.0304s/iter; left time: 1599.0477s
	iters: 3800, epoch: 3 | loss: 1.5809472
	speed: 0.0304s/iter; left time: 1594.3485s
	iters: 3900, epoch: 3 | loss: 1.7730078
	speed: 0.0306s/iter; left time: 1602.0430s
	iters: 4000, epoch: 3 | loss: 1.5703542
	speed: 0.0304s/iter; left time: 1587.9681s
	iters: 4100, epoch: 3 | loss: 1.5609403
	speed: 0.0304s/iter; left time: 1585.4677s
	iters: 4200, epoch: 3 | loss: 1.5076880
	speed: 0.0304s/iter; left time: 1584.1105s
	iters: 4300, epoch: 3 | loss: 1.5450988
	speed: 0.0304s/iter; left time: 1576.8535s
	iters: 4400, epoch: 3 | loss: 1.5816845
	speed: 0.0304s/iter; left time: 1575.7354s
	iters: 4500, epoch: 3 | loss: 1.7959855
	speed: 0.0304s/iter; left time: 1573.4287s
	iters: 4600, epoch: 3 | loss: 1.6915827
	speed: 0.0304s/iter; left time: 1570.4099s
	iters: 4700, epoch: 3 | loss: 1.7688603
	speed: 0.0304s/iter; left time: 1566.8268s
	iters: 4800, epoch: 3 | loss: 1.4686649
	speed: 0.0304s/iter; left time: 1563.2282s
	iters: 4900, epoch: 3 | loss: 1.7611618
	speed: 0.0299s/iter; left time: 1535.4134s
	iters: 5000, epoch: 3 | loss: 1.5154591
	speed: 0.0304s/iter; left time: 1558.3326s
	iters: 5100, epoch: 3 | loss: 1.5792326
	speed: 0.0304s/iter; left time: 1556.0599s
	iters: 5200, epoch: 3 | loss: 1.5135970
	speed: 0.0304s/iter; left time: 1549.7282s
	iters: 5300, epoch: 3 | loss: 1.7564441
	speed: 0.0304s/iter; left time: 1550.0451s
	iters: 5400, epoch: 3 | loss: 1.5948222
	speed: 0.0304s/iter; left time: 1545.2573s
	iters: 5500, epoch: 3 | loss: 1.6934519
	speed: 0.0304s/iter; left time: 1542.7855s
	iters: 5600, epoch: 3 | loss: 1.5242780
	speed: 0.0304s/iter; left time: 1540.6778s
	iters: 5700, epoch: 3 | loss: 1.7855072
	speed: 0.0304s/iter; left time: 1537.2465s
	iters: 5800, epoch: 3 | loss: 1.6250519
	speed: 0.0304s/iter; left time: 1531.4493s
	iters: 5900, epoch: 3 | loss: 1.3837016
	speed: 0.0303s/iter; left time: 1526.4959s
	iters: 6000, epoch: 3 | loss: 1.7356800
	speed: 0.0307s/iter; left time: 1544.1766s
	iters: 6100, epoch: 3 | loss: 1.7675234
	speed: 0.0305s/iter; left time: 1530.0781s
	iters: 6200, epoch: 3 | loss: 1.5414039
	speed: 0.0305s/iter; left time: 1528.0180s
	iters: 6300, epoch: 3 | loss: 1.4521288
	speed: 0.0310s/iter; left time: 1546.4671s
	iters: 6400, epoch: 3 | loss: 1.5052327
	speed: 0.0305s/iter; left time: 1519.2558s
	iters: 6500, epoch: 3 | loss: 1.7325407
	speed: 0.0307s/iter; left time: 1526.8133s
	iters: 6600, epoch: 3 | loss: 1.7344342
	speed: 0.0306s/iter; left time: 1517.8000s
	iters: 6700, epoch: 3 | loss: 1.4981339
	speed: 0.0305s/iter; left time: 1510.9609s
	iters: 6800, epoch: 3 | loss: 1.5410385
	speed: 0.0302s/iter; left time: 1492.6177s
	iters: 6900, epoch: 3 | loss: 1.5768341
	speed: 0.0302s/iter; left time: 1492.1399s
	iters: 7000, epoch: 3 | loss: 1.9014262
	speed: 0.0305s/iter; left time: 1500.6819s
Epoch: 3 cost time: 214.0039005279541
Epoch: 3, Steps: 7030 | Train Loss: 1.6276828 Vali Loss: 1.8007162 Test Loss: 1.7051630
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.7489878
	speed: 1.2716s/iter; left time: 62448.6608s
	iters: 200, epoch: 4 | loss: 1.4685652
	speed: 0.0304s/iter; left time: 1489.4699s
	iters: 300, epoch: 4 | loss: 1.4777018
	speed: 0.0304s/iter; left time: 1487.0971s
	iters: 400, epoch: 4 | loss: 1.5805044
	speed: 0.0304s/iter; left time: 1483.4266s
	iters: 500, epoch: 4 | loss: 1.6030327
	speed: 0.0304s/iter; left time: 1482.8116s
	iters: 600, epoch: 4 | loss: 1.5957437
	speed: 0.0304s/iter; left time: 1478.2533s
	iters: 700, epoch: 4 | loss: 1.7586994
	speed: 0.0306s/iter; left time: 1486.2923s
	iters: 800, epoch: 4 | loss: 1.5474486
	speed: 0.0304s/iter; left time: 1473.1673s
	iters: 900, epoch: 4 | loss: 1.3987807
	speed: 0.0304s/iter; left time: 1470.4365s
	iters: 1000, epoch: 4 | loss: 1.7058629
	speed: 0.0307s/iter; left time: 1481.4772s
	iters: 1100, epoch: 4 | loss: 1.6182712
	speed: 0.0304s/iter; left time: 1462.8506s
	iters: 1200, epoch: 4 | loss: 1.5763500
	speed: 0.0304s/iter; left time: 1460.7049s
	iters: 1300, epoch: 4 | loss: 1.5766026
	speed: 0.0305s/iter; left time: 1459.0943s
	iters: 1400, epoch: 4 | loss: 1.5865837
	speed: 0.0304s/iter; left time: 1455.3665s
	iters: 1500, epoch: 4 | loss: 1.7148284
	speed: 0.0305s/iter; left time: 1453.1605s
	iters: 1600, epoch: 4 | loss: 1.5771564
	speed: 0.0304s/iter; left time: 1449.5398s
	iters: 1700, epoch: 4 | loss: 1.7385080
	speed: 0.0305s/iter; left time: 1450.3249s
	iters: 1800, epoch: 4 | loss: 1.7028022
	speed: 0.0304s/iter; left time: 1441.1890s
	iters: 1900, epoch: 4 | loss: 1.5770984
	speed: 0.0304s/iter; left time: 1439.3370s
	iters: 2000, epoch: 4 | loss: 1.6852559
	speed: 0.0307s/iter; left time: 1447.1138s
	iters: 2100, epoch: 4 | loss: 2.0269990
	speed: 0.0304s/iter; left time: 1433.6675s
	iters: 2200, epoch: 4 | loss: 1.6370230
	speed: 0.0304s/iter; left time: 1430.1006s
	iters: 2300, epoch: 4 | loss: 1.4981914
	speed: 0.0305s/iter; left time: 1431.1436s
	iters: 2400, epoch: 4 | loss: 1.5504258
	speed: 0.0304s/iter; left time: 1423.1626s
	iters: 2500, epoch: 4 | loss: 1.5170503
	speed: 0.0304s/iter; left time: 1420.8529s
	iters: 2600, epoch: 4 | loss: 1.8256357
	speed: 0.0304s/iter; left time: 1418.5191s
	iters: 2700, epoch: 4 | loss: 1.7097081
	speed: 0.0304s/iter; left time: 1415.0496s
	iters: 2800, epoch: 4 | loss: 1.4199624
	speed: 0.0304s/iter; left time: 1411.1329s
	iters: 2900, epoch: 4 | loss: 1.5677664
	speed: 0.0304s/iter; left time: 1408.5846s
	iters: 3000, epoch: 4 | loss: 1.5583396
	speed: 0.0304s/iter; left time: 1405.7817s
	iters: 3100, epoch: 4 | loss: 1.6421900
	speed: 0.0304s/iter; left time: 1402.7270s
	iters: 3200, epoch: 4 | loss: 1.4962033
	speed: 0.0304s/iter; left time: 1399.7656s
	iters: 3300, epoch: 4 | loss: 1.7503510
	speed: 0.0305s/iter; left time: 1398.0257s
	iters: 3400, epoch: 4 | loss: 1.6088048
	speed: 0.0305s/iter; left time: 1395.2598s
	iters: 3500, epoch: 4 | loss: 1.7733380
	speed: 0.0305s/iter; left time: 1392.7472s
	iters: 3600, epoch: 4 | loss: 1.6499836
	speed: 0.0304s/iter; left time: 1388.0608s
	iters: 3700, epoch: 4 | loss: 1.3600615
	speed: 0.0304s/iter; left time: 1384.8141s
	iters: 3800, epoch: 4 | loss: 1.6003556
	speed: 0.0305s/iter; left time: 1384.0876s
	iters: 3900, epoch: 4 | loss: 1.6081029
	speed: 0.0316s/iter; left time: 1431.0802s
	iters: 4000, epoch: 4 | loss: 1.5334333
	speed: 0.0304s/iter; left time: 1376.6304s
	iters: 4100, epoch: 4 | loss: 1.7552257
	speed: 0.0305s/iter; left time: 1377.1511s
	iters: 4200, epoch: 4 | loss: 1.6865617
	speed: 0.0305s/iter; left time: 1370.7160s
	iters: 4300, epoch: 4 | loss: 1.5687106
	speed: 0.0305s/iter; left time: 1367.8745s
	iters: 4400, epoch: 4 | loss: 1.6189322
	speed: 0.0304s/iter; left time: 1364.4416s
	iters: 4500, epoch: 4 | loss: 1.6413839
	speed: 0.0304s/iter; left time: 1359.2072s
	iters: 4600, epoch: 4 | loss: 1.8205365
	speed: 0.0304s/iter; left time: 1357.8339s
	iters: 4700, epoch: 4 | loss: 1.6114048
	speed: 0.0304s/iter; left time: 1353.5218s
	iters: 4800, epoch: 4 | loss: 1.5435921
	speed: 0.0304s/iter; left time: 1351.4062s
	iters: 4900, epoch: 4 | loss: 1.4877545
	speed: 0.0304s/iter; left time: 1348.4233s
	iters: 5000, epoch: 4 | loss: 1.7486986
	speed: 0.0304s/iter; left time: 1344.6249s
	iters: 5100, epoch: 4 | loss: 1.6236761
	speed: 0.0305s/iter; left time: 1344.2238s
	iters: 5200, epoch: 4 | loss: 1.4960643
	speed: 0.0306s/iter; left time: 1346.1116s
	iters: 5300, epoch: 4 | loss: 1.5024364
	speed: 0.0305s/iter; left time: 1338.9216s
	iters: 5400, epoch: 4 | loss: 1.7052108
	speed: 0.0305s/iter; left time: 1336.0663s
	iters: 5500, epoch: 4 | loss: 1.5097783
	speed: 0.0305s/iter; left time: 1331.3372s
	iters: 5600, epoch: 4 | loss: 1.5479840
	speed: 0.0305s/iter; left time: 1330.0822s
	iters: 5700, epoch: 4 | loss: 1.6197941
	speed: 0.0305s/iter; left time: 1327.1344s
	iters: 5800, epoch: 4 | loss: 2.1497746
	speed: 0.0305s/iter; left time: 1323.1461s
	iters: 5900, epoch: 4 | loss: 1.5931292
	speed: 0.0305s/iter; left time: 1319.0489s
	iters: 6000, epoch: 4 | loss: 1.5851240
	speed: 0.0305s/iter; left time: 1317.1695s
	iters: 6100, epoch: 4 | loss: 1.5528754
	speed: 0.0305s/iter; left time: 1312.8796s
	iters: 6200, epoch: 4 | loss: 1.6218016
	speed: 0.0305s/iter; left time: 1311.3128s
	iters: 6300, epoch: 4 | loss: 1.4756706
	speed: 0.0316s/iter; left time: 1354.1907s
	iters: 6400, epoch: 4 | loss: 1.6850350
	speed: 0.0322s/iter; left time: 1378.9455s
	iters: 6500, epoch: 4 | loss: 1.4556701
	speed: 0.0307s/iter; left time: 1310.8100s
	iters: 6600, epoch: 4 | loss: 1.5444701
	speed: 0.0306s/iter; left time: 1304.5563s
	iters: 6700, epoch: 4 | loss: 2.0606904
	speed: 0.0306s/iter; left time: 1299.3260s
	iters: 6800, epoch: 4 | loss: 1.7935535
	speed: 0.0306s/iter; left time: 1296.7723s
	iters: 6900, epoch: 4 | loss: 1.7913274
	speed: 0.0306s/iter; left time: 1293.1932s
	iters: 7000, epoch: 4 | loss: 1.5236250
	speed: 0.0306s/iter; left time: 1291.4393s
Epoch: 4 cost time: 214.8111321926117
Epoch: 4, Steps: 7030 | Train Loss: 1.6276061 Vali Loss: 1.7987773 Test Loss: 1.7056031
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.4406439
	speed: 1.2879s/iter; left time: 54195.1995s
	iters: 200, epoch: 5 | loss: 1.8124887
	speed: 0.0306s/iter; left time: 1284.0273s
	iters: 300, epoch: 5 | loss: 1.6144538
	speed: 0.0305s/iter; left time: 1278.9331s
	iters: 400, epoch: 5 | loss: 1.5240831
	speed: 0.0306s/iter; left time: 1279.9106s
	iters: 500, epoch: 5 | loss: 1.6883886
	speed: 0.0305s/iter; left time: 1270.9081s
	iters: 600, epoch: 5 | loss: 1.5464932
	speed: 0.0305s/iter; left time: 1269.3370s
	iters: 700, epoch: 5 | loss: 1.8617376
	speed: 0.0305s/iter; left time: 1265.0053s
	iters: 800, epoch: 5 | loss: 1.4776589
	speed: 0.0305s/iter; left time: 1262.0161s
	iters: 900, epoch: 5 | loss: 1.5350845
	speed: 0.0305s/iter; left time: 1259.8187s
	iters: 1000, epoch: 5 | loss: 1.5921930
	speed: 0.0305s/iter; left time: 1255.2257s
	iters: 1100, epoch: 5 | loss: 1.6945107
	speed: 0.0305s/iter; left time: 1253.6974s
	iters: 1200, epoch: 5 | loss: 1.4155786
	speed: 0.0305s/iter; left time: 1249.4149s
	iters: 1300, epoch: 5 | loss: 1.7396985
	speed: 0.0306s/iter; left time: 1250.7451s
	iters: 1400, epoch: 5 | loss: 1.7007655
	speed: 0.0308s/iter; left time: 1257.9243s
	iters: 1500, epoch: 5 | loss: 1.5490683
	speed: 0.0306s/iter; left time: 1246.0498s
	iters: 1600, epoch: 5 | loss: 1.5161824
	speed: 0.0308s/iter; left time: 1248.1023s
	iters: 1700, epoch: 5 | loss: 1.6484390
	speed: 0.0309s/iter; left time: 1249.7524s
	iters: 1800, epoch: 5 | loss: 1.7147825
	speed: 0.0304s/iter; left time: 1227.6100s
	iters: 1900, epoch: 5 | loss: 1.8882979
	speed: 0.0304s/iter; left time: 1223.0686s
	iters: 2000, epoch: 5 | loss: 1.5718200
	speed: 0.0304s/iter; left time: 1221.3785s
	iters: 2100, epoch: 5 | loss: 1.5769014
	speed: 0.0305s/iter; left time: 1221.1390s
	iters: 2200, epoch: 5 | loss: 1.6071428
	speed: 0.0304s/iter; left time: 1215.3528s
	iters: 2300, epoch: 5 | loss: 1.8653321
	speed: 0.0304s/iter; left time: 1212.4860s
	iters: 2400, epoch: 5 | loss: 1.6795256
	speed: 0.0305s/iter; left time: 1213.7826s
	iters: 2500, epoch: 5 | loss: 1.4779880
	speed: 0.0304s/iter; left time: 1207.4335s
	iters: 2600, epoch: 5 | loss: 1.6665621
	speed: 0.0304s/iter; left time: 1203.6117s
	iters: 2700, epoch: 5 | loss: 1.8762859
	speed: 0.0304s/iter; left time: 1201.1032s
	iters: 2800, epoch: 5 | loss: 1.9462836
	speed: 0.0304s/iter; left time: 1198.7844s
	iters: 2900, epoch: 5 | loss: 1.5724229
	speed: 0.0304s/iter; left time: 1194.1647s
	iters: 3000, epoch: 5 | loss: 1.5396730
	speed: 0.0304s/iter; left time: 1191.0227s
	iters: 3100, epoch: 5 | loss: 1.6080635
	speed: 0.0304s/iter; left time: 1188.0157s
	iters: 3200, epoch: 5 | loss: 1.6947026
	speed: 0.0304s/iter; left time: 1185.2497s
	iters: 3300, epoch: 5 | loss: 1.6773697
	speed: 0.0305s/iter; left time: 1187.2003s
	iters: 3400, epoch: 5 | loss: 1.6644744
	speed: 0.0304s/iter; left time: 1179.0221s
	iters: 3500, epoch: 5 | loss: 1.7828702
	speed: 0.0304s/iter; left time: 1174.8728s
	iters: 3600, epoch: 5 | loss: 1.6523421
	speed: 0.0305s/iter; left time: 1175.9814s
	iters: 3700, epoch: 5 | loss: 1.3459114
	speed: 0.0307s/iter; left time: 1182.2394s
	iters: 3800, epoch: 5 | loss: 1.7353684
	speed: 0.0306s/iter; left time: 1174.8288s
	iters: 3900, epoch: 5 | loss: 1.6407968
	speed: 0.0315s/iter; left time: 1205.4662s
	iters: 4000, epoch: 5 | loss: 1.4862604
	speed: 0.0304s/iter; left time: 1159.5262s
	iters: 4100, epoch: 5 | loss: 1.5102872
	speed: 0.0304s/iter; left time: 1156.0412s
	iters: 4200, epoch: 5 | loss: 1.8707901
	speed: 0.0304s/iter; left time: 1154.1441s
	iters: 4300, epoch: 5 | loss: 1.5192837
	speed: 0.0311s/iter; left time: 1176.5517s
	iters: 4400, epoch: 5 | loss: 1.5857154
	speed: 0.0304s/iter; left time: 1146.7342s
	iters: 4500, epoch: 5 | loss: 1.7150056
	speed: 0.0306s/iter; left time: 1152.6253s
	iters: 4600, epoch: 5 | loss: 1.4246420
	speed: 0.0306s/iter; left time: 1150.5161s
	iters: 4700, epoch: 5 | loss: 1.7541980
	speed: 0.0304s/iter; left time: 1139.4549s
	iters: 4800, epoch: 5 | loss: 1.5423753
	speed: 0.0305s/iter; left time: 1140.9037s
	iters: 4900, epoch: 5 | loss: 1.9175167
	speed: 0.0307s/iter; left time: 1143.6089s
	iters: 5000, epoch: 5 | loss: 1.5337408
	speed: 0.0304s/iter; left time: 1129.6136s
	iters: 5100, epoch: 5 | loss: 1.8008454
	speed: 0.0304s/iter; left time: 1126.2516s
	iters: 5200, epoch: 5 | loss: 1.7475098
	speed: 0.0309s/iter; left time: 1143.0291s
	iters: 5300, epoch: 5 | loss: 1.5507951
	speed: 0.0306s/iter; left time: 1130.0913s
	iters: 5400, epoch: 5 | loss: 1.7146494
	speed: 0.0305s/iter; left time: 1120.7781s
	iters: 5500, epoch: 5 | loss: 1.6385115
	speed: 0.0305s/iter; left time: 1118.8565s
	iters: 5600, epoch: 5 | loss: 1.4717000
	speed: 0.0304s/iter; left time: 1113.8767s
	iters: 5700, epoch: 5 | loss: 1.6620446
	speed: 0.0304s/iter; left time: 1110.3236s
	iters: 5800, epoch: 5 | loss: 1.7167336
	speed: 0.0304s/iter; left time: 1106.4148s
	iters: 5900, epoch: 5 | loss: 1.6003392
	speed: 0.0304s/iter; left time: 1103.9359s
	iters: 6000, epoch: 5 | loss: 1.7719129
	speed: 0.0307s/iter; left time: 1112.4130s
	iters: 6100, epoch: 5 | loss: 1.4302533
	speed: 0.0304s/iter; left time: 1096.2711s
	iters: 6200, epoch: 5 | loss: 1.6421322
	speed: 0.0304s/iter; left time: 1095.5641s
	iters: 6300, epoch: 5 | loss: 1.6660526
	speed: 0.0311s/iter; left time: 1115.3962s
	iters: 6400, epoch: 5 | loss: 1.4219958
	speed: 0.0308s/iter; left time: 1102.3750s
	iters: 6500, epoch: 5 | loss: 1.7410510
	speed: 0.0310s/iter; left time: 1107.1647s
	iters: 6600, epoch: 5 | loss: 1.7987300
	speed: 0.0309s/iter; left time: 1099.5894s
	iters: 6700, epoch: 5 | loss: 1.5090909
	speed: 0.0304s/iter; left time: 1077.0264s
	iters: 6800, epoch: 5 | loss: 1.6737890
	speed: 0.0304s/iter; left time: 1075.7044s
	iters: 6900, epoch: 5 | loss: 1.7171364
	speed: 0.0305s/iter; left time: 1075.8406s
	iters: 7000, epoch: 5 | loss: 1.4929819
	speed: 0.0304s/iter; left time: 1069.7528s
Epoch: 5 cost time: 214.92181515693665
Epoch: 5, Steps: 7030 | Train Loss: 1.6275927 Vali Loss: 1.7967845 Test Loss: 1.7060648
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_all_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 245821
test shape: (24582, 1, 720, 107) (24582, 1, 720, 107)
test shape: (24582, 720, 107) (24582, 720, 107)
mse:1.706863284111023, mae:1.029990553855896
>>>>>>>Overall time: 1923 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
