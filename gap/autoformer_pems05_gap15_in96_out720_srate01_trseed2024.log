Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 600151
val 94388
test 94387
	iters: 100, epoch: 1 | loss: 1.4320099
	speed: 0.2909s/iter; left time: 109071.4681s
	iters: 200, epoch: 1 | loss: 1.3545779
	speed: 0.2900s/iter; left time: 108685.3298s
	iters: 300, epoch: 1 | loss: 1.3819624
	speed: 0.2903s/iter; left time: 108787.2995s
	iters: 400, epoch: 1 | loss: 1.1112652
	speed: 0.2904s/iter; left time: 108783.3640s
	iters: 500, epoch: 1 | loss: 1.0369803
	speed: 0.2896s/iter; left time: 108457.5666s
	iters: 600, epoch: 1 | loss: 1.3353134
	speed: 0.2893s/iter; left time: 108307.6174s
	iters: 700, epoch: 1 | loss: 1.1551614
	speed: 0.2901s/iter; left time: 108584.5630s
	iters: 800, epoch: 1 | loss: 1.1784345
	speed: 0.2907s/iter; left time: 108764.5908s
	iters: 900, epoch: 1 | loss: 0.9950673
	speed: 0.2842s/iter; left time: 106332.9717s
	iters: 1000, epoch: 1 | loss: 1.0109031
	speed: 0.2846s/iter; left time: 106453.6811s
	iters: 1100, epoch: 1 | loss: 1.1754473
	speed: 0.2851s/iter; left time: 106585.5065s
	iters: 1200, epoch: 1 | loss: 1.1307235
	speed: 0.2846s/iter; left time: 106373.5194s
	iters: 1300, epoch: 1 | loss: 1.1234082
	speed: 0.2854s/iter; left time: 106651.4952s
	iters: 1400, epoch: 1 | loss: 1.0407079
	speed: 0.2847s/iter; left time: 106347.9436s
	iters: 1500, epoch: 1 | loss: 0.9725752
	speed: 0.2851s/iter; left time: 106466.7766s
	iters: 1600, epoch: 1 | loss: 1.0472490
	speed: 0.2847s/iter; left time: 106307.1767s
	iters: 1700, epoch: 1 | loss: 1.0048518
	speed: 0.2845s/iter; left time: 106189.3888s
	iters: 1800, epoch: 1 | loss: 0.9786766
	speed: 0.2843s/iter; left time: 106119.6143s
Epoch: 1 cost time: 538.4882040023804
Epoch: 1, Steps: 1875 | Train Loss: 1.1093170 Vali Loss: 1.1533033 Test Loss: 1.3068389
Validation loss decreased (inf --> 1.153303).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.8181896
	speed: 1.9231s/iter; left time: 717356.6170s
	iters: 200, epoch: 2 | loss: 0.8386714
	speed: 0.2856s/iter; left time: 106499.0231s
	iters: 300, epoch: 2 | loss: 1.0535010
	speed: 0.2860s/iter; left time: 106611.1361s
	iters: 400, epoch: 2 | loss: 1.1313220
	speed: 0.2859s/iter; left time: 106549.6776s
	iters: 500, epoch: 2 | loss: 1.2270368
	speed: 0.2856s/iter; left time: 106405.7684s
	iters: 600, epoch: 2 | loss: 0.9436377
	speed: 0.2860s/iter; left time: 106528.0562s
	iters: 700, epoch: 2 | loss: 0.9347349
	speed: 0.2855s/iter; left time: 106323.6990s
	iters: 800, epoch: 2 | loss: 1.1750753
	speed: 0.2857s/iter; left time: 106386.6820s
	iters: 900, epoch: 2 | loss: 0.9826615
	speed: 0.2857s/iter; left time: 106331.5780s
	iters: 1000, epoch: 2 | loss: 0.9664777
	speed: 0.2857s/iter; left time: 106322.4905s
	iters: 1100, epoch: 2 | loss: 1.0533565
	speed: 0.2861s/iter; left time: 106435.6022s
	iters: 1200, epoch: 2 | loss: 1.0202264
	speed: 0.2856s/iter; left time: 106217.4942s
	iters: 1300, epoch: 2 | loss: 0.8119690
	speed: 0.2856s/iter; left time: 106209.0289s
	iters: 1400, epoch: 2 | loss: 0.8749411
	speed: 0.2858s/iter; left time: 106222.7333s
	iters: 1500, epoch: 2 | loss: 0.8844746
	speed: 0.2857s/iter; left time: 106164.1579s
	iters: 1600, epoch: 2 | loss: 0.7736505
	speed: 0.2859s/iter; left time: 106218.3229s
	iters: 1700, epoch: 2 | loss: 0.8080129
	speed: 0.2858s/iter; left time: 106169.1530s
	iters: 1800, epoch: 2 | loss: 0.8178325
	speed: 0.2856s/iter; left time: 106064.0842s
Epoch: 2 cost time: 535.8383049964905
Epoch: 2, Steps: 1875 | Train Loss: 0.9496024 Vali Loss: 1.0605007 Test Loss: 1.1464740
Validation loss decreased (1.153303 --> 1.060501).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7449258
	speed: 1.9394s/iter; left time: 719820.6754s
	iters: 200, epoch: 3 | loss: 0.7908880
	speed: 0.2944s/iter; left time: 109242.5509s
	iters: 300, epoch: 3 | loss: 0.7646710
	speed: 0.2942s/iter; left time: 109148.3773s
	iters: 400, epoch: 3 | loss: 0.8188291
	speed: 0.2952s/iter; left time: 109460.5643s
	iters: 500, epoch: 3 | loss: 0.7635399
	speed: 0.2941s/iter; left time: 109027.4876s
	iters: 600, epoch: 3 | loss: 0.7810085
	speed: 0.2958s/iter; left time: 109634.6622s
	iters: 700, epoch: 3 | loss: 0.7916746
	speed: 0.2940s/iter; left time: 108952.3547s
	iters: 800, epoch: 3 | loss: 0.7664720
	speed: 0.2961s/iter; left time: 109706.8848s
	iters: 900, epoch: 3 | loss: 0.8166656
	speed: 0.2945s/iter; left time: 109082.5866s
	iters: 1000, epoch: 3 | loss: 0.7431825
	speed: 0.2943s/iter; left time: 108978.9767s
	iters: 1100, epoch: 3 | loss: 0.7668411
	speed: 0.2946s/iter; left time: 109042.4005s
	iters: 1200, epoch: 3 | loss: 0.7733935
	speed: 0.2943s/iter; left time: 108909.9674s
	iters: 1300, epoch: 3 | loss: 0.8124470
	speed: 0.2942s/iter; left time: 108844.8458s
	iters: 1400, epoch: 3 | loss: 0.7636322
	speed: 0.2941s/iter; left time: 108775.7084s
	iters: 1500, epoch: 3 | loss: 0.7759208
	speed: 0.2947s/iter; left time: 108971.3270s
	iters: 1600, epoch: 3 | loss: 0.7601077
	speed: 0.2947s/iter; left time: 108928.5722s
	iters: 1700, epoch: 3 | loss: 0.7500211
	speed: 0.2947s/iter; left time: 108890.8292s
	iters: 1800, epoch: 3 | loss: 0.7795908
	speed: 0.2944s/iter; left time: 108775.0526s
Epoch: 3 cost time: 552.5257985591888
Epoch: 3, Steps: 1875 | Train Loss: 0.7863585 Vali Loss: 0.9622214 Test Loss: 1.0451223
Validation loss decreased (1.060501 --> 0.962221).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8912990
	speed: 1.9434s/iter; left time: 717642.5295s
	iters: 200, epoch: 4 | loss: 0.7372974
	speed: 0.2897s/iter; left time: 106960.0890s
	iters: 300, epoch: 4 | loss: 0.7406130
	speed: 0.2908s/iter; left time: 107310.3800s
	iters: 400, epoch: 4 | loss: 0.7763323
	speed: 0.2899s/iter; left time: 106982.9000s
	iters: 500, epoch: 4 | loss: 0.8083421
	speed: 0.2909s/iter; left time: 107314.0603s
	iters: 600, epoch: 4 | loss: 0.7638648
	speed: 0.2924s/iter; left time: 107813.0163s
	iters: 700, epoch: 4 | loss: 0.7620099
	speed: 0.2901s/iter; left time: 106952.3476s
	iters: 800, epoch: 4 | loss: 0.7309321
	speed: 0.2909s/iter; left time: 107221.7529s
	iters: 900, epoch: 4 | loss: 0.7388184
	speed: 0.2899s/iter; left time: 106829.2484s
	iters: 1000, epoch: 4 | loss: 0.7422757
	speed: 0.2897s/iter; left time: 106702.0412s
	iters: 1100, epoch: 4 | loss: 0.7392469
	speed: 0.2904s/iter; left time: 106949.2538s
	iters: 1200, epoch: 4 | loss: 0.7445340
	speed: 0.2901s/iter; left time: 106795.6746s
	iters: 1300, epoch: 4 | loss: 0.8050423
	speed: 0.2896s/iter; left time: 106588.4106s
	iters: 1400, epoch: 4 | loss: 0.7828060
	speed: 0.2916s/iter; left time: 107293.1094s
	iters: 1500, epoch: 4 | loss: 0.7409186
	speed: 0.2908s/iter; left time: 106995.1428s
	iters: 1600, epoch: 4 | loss: 0.7947263
	speed: 0.2905s/iter; left time: 106828.9072s
	iters: 1700, epoch: 4 | loss: 0.7346205
	speed: 0.2932s/iter; left time: 107803.6601s
	iters: 1800, epoch: 4 | loss: 0.7695340
	speed: 0.2905s/iter; left time: 106794.5938s
Epoch: 4 cost time: 545.1834344863892
Epoch: 4, Steps: 1875 | Train Loss: 0.7705195 Vali Loss: 0.9536627 Test Loss: 1.0267004
Validation loss decreased (0.962221 --> 0.953663).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.7618937
	speed: 1.9381s/iter; left time: 712061.2093s
	iters: 200, epoch: 5 | loss: 0.7815720
	speed: 0.2860s/iter; left time: 105031.1222s
	iters: 300, epoch: 5 | loss: 0.7595363
	speed: 0.2861s/iter; left time: 105070.0671s
	iters: 400, epoch: 5 | loss: 0.7743890
	speed: 0.2877s/iter; left time: 105612.2173s
	iters: 500, epoch: 5 | loss: 0.7475975
	speed: 0.2859s/iter; left time: 104934.1641s
	iters: 600, epoch: 5 | loss: 0.7239931
	speed: 0.2860s/iter; left time: 104947.6731s
	iters: 700, epoch: 5 | loss: 0.7589028
	speed: 0.2865s/iter; left time: 105100.7337s
	iters: 800, epoch: 5 | loss: 0.7896618
	speed: 0.2859s/iter; left time: 104855.9776s
	iters: 900, epoch: 5 | loss: 0.7823782
	speed: 0.2856s/iter; left time: 104684.8002s
	iters: 1000, epoch: 5 | loss: 0.7616446
	speed: 0.2859s/iter; left time: 104770.3726s
	iters: 1100, epoch: 5 | loss: 0.7626169
	speed: 0.2878s/iter; left time: 105439.0007s
	iters: 1200, epoch: 5 | loss: 0.7670041
	speed: 0.2857s/iter; left time: 104656.0792s
	iters: 1300, epoch: 5 | loss: 0.7547496
	speed: 0.2862s/iter; left time: 104823.8864s
	iters: 1400, epoch: 5 | loss: 0.7829843
	speed: 0.2879s/iter; left time: 105397.1112s
	iters: 1500, epoch: 5 | loss: 0.7274959
	speed: 0.2859s/iter; left time: 104642.1498s
	iters: 1600, epoch: 5 | loss: 0.7675913
	speed: 0.2873s/iter; left time: 105115.3926s
	iters: 1700, epoch: 5 | loss: 0.7098551
	speed: 0.2862s/iter; left time: 104686.9196s
	iters: 1800, epoch: 5 | loss: 0.7465434
	speed: 0.2857s/iter; left time: 104477.9252s
Epoch: 5 cost time: 537.2012393474579
Epoch: 5, Steps: 1875 | Train Loss: 0.7641592 Vali Loss: 0.9113210 Test Loss: 1.0244596
Validation loss decreased (0.953663 --> 0.911321).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.7974290
	speed: 1.9380s/iter; left time: 708376.9248s
	iters: 200, epoch: 6 | loss: 0.7097077
	speed: 0.2914s/iter; left time: 106489.1123s
	iters: 300, epoch: 6 | loss: 0.7961172
	speed: 0.2899s/iter; left time: 105895.5677s
	iters: 400, epoch: 6 | loss: 0.7432513
	speed: 0.2924s/iter; left time: 106777.4631s
	iters: 500, epoch: 6 | loss: 0.7305834
	speed: 0.2902s/iter; left time: 105948.2396s
	iters: 600, epoch: 6 | loss: 0.7879816
	speed: 0.2909s/iter; left time: 106171.8643s
	iters: 700, epoch: 6 | loss: 0.7239281
	speed: 0.2922s/iter; left time: 106636.6489s
	iters: 800, epoch: 6 | loss: 0.7375925
	speed: 0.2902s/iter; left time: 105885.9133s
	iters: 900, epoch: 6 | loss: 0.7523460
	speed: 0.2905s/iter; left time: 105970.0300s
	iters: 1000, epoch: 6 | loss: 0.7589303
	speed: 0.2899s/iter; left time: 105704.0160s
	iters: 1100, epoch: 6 | loss: 0.7251557
	speed: 0.2900s/iter; left time: 105717.2948s
	iters: 1200, epoch: 6 | loss: 0.7335702
	speed: 0.2904s/iter; left time: 105829.0070s
	iters: 1300, epoch: 6 | loss: 0.7226929
	speed: 0.2895s/iter; left time: 105476.3285s
	iters: 1400, epoch: 6 | loss: 0.7106726
	speed: 0.2899s/iter; left time: 105597.6918s
	iters: 1500, epoch: 6 | loss: 0.7408680
	speed: 0.2898s/iter; left time: 105505.9518s
	iters: 1600, epoch: 6 | loss: 0.7320963
	speed: 0.2901s/iter; left time: 105615.4232s
	iters: 1700, epoch: 6 | loss: 0.7552979
	speed: 0.2900s/iter; left time: 105524.5332s
	iters: 1800, epoch: 6 | loss: 0.7438711
	speed: 0.2898s/iter; left time: 105427.1672s
Epoch: 6 cost time: 544.626373052597
Epoch: 6, Steps: 1875 | Train Loss: 0.7465953 Vali Loss: 0.9248998 Test Loss: 1.0650574
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.7846107
	speed: 1.9393s/iter; left time: 705212.2425s
	iters: 200, epoch: 7 | loss: 0.7366366
	speed: 0.2901s/iter; left time: 105451.6665s
	iters: 300, epoch: 7 | loss: 0.7894571
	speed: 0.2903s/iter; left time: 105507.4977s
	iters: 400, epoch: 7 | loss: 0.7668247
	speed: 0.2901s/iter; left time: 105415.8334s
	iters: 500, epoch: 7 | loss: 0.7497236
	speed: 0.2904s/iter; left time: 105492.1477s
	iters: 600, epoch: 7 | loss: 0.6907400
	speed: 0.2899s/iter; left time: 105277.5632s
	iters: 700, epoch: 7 | loss: 0.7388691
	speed: 0.2894s/iter; left time: 105073.4290s
	iters: 800, epoch: 7 | loss: 0.7531898
	speed: 0.2897s/iter; left time: 105157.3625s
	iters: 900, epoch: 7 | loss: 0.7234555
	speed: 0.2899s/iter; left time: 105195.9828s
	iters: 1000, epoch: 7 | loss: 0.7167709
	speed: 0.2897s/iter; left time: 105072.7373s
	iters: 1100, epoch: 7 | loss: 0.7470073
	speed: 0.2904s/iter; left time: 105306.1378s
	iters: 1200, epoch: 7 | loss: 0.7833893
	speed: 0.2900s/iter; left time: 105153.9608s
	iters: 1300, epoch: 7 | loss: 0.7171796
	speed: 0.2893s/iter; left time: 104873.7933s
	iters: 1400, epoch: 7 | loss: 0.7571140
	speed: 0.2899s/iter; left time: 105057.2834s
	iters: 1500, epoch: 7 | loss: 0.7470644
	speed: 0.2900s/iter; left time: 105043.5919s
	iters: 1600, epoch: 7 | loss: 0.7323513
	speed: 0.2926s/iter; left time: 105968.8976s
	iters: 1700, epoch: 7 | loss: 0.7113930
	speed: 0.2911s/iter; left time: 105398.6781s
	iters: 1800, epoch: 7 | loss: 0.7703953
	speed: 0.2902s/iter; left time: 105040.2374s
Epoch: 7 cost time: 544.3400168418884
Epoch: 7, Steps: 1875 | Train Loss: 0.7391112 Vali Loss: 0.8997473 Test Loss: 1.0602496
Validation loss decreased (0.911321 --> 0.899747).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.7219219
	speed: 1.9459s/iter; left time: 703968.1228s
	iters: 200, epoch: 8 | loss: 0.6855794
	speed: 0.2955s/iter; left time: 106857.3970s
	iters: 300, epoch: 8 | loss: 0.7628570
	speed: 0.2947s/iter; left time: 106548.9646s
	iters: 400, epoch: 8 | loss: 0.7092748
	speed: 0.2941s/iter; left time: 106327.5499s
	iters: 500, epoch: 8 | loss: 0.7233125
	speed: 0.2946s/iter; left time: 106445.7698s
	iters: 600, epoch: 8 | loss: 0.7159947
	speed: 0.2945s/iter; left time: 106404.2535s
	iters: 700, epoch: 8 | loss: 0.7170686
	speed: 0.2943s/iter; left time: 106298.6962s
	iters: 800, epoch: 8 | loss: 0.7087888
	speed: 0.2958s/iter; left time: 106810.2724s
	iters: 900, epoch: 8 | loss: 0.7483001
	speed: 0.2949s/iter; left time: 106462.5365s
	iters: 1000, epoch: 8 | loss: 0.7110334
	speed: 0.2942s/iter; left time: 106185.4922s
	iters: 1100, epoch: 8 | loss: 0.7107151
	speed: 0.2948s/iter; left time: 106367.7981s
	iters: 1200, epoch: 8 | loss: 0.7440740
	speed: 0.2943s/iter; left time: 106139.2809s
	iters: 1300, epoch: 8 | loss: 0.7406320
	speed: 0.2955s/iter; left time: 106537.1501s
	iters: 1400, epoch: 8 | loss: 0.7500293
	speed: 0.2940s/iter; left time: 105986.2303s
	iters: 1500, epoch: 8 | loss: 0.6957269
	speed: 0.2951s/iter; left time: 106354.2831s
	iters: 1600, epoch: 8 | loss: 0.6562636
	speed: 0.2942s/iter; left time: 106004.0216s
	iters: 1700, epoch: 8 | loss: 0.6858858
	speed: 0.2938s/iter; left time: 105804.7760s
	iters: 1800, epoch: 8 | loss: 0.6961901
	speed: 0.2942s/iter; left time: 105925.5076s
Epoch: 8 cost time: 552.4867527484894
Epoch: 8, Steps: 1875 | Train Loss: 0.7299108 Vali Loss: 0.9095234 Test Loss: 1.0554709
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 9 | loss: 0.7419548
	speed: 1.9416s/iter; left time: 698786.5174s
	iters: 200, epoch: 9 | loss: 0.7239878
	speed: 0.2863s/iter; left time: 102995.2846s
	iters: 300, epoch: 9 | loss: 0.6861383
	speed: 0.2878s/iter; left time: 103530.3255s
	iters: 400, epoch: 9 | loss: 0.7309085
	speed: 0.2862s/iter; left time: 102906.6147s
	iters: 500, epoch: 9 | loss: 0.6986616
	speed: 0.2873s/iter; left time: 103301.2432s
	iters: 600, epoch: 9 | loss: 0.7389878
	speed: 0.2857s/iter; left time: 102675.0970s
	iters: 700, epoch: 9 | loss: 0.7519309
	speed: 0.2863s/iter; left time: 102868.3127s
	iters: 800, epoch: 9 | loss: 0.7290365
	speed: 0.2881s/iter; left time: 103484.2998s
	iters: 900, epoch: 9 | loss: 0.7090231
	speed: 0.2857s/iter; left time: 102605.3113s
	iters: 1000, epoch: 9 | loss: 0.7083368
	speed: 0.2873s/iter; left time: 103151.3877s
	iters: 1100, epoch: 9 | loss: 0.7790574
	speed: 0.2865s/iter; left time: 102818.1399s
	iters: 1200, epoch: 9 | loss: 0.6873601
	speed: 0.2882s/iter; left time: 103404.9484s
	iters: 1300, epoch: 9 | loss: 0.7555826
	speed: 0.2864s/iter; left time: 102742.4516s
	iters: 1400, epoch: 9 | loss: 0.7595065
	speed: 0.2859s/iter; left time: 102523.3989s
	iters: 1500, epoch: 9 | loss: 0.7829005
	speed: 0.2858s/iter; left time: 102458.9564s
	iters: 1600, epoch: 9 | loss: 0.7623597
	speed: 0.2856s/iter; left time: 102351.9067s
	iters: 1700, epoch: 9 | loss: 0.7186524
	speed: 0.2880s/iter; left time: 103185.2078s
	iters: 1800, epoch: 9 | loss: 0.6794864
	speed: 0.2858s/iter; left time: 102357.7499s
Epoch: 9 cost time: 537.5201754570007
Epoch: 9, Steps: 1875 | Train Loss: 0.7261189 Vali Loss: 0.9094188 Test Loss: 1.0704956
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 10 | loss: 0.7113946
	speed: 1.9289s/iter; left time: 690581.8798s
	iters: 200, epoch: 10 | loss: 0.7483531
	speed: 0.2865s/iter; left time: 102546.8319s
	iters: 300, epoch: 10 | loss: 0.7148149
	speed: 0.2868s/iter; left time: 102625.8748s
	iters: 400, epoch: 10 | loss: 0.7138722
	speed: 0.2856s/iter; left time: 102173.3634s
	iters: 500, epoch: 10 | loss: 0.6950641
	speed: 0.2859s/iter; left time: 102260.6020s
	iters: 600, epoch: 10 | loss: 0.7248544
	speed: 0.2857s/iter; left time: 102141.7385s
	iters: 700, epoch: 10 | loss: 0.7151188
	speed: 0.2861s/iter; left time: 102271.7481s
	iters: 800, epoch: 10 | loss: 0.7326063
	speed: 0.2860s/iter; left time: 102192.0937s
	iters: 900, epoch: 10 | loss: 0.7026872
	speed: 0.2859s/iter; left time: 102113.3657s
	iters: 1000, epoch: 10 | loss: 0.6924566
	speed: 0.2866s/iter; left time: 102367.0123s
	iters: 1100, epoch: 10 | loss: 0.7167851
	speed: 0.2863s/iter; left time: 102211.1083s
	iters: 1200, epoch: 10 | loss: 0.7157609
	speed: 0.2862s/iter; left time: 102147.1787s
	iters: 1300, epoch: 10 | loss: 0.7104614
	speed: 0.2857s/iter; left time: 101961.2372s
	iters: 1400, epoch: 10 | loss: 0.7106602
	speed: 0.2854s/iter; left time: 101809.8877s
	iters: 1500, epoch: 10 | loss: 0.7239594
	speed: 0.2855s/iter; left time: 101800.1019s
	iters: 1600, epoch: 10 | loss: 0.6965730
	speed: 0.2857s/iter; left time: 101847.8955s
	iters: 1700, epoch: 10 | loss: 0.7786396
	speed: 0.2862s/iter; left time: 101994.0719s
	iters: 1800, epoch: 10 | loss: 0.7273026
	speed: 0.2862s/iter; left time: 101990.3258s
Epoch: 10 cost time: 536.4692425727844
Epoch: 10, Steps: 1875 | Train Loss: 0.7208036 Vali Loss: 0.8904481 Test Loss: 1.0413105
Validation loss decreased (0.899747 --> 0.890448).  Saving model ...
	iters: 100, epoch: 11 | loss: 0.6977866
	speed: 1.9321s/iter; left time: 688125.6690s
	iters: 200, epoch: 11 | loss: 0.6873363
	speed: 0.2862s/iter; left time: 101893.7670s
	iters: 300, epoch: 11 | loss: 0.6893124
	speed: 0.2868s/iter; left time: 102082.5479s
	iters: 400, epoch: 11 | loss: 0.7290254
	speed: 0.2863s/iter; left time: 101881.2413s
	iters: 500, epoch: 11 | loss: 0.6952318
	speed: 0.2865s/iter; left time: 101928.9163s
	iters: 600, epoch: 11 | loss: 0.7448569
	speed: 0.2864s/iter; left time: 101844.9891s
	iters: 700, epoch: 11 | loss: 0.7278515
	speed: 0.2860s/iter; left time: 101692.6015s
	iters: 800, epoch: 11 | loss: 0.6985221
	speed: 0.2855s/iter; left time: 101488.2341s
	iters: 900, epoch: 11 | loss: 0.7074908
	speed: 0.2859s/iter; left time: 101600.7346s
	iters: 1000, epoch: 11 | loss: 0.7223663
	speed: 0.2857s/iter; left time: 101492.2231s
	iters: 1100, epoch: 11 | loss: 0.6830574
	speed: 0.2868s/iter; left time: 101874.9092s
	iters: 1200, epoch: 11 | loss: 0.6715197
	speed: 0.2861s/iter; left time: 101570.3957s
	iters: 1300, epoch: 11 | loss: 0.7099537
	speed: 0.2866s/iter; left time: 101730.7637s
	iters: 1400, epoch: 11 | loss: 0.7042567
	speed: 0.2871s/iter; left time: 101891.8983s
	iters: 1500, epoch: 11 | loss: 0.7255045
	speed: 0.2866s/iter; left time: 101666.7821s
	iters: 1600, epoch: 11 | loss: 0.7298854
	speed: 0.2863s/iter; left time: 101549.7267s
	iters: 1700, epoch: 11 | loss: 0.6883343
	speed: 0.2863s/iter; left time: 101494.0775s
	iters: 1800, epoch: 11 | loss: 0.7315226
	speed: 0.2865s/iter; left time: 101544.3495s
Epoch: 11 cost time: 537.0519323348999
Epoch: 11, Steps: 1875 | Train Loss: 0.7144897 Vali Loss: 0.8838995 Test Loss: 1.0627998
Validation loss decreased (0.890448 --> 0.883900).  Saving model ...
	iters: 100, epoch: 12 | loss: 0.7315686
	speed: 1.9338s/iter; left time: 685081.5841s
	iters: 200, epoch: 12 | loss: 0.7225061
	speed: 0.2906s/iter; left time: 102922.5008s
	iters: 300, epoch: 12 | loss: 0.6961037
	speed: 0.2898s/iter; left time: 102603.7817s
	iters: 400, epoch: 12 | loss: 0.6940604
	speed: 0.2897s/iter; left time: 102548.0254s
	iters: 500, epoch: 12 | loss: 0.7276523
	speed: 0.2902s/iter; left time: 102684.3962s
	iters: 600, epoch: 12 | loss: 0.7037441
	speed: 0.2897s/iter; left time: 102506.4017s
	iters: 700, epoch: 12 | loss: 0.7102159
	speed: 0.2906s/iter; left time: 102794.5332s
	iters: 800, epoch: 12 | loss: 0.7323859
	speed: 0.2904s/iter; left time: 102679.9059s
	iters: 900, epoch: 12 | loss: 0.7197702
	speed: 0.2897s/iter; left time: 102398.3094s
	iters: 1000, epoch: 12 | loss: 0.7120421
	speed: 0.2904s/iter; left time: 102619.0296s
	iters: 1100, epoch: 12 | loss: 0.6822374
	speed: 0.2910s/iter; left time: 102811.0309s
	iters: 1200, epoch: 12 | loss: 0.7309731
	speed: 0.2912s/iter; left time: 102829.4668s
	iters: 1300, epoch: 12 | loss: 0.7267415
	speed: 0.2896s/iter; left time: 102262.2186s
	iters: 1400, epoch: 12 | loss: 0.6847677
	speed: 0.2904s/iter; left time: 102501.7073s
	iters: 1500, epoch: 12 | loss: 0.6817116
	speed: 0.2900s/iter; left time: 102331.3663s
	iters: 1600, epoch: 12 | loss: 0.6983824
	speed: 0.2899s/iter; left time: 102255.8324s
	iters: 1700, epoch: 12 | loss: 0.6916376
	speed: 0.2896s/iter; left time: 102142.8897s
	iters: 1800, epoch: 12 | loss: 0.6737359
	speed: 0.2895s/iter; left time: 102071.3028s
Epoch: 12 cost time: 544.2159011363983
Epoch: 12, Steps: 1875 | Train Loss: 0.7092514 Vali Loss: 0.8809603 Test Loss: 1.0620182
Validation loss decreased (0.883900 --> 0.880960).  Saving model ...
	iters: 100, epoch: 13 | loss: 0.7073361
	speed: 1.9355s/iter; left time: 682074.5643s
	iters: 200, epoch: 13 | loss: 0.7198355
	speed: 0.2892s/iter; left time: 101902.6172s
	iters: 300, epoch: 13 | loss: 0.6936647
	speed: 0.2898s/iter; left time: 102080.0291s
	iters: 400, epoch: 13 | loss: 0.6738267
	speed: 0.2905s/iter; left time: 102298.1037s
	iters: 500, epoch: 13 | loss: 0.6921442
	speed: 0.2903s/iter; left time: 102177.3753s
	iters: 600, epoch: 13 | loss: 0.6827580
	speed: 0.2895s/iter; left time: 101870.4584s
	iters: 700, epoch: 13 | loss: 0.6905238
	speed: 0.2895s/iter; left time: 101843.7945s
	iters: 800, epoch: 13 | loss: 0.6958678
	speed: 0.2907s/iter; left time: 102253.1165s
	iters: 900, epoch: 13 | loss: 0.6964571
	speed: 0.2904s/iter; left time: 102099.2190s
	iters: 1000, epoch: 13 | loss: 0.7069267
	speed: 0.2893s/iter; left time: 101702.6248s
	iters: 1100, epoch: 13 | loss: 0.6913935
	speed: 0.2893s/iter; left time: 101669.9803s
	iters: 1200, epoch: 13 | loss: 0.7111221
	speed: 0.2911s/iter; left time: 102265.2593s
	iters: 1300, epoch: 13 | loss: 0.6885133
	speed: 0.2896s/iter; left time: 101707.2521s
	iters: 1400, epoch: 13 | loss: 0.6992042
	speed: 0.2900s/iter; left time: 101816.4598s
	iters: 1500, epoch: 13 | loss: 0.7045247
	speed: 0.2900s/iter; left time: 101774.8108s
	iters: 1600, epoch: 13 | loss: 0.7072775
	speed: 0.2907s/iter; left time: 102007.2685s
	iters: 1700, epoch: 13 | loss: 0.6799986
	speed: 0.2900s/iter; left time: 101749.2408s
	iters: 1800, epoch: 13 | loss: 0.7005016
	speed: 0.2896s/iter; left time: 101573.7650s
Epoch: 13 cost time: 543.7355561256409
Epoch: 13, Steps: 1875 | Train Loss: 0.7026504 Vali Loss: 0.8886110 Test Loss: 1.0551939
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 14 | loss: 0.7089938
	speed: 1.9307s/iter; left time: 676767.1844s
	iters: 200, epoch: 14 | loss: 0.6821045
	speed: 0.2865s/iter; left time: 100388.6101s
	iters: 300, epoch: 14 | loss: 0.7142040
	speed: 0.2899s/iter; left time: 101570.9962s
	iters: 400, epoch: 14 | loss: 0.7272347
	speed: 0.2892s/iter; left time: 101297.4169s
	iters: 500, epoch: 14 | loss: 0.6616961
	speed: 0.2909s/iter; left time: 101842.3864s
	iters: 600, epoch: 14 | loss: 0.6806793
	speed: 0.2900s/iter; left time: 101509.2616s
	iters: 700, epoch: 14 | loss: 0.6971014
	speed: 0.2892s/iter; left time: 101200.7936s
	iters: 800, epoch: 14 | loss: 0.6700737
	speed: 0.2900s/iter; left time: 101456.5135s
	iters: 900, epoch: 14 | loss: 0.6824729
	speed: 0.2902s/iter; left time: 101491.8701s
	iters: 1000, epoch: 14 | loss: 0.6902109
	speed: 0.2899s/iter; left time: 101344.3939s
	iters: 1100, epoch: 14 | loss: 0.6798401
	speed: 0.2893s/iter; left time: 101109.1320s
	iters: 1200, epoch: 14 | loss: 0.6632858
	speed: 0.2898s/iter; left time: 101263.4166s
	iters: 1300, epoch: 14 | loss: 0.7181486
	speed: 0.2901s/iter; left time: 101332.1243s
	iters: 1400, epoch: 14 | loss: 0.7152264
	speed: 0.2904s/iter; left time: 101410.5518s
	iters: 1500, epoch: 14 | loss: 0.6926866
	speed: 0.2891s/iter; left time: 100930.7204s
	iters: 1600, epoch: 14 | loss: 0.6641897
	speed: 0.2892s/iter; left time: 100932.2074s
	iters: 1700, epoch: 14 | loss: 0.6817753
	speed: 0.2897s/iter; left time: 101100.3839s
	iters: 1800, epoch: 14 | loss: 0.6840917
	speed: 0.2899s/iter; left time: 101112.7480s
Epoch: 14 cost time: 542.8050005435944
Epoch: 14, Steps: 1875 | Train Loss: 0.6964877 Vali Loss: 0.8955385 Test Loss: 1.0650414
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 15 | loss: 0.6848046
	speed: 1.9346s/iter; left time: 674487.9023s
	iters: 200, epoch: 15 | loss: 0.6967483
	speed: 0.2902s/iter; left time: 101157.6731s
	iters: 300, epoch: 15 | loss: 0.7029919
	speed: 0.2905s/iter; left time: 101236.9070s
	iters: 400, epoch: 15 | loss: 0.6738151
	speed: 0.2898s/iter; left time: 100936.1504s
	iters: 500, epoch: 15 | loss: 0.6893901
	speed: 0.2895s/iter; left time: 100833.8092s
	iters: 600, epoch: 15 | loss: 0.6827036
	speed: 0.2905s/iter; left time: 101151.9107s
	iters: 700, epoch: 15 | loss: 0.7236398
	speed: 0.2900s/iter; left time: 100935.2049s
	iters: 800, epoch: 15 | loss: 0.7035846
	speed: 0.2897s/iter; left time: 100802.5770s
	iters: 900, epoch: 15 | loss: 0.6887993
	speed: 0.2901s/iter; left time: 100913.1989s
	iters: 1000, epoch: 15 | loss: 0.6726910
	speed: 0.2901s/iter; left time: 100878.2645s
	iters: 1100, epoch: 15 | loss: 0.6887215
	speed: 0.2911s/iter; left time: 101186.3309s
	iters: 1200, epoch: 15 | loss: 0.6509694
	speed: 0.2897s/iter; left time: 100699.7308s
	iters: 1300, epoch: 15 | loss: 0.6438316
	speed: 0.2897s/iter; left time: 100656.4645s
	iters: 1400, epoch: 15 | loss: 0.6918331
	speed: 0.2909s/iter; left time: 101037.3854s
	iters: 1500, epoch: 15 | loss: 0.6766513
	speed: 0.2902s/iter; left time: 100758.2609s
	iters: 1600, epoch: 15 | loss: 0.6785391
	speed: 0.2896s/iter; left time: 100522.6578s
	iters: 1700, epoch: 15 | loss: 0.7048299
	speed: 0.2900s/iter; left time: 100649.4749s
	iters: 1800, epoch: 15 | loss: 0.6960132
	speed: 0.2897s/iter; left time: 100524.4701s
Epoch: 15 cost time: 543.9385969638824
Epoch: 15, Steps: 1875 | Train Loss: 0.6913782 Vali Loss: 0.8900236 Test Loss: 1.0670702
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 16 | loss: 0.6923974
	speed: 1.9260s/iter; left time: 667884.4443s
	iters: 200, epoch: 16 | loss: 0.7183430
	speed: 0.2865s/iter; left time: 99310.2027s
	iters: 300, epoch: 16 | loss: 0.6596782
	speed: 0.2899s/iter; left time: 100471.1248s
	iters: 400, epoch: 16 | loss: 0.7105069
	speed: 0.2906s/iter; left time: 100684.5723s
	iters: 500, epoch: 16 | loss: 0.6650022
	speed: 0.2905s/iter; left time: 100636.9358s
	iters: 600, epoch: 16 | loss: 0.6793646
	speed: 0.2901s/iter; left time: 100468.1964s
	iters: 700, epoch: 16 | loss: 0.7486426
	speed: 0.2900s/iter; left time: 100374.0931s
	iters: 800, epoch: 16 | loss: 0.6514061
	speed: 0.2902s/iter; left time: 100433.8047s
	iters: 900, epoch: 16 | loss: 0.7009683
	speed: 0.2916s/iter; left time: 100878.3161s
	iters: 1000, epoch: 16 | loss: 0.6831252
	speed: 0.2899s/iter; left time: 100269.4953s
	iters: 1100, epoch: 16 | loss: 0.6701242
	speed: 0.2901s/iter; left time: 100315.6208s
	iters: 1200, epoch: 16 | loss: 0.6879407
	speed: 0.2904s/iter; left time: 100395.3976s
	iters: 1300, epoch: 16 | loss: 0.6651788
	speed: 0.2870s/iter; left time: 99175.5730s
	iters: 1400, epoch: 16 | loss: 0.7153531
	speed: 0.2905s/iter; left time: 100344.5909s
	iters: 1500, epoch: 16 | loss: 0.6730639
	speed: 0.2922s/iter; left time: 100921.8053s
	iters: 1600, epoch: 16 | loss: 0.6985674
	speed: 0.2909s/iter; left time: 100434.5556s
	iters: 1700, epoch: 16 | loss: 0.7101072
	speed: 0.2906s/iter; left time: 100292.1322s
	iters: 1800, epoch: 16 | loss: 0.7064825
	speed: 0.2904s/iter; left time: 100225.7284s
Epoch: 16 cost time: 544.0175533294678
Epoch: 16, Steps: 1875 | Train Loss: 0.6876190 Vali Loss: 0.8938978 Test Loss: 1.1089057
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 17 | loss: 0.6795276
	speed: 1.9258s/iter; left time: 664200.3973s
	iters: 200, epoch: 17 | loss: 0.6721638
	speed: 0.2851s/iter; left time: 98319.1555s
	iters: 300, epoch: 17 | loss: 0.6744613
	speed: 0.2860s/iter; left time: 98596.6989s
	iters: 400, epoch: 17 | loss: 0.6929397
	speed: 0.2850s/iter; left time: 98200.3365s
	iters: 500, epoch: 17 | loss: 0.6924651
	speed: 0.2872s/iter; left time: 98941.8799s
	iters: 600, epoch: 17 | loss: 0.7137191
	speed: 0.2855s/iter; left time: 98318.5213s
	iters: 700, epoch: 17 | loss: 0.6948346
	speed: 0.2929s/iter; left time: 100838.9232s
	iters: 800, epoch: 17 | loss: 0.6942340
	speed: 0.2925s/iter; left time: 100695.7420s
	iters: 900, epoch: 17 | loss: 0.6807612
	speed: 0.2884s/iter; left time: 99225.5615s
	iters: 1000, epoch: 17 | loss: 0.6807433
	speed: 0.2863s/iter; left time: 98482.1761s
	iters: 1100, epoch: 17 | loss: 0.6998012
	speed: 0.2897s/iter; left time: 99627.1597s
	iters: 1200, epoch: 17 | loss: 0.6534228
	speed: 0.2930s/iter; left time: 100744.7865s
	iters: 1300, epoch: 17 | loss: 0.6587474
	speed: 0.2904s/iter; left time: 99815.5395s
	iters: 1400, epoch: 17 | loss: 0.6812085
	speed: 0.2923s/iter; left time: 100432.5219s
	iters: 1500, epoch: 17 | loss: 0.6662881
	speed: 0.2930s/iter; left time: 100641.0674s
	iters: 1600, epoch: 17 | loss: 0.6735010
	speed: 0.2945s/iter; left time: 101135.4517s
	iters: 1700, epoch: 17 | loss: 0.6977261
	speed: 0.2949s/iter; left time: 101248.0444s
	iters: 1800, epoch: 17 | loss: 0.7367857
	speed: 0.2948s/iter; left time: 101159.8282s
Epoch: 17 cost time: 544.2560420036316
Epoch: 17, Steps: 1875 | Train Loss: 0.6848525 Vali Loss: 0.8947565 Test Loss: 1.0939636
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 94387
test shape: (9438, 1, 720, 103) (9438, 1, 720, 103)
test shape: (9438, 720, 103) (9438, 720, 103)
mse:1.0620315074920654, mae:0.798882246017456
>>>>>>>Overall time: 11836 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
