Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=730, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1164134
val 247438
test 247437
	iters: 100, epoch: 1 | loss: 1.3821490
	speed: 0.3034s/iter; left time: 220681.7791s
	iters: 200, epoch: 1 | loss: 1.4466518
	speed: 0.3008s/iter; left time: 218764.5301s
	iters: 300, epoch: 1 | loss: 1.3751737
	speed: 0.3013s/iter; left time: 219068.5616s
	iters: 400, epoch: 1 | loss: 1.3114282
	speed: 0.3016s/iter; left time: 219267.2063s
	iters: 500, epoch: 1 | loss: 1.1736867
	speed: 0.3013s/iter; left time: 218986.4270s
	iters: 600, epoch: 1 | loss: 1.2671911
	speed: 0.3026s/iter; left time: 219913.8811s
	iters: 700, epoch: 1 | loss: 1.2523007
	speed: 0.3026s/iter; left time: 219900.8314s
	iters: 800, epoch: 1 | loss: 1.2356926
	speed: 0.3022s/iter; left time: 219550.3062s
	iters: 900, epoch: 1 | loss: 1.1968254
	speed: 0.3020s/iter; left time: 219423.7638s
	iters: 1000, epoch: 1 | loss: 1.1950123
	speed: 0.3023s/iter; left time: 219594.9832s
	iters: 1100, epoch: 1 | loss: 1.2371883
	speed: 0.3018s/iter; left time: 219210.5066s
	iters: 1200, epoch: 1 | loss: 1.3229567
	speed: 0.3017s/iter; left time: 219079.2510s
	iters: 1300, epoch: 1 | loss: 1.1925718
	speed: 0.2995s/iter; left time: 217463.0154s
	iters: 1400, epoch: 1 | loss: 1.2326791
	speed: 0.3019s/iter; left time: 219180.4033s
	iters: 1500, epoch: 1 | loss: 1.1266036
	speed: 0.3015s/iter; left time: 218863.2141s
	iters: 1600, epoch: 1 | loss: 1.2815802
	speed: 0.3014s/iter; left time: 218785.5628s
	iters: 1700, epoch: 1 | loss: 1.1429073
	speed: 0.2993s/iter; left time: 217219.1481s
	iters: 1800, epoch: 1 | loss: 1.0437728
	speed: 0.2970s/iter; left time: 215539.0845s
	iters: 1900, epoch: 1 | loss: 1.1418415
	speed: 0.2972s/iter; left time: 215642.8957s
	iters: 2000, epoch: 1 | loss: 1.0496941
	speed: 0.2966s/iter; left time: 215173.4666s
	iters: 2100, epoch: 1 | loss: 1.0493174
	speed: 0.2976s/iter; left time: 215885.1448s
	iters: 2200, epoch: 1 | loss: 1.0913049
	speed: 0.2983s/iter; left time: 216292.5230s
	iters: 2300, epoch: 1 | loss: 1.0633578
	speed: 0.2962s/iter; left time: 214777.8768s
	iters: 2400, epoch: 1 | loss: 0.9909704
	speed: 0.2949s/iter; left time: 213838.0018s
	iters: 2500, epoch: 1 | loss: 1.0501755
	speed: 0.2935s/iter; left time: 212792.5404s
	iters: 2600, epoch: 1 | loss: 1.1194023
	speed: 0.2945s/iter; left time: 213423.7056s
	iters: 2700, epoch: 1 | loss: 1.0443085
	speed: 0.2943s/iter; left time: 213299.1657s
	iters: 2800, epoch: 1 | loss: 0.9917018
	speed: 0.2945s/iter; left time: 213365.6708s
	iters: 2900, epoch: 1 | loss: 1.0099388
	speed: 0.2938s/iter; left time: 212884.8213s
	iters: 3000, epoch: 1 | loss: 1.0786800
	speed: 0.2938s/iter; left time: 212815.9732s
	iters: 3100, epoch: 1 | loss: 1.0259484
	speed: 0.2968s/iter; left time: 214969.7691s
	iters: 3200, epoch: 1 | loss: 1.0569888
	speed: 0.2948s/iter; left time: 213528.4177s
	iters: 3300, epoch: 1 | loss: 1.0855558
	speed: 0.2943s/iter; left time: 213068.6611s
	iters: 3400, epoch: 1 | loss: 1.0587866
	speed: 0.2963s/iter; left time: 214492.5323s
	iters: 3500, epoch: 1 | loss: 0.9938094
	speed: 0.2944s/iter; left time: 213125.9767s
	iters: 3600, epoch: 1 | loss: 1.0855117
	speed: 0.2944s/iter; left time: 213067.1160s
Epoch: 1 cost time: 1085.336056470871
Epoch: 1, Steps: 3637 | Train Loss: 1.1750554 Vali Loss: 1.4464808 Test Loss: 1.2721400
Validation loss decreased (inf --> 1.446481).  Saving model ...
	iters: 100, epoch: 2 | loss: 1.0257702
	speed: 4.3498s/iter; left time: 3147812.9309s
	iters: 200, epoch: 2 | loss: 1.0573972
	speed: 0.2994s/iter; left time: 216643.3822s
	iters: 300, epoch: 2 | loss: 1.1027218
	speed: 0.2983s/iter; left time: 215828.2153s
	iters: 400, epoch: 2 | loss: 1.0198002
	speed: 0.2981s/iter; left time: 215630.8637s
	iters: 500, epoch: 2 | loss: 1.0693743
	speed: 0.2984s/iter; left time: 215824.6981s
	iters: 600, epoch: 2 | loss: 1.0607769
	speed: 0.2989s/iter; left time: 216177.2034s
	iters: 700, epoch: 2 | loss: 0.9807360
	speed: 0.2983s/iter; left time: 215719.7576s
	iters: 800, epoch: 2 | loss: 0.9489703
	speed: 0.2986s/iter; left time: 215876.4205s
	iters: 900, epoch: 2 | loss: 0.9956882
	speed: 0.2987s/iter; left time: 215933.2652s
	iters: 1000, epoch: 2 | loss: 0.9713972
	speed: 0.2995s/iter; left time: 216443.7814s
	iters: 1100, epoch: 2 | loss: 1.0231580
	speed: 0.2985s/iter; left time: 215749.8763s
	iters: 1200, epoch: 2 | loss: 0.9952759
	speed: 0.2979s/iter; left time: 215254.7216s
	iters: 1300, epoch: 2 | loss: 1.0026423
	speed: 0.2976s/iter; left time: 215036.0741s
	iters: 1400, epoch: 2 | loss: 1.1404029
	speed: 0.2979s/iter; left time: 215201.1290s
	iters: 1500, epoch: 2 | loss: 1.0279750
	speed: 0.2982s/iter; left time: 215350.1652s
	iters: 1600, epoch: 2 | loss: 1.0022132
	speed: 0.2977s/iter; left time: 214954.6636s
	iters: 1700, epoch: 2 | loss: 0.9984682
	speed: 0.2975s/iter; left time: 214818.0305s
	iters: 1800, epoch: 2 | loss: 0.9300907
	speed: 0.2980s/iter; left time: 215123.7830s
	iters: 1900, epoch: 2 | loss: 0.9701613
	speed: 0.2981s/iter; left time: 215168.4820s
	iters: 2000, epoch: 2 | loss: 0.9553851
	speed: 0.2981s/iter; left time: 215187.3927s
	iters: 2100, epoch: 2 | loss: 1.0532960
	speed: 0.2986s/iter; left time: 215497.0286s
	iters: 2200, epoch: 2 | loss: 0.9427003
	speed: 0.2990s/iter; left time: 215762.6880s
	iters: 2300, epoch: 2 | loss: 1.0559447
	speed: 0.2981s/iter; left time: 215069.0802s
	iters: 2400, epoch: 2 | loss: 1.0671798
	speed: 0.2982s/iter; left time: 215094.2732s
	iters: 2500, epoch: 2 | loss: 1.1231711
	speed: 0.2983s/iter; left time: 215171.2770s
	iters: 2600, epoch: 2 | loss: 0.9116590
	speed: 0.2985s/iter; left time: 215238.9166s
	iters: 2700, epoch: 2 | loss: 1.0158421
	speed: 0.2988s/iter; left time: 215444.1678s
	iters: 2800, epoch: 2 | loss: 1.4844009
	speed: 0.2985s/iter; left time: 215184.1836s
	iters: 2900, epoch: 2 | loss: 1.0454159
	speed: 0.2982s/iter; left time: 214937.5777s
	iters: 3000, epoch: 2 | loss: 1.0007489
	speed: 0.2977s/iter; left time: 214587.8709s
	iters: 3100, epoch: 2 | loss: 0.9546652
	speed: 0.2976s/iter; left time: 214496.9360s
	iters: 3200, epoch: 2 | loss: 1.0582546
	speed: 0.2982s/iter; left time: 214879.5303s
	iters: 3300, epoch: 2 | loss: 1.0063715
	speed: 0.2985s/iter; left time: 215029.1337s
	iters: 3400, epoch: 2 | loss: 1.0207593
	speed: 0.2983s/iter; left time: 214886.7790s
	iters: 3500, epoch: 2 | loss: 1.0443023
	speed: 0.2987s/iter; left time: 215135.5749s
	iters: 3600, epoch: 2 | loss: 1.0714376
	speed: 0.2978s/iter; left time: 214490.8156s
Epoch: 2 cost time: 1085.5426433086395
Epoch: 2, Steps: 3637 | Train Loss: 1.0204870 Vali Loss: 1.2925926 Test Loss: 1.1850121
Validation loss decreased (1.446481 --> 1.292593).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0588224
	speed: 4.3614s/iter; left time: 3140328.1156s
	iters: 200, epoch: 3 | loss: 1.0513313
	speed: 0.2970s/iter; left time: 213808.0035s
	iters: 300, epoch: 3 | loss: 1.1965816
	speed: 0.3021s/iter; left time: 217447.8059s
	iters: 400, epoch: 3 | loss: 0.9925607
	speed: 0.3034s/iter; left time: 218369.5829s
	iters: 500, epoch: 3 | loss: 1.0163295
	speed: 0.3000s/iter; left time: 215866.9811s
	iters: 600, epoch: 3 | loss: 1.0228280
	speed: 0.3011s/iter; left time: 216683.6880s
	iters: 700, epoch: 3 | loss: 1.0108320
	speed: 0.3030s/iter; left time: 218004.9602s
	iters: 800, epoch: 3 | loss: 1.0195192
	speed: 0.2953s/iter; left time: 212446.5141s
	iters: 900, epoch: 3 | loss: 0.9523001
	speed: 0.3015s/iter; left time: 216861.8408s
	iters: 1000, epoch: 3 | loss: 1.0964409
	speed: 0.3032s/iter; left time: 218020.7375s
	iters: 1100, epoch: 3 | loss: 1.0809212
	speed: 0.3036s/iter; left time: 218269.9786s
	iters: 1200, epoch: 3 | loss: 0.9993417
	speed: 0.3038s/iter; left time: 218401.2732s
	iters: 1300, epoch: 3 | loss: 1.0053875
	speed: 0.2970s/iter; left time: 213490.3357s
	iters: 1400, epoch: 3 | loss: 0.9676143
	speed: 0.3013s/iter; left time: 216564.4855s
	iters: 1500, epoch: 3 | loss: 0.9134799
	speed: 0.3032s/iter; left time: 217878.3322s
	iters: 1600, epoch: 3 | loss: 0.9657581
	speed: 0.3034s/iter; left time: 218031.8825s
	iters: 1700, epoch: 3 | loss: 0.9528383
	speed: 0.3029s/iter; left time: 217594.0017s
	iters: 1800, epoch: 3 | loss: 1.0843482
	speed: 0.3032s/iter; left time: 217809.1967s
	iters: 1900, epoch: 3 | loss: 1.0780346
	speed: 0.3022s/iter; left time: 217057.5064s
	iters: 2000, epoch: 3 | loss: 1.0283833
	speed: 0.3030s/iter; left time: 217618.4916s
	iters: 2100, epoch: 3 | loss: 1.0089607
	speed: 0.3021s/iter; left time: 216951.6400s
	iters: 2200, epoch: 3 | loss: 1.0753382
	speed: 0.3007s/iter; left time: 215877.9816s
	iters: 2300, epoch: 3 | loss: 1.0472054
	speed: 0.3021s/iter; left time: 216859.4904s
	iters: 2400, epoch: 3 | loss: 1.0179085
	speed: 0.3025s/iter; left time: 217134.7349s
	iters: 2500, epoch: 3 | loss: 1.0166494
	speed: 0.3034s/iter; left time: 217745.9842s
	iters: 2600, epoch: 3 | loss: 1.0017498
	speed: 0.2990s/iter; left time: 214548.6534s
	iters: 2700, epoch: 3 | loss: 1.0546288
	speed: 0.3031s/iter; left time: 217467.5655s
	iters: 2800, epoch: 3 | loss: 0.9473492
	speed: 0.3024s/iter; left time: 216891.4505s
	iters: 2900, epoch: 3 | loss: 1.0260752
	speed: 0.3023s/iter; left time: 216844.7266s
	iters: 3000, epoch: 3 | loss: 0.9645552
	speed: 0.3015s/iter; left time: 216194.8453s
	iters: 3100, epoch: 3 | loss: 1.0565026
	speed: 0.2936s/iter; left time: 210522.9404s
	iters: 3200, epoch: 3 | loss: 1.0768044
	speed: 0.2956s/iter; left time: 211956.7570s
	iters: 3300, epoch: 3 | loss: 1.0181545
	speed: 0.2976s/iter; left time: 213326.8281s
	iters: 3400, epoch: 3 | loss: 0.9730991
	speed: 0.2974s/iter; left time: 213175.0165s
	iters: 3500, epoch: 3 | loss: 1.0068401
	speed: 0.2971s/iter; left time: 212922.8090s
	iters: 3600, epoch: 3 | loss: 1.0818613
	speed: 0.2978s/iter; left time: 213348.1119s
Epoch: 3 cost time: 1094.382072687149
Epoch: 3, Steps: 3637 | Train Loss: 1.0092873 Vali Loss: 1.4905591 Test Loss: 1.4263308
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.9234555
	speed: 4.3378s/iter; left time: 3107523.7327s
	iters: 200, epoch: 4 | loss: 0.9941122
	speed: 0.2955s/iter; left time: 211679.4591s
	iters: 300, epoch: 4 | loss: 0.9639047
	speed: 0.2980s/iter; left time: 213426.1803s
	iters: 400, epoch: 4 | loss: 1.0811446
	speed: 0.2975s/iter; left time: 213015.5295s
	iters: 500, epoch: 4 | loss: 0.9731061
	speed: 0.2974s/iter; left time: 212945.1597s
	iters: 600, epoch: 4 | loss: 1.0311059
	speed: 0.2976s/iter; left time: 213029.5906s
	iters: 700, epoch: 4 | loss: 0.9788603
	speed: 0.2981s/iter; left time: 213374.0513s
	iters: 800, epoch: 4 | loss: 0.9407932
	speed: 0.2973s/iter; left time: 212772.3575s
	iters: 900, epoch: 4 | loss: 0.9411069
	speed: 0.2974s/iter; left time: 212809.9300s
	iters: 1000, epoch: 4 | loss: 1.0294018
	speed: 0.2972s/iter; left time: 212651.2585s
	iters: 1100, epoch: 4 | loss: 1.0606273
	speed: 0.2972s/iter; left time: 212644.8056s
	iters: 1200, epoch: 4 | loss: 1.1137346
	speed: 0.2973s/iter; left time: 212640.3329s
	iters: 1300, epoch: 4 | loss: 1.1198320
	speed: 0.2973s/iter; left time: 212633.7541s
	iters: 1400, epoch: 4 | loss: 1.0355830
	speed: 0.2973s/iter; left time: 212599.4811s
	iters: 1500, epoch: 4 | loss: 1.0945501
	speed: 0.2975s/iter; left time: 212731.4692s
	iters: 1600, epoch: 4 | loss: 0.9807594
	speed: 0.2975s/iter; left time: 212649.0458s
	iters: 1700, epoch: 4 | loss: 0.9953008
	speed: 0.2979s/iter; left time: 212920.6013s
	iters: 1800, epoch: 4 | loss: 1.0304185
	speed: 0.2943s/iter; left time: 210363.5825s
	iters: 1900, epoch: 4 | loss: 0.9875242
	speed: 0.2962s/iter; left time: 211646.2340s
	iters: 2000, epoch: 4 | loss: 0.9170546
	speed: 0.2944s/iter; left time: 210317.4475s
	iters: 2100, epoch: 4 | loss: 0.9828696
	speed: 0.2946s/iter; left time: 210492.1038s
	iters: 2200, epoch: 4 | loss: 0.9535218
	speed: 0.2939s/iter; left time: 209906.9860s
	iters: 2300, epoch: 4 | loss: 0.9676225
	speed: 0.2955s/iter; left time: 211023.0640s
	iters: 2400, epoch: 4 | loss: 1.0166034
	speed: 0.2943s/iter; left time: 210148.5715s
	iters: 2500, epoch: 4 | loss: 0.9113018
	speed: 0.2949s/iter; left time: 210534.2397s
	iters: 2600, epoch: 4 | loss: 0.9734042
	speed: 0.2954s/iter; left time: 210891.3964s
	iters: 2700, epoch: 4 | loss: 1.0334904
	speed: 0.2950s/iter; left time: 210551.0609s
	iters: 2800, epoch: 4 | loss: 1.0504942
	speed: 0.2961s/iter; left time: 211304.2546s
	iters: 2900, epoch: 4 | loss: 0.9585873
	speed: 0.3015s/iter; left time: 215136.9446s
	iters: 3000, epoch: 4 | loss: 1.2599332
	speed: 0.3012s/iter; left time: 214894.1459s
	iters: 3100, epoch: 4 | loss: 0.9251854
	speed: 0.3010s/iter; left time: 214719.3406s
	iters: 3200, epoch: 4 | loss: 1.0481839
	speed: 0.3014s/iter; left time: 215010.9680s
	iters: 3300, epoch: 4 | loss: 0.9848148
	speed: 0.3017s/iter; left time: 215141.6326s
	iters: 3400, epoch: 4 | loss: 0.9716399
	speed: 0.3019s/iter; left time: 215310.2705s
	iters: 3500, epoch: 4 | loss: 1.0027630
	speed: 0.3011s/iter; left time: 214697.5546s
	iters: 3600, epoch: 4 | loss: 1.0922908
	speed: 0.3016s/iter; left time: 214997.2873s
Epoch: 4 cost time: 1082.7181358337402
Epoch: 4, Steps: 3637 | Train Loss: 0.9982835 Vali Loss: 1.4636575 Test Loss: 1.3301418
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 1.0011156
	speed: 4.3206s/iter; left time: 3079554.6253s
	iters: 200, epoch: 5 | loss: 1.0437295
	speed: 0.2980s/iter; left time: 212353.6231s
	iters: 300, epoch: 5 | loss: 1.1512966
	speed: 0.2984s/iter; left time: 212658.5703s
	iters: 400, epoch: 5 | loss: 0.8575779
	speed: 0.2983s/iter; left time: 212517.5187s
	iters: 500, epoch: 5 | loss: 0.9648828
	speed: 0.2978s/iter; left time: 212145.4199s
	iters: 600, epoch: 5 | loss: 0.9750894
	speed: 0.2979s/iter; left time: 212199.2997s
	iters: 700, epoch: 5 | loss: 0.9750221
	speed: 0.2979s/iter; left time: 212157.8543s
	iters: 800, epoch: 5 | loss: 1.0391781
	speed: 0.2979s/iter; left time: 212100.0976s
	iters: 900, epoch: 5 | loss: 0.9577360
	speed: 0.2982s/iter; left time: 212318.7461s
	iters: 1000, epoch: 5 | loss: 1.1222475
	speed: 0.2984s/iter; left time: 212450.1163s
	iters: 1100, epoch: 5 | loss: 0.9928262
	speed: 0.2973s/iter; left time: 211632.6979s
	iters: 1200, epoch: 5 | loss: 0.9751670
	speed: 0.2977s/iter; left time: 211865.1518s
	iters: 1300, epoch: 5 | loss: 0.8046943
	speed: 0.2990s/iter; left time: 212729.6436s
	iters: 1400, epoch: 5 | loss: 1.0111141
	speed: 0.2975s/iter; left time: 211648.5879s
	iters: 1500, epoch: 5 | loss: 0.9398332
	speed: 0.2980s/iter; left time: 211953.7274s
	iters: 1600, epoch: 5 | loss: 0.8759235
	speed: 0.2974s/iter; left time: 211530.4815s
	iters: 1700, epoch: 5 | loss: 0.8827666
	speed: 0.2976s/iter; left time: 211664.9182s
	iters: 1800, epoch: 5 | loss: 0.9856898
	speed: 0.2976s/iter; left time: 211602.9849s
	iters: 1900, epoch: 5 | loss: 0.9534773
	speed: 0.2973s/iter; left time: 211345.0627s
	iters: 2000, epoch: 5 | loss: 1.0133406
	speed: 0.2973s/iter; left time: 211315.7408s
	iters: 2100, epoch: 5 | loss: 0.9364756
	speed: 0.2977s/iter; left time: 211565.4309s
	iters: 2200, epoch: 5 | loss: 0.9888546
	speed: 0.2980s/iter; left time: 211791.8606s
	iters: 2300, epoch: 5 | loss: 0.8866987
	speed: 0.2974s/iter; left time: 211338.2137s
	iters: 2400, epoch: 5 | loss: 0.9917517
	speed: 0.2975s/iter; left time: 211352.8854s
	iters: 2500, epoch: 5 | loss: 0.9058140
	speed: 0.2976s/iter; left time: 211382.1943s
	iters: 2600, epoch: 5 | loss: 0.8141584
	speed: 0.2975s/iter; left time: 211276.0353s
	iters: 2700, epoch: 5 | loss: 1.1732985
	speed: 0.2975s/iter; left time: 211282.4761s
	iters: 2800, epoch: 5 | loss: 1.0012139
	speed: 0.2979s/iter; left time: 211511.8005s
	iters: 2900, epoch: 5 | loss: 0.9502542
	speed: 0.2976s/iter; left time: 211288.1639s
	iters: 3000, epoch: 5 | loss: 1.0108268
	speed: 0.2978s/iter; left time: 211367.3848s
	iters: 3100, epoch: 5 | loss: 1.0336243
	speed: 0.2977s/iter; left time: 211326.8920s
	iters: 3200, epoch: 5 | loss: 0.9324167
	speed: 0.2970s/iter; left time: 210758.1009s
	iters: 3300, epoch: 5 | loss: 0.8785412
	speed: 0.2976s/iter; left time: 211167.1326s
	iters: 3400, epoch: 5 | loss: 0.8990948
	speed: 0.2976s/iter; left time: 211161.7258s
	iters: 3500, epoch: 5 | loss: 0.8804813
	speed: 0.2978s/iter; left time: 211251.8581s
	iters: 3600, epoch: 5 | loss: 0.8875029
	speed: 0.2970s/iter; left time: 210647.0456s
Epoch: 5 cost time: 1083.181953907013
Epoch: 5, Steps: 3637 | Train Loss: 0.9583240 Vali Loss: 1.5321605 Test Loss: 1.3404503
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.8362181
	speed: 4.3544s/iter; left time: 3087785.0475s
	iters: 200, epoch: 6 | loss: 0.8170286
	speed: 0.3036s/iter; left time: 215269.4837s
	iters: 300, epoch: 6 | loss: 1.1300980
	speed: 0.3037s/iter; left time: 215304.0353s
	iters: 400, epoch: 6 | loss: 0.8346538
	speed: 0.3028s/iter; left time: 214653.0070s
	iters: 500, epoch: 6 | loss: 0.8208869
	speed: 0.3029s/iter; left time: 214662.5265s
	iters: 600, epoch: 6 | loss: 0.8433710
	speed: 0.3034s/iter; left time: 215020.1573s
	iters: 700, epoch: 6 | loss: 0.8208503
	speed: 0.3026s/iter; left time: 214378.4005s
	iters: 800, epoch: 6 | loss: 0.9330189
	speed: 0.3027s/iter; left time: 214421.9894s
	iters: 900, epoch: 6 | loss: 0.8742369
	speed: 0.3022s/iter; left time: 214082.8125s
	iters: 1000, epoch: 6 | loss: 0.8472119
	speed: 0.3022s/iter; left time: 214013.9651s
	iters: 1100, epoch: 6 | loss: 0.8649934
	speed: 0.3033s/iter; left time: 214758.2752s
	iters: 1200, epoch: 6 | loss: 0.9007592
	speed: 0.3025s/iter; left time: 214154.4265s
	iters: 1300, epoch: 6 | loss: 0.8851548
	speed: 0.3016s/iter; left time: 213512.5549s
	iters: 1400, epoch: 6 | loss: 0.8315702
	speed: 0.3001s/iter; left time: 212440.1204s
	iters: 1500, epoch: 6 | loss: 0.9302231
	speed: 0.3023s/iter; left time: 213931.5827s
	iters: 1600, epoch: 6 | loss: 0.7892717
	speed: 0.3032s/iter; left time: 214583.3241s
	iters: 1700, epoch: 6 | loss: 0.7895964
	speed: 0.3017s/iter; left time: 213483.1099s
	iters: 1800, epoch: 6 | loss: 0.7770216
	speed: 0.3021s/iter; left time: 213682.3576s
	iters: 1900, epoch: 6 | loss: 0.8550639
	speed: 0.3021s/iter; left time: 213652.1482s
	iters: 2000, epoch: 6 | loss: 0.7940494
	speed: 0.3019s/iter; left time: 213489.2737s
	iters: 2100, epoch: 6 | loss: 0.7358766
	speed: 0.3022s/iter; left time: 213671.9662s
	iters: 2200, epoch: 6 | loss: 0.9274660
	speed: 0.3029s/iter; left time: 214149.2042s
	iters: 2300, epoch: 6 | loss: 0.7931787
	speed: 0.3024s/iter; left time: 213792.3819s
	iters: 2400, epoch: 6 | loss: 0.8080841
	speed: 0.3019s/iter; left time: 213416.8303s
	iters: 2500, epoch: 6 | loss: 0.8070402
	speed: 0.3021s/iter; left time: 213480.9609s
	iters: 2600, epoch: 6 | loss: 0.9131102
	speed: 0.3029s/iter; left time: 214040.3274s
	iters: 2700, epoch: 6 | loss: 0.8080094
	speed: 0.3027s/iter; left time: 213845.4861s
	iters: 2800, epoch: 6 | loss: 0.9637716
	speed: 0.3018s/iter; left time: 213217.6160s
	iters: 2900, epoch: 6 | loss: 0.7948112
	speed: 0.3028s/iter; left time: 213841.0917s
	iters: 3000, epoch: 6 | loss: 0.8784040
	speed: 0.3021s/iter; left time: 213364.3496s
	iters: 3100, epoch: 6 | loss: 0.9552643
	speed: 0.3023s/iter; left time: 213445.1025s
	iters: 3200, epoch: 6 | loss: 0.7759489
	speed: 0.3017s/iter; left time: 212989.2572s
	iters: 3300, epoch: 6 | loss: 0.8049052
	speed: 0.3018s/iter; left time: 213030.6049s
	iters: 3400, epoch: 6 | loss: 0.8266620
	speed: 0.3023s/iter; left time: 213388.7239s
	iters: 3500, epoch: 6 | loss: 0.7868163
	speed: 0.3019s/iter; left time: 213082.7298s
	iters: 3600, epoch: 6 | loss: 0.7571647
	speed: 0.3022s/iter; left time: 213258.4620s
Epoch: 6 cost time: 1100.101878643036
Epoch: 6, Steps: 3637 | Train Loss: 0.8584348 Vali Loss: 1.5167574 Test Loss: 1.3819771
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.9403824
	speed: 4.3207s/iter; left time: 3048179.8254s
	iters: 200, epoch: 7 | loss: 0.8080123
	speed: 0.3024s/iter; left time: 213335.0784s
	iters: 300, epoch: 7 | loss: 0.7409748
	speed: 0.3026s/iter; left time: 213386.0432s
	iters: 400, epoch: 7 | loss: 0.8445932
	speed: 0.3027s/iter; left time: 213459.8402s
	iters: 500, epoch: 7 | loss: 0.8209618
	speed: 0.3022s/iter; left time: 213101.2159s
	iters: 600, epoch: 7 | loss: 0.7474070
	speed: 0.3019s/iter; left time: 212801.4001s
	iters: 700, epoch: 7 | loss: 0.7950565
	speed: 0.3020s/iter; left time: 212906.4965s
	iters: 800, epoch: 7 | loss: 0.8030024
	speed: 0.3025s/iter; left time: 213199.6517s
	iters: 900, epoch: 7 | loss: 0.8018554
	speed: 0.3013s/iter; left time: 212336.6902s
	iters: 1000, epoch: 7 | loss: 0.7953338
	speed: 0.3025s/iter; left time: 213144.3984s
	iters: 1100, epoch: 7 | loss: 0.8633378
	speed: 0.3023s/iter; left time: 212940.1682s
	iters: 1200, epoch: 7 | loss: 1.0966551
	speed: 0.3014s/iter; left time: 212294.4372s
	iters: 1300, epoch: 7 | loss: 0.8156667
	speed: 0.3022s/iter; left time: 212807.7272s
	iters: 1400, epoch: 7 | loss: 0.7252264
	speed: 0.3015s/iter; left time: 212290.7072s
	iters: 1500, epoch: 7 | loss: 0.7842233
	speed: 0.3016s/iter; left time: 212320.5987s
	iters: 1600, epoch: 7 | loss: 0.8107873
	speed: 0.3017s/iter; left time: 212400.5169s
	iters: 1700, epoch: 7 | loss: 0.7644274
	speed: 0.3016s/iter; left time: 212300.1640s
	iters: 1800, epoch: 7 | loss: 0.8126777
	speed: 0.3011s/iter; left time: 211878.1113s
	iters: 1900, epoch: 7 | loss: 0.8888341
	speed: 0.3015s/iter; left time: 212171.4916s
	iters: 2000, epoch: 7 | loss: 0.8688933
	speed: 0.3015s/iter; left time: 212103.1507s
	iters: 2100, epoch: 7 | loss: 0.7358707
	speed: 0.3018s/iter; left time: 212333.0631s
	iters: 2200, epoch: 7 | loss: 0.7088453
	speed: 0.3019s/iter; left time: 212383.5630s
	iters: 2300, epoch: 7 | loss: 0.7224059
	speed: 0.3014s/iter; left time: 211964.9194s
	iters: 2400, epoch: 7 | loss: 0.8469162
	speed: 0.3020s/iter; left time: 212383.8212s
	iters: 2500, epoch: 7 | loss: 0.7085026
	speed: 0.3020s/iter; left time: 212297.6186s
	iters: 2600, epoch: 7 | loss: 0.8514562
	speed: 0.3015s/iter; left time: 211933.5894s
	iters: 2700, epoch: 7 | loss: 0.8233564
	speed: 0.3013s/iter; left time: 211772.2385s
	iters: 2800, epoch: 7 | loss: 0.8056128
	speed: 0.3019s/iter; left time: 212168.8146s
	iters: 2900, epoch: 7 | loss: 0.8933995
	speed: 0.3020s/iter; left time: 212196.6509s
	iters: 3000, epoch: 7 | loss: 0.7384827
	speed: 0.3018s/iter; left time: 212004.3051s
	iters: 3100, epoch: 7 | loss: 0.7795286
	speed: 0.3013s/iter; left time: 211649.7954s
	iters: 3200, epoch: 7 | loss: 0.7645647
	speed: 0.3015s/iter; left time: 211771.9648s
	iters: 3300, epoch: 7 | loss: 0.7065448
	speed: 0.3016s/iter; left time: 211818.2287s
	iters: 3400, epoch: 7 | loss: 0.8366630
	speed: 0.3013s/iter; left time: 211553.7047s
	iters: 3500, epoch: 7 | loss: 0.7508740
	speed: 0.3017s/iter; left time: 211813.5623s
	iters: 3600, epoch: 7 | loss: 0.7544121
	speed: 0.3022s/iter; left time: 212126.5828s
Epoch: 7 cost time: 1097.7885591983795
Epoch: 7, Steps: 3637 | Train Loss: 0.8129529 Vali Loss: 1.5047690 Test Loss: 1.3522776
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap730_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 247437
test shape: (24743, 1, 720, 151) (24743, 1, 720, 151)
test shape: (24743, 720, 151) (24743, 720, 151)
mse:1.1850075721740723, mae:0.8221538662910461
>>>>>>>Overall time: 10891 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
