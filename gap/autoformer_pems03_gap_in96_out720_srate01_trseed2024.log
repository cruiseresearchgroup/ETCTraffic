Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1498452
val 123360
test 352557
	iters: 100, epoch: 1 | loss: 1.4208781
	speed: 0.2854s/iter; left time: 267237.5274s
	iters: 200, epoch: 1 | loss: 1.3396729
	speed: 0.2834s/iter; left time: 265332.4113s
	iters: 300, epoch: 1 | loss: 1.1769178
	speed: 0.2839s/iter; left time: 265729.4450s
	iters: 400, epoch: 1 | loss: 1.3501250
	speed: 0.2835s/iter; left time: 265357.9318s
	iters: 500, epoch: 1 | loss: 1.2551156
	speed: 0.2839s/iter; left time: 265709.1273s
	iters: 600, epoch: 1 | loss: 1.2296913
	speed: 0.2833s/iter; left time: 265147.0831s
	iters: 700, epoch: 1 | loss: 1.3709512
	speed: 0.2836s/iter; left time: 265364.4055s
	iters: 800, epoch: 1 | loss: 1.2130511
	speed: 0.2839s/iter; left time: 265628.9629s
	iters: 900, epoch: 1 | loss: 1.2236956
	speed: 0.2833s/iter; left time: 265067.0848s
	iters: 1000, epoch: 1 | loss: 1.1295798
	speed: 0.2835s/iter; left time: 265174.6727s
	iters: 1100, epoch: 1 | loss: 1.2313093
	speed: 0.2835s/iter; left time: 265141.5853s
	iters: 1200, epoch: 1 | loss: 1.1414623
	speed: 0.2835s/iter; left time: 265123.4112s
	iters: 1300, epoch: 1 | loss: 1.1252708
	speed: 0.2837s/iter; left time: 265323.6678s
	iters: 1400, epoch: 1 | loss: 1.2151262
	speed: 0.2832s/iter; left time: 264802.3118s
	iters: 1500, epoch: 1 | loss: 1.1684632
	speed: 0.2835s/iter; left time: 265040.1842s
	iters: 1600, epoch: 1 | loss: 1.2523676
	speed: 0.2835s/iter; left time: 264997.3946s
	iters: 1700, epoch: 1 | loss: 1.0895195
	speed: 0.2835s/iter; left time: 265021.0398s
	iters: 1800, epoch: 1 | loss: 1.1258806
	speed: 0.2845s/iter; left time: 265909.6474s
	iters: 1900, epoch: 1 | loss: 1.1499538
	speed: 0.2843s/iter; left time: 265663.6091s
	iters: 2000, epoch: 1 | loss: 1.1418684
	speed: 0.2838s/iter; left time: 265153.8053s
	iters: 2100, epoch: 1 | loss: 1.0825707
	speed: 0.2838s/iter; left time: 265185.6167s
	iters: 2200, epoch: 1 | loss: 1.0222439
	speed: 0.2835s/iter; left time: 264816.9363s
	iters: 2300, epoch: 1 | loss: 1.0193086
	speed: 0.2837s/iter; left time: 264978.9460s
	iters: 2400, epoch: 1 | loss: 1.1505578
	speed: 0.2834s/iter; left time: 264651.7602s
	iters: 2500, epoch: 1 | loss: 1.1450087
	speed: 0.2835s/iter; left time: 264769.4070s
	iters: 2600, epoch: 1 | loss: 1.0609481
	speed: 0.2835s/iter; left time: 264750.1708s
	iters: 2700, epoch: 1 | loss: 1.1082711
	speed: 0.2838s/iter; left time: 265030.4589s
	iters: 2800, epoch: 1 | loss: 1.0627311
	speed: 0.2835s/iter; left time: 264716.7898s
	iters: 2900, epoch: 1 | loss: 1.0504715
	speed: 0.2837s/iter; left time: 264817.3267s
	iters: 3000, epoch: 1 | loss: 0.9911558
	speed: 0.2831s/iter; left time: 264282.5995s
	iters: 3100, epoch: 1 | loss: 1.0785644
	speed: 0.2836s/iter; left time: 264640.9322s
	iters: 3200, epoch: 1 | loss: 0.9176542
	speed: 0.2828s/iter; left time: 263914.1173s
	iters: 3300, epoch: 1 | loss: 1.2804699
	speed: 0.2832s/iter; left time: 264277.7798s
	iters: 3400, epoch: 1 | loss: 1.1576344
	speed: 0.2834s/iter; left time: 264385.7425s
	iters: 3500, epoch: 1 | loss: 1.1852658
	speed: 0.2834s/iter; left time: 264352.2141s
	iters: 3600, epoch: 1 | loss: 1.0417502
	speed: 0.2831s/iter; left time: 264050.8851s
	iters: 3700, epoch: 1 | loss: 0.9797992
	speed: 0.2834s/iter; left time: 264305.9658s
	iters: 3800, epoch: 1 | loss: 0.9501442
	speed: 0.2834s/iter; left time: 264340.3818s
	iters: 3900, epoch: 1 | loss: 1.0006104
	speed: 0.2835s/iter; left time: 264336.2886s
	iters: 4000, epoch: 1 | loss: 1.1958029
	speed: 0.2836s/iter; left time: 264444.2103s
	iters: 4100, epoch: 1 | loss: 1.1223062
	speed: 0.2833s/iter; left time: 264162.6142s
	iters: 4200, epoch: 1 | loss: 0.9707868
	speed: 0.2833s/iter; left time: 264117.6884s
	iters: 4300, epoch: 1 | loss: 1.0965524
	speed: 0.2834s/iter; left time: 264151.4824s
	iters: 4400, epoch: 1 | loss: 0.9554414
	speed: 0.2829s/iter; left time: 263691.9383s
	iters: 4500, epoch: 1 | loss: 1.0568371
	speed: 0.2832s/iter; left time: 263892.6354s
	iters: 4600, epoch: 1 | loss: 0.9960499
	speed: 0.2834s/iter; left time: 264032.7095s
Epoch: 1 cost time: 1327.8714513778687
Epoch: 1, Steps: 4682 | Train Loss: 1.1284896 Vali Loss: 1.0618570 Test Loss: 1.1413976
Validation loss decreased (inf --> 1.061857).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9114171
	speed: 5.5490s/iter; left time: 5169591.0162s
	iters: 200, epoch: 2 | loss: 1.0283941
	speed: 0.2880s/iter; left time: 268290.6571s
	iters: 300, epoch: 2 | loss: 0.9469884
	speed: 0.2878s/iter; left time: 268090.5128s
	iters: 400, epoch: 2 | loss: 0.9481189
	speed: 0.2876s/iter; left time: 267826.9896s
	iters: 500, epoch: 2 | loss: 0.9355968
	speed: 0.2872s/iter; left time: 267475.0662s
	iters: 600, epoch: 2 | loss: 0.9790838
	speed: 0.2883s/iter; left time: 268400.8685s
	iters: 700, epoch: 2 | loss: 0.9212450
	speed: 0.2874s/iter; left time: 267573.4800s
	iters: 800, epoch: 2 | loss: 0.9118369
	speed: 0.2876s/iter; left time: 267711.1593s
	iters: 900, epoch: 2 | loss: 0.9344259
	speed: 0.2880s/iter; left time: 268035.1551s
	iters: 1000, epoch: 2 | loss: 0.9214368
	speed: 0.2873s/iter; left time: 267436.1301s
	iters: 1100, epoch: 2 | loss: 0.9346407
	speed: 0.2875s/iter; left time: 267545.0947s
	iters: 1200, epoch: 2 | loss: 0.8786404
	speed: 0.2881s/iter; left time: 268066.1861s
	iters: 1300, epoch: 2 | loss: 0.9301467
	speed: 0.2870s/iter; left time: 267011.2538s
	iters: 1400, epoch: 2 | loss: 0.8880473
	speed: 0.2882s/iter; left time: 268117.1500s
	iters: 1500, epoch: 2 | loss: 0.8779184
	speed: 0.2874s/iter; left time: 267345.4863s
	iters: 1600, epoch: 2 | loss: 0.8901782
	speed: 0.2872s/iter; left time: 267161.7154s
	iters: 1700, epoch: 2 | loss: 0.9144912
	speed: 0.2869s/iter; left time: 266856.3303s
	iters: 1800, epoch: 2 | loss: 0.9113021
	speed: 0.2858s/iter; left time: 265759.3006s
	iters: 1900, epoch: 2 | loss: 0.9505998
	speed: 0.2873s/iter; left time: 267104.0541s
	iters: 2000, epoch: 2 | loss: 0.9798502
	speed: 0.2873s/iter; left time: 267127.1057s
	iters: 2100, epoch: 2 | loss: 0.9236567
	speed: 0.2874s/iter; left time: 267208.1379s
	iters: 2200, epoch: 2 | loss: 0.9233515
	speed: 0.2883s/iter; left time: 267988.1190s
	iters: 2300, epoch: 2 | loss: 0.9242100
	speed: 0.2871s/iter; left time: 266812.1726s
	iters: 2400, epoch: 2 | loss: 0.9037715
	speed: 0.2871s/iter; left time: 266822.9218s
	iters: 2500, epoch: 2 | loss: 0.9522842
	speed: 0.2872s/iter; left time: 266852.2013s
	iters: 2600, epoch: 2 | loss: 0.8830576
	speed: 0.2868s/iter; left time: 266489.7314s
	iters: 2700, epoch: 2 | loss: 0.8965653
	speed: 0.2870s/iter; left time: 266591.1647s
	iters: 2800, epoch: 2 | loss: 0.9238548
	speed: 0.2869s/iter; left time: 266553.0074s
	iters: 2900, epoch: 2 | loss: 0.9271359
	speed: 0.2864s/iter; left time: 265984.8194s
	iters: 3000, epoch: 2 | loss: 0.9258272
	speed: 0.2871s/iter; left time: 266619.0657s
	iters: 3100, epoch: 2 | loss: 0.9250215
	speed: 0.2874s/iter; left time: 266865.3186s
	iters: 3200, epoch: 2 | loss: 0.8802805
	speed: 0.2878s/iter; left time: 267213.3054s
	iters: 3300, epoch: 2 | loss: 0.8618484
	speed: 0.2877s/iter; left time: 267073.0960s
	iters: 3400, epoch: 2 | loss: 0.8931602
	speed: 0.2875s/iter; left time: 266872.3750s
	iters: 3500, epoch: 2 | loss: 0.8301955
	speed: 0.2876s/iter; left time: 266933.2754s
	iters: 3600, epoch: 2 | loss: 0.9970244
	speed: 0.2871s/iter; left time: 266457.9997s
	iters: 3700, epoch: 2 | loss: 0.8487591
	speed: 0.2868s/iter; left time: 266196.6983s
	iters: 3800, epoch: 2 | loss: 0.9199688
	speed: 0.2867s/iter; left time: 266064.0852s
	iters: 3900, epoch: 2 | loss: 0.8649186
	speed: 0.2873s/iter; left time: 266546.7085s
	iters: 4000, epoch: 2 | loss: 0.9013516
	speed: 0.2873s/iter; left time: 266516.5823s
	iters: 4100, epoch: 2 | loss: 0.9087324
	speed: 0.2868s/iter; left time: 266062.7594s
	iters: 4200, epoch: 2 | loss: 0.8925360
	speed: 0.2865s/iter; left time: 265732.2727s
	iters: 4300, epoch: 2 | loss: 0.9504885
	speed: 0.2867s/iter; left time: 265909.7785s
	iters: 4400, epoch: 2 | loss: 0.8946851
	speed: 0.2882s/iter; left time: 267255.7981s
	iters: 4500, epoch: 2 | loss: 0.9456435
	speed: 0.2870s/iter; left time: 266128.0863s
	iters: 4600, epoch: 2 | loss: 0.8784366
	speed: 0.2882s/iter; left time: 267209.6186s
Epoch: 2 cost time: 1345.4908609390259
Epoch: 2, Steps: 4682 | Train Loss: 0.9317808 Vali Loss: 1.0355310 Test Loss: 1.0283421
Validation loss decreased (1.061857 --> 1.035531).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8427834
	speed: 5.5548s/iter; left time: 5148927.0860s
	iters: 200, epoch: 3 | loss: 0.8794978
	speed: 0.2845s/iter; left time: 263685.0076s
	iters: 300, epoch: 3 | loss: 0.9013343
	speed: 0.2842s/iter; left time: 263349.0265s
	iters: 400, epoch: 3 | loss: 1.0020702
	speed: 0.2843s/iter; left time: 263456.1399s
	iters: 500, epoch: 3 | loss: 0.9668397
	speed: 0.2838s/iter; left time: 262940.2250s
	iters: 600, epoch: 3 | loss: 0.9280166
	speed: 0.2840s/iter; left time: 263070.4599s
	iters: 700, epoch: 3 | loss: 0.8655407
	speed: 0.2838s/iter; left time: 262937.9657s
	iters: 800, epoch: 3 | loss: 0.9135863
	speed: 0.2843s/iter; left time: 263346.5018s
	iters: 900, epoch: 3 | loss: 0.8687700
	speed: 0.2845s/iter; left time: 263447.7771s
	iters: 1000, epoch: 3 | loss: 0.8921162
	speed: 0.2844s/iter; left time: 263361.6425s
	iters: 1100, epoch: 3 | loss: 0.8378460
	speed: 0.2841s/iter; left time: 263095.6931s
	iters: 1200, epoch: 3 | loss: 0.8502890
	speed: 0.2847s/iter; left time: 263613.1457s
	iters: 1300, epoch: 3 | loss: 0.8882266
	speed: 0.2845s/iter; left time: 263332.0028s
	iters: 1400, epoch: 3 | loss: 1.0102129
	speed: 0.2838s/iter; left time: 262689.8981s
	iters: 1500, epoch: 3 | loss: 0.9413489
	speed: 0.2844s/iter; left time: 263234.6304s
	iters: 1600, epoch: 3 | loss: 0.9270837
	speed: 0.2844s/iter; left time: 263156.4257s
	iters: 1700, epoch: 3 | loss: 0.8475457
	speed: 0.2840s/iter; left time: 262802.9804s
	iters: 1800, epoch: 3 | loss: 0.8966108
	speed: 0.2839s/iter; left time: 262637.3218s
	iters: 1900, epoch: 3 | loss: 0.8603631
	speed: 0.2841s/iter; left time: 262808.1810s
	iters: 2000, epoch: 3 | loss: 0.8177290
	speed: 0.2842s/iter; left time: 262884.9850s
	iters: 2100, epoch: 3 | loss: 0.9162865
	speed: 0.2842s/iter; left time: 262840.6753s
	iters: 2200, epoch: 3 | loss: 0.8736385
	speed: 0.2842s/iter; left time: 262866.7764s
	iters: 2300, epoch: 3 | loss: 0.8646312
	speed: 0.2841s/iter; left time: 262706.1899s
	iters: 2400, epoch: 3 | loss: 0.9037668
	speed: 0.2838s/iter; left time: 262449.4891s
	iters: 2500, epoch: 3 | loss: 0.8482768
	speed: 0.2842s/iter; left time: 262741.3191s
	iters: 2600, epoch: 3 | loss: 0.9247372
	speed: 0.3532s/iter; left time: 326555.6009s
	iters: 2700, epoch: 3 | loss: 0.8410106
	speed: 0.4018s/iter; left time: 371373.2857s
	iters: 2800, epoch: 3 | loss: 0.8634148
	speed: 0.4019s/iter; left time: 371432.4027s
	iters: 2900, epoch: 3 | loss: 0.9813220
	speed: 0.4029s/iter; left time: 372344.3946s
	iters: 3000, epoch: 3 | loss: 0.8518228
	speed: 0.2991s/iter; left time: 276342.2333s
	iters: 3100, epoch: 3 | loss: 0.8897448
	speed: 0.3797s/iter; left time: 350804.8845s
	iters: 3200, epoch: 3 | loss: 1.0008048
	speed: 0.4023s/iter; left time: 371646.9978s
	iters: 3300, epoch: 3 | loss: 0.9971335
	speed: 0.4022s/iter; left time: 371489.6564s
	iters: 3400, epoch: 3 | loss: 0.9285591
	speed: 0.4027s/iter; left time: 371956.5319s
	iters: 3500, epoch: 3 | loss: 0.8835130
	speed: 0.4029s/iter; left time: 372075.8206s
	iters: 3600, epoch: 3 | loss: 0.8473253
	speed: 0.4023s/iter; left time: 371454.9190s
	iters: 3700, epoch: 3 | loss: 0.9246182
	speed: 0.4026s/iter; left time: 371737.3341s
	iters: 3800, epoch: 3 | loss: 0.8220300
	speed: 0.4033s/iter; left time: 372307.4887s
	iters: 3900, epoch: 3 | loss: 0.9090171
	speed: 0.4025s/iter; left time: 371580.0519s
	iters: 4000, epoch: 3 | loss: 0.8829544
	speed: 0.4025s/iter; left time: 371485.8214s
	iters: 4100, epoch: 3 | loss: 0.8268874
	speed: 0.4023s/iter; left time: 371286.5574s
	iters: 4200, epoch: 3 | loss: 0.8214758
	speed: 0.4025s/iter; left time: 371443.0894s
	iters: 4300, epoch: 3 | loss: 0.8776273
	speed: 0.4028s/iter; left time: 371669.7800s
	iters: 4400, epoch: 3 | loss: 0.8760963
	speed: 0.4026s/iter; left time: 371448.9443s
	iters: 4500, epoch: 3 | loss: 0.8049974
	speed: 0.4029s/iter; left time: 371724.3042s
	iters: 4600, epoch: 3 | loss: 0.9665521
	speed: 0.4023s/iter; left time: 371105.7983s
Epoch: 3 cost time: 1571.4722623825073
Epoch: 3, Steps: 4682 | Train Loss: 0.9056843 Vali Loss: 1.0264834 Test Loss: 1.0540458
Validation loss decreased (1.035531 --> 1.026483).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8548305
	speed: 5.7703s/iter; left time: 5321677.6412s
	iters: 200, epoch: 4 | loss: 0.9010093
	speed: 0.4031s/iter; left time: 371764.3681s
	iters: 300, epoch: 4 | loss: 0.8650188
	speed: 0.4034s/iter; left time: 371984.6590s
	iters: 400, epoch: 4 | loss: 0.8447652
	speed: 0.4031s/iter; left time: 371599.4499s
	iters: 500, epoch: 4 | loss: 0.9593769
	speed: 0.4027s/iter; left time: 371198.8578s
	iters: 600, epoch: 4 | loss: 0.8335040
	speed: 0.4030s/iter; left time: 371435.7834s
	iters: 700, epoch: 4 | loss: 0.7986868
	speed: 0.4030s/iter; left time: 371403.2678s
	iters: 800, epoch: 4 | loss: 0.8122516
	speed: 0.3151s/iter; left time: 290356.1924s
	iters: 900, epoch: 4 | loss: 0.7918534
	speed: 0.2869s/iter; left time: 264398.3719s
	iters: 1000, epoch: 4 | loss: 0.8556111
	speed: 0.2879s/iter; left time: 265304.1598s
	iters: 1100, epoch: 4 | loss: 1.0143595
	speed: 0.2874s/iter; left time: 264725.4501s
	iters: 1200, epoch: 4 | loss: 0.8044404
	speed: 0.2869s/iter; left time: 264250.1649s
	iters: 1300, epoch: 4 | loss: 0.7963343
	speed: 0.2874s/iter; left time: 264725.9530s
	iters: 1400, epoch: 4 | loss: 0.7602437
	speed: 0.2875s/iter; left time: 264730.6633s
	iters: 1500, epoch: 4 | loss: 0.7739535
	speed: 0.2871s/iter; left time: 264375.0822s
	iters: 1600, epoch: 4 | loss: 0.8719674
	speed: 0.2863s/iter; left time: 263644.0436s
	iters: 1700, epoch: 4 | loss: 0.8354571
	speed: 0.2873s/iter; left time: 264470.6090s
	iters: 1800, epoch: 4 | loss: 0.8284681
	speed: 0.2874s/iter; left time: 264573.3693s
	iters: 1900, epoch: 4 | loss: 0.9914025
	speed: 0.2879s/iter; left time: 264953.9206s
	iters: 2000, epoch: 4 | loss: 0.7778742
	speed: 0.2880s/iter; left time: 265070.2904s
	iters: 2100, epoch: 4 | loss: 0.8518197
	speed: 0.2876s/iter; left time: 264652.6957s
	iters: 2200, epoch: 4 | loss: 0.8610907
	speed: 0.2868s/iter; left time: 263893.3181s
	iters: 2300, epoch: 4 | loss: 0.7523654
	speed: 0.2871s/iter; left time: 264173.8089s
	iters: 2400, epoch: 4 | loss: 0.9372993
	speed: 0.2865s/iter; left time: 263523.8315s
	iters: 2500, epoch: 4 | loss: 0.8436701
	speed: 0.2868s/iter; left time: 263825.4898s
	iters: 2600, epoch: 4 | loss: 0.8681925
	speed: 0.2862s/iter; left time: 263266.5756s
	iters: 2700, epoch: 4 | loss: 0.8137255
	speed: 0.2874s/iter; left time: 264300.2081s
	iters: 2800, epoch: 4 | loss: 0.8629773
	speed: 0.2878s/iter; left time: 264637.4754s
	iters: 2900, epoch: 4 | loss: 0.8015814
	speed: 0.2874s/iter; left time: 264216.0888s
	iters: 3000, epoch: 4 | loss: 0.9915675
	speed: 0.2873s/iter; left time: 264158.6671s
	iters: 3100, epoch: 4 | loss: 1.0763354
	speed: 0.2867s/iter; left time: 263565.8079s
	iters: 3200, epoch: 4 | loss: 0.8667231
	speed: 0.2868s/iter; left time: 263632.8932s
	iters: 3300, epoch: 4 | loss: 0.8151306
	speed: 0.2869s/iter; left time: 263710.7340s
	iters: 3400, epoch: 4 | loss: 0.9289337
	speed: 0.2881s/iter; left time: 264767.7068s
	iters: 3500, epoch: 4 | loss: 0.8788383
	speed: 0.2876s/iter; left time: 264237.4959s
	iters: 3600, epoch: 4 | loss: 0.8232402
	speed: 0.2875s/iter; left time: 264144.1851s
	iters: 3700, epoch: 4 | loss: 0.7866796
	speed: 0.2872s/iter; left time: 263868.0533s
	iters: 3800, epoch: 4 | loss: 0.8885283
	speed: 0.2854s/iter; left time: 262163.5091s
	iters: 3900, epoch: 4 | loss: 0.8895853
	speed: 0.2843s/iter; left time: 261131.8249s
	iters: 4000, epoch: 4 | loss: 0.7815517
	speed: 0.2842s/iter; left time: 261018.9366s
	iters: 4100, epoch: 4 | loss: 0.8548568
	speed: 0.2837s/iter; left time: 260544.2535s
	iters: 4200, epoch: 4 | loss: 0.8457947
	speed: 0.2841s/iter; left time: 260876.5063s
	iters: 4300, epoch: 4 | loss: 0.7764119
	speed: 0.2840s/iter; left time: 260747.2545s
	iters: 4400, epoch: 4 | loss: 0.8372291
	speed: 0.2839s/iter; left time: 260648.7983s
	iters: 4500, epoch: 4 | loss: 0.8714933
	speed: 0.2842s/iter; left time: 260887.2649s
	iters: 4600, epoch: 4 | loss: 0.7357065
	speed: 0.2834s/iter; left time: 260052.1201s
Epoch: 4 cost time: 1425.735392332077
Epoch: 4, Steps: 4682 | Train Loss: 0.8631677 Vali Loss: 1.0586053 Test Loss: 1.0411012
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.8847537
	speed: 5.5538s/iter; left time: 5096062.3291s
	iters: 200, epoch: 5 | loss: 0.8693770
	speed: 0.2840s/iter; left time: 260529.4952s
	iters: 300, epoch: 5 | loss: 0.7986431
	speed: 0.2837s/iter; left time: 260248.4196s
	iters: 400, epoch: 5 | loss: 1.0301085
	speed: 0.2839s/iter; left time: 260446.4131s
	iters: 500, epoch: 5 | loss: 0.8996547
	speed: 0.2836s/iter; left time: 260106.5947s
	iters: 600, epoch: 5 | loss: 0.8187986
	speed: 0.2840s/iter; left time: 260486.4102s
	iters: 700, epoch: 5 | loss: 0.8478789
	speed: 0.2842s/iter; left time: 260577.2454s
	iters: 800, epoch: 5 | loss: 0.8485604
	speed: 0.2846s/iter; left time: 260910.6543s
	iters: 900, epoch: 5 | loss: 0.8175616
	speed: 0.2839s/iter; left time: 260254.5073s
	iters: 1000, epoch: 5 | loss: 0.7467113
	speed: 0.2839s/iter; left time: 260257.7502s
	iters: 1100, epoch: 5 | loss: 0.8749566
	speed: 0.2843s/iter; left time: 260619.7765s
	iters: 1200, epoch: 5 | loss: 0.8603389
	speed: 0.2843s/iter; left time: 260513.5089s
	iters: 1300, epoch: 5 | loss: 0.8241163
	speed: 0.2839s/iter; left time: 260154.9311s
	iters: 1400, epoch: 5 | loss: 0.8181433
	speed: 0.2840s/iter; left time: 260210.2627s
	iters: 1500, epoch: 5 | loss: 0.7875604
	speed: 0.2842s/iter; left time: 260379.3467s
	iters: 1600, epoch: 5 | loss: 0.8546716
	speed: 0.2844s/iter; left time: 260553.4787s
	iters: 1700, epoch: 5 | loss: 0.7904919
	speed: 0.2840s/iter; left time: 260114.8984s
	iters: 1800, epoch: 5 | loss: 0.9538058
	speed: 0.2841s/iter; left time: 260224.9111s
	iters: 1900, epoch: 5 | loss: 0.7993627
	speed: 0.2840s/iter; left time: 260045.2146s
	iters: 2000, epoch: 5 | loss: 0.8232083
	speed: 0.2842s/iter; left time: 260248.0800s
	iters: 2100, epoch: 5 | loss: 0.8202105
	speed: 0.2837s/iter; left time: 259792.7386s
	iters: 2200, epoch: 5 | loss: 0.8262897
	speed: 0.2839s/iter; left time: 259900.0486s
	iters: 2300, epoch: 5 | loss: 0.8229923
	speed: 0.2842s/iter; left time: 260105.3764s
	iters: 2400, epoch: 5 | loss: 0.8101559
	speed: 0.2837s/iter; left time: 259678.4971s
	iters: 2500, epoch: 5 | loss: 0.7530910
	speed: 0.2839s/iter; left time: 259861.4247s
	iters: 2600, epoch: 5 | loss: 0.9506838
	speed: 0.2839s/iter; left time: 259766.8828s
	iters: 2700, epoch: 5 | loss: 0.8344885
	speed: 0.2839s/iter; left time: 259779.8493s
	iters: 2800, epoch: 5 | loss: 0.8179554
	speed: 0.2839s/iter; left time: 259737.9882s
	iters: 2900, epoch: 5 | loss: 0.8577331
	speed: 0.2836s/iter; left time: 259408.8785s
	iters: 3000, epoch: 5 | loss: 0.8010637
	speed: 0.2838s/iter; left time: 259588.2612s
	iters: 3100, epoch: 5 | loss: 0.8252534
	speed: 0.2844s/iter; left time: 260118.0787s
	iters: 3200, epoch: 5 | loss: 0.8208988
	speed: 0.2841s/iter; left time: 259764.8005s
	iters: 3300, epoch: 5 | loss: 0.8985741
	speed: 0.2837s/iter; left time: 259405.8837s
	iters: 3400, epoch: 5 | loss: 0.7581681
	speed: 0.2841s/iter; left time: 259710.6871s
	iters: 3500, epoch: 5 | loss: 0.7688103
	speed: 0.2839s/iter; left time: 259535.9323s
	iters: 3600, epoch: 5 | loss: 0.7933081
	speed: 0.2842s/iter; left time: 259754.0645s
	iters: 3700, epoch: 5 | loss: 0.8269032
	speed: 0.2841s/iter; left time: 259684.5869s
	iters: 3800, epoch: 5 | loss: 0.8260001
	speed: 0.2845s/iter; left time: 259966.5220s
	iters: 3900, epoch: 5 | loss: 0.8442174
	speed: 0.2845s/iter; left time: 259966.3384s
	iters: 4000, epoch: 5 | loss: 0.8457540
	speed: 0.2842s/iter; left time: 259664.3533s
	iters: 4100, epoch: 5 | loss: 0.8802422
	speed: 0.2837s/iter; left time: 259173.4059s
	iters: 4200, epoch: 5 | loss: 0.8161608
	speed: 0.2842s/iter; left time: 259594.7142s
	iters: 4300, epoch: 5 | loss: 0.7477737
	speed: 0.2839s/iter; left time: 259346.9214s
	iters: 4400, epoch: 5 | loss: 0.8403355
	speed: 0.2841s/iter; left time: 259432.6974s
	iters: 4500, epoch: 5 | loss: 0.7779983
	speed: 0.2837s/iter; left time: 259100.5159s
	iters: 4600, epoch: 5 | loss: 0.8209499
	speed: 0.2841s/iter; left time: 259368.1206s
Epoch: 5 cost time: 1330.0134353637695
Epoch: 5, Steps: 4682 | Train Loss: 0.8282535 Vali Loss: 1.0860354 Test Loss: 1.0850980
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.8513182
	speed: 5.6737s/iter; left time: 5179480.9008s
	iters: 200, epoch: 6 | loss: 0.8904093
	speed: 0.4068s/iter; left time: 371282.7159s
	iters: 300, epoch: 6 | loss: 0.8490827
	speed: 0.4074s/iter; left time: 371823.9290s
	iters: 400, epoch: 6 | loss: 0.7525918
	speed: 0.4071s/iter; left time: 371509.6781s
	iters: 500, epoch: 6 | loss: 0.7845214
	speed: 0.4067s/iter; left time: 371119.6432s
	iters: 600, epoch: 6 | loss: 0.7940049
	speed: 0.4071s/iter; left time: 371426.4931s
	iters: 700, epoch: 6 | loss: 0.8119971
	speed: 0.4079s/iter; left time: 372079.0771s
	iters: 800, epoch: 6 | loss: 0.8167239
	speed: 0.4077s/iter; left time: 371878.5331s
	iters: 900, epoch: 6 | loss: 0.7481002
	speed: 0.4067s/iter; left time: 370941.9043s
	iters: 1000, epoch: 6 | loss: 0.7670951
	speed: 0.4075s/iter; left time: 371666.3147s
	iters: 1100, epoch: 6 | loss: 0.7737114
	speed: 0.4075s/iter; left time: 371560.1422s
	iters: 1200, epoch: 6 | loss: 0.8021223
	speed: 0.4067s/iter; left time: 370809.3224s
	iters: 1300, epoch: 6 | loss: 0.8113989
	speed: 0.4073s/iter; left time: 371290.7627s
	iters: 1400, epoch: 6 | loss: 0.8049008
	speed: 0.4072s/iter; left time: 371209.4576s
	iters: 1500, epoch: 6 | loss: 0.8162063
	speed: 0.4076s/iter; left time: 371509.9015s
	iters: 1600, epoch: 6 | loss: 0.8363178
	speed: 0.4067s/iter; left time: 370672.8419s
	iters: 1700, epoch: 6 | loss: 0.7736212
	speed: 0.4069s/iter; left time: 370817.1142s
	iters: 1800, epoch: 6 | loss: 0.7956247
	speed: 0.4073s/iter; left time: 371089.3880s
	iters: 1900, epoch: 6 | loss: 0.7951034
	speed: 0.4065s/iter; left time: 370384.9130s
	iters: 2000, epoch: 6 | loss: 0.7642355
	speed: 0.4071s/iter; left time: 370847.3930s
	iters: 2100, epoch: 6 | loss: 0.8036413
	speed: 0.4074s/iter; left time: 371099.0501s
	iters: 2200, epoch: 6 | loss: 0.7765352
	speed: 0.4067s/iter; left time: 370398.3687s
	iters: 2300, epoch: 6 | loss: 0.7714978
	speed: 0.4067s/iter; left time: 370415.8928s
	iters: 2400, epoch: 6 | loss: 0.7166958
	speed: 0.4066s/iter; left time: 370237.6151s
	iters: 2500, epoch: 6 | loss: 0.7766441
	speed: 0.4076s/iter; left time: 371160.7128s
	iters: 2600, epoch: 6 | loss: 0.7719904
	speed: 0.4065s/iter; left time: 370059.6385s
	iters: 2700, epoch: 6 | loss: 0.8138102
	speed: 0.4066s/iter; left time: 370164.0531s
	iters: 2800, epoch: 6 | loss: 0.8107875
	speed: 0.4076s/iter; left time: 370978.9367s
	iters: 2900, epoch: 6 | loss: 0.8023862
	speed: 0.4061s/iter; left time: 369573.7309s
	iters: 3000, epoch: 6 | loss: 0.7695793
	speed: 0.4063s/iter; left time: 369710.1001s
	iters: 3100, epoch: 6 | loss: 0.7147217
	speed: 0.4062s/iter; left time: 369628.5843s
	iters: 3200, epoch: 6 | loss: 0.7565314
	speed: 0.4074s/iter; left time: 370691.4331s
	iters: 3300, epoch: 6 | loss: 0.7441624
	speed: 0.4076s/iter; left time: 370800.6465s
	iters: 3400, epoch: 6 | loss: 0.7619587
	speed: 0.4069s/iter; left time: 370109.2539s
	iters: 3500, epoch: 6 | loss: 0.7724672
	speed: 0.4061s/iter; left time: 369379.7951s
	iters: 3600, epoch: 6 | loss: 0.7444103
	speed: 0.4072s/iter; left time: 370264.8889s
	iters: 3700, epoch: 6 | loss: 0.7357159
	speed: 0.4072s/iter; left time: 370300.2021s
	iters: 3800, epoch: 6 | loss: 0.7102814
	speed: 0.4063s/iter; left time: 369391.8900s
	iters: 3900, epoch: 6 | loss: 0.8324373
	speed: 0.4063s/iter; left time: 369356.8101s
	iters: 4000, epoch: 6 | loss: 0.7768407
	speed: 0.4068s/iter; left time: 369797.5795s
	iters: 4100, epoch: 6 | loss: 0.8594972
	speed: 0.4073s/iter; left time: 370198.5681s
	iters: 4200, epoch: 6 | loss: 0.7940400
	speed: 0.4064s/iter; left time: 369371.3178s
	iters: 4300, epoch: 6 | loss: 0.7890424
	speed: 0.4078s/iter; left time: 370591.7624s
	iters: 4400, epoch: 6 | loss: 0.7113102
	speed: 0.4068s/iter; left time: 369632.4982s
	iters: 4500, epoch: 6 | loss: 0.7730023
	speed: 0.4067s/iter; left time: 369498.4438s
	iters: 4600, epoch: 6 | loss: 0.8762790
	speed: 0.4070s/iter; left time: 369683.1273s
Epoch: 6 cost time: 1905.6119849681854
Epoch: 6, Steps: 4682 | Train Loss: 0.7932550 Vali Loss: 1.1268466 Test Loss: 1.1058863
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.7831476
	speed: 5.7703s/iter; left time: 5240634.1982s
	iters: 200, epoch: 7 | loss: 0.6992521
	speed: 0.4033s/iter; left time: 366195.2859s
	iters: 300, epoch: 7 | loss: 0.7629549
	speed: 0.4037s/iter; left time: 366591.5335s
	iters: 400, epoch: 7 | loss: 0.8207017
	speed: 0.4024s/iter; left time: 365351.3701s
	iters: 500, epoch: 7 | loss: 0.7997630
	speed: 0.4021s/iter; left time: 365061.0885s
	iters: 600, epoch: 7 | loss: 0.7087780
	speed: 0.4029s/iter; left time: 365678.4468s
	iters: 700, epoch: 7 | loss: 0.8050700
	speed: 0.4026s/iter; left time: 365390.0666s
	iters: 800, epoch: 7 | loss: 0.7370406
	speed: 0.4025s/iter; left time: 365277.9483s
	iters: 900, epoch: 7 | loss: 0.7476461
	speed: 0.4022s/iter; left time: 364954.0090s
	iters: 1000, epoch: 7 | loss: 0.7930772
	speed: 0.4021s/iter; left time: 364810.3393s
	iters: 1100, epoch: 7 | loss: 0.8364203
	speed: 0.4024s/iter; left time: 365054.4734s
	iters: 1200, epoch: 7 | loss: 0.7634644
	speed: 0.4023s/iter; left time: 364931.0560s
	iters: 1300, epoch: 7 | loss: 0.7622066
	speed: 0.4016s/iter; left time: 364252.1380s
	iters: 1400, epoch: 7 | loss: 0.7733256
	speed: 0.4024s/iter; left time: 364916.4295s
	iters: 1500, epoch: 7 | loss: 0.7182357
	speed: 0.4018s/iter; left time: 364374.3441s
	iters: 1600, epoch: 7 | loss: 0.8239492
	speed: 0.4025s/iter; left time: 364916.4869s
	iters: 1700, epoch: 7 | loss: 0.7652583
	speed: 0.4035s/iter; left time: 365785.6436s
	iters: 1800, epoch: 7 | loss: 0.7174027
	speed: 0.4019s/iter; left time: 364335.5940s
	iters: 1900, epoch: 7 | loss: 0.7395434
	speed: 0.4025s/iter; left time: 364871.8926s
	iters: 2000, epoch: 7 | loss: 0.7333816
	speed: 0.4029s/iter; left time: 365145.8174s
	iters: 2100, epoch: 7 | loss: 0.7799502
	speed: 0.4029s/iter; left time: 365148.9015s
	iters: 2200, epoch: 7 | loss: 0.7373222
	speed: 0.4019s/iter; left time: 364184.3244s
	iters: 2300, epoch: 7 | loss: 0.7178641
	speed: 0.4027s/iter; left time: 364879.4822s
	iters: 2400, epoch: 7 | loss: 0.7673771
	speed: 0.4030s/iter; left time: 365117.8152s
	iters: 2500, epoch: 7 | loss: 0.7962698
	speed: 0.4030s/iter; left time: 365065.7823s
	iters: 2600, epoch: 7 | loss: 0.7443295
	speed: 0.4029s/iter; left time: 364932.8120s
	iters: 2700, epoch: 7 | loss: 0.7267675
	speed: 0.4029s/iter; left time: 364837.4031s
	iters: 2800, epoch: 7 | loss: 0.7336719
	speed: 0.4032s/iter; left time: 365114.5529s
	iters: 2900, epoch: 7 | loss: 0.7358310
	speed: 0.4028s/iter; left time: 364708.6057s
	iters: 3000, epoch: 7 | loss: 0.7597573
	speed: 0.4021s/iter; left time: 364040.3719s
	iters: 3100, epoch: 7 | loss: 0.7296164
	speed: 0.4022s/iter; left time: 364078.4527s
	iters: 3200, epoch: 7 | loss: 0.7138257
	speed: 0.4034s/iter; left time: 365075.9119s
	iters: 3300, epoch: 7 | loss: 0.6977741
	speed: 0.4022s/iter; left time: 363964.3280s
	iters: 3400, epoch: 7 | loss: 0.7503658
	speed: 0.4021s/iter; left time: 363832.0369s
	iters: 3500, epoch: 7 | loss: 0.7683567
	speed: 0.4034s/iter; left time: 364984.0165s
	iters: 3600, epoch: 7 | loss: 0.7452177
	speed: 0.4028s/iter; left time: 364407.4279s
	iters: 3700, epoch: 7 | loss: 0.7375563
	speed: 0.4025s/iter; left time: 364091.0324s
	iters: 3800, epoch: 7 | loss: 0.7762166
	speed: 0.4027s/iter; left time: 364258.1353s
	iters: 3900, epoch: 7 | loss: 0.8105320
	speed: 0.4032s/iter; left time: 364683.3054s
	iters: 4000, epoch: 7 | loss: 0.7044825
	speed: 0.4020s/iter; left time: 363491.1459s
	iters: 4100, epoch: 7 | loss: 0.7770163
	speed: 0.4031s/iter; left time: 364445.4845s
	iters: 4200, epoch: 7 | loss: 0.7255782
	speed: 0.4028s/iter; left time: 364187.2731s
	iters: 4300, epoch: 7 | loss: 0.8002836
	speed: 0.4025s/iter; left time: 363831.3228s
	iters: 4400, epoch: 7 | loss: 0.7178992
	speed: 0.4022s/iter; left time: 363518.8027s
	iters: 4500, epoch: 7 | loss: 0.7827840
	speed: 0.4031s/iter; left time: 364305.2940s
	iters: 4600, epoch: 7 | loss: 0.7035274
	speed: 0.4026s/iter; left time: 363835.7987s
Epoch: 7 cost time: 1885.214525938034
Epoch: 7, Steps: 4682 | Train Loss: 0.7651238 Vali Loss: 1.1348104 Test Loss: 1.1039662
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.7956675
	speed: 5.7745s/iter; left time: 5217398.9934s
	iters: 200, epoch: 8 | loss: 0.7105203
	speed: 0.4079s/iter; left time: 368475.0685s
	iters: 300, epoch: 8 | loss: 0.7187054
	speed: 0.4079s/iter; left time: 368428.5210s
	iters: 400, epoch: 8 | loss: 0.7323119
	speed: 0.4083s/iter; left time: 368809.0276s
	iters: 500, epoch: 8 | loss: 0.6846351
	speed: 0.4072s/iter; left time: 367772.2458s
	iters: 600, epoch: 8 | loss: 0.7472786
	speed: 0.4077s/iter; left time: 368122.4216s
	iters: 700, epoch: 8 | loss: 0.7605965
	speed: 0.4077s/iter; left time: 368124.7801s
	iters: 800, epoch: 8 | loss: 0.7650717
	speed: 0.4077s/iter; left time: 368069.9691s
	iters: 900, epoch: 8 | loss: 0.7460625
	speed: 0.4074s/iter; left time: 367739.2296s
	iters: 1000, epoch: 8 | loss: 0.6929889
	speed: 0.4080s/iter; left time: 368245.4747s
	iters: 1100, epoch: 8 | loss: 0.7697316
	speed: 0.4074s/iter; left time: 367657.6297s
	iters: 1200, epoch: 8 | loss: 0.7414359
	speed: 0.4083s/iter; left time: 368472.4370s
	iters: 1300, epoch: 8 | loss: 0.8316327
	speed: 0.4073s/iter; left time: 367535.9594s
	iters: 1400, epoch: 8 | loss: 0.7674049
	speed: 0.4130s/iter; left time: 372645.0687s
	iters: 1500, epoch: 8 | loss: 0.7266689
	speed: 0.2873s/iter; left time: 259139.1631s
	iters: 1600, epoch: 8 | loss: 0.7266673
	speed: 0.2839s/iter; left time: 256124.3018s
	iters: 1700, epoch: 8 | loss: 0.7145424
	speed: 0.2838s/iter; left time: 255943.6081s
	iters: 1800, epoch: 8 | loss: 0.7373720
	speed: 0.2840s/iter; left time: 256079.0636s
	iters: 1900, epoch: 8 | loss: 0.8275709
	speed: 0.2845s/iter; left time: 256522.0991s
	iters: 2000, epoch: 8 | loss: 0.7528665
	speed: 0.2842s/iter; left time: 256210.9491s
	iters: 2100, epoch: 8 | loss: 0.7949912
	speed: 0.2842s/iter; left time: 256247.2727s
	iters: 2200, epoch: 8 | loss: 0.7233146
	speed: 0.2844s/iter; left time: 256330.6230s
	iters: 2300, epoch: 8 | loss: 0.7728338
	speed: 0.2837s/iter; left time: 255707.5541s
	iters: 2400, epoch: 8 | loss: 0.7686620
	speed: 0.2841s/iter; left time: 256020.3512s
	iters: 2500, epoch: 8 | loss: 0.7865021
	speed: 0.2842s/iter; left time: 256093.6618s
	iters: 2600, epoch: 8 | loss: 0.7819465
	speed: 0.2842s/iter; left time: 256047.4897s
	iters: 2700, epoch: 8 | loss: 0.7367043
	speed: 0.2838s/iter; left time: 255712.6484s
	iters: 2800, epoch: 8 | loss: 0.7065046
	speed: 0.2843s/iter; left time: 256079.4491s
	iters: 2900, epoch: 8 | loss: 0.7256927
	speed: 0.2841s/iter; left time: 255892.2100s
	iters: 3000, epoch: 8 | loss: 0.7128461
	speed: 0.2843s/iter; left time: 256035.9271s
	iters: 3100, epoch: 8 | loss: 0.6990410
	speed: 0.2845s/iter; left time: 256161.6891s
	iters: 3200, epoch: 8 | loss: 0.7703353
	speed: 0.2843s/iter; left time: 256032.6858s
	iters: 3300, epoch: 8 | loss: 0.7880784
	speed: 0.2840s/iter; left time: 255655.0059s
	iters: 3400, epoch: 8 | loss: 0.6875349
	speed: 0.2839s/iter; left time: 255596.6970s
	iters: 3500, epoch: 8 | loss: 1.0135186
	speed: 0.2846s/iter; left time: 256152.9048s
	iters: 3600, epoch: 8 | loss: 0.7161983
	speed: 0.2841s/iter; left time: 255725.5630s
	iters: 3700, epoch: 8 | loss: 0.7240427
	speed: 0.2838s/iter; left time: 255370.1186s
	iters: 3800, epoch: 8 | loss: 0.7271149
	speed: 0.2840s/iter; left time: 255518.6499s
	iters: 3900, epoch: 8 | loss: 0.6892139
	speed: 0.2840s/iter; left time: 255497.9931s
	iters: 4000, epoch: 8 | loss: 0.6752467
	speed: 0.2842s/iter; left time: 255641.7716s
	iters: 4100, epoch: 8 | loss: 0.6992956
	speed: 0.2836s/iter; left time: 255120.8087s
	iters: 4200, epoch: 8 | loss: 0.7305815
	speed: 0.2840s/iter; left time: 255481.1283s
	iters: 4300, epoch: 8 | loss: 0.6974061
	speed: 0.2839s/iter; left time: 255334.8030s
	iters: 4400, epoch: 8 | loss: 0.6547226
	speed: 0.2841s/iter; left time: 255480.2878s
	iters: 4500, epoch: 8 | loss: 0.6775905
	speed: 0.2839s/iter; left time: 255231.7288s
	iters: 4600, epoch: 8 | loss: 0.7148336
	speed: 0.2836s/iter; left time: 254922.8313s
Epoch: 8 cost time: 1504.11936545372
Epoch: 8, Steps: 4682 | Train Loss: 0.7460970 Vali Loss: 1.1617551 Test Loss: 1.1318976
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 352557
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1498452
val 123360
test 352557
	iters: 100, epoch: 1 | loss: 1.4236666
	speed: 0.3010s/iter; left time: 281837.0808s
	iters: 200, epoch: 1 | loss: 1.3343432
	speed: 0.2992s/iter; left time: 280153.0307s
	iters: 300, epoch: 1 | loss: 1.2809973
	speed: 0.3002s/iter; left time: 281011.4115s
	iters: 400, epoch: 1 | loss: 1.3767564
	speed: 0.2998s/iter; left time: 280581.5518s
	iters: 500, epoch: 1 | loss: 1.2835622
	speed: 0.2994s/iter; left time: 280210.5383s
	iters: 600, epoch: 1 | loss: 1.1967250
	speed: 0.2998s/iter; left time: 280579.5542s
	iters: 700, epoch: 1 | loss: 1.3771957
	speed: 0.3000s/iter; left time: 280692.0179s
	iters: 800, epoch: 1 | loss: 1.1585317
	speed: 0.3004s/iter; left time: 281084.2478s
	iters: 900, epoch: 1 | loss: 1.2369733
	speed: 0.3000s/iter; left time: 280651.3505s
	iters: 1000, epoch: 1 | loss: 1.3572613
	speed: 0.2998s/iter; left time: 280464.6921s
	iters: 1100, epoch: 1 | loss: 1.2441531
	speed: 0.2997s/iter; left time: 280271.7320s
	iters: 1200, epoch: 1 | loss: 1.1374167
	speed: 0.3001s/iter; left time: 280680.6677s
	iters: 1300, epoch: 1 | loss: 1.1307336
	speed: 0.2997s/iter; left time: 280244.5085s
	iters: 1400, epoch: 1 | loss: 1.0666910
	speed: 0.2991s/iter; left time: 279647.9392s
	iters: 1500, epoch: 1 | loss: 1.1655996
	speed: 0.2995s/iter; left time: 279981.5588s
	iters: 1600, epoch: 1 | loss: 1.2240940
	speed: 0.2999s/iter; left time: 280313.4847s
	iters: 1700, epoch: 1 | loss: 1.1552486
	speed: 0.2995s/iter; left time: 279915.2787s
	iters: 1800, epoch: 1 | loss: 1.1443925
	speed: 0.2995s/iter; left time: 279955.0227s
	iters: 1900, epoch: 1 | loss: 1.1364455
	speed: 0.3003s/iter; left time: 280604.5131s
	iters: 2000, epoch: 1 | loss: 1.1729176
	speed: 0.3003s/iter; left time: 280595.0082s
	iters: 2100, epoch: 1 | loss: 1.1601282
	speed: 0.2997s/iter; left time: 279965.0714s
	iters: 2200, epoch: 1 | loss: 0.9845057
	speed: 0.3000s/iter; left time: 280278.6642s
	iters: 2300, epoch: 1 | loss: 1.0855793
	speed: 0.2998s/iter; left time: 280000.5332s
	iters: 2400, epoch: 1 | loss: 1.0693227
	speed: 0.3004s/iter; left time: 280613.9496s
	iters: 2500, epoch: 1 | loss: 1.3261337
	speed: 0.2997s/iter; left time: 279905.0125s
	iters: 2600, epoch: 1 | loss: 1.1088197
	speed: 0.3000s/iter; left time: 280175.7592s
	iters: 2700, epoch: 1 | loss: 0.9841548
	speed: 0.2997s/iter; left time: 279842.4136s
	iters: 2800, epoch: 1 | loss: 0.9554183
	speed: 0.3005s/iter; left time: 280522.7935s
	iters: 2900, epoch: 1 | loss: 0.9743053
	speed: 0.2996s/iter; left time: 279707.5047s
	iters: 3000, epoch: 1 | loss: 1.0484922
	speed: 0.2999s/iter; left time: 279953.1641s
	iters: 3100, epoch: 1 | loss: 1.0086050
	speed: 0.2995s/iter; left time: 279517.6220s
	iters: 3200, epoch: 1 | loss: 0.8921624
	speed: 0.3001s/iter; left time: 280062.7511s
	iters: 3300, epoch: 1 | loss: 1.2576607
	speed: 0.3006s/iter; left time: 280466.8543s
	iters: 3400, epoch: 1 | loss: 0.9608625
	speed: 0.2999s/iter; left time: 279830.3456s
	iters: 3500, epoch: 1 | loss: 0.9520953
	speed: 0.3001s/iter; left time: 279957.2799s
	iters: 3600, epoch: 1 | loss: 0.8796079
	speed: 0.3001s/iter; left time: 279954.2207s
	iters: 3700, epoch: 1 | loss: 0.9321567
	speed: 0.3001s/iter; left time: 279865.5686s
	iters: 3800, epoch: 1 | loss: 0.8721195
	speed: 0.2996s/iter; left time: 279427.5427s
	iters: 3900, epoch: 1 | loss: 0.8670388
	speed: 0.2996s/iter; left time: 279362.8755s
	iters: 4000, epoch: 1 | loss: 0.9772188
	speed: 0.3002s/iter; left time: 279932.3781s
	iters: 4100, epoch: 1 | loss: 0.9134358
	speed: 0.3001s/iter; left time: 279821.3795s
	iters: 4200, epoch: 1 | loss: 0.9149892
	speed: 0.2993s/iter; left time: 279026.5893s
	iters: 4300, epoch: 1 | loss: 0.9500708
	speed: 0.2996s/iter; left time: 279239.0837s
	iters: 4400, epoch: 1 | loss: 0.9465815
	speed: 0.3000s/iter; left time: 279612.9791s
	iters: 4500, epoch: 1 | loss: 0.9843352
	speed: 0.3004s/iter; left time: 279907.7108s
	iters: 4600, epoch: 1 | loss: 1.0033334
	speed: 0.2998s/iter; left time: 279355.3929s
Epoch: 1 cost time: 1404.493974685669
Epoch: 1, Steps: 4682 | Train Loss: 1.0905634 Vali Loss: 1.0421218 Test Loss: 1.0930644
Validation loss decreased (inf --> 1.042122).  Saving model ...
Traceback (most recent call last):
  File "/jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 372, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 493, in _save
    zip_file.write_record(name, buf_value, len(buf_value))
OSError: [Errno 122] Disk quota exceeded

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 373, in save
    return
  File "/jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 259, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:274] . unexpected pos 10574208 vs 10574096

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 214, in train
    early_stopping(vali_loss, self.model, path)
  File "/g/data/hn98/du/exlts/ddd2/utils/tools.py", line 43, in __call__
    self.save_checkpoint(val_loss, model, path)
  File "/g/data/hn98/du/exlts/ddd2/utils/tools.py", line 57, in save_checkpoint
    torch.save(model.state_dict(), path + '/' + 'checkpoint.pth')
  File "/jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 374, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 214, in __exit__
    self.file_like.close()
OSError: [Errno 122] Disk quota exceeded
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:274] . unexpected pos 10574208 vs 10574096
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x14c70c5816a7 in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1c99500 (0x14c74b8e8500 in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x1c956d3 (0x14c74b8e46d3 in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xa9 (0x14c74b8e9609 in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0xe1 (0x14c74b8ea141 in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x115 (0x14c74b8ea935 in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x654323 (0x14c75afbb323 in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x2c2b90 (0x14c75ac29b90 in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x2c3cfe (0x14c75ac2acfe in /jobfs/116442444.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #9: python() [0x4e0800]
frame #10: python() [0x4f16a8]
frame #11: python() [0x4f1691]
frame #12: python() [0x4f1691]
frame #13: python() [0x4f1691]
frame #14: python() [0x4f1691]
frame #15: python() [0x4c9280]
<omitting python frames>
frame #21: __libc_start_main + 0xe5 (0x14c769d7ad85 in /lib64/libc.so.6)
frame #22: python() [0x57a64d]

Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_all_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1498452
val 123360
test 352557
	iters: 100, epoch: 1 | loss: 1.4297445
	speed: 0.2995s/iter; left time: 280466.2159s
	iters: 200, epoch: 1 | loss: 1.3537014
	speed: 0.2978s/iter; left time: 278841.5068s
	iters: 300, epoch: 1 | loss: 1.2308158
	speed: 0.2974s/iter; left time: 278385.3430s
	iters: 400, epoch: 1 | loss: 1.3574222
	speed: 0.2980s/iter; left time: 278962.8204s
	iters: 500, epoch: 1 | loss: 1.2162415
	speed: 0.2981s/iter; left time: 278995.9947s
	iters: 600, epoch: 1 | loss: 1.2003764
	speed: 0.2982s/iter; left time: 279044.2780s
	iters: 700, epoch: 1 | loss: 1.3178234
	speed: 0.2975s/iter; left time: 278327.0656s
	iters: 800, epoch: 1 | loss: 1.1382985
	speed: 0.2970s/iter; left time: 277890.5597s
	iters: 900, epoch: 1 | loss: 1.1945707
	speed: 0.2976s/iter; left time: 278417.9179s
	iters: 1000, epoch: 1 | loss: 1.1307755
	speed: 0.2978s/iter; left time: 278580.6269s
	iters: 1100, epoch: 1 | loss: 1.1942035
	speed: 0.2985s/iter; left time: 279223.4636s
	iters: 1200, epoch: 1 | loss: 1.1161126
	speed: 0.2972s/iter; left time: 277929.1419s
	iters: 1300, epoch: 1 | loss: 1.0757473
	speed: 0.2978s/iter; left time: 278507.5271s
	iters: 1400, epoch: 1 | loss: 1.0987653
	speed: 0.2981s/iter; left time: 278685.9009s
	iters: 1500, epoch: 1 | loss: 1.1217568
	speed: 0.2976s/iter; left time: 278184.4098s
	iters: 1600, epoch: 1 | loss: 1.2302190
	speed: 0.2974s/iter; left time: 278002.0258s
	iters: 1700, epoch: 1 | loss: 1.1292980
	speed: 0.2976s/iter; left time: 278166.2175s
	iters: 1800, epoch: 1 | loss: 1.0972893
	speed: 0.2981s/iter; left time: 278617.6174s
	iters: 1900, epoch: 1 | loss: 1.1604888
	speed: 0.2976s/iter; left time: 278080.9350s
	iters: 2000, epoch: 1 | loss: 1.1653637
	speed: 0.2979s/iter; left time: 278370.4997s
	iters: 2100, epoch: 1 | loss: 1.1151170
	speed: 0.2977s/iter; left time: 278138.1709s
	iters: 2200, epoch: 1 | loss: 1.0866631
	speed: 0.2979s/iter; left time: 278299.8407s
	iters: 2300, epoch: 1 | loss: 1.0628333
	speed: 0.2974s/iter; left time: 277794.4173s
	iters: 2400, epoch: 1 | loss: 1.1523329
	speed: 0.2973s/iter; left time: 277723.4171s
	iters: 2500, epoch: 1 | loss: 1.1252142
	speed: 0.2956s/iter; left time: 276049.9398s
	iters: 2600, epoch: 1 | loss: 1.0458562
	speed: 0.2947s/iter; left time: 275187.3034s
	iters: 2700, epoch: 1 | loss: 1.0527200
	speed: 0.2951s/iter; left time: 275570.7161s
	iters: 2800, epoch: 1 | loss: 1.0243037
	speed: 0.2966s/iter; left time: 276860.4558s
	iters: 2900, epoch: 1 | loss: 1.0493168
	speed: 0.2952s/iter; left time: 275572.1480s
	iters: 3000, epoch: 1 | loss: 0.9721748
	speed: 0.2953s/iter; left time: 275586.9243s
	iters: 3100, epoch: 1 | loss: 0.9915931
	speed: 0.2961s/iter; left time: 276377.5677s
	iters: 3200, epoch: 1 | loss: 0.9311381
	speed: 0.2948s/iter; left time: 275102.2373s
	iters: 3300, epoch: 1 | loss: 1.0314044
	speed: 0.2951s/iter; left time: 275324.7325s
	iters: 3400, epoch: 1 | loss: 0.9843619
	speed: 0.2982s/iter; left time: 278257.4897s
	iters: 3500, epoch: 1 | loss: 0.9898006
	speed: 0.2957s/iter; left time: 275840.4976s
	iters: 3600, epoch: 1 | loss: 0.8822922
	speed: 0.2945s/iter; left time: 274747.3800s
	iters: 3700, epoch: 1 | loss: 0.9863459
	speed: 0.2949s/iter; left time: 275062.2487s
	iters: 3800, epoch: 1 | loss: 0.9780270
	speed: 0.2949s/iter; left time: 275036.3598s
	iters: 3900, epoch: 1 | loss: 1.1490611
	speed: 0.2950s/iter; left time: 275075.3626s
	iters: 4000, epoch: 1 | loss: 1.1840988
	speed: 0.2946s/iter; left time: 274703.0035s
	iters: 4100, epoch: 1 | loss: 1.1156874
	speed: 0.2949s/iter; left time: 274938.8436s
	iters: 4200, epoch: 1 | loss: 1.0997280
	speed: 0.2946s/iter; left time: 274641.7549s
	iters: 4300, epoch: 1 | loss: 1.1506751
	speed: 0.2946s/iter; left time: 274603.3307s
	iters: 4400, epoch: 1 | loss: 1.0652325
	speed: 0.2975s/iter; left time: 277225.3740s
	iters: 4500, epoch: 1 | loss: 1.0355107
	speed: 0.3026s/iter; left time: 282030.2448s
	iters: 4600, epoch: 1 | loss: 0.9985074
	speed: 0.3022s/iter; left time: 281578.3370s
Epoch: 1 cost time: 1390.601236820221
Epoch: 1, Steps: 4682 | Train Loss: 1.1140357 Vali Loss: 1.0085312 Test Loss: 1.0750735
Validation loss decreased (inf --> 1.008531).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9234536
	speed: 5.6454s/iter; left time: 5259396.0747s
	iters: 200, epoch: 2 | loss: 0.9231250
	speed: 0.2952s/iter; left time: 274951.4014s
	iters: 300, epoch: 2 | loss: 0.9549530
	speed: 0.2954s/iter; left time: 275111.2797s
	iters: 400, epoch: 2 | loss: 0.9645373
	speed: 0.2951s/iter; left time: 274808.5403s
	iters: 500, epoch: 2 | loss: 0.9968569
	speed: 0.2952s/iter; left time: 274895.4135s
	iters: 600, epoch: 2 | loss: 0.9676800
	speed: 0.2950s/iter; left time: 274685.0755s
	iters: 700, epoch: 2 | loss: 0.9296263
	speed: 0.2951s/iter; left time: 274782.7340s
	iters: 800, epoch: 2 | loss: 0.9450917
	speed: 0.2954s/iter; left time: 275026.5625s
	iters: 900, epoch: 2 | loss: 0.9422967
	speed: 0.2955s/iter; left time: 275063.3966s
	iters: 1000, epoch: 2 | loss: 0.9425089
	speed: 0.2948s/iter; left time: 274396.8689s
	iters: 1100, epoch: 2 | loss: 0.9758384
	speed: 0.2954s/iter; left time: 274912.3007s
	iters: 1200, epoch: 2 | loss: 0.9043954
	speed: 0.2949s/iter; left time: 274455.5530s
	iters: 1300, epoch: 2 | loss: 0.9353673
	speed: 0.2951s/iter; left time: 274600.2428s
	iters: 1400, epoch: 2 | loss: 0.9253345
	speed: 0.2949s/iter; left time: 274394.1167s
	iters: 1500, epoch: 2 | loss: 0.8789772
	speed: 0.2955s/iter; left time: 274884.1342s
	iters: 1600, epoch: 2 | loss: 0.9393520
	speed: 0.2949s/iter; left time: 274325.5320s
	iters: 1700, epoch: 2 | loss: 0.9484583
	speed: 0.2945s/iter; left time: 273925.9004s
	iters: 1800, epoch: 2 | loss: 0.9368344
	speed: 0.2953s/iter; left time: 274640.5474s
	iters: 1900, epoch: 2 | loss: 0.9804319
	speed: 0.2949s/iter; left time: 274216.8822s
	iters: 2000, epoch: 2 | loss: 1.0131502
	speed: 0.2950s/iter; left time: 274224.2599s
	iters: 2100, epoch: 2 | loss: 0.9406968
	speed: 0.2952s/iter; left time: 274399.5385s
	iters: 2200, epoch: 2 | loss: 0.9599262
	speed: 0.2949s/iter; left time: 274154.0067s
	iters: 2300, epoch: 2 | loss: 0.9633136
	speed: 0.2951s/iter; left time: 274289.3782s
	iters: 2400, epoch: 2 | loss: 0.9358066
	speed: 0.2948s/iter; left time: 274008.7291s
	iters: 2500, epoch: 2 | loss: 0.9453787
	speed: 0.2953s/iter; left time: 274354.7331s
	iters: 2600, epoch: 2 | loss: 0.8816802
	speed: 0.2947s/iter; left time: 273776.9056s
	iters: 2700, epoch: 2 | loss: 0.8991989
	speed: 0.2947s/iter; left time: 273790.4825s
	iters: 2800, epoch: 2 | loss: 0.9652750
	speed: 0.2949s/iter; left time: 273893.4582s
	iters: 2900, epoch: 2 | loss: 0.9319488
	speed: 0.2947s/iter; left time: 273751.6680s
	iters: 3000, epoch: 2 | loss: 0.9290816
	speed: 0.2946s/iter; left time: 273602.4954s
	iters: 3100, epoch: 2 | loss: 0.9438657
	speed: 0.2946s/iter; left time: 273581.4418s
	iters: 3200, epoch: 2 | loss: 0.9068771
	speed: 0.2950s/iter; left time: 273873.6004s
	iters: 3300, epoch: 2 | loss: 0.8816904
	speed: 0.2947s/iter; left time: 273618.6772s
	iters: 3400, epoch: 2 | loss: 0.9024392
	speed: 0.2949s/iter; left time: 273792.8678s
	iters: 3500, epoch: 2 | loss: 0.8631353
	speed: 0.2947s/iter; left time: 273514.6745s
	iters: 3600, epoch: 2 | loss: 1.0081410
	speed: 0.2954s/iter; left time: 274156.2242s
	iters: 3700, epoch: 2 | loss: 0.9042385
	speed: 0.2946s/iter; left time: 273417.7492s
	iters: 3800, epoch: 2 | loss: 0.9253668
	speed: 0.2950s/iter; left time: 273733.2555s
	iters: 3900, epoch: 2 | loss: 0.8807784
	speed: 0.2943s/iter; left time: 273070.7964s
	iters: 4000, epoch: 2 | loss: 0.9472461
	speed: 0.2948s/iter; left time: 273474.4792s
	iters: 4100, epoch: 2 | loss: 0.8838653
	speed: 0.2948s/iter; left time: 273471.9607s
	iters: 4200, epoch: 2 | loss: 0.9057726
	speed: 0.2950s/iter; left time: 273623.0165s
	iters: 4300, epoch: 2 | loss: 0.9574223
	speed: 0.2946s/iter; left time: 273183.5951s
	iters: 4400, epoch: 2 | loss: 0.9057997
	speed: 0.2948s/iter; left time: 273330.5642s
	iters: 4500, epoch: 2 | loss: 0.9633566
	speed: 0.2946s/iter; left time: 273168.8006s
	iters: 4600, epoch: 2 | loss: 0.8798862
	speed: 0.2951s/iter; left time: 273547.7838s
Epoch: 2 cost time: 1381.262773990631
Epoch: 2, Steps: 4682 | Train Loss: 0.9490962 Vali Loss: 1.0191386 Test Loss: 1.0229576
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.8618284
	speed: 5.6458s/iter; left time: 5233271.9586s
	iters: 200, epoch: 3 | loss: 0.8919400
	speed: 0.3000s/iter; left time: 278042.0931s
	iters: 300, epoch: 3 | loss: 0.8907224
	speed: 0.3001s/iter; left time: 278069.2895s
	iters: 400, epoch: 3 | loss: 1.0032691
	speed: 0.2995s/iter; left time: 277491.5344s
	iters: 500, epoch: 3 | loss: 0.9855729
	speed: 0.2998s/iter; left time: 277817.7843s
	iters: 600, epoch: 3 | loss: 0.9374823
	speed: 0.2995s/iter; left time: 277482.8156s
	iters: 700, epoch: 3 | loss: 0.8722875
	speed: 0.2997s/iter; left time: 277605.6566s
	iters: 800, epoch: 3 | loss: 0.9476859
	speed: 0.2993s/iter; left time: 277229.9714s
	iters: 900, epoch: 3 | loss: 0.8897720
	speed: 0.2999s/iter; left time: 277704.4373s
	iters: 1000, epoch: 3 | loss: 0.9300222
	speed: 0.2992s/iter; left time: 277108.8775s
	iters: 1100, epoch: 3 | loss: 0.8665095
	speed: 0.2997s/iter; left time: 277526.9891s
	iters: 1200, epoch: 3 | loss: 0.8452414
	speed: 0.2993s/iter; left time: 277078.8021s
	iters: 1300, epoch: 3 | loss: 0.9121465
	speed: 0.2998s/iter; left time: 277565.6983s
	iters: 1400, epoch: 3 | loss: 1.0376395
	speed: 0.2992s/iter; left time: 276945.3299s
	iters: 1500, epoch: 3 | loss: 0.9507474
	speed: 0.2989s/iter; left time: 276640.5388s
	iters: 1600, epoch: 3 | loss: 0.9214995
	speed: 0.2994s/iter; left time: 277085.2840s
	iters: 1700, epoch: 3 | loss: 0.8673988
	speed: 0.2991s/iter; left time: 276807.2233s
	iters: 1800, epoch: 3 | loss: 0.9125472
	speed: 0.2992s/iter; left time: 276847.1247s
	iters: 1900, epoch: 3 | loss: 0.8597688
	speed: 0.2992s/iter; left time: 276759.5482s
	iters: 2000, epoch: 3 | loss: 0.8364189
	speed: 0.2993s/iter; left time: 276841.3327s
	iters: 2100, epoch: 3 | loss: 0.9562845
	speed: 0.2994s/iter; left time: 276966.7012s
	iters: 2200, epoch: 3 | loss: 0.8824314
	speed: 0.2992s/iter; left time: 276701.1257s
	iters: 2300, epoch: 3 | loss: 0.9024428
	speed: 0.2994s/iter; left time: 276865.1956s
	iters: 2400, epoch: 3 | loss: 0.9328594
	speed: 0.2991s/iter; left time: 276580.0026s
	iters: 2500, epoch: 3 | loss: 0.8731917
	speed: 0.2986s/iter; left time: 276060.6150s
	iters: 2600, epoch: 3 | loss: 0.9399090
	speed: 0.2995s/iter; left time: 276835.6628s
	iters: 2700, epoch: 3 | loss: 0.8729547
	speed: 0.2988s/iter; left time: 276169.0786s
	iters: 2800, epoch: 3 | loss: 0.8899751
	speed: 0.2991s/iter; left time: 276455.7480s
	iters: 2900, epoch: 3 | loss: 0.9976602
	speed: 0.2989s/iter; left time: 276265.4372s
	iters: 3000, epoch: 3 | loss: 0.8774273
	speed: 0.2992s/iter; left time: 276506.1510s
	iters: 3100, epoch: 3 | loss: 0.9094225
	speed: 0.2993s/iter; left time: 276525.6281s
	iters: 3200, epoch: 3 | loss: 0.9903360
	speed: 0.2992s/iter; left time: 276421.4847s
	iters: 3300, epoch: 3 | loss: 1.0270566
	speed: 0.2990s/iter; left time: 276167.3699s
	iters: 3400, epoch: 3 | loss: 0.9583275
	speed: 0.2993s/iter; left time: 276487.4983s
	iters: 3500, epoch: 3 | loss: 0.9002503
	speed: 0.2989s/iter; left time: 276032.0188s
	iters: 3600, epoch: 3 | loss: 0.8492506
	speed: 0.2992s/iter; left time: 276305.4421s
	iters: 3700, epoch: 3 | loss: 0.9192800
	speed: 0.2990s/iter; left time: 276080.3990s
	iters: 3800, epoch: 3 | loss: 0.8416087
	speed: 0.2991s/iter; left time: 276102.1139s
	iters: 3900, epoch: 3 | loss: 0.9002007
	speed: 0.2994s/iter; left time: 276400.6880s
	iters: 4000, epoch: 3 | loss: 0.9071417
	speed: 0.2991s/iter; left time: 276036.0632s
	iters: 4100, epoch: 3 | loss: 0.8269305
	speed: 0.2991s/iter; left time: 276080.8303s
	iters: 4200, epoch: 3 | loss: 0.8544236
	speed: 0.2995s/iter; left time: 276370.4807s
	iters: 4300, epoch: 3 | loss: 0.8907473
	speed: 0.2991s/iter; left time: 275983.7670s
	iters: 4400, epoch: 3 | loss: 0.9122162
	speed: 0.2987s/iter; left time: 275563.1776s
	iters: 4500, epoch: 3 | loss: 0.8025008
	speed: 0.2997s/iter; left time: 276461.8097s
	iters: 4600, epoch: 3 | loss: 0.9641759
	speed: 0.2996s/iter; left time: 276340.7267s
Epoch: 3 cost time: 1401.655475616455
Epoch: 3, Steps: 4682 | Train Loss: 0.9175617 Vali Loss: 1.0062217 Test Loss: 1.0143670
Validation loss decreased (1.008531 --> 1.006222).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8534818
	speed: 5.6495s/iter; left time: 5210301.6750s
	iters: 200, epoch: 4 | loss: 0.9136016
	speed: 0.2953s/iter; left time: 272334.0735s
	iters: 300, epoch: 4 | loss: 0.8739433
	speed: 0.2954s/iter; left time: 272405.3069s
	iters: 400, epoch: 4 | loss: 0.8801897
	speed: 0.2952s/iter; left time: 272154.0027s
	iters: 500, epoch: 4 | loss: 0.9929916
	speed: 0.2950s/iter; left time: 271928.0090s
	iters: 600, epoch: 4 | loss: 0.9071681
	speed: 0.2951s/iter; left time: 272003.7404s
	iters: 700, epoch: 4 | loss: 0.8755707
	speed: 0.2948s/iter; left time: 271689.2441s
	iters: 800, epoch: 4 | loss: 0.8635641
	speed: 0.2950s/iter; left time: 271829.4589s
	iters: 900, epoch: 4 | loss: 0.8750035
	speed: 0.2954s/iter; left time: 272189.5155s
	iters: 1000, epoch: 4 | loss: 0.9325042
	speed: 0.2943s/iter; left time: 271199.6114s
	iters: 1100, epoch: 4 | loss: 0.9686099
	speed: 0.2944s/iter; left time: 271254.2124s
	iters: 1200, epoch: 4 | loss: 0.8671076
	speed: 0.2947s/iter; left time: 271467.0889s
	iters: 1300, epoch: 4 | loss: 0.8502662
	speed: 0.2944s/iter; left time: 271162.6068s
	iters: 1400, epoch: 4 | loss: 0.8233483
	speed: 0.2945s/iter; left time: 271232.3803s
	iters: 1500, epoch: 4 | loss: 0.8719624
	speed: 0.2950s/iter; left time: 271621.8043s
	iters: 1600, epoch: 4 | loss: 0.9437123
	speed: 0.2949s/iter; left time: 271508.6861s
	iters: 1700, epoch: 4 | loss: 0.8922591
	speed: 0.2945s/iter; left time: 271144.9288s
	iters: 1800, epoch: 4 | loss: 0.8804343
	speed: 0.2947s/iter; left time: 271279.2801s
	iters: 1900, epoch: 4 | loss: 0.9382762
	speed: 0.2954s/iter; left time: 271892.0770s
	iters: 2000, epoch: 4 | loss: 0.8305534
	speed: 0.2947s/iter; left time: 271252.4642s
	iters: 2100, epoch: 4 | loss: 0.8990344
	speed: 0.2944s/iter; left time: 270953.0521s
	iters: 2200, epoch: 4 | loss: 0.8601720
	speed: 0.2943s/iter; left time: 270827.8837s
	iters: 2300, epoch: 4 | loss: 0.8104957
	speed: 0.2944s/iter; left time: 270839.8854s
	iters: 2400, epoch: 4 | loss: 0.8712249
	speed: 0.2944s/iter; left time: 270811.8584s
	iters: 2500, epoch: 4 | loss: 0.8749475
	speed: 0.2943s/iter; left time: 270744.5547s
	iters: 2600, epoch: 4 | loss: 0.8506802
	speed: 0.2948s/iter; left time: 271149.2037s
	iters: 2700, epoch: 4 | loss: 0.8602351
	speed: 0.2946s/iter; left time: 270949.8997s
	iters: 2800, epoch: 4 | loss: 0.9035846
	speed: 0.2944s/iter; left time: 270740.0236s
	iters: 2900, epoch: 4 | loss: 0.8354453
	speed: 0.2948s/iter; left time: 271012.1247s
	iters: 3000, epoch: 4 | loss: 0.9249660
	speed: 0.2947s/iter; left time: 270963.2334s
	iters: 3100, epoch: 4 | loss: 0.9384907
	speed: 0.2942s/iter; left time: 270456.0124s
	iters: 3200, epoch: 4 | loss: 0.8805270
	speed: 0.2947s/iter; left time: 270835.5833s
	iters: 3300, epoch: 4 | loss: 0.8352903
	speed: 0.2946s/iter; left time: 270754.7274s
	iters: 3400, epoch: 4 | loss: 0.8732994
	speed: 0.2942s/iter; left time: 270382.3646s
	iters: 3500, epoch: 4 | loss: 0.8734226
	speed: 0.2944s/iter; left time: 270499.8669s
	iters: 3600, epoch: 4 | loss: 0.8588310
	speed: 0.2949s/iter; left time: 270967.2515s
	iters: 3700, epoch: 4 | loss: 0.8048329
	speed: 0.2949s/iter; left time: 270949.2004s
	iters: 3800, epoch: 4 | loss: 0.8262499
	speed: 0.2948s/iter; left time: 270749.7662s
	iters: 3900, epoch: 4 | loss: 0.9362379
	speed: 0.2948s/iter; left time: 270716.7432s
	iters: 4000, epoch: 4 | loss: 0.8120486
	speed: 0.2951s/iter; left time: 271035.8344s
	iters: 4100, epoch: 4 | loss: 0.8820619
	speed: 0.2946s/iter; left time: 270473.8901s
	iters: 4200, epoch: 4 | loss: 0.9009496
	speed: 0.2946s/iter; left time: 270468.6393s
	iters: 4300, epoch: 4 | loss: 0.8229871
	speed: 0.2945s/iter; left time: 270400.7262s
	iters: 4400, epoch: 4 | loss: 0.8601163
	speed: 0.2946s/iter; left time: 270420.0187s
	iters: 4500, epoch: 4 | loss: 0.9257848
	speed: 0.2944s/iter; left time: 270195.7343s
	iters: 4600, epoch: 4 | loss: 0.8057005
	speed: 0.2946s/iter; left time: 270380.9052s
Epoch: 4 cost time: 1380.0638046264648
Epoch: 4, Steps: 4682 | Train Loss: 0.8920457 Vali Loss: 0.9957794 Test Loss: 1.0143644
Validation loss decreased (1.006222 --> 0.995779).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.9412113
	speed: 5.6590s/iter; left time: 5192549.0491s
	iters: 200, epoch: 5 | loss: 0.9111797
	speed: 0.3039s/iter; left time: 278804.6702s
	iters: 300, epoch: 5 | loss: 0.8277383
	speed: 0.3002s/iter; left time: 275385.3024s
	iters: 400, epoch: 5 | loss: 0.9145177
	speed: 0.2995s/iter; left time: 274691.0414s
	iters: 500, epoch: 5 | loss: 0.8518053
	speed: 0.2996s/iter; left time: 274801.3746s
	iters: 600, epoch: 5 | loss: 0.8633204
	speed: 0.2990s/iter; left time: 274190.4540s
	iters: 700, epoch: 5 | loss: 0.9135566
	speed: 0.2995s/iter; left time: 274593.9765s
	iters: 800, epoch: 5 | loss: 0.8860443
	speed: 0.2993s/iter; left time: 274404.4859s
	iters: 900, epoch: 5 | loss: 0.8615587
	speed: 0.3002s/iter; left time: 275184.8396s
	iters: 1000, epoch: 5 | loss: 0.8078936
	speed: 0.2987s/iter; left time: 273819.3857s
	iters: 1100, epoch: 5 | loss: 0.9349017
	speed: 0.2987s/iter; left time: 273768.9709s
	iters: 1200, epoch: 5 | loss: 0.8687661
	speed: 0.2989s/iter; left time: 273908.0146s
	iters: 1300, epoch: 5 | loss: 0.8562016
	speed: 0.2996s/iter; left time: 274510.2042s
	iters: 1400, epoch: 5 | loss: 0.8815142
	speed: 0.2994s/iter; left time: 274320.5869s
	iters: 1500, epoch: 5 | loss: 0.8315231
	speed: 0.2983s/iter; left time: 273275.8428s
	iters: 1600, epoch: 5 | loss: 0.9199106
	speed: 0.2989s/iter; left time: 273772.3823s
	iters: 1700, epoch: 5 | loss: 0.8649536
	speed: 0.2990s/iter; left time: 273881.9640s
	iters: 1800, epoch: 5 | loss: 0.9327405
	speed: 0.2989s/iter; left time: 273727.0211s
	iters: 1900, epoch: 5 | loss: 0.8696401
	speed: 0.2992s/iter; left time: 273988.9702s
	iters: 2000, epoch: 5 | loss: 0.8836596
	speed: 0.2989s/iter; left time: 273732.4136s
	iters: 2100, epoch: 5 | loss: 0.8842677
	speed: 0.2986s/iter; left time: 273355.2185s
	iters: 2200, epoch: 5 | loss: 0.8717524
	speed: 0.2986s/iter; left time: 273402.3861s
	iters: 2300, epoch: 5 | loss: 0.9123297
	speed: 0.2985s/iter; left time: 273247.9272s
	iters: 2400, epoch: 5 | loss: 0.8946820
	speed: 0.2986s/iter; left time: 273287.2797s
	iters: 2500, epoch: 5 | loss: 0.8365861
	speed: 0.2980s/iter; left time: 272697.7878s
	iters: 2600, epoch: 5 | loss: 0.8779358
	speed: 0.2990s/iter; left time: 273610.4582s
	iters: 2700, epoch: 5 | loss: 0.8317578
	speed: 0.2941s/iter; left time: 269111.4786s
	iters: 2800, epoch: 5 | loss: 0.8585677
	speed: 0.2935s/iter; left time: 268541.6437s
	iters: 2900, epoch: 5 | loss: 0.9032870
	speed: 0.2942s/iter; left time: 269093.1513s
	iters: 3000, epoch: 5 | loss: 0.8831392
	speed: 0.2991s/iter; left time: 273539.2519s
	iters: 3100, epoch: 5 | loss: 0.8777820
	speed: 0.2986s/iter; left time: 273072.0445s
	iters: 3200, epoch: 5 | loss: 0.8693530
	speed: 0.2988s/iter; left time: 273243.6788s
	iters: 3300, epoch: 5 | loss: 0.7585492
	speed: 0.2996s/iter; left time: 273927.5489s
	iters: 3400, epoch: 5 | loss: 0.7846155
	speed: 0.2991s/iter; left time: 273467.8200s
	iters: 3500, epoch: 5 | loss: 0.8202387
	speed: 0.2986s/iter; left time: 272992.1785s
	iters: 3600, epoch: 5 | loss: 0.8750876
	speed: 0.2984s/iter; left time: 272800.5694s
	iters: 3700, epoch: 5 | loss: 0.9091865
	speed: 0.2993s/iter; left time: 273544.1724s
	iters: 3800, epoch: 5 | loss: 0.8866786
	speed: 0.3010s/iter; left time: 275115.9740s
	iters: 3900, epoch: 5 | loss: 0.8919925
	speed: 0.3001s/iter; left time: 274242.1091s
	iters: 4000, epoch: 5 | loss: 0.9091067
	speed: 0.2990s/iter; left time: 273207.2036s
	iters: 4100, epoch: 5 | loss: 0.9311733
	speed: 0.2990s/iter; left time: 273120.6855s
	iters: 4200, epoch: 5 | loss: 0.8892435
	speed: 0.3000s/iter; left time: 274061.0197s
	iters: 4300, epoch: 5 | loss: 0.8266945
	speed: 0.2996s/iter; left time: 273680.7860s
	iters: 4400, epoch: 5 | loss: 0.8942512
	speed: 0.2996s/iter; left time: 273631.0535s
	iters: 4500, epoch: 5 | loss: 0.8667194
	speed: 0.2995s/iter; left time: 273540.4729s
	iters: 4600, epoch: 5 | loss: 0.8955868
	speed: 0.3000s/iter; left time: 273964.1630s
Epoch: 5 cost time: 1400.3260304927826
Epoch: 5, Steps: 4682 | Train Loss: 0.8751268 Vali Loss: 1.0058712 Test Loss: 1.0224093
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.8992097
	speed: 5.6592s/iter; left time: 5166228.3057s
	iters: 200, epoch: 6 | loss: 0.9372415
	speed: 0.2961s/iter; left time: 270279.1965s
	iters: 300, epoch: 6 | loss: 0.9248821
	speed: 0.2958s/iter; left time: 269954.7088s
	iters: 400, epoch: 6 | loss: 0.8380657
	speed: 0.2957s/iter; left time: 269864.9182s
	iters: 500, epoch: 6 | loss: 0.8594827
	speed: 0.2956s/iter; left time: 269693.1357s
	iters: 600, epoch: 6 | loss: 0.8661028
	speed: 0.2961s/iter; left time: 270120.6147s
	iters: 700, epoch: 6 | loss: 0.8487282
	speed: 0.2963s/iter; left time: 270327.0933s
	iters: 800, epoch: 6 | loss: 0.8684613
	speed: 0.2957s/iter; left time: 269733.6189s
	iters: 900, epoch: 6 | loss: 0.8206443
	speed: 0.2957s/iter; left time: 269719.0254s
	iters: 1000, epoch: 6 | loss: 0.8414427
	speed: 0.2960s/iter; left time: 269922.4797s
	iters: 1100, epoch: 6 | loss: 0.8529155
	speed: 0.2957s/iter; left time: 269658.1866s
	iters: 1200, epoch: 6 | loss: 0.8970714
	speed: 0.2950s/iter; left time: 268971.5386s
	iters: 1300, epoch: 6 | loss: 0.8808245
	speed: 0.2960s/iter; left time: 269905.0122s
	iters: 1400, epoch: 6 | loss: 0.8436092
	speed: 0.2960s/iter; left time: 269789.1276s
	iters: 1500, epoch: 6 | loss: 0.8795217
	speed: 0.2957s/iter; left time: 269508.9968s
	iters: 1600, epoch: 6 | loss: 0.8707126
	speed: 0.2954s/iter; left time: 269231.0417s
	iters: 1700, epoch: 6 | loss: 0.8286198
	speed: 0.2958s/iter; left time: 269581.6952s
	iters: 1800, epoch: 6 | loss: 0.8677648
	speed: 0.2955s/iter; left time: 269219.5044s
	iters: 1900, epoch: 6 | loss: 0.8958488
	speed: 0.2958s/iter; left time: 269481.9405s
	iters: 2000, epoch: 6 | loss: 0.8217639
	speed: 0.2956s/iter; left time: 269282.8098s
	iters: 2100, epoch: 6 | loss: 0.8824982
	speed: 0.2958s/iter; left time: 269404.5595s
	iters: 2200, epoch: 6 | loss: 0.8294618
	speed: 0.2954s/iter; left time: 269058.3101s
	iters: 2300, epoch: 6 | loss: 0.8931546
	speed: 0.2960s/iter; left time: 269600.5802s
	iters: 2400, epoch: 6 | loss: 0.7947838
	speed: 0.2956s/iter; left time: 269193.0106s
	iters: 2500, epoch: 6 | loss: 0.8381130
	speed: 0.2953s/iter; left time: 268885.7382s
	iters: 2600, epoch: 6 | loss: 0.8448726
	speed: 0.2953s/iter; left time: 268848.4444s
	iters: 2700, epoch: 6 | loss: 0.8676502
	speed: 0.2958s/iter; left time: 269258.9118s
	iters: 2800, epoch: 6 | loss: 0.8522748
	speed: 0.2954s/iter; left time: 268906.3334s
	iters: 2900, epoch: 6 | loss: 0.8531544
	speed: 0.2952s/iter; left time: 268684.0135s
	iters: 3000, epoch: 6 | loss: 0.8641109
	speed: 0.2948s/iter; left time: 268230.9156s
	iters: 3100, epoch: 6 | loss: 0.7927170
	speed: 0.2961s/iter; left time: 269440.2788s
	iters: 3200, epoch: 6 | loss: 0.8509572
	speed: 0.2948s/iter; left time: 268195.5891s
	iters: 3300, epoch: 6 | loss: 0.8204283
	speed: 0.2952s/iter; left time: 268569.4208s
	iters: 3400, epoch: 6 | loss: 0.8546342
	speed: 0.2957s/iter; left time: 268980.0783s
	iters: 3500, epoch: 6 | loss: 0.8663282
	speed: 0.2954s/iter; left time: 268674.1860s
	iters: 3600, epoch: 6 | loss: 0.8385683
	speed: 0.2952s/iter; left time: 268418.1634s
	iters: 3700, epoch: 6 | loss: 0.8613216
	speed: 0.2957s/iter; left time: 268900.6684s
	iters: 3800, epoch: 6 | loss: 0.7816871
	speed: 0.2954s/iter; left time: 268609.6216s
	iters: 3900, epoch: 6 | loss: 0.8792548
	speed: 0.2959s/iter; left time: 269025.6605s
	iters: 4000, epoch: 6 | loss: 0.8410165
	speed: 0.2948s/iter; left time: 267938.0498s
	iters: 4100, epoch: 6 | loss: 0.8972201
	speed: 0.2953s/iter; left time: 268418.6141s
	iters: 4200, epoch: 6 | loss: 0.8993281
	speed: 0.2950s/iter; left time: 268067.2533s
	iters: 4300, epoch: 6 | loss: 0.8345764
	speed: 0.2952s/iter; left time: 268242.9746s
	iters: 4400, epoch: 6 | loss: 0.8065072
	speed: 0.2958s/iter; left time: 268746.0079s
	iters: 4500, epoch: 6 | loss: 0.8326361
	speed: 0.2958s/iter; left time: 268741.3820s
	iters: 4600, epoch: 6 | loss: 0.9152190
	speed: 0.2946s/iter; left time: 267577.0637s
Epoch: 6 cost time: 1383.9917423725128
Epoch: 6, Steps: 4682 | Train Loss: 0.8579724 Vali Loss: 1.0500027 Test Loss: 1.0480139
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 0.8311283
	speed: 5.6534s/iter; left time: 5134443.9645s
	iters: 200, epoch: 7 | loss: 0.7614720
	speed: 0.2954s/iter; left time: 268286.9264s
	iters: 300, epoch: 7 | loss: 0.8430411
	speed: 0.2958s/iter; left time: 268595.1621s
	iters: 400, epoch: 7 | loss: 0.9017029
	speed: 0.2964s/iter; left time: 269144.0208s
	iters: 500, epoch: 7 | loss: 0.8654541
	speed: 0.2958s/iter; left time: 268492.0356s
	iters: 600, epoch: 7 | loss: 0.8109151
	speed: 0.2960s/iter; left time: 268712.5507s
	iters: 700, epoch: 7 | loss: 0.8080410
	speed: 0.2956s/iter; left time: 268286.7487s
	iters: 800, epoch: 7 | loss: 0.8163179
	speed: 0.2967s/iter; left time: 269269.8969s
	iters: 900, epoch: 7 | loss: 0.8466704
	speed: 0.2961s/iter; left time: 268645.3771s
	iters: 1000, epoch: 7 | loss: 0.8537419
	speed: 0.2963s/iter; left time: 268858.1939s
	iters: 1100, epoch: 7 | loss: 0.8996879
	speed: 0.2960s/iter; left time: 268497.5536s
	iters: 1200, epoch: 7 | loss: 0.8565974
	speed: 0.2957s/iter; left time: 268223.1014s
	iters: 1300, epoch: 7 | loss: 0.8140851
	speed: 0.2955s/iter; left time: 268026.5501s
	iters: 1400, epoch: 7 | loss: 0.8680339
	speed: 0.2962s/iter; left time: 268637.6754s
	iters: 1500, epoch: 7 | loss: 0.7851920
	speed: 0.2957s/iter; left time: 268154.8296s
	iters: 1600, epoch: 7 | loss: 0.8863104
	speed: 0.2958s/iter; left time: 268172.1621s
	iters: 1700, epoch: 7 | loss: 0.8509632
	speed: 0.2954s/iter; left time: 267837.8064s
	iters: 1800, epoch: 7 | loss: 0.7952153
	speed: 0.2957s/iter; left time: 268048.9293s
	iters: 1900, epoch: 7 | loss: 0.8300021
	speed: 0.2952s/iter; left time: 267604.2119s
	iters: 2000, epoch: 7 | loss: 0.8053690
	speed: 0.2953s/iter; left time: 267634.0544s
	iters: 2100, epoch: 7 | loss: 0.8465651
	speed: 0.2960s/iter; left time: 268232.2370s
	iters: 2200, epoch: 7 | loss: 0.8184708
	speed: 0.2957s/iter; left time: 267967.2997s
	iters: 2300, epoch: 7 | loss: 0.8282475
	speed: 0.2954s/iter; left time: 267589.9987s
	iters: 2400, epoch: 7 | loss: 0.8686067
	speed: 0.2959s/iter; left time: 268068.5027s
	iters: 2500, epoch: 7 | loss: 0.8869370
	speed: 0.2959s/iter; left time: 268034.8774s
	iters: 2600, epoch: 7 | loss: 0.8172540
	speed: 0.2951s/iter; left time: 267283.6635s
	iters: 2700, epoch: 7 | loss: 0.8479545
	speed: 0.2957s/iter; left time: 267777.1740s
	iters: 2800, epoch: 7 | loss: 0.8242515
	speed: 0.2958s/iter; left time: 267836.1223s
	iters: 2900, epoch: 7 | loss: 0.8283215
	speed: 0.2963s/iter; left time: 268272.3661s
	iters: 3000, epoch: 7 | loss: 0.8375404
	speed: 0.2952s/iter; left time: 267281.5162s
	iters: 3100, epoch: 7 | loss: 0.7893870
	speed: 0.2952s/iter; left time: 267232.7241s
	iters: 3200, epoch: 7 | loss: 0.7948631
	speed: 0.2954s/iter; left time: 267384.8434s
	iters: 3300, epoch: 7 | loss: 0.8140104
	speed: 0.2958s/iter; left time: 267738.5993s
	iters: 3400, epoch: 7 | loss: 0.8445621
	speed: 0.2954s/iter; left time: 267288.4961s
	iters: 3500, epoch: 7 | loss: 0.8506669
	speed: 0.2957s/iter; left time: 267512.7051s
	iters: 3600, epoch: 7 | loss: 0.8421641
	speed: 0.2957s/iter; left time: 267522.8799s
	iters: 3700, epoch: 7 | loss: 0.7977256
	speed: 0.2960s/iter; left time: 267775.6659s
	iters: 3800, epoch: 7 | loss: 0.8643166
	speed: 0.2953s/iter; left time: 267128.8780s
	iters: 3900, epoch: 7 | loss: 0.8797331
	speed: 0.2954s/iter; left time: 267157.9634s
	iters: 4000, epoch: 7 | loss: 0.7832926
	speed: 0.2955s/iter; left time: 267190.0521s
	iters: 4100, epoch: 7 | loss: 0.8861640
	speed: 0.2963s/iter; left time: 267930.5864s
	iters: 4200, epoch: 7 | loss: 0.8228377
	speed: 0.2954s/iter; left time: 267082.6749s
	iters: 4300, epoch: 7 | loss: 0.9009247
	speed: 0.2956s/iter; left time: 267227.5945s
	iters: 4400, epoch: 7 | loss: 0.7586758
	speed: 0.2952s/iter; left time: 266855.8970s
	iters: 4500, epoch: 7 | loss: 0.8355976
	speed: 0.2957s/iter; left time: 267215.5208s
	iters: 4600, epoch: 7 | loss: 0.7889428
	speed: 0.2955s/iter; left time: 267066.9454s
Epoch: 7 cost time: 1384.7779829502106
Epoch: 7, Steps: 4682 | Train Loss: 0.8382676 Vali Loss: 1.0933806 Test Loss: 1.0897837
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 8 | loss: 0.8601168
	speed: 5.6513s/iter; left time: 5106112.3125s
	iters: 200, epoch: 8 | loss: 0.7953844
	speed: 0.2968s/iter; left time: 268120.6437s
	iters: 300, epoch: 8 | loss: 0.8071718
	speed: 0.2963s/iter; left time: 267689.7722s
	iters: 400, epoch: 8 | loss: 0.8002497
	speed: 0.2961s/iter; left time: 267433.4070s
	iters: 500, epoch: 8 | loss: 0.7905762
	speed: 0.2963s/iter; left time: 267556.6298s
	iters: 600, epoch: 8 | loss: 0.8340967
	speed: 0.2958s/iter; left time: 267132.7067s
	iters: 700, epoch: 8 | loss: 0.8099002
	speed: 0.2953s/iter; left time: 266595.6085s
	iters: 800, epoch: 8 | loss: 0.7816746
	speed: 0.3022s/iter; left time: 272809.1160s
	iters: 900, epoch: 8 | loss: 0.7979519
	speed: 0.3050s/iter; left time: 275336.7476s
	iters: 1000, epoch: 8 | loss: 0.8177695
	speed: 0.3039s/iter; left time: 274307.8405s
	iters: 1100, epoch: 8 | loss: 0.8448554
	speed: 0.3040s/iter; left time: 274409.5082s
	iters: 1200, epoch: 8 | loss: 0.7913822
	speed: 0.3046s/iter; left time: 274889.0369s
	iters: 1300, epoch: 8 | loss: 0.8699701
	speed: 0.3046s/iter; left time: 274885.9190s
	iters: 1400, epoch: 8 | loss: 0.8221840
	speed: 0.3036s/iter; left time: 273895.8983s
	iters: 1500, epoch: 8 | loss: 0.8018017
	speed: 0.3032s/iter; left time: 273534.6104s
	iters: 1600, epoch: 8 | loss: 0.8073600
	speed: 0.3039s/iter; left time: 274120.6254s
	iters: 1700, epoch: 8 | loss: 0.7872501
	speed: 0.3043s/iter; left time: 274499.8778s
	iters: 1800, epoch: 8 | loss: 0.8486296
	speed: 0.3047s/iter; left time: 274772.9436s
	iters: 1900, epoch: 8 | loss: 0.8892990
	speed: 0.3041s/iter; left time: 274214.2699s
	iters: 2000, epoch: 8 | loss: 0.8251814
	speed: 0.2953s/iter; left time: 266256.1322s
	iters: 2100, epoch: 8 | loss: 0.8591962
	speed: 0.2941s/iter; left time: 265167.1713s
	iters: 2200, epoch: 8 | loss: 0.7971799
	speed: 0.2937s/iter; left time: 264713.5831s
	iters: 2300, epoch: 8 | loss: 0.8494706
	speed: 0.2938s/iter; left time: 264849.6267s
	iters: 2400, epoch: 8 | loss: 0.8485111
	speed: 0.2988s/iter; left time: 269321.4052s
	iters: 2500, epoch: 8 | loss: 0.8563772
	speed: 0.3044s/iter; left time: 274264.9286s
	iters: 2600, epoch: 8 | loss: 0.8719380
	speed: 0.3039s/iter; left time: 273791.7305s
	iters: 2700, epoch: 8 | loss: 0.8240177
	speed: 0.3045s/iter; left time: 274310.7986s
	iters: 2800, epoch: 8 | loss: 0.8070951
	speed: 0.3002s/iter; left time: 270473.1165s
	iters: 2900, epoch: 8 | loss: 0.7900558
	speed: 0.2987s/iter; left time: 269010.1653s
	iters: 3000, epoch: 8 | loss: 0.7862987
	speed: 0.3037s/iter; left time: 273565.2258s
	iters: 3100, epoch: 8 | loss: 0.8071600
	speed: 0.3027s/iter; left time: 272577.4607s
	iters: 3200, epoch: 8 | loss: 0.8813897
	speed: 0.2961s/iter; left time: 266629.3316s
	iters: 3300, epoch: 8 | loss: 0.8687662
	speed: 0.2988s/iter; left time: 269040.1143s
	iters: 3400, epoch: 8 | loss: 0.7795829
	speed: 0.2985s/iter; left time: 268704.7520s
	iters: 3500, epoch: 8 | loss: 0.8823809
	speed: 0.3041s/iter; left time: 273773.4507s
	iters: 3600, epoch: 8 | loss: 0.8017144
	speed: 0.3039s/iter; left time: 273477.6565s
	iters: 3700, epoch: 8 | loss: 0.8068459
	speed: 0.3038s/iter; left time: 273397.6670s
	iters: 3800, epoch: 8 | loss: 0.8113359
	speed: 0.3043s/iter; left time: 273824.2068s
	iters: 3900, epoch: 8 | loss: 0.7887980
	speed: 0.3004s/iter; left time: 270297.3158s
	iters: 4000, epoch: 8 | loss: 0.7704570
	speed: 0.2938s/iter; left time: 264285.7282s
	iters: 4100, epoch: 8 | loss: 0.7876988
	speed: 0.2940s/iter; left time: 264449.0147s
	iters: 4200, epoch: 8 | loss: 0.8317142
	speed: 0.2938s/iter; left time: 264278.4458s
	iters: 4300, epoch: 8 | loss: 0.7950574
	speed: 0.2990s/iter; left time: 268936.3396s
	iters: 4400, epoch: 8 | loss: 0.7416441
	speed: 0.2965s/iter; left time: 266586.6622s
	iters: 4500, epoch: 8 | loss: 0.7366813
	speed: 0.2960s/iter; left time: 266119.8799s
	iters: 4600, epoch: 8 | loss: 0.8160841
	speed: 0.2959s/iter; left time: 266020.6546s
Epoch: 8 cost time: 1403.802918434143
Epoch: 8, Steps: 4682 | Train Loss: 0.8232505 Vali Loss: 1.1135874 Test Loss: 1.0637418
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 9 | loss: 0.8063534
	speed: 5.6420s/iter; left time: 5071318.0379s
	iters: 200, epoch: 9 | loss: 0.8250123
	speed: 0.2960s/iter; left time: 266061.3550s
	iters: 300, epoch: 9 | loss: 0.8551986
	speed: 0.2968s/iter; left time: 266711.3361s
	iters: 400, epoch: 9 | loss: 0.8579019
	speed: 0.2957s/iter; left time: 265709.7090s
	iters: 500, epoch: 9 | loss: 0.8616506
	speed: 0.2965s/iter; left time: 266393.3174s
	iters: 600, epoch: 9 | loss: 0.8415309
	speed: 0.2957s/iter; left time: 265616.4133s
	iters: 700, epoch: 9 | loss: 0.8717923
	speed: 0.2956s/iter; left time: 265481.7286s
	iters: 800, epoch: 9 | loss: 0.8620805
	speed: 0.2957s/iter; left time: 265566.4972s
	iters: 900, epoch: 9 | loss: 0.8022071
	speed: 0.2953s/iter; left time: 265230.8770s
	iters: 1000, epoch: 9 | loss: 0.8266726
	speed: 0.2959s/iter; left time: 265739.1009s
	iters: 1100, epoch: 9 | loss: 0.8334147
	speed: 0.2956s/iter; left time: 265388.0035s
	iters: 1200, epoch: 9 | loss: 0.8408396
	speed: 0.2967s/iter; left time: 266320.7713s
	iters: 1300, epoch: 9 | loss: 0.8409799
	speed: 0.2957s/iter; left time: 265451.4577s
	iters: 1400, epoch: 9 | loss: 0.8182838
	speed: 0.2951s/iter; left time: 264843.9890s
	iters: 1500, epoch: 9 | loss: 0.8407339
	speed: 0.2952s/iter; left time: 264933.6079s
	iters: 1600, epoch: 9 | loss: 0.7148283
	speed: 0.2961s/iter; left time: 265717.1480s
	iters: 1700, epoch: 9 | loss: 0.7762321
	speed: 0.2950s/iter; left time: 264648.3287s
	iters: 1800, epoch: 9 | loss: 0.8278020
	speed: 0.2954s/iter; left time: 264976.6897s
	iters: 1900, epoch: 9 | loss: 0.8080284
	speed: 0.2952s/iter; left time: 264787.7616s
	iters: 2000, epoch: 9 | loss: 0.8004690
	speed: 0.2954s/iter; left time: 264987.2263s
	iters: 2100, epoch: 9 | loss: 0.8253294
	speed: 0.2954s/iter; left time: 264935.9648s
	iters: 2200, epoch: 9 | loss: 0.7365042
	speed: 0.2953s/iter; left time: 264783.8071s
	iters: 2300, epoch: 9 | loss: 0.7883165
	speed: 0.2948s/iter; left time: 264328.4065s
	iters: 2400, epoch: 9 | loss: 0.8123580
	speed: 0.2954s/iter; left time: 264818.0473s
	iters: 2500, epoch: 9 | loss: 0.7952562
	speed: 0.2966s/iter; left time: 265858.2710s
	iters: 2600, epoch: 9 | loss: 0.8372431
	speed: 0.2958s/iter; left time: 265176.2787s
	iters: 2700, epoch: 9 | loss: 0.8201029
	speed: 0.2949s/iter; left time: 264326.5658s
	iters: 2800, epoch: 9 | loss: 0.8742957
	speed: 0.2953s/iter; left time: 264650.5547s
	iters: 2900, epoch: 9 | loss: 0.8612605
	speed: 0.2954s/iter; left time: 264693.5256s
	iters: 3000, epoch: 9 | loss: 0.7396631
	speed: 0.2951s/iter; left time: 264420.6837s
	iters: 3100, epoch: 9 | loss: 0.8383107
	speed: 0.2961s/iter; left time: 265247.2857s
	iters: 3200, epoch: 9 | loss: 0.8127887
	speed: 0.2960s/iter; left time: 265168.2224s
	iters: 3300, epoch: 9 | loss: 0.7996067
	speed: 0.2957s/iter; left time: 264872.4928s
	iters: 3400, epoch: 9 | loss: 0.8100607
	speed: 0.2953s/iter; left time: 264455.5549s
	iters: 3500, epoch: 9 | loss: 0.8764074
	speed: 0.2953s/iter; left time: 264405.4891s
	iters: 3600, epoch: 9 | loss: 0.8299019
	speed: 0.2958s/iter; left time: 264850.8483s
	iters: 3700, epoch: 9 | loss: 0.9029360
	speed: 0.2964s/iter; left time: 265338.1773s
	iters: 3800, epoch: 9 | loss: 0.8939949
	speed: 0.2968s/iter; left time: 265635.8918s
	iters: 3900, epoch: 9 | loss: 0.8287970
	speed: 0.2958s/iter; left time: 264717.0728s
	iters: 4000, epoch: 9 | loss: 0.8106372
	speed: 0.2948s/iter; left time: 263872.5864s
	iters: 4100, epoch: 9 | loss: 0.7821782
	speed: 0.2952s/iter; left time: 264175.3607s
	iters: 4200, epoch: 9 | loss: 0.7770622
	speed: 0.2958s/iter; left time: 264658.0997s
	iters: 4300, epoch: 9 | loss: 0.7980159
	speed: 0.2965s/iter; left time: 265252.9435s
	iters: 4400, epoch: 9 | loss: 0.8149234
	speed: 0.2958s/iter; left time: 264592.8310s
	iters: 4500, epoch: 9 | loss: 0.7848548
	speed: 0.2957s/iter; left time: 264475.3649s
	iters: 4600, epoch: 9 | loss: 0.7839038
	speed: 0.2949s/iter; left time: 263771.6851s
Epoch: 9 cost time: 1384.6075146198273
Epoch: 9, Steps: 4682 | Train Loss: 0.8097852 Vali Loss: 1.0961933 Test Loss: 1.0908685
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 352557
test shape: (35255, 1, 720, 151) (35255, 1, 720, 151)
test shape: (35255, 720, 151) (35255, 720, 151)
mse:1.0143764019012451, mae:0.7549214363098145
>>>>>>>Overall time: 18029 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
