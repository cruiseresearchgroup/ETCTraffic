Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=103, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems05_all_common_flow.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems05_all_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 600775
val 95012
test 95011
	iters: 100, epoch: 1 | loss: 1.9942021
	speed: 0.0329s/iter; left time: 1231.0058s
	iters: 200, epoch: 1 | loss: 1.3601115
	speed: 0.0299s/iter; left time: 1116.3864s
	iters: 300, epoch: 1 | loss: 1.9780155
	speed: 0.0301s/iter; left time: 1120.9988s
	iters: 400, epoch: 1 | loss: 1.4640642
	speed: 0.0301s/iter; left time: 1117.1437s
	iters: 500, epoch: 1 | loss: 1.5779793
	speed: 0.0303s/iter; left time: 1123.8404s
	iters: 600, epoch: 1 | loss: 1.3831136
	speed: 0.0301s/iter; left time: 1110.5013s
	iters: 700, epoch: 1 | loss: 1.4579713
	speed: 0.0295s/iter; left time: 1087.9553s
	iters: 800, epoch: 1 | loss: 1.6807469
	speed: 0.0296s/iter; left time: 1088.0977s
	iters: 900, epoch: 1 | loss: 1.5179667
	speed: 0.0300s/iter; left time: 1098.5013s
	iters: 1000, epoch: 1 | loss: 1.6701125
	speed: 0.0301s/iter; left time: 1100.2713s
	iters: 1100, epoch: 1 | loss: 1.5964019
	speed: 0.0295s/iter; left time: 1073.7914s
	iters: 1200, epoch: 1 | loss: 1.5348195
	speed: 0.0299s/iter; left time: 1087.6854s
	iters: 1300, epoch: 1 | loss: 2.0198362
	speed: 0.0298s/iter; left time: 1080.6902s
	iters: 1400, epoch: 1 | loss: 1.8606939
	speed: 0.0305s/iter; left time: 1102.1600s
	iters: 1500, epoch: 1 | loss: 2.0164526
	speed: 0.0304s/iter; left time: 1095.8152s
	iters: 1600, epoch: 1 | loss: 1.9247310
	speed: 0.0299s/iter; left time: 1073.8541s
	iters: 1700, epoch: 1 | loss: 2.1318288
	speed: 0.0303s/iter; left time: 1086.0034s
	iters: 1800, epoch: 1 | loss: 1.9834025
	speed: 0.0299s/iter; left time: 1067.4289s
	iters: 1900, epoch: 1 | loss: 1.5341204
	speed: 0.0304s/iter; left time: 1083.3303s
	iters: 2000, epoch: 1 | loss: 1.6512510
	speed: 0.0302s/iter; left time: 1072.4029s
	iters: 2100, epoch: 1 | loss: 1.7455305
	speed: 0.0303s/iter; left time: 1075.2521s
	iters: 2200, epoch: 1 | loss: 1.3606052
	speed: 0.0302s/iter; left time: 1068.4362s
	iters: 2300, epoch: 1 | loss: 2.2019310
	speed: 0.0297s/iter; left time: 1046.1659s
	iters: 2400, epoch: 1 | loss: 1.8655493
	speed: 0.0305s/iter; left time: 1071.3907s
	iters: 2500, epoch: 1 | loss: 1.9997008
	speed: 0.0302s/iter; left time: 1056.7411s
	iters: 2600, epoch: 1 | loss: 1.3061466
	speed: 0.0304s/iter; left time: 1062.0450s
	iters: 2700, epoch: 1 | loss: 1.7863964
	speed: 0.0292s/iter; left time: 1017.3679s
	iters: 2800, epoch: 1 | loss: 1.8142266
	speed: 0.0305s/iter; left time: 1058.2223s
	iters: 2900, epoch: 1 | loss: 1.5178007
	speed: 0.0303s/iter; left time: 1050.7250s
	iters: 3000, epoch: 1 | loss: 1.8735571
	speed: 0.0301s/iter; left time: 1039.7677s
	iters: 3100, epoch: 1 | loss: 1.5085679
	speed: 0.0302s/iter; left time: 1039.3481s
	iters: 3200, epoch: 1 | loss: 1.9761045
	speed: 0.0303s/iter; left time: 1040.8446s
	iters: 3300, epoch: 1 | loss: 1.9158466
	speed: 0.0303s/iter; left time: 1037.2375s
	iters: 3400, epoch: 1 | loss: 2.0068843
	speed: 0.0300s/iter; left time: 1024.0851s
	iters: 3500, epoch: 1 | loss: 1.7395954
	speed: 0.0302s/iter; left time: 1027.4706s
	iters: 3600, epoch: 1 | loss: 1.7542877
	speed: 0.0296s/iter; left time: 1006.1223s
	iters: 3700, epoch: 1 | loss: 1.9058635
	speed: 0.0302s/iter; left time: 1021.2987s
Epoch: 1 cost time: 113.28770589828491
Epoch: 1, Steps: 3754 | Train Loss: 1.7405453 Vali Loss: 2.0738347 Test Loss: 1.6865606
Validation loss decreased (inf --> 2.073835).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.6063778
	speed: 0.4594s/iter; left time: 15477.3990s
	iters: 200, epoch: 2 | loss: 1.3973820
	speed: 0.0304s/iter; left time: 1020.9417s
	iters: 300, epoch: 2 | loss: 1.8990514
	speed: 0.0305s/iter; left time: 1020.9224s
	iters: 400, epoch: 2 | loss: 2.1047487
	speed: 0.0303s/iter; left time: 1010.4113s
	iters: 500, epoch: 2 | loss: 2.3184297
	speed: 0.0304s/iter; left time: 1011.6158s
	iters: 600, epoch: 2 | loss: 1.5882119
	speed: 0.0302s/iter; left time: 1002.4789s
	iters: 700, epoch: 2 | loss: 2.0891774
	speed: 0.0301s/iter; left time: 994.3292s
	iters: 800, epoch: 2 | loss: 1.7768353
	speed: 0.0303s/iter; left time: 1000.8086s
	iters: 900, epoch: 2 | loss: 1.6469131
	speed: 0.0304s/iter; left time: 999.2571s
	iters: 1000, epoch: 2 | loss: 2.0064776
	speed: 0.0305s/iter; left time: 1001.4936s
	iters: 1100, epoch: 2 | loss: 2.1687145
	speed: 0.0304s/iter; left time: 994.6652s
	iters: 1200, epoch: 2 | loss: 1.8948294
	speed: 0.0296s/iter; left time: 964.8548s
	iters: 1300, epoch: 2 | loss: 1.7178092
	speed: 0.0305s/iter; left time: 990.3498s
	iters: 1400, epoch: 2 | loss: 1.4481251
	speed: 0.0306s/iter; left time: 989.4597s
	iters: 1500, epoch: 2 | loss: 2.1897707
	speed: 0.0302s/iter; left time: 974.9272s
	iters: 1600, epoch: 2 | loss: 2.5722888
	speed: 0.0304s/iter; left time: 978.2044s
	iters: 1700, epoch: 2 | loss: 1.6570563
	speed: 0.0295s/iter; left time: 946.3572s
	iters: 1800, epoch: 2 | loss: 1.8743793
	speed: 0.0302s/iter; left time: 964.6493s
	iters: 1900, epoch: 2 | loss: 1.9238846
	speed: 0.0304s/iter; left time: 969.2992s
	iters: 2000, epoch: 2 | loss: 1.4092542
	speed: 0.0306s/iter; left time: 973.2309s
	iters: 2100, epoch: 2 | loss: 1.5346408
	speed: 0.0304s/iter; left time: 962.6459s
	iters: 2200, epoch: 2 | loss: 1.8758585
	speed: 0.0300s/iter; left time: 946.8113s
	iters: 2300, epoch: 2 | loss: 1.7625808
	speed: 0.0299s/iter; left time: 942.6778s
	iters: 2400, epoch: 2 | loss: 1.6607807
	speed: 0.0297s/iter; left time: 931.6504s
	iters: 2500, epoch: 2 | loss: 1.2131479
	speed: 0.0301s/iter; left time: 940.6475s
	iters: 2600, epoch: 2 | loss: 1.8911726
	speed: 0.0294s/iter; left time: 917.8247s
	iters: 2700, epoch: 2 | loss: 2.2960684
	speed: 0.0303s/iter; left time: 942.6179s
	iters: 2800, epoch: 2 | loss: 1.8526944
	speed: 0.0302s/iter; left time: 935.3184s
	iters: 2900, epoch: 2 | loss: 1.4694350
	speed: 0.0301s/iter; left time: 929.1728s
	iters: 3000, epoch: 2 | loss: 1.8069301
	speed: 0.0304s/iter; left time: 935.8747s
	iters: 3100, epoch: 2 | loss: 1.9630321
	speed: 0.0303s/iter; left time: 929.0942s
	iters: 3200, epoch: 2 | loss: 1.8200496
	speed: 0.0304s/iter; left time: 929.3000s
	iters: 3300, epoch: 2 | loss: 2.0307992
	speed: 0.0302s/iter; left time: 920.2678s
	iters: 3400, epoch: 2 | loss: 1.5748664
	speed: 0.0305s/iter; left time: 926.3363s
	iters: 3500, epoch: 2 | loss: 1.7736936
	speed: 0.0303s/iter; left time: 917.0329s
	iters: 3600, epoch: 2 | loss: 1.5793915
	speed: 0.0304s/iter; left time: 916.6319s
	iters: 3700, epoch: 2 | loss: 1.6608790
	speed: 0.0307s/iter; left time: 922.9056s
Epoch: 2 cost time: 113.6095781326294
Epoch: 2, Steps: 3754 | Train Loss: 1.7548214 Vali Loss: 1.8879398 Test Loss: 1.7816867
Validation loss decreased (2.073835 --> 1.887940).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.5784400
	speed: 0.4562s/iter; left time: 13655.9510s
	iters: 200, epoch: 3 | loss: 1.9901853
	speed: 0.0297s/iter; left time: 885.4707s
	iters: 300, epoch: 3 | loss: 1.6310887
	speed: 0.0304s/iter; left time: 902.8596s
	iters: 400, epoch: 3 | loss: 1.2919284
	speed: 0.0299s/iter; left time: 885.4650s
	iters: 500, epoch: 3 | loss: 1.7547072
	speed: 0.0304s/iter; left time: 897.6216s
	iters: 600, epoch: 3 | loss: 1.5528097
	speed: 0.0305s/iter; left time: 898.2991s
	iters: 700, epoch: 3 | loss: 1.6947180
	speed: 0.0299s/iter; left time: 875.7833s
	iters: 800, epoch: 3 | loss: 1.8623636
	speed: 0.0302s/iter; left time: 883.2279s
	iters: 900, epoch: 3 | loss: 1.6510763
	speed: 0.0304s/iter; left time: 885.5766s
	iters: 1000, epoch: 3 | loss: 1.4598377
	speed: 0.0300s/iter; left time: 872.3046s
	iters: 1100, epoch: 3 | loss: 2.1929550
	speed: 0.0304s/iter; left time: 879.1851s
	iters: 1200, epoch: 3 | loss: 1.4880797
	speed: 0.0303s/iter; left time: 873.4758s
	iters: 1300, epoch: 3 | loss: 1.7344661
	speed: 0.0304s/iter; left time: 873.3440s
	iters: 1400, epoch: 3 | loss: 1.9629010
	speed: 0.0305s/iter; left time: 873.4862s
	iters: 1500, epoch: 3 | loss: 1.9651413
	speed: 0.0295s/iter; left time: 840.3634s
	iters: 1600, epoch: 3 | loss: 1.9673872
	speed: 0.0305s/iter; left time: 867.6079s
	iters: 1700, epoch: 3 | loss: 1.8921432
	speed: 0.0297s/iter; left time: 841.8540s
	iters: 1800, epoch: 3 | loss: 1.6151435
	speed: 0.0302s/iter; left time: 853.5775s
	iters: 1900, epoch: 3 | loss: 1.8534716
	speed: 0.0305s/iter; left time: 857.2949s
	iters: 2000, epoch: 3 | loss: 1.6298033
	speed: 0.0295s/iter; left time: 826.9191s
	iters: 2100, epoch: 3 | loss: 1.4028130
	speed: 0.0304s/iter; left time: 849.0263s
	iters: 2200, epoch: 3 | loss: 1.7821333
	speed: 0.0304s/iter; left time: 845.6380s
	iters: 2300, epoch: 3 | loss: 1.8336804
	speed: 0.0304s/iter; left time: 842.6356s
	iters: 2400, epoch: 3 | loss: 1.2912648
	speed: 0.0297s/iter; left time: 820.4245s
	iters: 2500, epoch: 3 | loss: 1.6558665
	speed: 0.0305s/iter; left time: 840.8059s
	iters: 2600, epoch: 3 | loss: 1.8855625
	speed: 0.0300s/iter; left time: 822.3609s
	iters: 2700, epoch: 3 | loss: 1.3561879
	speed: 0.0294s/iter; left time: 804.3341s
	iters: 2800, epoch: 3 | loss: 1.6657299
	speed: 0.0304s/iter; left time: 828.3851s
	iters: 2900, epoch: 3 | loss: 1.6077449
	speed: 0.0302s/iter; left time: 819.6598s
	iters: 3000, epoch: 3 | loss: 1.9279968
	speed: 0.0298s/iter; left time: 804.8644s
	iters: 3100, epoch: 3 | loss: 1.2462395
	speed: 0.0294s/iter; left time: 791.8953s
	iters: 3200, epoch: 3 | loss: 1.4694657
	speed: 0.0302s/iter; left time: 811.2419s
	iters: 3300, epoch: 3 | loss: 2.0700624
	speed: 0.0301s/iter; left time: 805.0417s
	iters: 3400, epoch: 3 | loss: 1.7695642
	speed: 0.0303s/iter; left time: 805.7714s
	iters: 3500, epoch: 3 | loss: 1.6598130
	speed: 0.0304s/iter; left time: 806.6051s
	iters: 3600, epoch: 3 | loss: 1.7103724
	speed: 0.0305s/iter; left time: 807.4602s
	iters: 3700, epoch: 3 | loss: 1.5562851
	speed: 0.0304s/iter; left time: 799.7644s
Epoch: 3 cost time: 113.32164525985718
Epoch: 3, Steps: 3754 | Train Loss: 1.6750995 Vali Loss: 1.8670944 Test Loss: 1.7270883
Validation loss decreased (1.887940 --> 1.867094).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6580777
	speed: 0.4535s/iter; left time: 11871.2567s
	iters: 200, epoch: 4 | loss: 1.8357586
	speed: 0.0304s/iter; left time: 793.1644s
	iters: 300, epoch: 4 | loss: 1.5568146
	speed: 0.0305s/iter; left time: 791.3265s
	iters: 400, epoch: 4 | loss: 1.5746217
	speed: 0.0301s/iter; left time: 779.0782s
	iters: 500, epoch: 4 | loss: 1.8074073
	speed: 0.0298s/iter; left time: 768.4279s
	iters: 600, epoch: 4 | loss: 1.6078048
	speed: 0.0301s/iter; left time: 773.6407s
	iters: 700, epoch: 4 | loss: 1.2118839
	speed: 0.0304s/iter; left time: 778.2297s
	iters: 800, epoch: 4 | loss: 2.1413913
	speed: 0.0304s/iter; left time: 775.3103s
	iters: 900, epoch: 4 | loss: 1.4950210
	speed: 0.0305s/iter; left time: 773.8675s
	iters: 1000, epoch: 4 | loss: 1.4558065
	speed: 0.0303s/iter; left time: 765.8825s
	iters: 1100, epoch: 4 | loss: 1.4872168
	speed: 0.0304s/iter; left time: 765.5272s
	iters: 1200, epoch: 4 | loss: 1.7422601
	speed: 0.0302s/iter; left time: 758.2666s
	iters: 1300, epoch: 4 | loss: 1.5222365
	speed: 0.0300s/iter; left time: 748.7846s
	iters: 1400, epoch: 4 | loss: 1.7042431
	speed: 0.0295s/iter; left time: 734.2826s
	iters: 1500, epoch: 4 | loss: 1.6688565
	speed: 0.0304s/iter; left time: 753.3043s
	iters: 1600, epoch: 4 | loss: 1.9881474
	speed: 0.0305s/iter; left time: 752.2753s
	iters: 1700, epoch: 4 | loss: 2.2661340
	speed: 0.0303s/iter; left time: 744.6642s
	iters: 1800, epoch: 4 | loss: 1.5330358
	speed: 0.0304s/iter; left time: 743.6133s
	iters: 1900, epoch: 4 | loss: 2.5148377
	speed: 0.0300s/iter; left time: 732.5354s
	iters: 2000, epoch: 4 | loss: 1.6041460
	speed: 0.0305s/iter; left time: 740.6342s
	iters: 2100, epoch: 4 | loss: 1.5596905
	speed: 0.0301s/iter; left time: 727.6300s
	iters: 2200, epoch: 4 | loss: 1.6178217
	speed: 0.0306s/iter; left time: 736.3548s
	iters: 2300, epoch: 4 | loss: 1.6280990
	speed: 0.0303s/iter; left time: 726.4983s
	iters: 2400, epoch: 4 | loss: 1.7547041
	speed: 0.0297s/iter; left time: 708.3192s
	iters: 2500, epoch: 4 | loss: 1.8392718
	speed: 0.0300s/iter; left time: 712.2203s
	iters: 2600, epoch: 4 | loss: 1.5798600
	speed: 0.0300s/iter; left time: 710.1356s
	iters: 2700, epoch: 4 | loss: 1.9994346
	speed: 0.0304s/iter; left time: 717.1216s
	iters: 2800, epoch: 4 | loss: 1.7629297
	speed: 0.0304s/iter; left time: 712.9020s
	iters: 2900, epoch: 4 | loss: 2.0733607
	speed: 0.0303s/iter; left time: 707.3903s
	iters: 3000, epoch: 4 | loss: 1.3314942
	speed: 0.0304s/iter; left time: 706.8642s
	iters: 3100, epoch: 4 | loss: 1.7748535
	speed: 0.0303s/iter; left time: 701.7028s
	iters: 3200, epoch: 4 | loss: 1.3873364
	speed: 0.0301s/iter; left time: 693.6859s
	iters: 3300, epoch: 4 | loss: 1.6629899
	speed: 0.0301s/iter; left time: 692.5246s
	iters: 3400, epoch: 4 | loss: 1.7020702
	speed: 0.0302s/iter; left time: 692.0080s
	iters: 3500, epoch: 4 | loss: 1.9360058
	speed: 0.0304s/iter; left time: 692.8205s
	iters: 3600, epoch: 4 | loss: 1.8197429
	speed: 0.0303s/iter; left time: 688.2745s
	iters: 3700, epoch: 4 | loss: 1.5830487
	speed: 0.0305s/iter; left time: 689.5663s
Epoch: 4 cost time: 113.63882875442505
Epoch: 4, Steps: 3754 | Train Loss: 1.6713904 Vali Loss: 1.9396384 Test Loss: 1.7010454
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 1.4350160
	speed: 0.4513s/iter; left time: 10120.9335s
	iters: 200, epoch: 5 | loss: 1.4757339
	speed: 0.0307s/iter; left time: 685.0210s
	iters: 300, epoch: 5 | loss: 1.8008139
	speed: 0.0302s/iter; left time: 670.1516s
	iters: 400, epoch: 5 | loss: 1.8890365
	speed: 0.0302s/iter; left time: 668.7886s
	iters: 500, epoch: 5 | loss: 1.7436463
	speed: 0.0304s/iter; left time: 668.8049s
	iters: 600, epoch: 5 | loss: 1.7222455
	speed: 0.0296s/iter; left time: 648.7911s
	iters: 700, epoch: 5 | loss: 1.5806736
	speed: 0.0304s/iter; left time: 662.4200s
	iters: 800, epoch: 5 | loss: 1.8016980
	speed: 0.0299s/iter; left time: 650.6466s
	iters: 900, epoch: 5 | loss: 1.4337236
	speed: 0.0301s/iter; left time: 651.5927s
	iters: 1000, epoch: 5 | loss: 1.8143957
	speed: 0.0302s/iter; left time: 649.4666s
	iters: 1100, epoch: 5 | loss: 1.2551516
	speed: 0.0304s/iter; left time: 652.0392s
	iters: 1200, epoch: 5 | loss: 1.7463529
	speed: 0.0296s/iter; left time: 630.9403s
	iters: 1300, epoch: 5 | loss: 1.3765002
	speed: 0.0304s/iter; left time: 646.1998s
	iters: 1400, epoch: 5 | loss: 1.4909664
	speed: 0.0302s/iter; left time: 638.9241s
	iters: 1500, epoch: 5 | loss: 1.6117175
	speed: 0.0302s/iter; left time: 634.3388s
	iters: 1600, epoch: 5 | loss: 1.3985229
	speed: 0.0302s/iter; left time: 631.4381s
	iters: 1700, epoch: 5 | loss: 1.4999329
	speed: 0.0304s/iter; left time: 633.0192s
	iters: 1800, epoch: 5 | loss: 1.7203901
	speed: 0.0300s/iter; left time: 621.0587s
	iters: 1900, epoch: 5 | loss: 1.8213594
	speed: 0.0304s/iter; left time: 627.1463s
	iters: 2000, epoch: 5 | loss: 1.8838549
	speed: 0.0303s/iter; left time: 621.4080s
	iters: 2100, epoch: 5 | loss: 1.7589799
	speed: 0.0302s/iter; left time: 616.2379s
	iters: 2200, epoch: 5 | loss: 1.5309552
	speed: 0.0303s/iter; left time: 615.1761s
	iters: 2300, epoch: 5 | loss: 1.0079045
	speed: 0.0303s/iter; left time: 612.5548s
	iters: 2400, epoch: 5 | loss: 2.0818560
	speed: 0.0302s/iter; left time: 607.7737s
	iters: 2500, epoch: 5 | loss: 1.6557037
	speed: 0.0303s/iter; left time: 607.1059s
	iters: 2600, epoch: 5 | loss: 1.8770077
	speed: 0.0303s/iter; left time: 604.3452s
	iters: 2700, epoch: 5 | loss: 2.1751916
	speed: 0.0303s/iter; left time: 600.1922s
	iters: 2800, epoch: 5 | loss: 1.2023739
	speed: 0.0304s/iter; left time: 599.9546s
	iters: 2900, epoch: 5 | loss: 1.5023376
	speed: 0.0305s/iter; left time: 597.8236s
	iters: 3000, epoch: 5 | loss: 1.7878827
	speed: 0.0304s/iter; left time: 593.8369s
	iters: 3100, epoch: 5 | loss: 1.8619990
	speed: 0.0304s/iter; left time: 590.0394s
	iters: 3200, epoch: 5 | loss: 1.6698378
	speed: 0.0305s/iter; left time: 589.6866s
	iters: 3300, epoch: 5 | loss: 1.5512289
	speed: 0.0299s/iter; left time: 575.7355s
	iters: 3400, epoch: 5 | loss: 1.7914003
	speed: 0.0297s/iter; left time: 567.3116s
	iters: 3500, epoch: 5 | loss: 1.5840265
	speed: 0.0300s/iter; left time: 570.5051s
	iters: 3600, epoch: 5 | loss: 1.7641567
	speed: 0.0305s/iter; left time: 577.2124s
	iters: 3700, epoch: 5 | loss: 1.3001139
	speed: 0.0309s/iter; left time: 581.4435s
Epoch: 5 cost time: 113.62342715263367
Epoch: 5, Steps: 3754 | Train Loss: 1.7308943 Vali Loss: 1.9953084 Test Loss: 1.7990494
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 1.7058778
	speed: 0.4541s/iter; left time: 8478.9164s
	iters: 200, epoch: 6 | loss: 2.0822818
	speed: 0.0303s/iter; left time: 562.0312s
	iters: 300, epoch: 6 | loss: 1.9671158
	speed: 0.0301s/iter; left time: 556.3993s
	iters: 400, epoch: 6 | loss: 1.5919235
	speed: 0.0300s/iter; left time: 552.0116s
	iters: 500, epoch: 6 | loss: 2.1489153
	speed: 0.0300s/iter; left time: 547.4944s
	iters: 600, epoch: 6 | loss: 1.8078531
	speed: 0.0305s/iter; left time: 554.4850s
	iters: 700, epoch: 6 | loss: 1.6984279
	speed: 0.0300s/iter; left time: 541.9801s
	iters: 800, epoch: 6 | loss: 1.6682222
	speed: 0.0305s/iter; left time: 549.0016s
	iters: 900, epoch: 6 | loss: 1.3721093
	speed: 0.0304s/iter; left time: 543.2634s
	iters: 1000, epoch: 6 | loss: 1.6306396
	speed: 0.0303s/iter; left time: 538.7556s
	iters: 1100, epoch: 6 | loss: 1.7925390
	speed: 0.0302s/iter; left time: 533.3357s
	iters: 1200, epoch: 6 | loss: 1.8059863
	speed: 0.0304s/iter; left time: 534.3620s
	iters: 1300, epoch: 6 | loss: 2.0326891
	speed: 0.0299s/iter; left time: 522.4062s
	iters: 1400, epoch: 6 | loss: 2.1918399
	speed: 0.0306s/iter; left time: 530.8043s
	iters: 1500, epoch: 6 | loss: 1.2068193
	speed: 0.0291s/iter; left time: 503.3491s
	iters: 1600, epoch: 6 | loss: 1.6989824
	speed: 0.0292s/iter; left time: 500.5525s
	iters: 1700, epoch: 6 | loss: 1.7801005
	speed: 0.0304s/iter; left time: 519.1698s
	iters: 1800, epoch: 6 | loss: 1.4406444
	speed: 0.0301s/iter; left time: 510.7311s
	iters: 1900, epoch: 6 | loss: 1.4483891
	speed: 0.0296s/iter; left time: 499.7141s
	iters: 2000, epoch: 6 | loss: 1.7932497
	speed: 0.0298s/iter; left time: 499.6101s
	iters: 2100, epoch: 6 | loss: 1.1762784
	speed: 0.0302s/iter; left time: 503.7158s
	iters: 2200, epoch: 6 | loss: 1.6915330
	speed: 0.0304s/iter; left time: 504.5301s
	iters: 2300, epoch: 6 | loss: 2.1361773
	speed: 0.0301s/iter; left time: 496.0364s
	iters: 2400, epoch: 6 | loss: 1.6135001
	speed: 0.0304s/iter; left time: 497.8378s
	iters: 2500, epoch: 6 | loss: 1.8627844
	speed: 0.0299s/iter; left time: 485.8697s
	iters: 2600, epoch: 6 | loss: 1.7391231
	speed: 0.0297s/iter; left time: 480.7490s
	iters: 2700, epoch: 6 | loss: 1.7631390
	speed: 0.0302s/iter; left time: 485.7769s
	iters: 2800, epoch: 6 | loss: 2.0284381
	speed: 0.0304s/iter; left time: 485.7732s
	iters: 2900, epoch: 6 | loss: 1.8566818
	speed: 0.0304s/iter; left time: 482.1192s
	iters: 3000, epoch: 6 | loss: 1.5774143
	speed: 0.0305s/iter; left time: 481.2169s
	iters: 3100, epoch: 6 | loss: 1.3821295
	speed: 0.0296s/iter; left time: 463.8632s
	iters: 3200, epoch: 6 | loss: 1.7717792
	speed: 0.0304s/iter; left time: 473.4591s
	iters: 3300, epoch: 6 | loss: 1.9450291
	speed: 0.0306s/iter; left time: 472.8776s
	iters: 3400, epoch: 6 | loss: 1.6735005
	speed: 0.0303s/iter; left time: 466.2409s
	iters: 3500, epoch: 6 | loss: 1.9299860
	speed: 0.0295s/iter; left time: 450.9628s
	iters: 3600, epoch: 6 | loss: 1.4243150
	speed: 0.0299s/iter; left time: 453.4250s
	iters: 3700, epoch: 6 | loss: 1.4168893
	speed: 0.0305s/iter; left time: 459.9569s
Epoch: 6 cost time: 113.18007278442383
Epoch: 6, Steps: 3754 | Train Loss: 1.7263077 Vali Loss: 1.9430342 Test Loss: 1.7287724
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_all_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 95011
test shape: (9501, 1, 96, 103) (9501, 1, 96, 103)
test shape: (9501, 96, 103) (9501, 96, 103)
mse:1.727091908454895, mae:1.031618356704712
>>>>>>>Overall time: 1017 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
