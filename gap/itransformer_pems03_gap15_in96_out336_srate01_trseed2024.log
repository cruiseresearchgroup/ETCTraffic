Traceback (most recent call last):
  File "run.py", line 4, in <module>
    from exp.exp_long_term_forecasting import Exp_Long_Term_Forecast
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_long_term_forecasting.py", line 2, in <module>
    from exp.exp_basic import Exp_Basic
  File "/g/data/hn98/du/exlts/ddd2/exp/exp_basic.py", line 3, in <module>
    from models import Autoformer, Transformer, TimesNet, Nonstationary_Transformer, DLinear, FEDformer, \
  File "/g/data/hn98/du/exlts/ddd2/models/Mamba.py", line 7, in <module>
    from mamba_ssm import Mamba
ModuleNotFoundError: No module named 'mamba_ssm'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=151, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems03_all_common_flow.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=151, expand=2, factor=3, features='M', freq='h', gap_day=548, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems03_all_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=0.1, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 1216934
val 300238
test 300237
	iters: 100, epoch: 1 | loss: 1.8788944
	speed: 0.0335s/iter; left time: 2546.5745s
	iters: 200, epoch: 1 | loss: 1.1861749
	speed: 0.0304s/iter; left time: 2307.7830s
	iters: 300, epoch: 1 | loss: 1.6325070
	speed: 0.0305s/iter; left time: 2306.9747s
	iters: 400, epoch: 1 | loss: 1.5274861
	speed: 0.0305s/iter; left time: 2304.4117s
	iters: 500, epoch: 1 | loss: 1.3060714
	speed: 0.0305s/iter; left time: 2301.4359s
	iters: 600, epoch: 1 | loss: 1.5112433
	speed: 0.0304s/iter; left time: 2296.9394s
	iters: 700, epoch: 1 | loss: 1.3662652
	speed: 0.0305s/iter; left time: 2295.5808s
	iters: 800, epoch: 1 | loss: 1.4318905
	speed: 0.0304s/iter; left time: 2291.2981s
	iters: 900, epoch: 1 | loss: 1.6356760
	speed: 0.0304s/iter; left time: 2287.4572s
	iters: 1000, epoch: 1 | loss: 1.6168654
	speed: 0.0304s/iter; left time: 2282.4449s
	iters: 1100, epoch: 1 | loss: 1.6077607
	speed: 0.0305s/iter; left time: 2284.0305s
	iters: 1200, epoch: 1 | loss: 1.7516035
	speed: 0.0305s/iter; left time: 2280.2954s
	iters: 1300, epoch: 1 | loss: 1.2136203
	speed: 0.0305s/iter; left time: 2277.3785s
	iters: 1400, epoch: 1 | loss: 1.3916492
	speed: 0.0305s/iter; left time: 2273.1746s
	iters: 1500, epoch: 1 | loss: 1.3872063
	speed: 0.0305s/iter; left time: 2271.5561s
	iters: 1600, epoch: 1 | loss: 1.2926878
	speed: 0.0305s/iter; left time: 2267.0424s
	iters: 1700, epoch: 1 | loss: 1.3812497
	speed: 0.0305s/iter; left time: 2264.3168s
	iters: 1800, epoch: 1 | loss: 1.2782083
	speed: 0.0305s/iter; left time: 2262.3343s
	iters: 1900, epoch: 1 | loss: 1.4810561
	speed: 0.0305s/iter; left time: 2258.5097s
	iters: 2000, epoch: 1 | loss: 1.4587047
	speed: 0.0304s/iter; left time: 2253.4830s
	iters: 2100, epoch: 1 | loss: 1.3418132
	speed: 0.0305s/iter; left time: 2253.2936s
	iters: 2200, epoch: 1 | loss: 1.6822519
	speed: 0.0304s/iter; left time: 2247.0664s
	iters: 2300, epoch: 1 | loss: 1.3988671
	speed: 0.0304s/iter; left time: 2245.5232s
	iters: 2400, epoch: 1 | loss: 1.6373618
	speed: 0.0305s/iter; left time: 2243.5605s
	iters: 2500, epoch: 1 | loss: 1.6247920
	speed: 0.0305s/iter; left time: 2240.8034s
	iters: 2600, epoch: 1 | loss: 1.3741069
	speed: 0.0304s/iter; left time: 2233.7991s
	iters: 2700, epoch: 1 | loss: 1.6965283
	speed: 0.0305s/iter; left time: 2235.6733s
	iters: 2800, epoch: 1 | loss: 1.6393965
	speed: 0.0305s/iter; left time: 2230.9666s
	iters: 2900, epoch: 1 | loss: 1.4000199
	speed: 0.0305s/iter; left time: 2229.1690s
	iters: 3000, epoch: 1 | loss: 1.3598404
	speed: 0.0305s/iter; left time: 2225.3015s
	iters: 3100, epoch: 1 | loss: 1.4697787
	speed: 0.0304s/iter; left time: 2219.5478s
	iters: 3200, epoch: 1 | loss: 1.4542350
	speed: 0.0304s/iter; left time: 2217.2943s
	iters: 3300, epoch: 1 | loss: 1.3675089
	speed: 0.0306s/iter; left time: 2226.3278s
	iters: 3400, epoch: 1 | loss: 1.4485363
	speed: 0.0305s/iter; left time: 2212.7785s
	iters: 3500, epoch: 1 | loss: 1.4356529
	speed: 0.0306s/iter; left time: 2217.2215s
	iters: 3600, epoch: 1 | loss: 1.5168293
	speed: 0.0304s/iter; left time: 2204.7654s
	iters: 3700, epoch: 1 | loss: 1.2861605
	speed: 0.0304s/iter; left time: 2202.9593s
	iters: 3800, epoch: 1 | loss: 1.6587771
	speed: 0.0305s/iter; left time: 2201.1477s
	iters: 3900, epoch: 1 | loss: 1.5792220
	speed: 0.0304s/iter; left time: 2196.7699s
	iters: 4000, epoch: 1 | loss: 1.4946457
	speed: 0.0305s/iter; left time: 2194.1526s
	iters: 4100, epoch: 1 | loss: 1.4432316
	speed: 0.0304s/iter; left time: 2190.6270s
	iters: 4200, epoch: 1 | loss: 1.5314951
	speed: 0.0304s/iter; left time: 2186.8012s
	iters: 4300, epoch: 1 | loss: 1.4078704
	speed: 0.0305s/iter; left time: 2185.4455s
	iters: 4400, epoch: 1 | loss: 1.3869300
	speed: 0.0304s/iter; left time: 2181.1977s
	iters: 4500, epoch: 1 | loss: 1.6208664
	speed: 0.0304s/iter; left time: 2175.7619s
	iters: 4600, epoch: 1 | loss: 1.3414261
	speed: 0.0305s/iter; left time: 2176.8417s
	iters: 4700, epoch: 1 | loss: 1.2715212
	speed: 0.0304s/iter; left time: 2170.1788s
	iters: 4800, epoch: 1 | loss: 1.4840541
	speed: 0.0304s/iter; left time: 2169.4663s
	iters: 4900, epoch: 1 | loss: 1.5063016
	speed: 0.0304s/iter; left time: 2165.6511s
	iters: 5000, epoch: 1 | loss: 1.3935368
	speed: 0.0304s/iter; left time: 2163.4944s
	iters: 5100, epoch: 1 | loss: 1.4825828
	speed: 0.0304s/iter; left time: 2159.7085s
	iters: 5200, epoch: 1 | loss: 1.3096206
	speed: 0.0304s/iter; left time: 2156.0927s
	iters: 5300, epoch: 1 | loss: 1.6350782
	speed: 0.0305s/iter; left time: 2155.0999s
	iters: 5400, epoch: 1 | loss: 1.3545399
	speed: 0.0304s/iter; left time: 2149.6672s
	iters: 5500, epoch: 1 | loss: 1.6322443
	speed: 0.0304s/iter; left time: 2148.1290s
	iters: 5600, epoch: 1 | loss: 1.5637679
	speed: 0.0304s/iter; left time: 2145.1532s
	iters: 5700, epoch: 1 | loss: 1.4599243
	speed: 0.0304s/iter; left time: 2141.1179s
	iters: 5800, epoch: 1 | loss: 1.4760525
	speed: 0.0304s/iter; left time: 2137.7228s
	iters: 5900, epoch: 1 | loss: 1.6400729
	speed: 0.0305s/iter; left time: 2136.1903s
	iters: 6000, epoch: 1 | loss: 1.5749110
	speed: 0.0304s/iter; left time: 2131.9385s
	iters: 6100, epoch: 1 | loss: 1.5161939
	speed: 0.0304s/iter; left time: 2129.2285s
	iters: 6200, epoch: 1 | loss: 1.7047852
	speed: 0.0304s/iter; left time: 2125.5648s
	iters: 6300, epoch: 1 | loss: 1.4866385
	speed: 0.0304s/iter; left time: 2122.0127s
	iters: 6400, epoch: 1 | loss: 1.5156227
	speed: 0.0305s/iter; left time: 2121.4683s
	iters: 6500, epoch: 1 | loss: 1.5683173
	speed: 0.0304s/iter; left time: 2116.2905s
	iters: 6600, epoch: 1 | loss: 1.4581335
	speed: 0.0305s/iter; left time: 2114.8059s
	iters: 6700, epoch: 1 | loss: 1.5212173
	speed: 0.0304s/iter; left time: 2107.1219s
	iters: 6800, epoch: 1 | loss: 1.4464686
	speed: 0.0304s/iter; left time: 2105.7850s
	iters: 6900, epoch: 1 | loss: 1.3587295
	speed: 0.0304s/iter; left time: 2102.7392s
	iters: 7000, epoch: 1 | loss: 1.3497726
	speed: 0.0304s/iter; left time: 2101.5986s
	iters: 7100, epoch: 1 | loss: 1.4587485
	speed: 0.0304s/iter; left time: 2097.5000s
	iters: 7200, epoch: 1 | loss: 1.4798886
	speed: 0.0305s/iter; left time: 2096.5641s
	iters: 7300, epoch: 1 | loss: 1.4289402
	speed: 0.0305s/iter; left time: 2093.9727s
	iters: 7400, epoch: 1 | loss: 1.4461572
	speed: 0.0304s/iter; left time: 2088.8026s
	iters: 7500, epoch: 1 | loss: 1.5764775
	speed: 0.0304s/iter; left time: 2084.0115s
	iters: 7600, epoch: 1 | loss: 1.4982044
	speed: 0.0304s/iter; left time: 2081.7301s
Epoch: 1 cost time: 231.94750499725342
Epoch: 1, Steps: 7605 | Train Loss: 1.4927151 Vali Loss: 1.7302575 Test Loss: 1.6623814
Validation loss decreased (inf --> 1.730258).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 1.5275421
	speed: 1.6124s/iter; left time: 110198.5222s
	iters: 200, epoch: 2 | loss: 1.4828818
	speed: 0.0304s/iter; left time: 2077.8045s
	iters: 300, epoch: 2 | loss: 1.4604332
	speed: 0.0305s/iter; left time: 2076.9267s
	iters: 400, epoch: 2 | loss: 1.4346421
	speed: 0.0304s/iter; left time: 2070.6534s
	iters: 500, epoch: 2 | loss: 1.7858083
	speed: 0.0304s/iter; left time: 2068.9506s
	iters: 600, epoch: 2 | loss: 1.2631867
	speed: 0.0305s/iter; left time: 2066.4856s
	iters: 700, epoch: 2 | loss: 1.2373104
	speed: 0.0304s/iter; left time: 2061.8916s
	iters: 800, epoch: 2 | loss: 1.4326754
	speed: 0.0305s/iter; left time: 2062.6074s
	iters: 900, epoch: 2 | loss: 1.6913807
	speed: 0.0305s/iter; left time: 2057.1170s
	iters: 1000, epoch: 2 | loss: 1.5338851
	speed: 0.0305s/iter; left time: 2059.0082s
	iters: 1100, epoch: 2 | loss: 1.4716083
	speed: 0.0305s/iter; left time: 2051.4025s
	iters: 1200, epoch: 2 | loss: 1.5734236
	speed: 0.0305s/iter; left time: 2053.1206s
	iters: 1300, epoch: 2 | loss: 1.4774101
	speed: 0.0304s/iter; left time: 2044.0892s
	iters: 1400, epoch: 2 | loss: 1.4149793
	speed: 0.0304s/iter; left time: 2041.3274s
	iters: 1500, epoch: 2 | loss: 1.4557602
	speed: 0.0304s/iter; left time: 2037.6735s
	iters: 1600, epoch: 2 | loss: 1.2847936
	speed: 0.0304s/iter; left time: 2034.6194s
	iters: 1700, epoch: 2 | loss: 1.5698026
	speed: 0.0304s/iter; left time: 2031.0628s
	iters: 1800, epoch: 2 | loss: 1.5544415
	speed: 0.0304s/iter; left time: 2026.6868s
	iters: 1900, epoch: 2 | loss: 1.4275343
	speed: 0.0304s/iter; left time: 2025.3981s
	iters: 2000, epoch: 2 | loss: 1.7031980
	speed: 0.0305s/iter; left time: 2023.5875s
	iters: 2100, epoch: 2 | loss: 1.5014523
	speed: 0.0304s/iter; left time: 2018.9338s
	iters: 2200, epoch: 2 | loss: 1.5848101
	speed: 0.0304s/iter; left time: 2016.4667s
	iters: 2300, epoch: 2 | loss: 1.3186226
	speed: 0.0305s/iter; left time: 2015.5935s
	iters: 2400, epoch: 2 | loss: 1.5600026
	speed: 0.0304s/iter; left time: 2008.9520s
	iters: 2500, epoch: 2 | loss: 1.6135182
	speed: 0.0304s/iter; left time: 2005.0601s
	iters: 2600, epoch: 2 | loss: 1.4513499
	speed: 0.0304s/iter; left time: 2004.0646s
	iters: 2700, epoch: 2 | loss: 1.6012881
	speed: 0.0304s/iter; left time: 1997.9043s
	iters: 2800, epoch: 2 | loss: 1.4762831
	speed: 0.0305s/iter; left time: 1999.5466s
	iters: 2900, epoch: 2 | loss: 1.6600072
	speed: 0.0304s/iter; left time: 1992.6715s
	iters: 3000, epoch: 2 | loss: 1.7009587
	speed: 0.0305s/iter; left time: 1993.6635s
	iters: 3100, epoch: 2 | loss: 1.3464396
	speed: 0.0304s/iter; left time: 1989.4347s
	iters: 3200, epoch: 2 | loss: 1.6888777
	speed: 0.0304s/iter; left time: 1984.4683s
	iters: 3300, epoch: 2 | loss: 1.3898062
	speed: 0.0304s/iter; left time: 1983.5789s
	iters: 3400, epoch: 2 | loss: 1.7384287
	speed: 0.0304s/iter; left time: 1978.3245s
	iters: 3500, epoch: 2 | loss: 1.6065658
	speed: 0.0305s/iter; left time: 1978.2386s
	iters: 3600, epoch: 2 | loss: 1.6538445
	speed: 0.0305s/iter; left time: 1975.3214s
	iters: 3700, epoch: 2 | loss: 1.4207336
	speed: 0.0305s/iter; left time: 1973.3652s
	iters: 3800, epoch: 2 | loss: 1.6994915
	speed: 0.0304s/iter; left time: 1967.3097s
	iters: 3900, epoch: 2 | loss: 1.4542147
	speed: 0.0304s/iter; left time: 1965.0837s
	iters: 4000, epoch: 2 | loss: 1.5201331
	speed: 0.0304s/iter; left time: 1960.9337s
	iters: 4100, epoch: 2 | loss: 1.4988292
	speed: 0.0304s/iter; left time: 1958.8016s
	iters: 4200, epoch: 2 | loss: 1.6921511
	speed: 0.0304s/iter; left time: 1953.2276s
	iters: 4300, epoch: 2 | loss: 1.6777310
	speed: 0.0305s/iter; left time: 1954.1007s
	iters: 4400, epoch: 2 | loss: 1.4407188
	speed: 0.0304s/iter; left time: 1948.6269s
	iters: 4500, epoch: 2 | loss: 1.8470763
	speed: 0.0304s/iter; left time: 1943.7945s
	iters: 4600, epoch: 2 | loss: 1.5296363
	speed: 0.0304s/iter; left time: 1942.8901s
	iters: 4700, epoch: 2 | loss: 1.6635387
	speed: 0.0304s/iter; left time: 1938.8368s
	iters: 4800, epoch: 2 | loss: 1.5786079
	speed: 0.0305s/iter; left time: 1938.1238s
	iters: 4900, epoch: 2 | loss: 1.7084297
	speed: 0.0304s/iter; left time: 1933.6128s
	iters: 5000, epoch: 2 | loss: 1.7367905
	speed: 0.0305s/iter; left time: 1932.4280s
	iters: 5100, epoch: 2 | loss: 1.6148771
	speed: 0.0304s/iter; left time: 1925.6426s
	iters: 5200, epoch: 2 | loss: 1.6711929
	speed: 0.0304s/iter; left time: 1924.9739s
	iters: 5300, epoch: 2 | loss: 1.6912031
	speed: 0.0304s/iter; left time: 1920.7410s
	iters: 5400, epoch: 2 | loss: 1.4670501
	speed: 0.0304s/iter; left time: 1917.2791s
	iters: 5500, epoch: 2 | loss: 1.5631304
	speed: 0.0305s/iter; left time: 1917.0385s
	iters: 5600, epoch: 2 | loss: 1.5790868
	speed: 0.0304s/iter; left time: 1912.9496s
	iters: 5700, epoch: 2 | loss: 1.6019243
	speed: 0.0304s/iter; left time: 1908.8037s
	iters: 5800, epoch: 2 | loss: 1.6849544
	speed: 0.0304s/iter; left time: 1906.5405s
	iters: 5900, epoch: 2 | loss: 1.5916817
	speed: 0.0304s/iter; left time: 1902.8835s
	iters: 6000, epoch: 2 | loss: 1.6353638
	speed: 0.0304s/iter; left time: 1899.4556s
	iters: 6100, epoch: 2 | loss: 1.4944770
	speed: 0.0304s/iter; left time: 1897.9565s
	iters: 6200, epoch: 2 | loss: 1.3044156
	speed: 0.0304s/iter; left time: 1895.1469s
	iters: 6300, epoch: 2 | loss: 1.6268928
	speed: 0.0304s/iter; left time: 1889.6993s
	iters: 6400, epoch: 2 | loss: 1.5123048
	speed: 0.0305s/iter; left time: 1889.4613s
	iters: 6500, epoch: 2 | loss: 1.5111470
	speed: 0.0304s/iter; left time: 1885.1810s
	iters: 6600, epoch: 2 | loss: 1.5508564
	speed: 0.0304s/iter; left time: 1881.0007s
	iters: 6700, epoch: 2 | loss: 1.7347821
	speed: 0.0304s/iter; left time: 1878.7512s
	iters: 6800, epoch: 2 | loss: 1.5020920
	speed: 0.0304s/iter; left time: 1874.1834s
	iters: 6900, epoch: 2 | loss: 1.5936971
	speed: 0.0306s/iter; left time: 1880.6673s
	iters: 7000, epoch: 2 | loss: 1.3807362
	speed: 0.0305s/iter; left time: 1871.8463s
	iters: 7100, epoch: 2 | loss: 1.6331497
	speed: 0.0305s/iter; left time: 1868.8529s
	iters: 7200, epoch: 2 | loss: 1.6065787
	speed: 0.0304s/iter; left time: 1863.7685s
	iters: 7300, epoch: 2 | loss: 1.6768265
	speed: 0.0304s/iter; left time: 1860.8585s
	iters: 7400, epoch: 2 | loss: 1.6587701
	speed: 0.0305s/iter; left time: 1859.0523s
	iters: 7500, epoch: 2 | loss: 1.7616946
	speed: 0.0304s/iter; left time: 1855.3951s
	iters: 7600, epoch: 2 | loss: 1.5486561
	speed: 0.0305s/iter; left time: 1854.0426s
Epoch: 2 cost time: 231.65777969360352
Epoch: 2, Steps: 7605 | Train Loss: 1.5467347 Vali Loss: 1.7649282 Test Loss: 1.6947364
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 1.6080735
	speed: 1.6087s/iter; left time: 97716.1891s
	iters: 200, epoch: 3 | loss: 1.5694841
	speed: 0.0304s/iter; left time: 1843.7027s
	iters: 300, epoch: 3 | loss: 1.7475482
	speed: 0.0304s/iter; left time: 1841.3338s
	iters: 400, epoch: 3 | loss: 1.7488071
	speed: 0.0304s/iter; left time: 1839.6217s
	iters: 500, epoch: 3 | loss: 1.5466753
	speed: 0.0304s/iter; left time: 1834.9633s
	iters: 600, epoch: 3 | loss: 1.5641215
	speed: 0.0304s/iter; left time: 1832.3572s
	iters: 700, epoch: 3 | loss: 1.4827708
	speed: 0.0304s/iter; left time: 1830.2891s
	iters: 800, epoch: 3 | loss: 1.5237488
	speed: 0.0305s/iter; left time: 1828.6082s
	iters: 900, epoch: 3 | loss: 1.5503963
	speed: 0.0304s/iter; left time: 1823.9788s
	iters: 1000, epoch: 3 | loss: 1.6308329
	speed: 0.0304s/iter; left time: 1821.5393s
	iters: 1100, epoch: 3 | loss: 1.5093963
	speed: 0.0304s/iter; left time: 1816.0627s
	iters: 1200, epoch: 3 | loss: 1.6575856
	speed: 0.0304s/iter; left time: 1815.0249s
	iters: 1300, epoch: 3 | loss: 1.6080532
	speed: 0.0304s/iter; left time: 1812.3347s
	iters: 1400, epoch: 3 | loss: 1.6374571
	speed: 0.0305s/iter; left time: 1811.0794s
	iters: 1500, epoch: 3 | loss: 1.5476114
	speed: 0.0305s/iter; left time: 1807.1940s
	iters: 1600, epoch: 3 | loss: 1.4629098
	speed: 0.0305s/iter; left time: 1804.6872s
	iters: 1700, epoch: 3 | loss: 1.8000481
	speed: 0.0304s/iter; left time: 1799.8897s
	iters: 1800, epoch: 3 | loss: 1.6625732
	speed: 0.0305s/iter; left time: 1802.4128s
	iters: 1900, epoch: 3 | loss: 1.4477233
	speed: 0.0304s/iter; left time: 1791.5768s
	iters: 2000, epoch: 3 | loss: 1.5960709
	speed: 0.0304s/iter; left time: 1789.7405s
	iters: 2100, epoch: 3 | loss: 1.4285719
	speed: 0.0304s/iter; left time: 1786.8944s
	iters: 2200, epoch: 3 | loss: 1.6158007
	speed: 0.0304s/iter; left time: 1785.1118s
	iters: 2300, epoch: 3 | loss: 1.6490154
	speed: 0.0304s/iter; left time: 1781.0752s
	iters: 2400, epoch: 3 | loss: 1.5642335
	speed: 0.0304s/iter; left time: 1778.4585s
	iters: 2500, epoch: 3 | loss: 1.3991823
	speed: 0.0304s/iter; left time: 1774.7422s
	iters: 2600, epoch: 3 | loss: 1.7925788
	speed: 0.0304s/iter; left time: 1771.8337s
	iters: 2700, epoch: 3 | loss: 1.6506019
	speed: 0.0304s/iter; left time: 1770.0350s
	iters: 2800, epoch: 3 | loss: 1.5865993
	speed: 0.0304s/iter; left time: 1766.0351s
	iters: 2900, epoch: 3 | loss: 1.4344649
	speed: 0.0304s/iter; left time: 1761.6952s
	iters: 3000, epoch: 3 | loss: 1.4231272
	speed: 0.0304s/iter; left time: 1759.2805s
	iters: 3100, epoch: 3 | loss: 1.4989716
	speed: 0.0305s/iter; left time: 1760.0234s
	iters: 3200, epoch: 3 | loss: 1.6434743
	speed: 0.0305s/iter; left time: 1755.3136s
	iters: 3300, epoch: 3 | loss: 1.6553785
	speed: 0.0304s/iter; left time: 1751.3166s
	iters: 3400, epoch: 3 | loss: 1.4736998
	speed: 0.0304s/iter; left time: 1748.3842s
	iters: 3500, epoch: 3 | loss: 1.8782957
	speed: 0.0304s/iter; left time: 1745.8789s
	iters: 3600, epoch: 3 | loss: 1.6352646
	speed: 0.0304s/iter; left time: 1740.6300s
	iters: 3700, epoch: 3 | loss: 1.6752001
	speed: 0.0304s/iter; left time: 1738.7886s
	iters: 3800, epoch: 3 | loss: 1.6567117
	speed: 0.0304s/iter; left time: 1736.3806s
	iters: 3900, epoch: 3 | loss: 1.5562418
	speed: 0.0304s/iter; left time: 1731.2043s
	iters: 4000, epoch: 3 | loss: 1.6219283
	speed: 0.0305s/iter; left time: 1731.3342s
	iters: 4100, epoch: 3 | loss: 1.6703823
	speed: 0.0304s/iter; left time: 1727.3944s
	iters: 4200, epoch: 3 | loss: 1.7650764
	speed: 0.0305s/iter; left time: 1726.1571s
	iters: 4300, epoch: 3 | loss: 1.5825508
	speed: 0.0304s/iter; left time: 1720.8780s
	iters: 4400, epoch: 3 | loss: 1.5516485
	speed: 0.0305s/iter; left time: 1718.7913s
	iters: 4500, epoch: 3 | loss: 1.5622108
	speed: 0.0304s/iter; left time: 1713.8771s
	iters: 4600, epoch: 3 | loss: 1.4088825
	speed: 0.0304s/iter; left time: 1710.5309s
	iters: 4700, epoch: 3 | loss: 1.6572872
	speed: 0.0304s/iter; left time: 1708.5515s
	iters: 4800, epoch: 3 | loss: 1.6868074
	speed: 0.0304s/iter; left time: 1704.6148s
	iters: 4900, epoch: 3 | loss: 1.6011215
	speed: 0.0304s/iter; left time: 1701.8937s
	iters: 5000, epoch: 3 | loss: 1.6921974
	speed: 0.0304s/iter; left time: 1699.6981s
	iters: 5100, epoch: 3 | loss: 1.7089659
	speed: 0.0304s/iter; left time: 1695.6585s
	iters: 5200, epoch: 3 | loss: 1.5357286
	speed: 0.0304s/iter; left time: 1692.2724s
	iters: 5300, epoch: 3 | loss: 1.4769021
	speed: 0.0304s/iter; left time: 1690.9659s
	iters: 5400, epoch: 3 | loss: 1.7275933
	speed: 0.0305s/iter; left time: 1691.4965s
	iters: 5500, epoch: 3 | loss: 1.7033627
	speed: 0.0304s/iter; left time: 1682.5371s
	iters: 5600, epoch: 3 | loss: 1.6823090
	speed: 0.0304s/iter; left time: 1679.4990s
	iters: 5700, epoch: 3 | loss: 1.4377005
	speed: 0.0304s/iter; left time: 1678.1950s
	iters: 5800, epoch: 3 | loss: 1.6232163
	speed: 0.0304s/iter; left time: 1675.9485s
	iters: 5900, epoch: 3 | loss: 1.6461742
	speed: 0.0304s/iter; left time: 1668.4788s
	iters: 6000, epoch: 3 | loss: 1.5990455
	speed: 0.0304s/iter; left time: 1669.1258s
	iters: 6100, epoch: 3 | loss: 1.5675645
	speed: 0.0304s/iter; left time: 1665.6778s
	iters: 6200, epoch: 3 | loss: 1.6115828
	speed: 0.0304s/iter; left time: 1662.0530s
	iters: 6300, epoch: 3 | loss: 1.6439126
	speed: 0.0304s/iter; left time: 1659.2864s
	iters: 6400, epoch: 3 | loss: 1.6845386
	speed: 0.0304s/iter; left time: 1655.9304s
	iters: 6500, epoch: 3 | loss: 1.7293651
	speed: 0.0304s/iter; left time: 1652.5481s
	iters: 6600, epoch: 3 | loss: 1.5610176
	speed: 0.0304s/iter; left time: 1649.3125s
	iters: 6700, epoch: 3 | loss: 1.7401949
	speed: 0.0304s/iter; left time: 1646.4438s
	iters: 6800, epoch: 3 | loss: 1.5168089
	speed: 0.0304s/iter; left time: 1645.5344s
	iters: 6900, epoch: 3 | loss: 1.5831805
	speed: 0.0304s/iter; left time: 1641.9376s
	iters: 7000, epoch: 3 | loss: 1.6368899
	speed: 0.0304s/iter; left time: 1637.6286s
	iters: 7100, epoch: 3 | loss: 1.5504291
	speed: 0.0304s/iter; left time: 1634.4207s
	iters: 7200, epoch: 3 | loss: 1.4468058
	speed: 0.0305s/iter; left time: 1636.4512s
	iters: 7300, epoch: 3 | loss: 1.5406324
	speed: 0.0304s/iter; left time: 1627.9341s
	iters: 7400, epoch: 3 | loss: 1.5461212
	speed: 0.0304s/iter; left time: 1624.2752s
	iters: 7500, epoch: 3 | loss: 1.5679519
	speed: 0.0304s/iter; left time: 1619.9158s
	iters: 7600, epoch: 3 | loss: 1.6444789
	speed: 0.0304s/iter; left time: 1617.2617s
Epoch: 3 cost time: 231.5878221988678
Epoch: 3, Steps: 7605 | Train Loss: 1.5799765 Vali Loss: 1.7453967 Test Loss: 1.6639369
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 1.6071330
	speed: 1.6144s/iter; left time: 85783.7264s
	iters: 200, epoch: 4 | loss: 1.5554451
	speed: 0.0304s/iter; left time: 1613.4668s
	iters: 300, epoch: 4 | loss: 1.6099254
	speed: 0.0304s/iter; left time: 1610.0596s
	iters: 400, epoch: 4 | loss: 1.6064922
	speed: 0.0304s/iter; left time: 1607.7333s
	iters: 500, epoch: 4 | loss: 1.6839701
	speed: 0.0305s/iter; left time: 1605.8723s
	iters: 600, epoch: 4 | loss: 1.4474984
	speed: 0.0304s/iter; left time: 1602.1807s
	iters: 700, epoch: 4 | loss: 1.5768565
	speed: 0.0304s/iter; left time: 1598.5213s
	iters: 800, epoch: 4 | loss: 1.5193379
	speed: 0.0304s/iter; left time: 1595.5735s
	iters: 900, epoch: 4 | loss: 1.5614079
	speed: 0.0304s/iter; left time: 1591.0578s
	iters: 1000, epoch: 4 | loss: 1.4656676
	speed: 0.0305s/iter; left time: 1591.8446s
	iters: 1100, epoch: 4 | loss: 1.5718406
	speed: 0.0304s/iter; left time: 1587.3262s
	iters: 1200, epoch: 4 | loss: 1.3704581
	speed: 0.0304s/iter; left time: 1583.2805s
	iters: 1300, epoch: 4 | loss: 1.5204207
	speed: 0.0304s/iter; left time: 1578.7970s
	iters: 1400, epoch: 4 | loss: 1.6513335
	speed: 0.0304s/iter; left time: 1576.8269s
	iters: 1500, epoch: 4 | loss: 1.6396035
	speed: 0.0305s/iter; left time: 1575.7832s
	iters: 1600, epoch: 4 | loss: 1.6303515
	speed: 0.0304s/iter; left time: 1571.2843s
	iters: 1700, epoch: 4 | loss: 1.6095512
	speed: 0.0304s/iter; left time: 1568.5647s
	iters: 1800, epoch: 4 | loss: 1.4526271
	speed: 0.0304s/iter; left time: 1565.7631s
	iters: 1900, epoch: 4 | loss: 1.2695696
	speed: 0.0304s/iter; left time: 1562.8749s
	iters: 2000, epoch: 4 | loss: 1.6729085
	speed: 0.0304s/iter; left time: 1559.0158s
	iters: 2100, epoch: 4 | loss: 1.4295714
	speed: 0.0304s/iter; left time: 1556.2023s
	iters: 2200, epoch: 4 | loss: 1.4876895
	speed: 0.0304s/iter; left time: 1553.0950s
	iters: 2300, epoch: 4 | loss: 1.5731677
	speed: 0.0304s/iter; left time: 1550.6023s
	iters: 2400, epoch: 4 | loss: 1.5510478
	speed: 0.0304s/iter; left time: 1546.5366s
	iters: 2500, epoch: 4 | loss: 1.4157243
	speed: 0.0304s/iter; left time: 1542.9418s
	iters: 2600, epoch: 4 | loss: 1.6075084
	speed: 0.0304s/iter; left time: 1540.6603s
	iters: 2700, epoch: 4 | loss: 1.5247076
	speed: 0.0305s/iter; left time: 1539.3631s
	iters: 2800, epoch: 4 | loss: 1.5873338
	speed: 0.0305s/iter; left time: 1535.8492s
	iters: 2900, epoch: 4 | loss: 1.5056618
	speed: 0.0304s/iter; left time: 1531.8901s
	iters: 3000, epoch: 4 | loss: 1.6012642
	speed: 0.0305s/iter; left time: 1529.8779s
	iters: 3100, epoch: 4 | loss: 1.5792093
	speed: 0.0304s/iter; left time: 1524.3535s
	iters: 3200, epoch: 4 | loss: 1.4443749
	speed: 0.0304s/iter; left time: 1521.9428s
	iters: 3300, epoch: 4 | loss: 1.4800401
	speed: 0.0304s/iter; left time: 1519.2049s
	iters: 3400, epoch: 4 | loss: 1.6082671
	speed: 0.0304s/iter; left time: 1516.1447s
	iters: 3500, epoch: 4 | loss: 1.5779593
	speed: 0.0304s/iter; left time: 1512.9065s
	iters: 3600, epoch: 4 | loss: 1.5226976
	speed: 0.0304s/iter; left time: 1508.8428s
	iters: 3700, epoch: 4 | loss: 1.5212367
	speed: 0.0304s/iter; left time: 1506.5993s
	iters: 3800, epoch: 4 | loss: 1.7665313
	speed: 0.0304s/iter; left time: 1504.5942s
	iters: 3900, epoch: 4 | loss: 1.3256391
	speed: 0.0305s/iter; left time: 1502.6373s
	iters: 4000, epoch: 4 | loss: 1.3385525
	speed: 0.0304s/iter; left time: 1497.9492s
	iters: 4100, epoch: 4 | loss: 1.8255161
	speed: 0.0304s/iter; left time: 1495.4347s
	iters: 4200, epoch: 4 | loss: 1.4583932
	speed: 0.0305s/iter; left time: 1496.9988s
	iters: 4300, epoch: 4 | loss: 1.7189184
	speed: 0.0304s/iter; left time: 1489.5677s
	iters: 4400, epoch: 4 | loss: 1.4759284
	speed: 0.0304s/iter; left time: 1484.5833s
	iters: 4500, epoch: 4 | loss: 1.3833174
	speed: 0.0304s/iter; left time: 1482.6822s
	iters: 4600, epoch: 4 | loss: 1.7099154
	speed: 0.0304s/iter; left time: 1478.3833s
	iters: 4700, epoch: 4 | loss: 1.4094416
	speed: 0.0304s/iter; left time: 1477.7591s
	iters: 4800, epoch: 4 | loss: 1.5108377
	speed: 0.0304s/iter; left time: 1473.8948s
	iters: 4900, epoch: 4 | loss: 1.6184523
	speed: 0.0304s/iter; left time: 1470.7548s
	iters: 5000, epoch: 4 | loss: 1.4508551
	speed: 0.0304s/iter; left time: 1468.7186s
	iters: 5100, epoch: 4 | loss: 1.5084136
	speed: 0.0304s/iter; left time: 1464.8937s
	iters: 5200, epoch: 4 | loss: 1.7873154
	speed: 0.0304s/iter; left time: 1461.0154s
	iters: 5300, epoch: 4 | loss: 1.4005861
	speed: 0.0304s/iter; left time: 1459.3876s
	iters: 5400, epoch: 4 | loss: 1.4734218
	speed: 0.0304s/iter; left time: 1456.0282s
	iters: 5500, epoch: 4 | loss: 1.6467175
	speed: 0.0304s/iter; left time: 1452.4326s
	iters: 5600, epoch: 4 | loss: 1.5393702
	speed: 0.0305s/iter; left time: 1450.6638s
	iters: 5700, epoch: 4 | loss: 1.4175174
	speed: 0.0305s/iter; left time: 1448.1523s
	iters: 5800, epoch: 4 | loss: 1.5051777
	speed: 0.0304s/iter; left time: 1442.9154s
	iters: 5900, epoch: 4 | loss: 1.5226815
	speed: 0.0305s/iter; left time: 1441.7122s
	iters: 6000, epoch: 4 | loss: 1.5926629
	speed: 0.0304s/iter; left time: 1436.7122s
	iters: 6100, epoch: 4 | loss: 1.5240172
	speed: 0.0304s/iter; left time: 1433.6432s
	iters: 6200, epoch: 4 | loss: 1.6188364
	speed: 0.0304s/iter; left time: 1431.9265s
	iters: 6300, epoch: 4 | loss: 1.4779904
	speed: 0.0305s/iter; left time: 1430.4645s
	iters: 6400, epoch: 4 | loss: 1.4738491
	speed: 0.0305s/iter; left time: 1426.6052s
	iters: 6500, epoch: 4 | loss: 1.6453876
	speed: 0.0304s/iter; left time: 1423.0173s
	iters: 6600, epoch: 4 | loss: 1.6594864
	speed: 0.0304s/iter; left time: 1419.7843s
	iters: 6700, epoch: 4 | loss: 1.5308725
	speed: 0.0304s/iter; left time: 1415.0455s
	iters: 6800, epoch: 4 | loss: 1.5237639
	speed: 0.0305s/iter; left time: 1414.2549s
	iters: 6900, epoch: 4 | loss: 1.3923368
	speed: 0.0304s/iter; left time: 1408.3399s
	iters: 7000, epoch: 4 | loss: 1.4938904
	speed: 0.0305s/iter; left time: 1408.3938s
	iters: 7100, epoch: 4 | loss: 1.5289553
	speed: 0.0304s/iter; left time: 1404.4312s
	iters: 7200, epoch: 4 | loss: 1.5798758
	speed: 0.0305s/iter; left time: 1401.9233s
	iters: 7300, epoch: 4 | loss: 1.5776393
	speed: 0.0304s/iter; left time: 1398.4366s
	iters: 7400, epoch: 4 | loss: 1.3563529
	speed: 0.0306s/iter; left time: 1400.9933s
	iters: 7500, epoch: 4 | loss: 1.5329118
	speed: 0.0304s/iter; left time: 1391.9442s
	iters: 7600, epoch: 4 | loss: 1.5940291
	speed: 0.0305s/iter; left time: 1389.9235s
Epoch: 4 cost time: 231.62144017219543
Epoch: 4, Steps: 7605 | Train Loss: 1.5443933 Vali Loss: 1.7865170 Test Loss: 1.7408891
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems03_all_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate0.1_sseed7_trainseed2024_gap548_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 300237
test shape: (30023, 1, 336, 151) (30023, 1, 336, 151)
test shape: (30023, 336, 151) (30023, 336, 151)
mse:1.6623773574829102, mae:0.9873539209365845
>>>>>>>Overall time: 1823 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
