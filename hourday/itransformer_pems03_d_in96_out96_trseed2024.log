Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=151, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems03_d.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems03_d_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_d_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5383
val 703
test 1497
	iters: 100, epoch: 1 | loss: 0.5456729
	speed: 0.0370s/iter; left time: 120.6183s
	iters: 200, epoch: 1 | loss: 0.4426422
	speed: 0.0307s/iter; left time: 96.8988s
	iters: 300, epoch: 1 | loss: 0.6556014
	speed: 0.0302s/iter; left time: 92.3593s
Epoch: 1 cost time: 10.948188304901123
Epoch: 1, Steps: 336 | Train Loss: 0.5519966 Vali Loss: 0.4427207 Test Loss: 0.6131079
Validation loss decreased (inf --> 0.442721).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5313078
	speed: 0.1192s/iter; left time: 348.5691s
	iters: 200, epoch: 2 | loss: 0.5660037
	speed: 0.0303s/iter; left time: 85.7097s
	iters: 300, epoch: 2 | loss: 0.5452003
	speed: 0.0301s/iter; left time: 81.9977s
Epoch: 2 cost time: 10.627687215805054
Epoch: 2, Steps: 336 | Train Loss: 0.5406661 Vali Loss: 0.4524911 Test Loss: 0.6145727
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4997721
	speed: 0.1171s/iter; left time: 303.1854s
	iters: 200, epoch: 3 | loss: 0.5307891
	speed: 0.0304s/iter; left time: 75.7407s
	iters: 300, epoch: 3 | loss: 0.5926036
	speed: 0.0302s/iter; left time: 72.0574s
Epoch: 3 cost time: 10.496281862258911
Epoch: 3, Steps: 336 | Train Loss: 0.5264196 Vali Loss: 0.4354495 Test Loss: 0.5994684
Validation loss decreased (0.442721 --> 0.435449).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5749584
	speed: 0.1175s/iter; left time: 264.7199s
	iters: 200, epoch: 4 | loss: 0.5430738
	speed: 0.0304s/iter; left time: 65.3986s
	iters: 300, epoch: 4 | loss: 0.4919591
	speed: 0.0301s/iter; left time: 61.7170s
Epoch: 4 cost time: 10.539450883865356
Epoch: 4, Steps: 336 | Train Loss: 0.5114529 Vali Loss: 0.4408632 Test Loss: 0.5983263
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4502095
	speed: 0.1171s/iter; left time: 224.4412s
	iters: 200, epoch: 5 | loss: 0.5264506
	speed: 0.0297s/iter; left time: 53.9104s
	iters: 300, epoch: 5 | loss: 0.4895244
	speed: 0.0299s/iter; left time: 51.3052s
Epoch: 5 cost time: 10.442960500717163
Epoch: 5, Steps: 336 | Train Loss: 0.4983791 Vali Loss: 0.4316847 Test Loss: 0.5998424
Validation loss decreased (0.435449 --> 0.431685).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4834472
	speed: 0.1188s/iter; left time: 187.7896s
	iters: 200, epoch: 6 | loss: 0.4681487
	speed: 0.0308s/iter; left time: 45.5623s
	iters: 300, epoch: 6 | loss: 0.5296646
	speed: 0.0306s/iter; left time: 42.3066s
Epoch: 6 cost time: 10.623881340026855
Epoch: 6, Steps: 336 | Train Loss: 0.4877168 Vali Loss: 0.4309259 Test Loss: 0.6063000
Validation loss decreased (0.431685 --> 0.430926).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.5048255
	speed: 0.1178s/iter; left time: 146.7183s
	iters: 200, epoch: 7 | loss: 0.5071203
	speed: 0.0321s/iter; left time: 36.7615s
	iters: 300, epoch: 7 | loss: 0.4576676
	speed: 0.0300s/iter; left time: 31.4018s
Epoch: 7 cost time: 10.71119213104248
Epoch: 7, Steps: 336 | Train Loss: 0.4800645 Vali Loss: 0.4333712 Test Loss: 0.6057776
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=151, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems03_d.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=151, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems03_d_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_d_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5383
val 703
test 1497
	iters: 100, epoch: 1 | loss: 0.5456729
	speed: 0.0347s/iter; left time: 113.1444s
	iters: 200, epoch: 1 | loss: 0.4426422
	speed: 0.0301s/iter; left time: 95.1327s
	iters: 300, epoch: 1 | loss: 0.6556014
	speed: 0.0301s/iter; left time: 91.9950s
Epoch: 1 cost time: 10.665388822555542
Epoch: 1, Steps: 336 | Train Loss: 0.5519966 Vali Loss: 0.4427207 Test Loss: 0.6131079
Validation loss decreased (inf --> 0.442721).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5313078
	speed: 0.1151s/iter; left time: 336.7714s
	iters: 200, epoch: 2 | loss: 0.5660037
	speed: 0.0294s/iter; left time: 82.9484s
	iters: 300, epoch: 2 | loss: 0.5452003
	speed: 0.0294s/iter; left time: 80.0547s
Epoch: 2 cost time: 10.174838304519653
Epoch: 2, Steps: 336 | Train Loss: 0.5406661 Vali Loss: 0.4524911 Test Loss: 0.6145727
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.4997721
	speed: 0.1142s/iter; left time: 295.5683s
	iters: 200, epoch: 3 | loss: 0.5307891
	speed: 0.0290s/iter; left time: 72.1671s
	iters: 300, epoch: 3 | loss: 0.5926036
	speed: 0.0299s/iter; left time: 71.5130s
Epoch: 3 cost time: 10.2715482711792
Epoch: 3, Steps: 336 | Train Loss: 0.5264196 Vali Loss: 0.4354495 Test Loss: 0.5994684
Validation loss decreased (0.442721 --> 0.435449).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5749584
	speed: 0.1140s/iter; left time: 256.7392s
	iters: 200, epoch: 4 | loss: 0.5430738
	speed: 0.0302s/iter; left time: 64.9187s
	iters: 300, epoch: 4 | loss: 0.4919591
	speed: 0.0293s/iter; left time: 60.2502s
Epoch: 4 cost time: 10.318872690200806
Epoch: 4, Steps: 336 | Train Loss: 0.5114529 Vali Loss: 0.4408632 Test Loss: 0.5983263
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.4502095
	speed: 0.1134s/iter; left time: 217.4775s
	iters: 200, epoch: 5 | loss: 0.5264506
	speed: 0.0298s/iter; left time: 54.1272s
	iters: 300, epoch: 5 | loss: 0.4895244
	speed: 0.0299s/iter; left time: 51.4155s
Epoch: 5 cost time: 10.307167530059814
Epoch: 5, Steps: 336 | Train Loss: 0.4983791 Vali Loss: 0.4316847 Test Loss: 0.5998424
Validation loss decreased (0.435449 --> 0.431685).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4834472
	speed: 0.1138s/iter; left time: 179.9719s
	iters: 200, epoch: 6 | loss: 0.4681487
	speed: 0.0294s/iter; left time: 43.5161s
	iters: 300, epoch: 6 | loss: 0.5296646
	speed: 0.0295s/iter; left time: 40.6853s
Epoch: 6 cost time: 10.258453369140625
Epoch: 6, Steps: 336 | Train Loss: 0.4877168 Vali Loss: 0.4309259 Test Loss: 0.6063000
Validation loss decreased (0.431685 --> 0.430926).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.5048255
	speed: 0.1129s/iter; left time: 140.5648s
	iters: 200, epoch: 7 | loss: 0.5071203
	speed: 0.0296s/iter; left time: 33.9381s
	iters: 300, epoch: 7 | loss: 0.4576676
	speed: 0.0290s/iter; left time: 30.2698s
Epoch: 7 cost time: 10.18802547454834
Epoch: 7, Steps: 336 | Train Loss: 0.4800645 Vali Loss: 0.4333712 Test Loss: 0.6057776
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.5222890
	speed: 0.1132s/iter; left time: 102.9287s
	iters: 200, epoch: 8 | loss: 0.4916306
	speed: 0.0289s/iter; left time: 23.3727s
	iters: 300, epoch: 8 | loss: 0.4687262
	speed: 0.0281s/iter; left time: 19.9568s
Epoch: 8 cost time: 9.972402334213257
Epoch: 8, Steps: 336 | Train Loss: 0.4748633 Vali Loss: 0.4359327 Test Loss: 0.6074862
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.4799103
	speed: 0.1126s/iter; left time: 64.5068s
	iters: 200, epoch: 9 | loss: 0.5549078
	speed: 0.0292s/iter; left time: 13.7924s
	iters: 300, epoch: 9 | loss: 0.4694772
	speed: 0.0288s/iter; left time: 10.7503s
Epoch: 9 cost time: 10.195106506347656
Epoch: 9, Steps: 336 | Train Loss: 0.4716339 Vali Loss: 0.4359907 Test Loss: 0.6078584
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems03_d_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1497
test shape: (1497, 1, 96, 151) (1497, 1, 96, 151)
test shape: (1497, 96, 151) (1497, 96, 151)
mse:0.606299877166748, mae:0.41869810223579407
>>>>>>>Overall time: 165 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
