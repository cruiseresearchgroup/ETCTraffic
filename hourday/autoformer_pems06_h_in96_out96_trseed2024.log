Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_h.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 87521
val 12437
test 24965
	iters: 100, epoch: 1 | loss: 0.2329962
	speed: 0.1040s/iter; left time: 56864.0121s
	iters: 200, epoch: 1 | loss: 0.1893158
	speed: 0.1000s/iter; left time: 54655.6378s
	iters: 300, epoch: 1 | loss: 0.1544591
	speed: 0.0994s/iter; left time: 54359.7608s
	iters: 400, epoch: 1 | loss: 0.1205208
	speed: 0.0997s/iter; left time: 54473.5328s
	iters: 500, epoch: 1 | loss: 0.1468426
	speed: 0.0995s/iter; left time: 54355.7184s
	iters: 600, epoch: 1 | loss: 0.1015727
	speed: 0.0991s/iter; left time: 54166.7796s
	iters: 700, epoch: 1 | loss: 0.1134841
	speed: 0.0991s/iter; left time: 54130.9846s
	iters: 800, epoch: 1 | loss: 0.1414320
	speed: 0.0994s/iter; left time: 54278.5369s
	iters: 900, epoch: 1 | loss: 0.1099450
	speed: 0.0996s/iter; left time: 54391.9879s
	iters: 1000, epoch: 1 | loss: 0.1189543
	speed: 0.0997s/iter; left time: 54456.9498s
	iters: 1100, epoch: 1 | loss: 0.1352285
	speed: 0.0996s/iter; left time: 54353.6485s
	iters: 1200, epoch: 1 | loss: 0.1064945
	speed: 0.0998s/iter; left time: 54466.5884s
	iters: 1300, epoch: 1 | loss: 0.1085476
	speed: 0.0993s/iter; left time: 54201.1254s
	iters: 1400, epoch: 1 | loss: 0.1120071
	speed: 0.0987s/iter; left time: 53870.5618s
	iters: 1500, epoch: 1 | loss: 0.0991318
	speed: 0.0984s/iter; left time: 53654.8396s
	iters: 1600, epoch: 1 | loss: 0.1100221
	speed: 0.0983s/iter; left time: 53606.3902s
	iters: 1700, epoch: 1 | loss: 0.0817290
	speed: 0.1001s/iter; left time: 54590.0047s
	iters: 1800, epoch: 1 | loss: 0.1144886
	speed: 0.0982s/iter; left time: 53530.8087s
	iters: 1900, epoch: 1 | loss: 0.1020161
	speed: 0.0989s/iter; left time: 53893.6295s
	iters: 2000, epoch: 1 | loss: 0.0777465
	speed: 0.0988s/iter; left time: 53868.8711s
	iters: 2100, epoch: 1 | loss: 0.1073312
	speed: 0.0986s/iter; left time: 53722.8001s
	iters: 2200, epoch: 1 | loss: 0.0873501
	speed: 0.0980s/iter; left time: 53376.0799s
	iters: 2300, epoch: 1 | loss: 0.0886904
	speed: 0.0985s/iter; left time: 53658.0660s
	iters: 2400, epoch: 1 | loss: 0.0759838
	speed: 0.0982s/iter; left time: 53481.6395s
	iters: 2500, epoch: 1 | loss: 0.0776128
	speed: 0.0979s/iter; left time: 53310.0749s
	iters: 2600, epoch: 1 | loss: 0.0865097
	speed: 0.0988s/iter; left time: 53786.5131s
	iters: 2700, epoch: 1 | loss: 0.1092841
	speed: 0.0979s/iter; left time: 53280.1677s
Epoch: 1 cost time: 271.34415340423584
Epoch: 1, Steps: 2735 | Train Loss: 0.1228778 Vali Loss: 0.1008912 Test Loss: 0.1636271
Validation loss decreased (inf --> 0.100891).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1080304
	speed: 3.0493s/iter; left time: 1659344.4740s
	iters: 200, epoch: 2 | loss: 0.0742656
	speed: 0.0994s/iter; left time: 54098.5634s
	iters: 300, epoch: 2 | loss: 0.0744348
	speed: 0.1003s/iter; left time: 54576.9427s
	iters: 400, epoch: 2 | loss: 0.0900053
	speed: 0.1002s/iter; left time: 54516.7890s
	iters: 500, epoch: 2 | loss: 0.1070736
	speed: 0.1001s/iter; left time: 54418.6448s
	iters: 600, epoch: 2 | loss: 0.0696326
	speed: 0.1003s/iter; left time: 54519.1589s
	iters: 700, epoch: 2 | loss: 0.0993136
	speed: 0.1004s/iter; left time: 54558.2297s
	iters: 800, epoch: 2 | loss: 0.0870223
	speed: 0.1001s/iter; left time: 54379.3676s
	iters: 900, epoch: 2 | loss: 0.0899448
	speed: 0.1002s/iter; left time: 54437.0234s
	iters: 1000, epoch: 2 | loss: 0.0734702
	speed: 0.1003s/iter; left time: 54481.4960s
	iters: 1100, epoch: 2 | loss: 0.1074621
	speed: 0.1004s/iter; left time: 54539.0242s
	iters: 1200, epoch: 2 | loss: 0.0855365
	speed: 0.1000s/iter; left time: 54301.8870s
	iters: 1300, epoch: 2 | loss: 0.0938817
	speed: 0.1003s/iter; left time: 54459.7706s
	iters: 1400, epoch: 2 | loss: 0.0893463
	speed: 0.1001s/iter; left time: 54366.8488s
	iters: 1500, epoch: 2 | loss: 0.0836128
	speed: 0.1003s/iter; left time: 54430.1564s
	iters: 1600, epoch: 2 | loss: 0.0694534
	speed: 0.1002s/iter; left time: 54371.8468s
	iters: 1700, epoch: 2 | loss: 0.0855207
	speed: 0.1002s/iter; left time: 54371.7569s
	iters: 1800, epoch: 2 | loss: 0.0753153
	speed: 0.1002s/iter; left time: 54378.6202s
	iters: 1900, epoch: 2 | loss: 0.0725659
	speed: 0.1001s/iter; left time: 54278.0491s
	iters: 2000, epoch: 2 | loss: 0.0644250
	speed: 0.1003s/iter; left time: 54390.1536s
	iters: 2100, epoch: 2 | loss: 0.0693369
	speed: 0.1003s/iter; left time: 54366.9064s
	iters: 2200, epoch: 2 | loss: 0.0695722
	speed: 0.1002s/iter; left time: 54307.3945s
	iters: 2300, epoch: 2 | loss: 0.0813412
	speed: 0.1004s/iter; left time: 54394.6849s
	iters: 2400, epoch: 2 | loss: 0.0685429
	speed: 0.1001s/iter; left time: 54230.6283s
	iters: 2500, epoch: 2 | loss: 0.0740243
	speed: 0.1002s/iter; left time: 54302.7975s
	iters: 2600, epoch: 2 | loss: 0.0679418
	speed: 0.1002s/iter; left time: 54266.8913s
	iters: 2700, epoch: 2 | loss: 0.0828666
	speed: 0.1003s/iter; left time: 54313.3174s
Epoch: 2 cost time: 274.3787522315979
Epoch: 2, Steps: 2735 | Train Loss: 0.0826386 Vali Loss: 0.1012556 Test Loss: 0.1974948
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.0773702
	speed: 3.0743s/iter; left time: 1664525.5564s
	iters: 200, epoch: 3 | loss: 0.0718614
	speed: 0.0987s/iter; left time: 53409.5359s
	iters: 300, epoch: 3 | loss: 0.0779310
	speed: 0.0989s/iter; left time: 53502.9825s
	iters: 400, epoch: 3 | loss: 0.0809348
	speed: 0.0992s/iter; left time: 53670.2150s
	iters: 500, epoch: 3 | loss: 0.0708486
	speed: 0.0987s/iter; left time: 53418.5777s
	iters: 600, epoch: 3 | loss: 0.0651163
	speed: 0.0988s/iter; left time: 53450.2242s
	iters: 700, epoch: 3 | loss: 0.0760030
	speed: 0.0993s/iter; left time: 53714.9722s
	iters: 800, epoch: 3 | loss: 0.0731927
	speed: 0.0989s/iter; left time: 53482.7429s
	iters: 900, epoch: 3 | loss: 0.0631078
	speed: 0.0995s/iter; left time: 53811.1770s
	iters: 1000, epoch: 3 | loss: 0.0749499
	speed: 0.0987s/iter; left time: 53367.9577s
	iters: 1100, epoch: 3 | loss: 0.0754070
	speed: 0.0982s/iter; left time: 53079.3909s
	iters: 1200, epoch: 3 | loss: 0.0659580
	speed: 0.0987s/iter; left time: 53347.1509s
	iters: 1300, epoch: 3 | loss: 0.0649213
	speed: 0.0994s/iter; left time: 53720.3749s
	iters: 1400, epoch: 3 | loss: 0.0867308
	speed: 0.0995s/iter; left time: 53767.2694s
	iters: 1500, epoch: 3 | loss: 0.0768112
	speed: 0.0987s/iter; left time: 53301.0320s
	iters: 1600, epoch: 3 | loss: 0.0738052
	speed: 0.0992s/iter; left time: 53564.8540s
	iters: 1700, epoch: 3 | loss: 0.0599543
	speed: 0.0996s/iter; left time: 53762.5228s
	iters: 1800, epoch: 3 | loss: 0.0668900
	speed: 0.0998s/iter; left time: 53879.0606s
	iters: 1900, epoch: 3 | loss: 0.0764192
	speed: 0.0989s/iter; left time: 53352.8388s
	iters: 2000, epoch: 3 | loss: 0.0677334
	speed: 0.0990s/iter; left time: 53418.7843s
	iters: 2100, epoch: 3 | loss: 0.0679583
	speed: 0.0989s/iter; left time: 53331.1680s
	iters: 2200, epoch: 3 | loss: 0.0837155
	speed: 0.0994s/iter; left time: 53627.3135s
	iters: 2300, epoch: 3 | loss: 0.0631923
	speed: 0.0991s/iter; left time: 53436.1148s
	iters: 2400, epoch: 3 | loss: 0.0667662
	speed: 0.0992s/iter; left time: 53498.8643s
	iters: 2500, epoch: 3 | loss: 0.0649714
	speed: 0.1003s/iter; left time: 54073.2564s
	iters: 2600, epoch: 3 | loss: 0.0664742
	speed: 0.1002s/iter; left time: 54020.1945s
	iters: 2700, epoch: 3 | loss: 0.2600297
	speed: 0.0991s/iter; left time: 53390.1683s
Epoch: 3 cost time: 271.7335789203644
Epoch: 3, Steps: 2735 | Train Loss: 0.0810998 Vali Loss: 0.1828250 Test Loss: 0.2588726
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.2252491
	speed: 3.0576s/iter; left time: 1647125.8338s
	iters: 200, epoch: 4 | loss: 0.2204090
	speed: 0.0988s/iter; left time: 53226.4168s
	iters: 300, epoch: 4 | loss: 0.1903162
	speed: 0.0988s/iter; left time: 53213.3927s
	iters: 400, epoch: 4 | loss: 0.1562977
	speed: 0.0984s/iter; left time: 52992.1075s
	iters: 500, epoch: 4 | loss: 0.1444571
	speed: 0.0987s/iter; left time: 53120.1236s
	iters: 600, epoch: 4 | loss: 0.1415520
	speed: 0.0984s/iter; left time: 52979.8287s
	iters: 700, epoch: 4 | loss: 0.1160314
	speed: 0.0988s/iter; left time: 53162.4781s
	iters: 800, epoch: 4 | loss: 0.1408898
	speed: 0.0987s/iter; left time: 53119.2396s
	iters: 900, epoch: 4 | loss: 0.0914722
	speed: 0.0987s/iter; left time: 53099.1770s
	iters: 1000, epoch: 4 | loss: 0.1011077
	speed: 0.0987s/iter; left time: 53101.9415s
	iters: 1100, epoch: 4 | loss: 0.0925063
	speed: 0.0990s/iter; left time: 53227.3420s
	iters: 1200, epoch: 4 | loss: 0.0852929
	speed: 0.0985s/iter; left time: 52963.2671s
	iters: 1300, epoch: 4 | loss: 0.1104076
	speed: 0.0986s/iter; left time: 53000.0345s
	iters: 1400, epoch: 4 | loss: 0.0753421
	speed: 0.0987s/iter; left time: 53024.5615s
	iters: 1500, epoch: 4 | loss: 0.1037697
	speed: 0.0988s/iter; left time: 53065.3586s
	iters: 1600, epoch: 4 | loss: 0.0805761
	speed: 0.0987s/iter; left time: 53034.2342s
	iters: 1700, epoch: 4 | loss: 0.0741214
	speed: 0.0990s/iter; left time: 53174.9606s
	iters: 1800, epoch: 4 | loss: 0.0992003
	speed: 0.0990s/iter; left time: 53165.8744s
	iters: 1900, epoch: 4 | loss: 0.0831981
	speed: 0.0985s/iter; left time: 52870.2568s
	iters: 2000, epoch: 4 | loss: 0.0722152
	speed: 0.0992s/iter; left time: 53229.7594s
	iters: 2100, epoch: 4 | loss: 0.0875112
	speed: 0.0987s/iter; left time: 52953.0898s
	iters: 2200, epoch: 4 | loss: 0.0805020
	speed: 0.0987s/iter; left time: 52968.8972s
	iters: 2300, epoch: 4 | loss: 0.0903880
	speed: 0.0989s/iter; left time: 53066.7382s
	iters: 2400, epoch: 4 | loss: 0.0806700
	speed: 0.0987s/iter; left time: 52961.2067s
	iters: 2500, epoch: 4 | loss: 0.0929612
	speed: 0.0989s/iter; left time: 53015.6393s
	iters: 2600, epoch: 4 | loss: 0.0795525
	speed: 0.0985s/iter; left time: 52808.8356s
	iters: 2700, epoch: 4 | loss: 0.0696881
	speed: 0.0987s/iter; left time: 52929.7993s
Epoch: 4 cost time: 270.38738656044006
Epoch: 4, Steps: 2735 | Train Loss: 0.1083910 Vali Loss: 0.1013301 Test Loss: 0.1824169
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.0650037
	speed: 3.0595s/iter; left time: 1639755.9338s
	iters: 200, epoch: 5 | loss: 0.0785328
	speed: 0.0987s/iter; left time: 52910.3355s
	iters: 300, epoch: 5 | loss: 0.0643376
	speed: 0.0982s/iter; left time: 52634.6954s
	iters: 400, epoch: 5 | loss: 0.0679791
	speed: 0.0989s/iter; left time: 53000.4503s
	iters: 500, epoch: 5 | loss: 0.0746352
	speed: 0.0983s/iter; left time: 52650.2937s
	iters: 600, epoch: 5 | loss: 0.0557310
	speed: 0.0987s/iter; left time: 52852.0491s
	iters: 700, epoch: 5 | loss: 0.0647878
	speed: 0.0988s/iter; left time: 52907.3057s
	iters: 800, epoch: 5 | loss: 0.0705930
	speed: 0.0979s/iter; left time: 52418.2832s
	iters: 900, epoch: 5 | loss: 0.0572859
	speed: 0.0985s/iter; left time: 52721.6094s
	iters: 1000, epoch: 5 | loss: 0.0649929
	speed: 0.0985s/iter; left time: 52708.6669s
	iters: 1100, epoch: 5 | loss: 0.0614760
	speed: 0.0985s/iter; left time: 52704.3131s
	iters: 1200, epoch: 5 | loss: 0.0689738
	speed: 0.0985s/iter; left time: 52660.1427s
	iters: 1300, epoch: 5 | loss: 0.0600315
	speed: 0.0984s/iter; left time: 52615.3629s
	iters: 1400, epoch: 5 | loss: 0.0603830
	speed: 0.0987s/iter; left time: 52760.8142s
	iters: 1500, epoch: 5 | loss: 0.0701315
	speed: 0.0983s/iter; left time: 52521.5106s
	iters: 1600, epoch: 5 | loss: 0.0644581
	speed: 0.0987s/iter; left time: 52752.7655s
	iters: 1700, epoch: 5 | loss: 0.0658586
	speed: 0.0980s/iter; left time: 52354.1394s
	iters: 1800, epoch: 5 | loss: 0.0580853
	speed: 0.0989s/iter; left time: 52818.0674s
	iters: 1900, epoch: 5 | loss: 0.0577326
	speed: 0.0983s/iter; left time: 52513.4843s
	iters: 2000, epoch: 5 | loss: 0.0744371
	speed: 0.0988s/iter; left time: 52766.1900s
	iters: 2100, epoch: 5 | loss: 0.0635774
	speed: 0.0983s/iter; left time: 52476.6168s
	iters: 2200, epoch: 5 | loss: 0.0668144
	speed: 0.0983s/iter; left time: 52453.2092s
	iters: 2300, epoch: 5 | loss: 0.0576918
	speed: 0.0990s/iter; left time: 52829.7282s
	iters: 2400, epoch: 5 | loss: 0.0510636
	speed: 0.0988s/iter; left time: 52732.6366s
	iters: 2500, epoch: 5 | loss: 0.0613486
	speed: 0.0984s/iter; left time: 52488.0615s
	iters: 2600, epoch: 5 | loss: 0.0576205
	speed: 0.0986s/iter; left time: 52577.5381s
	iters: 2700, epoch: 5 | loss: 0.0769516
	speed: 0.0980s/iter; left time: 52291.4647s
Epoch: 5 cost time: 269.7618317604065
Epoch: 5, Steps: 2735 | Train Loss: 0.0669136 Vali Loss: 0.1152310 Test Loss: 0.2161075
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.0647995
	speed: 3.0601s/iter; left time: 1631709.4209s
	iters: 200, epoch: 6 | loss: 0.0642041
	speed: 0.0997s/iter; left time: 53127.3070s
	iters: 300, epoch: 6 | loss: 0.0567337
	speed: 0.0989s/iter; left time: 52737.9181s
	iters: 400, epoch: 6 | loss: 0.0544577
	speed: 0.0992s/iter; left time: 52843.3495s
	iters: 500, epoch: 6 | loss: 0.0642046
	speed: 0.0984s/iter; left time: 52441.2279s
	iters: 600, epoch: 6 | loss: 0.0629706
	speed: 0.0990s/iter; left time: 52742.9685s
	iters: 700, epoch: 6 | loss: 0.0687046
	speed: 0.0989s/iter; left time: 52698.4459s
	iters: 800, epoch: 6 | loss: 0.0568155
	speed: 0.0989s/iter; left time: 52657.4863s
	iters: 900, epoch: 6 | loss: 0.0723828
	speed: 0.0986s/iter; left time: 52472.4472s
	iters: 1000, epoch: 6 | loss: 0.0468454
	speed: 0.0990s/iter; left time: 52695.2867s
	iters: 1100, epoch: 6 | loss: 0.0530938
	speed: 0.0990s/iter; left time: 52699.6719s
	iters: 1200, epoch: 6 | loss: 0.0549438
	speed: 0.0992s/iter; left time: 52762.6423s
	iters: 1300, epoch: 6 | loss: 0.0634696
	speed: 0.0985s/iter; left time: 52412.7547s
	iters: 1400, epoch: 6 | loss: 0.0624258
	speed: 0.0992s/iter; left time: 52793.1188s
	iters: 1500, epoch: 6 | loss: 0.0549483
	speed: 0.0995s/iter; left time: 52938.4533s
	iters: 1600, epoch: 6 | loss: 0.0573942
	speed: 0.0988s/iter; left time: 52514.4257s
	iters: 1700, epoch: 6 | loss: 0.0611211
	speed: 0.0990s/iter; left time: 52608.8859s
	iters: 1800, epoch: 6 | loss: 0.0507549
	speed: 0.0988s/iter; left time: 52488.7640s
	iters: 1900, epoch: 6 | loss: 0.0629882
	speed: 0.0986s/iter; left time: 52391.3240s
	iters: 2000, epoch: 6 | loss: 0.0588380
	speed: 0.0990s/iter; left time: 52599.3465s
	iters: 2100, epoch: 6 | loss: 0.0834140
	speed: 0.0987s/iter; left time: 52454.9731s
	iters: 2200, epoch: 6 | loss: 0.0533274
	speed: 0.0991s/iter; left time: 52608.9254s
	iters: 2300, epoch: 6 | loss: 0.0645088
	speed: 0.0990s/iter; left time: 52583.1919s
	iters: 2400, epoch: 6 | loss: 0.0598559
	speed: 0.0988s/iter; left time: 52448.6869s
	iters: 2500, epoch: 6 | loss: 0.0565258
	speed: 0.0984s/iter; left time: 52248.7687s
	iters: 2600, epoch: 6 | loss: 0.0579943
	speed: 0.0986s/iter; left time: 52351.3331s
	iters: 2700, epoch: 6 | loss: 0.0521941
	speed: 0.0991s/iter; left time: 52566.5766s
Epoch: 6 cost time: 270.89200830459595
Epoch: 6, Steps: 2735 | Train Loss: 0.0591210 Vali Loss: 0.1117468 Test Loss: 0.2524721
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 24965
test shape: (24965, 1, 96, 130) (24965, 1, 96, 130)
test shape: (24965, 96, 130) (24965, 96, 130)
mse:0.16362743079662323, mae:0.2711876630783081
>>>>>>>Overall time: 3862 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
