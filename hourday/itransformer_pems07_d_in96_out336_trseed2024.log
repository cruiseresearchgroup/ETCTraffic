Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems07_d.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems07_d_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_d_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5143
val 463
test 1257
	iters: 100, epoch: 1 | loss: 0.6932675
	speed: 0.3493s/iter; left time: 1086.6804s
	iters: 200, epoch: 1 | loss: 0.7998275
	speed: 0.3451s/iter; left time: 1039.1068s
	iters: 300, epoch: 1 | loss: 0.7700474
	speed: 0.3452s/iter; left time: 1004.9855s
Epoch: 1 cost time: 111.37470126152039
Epoch: 1, Steps: 321 | Train Loss: 0.8172008 Vali Loss: 1.4968516 Test Loss: 2.0575972
Validation loss decreased (inf --> 1.496852).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.8145493
	speed: 0.6988s/iter; left time: 1949.6191s
	iters: 200, epoch: 2 | loss: 0.8296940
	speed: 0.3456s/iter; left time: 929.7342s
	iters: 300, epoch: 2 | loss: 0.7235982
	speed: 0.3460s/iter; left time: 896.0657s
Epoch: 2 cost time: 111.3042221069336
Epoch: 2, Steps: 321 | Train Loss: 0.7856620 Vali Loss: 1.4838054 Test Loss: 2.0715706
Validation loss decreased (1.496852 --> 1.483805).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.7340622
	speed: 0.6911s/iter; left time: 1706.4327s
	iters: 200, epoch: 3 | loss: 0.7431527
	speed: 0.3454s/iter; left time: 818.3149s
	iters: 300, epoch: 3 | loss: 0.7014943
	speed: 0.3452s/iter; left time: 783.3445s
Epoch: 3 cost time: 111.24199056625366
Epoch: 3, Steps: 321 | Train Loss: 0.7542277 Vali Loss: 1.4609123 Test Loss: 2.0511382
Validation loss decreased (1.483805 --> 1.460912).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.7439240
	speed: 0.6906s/iter; left time: 1483.5091s
	iters: 200, epoch: 4 | loss: 0.6588774
	speed: 0.3461s/iter; left time: 708.8430s
	iters: 300, epoch: 4 | loss: 0.7441173
	speed: 0.3465s/iter; left time: 675.0268s
Epoch: 4 cost time: 111.35055351257324
Epoch: 4, Steps: 321 | Train Loss: 0.7290596 Vali Loss: 1.4572688 Test Loss: 2.0749910
Validation loss decreased (1.460912 --> 1.457269).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.7461095
	speed: 0.6897s/iter; left time: 1260.0256s
	iters: 200, epoch: 5 | loss: 0.7117511
	speed: 0.3470s/iter; left time: 599.2076s
	iters: 300, epoch: 5 | loss: 0.6854567
	speed: 0.3462s/iter; left time: 563.2541s
Epoch: 5 cost time: 111.60722589492798
Epoch: 5, Steps: 321 | Train Loss: 0.7097795 Vali Loss: 1.4343957 Test Loss: 2.0868127
Validation loss decreased (1.457269 --> 1.434396).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.7018135
	speed: 0.6910s/iter; left time: 1040.5910s
	iters: 200, epoch: 6 | loss: 0.6735917
	speed: 0.3454s/iter; left time: 485.5768s
	iters: 300, epoch: 6 | loss: 0.6705632
	speed: 0.3454s/iter; left time: 451.1499s
Epoch: 6 cost time: 111.21017622947693
Epoch: 6, Steps: 321 | Train Loss: 0.6985550 Vali Loss: 1.4353466 Test Loss: 2.0782263
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.6229348
	speed: 0.6888s/iter; left time: 816.2634s
	iters: 200, epoch: 7 | loss: 0.7235913
	speed: 0.3450s/iter; left time: 374.3610s
	iters: 300, epoch: 7 | loss: 0.7305816
	speed: 0.3451s/iter; left time: 339.8978s
Epoch: 7 cost time: 111.10912156105042
Epoch: 7, Steps: 321 | Train Loss: 0.6920620 Vali Loss: 1.4362632 Test Loss: 2.0723553
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.7121568
	speed: 0.6912s/iter; left time: 597.2161s
	iters: 200, epoch: 8 | loss: 0.7336552
	speed: 0.3453s/iter; left time: 263.7826s
	iters: 300, epoch: 8 | loss: 0.7039310
	speed: 0.3454s/iter; left time: 229.3370s
Epoch: 8 cost time: 111.2374050617218
Epoch: 8, Steps: 321 | Train Loss: 0.6887357 Vali Loss: 1.4321110 Test Loss: 2.0779986
Validation loss decreased (1.434396 --> 1.432111).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.7151517
	speed: 0.6910s/iter; left time: 375.2167s
	iters: 200, epoch: 9 | loss: 0.7187481
	speed: 0.3456s/iter; left time: 153.0809s
	iters: 300, epoch: 9 | loss: 0.7280079
	speed: 0.3454s/iter; left time: 118.4638s
Epoch: 9 cost time: 111.17861270904541
Epoch: 9, Steps: 321 | Train Loss: 0.6874111 Vali Loss: 1.4412403 Test Loss: 2.0773830
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.6543710
	speed: 0.6897s/iter; left time: 153.1169s
	iters: 200, epoch: 10 | loss: 0.6588482
	speed: 0.3451s/iter; left time: 42.1078s
	iters: 300, epoch: 10 | loss: 0.6837785
	speed: 0.3450s/iter; left time: 7.5901s
Epoch: 10 cost time: 111.10207438468933
Epoch: 10, Steps: 321 | Train Loss: 0.6863548 Vali Loss: 1.4416845 Test Loss: 2.0770867
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_pems07_d_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1257
test shape: (1257, 1, 336, 1613) (1257, 1, 336, 1613)
test shape: (1257, 336, 1613) (1257, 336, 1613)
mse:2.077993631362915, mae:0.8192642331123352
>>>>>>>Overall time: 1417 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
