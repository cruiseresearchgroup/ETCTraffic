Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems03_h.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems03_h_720_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=720, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_h_720_720_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 132356
val 18395
test 37508
	iters: 100, epoch: 1 | loss: 0.2180560
	speed: 0.0332s/iter; left time: 27467.2362s
	iters: 200, epoch: 1 | loss: 0.2341930
	speed: 0.0267s/iter; left time: 22088.7472s
	iters: 300, epoch: 1 | loss: 0.2165536
	speed: 0.0269s/iter; left time: 22241.3879s
	iters: 400, epoch: 1 | loss: 0.2132667
	speed: 0.0269s/iter; left time: 22266.6367s
	iters: 500, epoch: 1 | loss: 0.2398361
	speed: 0.0270s/iter; left time: 22318.2508s
	iters: 600, epoch: 1 | loss: 0.2194169
	speed: 0.0270s/iter; left time: 22359.3889s
	iters: 700, epoch: 1 | loss: 0.2389693
	speed: 0.0271s/iter; left time: 22386.1926s
	iters: 800, epoch: 1 | loss: 0.2108420
	speed: 0.0271s/iter; left time: 22435.9550s
	iters: 900, epoch: 1 | loss: 0.2261280
	speed: 0.0271s/iter; left time: 22391.2208s
	iters: 1000, epoch: 1 | loss: 0.2271366
	speed: 0.0271s/iter; left time: 22396.1184s
	iters: 1100, epoch: 1 | loss: 0.2275091
	speed: 0.0271s/iter; left time: 22418.9393s
	iters: 1200, epoch: 1 | loss: 0.2303456
	speed: 0.0271s/iter; left time: 22417.1452s
	iters: 1300, epoch: 1 | loss: 0.2532613
	speed: 0.0272s/iter; left time: 22473.6874s
	iters: 1400, epoch: 1 | loss: 0.2395778
	speed: 0.0271s/iter; left time: 22413.7708s
	iters: 1500, epoch: 1 | loss: 0.1992390
	speed: 0.0271s/iter; left time: 22380.0272s
	iters: 1600, epoch: 1 | loss: 0.2026525
	speed: 0.0271s/iter; left time: 22395.9495s
	iters: 1700, epoch: 1 | loss: 0.2170563
	speed: 0.0271s/iter; left time: 22408.7360s
	iters: 1800, epoch: 1 | loss: 0.2043711
	speed: 0.0271s/iter; left time: 22406.4819s
	iters: 1900, epoch: 1 | loss: 0.1938776
	speed: 0.0272s/iter; left time: 22429.4119s
	iters: 2000, epoch: 1 | loss: 0.2137926
	speed: 0.0272s/iter; left time: 22411.1239s
	iters: 2100, epoch: 1 | loss: 0.1982937
	speed: 0.0271s/iter; left time: 22365.1967s
	iters: 2200, epoch: 1 | loss: 0.2445668
	speed: 0.0271s/iter; left time: 22366.9885s
	iters: 2300, epoch: 1 | loss: 0.2253113
	speed: 0.0271s/iter; left time: 22389.8387s
	iters: 2400, epoch: 1 | loss: 0.2201735
	speed: 0.0271s/iter; left time: 22333.0798s
	iters: 2500, epoch: 1 | loss: 0.1907551
	speed: 0.0271s/iter; left time: 22341.0448s
	iters: 2600, epoch: 1 | loss: 0.2108847
	speed: 0.0272s/iter; left time: 22388.3057s
	iters: 2700, epoch: 1 | loss: 0.2243140
	speed: 0.0272s/iter; left time: 22398.7377s
	iters: 2800, epoch: 1 | loss: 0.2405096
	speed: 0.0271s/iter; left time: 22372.2598s
	iters: 2900, epoch: 1 | loss: 0.2191556
	speed: 0.0271s/iter; left time: 22378.8301s
	iters: 3000, epoch: 1 | loss: 0.2226198
	speed: 0.0272s/iter; left time: 22387.2118s
	iters: 3100, epoch: 1 | loss: 0.1959086
	speed: 0.0272s/iter; left time: 22389.9008s
	iters: 3200, epoch: 1 | loss: 0.2204740
	speed: 0.0272s/iter; left time: 22406.0634s
	iters: 3300, epoch: 1 | loss: 0.2040489
	speed: 0.0272s/iter; left time: 22420.7679s
	iters: 3400, epoch: 1 | loss: 0.2496550
	speed: 0.0272s/iter; left time: 22373.8328s
	iters: 3500, epoch: 1 | loss: 0.2070421
	speed: 0.0271s/iter; left time: 22304.5815s
	iters: 3600, epoch: 1 | loss: 0.2292603
	speed: 0.0271s/iter; left time: 22318.7156s
	iters: 3700, epoch: 1 | loss: 0.2166268
	speed: 0.0271s/iter; left time: 22323.8081s
	iters: 3800, epoch: 1 | loss: 0.2478662
	speed: 0.0271s/iter; left time: 22350.5405s
	iters: 3900, epoch: 1 | loss: 0.2214809
	speed: 0.0271s/iter; left time: 22343.2643s
	iters: 4000, epoch: 1 | loss: 0.2539654
	speed: 0.0272s/iter; left time: 22351.8397s
	iters: 4100, epoch: 1 | loss: 0.2351368
	speed: 0.0272s/iter; left time: 22352.5567s
Epoch: 1 cost time: 112.81923198699951
Epoch: 1, Steps: 4136 | Train Loss: 0.2199757 Vali Loss: 0.1725115 Test Loss: 0.1547612
Validation loss decreased (inf --> 0.172511).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1926792
	speed: 1.3866s/iter; left time: 1141102.0084s
	iters: 200, epoch: 2 | loss: 0.2397687
	speed: 0.0274s/iter; left time: 22542.0790s
	iters: 300, epoch: 2 | loss: 0.1930020
	speed: 0.0276s/iter; left time: 22689.5373s
	iters: 400, epoch: 2 | loss: 0.2075549
	speed: 0.0277s/iter; left time: 22757.7660s
	iters: 500, epoch: 2 | loss: 0.2001947
	speed: 0.0277s/iter; left time: 22794.4462s
	iters: 600, epoch: 2 | loss: 0.2160971
	speed: 0.0278s/iter; left time: 22832.1796s
	iters: 700, epoch: 2 | loss: 0.2056951
	speed: 0.0278s/iter; left time: 22857.1039s
	iters: 800, epoch: 2 | loss: 0.2055217
	speed: 0.0278s/iter; left time: 22853.8853s
	iters: 900, epoch: 2 | loss: 0.2325452
	speed: 0.0278s/iter; left time: 22852.9368s
	iters: 1000, epoch: 2 | loss: 0.2394783
	speed: 0.0276s/iter; left time: 22709.2305s
	iters: 1100, epoch: 2 | loss: 0.2157550
	speed: 0.0277s/iter; left time: 22752.8800s
	iters: 1200, epoch: 2 | loss: 0.1884214
	speed: 0.0277s/iter; left time: 22797.6919s
	iters: 1300, epoch: 2 | loss: 0.2009647
	speed: 0.0277s/iter; left time: 22766.0741s
	iters: 1400, epoch: 2 | loss: 0.2201283
	speed: 0.0277s/iter; left time: 22735.2645s
	iters: 1500, epoch: 2 | loss: 0.2030118
	speed: 0.0277s/iter; left time: 22748.1246s
	iters: 1600, epoch: 2 | loss: 0.2498414
	speed: 0.0277s/iter; left time: 22742.2240s
	iters: 1700, epoch: 2 | loss: 0.2295832
	speed: 0.0277s/iter; left time: 22756.0716s
	iters: 1800, epoch: 2 | loss: 0.2111428
	speed: 0.0277s/iter; left time: 22735.3340s
	iters: 1900, epoch: 2 | loss: 0.2329511
	speed: 0.0277s/iter; left time: 22724.0492s
	iters: 2000, epoch: 2 | loss: 0.2365278
	speed: 0.0277s/iter; left time: 22728.4192s
	iters: 2100, epoch: 2 | loss: 0.1812721
	speed: 0.0277s/iter; left time: 22734.1400s
	iters: 2200, epoch: 2 | loss: 0.2180045
	speed: 0.0277s/iter; left time: 22726.7110s
	iters: 2300, epoch: 2 | loss: 0.2066307
	speed: 0.0277s/iter; left time: 22714.2735s
	iters: 2400, epoch: 2 | loss: 0.2235386
	speed: 0.0277s/iter; left time: 22713.4822s
	iters: 2500, epoch: 2 | loss: 0.2155234
	speed: 0.0273s/iter; left time: 22384.9246s
	iters: 2600, epoch: 2 | loss: 0.2334329
	speed: 0.0273s/iter; left time: 22391.4706s
	iters: 2700, epoch: 2 | loss: 0.2115831
	speed: 0.0273s/iter; left time: 22391.9864s
	iters: 2800, epoch: 2 | loss: 0.2383230
	speed: 0.0273s/iter; left time: 22372.2367s
	iters: 2900, epoch: 2 | loss: 0.1975124
	speed: 0.0273s/iter; left time: 22403.5161s
	iters: 3000, epoch: 2 | loss: 0.2458624
	speed: 0.0273s/iter; left time: 22382.7948s
	iters: 3100, epoch: 2 | loss: 0.2153585
	speed: 0.0273s/iter; left time: 22384.4699s
	iters: 3200, epoch: 2 | loss: 0.2301993
	speed: 0.0273s/iter; left time: 22409.6141s
	iters: 3300, epoch: 2 | loss: 0.2043476
	speed: 0.0273s/iter; left time: 22398.7209s
	iters: 3400, epoch: 2 | loss: 0.2005055
	speed: 0.0273s/iter; left time: 22359.3721s
	iters: 3500, epoch: 2 | loss: 0.2363060
	speed: 0.0273s/iter; left time: 22384.2288s
	iters: 3600, epoch: 2 | loss: 0.2176881
	speed: 0.0273s/iter; left time: 22369.3979s
	iters: 3700, epoch: 2 | loss: 0.2347121
	speed: 0.0273s/iter; left time: 22364.9666s
	iters: 3800, epoch: 2 | loss: 0.2371529
	speed: 0.0273s/iter; left time: 22367.6516s
	iters: 3900, epoch: 2 | loss: 0.1969328
	speed: 0.0273s/iter; left time: 22375.1788s
	iters: 4000, epoch: 2 | loss: 0.2330570
	speed: 0.0273s/iter; left time: 22382.6605s
	iters: 4100, epoch: 2 | loss: 0.2320629
	speed: 0.0274s/iter; left time: 22449.3668s
Epoch: 2 cost time: 114.36064505577087
Epoch: 2, Steps: 4136 | Train Loss: 0.2173431 Vali Loss: 0.1731943 Test Loss: 0.1559457
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.1976656
	speed: 1.2892s/iter; left time: 1055629.9744s
	iters: 200, epoch: 3 | loss: 0.2071124
	speed: 0.0269s/iter; left time: 21985.8871s
	iters: 300, epoch: 3 | loss: 0.2400772
	speed: 0.0270s/iter; left time: 22123.4828s
	iters: 400, epoch: 3 | loss: 0.2140867
	speed: 0.0271s/iter; left time: 22178.1102s
	iters: 500, epoch: 3 | loss: 0.2155645
	speed: 0.0271s/iter; left time: 22210.3170s
	iters: 600, epoch: 3 | loss: 0.2296454
	speed: 0.0272s/iter; left time: 22232.9435s
	iters: 700, epoch: 3 | loss: 0.2402507
	speed: 0.0272s/iter; left time: 22288.9889s
	iters: 800, epoch: 3 | loss: 0.2109137
	speed: 0.0272s/iter; left time: 22254.3457s
	iters: 900, epoch: 3 | loss: 0.2056101
	speed: 0.0273s/iter; left time: 22294.5563s
	iters: 1000, epoch: 3 | loss: 0.2329829
	speed: 0.0272s/iter; left time: 22282.5289s
	iters: 1100, epoch: 3 | loss: 0.2052519
	speed: 0.0272s/iter; left time: 22277.2523s
	iters: 1200, epoch: 3 | loss: 0.2371752
	speed: 0.0272s/iter; left time: 22275.7917s
	iters: 1300, epoch: 3 | loss: 0.2126430
	speed: 0.0272s/iter; left time: 22268.8277s
	iters: 1400, epoch: 3 | loss: 0.2216554
	speed: 0.0273s/iter; left time: 22294.4817s
	iters: 1500, epoch: 3 | loss: 0.2247850
	speed: 0.0272s/iter; left time: 22264.3257s
	iters: 1600, epoch: 3 | loss: 0.2162044
	speed: 0.0273s/iter; left time: 22302.0602s
	iters: 1700, epoch: 3 | loss: 0.2354144
	speed: 0.0273s/iter; left time: 22287.1442s
	iters: 1800, epoch: 3 | loss: 0.2176825
	speed: 0.0273s/iter; left time: 22289.3479s
	iters: 1900, epoch: 3 | loss: 0.2207592
	speed: 0.0273s/iter; left time: 22299.7415s
	iters: 2000, epoch: 3 | loss: 0.2083281
	speed: 0.0273s/iter; left time: 22280.7955s
	iters: 2100, epoch: 3 | loss: 0.2444043
	speed: 0.0273s/iter; left time: 22303.4028s
	iters: 2200, epoch: 3 | loss: 0.1750988
	speed: 0.0273s/iter; left time: 22292.4374s
	iters: 2300, epoch: 3 | loss: 0.2429714
	speed: 0.0273s/iter; left time: 22294.9161s
	iters: 2400, epoch: 3 | loss: 0.2457160
	speed: 0.0273s/iter; left time: 22263.6368s
	iters: 2500, epoch: 3 | loss: 0.2047061
	speed: 0.0273s/iter; left time: 22280.2450s
	iters: 2600, epoch: 3 | loss: 0.1883669
	speed: 0.0273s/iter; left time: 22284.9683s
	iters: 2700, epoch: 3 | loss: 0.2014353
	speed: 0.0273s/iter; left time: 22295.0589s
	iters: 2800, epoch: 3 | loss: 0.2089106
	speed: 0.0273s/iter; left time: 22317.6793s
	iters: 2900, epoch: 3 | loss: 0.2323583
	speed: 0.0273s/iter; left time: 22265.0157s
	iters: 3000, epoch: 3 | loss: 0.2090331
	speed: 0.0273s/iter; left time: 22284.7927s
	iters: 3100, epoch: 3 | loss: 0.2084342
	speed: 0.0273s/iter; left time: 22277.1599s
	iters: 3200, epoch: 3 | loss: 0.2023972
	speed: 0.0273s/iter; left time: 22258.5321s
	iters: 3300, epoch: 3 | loss: 0.2247709
	speed: 0.0273s/iter; left time: 22279.0318s
	iters: 3400, epoch: 3 | loss: 0.2602925
	speed: 0.0273s/iter; left time: 22275.0792s
	iters: 3500, epoch: 3 | loss: 0.2208075
	speed: 0.0273s/iter; left time: 22253.5928s
	iters: 3600, epoch: 3 | loss: 0.2541500
	speed: 0.0273s/iter; left time: 22258.2622s
	iters: 3700, epoch: 3 | loss: 0.2232326
	speed: 0.0273s/iter; left time: 22229.6991s
	iters: 3800, epoch: 3 | loss: 0.2127716
	speed: 0.0273s/iter; left time: 22257.0525s
	iters: 3900, epoch: 3 | loss: 0.2051387
	speed: 0.0273s/iter; left time: 22237.4999s
	iters: 4000, epoch: 3 | loss: 0.1973578
	speed: 0.0273s/iter; left time: 22248.6732s
	iters: 4100, epoch: 3 | loss: 0.2331013
	speed: 0.0273s/iter; left time: 22231.8779s
Epoch: 3 cost time: 113.198401927948
Epoch: 3, Steps: 4136 | Train Loss: 0.2173961 Vali Loss: 0.1729430 Test Loss: 0.1552087
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.2147031
	speed: 1.2951s/iter; left time: 1055072.0825s
	iters: 200, epoch: 4 | loss: 0.2108079
	speed: 0.0269s/iter; left time: 21930.2470s
	iters: 300, epoch: 4 | loss: 0.2109423
	speed: 0.0271s/iter; left time: 22063.1501s
	iters: 400, epoch: 4 | loss: 0.2386686
	speed: 0.0272s/iter; left time: 22120.3902s
	iters: 500, epoch: 4 | loss: 0.2067939
	speed: 0.0272s/iter; left time: 22156.1434s
	iters: 600, epoch: 4 | loss: 0.1963187
	speed: 0.0273s/iter; left time: 22193.6982s
	iters: 700, epoch: 4 | loss: 0.2060498
	speed: 0.0273s/iter; left time: 22216.6531s
	iters: 800, epoch: 4 | loss: 0.2203986
	speed: 0.0273s/iter; left time: 22231.0644s
	iters: 900, epoch: 4 | loss: 0.2405104
	speed: 0.0274s/iter; left time: 22292.8870s
	iters: 1000, epoch: 4 | loss: 0.2164486
	speed: 0.0273s/iter; left time: 22239.8842s
	iters: 1100, epoch: 4 | loss: 0.2631059
	speed: 0.0274s/iter; left time: 22287.9560s
	iters: 1200, epoch: 4 | loss: 0.2057312
	speed: 0.0274s/iter; left time: 22281.3315s
	iters: 1300, epoch: 4 | loss: 0.2219746
	speed: 0.0274s/iter; left time: 22265.0648s
	iters: 1400, epoch: 4 | loss: 0.2250319
	speed: 0.0274s/iter; left time: 22286.2934s
	iters: 1500, epoch: 4 | loss: 0.1993575
	speed: 0.0274s/iter; left time: 22268.7373s
	iters: 1600, epoch: 4 | loss: 0.2217758
	speed: 0.0274s/iter; left time: 22242.3690s
	iters: 1700, epoch: 4 | loss: 0.1952329
	speed: 0.0274s/iter; left time: 22238.3622s
	iters: 1800, epoch: 4 | loss: 0.2373471
	speed: 0.0274s/iter; left time: 22272.6763s
	iters: 1900, epoch: 4 | loss: 0.2160876
	speed: 0.0274s/iter; left time: 22272.2217s
	iters: 2000, epoch: 4 | loss: 0.2322227
	speed: 0.0274s/iter; left time: 22269.0885s
	iters: 2100, epoch: 4 | loss: 0.1978410
	speed: 0.0274s/iter; left time: 22252.4036s
	iters: 2200, epoch: 4 | loss: 0.2246096
	speed: 0.0274s/iter; left time: 22273.2298s
	iters: 2300, epoch: 4 | loss: 0.2762729
	speed: 0.0274s/iter; left time: 22246.3908s
	iters: 2400, epoch: 4 | loss: 0.1941277
	speed: 0.0274s/iter; left time: 22233.8618s
	iters: 2500, epoch: 4 | loss: 0.2285072
	speed: 0.0274s/iter; left time: 22257.9244s
	iters: 2600, epoch: 4 | loss: 0.2129928
	speed: 0.0274s/iter; left time: 22241.3544s
	iters: 2700, epoch: 4 | loss: 0.1946699
	speed: 0.0274s/iter; left time: 22224.4392s
	iters: 2800, epoch: 4 | loss: 0.2207575
	speed: 0.0274s/iter; left time: 22220.0918s
	iters: 2900, epoch: 4 | loss: 0.2255573
	speed: 0.0274s/iter; left time: 22270.8234s
	iters: 3000, epoch: 4 | loss: 0.1809054
	speed: 0.0274s/iter; left time: 22221.6446s
	iters: 3100, epoch: 4 | loss: 0.2202815
	speed: 0.0274s/iter; left time: 22243.5272s
	iters: 3200, epoch: 4 | loss: 0.1880460
	speed: 0.0274s/iter; left time: 22214.3568s
	iters: 3300, epoch: 4 | loss: 0.2252359
	speed: 0.0274s/iter; left time: 22213.1772s
	iters: 3400, epoch: 4 | loss: 0.2307317
	speed: 0.0274s/iter; left time: 22198.6296s
	iters: 3500, epoch: 4 | loss: 0.2274544
	speed: 0.0274s/iter; left time: 22210.6059s
	iters: 3600, epoch: 4 | loss: 0.2041055
	speed: 0.0274s/iter; left time: 22221.4935s
	iters: 3700, epoch: 4 | loss: 0.2136073
	speed: 0.0274s/iter; left time: 22225.3483s
	iters: 3800, epoch: 4 | loss: 0.2184331
	speed: 0.0274s/iter; left time: 22218.1552s
	iters: 3900, epoch: 4 | loss: 0.2248398
	speed: 0.0274s/iter; left time: 22209.9056s
	iters: 4000, epoch: 4 | loss: 0.2150103
	speed: 0.0274s/iter; left time: 22193.2620s
	iters: 4100, epoch: 4 | loss: 0.2145880
	speed: 0.0274s/iter; left time: 22195.7299s
Epoch: 4 cost time: 113.59053778648376
Epoch: 4, Steps: 4136 | Train Loss: 0.2173738 Vali Loss: 0.1735948 Test Loss: 0.1557821
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.2154069
	speed: 1.2892s/iter; left time: 1044960.5654s
	iters: 200, epoch: 5 | loss: 0.2277241
	speed: 0.0270s/iter; left time: 21852.7678s
	iters: 300, epoch: 5 | loss: 0.2169954
	speed: 0.0271s/iter; left time: 21992.5093s
	iters: 400, epoch: 5 | loss: 0.2495920
	speed: 0.0272s/iter; left time: 22047.6780s
	iters: 500, epoch: 5 | loss: 0.2183574
	speed: 0.0273s/iter; left time: 22090.5746s
	iters: 600, epoch: 5 | loss: 0.2175437
	speed: 0.0273s/iter; left time: 22122.0305s
	iters: 700, epoch: 5 | loss: 0.2118136
	speed: 0.0274s/iter; left time: 22168.3241s
	iters: 800, epoch: 5 | loss: 0.2296111
	speed: 0.0273s/iter; left time: 22134.1703s
	iters: 900, epoch: 5 | loss: 0.2495734
	speed: 0.0274s/iter; left time: 22154.4887s
	iters: 1000, epoch: 5 | loss: 0.2112971
	speed: 0.0274s/iter; left time: 22154.9822s
	iters: 1100, epoch: 5 | loss: 0.2114067
	speed: 0.0274s/iter; left time: 22161.5607s
	iters: 1200, epoch: 5 | loss: 0.2150392
	speed: 0.0274s/iter; left time: 22159.8557s
	iters: 1300, epoch: 5 | loss: 0.2109471
	speed: 0.0274s/iter; left time: 22159.7637s
	iters: 1400, epoch: 5 | loss: 0.1897478
	speed: 0.0274s/iter; left time: 22153.0492s
	iters: 1500, epoch: 5 | loss: 0.2304352
	speed: 0.0274s/iter; left time: 22159.1416s
	iters: 1600, epoch: 5 | loss: 0.2321943
	speed: 0.0274s/iter; left time: 22136.5484s
	iters: 1700, epoch: 5 | loss: 0.2172451
	speed: 0.0274s/iter; left time: 22157.0050s
	iters: 1800, epoch: 5 | loss: 0.2256602
	speed: 0.0274s/iter; left time: 22157.8164s
	iters: 1900, epoch: 5 | loss: 0.1932486
	speed: 0.0274s/iter; left time: 22165.4797s
	iters: 2000, epoch: 5 | loss: 0.2333288
	speed: 0.0274s/iter; left time: 22175.1264s
	iters: 2100, epoch: 5 | loss: 0.2225517
	speed: 0.0274s/iter; left time: 22157.6581s
	iters: 2200, epoch: 5 | loss: 0.2259895
	speed: 0.0274s/iter; left time: 22161.5984s
	iters: 2300, epoch: 5 | loss: 0.2104656
	speed: 0.0274s/iter; left time: 22139.8909s
	iters: 2400, epoch: 5 | loss: 0.2056499
	speed: 0.0274s/iter; left time: 22185.7519s
	iters: 2500, epoch: 5 | loss: 0.2149187
	speed: 0.0274s/iter; left time: 22129.5461s
	iters: 2600, epoch: 5 | loss: 0.2042212
	speed: 0.0274s/iter; left time: 22140.0317s
	iters: 2700, epoch: 5 | loss: 0.1822783
	speed: 0.0274s/iter; left time: 22145.9911s
	iters: 2800, epoch: 5 | loss: 0.2180214
	speed: 0.0274s/iter; left time: 22131.0406s
	iters: 2900, epoch: 5 | loss: 0.2330072
	speed: 0.0274s/iter; left time: 22170.6697s
	iters: 3000, epoch: 5 | loss: 0.1768655
	speed: 0.0274s/iter; left time: 22156.2558s
	iters: 3100, epoch: 5 | loss: 0.2409513
	speed: 0.0274s/iter; left time: 22165.2380s
	iters: 3200, epoch: 5 | loss: 0.2399078
	speed: 0.0274s/iter; left time: 22152.6444s
	iters: 3300, epoch: 5 | loss: 0.2087798
	speed: 0.0274s/iter; left time: 22138.4362s
	iters: 3400, epoch: 5 | loss: 0.1937273
	speed: 0.0274s/iter; left time: 22149.2533s
	iters: 3500, epoch: 5 | loss: 0.2156163
	speed: 0.0274s/iter; left time: 22147.1869s
	iters: 3600, epoch: 5 | loss: 0.2160812
	speed: 0.0274s/iter; left time: 22140.8525s
	iters: 3700, epoch: 5 | loss: 0.2430412
	speed: 0.0274s/iter; left time: 22132.1372s
	iters: 3800, epoch: 5 | loss: 0.2047549
	speed: 0.0274s/iter; left time: 22136.6469s
	iters: 3900, epoch: 5 | loss: 0.2284761
	speed: 0.0274s/iter; left time: 22136.3192s
	iters: 4000, epoch: 5 | loss: 0.2228007
	speed: 0.0274s/iter; left time: 22131.8983s
	iters: 4100, epoch: 5 | loss: 0.2351903
	speed: 0.0274s/iter; left time: 22122.4261s
Epoch: 5 cost time: 113.69068908691406
Epoch: 5, Steps: 4136 | Train Loss: 0.2173496 Vali Loss: 0.1742802 Test Loss: 0.1556505
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.2247920
	speed: 1.2920s/iter; left time: 1041893.9751s
	iters: 200, epoch: 6 | loss: 0.2261426
	speed: 0.0269s/iter; left time: 21728.2838s
	iters: 300, epoch: 6 | loss: 0.1808171
	speed: 0.0270s/iter; left time: 21734.3638s
	iters: 400, epoch: 6 | loss: 0.2298501
	speed: 0.0270s/iter; left time: 21794.7865s
	iters: 500, epoch: 6 | loss: 0.2081066
	speed: 0.0270s/iter; left time: 21801.6164s
	iters: 600, epoch: 6 | loss: 0.2087641
	speed: 0.0271s/iter; left time: 21837.0142s
	iters: 700, epoch: 6 | loss: 0.2097702
	speed: 0.0271s/iter; left time: 21848.1394s
	iters: 800, epoch: 6 | loss: 0.1948726
	speed: 0.0271s/iter; left time: 21871.3826s
	iters: 900, epoch: 6 | loss: 0.2182300
	speed: 0.0272s/iter; left time: 21881.9174s
	iters: 1000, epoch: 6 | loss: 0.2102824
	speed: 0.0272s/iter; left time: 21882.2760s
	iters: 1100, epoch: 6 | loss: 0.2150426
	speed: 0.0272s/iter; left time: 21887.4729s
	iters: 1200, epoch: 6 | loss: 0.2001791
	speed: 0.0277s/iter; left time: 22316.5252s
	iters: 1300, epoch: 6 | loss: 0.2091486
	speed: 0.0278s/iter; left time: 22403.0342s
	iters: 1400, epoch: 6 | loss: 0.2244251
	speed: 0.0278s/iter; left time: 22418.5511s
	iters: 1500, epoch: 6 | loss: 0.2467483
	speed: 0.0278s/iter; left time: 22414.6918s
	iters: 1600, epoch: 6 | loss: 0.2438702
	speed: 0.0276s/iter; left time: 22193.7251s
	iters: 1700, epoch: 6 | loss: 0.2017273
	speed: 0.0274s/iter; left time: 22059.3506s
	iters: 1800, epoch: 6 | loss: 0.2107419
	speed: 0.0274s/iter; left time: 22049.8332s
	iters: 1900, epoch: 6 | loss: 0.2164034
	speed: 0.0274s/iter; left time: 22027.6428s
	iters: 2000, epoch: 6 | loss: 0.2096691
	speed: 0.0274s/iter; left time: 22040.5399s
	iters: 2100, epoch: 6 | loss: 0.2538867
	speed: 0.0275s/iter; left time: 22083.1679s
	iters: 2200, epoch: 6 | loss: 0.2314055
	speed: 0.0274s/iter; left time: 22063.4726s
	iters: 2300, epoch: 6 | loss: 0.2081086
	speed: 0.0274s/iter; left time: 22047.7237s
	iters: 2400, epoch: 6 | loss: 0.2022902
	speed: 0.0274s/iter; left time: 22023.2663s
	iters: 2500, epoch: 6 | loss: 0.2253944
	speed: 0.0274s/iter; left time: 22033.2828s
	iters: 2600, epoch: 6 | loss: 0.2430284
	speed: 0.0274s/iter; left time: 22039.8902s
	iters: 2700, epoch: 6 | loss: 0.2219114
	speed: 0.0274s/iter; left time: 22023.2715s
	iters: 2800, epoch: 6 | loss: 0.2510485
	speed: 0.0274s/iter; left time: 22013.3727s
	iters: 2900, epoch: 6 | loss: 0.2033249
	speed: 0.0274s/iter; left time: 22008.7753s
	iters: 3000, epoch: 6 | loss: 0.2107689
	speed: 0.0274s/iter; left time: 21998.2606s
	iters: 3100, epoch: 6 | loss: 0.2467262
	speed: 0.0274s/iter; left time: 22003.7614s
	iters: 3200, epoch: 6 | loss: 0.2021253
	speed: 0.0274s/iter; left time: 22021.7708s
	iters: 3300, epoch: 6 | loss: 0.1899076
	speed: 0.0274s/iter; left time: 22019.5656s
	iters: 3400, epoch: 6 | loss: 0.2440962
	speed: 0.0274s/iter; left time: 22000.4202s
	iters: 3500, epoch: 6 | loss: 0.2165990
	speed: 0.0274s/iter; left time: 21995.1154s
	iters: 3600, epoch: 6 | loss: 0.1999529
	speed: 0.0274s/iter; left time: 21994.7673s
	iters: 3700, epoch: 6 | loss: 0.2348216
	speed: 0.0274s/iter; left time: 21979.3817s
	iters: 3800, epoch: 6 | loss: 0.2108226
	speed: 0.0274s/iter; left time: 21980.7510s
	iters: 3900, epoch: 6 | loss: 0.2381315
	speed: 0.0274s/iter; left time: 22006.9004s
	iters: 4000, epoch: 6 | loss: 0.1932931
	speed: 0.0274s/iter; left time: 21974.8363s
	iters: 4100, epoch: 6 | loss: 0.1947271
	speed: 0.0275s/iter; left time: 22026.4747s
Epoch: 6 cost time: 113.63099646568298
Epoch: 6, Steps: 4136 | Train Loss: 0.2173767 Vali Loss: 0.1731370 Test Loss: 0.1554808
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_h_720_720_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 37508
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems03_h.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems03_h_720_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=720, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_h_720_720_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 132356
val 18395
test 37508
	iters: 100, epoch: 1 | loss: 0.2180560
	speed: 0.0314s/iter; left time: 26001.5061s
	iters: 200, epoch: 1 | loss: 0.2341930
	speed: 0.0264s/iter; left time: 21859.3864s
	iters: 300, epoch: 1 | loss: 0.2165536
	speed: 0.0265s/iter; left time: 21929.1618s
	iters: 400, epoch: 1 | loss: 0.2132667
	speed: 0.0259s/iter; left time: 21449.2590s
	iters: 500, epoch: 1 | loss: 0.2398361
	speed: 0.0258s/iter; left time: 21365.1360s
	iters: 600, epoch: 1 | loss: 0.2194169
	speed: 0.0264s/iter; left time: 21821.0552s
	iters: 700, epoch: 1 | loss: 0.2389693
	speed: 0.0263s/iter; left time: 21775.6726s
	iters: 800, epoch: 1 | loss: 0.2108420
	speed: 0.0264s/iter; left time: 21809.0411s
	iters: 900, epoch: 1 | loss: 0.2261280
	speed: 0.0267s/iter; left time: 22055.5549s
	iters: 1000, epoch: 1 | loss: 0.2271366
	speed: 0.0267s/iter; left time: 22021.3352s
	iters: 1100, epoch: 1 | loss: 0.2275091
	speed: 0.0268s/iter; left time: 22126.8508s
	iters: 1200, epoch: 1 | loss: 0.2303456
	speed: 0.0266s/iter; left time: 22002.2643s
	iters: 1300, epoch: 1 | loss: 0.2532613
	speed: 0.0266s/iter; left time: 21980.0829s
	iters: 1400, epoch: 1 | loss: 0.2395778
	speed: 0.0267s/iter; left time: 22069.7573s
	iters: 1500, epoch: 1 | loss: 0.1992390
	speed: 0.0267s/iter; left time: 22023.4482s
	iters: 1600, epoch: 1 | loss: 0.2026525
	speed: 0.0262s/iter; left time: 21664.1488s
	iters: 1700, epoch: 1 | loss: 0.2170563
	speed: 0.0264s/iter; left time: 21803.1999s
	iters: 1800, epoch: 1 | loss: 0.2043711
	speed: 0.0264s/iter; left time: 21789.9989s
	iters: 1900, epoch: 1 | loss: 0.1938776
	speed: 0.0264s/iter; left time: 21766.4603s
	iters: 2000, epoch: 1 | loss: 0.2137926
	speed: 0.0264s/iter; left time: 21762.1722s
	iters: 2100, epoch: 1 | loss: 0.1982937
	speed: 0.0263s/iter; left time: 21727.2219s
	iters: 2200, epoch: 1 | loss: 0.2445668
	speed: 0.0264s/iter; left time: 21773.3062s
	iters: 2300, epoch: 1 | loss: 0.2253113
	speed: 0.0264s/iter; left time: 21749.3910s
	iters: 2400, epoch: 1 | loss: 0.2201735
	speed: 0.0264s/iter; left time: 21753.5939s
	iters: 2500, epoch: 1 | loss: 0.1907551
	speed: 0.0264s/iter; left time: 21745.4470s
	iters: 2600, epoch: 1 | loss: 0.2108847
	speed: 0.0263s/iter; left time: 21693.2080s
	iters: 2700, epoch: 1 | loss: 0.2243140
	speed: 0.0265s/iter; left time: 21812.1420s
	iters: 2800, epoch: 1 | loss: 0.2405096
	speed: 0.0267s/iter; left time: 22033.4642s
	iters: 2900, epoch: 1 | loss: 0.2191556
	speed: 0.0267s/iter; left time: 22014.8943s
	iters: 3000, epoch: 1 | loss: 0.2226198
	speed: 0.0266s/iter; left time: 21962.7064s
	iters: 3100, epoch: 1 | loss: 0.1959086
	speed: 0.0266s/iter; left time: 21936.0356s
	iters: 3200, epoch: 1 | loss: 0.2204740
	speed: 0.0265s/iter; left time: 21850.8048s
	iters: 3300, epoch: 1 | loss: 0.2040489
	speed: 0.0268s/iter; left time: 22050.5677s
	iters: 3400, epoch: 1 | loss: 0.2496550
	speed: 0.0267s/iter; left time: 21960.1670s
	iters: 3500, epoch: 1 | loss: 0.2070421
	speed: 0.0267s/iter; left time: 22012.3361s
	iters: 3600, epoch: 1 | loss: 0.2292603
	speed: 0.0268s/iter; left time: 22034.8373s
	iters: 3700, epoch: 1 | loss: 0.2166268
	speed: 0.0268s/iter; left time: 22046.8931s
	iters: 3800, epoch: 1 | loss: 0.2478662
	speed: 0.0267s/iter; left time: 22013.4142s
	iters: 3900, epoch: 1 | loss: 0.2214809
	speed: 0.0268s/iter; left time: 22047.1330s
	iters: 4000, epoch: 1 | loss: 0.2539654
	speed: 0.0268s/iter; left time: 22031.4367s
	iters: 4100, epoch: 1 | loss: 0.2351368
	speed: 0.0267s/iter; left time: 21964.5145s
Epoch: 1 cost time: 110.26564431190491
Epoch: 1, Steps: 4136 | Train Loss: 0.2199757 Vali Loss: 0.1725115 Test Loss: 0.1547612
Validation loss decreased (inf --> 0.172511).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1926792
	speed: 1.3398s/iter; left time: 1102571.1566s
	iters: 200, epoch: 2 | loss: 0.2397687
	speed: 0.0269s/iter; left time: 22173.8805s
	iters: 300, epoch: 2 | loss: 0.1930020
	speed: 0.0268s/iter; left time: 22019.3149s
	iters: 400, epoch: 2 | loss: 0.2075549
	speed: 0.0275s/iter; left time: 22617.4171s
	iters: 500, epoch: 2 | loss: 0.2001947
	speed: 0.0266s/iter; left time: 21862.1754s
	iters: 600, epoch: 2 | loss: 0.2160971
	speed: 0.0264s/iter; left time: 21726.1934s
	iters: 700, epoch: 2 | loss: 0.2056951
	speed: 0.0271s/iter; left time: 22255.7759s
	iters: 800, epoch: 2 | loss: 0.2055217
	speed: 0.0264s/iter; left time: 21701.4745s
	iters: 900, epoch: 2 | loss: 0.2325452
	speed: 0.0264s/iter; left time: 21722.8241s
	iters: 1000, epoch: 2 | loss: 0.2394783
	speed: 0.0266s/iter; left time: 21884.9946s
	iters: 1100, epoch: 2 | loss: 0.2157550
	speed: 0.0265s/iter; left time: 21769.4566s
	iters: 1200, epoch: 2 | loss: 0.1884214
	speed: 0.0265s/iter; left time: 21765.2660s
	iters: 1300, epoch: 2 | loss: 0.2009647
	speed: 0.0269s/iter; left time: 22077.7107s
	iters: 1400, epoch: 2 | loss: 0.2201283
	speed: 0.0268s/iter; left time: 22014.4458s
	iters: 1500, epoch: 2 | loss: 0.2030118
	speed: 0.0267s/iter; left time: 21957.6851s
	iters: 1600, epoch: 2 | loss: 0.2498414
	speed: 0.0266s/iter; left time: 21849.9846s
	iters: 1700, epoch: 2 | loss: 0.2295832
	speed: 0.0266s/iter; left time: 21834.6859s
	iters: 1800, epoch: 2 | loss: 0.2111428
	speed: 0.0263s/iter; left time: 21623.0235s
	iters: 1900, epoch: 2 | loss: 0.2329511
	speed: 0.0266s/iter; left time: 21881.1024s
	iters: 2000, epoch: 2 | loss: 0.2365278
	speed: 0.0269s/iter; left time: 22078.5759s
	iters: 2100, epoch: 2 | loss: 0.1812721
	speed: 0.0269s/iter; left time: 22104.3916s
	iters: 2200, epoch: 2 | loss: 0.2180045
	speed: 0.0270s/iter; left time: 22193.5612s
	iters: 2300, epoch: 2 | loss: 0.2066307
	speed: 0.0266s/iter; left time: 21832.0679s
	iters: 2400, epoch: 2 | loss: 0.2235386
	speed: 0.0268s/iter; left time: 22013.2283s
	iters: 2500, epoch: 2 | loss: 0.2155234
	speed: 0.0264s/iter; left time: 21643.0753s
	iters: 2600, epoch: 2 | loss: 0.2334329
	speed: 0.0263s/iter; left time: 21565.6994s
	iters: 2700, epoch: 2 | loss: 0.2115831
	speed: 0.0263s/iter; left time: 21540.5663s
	iters: 2800, epoch: 2 | loss: 0.2383230
	speed: 0.0264s/iter; left time: 21655.0790s
	iters: 2900, epoch: 2 | loss: 0.1975124
	speed: 0.0265s/iter; left time: 21697.9359s
	iters: 3000, epoch: 2 | loss: 0.2458624
	speed: 0.0268s/iter; left time: 22004.1082s
	iters: 3100, epoch: 2 | loss: 0.2153585
	speed: 0.0268s/iter; left time: 21979.6352s
	iters: 3200, epoch: 2 | loss: 0.2301993
	speed: 0.0270s/iter; left time: 22098.9618s
	iters: 3300, epoch: 2 | loss: 0.2043476
	speed: 0.0266s/iter; left time: 21799.4817s
	iters: 3400, epoch: 2 | loss: 0.2005055
	speed: 0.0268s/iter; left time: 21959.2779s
	iters: 3500, epoch: 2 | loss: 0.2363060
	speed: 0.0265s/iter; left time: 21701.8194s
	iters: 3600, epoch: 2 | loss: 0.2176881
	speed: 0.0264s/iter; left time: 21651.9960s
	iters: 3700, epoch: 2 | loss: 0.2347121
	speed: 0.0270s/iter; left time: 22150.7399s
	iters: 3800, epoch: 2 | loss: 0.2371529
	speed: 0.0264s/iter; left time: 21601.7529s
	iters: 3900, epoch: 2 | loss: 0.1969328
	speed: 0.0272s/iter; left time: 22245.2331s
	iters: 4000, epoch: 2 | loss: 0.2330570
	speed: 0.0269s/iter; left time: 22001.2721s
	iters: 4100, epoch: 2 | loss: 0.2320629
	speed: 0.0262s/iter; left time: 21453.0707s
Epoch: 2 cost time: 110.67355608940125
Epoch: 2, Steps: 4136 | Train Loss: 0.2173431 Vali Loss: 0.1731943 Test Loss: 0.1559457
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.1976656
	speed: 1.3358s/iter; left time: 1093793.4057s
	iters: 200, epoch: 3 | loss: 0.2071124
	speed: 0.0271s/iter; left time: 22216.2955s
	iters: 300, epoch: 3 | loss: 0.2400772
	speed: 0.0270s/iter; left time: 22092.9845s
	iters: 400, epoch: 3 | loss: 0.2140867
	speed: 0.0268s/iter; left time: 21969.1955s
	iters: 500, epoch: 3 | loss: 0.2155645
	speed: 0.0264s/iter; left time: 21572.5682s
	iters: 600, epoch: 3 | loss: 0.2296454
	speed: 0.0273s/iter; left time: 22376.4060s
	iters: 700, epoch: 3 | loss: 0.2402507
	speed: 0.0272s/iter; left time: 22261.0592s
	iters: 800, epoch: 3 | loss: 0.2109137
	speed: 0.0268s/iter; left time: 21924.6250s
	iters: 900, epoch: 3 | loss: 0.2056101
	speed: 0.0264s/iter; left time: 21621.8688s
	iters: 1000, epoch: 3 | loss: 0.2329829
	speed: 0.0267s/iter; left time: 21820.7173s
	iters: 1100, epoch: 3 | loss: 0.2052519
	speed: 0.0271s/iter; left time: 22193.3617s
	iters: 1200, epoch: 3 | loss: 0.2371752
	speed: 0.0270s/iter; left time: 22107.6372s
	iters: 1300, epoch: 3 | loss: 0.2126430
	speed: 0.0271s/iter; left time: 22185.2286s
	iters: 1400, epoch: 3 | loss: 0.2216554
	speed: 0.0267s/iter; left time: 21815.3750s
	iters: 1500, epoch: 3 | loss: 0.2247850
	speed: 0.0274s/iter; left time: 22403.9217s
	iters: 1600, epoch: 3 | loss: 0.2162044
	speed: 0.0273s/iter; left time: 22333.7377s
	iters: 1700, epoch: 3 | loss: 0.2354144
	speed: 0.0271s/iter; left time: 22154.0686s
	iters: 1800, epoch: 3 | loss: 0.2176825
	speed: 0.0271s/iter; left time: 22117.1145s
	iters: 1900, epoch: 3 | loss: 0.2207592
	speed: 0.0266s/iter; left time: 21711.0343s
	iters: 2000, epoch: 3 | loss: 0.2083281
	speed: 0.0266s/iter; left time: 21755.7726s
	iters: 2100, epoch: 3 | loss: 0.2444043
	speed: 0.0273s/iter; left time: 22302.7231s
	iters: 2200, epoch: 3 | loss: 0.1750988
	speed: 0.0277s/iter; left time: 22589.6009s
	iters: 2300, epoch: 3 | loss: 0.2429714
	speed: 0.0266s/iter; left time: 21730.3810s
	iters: 2400, epoch: 3 | loss: 0.2457160
	speed: 0.0264s/iter; left time: 21554.9434s
	iters: 2500, epoch: 3 | loss: 0.2047061
	speed: 0.0268s/iter; left time: 21856.9804s
	iters: 2600, epoch: 3 | loss: 0.1883669
	speed: 0.0266s/iter; left time: 21676.6176s
	iters: 2700, epoch: 3 | loss: 0.2014353
	speed: 0.0271s/iter; left time: 22146.8056s
	iters: 2800, epoch: 3 | loss: 0.2089106
	speed: 0.0268s/iter; left time: 21896.1989s
	iters: 2900, epoch: 3 | loss: 0.2323583
	speed: 0.0278s/iter; left time: 22705.4001s
	iters: 3000, epoch: 3 | loss: 0.2090331
	speed: 0.0265s/iter; left time: 21590.5019s
	iters: 3100, epoch: 3 | loss: 0.2084342
	speed: 0.0265s/iter; left time: 21599.4971s
	iters: 3200, epoch: 3 | loss: 0.2023972
	speed: 0.0264s/iter; left time: 21538.8464s
	iters: 3300, epoch: 3 | loss: 0.2247709
	speed: 0.0266s/iter; left time: 21676.3988s
	iters: 3400, epoch: 3 | loss: 0.2602925
	speed: 0.0264s/iter; left time: 21501.3297s
	iters: 3500, epoch: 3 | loss: 0.2208075
	speed: 0.0273s/iter; left time: 22245.2136s
	iters: 3600, epoch: 3 | loss: 0.2541500
	speed: 0.0271s/iter; left time: 22069.4846s
	iters: 3700, epoch: 3 | loss: 0.2232326
	speed: 0.0273s/iter; left time: 22275.7929s
	iters: 3800, epoch: 3 | loss: 0.2127716
	speed: 0.0267s/iter; left time: 21789.7982s
	iters: 3900, epoch: 3 | loss: 0.2051387
	speed: 0.0269s/iter; left time: 21885.0575s
	iters: 4000, epoch: 3 | loss: 0.1973578
	speed: 0.0266s/iter; left time: 21680.0304s
	iters: 4100, epoch: 3 | loss: 0.2331013
	speed: 0.0272s/iter; left time: 22144.0191s
Epoch: 3 cost time: 111.67766952514648
Epoch: 3, Steps: 4136 | Train Loss: 0.2173961 Vali Loss: 0.1729430 Test Loss: 0.1552087
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.2147031
	speed: 1.3408s/iter; left time: 1092378.0657s
	iters: 200, epoch: 4 | loss: 0.2108079
	speed: 0.0269s/iter; left time: 21946.3085s
	iters: 300, epoch: 4 | loss: 0.2109423
	speed: 0.0264s/iter; left time: 21468.0813s
	iters: 400, epoch: 4 | loss: 0.2386686
	speed: 0.0263s/iter; left time: 21452.8519s
	iters: 500, epoch: 4 | loss: 0.2067939
	speed: 0.0265s/iter; left time: 21539.3388s
	iters: 600, epoch: 4 | loss: 0.1963187
	speed: 0.0274s/iter; left time: 22280.3722s
	iters: 700, epoch: 4 | loss: 0.2060498
	speed: 0.0271s/iter; left time: 22041.0069s
	iters: 800, epoch: 4 | loss: 0.2203986
	speed: 0.0266s/iter; left time: 21667.9071s
	iters: 900, epoch: 4 | loss: 0.2405104
	speed: 0.0266s/iter; left time: 21625.8555s
	iters: 1000, epoch: 4 | loss: 0.2164486
	speed: 0.0268s/iter; left time: 21774.5114s
	iters: 1100, epoch: 4 | loss: 0.2631059
	speed: 0.0276s/iter; left time: 22496.4550s
	iters: 1200, epoch: 4 | loss: 0.2057312
	speed: 0.0265s/iter; left time: 21581.8765s
	iters: 1300, epoch: 4 | loss: 0.2219746
	speed: 0.0271s/iter; left time: 22016.6027s
	iters: 1400, epoch: 4 | loss: 0.2250319
	speed: 0.0266s/iter; left time: 21619.6407s
	iters: 1500, epoch: 4 | loss: 0.1993575
	speed: 0.0262s/iter; left time: 21284.2723s
	iters: 1600, epoch: 4 | loss: 0.2217758
	speed: 0.0266s/iter; left time: 21642.5499s
	iters: 1700, epoch: 4 | loss: 0.1952329
	speed: 0.0262s/iter; left time: 21312.2807s
	iters: 1800, epoch: 4 | loss: 0.2373471
	speed: 0.0272s/iter; left time: 22130.9342s
	iters: 1900, epoch: 4 | loss: 0.2160876
	speed: 0.0275s/iter; left time: 22324.9784s
	iters: 2000, epoch: 4 | loss: 0.2322227
	speed: 0.0277s/iter; left time: 22545.5634s
	iters: 2100, epoch: 4 | loss: 0.1978410
	speed: 0.0272s/iter; left time: 22095.2304s
	iters: 2200, epoch: 4 | loss: 0.2246096
	speed: 0.0266s/iter; left time: 21585.9391s
	iters: 2300, epoch: 4 | loss: 0.2762729
	speed: 0.0270s/iter; left time: 21932.2516s
	iters: 2400, epoch: 4 | loss: 0.1941277
	speed: 0.0268s/iter; left time: 21768.1894s
	iters: 2500, epoch: 4 | loss: 0.2285072
	speed: 0.0265s/iter; left time: 21565.7011s
	iters: 2600, epoch: 4 | loss: 0.2129928
	speed: 0.0263s/iter; left time: 21369.2494s
	iters: 2700, epoch: 4 | loss: 0.1946699
	speed: 0.0265s/iter; left time: 21521.8806s
	iters: 2800, epoch: 4 | loss: 0.2207575
	speed: 0.0268s/iter; left time: 21796.5522s
	iters: 2900, epoch: 4 | loss: 0.2255573
	speed: 0.0271s/iter; left time: 22019.3774s
	iters: 3000, epoch: 4 | loss: 0.1809054
	speed: 0.0265s/iter; left time: 21510.0243s
	iters: 3100, epoch: 4 | loss: 0.2202815
	speed: 0.0267s/iter; left time: 21712.4081s
	iters: 3200, epoch: 4 | loss: 0.1880460
	speed: 0.0269s/iter; left time: 21864.3987s
	iters: 3300, epoch: 4 | loss: 0.2252359
	speed: 0.0268s/iter; left time: 21748.6437s
	iters: 3400, epoch: 4 | loss: 0.2307317
	speed: 0.0266s/iter; left time: 21620.1410s
	iters: 3500, epoch: 4 | loss: 0.2274544
	speed: 0.0272s/iter; left time: 22046.7691s
	iters: 3600, epoch: 4 | loss: 0.2041055
	speed: 0.0275s/iter; left time: 22270.0416s
	iters: 3700, epoch: 4 | loss: 0.2136073
	speed: 0.0273s/iter; left time: 22135.4094s
	iters: 3800, epoch: 4 | loss: 0.2184331
	speed: 0.0272s/iter; left time: 22097.3020s
	iters: 3900, epoch: 4 | loss: 0.2248398
	speed: 0.0271s/iter; left time: 21964.4108s
	iters: 4000, epoch: 4 | loss: 0.2150103
	speed: 0.0266s/iter; left time: 21589.5182s
	iters: 4100, epoch: 4 | loss: 0.2145880
	speed: 0.0268s/iter; left time: 21711.9780s
Epoch: 4 cost time: 111.40102887153625
Epoch: 4, Steps: 4136 | Train Loss: 0.2173738 Vali Loss: 0.1735948 Test Loss: 0.1557821
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.2154069
	speed: 1.3224s/iter; left time: 1071916.2647s
	iters: 200, epoch: 5 | loss: 0.2277241
	speed: 0.0266s/iter; left time: 21539.5220s
	iters: 300, epoch: 5 | loss: 0.2169954
	speed: 0.0266s/iter; left time: 21554.5058s
	iters: 400, epoch: 5 | loss: 0.2495920
	speed: 0.0267s/iter; left time: 21618.4332s
	iters: 500, epoch: 5 | loss: 0.2183574
	speed: 0.0268s/iter; left time: 21674.8807s
	iters: 600, epoch: 5 | loss: 0.2175437
	speed: 0.0268s/iter; left time: 21699.5625s
	iters: 700, epoch: 5 | loss: 0.2118136
	speed: 0.0265s/iter; left time: 21479.8275s
	iters: 800, epoch: 5 | loss: 0.2296111
	speed: 0.0275s/iter; left time: 22234.3003s
	iters: 900, epoch: 5 | loss: 0.2495734
	speed: 0.0268s/iter; left time: 21684.1493s
	iters: 1000, epoch: 5 | loss: 0.2112971
	speed: 0.0262s/iter; left time: 21208.1499s
	iters: 1100, epoch: 5 | loss: 0.2114067
	speed: 0.0266s/iter; left time: 21565.3866s
	iters: 1200, epoch: 5 | loss: 0.2150392
	speed: 0.0266s/iter; left time: 21558.5137s
	iters: 1300, epoch: 5 | loss: 0.2109471
	speed: 0.0263s/iter; left time: 21307.3163s
	iters: 1400, epoch: 5 | loss: 0.1897478
	speed: 0.0269s/iter; left time: 21745.2588s
	iters: 1500, epoch: 5 | loss: 0.2304352
	speed: 0.0273s/iter; left time: 22051.3235s
	iters: 1600, epoch: 5 | loss: 0.2321943
	speed: 0.0266s/iter; left time: 21543.9195s
	iters: 1700, epoch: 5 | loss: 0.2172451
	speed: 0.0265s/iter; left time: 21418.2227s
	iters: 1800, epoch: 5 | loss: 0.2256602
	speed: 0.0268s/iter; left time: 21691.2434s
	iters: 1900, epoch: 5 | loss: 0.1932486
	speed: 0.0270s/iter; left time: 21796.3573s
	iters: 2000, epoch: 5 | loss: 0.2333288
	speed: 0.0266s/iter; left time: 21504.9865s
	iters: 2100, epoch: 5 | loss: 0.2225517
	speed: 0.0271s/iter; left time: 21918.6094s
	iters: 2200, epoch: 5 | loss: 0.2259895
	speed: 0.0262s/iter; left time: 21165.4527s
	iters: 2300, epoch: 5 | loss: 0.2104656
	speed: 0.0265s/iter; left time: 21408.3057s
	iters: 2400, epoch: 5 | loss: 0.2056499
	speed: 0.0264s/iter; left time: 21361.4839s
	iters: 2500, epoch: 5 | loss: 0.2149187
	speed: 0.0265s/iter; left time: 21447.2675s
	iters: 2600, epoch: 5 | loss: 0.2042212
	speed: 0.0264s/iter; left time: 21357.5486s
	iters: 2700, epoch: 5 | loss: 0.1822783
	speed: 0.0267s/iter; left time: 21542.1207s
	iters: 2800, epoch: 5 | loss: 0.2180214
	speed: 0.0271s/iter; left time: 21926.8067s
	iters: 2900, epoch: 5 | loss: 0.2330072
	speed: 0.0271s/iter; left time: 21862.0457s
	iters: 3000, epoch: 5 | loss: 0.1768655
	speed: 0.0266s/iter; left time: 21463.6102s
	iters: 3100, epoch: 5 | loss: 0.2409513
	speed: 0.0269s/iter; left time: 21753.7238s
	iters: 3200, epoch: 5 | loss: 0.2399078
	speed: 0.0262s/iter; left time: 21133.0487s
	iters: 3300, epoch: 5 | loss: 0.2087798
	speed: 0.0268s/iter; left time: 21607.1918s
	iters: 3400, epoch: 5 | loss: 0.1937273
	speed: 0.0270s/iter; left time: 21815.7537s
	iters: 3500, epoch: 5 | loss: 0.2156163
	speed: 0.0265s/iter; left time: 21401.3598s
	iters: 3600, epoch: 5 | loss: 0.2160812
	speed: 0.0268s/iter; left time: 21629.8324s
	iters: 3700, epoch: 5 | loss: 0.2430412
	speed: 0.0263s/iter; left time: 21253.5741s
	iters: 3800, epoch: 5 | loss: 0.2047549
	speed: 0.0264s/iter; left time: 21299.2885s
	iters: 3900, epoch: 5 | loss: 0.2284761
	speed: 0.0266s/iter; left time: 21424.9165s
	iters: 4000, epoch: 5 | loss: 0.2228007
	speed: 0.0264s/iter; left time: 21334.4004s
	iters: 4100, epoch: 5 | loss: 0.2351903
	speed: 0.0267s/iter; left time: 21506.8278s
Epoch: 5 cost time: 110.60698246955872
Epoch: 5, Steps: 4136 | Train Loss: 0.2173496 Vali Loss: 0.1742802 Test Loss: 0.1556505
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.2247920
	speed: 1.3586s/iter; left time: 1095586.2466s
	iters: 200, epoch: 6 | loss: 0.2261426
	speed: 0.0262s/iter; left time: 21154.7974s
	iters: 300, epoch: 6 | loss: 0.1808171
	speed: 0.0262s/iter; left time: 21121.1978s
	iters: 400, epoch: 6 | loss: 0.2298501
	speed: 0.0266s/iter; left time: 21462.9343s
	iters: 500, epoch: 6 | loss: 0.2081066
	speed: 0.0277s/iter; left time: 22350.3974s
	iters: 600, epoch: 6 | loss: 0.2087641
	speed: 0.0269s/iter; left time: 21717.9026s
	iters: 700, epoch: 6 | loss: 0.2097702
	speed: 0.0277s/iter; left time: 22320.0754s
	iters: 800, epoch: 6 | loss: 0.1948726
	speed: 0.0265s/iter; left time: 21373.5642s
	iters: 900, epoch: 6 | loss: 0.2182300
	speed: 0.0263s/iter; left time: 21200.4045s
	iters: 1000, epoch: 6 | loss: 0.2102824
	speed: 0.0272s/iter; left time: 21905.3529s
	iters: 1100, epoch: 6 | loss: 0.2150426
	speed: 0.0275s/iter; left time: 22150.0645s
	iters: 1200, epoch: 6 | loss: 0.2001791
	speed: 0.0264s/iter; left time: 21239.9520s
	iters: 1300, epoch: 6 | loss: 0.2091486
	speed: 0.0262s/iter; left time: 21107.0717s
	iters: 1400, epoch: 6 | loss: 0.2244251
	speed: 0.0263s/iter; left time: 21204.5803s
	iters: 1500, epoch: 6 | loss: 0.2467483
	speed: 0.0269s/iter; left time: 21624.3793s
	iters: 1600, epoch: 6 | loss: 0.2438702
	speed: 0.0272s/iter; left time: 21868.3929s
	iters: 1700, epoch: 6 | loss: 0.2017273
	speed: 0.0263s/iter; left time: 21170.3047s
	iters: 1800, epoch: 6 | loss: 0.2107419
	speed: 0.0270s/iter; left time: 21695.4958s
	iters: 1900, epoch: 6 | loss: 0.2164034
	speed: 0.0272s/iter; left time: 21888.8951s
	iters: 2000, epoch: 6 | loss: 0.2096691
	speed: 0.0263s/iter; left time: 21190.7691s
	iters: 2100, epoch: 6 | loss: 0.2538867
	speed: 0.0271s/iter; left time: 21782.8438s
	iters: 2200, epoch: 6 | loss: 0.2314055
	speed: 0.0268s/iter; left time: 21571.7428s
	iters: 2300, epoch: 6 | loss: 0.2081086
	speed: 0.0272s/iter; left time: 21877.8486s
	iters: 2400, epoch: 6 | loss: 0.2022902
	speed: 0.0274s/iter; left time: 22058.2969s
	iters: 2500, epoch: 6 | loss: 0.2253944
	speed: 0.0273s/iter; left time: 21938.0916s
	iters: 2600, epoch: 6 | loss: 0.2430284
	speed: 0.0269s/iter; left time: 21613.3139s
	iters: 2700, epoch: 6 | loss: 0.2219114
	speed: 0.0268s/iter; left time: 21536.2918s
	iters: 2800, epoch: 6 | loss: 0.2510485
	speed: 0.0267s/iter; left time: 21461.8654s
	iters: 2900, epoch: 6 | loss: 0.2033249
	speed: 0.0262s/iter; left time: 21073.9582s
	iters: 3000, epoch: 6 | loss: 0.2107689
	speed: 0.0265s/iter; left time: 21258.9158s
	iters: 3100, epoch: 6 | loss: 0.2467262
	speed: 0.0270s/iter; left time: 21706.9674s
	iters: 3200, epoch: 6 | loss: 0.2021253
	speed: 0.0264s/iter; left time: 21225.3800s
	iters: 3300, epoch: 6 | loss: 0.1899076
	speed: 0.0264s/iter; left time: 21202.6606s
	iters: 3400, epoch: 6 | loss: 0.2440962
	speed: 0.0267s/iter; left time: 21417.0087s
	iters: 3500, epoch: 6 | loss: 0.2165990
	speed: 0.0267s/iter; left time: 21437.2687s
	iters: 3600, epoch: 6 | loss: 0.1999529
	speed: 0.0263s/iter; left time: 21102.9081s
	iters: 3700, epoch: 6 | loss: 0.2348216
	speed: 0.0266s/iter; left time: 21327.0364s
	iters: 3800, epoch: 6 | loss: 0.2108226
	speed: 0.0261s/iter; left time: 20974.5230s
	iters: 3900, epoch: 6 | loss: 0.2381315
	speed: 0.0262s/iter; left time: 21001.4350s
	iters: 4000, epoch: 6 | loss: 0.1932931
	speed: 0.0261s/iter; left time: 20965.8646s
	iters: 4100, epoch: 6 | loss: 0.1947271
	speed: 0.0265s/iter; left time: 21280.3231s
Epoch: 6 cost time: 110.87229561805725
Epoch: 6, Steps: 4136 | Train Loss: 0.2173767 Vali Loss: 0.1731370 Test Loss: 0.1554808
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_h_720_720_DLinear_custom_ftM_sl720_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 37508
test shape: (37508, 1, 720, 151) (37508, 1, 720, 151)
test shape: (37508, 720, 151) (37508, 720, 151)
mse:0.15475961565971375, mae:0.19872987270355225
>>>>>>>Overall time: 2079 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
