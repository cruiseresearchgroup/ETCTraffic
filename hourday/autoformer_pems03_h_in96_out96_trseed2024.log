Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_h.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 133604
val 19019
test 38132
	iters: 100, epoch: 1 | loss: 0.2912003
	speed: 0.1028s/iter; left time: 85836.2347s
	iters: 200, epoch: 1 | loss: 0.2228811
	speed: 0.0981s/iter; left time: 81874.6715s
	iters: 300, epoch: 1 | loss: 0.2372373
	speed: 0.0986s/iter; left time: 82336.9770s
	iters: 400, epoch: 1 | loss: 0.2069590
	speed: 0.0983s/iter; left time: 82070.4766s
	iters: 500, epoch: 1 | loss: 0.1966192
	speed: 0.0982s/iter; left time: 81940.8291s
	iters: 600, epoch: 1 | loss: 0.1888748
	speed: 0.0982s/iter; left time: 81958.7258s
	iters: 700, epoch: 1 | loss: 0.1963748
	speed: 0.0979s/iter; left time: 81683.6988s
	iters: 800, epoch: 1 | loss: 0.1581583
	speed: 0.0973s/iter; left time: 81154.3126s
	iters: 900, epoch: 1 | loss: 0.1427545
	speed: 0.0982s/iter; left time: 81950.3779s
	iters: 1000, epoch: 1 | loss: 0.1983296
	speed: 0.0976s/iter; left time: 81374.7062s
	iters: 1100, epoch: 1 | loss: 0.1518465
	speed: 0.0981s/iter; left time: 81793.6194s
	iters: 1200, epoch: 1 | loss: 0.1842699
	speed: 0.0993s/iter; left time: 82773.3480s
	iters: 1300, epoch: 1 | loss: 0.1827217
	speed: 0.0998s/iter; left time: 83198.5537s
	iters: 1400, epoch: 1 | loss: 0.1516815
	speed: 0.1003s/iter; left time: 83590.1584s
	iters: 1500, epoch: 1 | loss: 0.1626223
	speed: 0.0993s/iter; left time: 82755.2929s
	iters: 1600, epoch: 1 | loss: 0.1771904
	speed: 0.0992s/iter; left time: 82672.9824s
	iters: 1700, epoch: 1 | loss: 0.1636599
	speed: 0.0988s/iter; left time: 82349.1926s
	iters: 1800, epoch: 1 | loss: 0.1567085
	speed: 0.0993s/iter; left time: 82726.8757s
	iters: 1900, epoch: 1 | loss: 0.1623357
	speed: 0.0987s/iter; left time: 82243.9550s
	iters: 2000, epoch: 1 | loss: 0.1323633
	speed: 0.0999s/iter; left time: 83214.4167s
	iters: 2100, epoch: 1 | loss: 0.1534522
	speed: 0.0989s/iter; left time: 82348.1005s
	iters: 2200, epoch: 1 | loss: 0.2099257
	speed: 0.0986s/iter; left time: 82115.7384s
	iters: 2300, epoch: 1 | loss: 0.1576147
	speed: 0.0994s/iter; left time: 82748.9094s
	iters: 2400, epoch: 1 | loss: 0.1457431
	speed: 0.0988s/iter; left time: 82295.7464s
	iters: 2500, epoch: 1 | loss: 0.1653571
	speed: 0.0989s/iter; left time: 82347.2472s
	iters: 2600, epoch: 1 | loss: 0.1540069
	speed: 0.0992s/iter; left time: 82608.0014s
	iters: 2700, epoch: 1 | loss: 0.1480410
	speed: 0.0991s/iter; left time: 82468.1077s
	iters: 2800, epoch: 1 | loss: 0.1614528
	speed: 0.0982s/iter; left time: 81753.9411s
	iters: 2900, epoch: 1 | loss: 0.1341669
	speed: 0.0981s/iter; left time: 81654.0788s
	iters: 3000, epoch: 1 | loss: 0.1353744
	speed: 0.0994s/iter; left time: 82688.3732s
	iters: 3100, epoch: 1 | loss: 0.1639320
	speed: 0.0983s/iter; left time: 81771.4268s
	iters: 3200, epoch: 1 | loss: 0.1178138
	speed: 0.0994s/iter; left time: 82716.9807s
	iters: 3300, epoch: 1 | loss: 0.1438545
	speed: 0.0988s/iter; left time: 82198.9582s
	iters: 3400, epoch: 1 | loss: 0.1477402
	speed: 0.0986s/iter; left time: 82029.4524s
	iters: 3500, epoch: 1 | loss: 0.1291995
	speed: 0.0988s/iter; left time: 82186.9154s
	iters: 3600, epoch: 1 | loss: 0.1441764
	speed: 0.0990s/iter; left time: 82274.8892s
	iters: 3700, epoch: 1 | loss: 0.1247564
	speed: 0.0986s/iter; left time: 81945.6077s
	iters: 3800, epoch: 1 | loss: 0.1625274
	speed: 0.0986s/iter; left time: 81989.9646s
	iters: 3900, epoch: 1 | loss: 0.1309935
	speed: 0.0984s/iter; left time: 81789.8647s
	iters: 4000, epoch: 1 | loss: 0.1236498
	speed: 0.0992s/iter; left time: 82454.8034s
Epoch: 1 cost time: 412.88656210899353
Epoch: 1, Steps: 4175 | Train Loss: 0.1656561 Vali Loss: 0.3357834 Test Loss: 0.3311281
Validation loss decreased (inf --> 0.335783).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1279973
	speed: 4.6775s/iter; left time: 3885743.7370s
	iters: 200, epoch: 2 | loss: 0.1495145
	speed: 0.0982s/iter; left time: 81567.2766s
	iters: 300, epoch: 2 | loss: 0.1186183
	speed: 0.0973s/iter; left time: 80840.6165s
	iters: 400, epoch: 2 | loss: 0.1429390
	speed: 0.0973s/iter; left time: 80835.8840s
	iters: 500, epoch: 2 | loss: 0.1267160
	speed: 0.0972s/iter; left time: 80731.4096s
	iters: 600, epoch: 2 | loss: 0.1266828
	speed: 0.0976s/iter; left time: 81068.2345s
	iters: 700, epoch: 2 | loss: 0.1339166
	speed: 0.0979s/iter; left time: 81247.8036s
	iters: 800, epoch: 2 | loss: 0.1064316
	speed: 0.0976s/iter; left time: 80990.3187s
	iters: 900, epoch: 2 | loss: 0.1287921
	speed: 0.0978s/iter; left time: 81158.0682s
	iters: 1000, epoch: 2 | loss: 0.1213760
	speed: 0.0975s/iter; left time: 80922.9645s
	iters: 1100, epoch: 2 | loss: 0.1219239
	speed: 0.0975s/iter; left time: 80871.4682s
	iters: 1200, epoch: 2 | loss: 0.1135302
	speed: 0.0972s/iter; left time: 80618.0815s
	iters: 1300, epoch: 2 | loss: 0.1216442
	speed: 0.0983s/iter; left time: 81509.6557s
	iters: 1400, epoch: 2 | loss: 0.1340050
	speed: 0.0979s/iter; left time: 81176.5747s
	iters: 1500, epoch: 2 | loss: 0.1239790
	speed: 0.0974s/iter; left time: 80785.0544s
	iters: 1600, epoch: 2 | loss: 0.1261652
	speed: 0.0976s/iter; left time: 80947.7360s
	iters: 1700, epoch: 2 | loss: 0.1240012
	speed: 0.0977s/iter; left time: 80975.8574s
	iters: 1800, epoch: 2 | loss: 0.1299988
	speed: 0.0977s/iter; left time: 80993.4978s
	iters: 1900, epoch: 2 | loss: 0.1211339
	speed: 0.0977s/iter; left time: 81002.6770s
	iters: 2000, epoch: 2 | loss: 0.1114073
	speed: 0.0979s/iter; left time: 81152.5501s
	iters: 2100, epoch: 2 | loss: 0.1151044
	speed: 0.0973s/iter; left time: 80663.6679s
	iters: 2200, epoch: 2 | loss: 0.1136403
	speed: 0.0974s/iter; left time: 80707.7754s
	iters: 2300, epoch: 2 | loss: 0.1279952
	speed: 0.0982s/iter; left time: 81382.4404s
	iters: 2400, epoch: 2 | loss: 0.1080248
	speed: 0.0977s/iter; left time: 80938.7527s
	iters: 2500, epoch: 2 | loss: 0.1164700
	speed: 0.0976s/iter; left time: 80856.7868s
	iters: 2600, epoch: 2 | loss: 0.1116481
	speed: 0.0974s/iter; left time: 80678.1635s
	iters: 2700, epoch: 2 | loss: 0.1149392
	speed: 0.0978s/iter; left time: 80960.2989s
	iters: 2800, epoch: 2 | loss: 0.1189291
	speed: 0.0981s/iter; left time: 81212.5144s
	iters: 2900, epoch: 2 | loss: 0.1267708
	speed: 0.0983s/iter; left time: 81371.1399s
	iters: 3000, epoch: 2 | loss: 0.1225513
	speed: 0.0974s/iter; left time: 80671.0546s
	iters: 3100, epoch: 2 | loss: 0.0837528
	speed: 0.0981s/iter; left time: 81240.4706s
	iters: 3200, epoch: 2 | loss: 0.1045385
	speed: 0.0983s/iter; left time: 81358.2517s
	iters: 3300, epoch: 2 | loss: 0.1083551
	speed: 0.0977s/iter; left time: 80854.0686s
	iters: 3400, epoch: 2 | loss: 0.1215344
	speed: 0.0977s/iter; left time: 80831.0491s
	iters: 3500, epoch: 2 | loss: 0.1130692
	speed: 0.0976s/iter; left time: 80781.7927s
	iters: 3600, epoch: 2 | loss: 0.1143791
	speed: 0.0982s/iter; left time: 81199.2083s
	iters: 3700, epoch: 2 | loss: 0.1012585
	speed: 0.0979s/iter; left time: 81015.0736s
	iters: 3800, epoch: 2 | loss: 0.1155083
	speed: 0.0975s/iter; left time: 80595.0374s
	iters: 3900, epoch: 2 | loss: 0.1051936
	speed: 0.0977s/iter; left time: 80815.9236s
	iters: 4000, epoch: 2 | loss: 0.1358358
	speed: 0.0973s/iter; left time: 80445.4782s
	iters: 4100, epoch: 2 | loss: 0.1040647
	speed: 0.0979s/iter; left time: 80934.3798s
Epoch: 2 cost time: 408.5971403121948
Epoch: 2, Steps: 4175 | Train Loss: 0.1213365 Vali Loss: 0.2254864 Test Loss: 0.2407642
Validation loss decreased (0.335783 --> 0.225486).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1201888
	speed: 4.6602s/iter; left time: 3851922.0293s
	iters: 200, epoch: 3 | loss: 0.1132026
	speed: 0.0979s/iter; left time: 80892.2859s
	iters: 300, epoch: 3 | loss: 0.1276231
	speed: 0.0979s/iter; left time: 80929.6876s
	iters: 400, epoch: 3 | loss: 0.1198717
	speed: 0.0990s/iter; left time: 81779.7513s
	iters: 500, epoch: 3 | loss: 0.0916924
	speed: 0.0983s/iter; left time: 81203.9713s
	iters: 600, epoch: 3 | loss: 0.1309607
	speed: 0.0993s/iter; left time: 82040.5940s
	iters: 700, epoch: 3 | loss: 0.1121860
	speed: 0.0981s/iter; left time: 80998.5485s
	iters: 800, epoch: 3 | loss: 0.1213387
	speed: 0.0983s/iter; left time: 81161.1714s
	iters: 900, epoch: 3 | loss: 0.1037789
	speed: 0.0985s/iter; left time: 81320.6972s
	iters: 1000, epoch: 3 | loss: 0.1189681
	speed: 0.0985s/iter; left time: 81305.2329s
	iters: 1100, epoch: 3 | loss: 0.1140851
	speed: 0.0975s/iter; left time: 80515.8534s
	iters: 1200, epoch: 3 | loss: 0.1106172
	speed: 0.0979s/iter; left time: 80835.1764s
	iters: 1300, epoch: 3 | loss: 0.1115056
	speed: 0.0982s/iter; left time: 81012.9022s
	iters: 1400, epoch: 3 | loss: 0.0925342
	speed: 0.0989s/iter; left time: 81588.9704s
	iters: 1500, epoch: 3 | loss: 0.0855650
	speed: 0.1002s/iter; left time: 82719.5904s
	iters: 1600, epoch: 3 | loss: 0.1088389
	speed: 0.1002s/iter; left time: 82689.6883s
	iters: 1700, epoch: 3 | loss: 0.1168631
	speed: 0.0986s/iter; left time: 81380.9776s
	iters: 1800, epoch: 3 | loss: 0.1165144
	speed: 0.0992s/iter; left time: 81827.8275s
	iters: 1900, epoch: 3 | loss: 0.1129227
	speed: 0.0997s/iter; left time: 82262.5503s
	iters: 2000, epoch: 3 | loss: 0.1082280
	speed: 0.1003s/iter; left time: 82686.3850s
	iters: 2100, epoch: 3 | loss: 0.1069394
	speed: 0.1002s/iter; left time: 82648.9203s
	iters: 2200, epoch: 3 | loss: 0.0959737
	speed: 0.0992s/iter; left time: 81795.7081s
	iters: 2300, epoch: 3 | loss: 0.1023362
	speed: 0.1002s/iter; left time: 82590.2668s
	iters: 2400, epoch: 3 | loss: 0.0855034
	speed: 0.1003s/iter; left time: 82697.8711s
	iters: 2500, epoch: 3 | loss: 0.1001443
	speed: 0.0989s/iter; left time: 81543.7777s
	iters: 2600, epoch: 3 | loss: 0.0937780
	speed: 0.0984s/iter; left time: 81121.8269s
	iters: 2700, epoch: 3 | loss: 0.1039668
	speed: 0.0993s/iter; left time: 81805.6838s
	iters: 2800, epoch: 3 | loss: 0.1049737
	speed: 0.0981s/iter; left time: 80854.0896s
	iters: 2900, epoch: 3 | loss: 0.0954738
	speed: 0.0993s/iter; left time: 81798.8853s
	iters: 3000, epoch: 3 | loss: 0.1134630
	speed: 0.0999s/iter; left time: 82279.1963s
	iters: 3100, epoch: 3 | loss: 0.0984101
	speed: 0.0986s/iter; left time: 81193.5492s
	iters: 3200, epoch: 3 | loss: 0.0977043
	speed: 0.0992s/iter; left time: 81676.1191s
	iters: 3300, epoch: 3 | loss: 0.1009214
	speed: 0.0988s/iter; left time: 81359.5528s
	iters: 3400, epoch: 3 | loss: 0.1024321
	speed: 0.0988s/iter; left time: 81330.0415s
	iters: 3500, epoch: 3 | loss: 0.1067183
	speed: 0.0977s/iter; left time: 80413.1408s
	iters: 3600, epoch: 3 | loss: 0.0857924
	speed: 0.0974s/iter; left time: 80195.3791s
	iters: 3700, epoch: 3 | loss: 0.0902885
	speed: 0.0986s/iter; left time: 81132.0017s
	iters: 3800, epoch: 3 | loss: 0.1015193
	speed: 0.0991s/iter; left time: 81538.6160s
	iters: 3900, epoch: 3 | loss: 0.0920359
	speed: 0.1001s/iter; left time: 82388.8076s
	iters: 4000, epoch: 3 | loss: 0.1026676
	speed: 0.0994s/iter; left time: 81735.8172s
	iters: 4100, epoch: 3 | loss: 0.0903468
	speed: 0.0975s/iter; left time: 80174.9656s
Epoch: 3 cost time: 413.1642417907715
Epoch: 3, Steps: 4175 | Train Loss: 0.1020916 Vali Loss: 0.2321092 Test Loss: 0.2620234
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.0895026
	speed: 4.6710s/iter; left time: 3841356.4014s
	iters: 200, epoch: 4 | loss: 0.0915955
	speed: 0.0983s/iter; left time: 80862.9266s
	iters: 300, epoch: 4 | loss: 0.0978978
	speed: 0.0991s/iter; left time: 81506.4183s
	iters: 400, epoch: 4 | loss: 0.0891347
	speed: 0.0989s/iter; left time: 81299.3032s
	iters: 500, epoch: 4 | loss: 0.1018166
	speed: 0.0982s/iter; left time: 80726.9948s
	iters: 600, epoch: 4 | loss: 0.0937348
	speed: 0.0991s/iter; left time: 81458.1840s
	iters: 700, epoch: 4 | loss: 0.0934581
	speed: 0.0999s/iter; left time: 82128.6947s
	iters: 800, epoch: 4 | loss: 0.0923111
	speed: 0.0999s/iter; left time: 82110.0144s
	iters: 900, epoch: 4 | loss: 0.0748416
	speed: 0.0987s/iter; left time: 81096.3081s
	iters: 1000, epoch: 4 | loss: 0.0808063
	speed: 0.0984s/iter; left time: 80871.6566s
	iters: 1100, epoch: 4 | loss: 0.0840784
	speed: 0.0988s/iter; left time: 81167.2481s
	iters: 1200, epoch: 4 | loss: 0.0817461
	speed: 0.0999s/iter; left time: 82018.6155s
	iters: 1300, epoch: 4 | loss: 0.0935494
	speed: 0.0986s/iter; left time: 80938.6890s
	iters: 1400, epoch: 4 | loss: 0.1020209
	speed: 0.0994s/iter; left time: 81635.9481s
	iters: 1500, epoch: 4 | loss: 0.0930266
	speed: 0.0993s/iter; left time: 81506.4423s
	iters: 1600, epoch: 4 | loss: 0.1018023
	speed: 0.0998s/iter; left time: 81899.1997s
	iters: 1700, epoch: 4 | loss: 0.0850560
	speed: 0.0991s/iter; left time: 81341.6537s
	iters: 1800, epoch: 4 | loss: 0.0979985
	speed: 0.0995s/iter; left time: 81681.2098s
	iters: 1900, epoch: 4 | loss: 0.0866487
	speed: 0.0992s/iter; left time: 81388.4447s
	iters: 2000, epoch: 4 | loss: 0.0822489
	speed: 0.0991s/iter; left time: 81320.6530s
	iters: 2100, epoch: 4 | loss: 0.0850862
	speed: 0.0991s/iter; left time: 81319.7174s
	iters: 2200, epoch: 4 | loss: 0.0876937
	speed: 0.0997s/iter; left time: 81803.9218s
	iters: 2300, epoch: 4 | loss: 0.0881982
	speed: 0.0989s/iter; left time: 81078.2419s
	iters: 2400, epoch: 4 | loss: 0.0791952
	speed: 0.0997s/iter; left time: 81793.0349s
	iters: 2500, epoch: 4 | loss: 0.0783207
	speed: 0.0992s/iter; left time: 81368.5711s
	iters: 2600, epoch: 4 | loss: 0.0812207
	speed: 0.0996s/iter; left time: 81688.5214s
	iters: 2700, epoch: 4 | loss: 0.0897381
	speed: 0.0991s/iter; left time: 81267.0930s
	iters: 2800, epoch: 4 | loss: 0.0847982
	speed: 0.0996s/iter; left time: 81616.0345s
	iters: 2900, epoch: 4 | loss: 0.0836985
	speed: 0.0991s/iter; left time: 81244.7065s
	iters: 3000, epoch: 4 | loss: 0.0931532
	speed: 0.0984s/iter; left time: 80661.2664s
	iters: 3100, epoch: 4 | loss: 0.0918577
	speed: 0.0981s/iter; left time: 80412.5595s
	iters: 3200, epoch: 4 | loss: 0.0829674
	speed: 0.0976s/iter; left time: 79928.3384s
	iters: 3300, epoch: 4 | loss: 0.0819803
	speed: 0.0991s/iter; left time: 81215.4546s
	iters: 3400, epoch: 4 | loss: 0.0773620
	speed: 0.1001s/iter; left time: 81980.9737s
	iters: 3500, epoch: 4 | loss: 0.0976967
	speed: 0.0995s/iter; left time: 81472.0426s
	iters: 3600, epoch: 4 | loss: 0.0807501
	speed: 0.0993s/iter; left time: 81305.2406s
	iters: 3700, epoch: 4 | loss: 0.0817498
	speed: 0.1000s/iter; left time: 81890.5464s
	iters: 3800, epoch: 4 | loss: 0.0853538
	speed: 0.1002s/iter; left time: 81994.0562s
	iters: 3900, epoch: 4 | loss: 0.0886057
	speed: 0.1003s/iter; left time: 82082.1729s
	iters: 4000, epoch: 4 | loss: 0.0874228
	speed: 0.1001s/iter; left time: 81922.1395s
	iters: 4100, epoch: 4 | loss: 0.0869548
	speed: 0.0997s/iter; left time: 81578.6517s
Epoch: 4 cost time: 414.5393760204315
Epoch: 4, Steps: 4175 | Train Loss: 0.0887281 Vali Loss: 0.2502774 Test Loss: 0.2654685
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.0850582
	speed: 4.6585s/iter; left time: 3811566.8754s
	iters: 200, epoch: 5 | loss: 0.0797862
	speed: 0.0975s/iter; left time: 79785.1464s
	iters: 300, epoch: 5 | loss: 0.0761591
	speed: 0.0976s/iter; left time: 79810.9395s
	iters: 400, epoch: 5 | loss: 0.0742773
	speed: 0.0975s/iter; left time: 79712.0235s
	iters: 500, epoch: 5 | loss: 0.0839113
	speed: 0.0979s/iter; left time: 80086.2652s
	iters: 600, epoch: 5 | loss: 0.0886828
	speed: 0.0975s/iter; left time: 79751.3164s
	iters: 700, epoch: 5 | loss: 0.0829735
	speed: 0.0977s/iter; left time: 79864.1264s
	iters: 800, epoch: 5 | loss: 0.0797141
	speed: 0.0975s/iter; left time: 79733.5897s
	iters: 900, epoch: 5 | loss: 0.0765884
	speed: 0.0977s/iter; left time: 79868.2061s
	iters: 1000, epoch: 5 | loss: 0.0820007
	speed: 0.0978s/iter; left time: 79920.6207s
	iters: 1100, epoch: 5 | loss: 0.0775008
	speed: 0.0979s/iter; left time: 80009.5402s
	iters: 1200, epoch: 5 | loss: 0.0815911
	speed: 0.0978s/iter; left time: 79926.5995s
	iters: 1300, epoch: 5 | loss: 0.0843830
	speed: 0.0977s/iter; left time: 79793.7545s
	iters: 1400, epoch: 5 | loss: 0.0817876
	speed: 0.0974s/iter; left time: 79535.5249s
	iters: 1500, epoch: 5 | loss: 0.0836707
	speed: 0.0968s/iter; left time: 79098.0099s
	iters: 1600, epoch: 5 | loss: 0.0834587
	speed: 0.0973s/iter; left time: 79501.5597s
	iters: 1700, epoch: 5 | loss: 0.0762549
	speed: 0.0978s/iter; left time: 79865.9411s
	iters: 1800, epoch: 5 | loss: 0.0840066
	speed: 0.0976s/iter; left time: 79670.3590s
	iters: 1900, epoch: 5 | loss: 0.0786383
	speed: 0.0977s/iter; left time: 79754.7416s
	iters: 2000, epoch: 5 | loss: 0.0812283
	speed: 0.0975s/iter; left time: 79583.1585s
	iters: 2100, epoch: 5 | loss: 0.0874010
	speed: 0.0975s/iter; left time: 79556.0493s
	iters: 2200, epoch: 5 | loss: 0.0844808
	speed: 0.0976s/iter; left time: 79656.8161s
	iters: 2300, epoch: 5 | loss: 0.0773445
	speed: 0.0980s/iter; left time: 79959.5491s
	iters: 2400, epoch: 5 | loss: 0.0836787
	speed: 0.0972s/iter; left time: 79319.2215s
	iters: 2500, epoch: 5 | loss: 0.0734113
	speed: 0.0973s/iter; left time: 79406.3074s
	iters: 2600, epoch: 5 | loss: 0.0704112
	speed: 0.0974s/iter; left time: 79485.7227s
	iters: 2700, epoch: 5 | loss: 0.0842015
	speed: 0.0974s/iter; left time: 79412.3391s
	iters: 2800, epoch: 5 | loss: 0.0721118
	speed: 0.0987s/iter; left time: 80498.4930s
	iters: 2900, epoch: 5 | loss: 0.0792315
	speed: 0.0974s/iter; left time: 79417.5282s
	iters: 3000, epoch: 5 | loss: 0.0670279
	speed: 0.0980s/iter; left time: 79911.7709s
	iters: 3100, epoch: 5 | loss: 0.0757330
	speed: 0.0977s/iter; left time: 79664.6998s
	iters: 3200, epoch: 5 | loss: 0.0748754
	speed: 0.0978s/iter; left time: 79704.1700s
	iters: 3300, epoch: 5 | loss: 0.0703505
	speed: 0.0978s/iter; left time: 79741.4363s
	iters: 3400, epoch: 5 | loss: 0.0776089
	speed: 0.0974s/iter; left time: 79369.1096s
	iters: 3500, epoch: 5 | loss: 0.0697611
	speed: 0.0973s/iter; left time: 79241.4809s
	iters: 3600, epoch: 5 | loss: 0.0752754
	speed: 0.0975s/iter; left time: 79435.2860s
	iters: 3700, epoch: 5 | loss: 0.0779721
	speed: 0.0975s/iter; left time: 79456.6356s
	iters: 3800, epoch: 5 | loss: 0.0816143
	speed: 0.0974s/iter; left time: 79294.5766s
	iters: 3900, epoch: 5 | loss: 0.0694092
	speed: 0.0979s/iter; left time: 79764.1574s
	iters: 4000, epoch: 5 | loss: 0.0732686
	speed: 0.0977s/iter; left time: 79547.5916s
	iters: 4100, epoch: 5 | loss: 0.0759197
	speed: 0.0977s/iter; left time: 79513.9886s
Epoch: 5 cost time: 407.84434485435486
Epoch: 5, Steps: 4175 | Train Loss: 0.0792429 Vali Loss: 0.2428773 Test Loss: 0.2686980
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.0957894
	speed: 4.6686s/iter; left time: 3800386.1571s
	iters: 200, epoch: 6 | loss: 0.0764626
	speed: 0.0973s/iter; left time: 79177.6650s
	iters: 300, epoch: 6 | loss: 0.0638880
	speed: 0.0969s/iter; left time: 78856.6082s
	iters: 400, epoch: 6 | loss: 0.0783240
	speed: 0.0972s/iter; left time: 79077.3315s
	iters: 500, epoch: 6 | loss: 0.0736667
	speed: 0.0977s/iter; left time: 79482.4163s
	iters: 600, epoch: 6 | loss: 0.0773040
	speed: 0.0971s/iter; left time: 78991.4954s
	iters: 700, epoch: 6 | loss: 0.0680890
	speed: 0.0976s/iter; left time: 79413.0157s
	iters: 800, epoch: 6 | loss: 0.0798688
	speed: 0.0968s/iter; left time: 78755.8717s
	iters: 900, epoch: 6 | loss: 0.0801596
	speed: 0.0971s/iter; left time: 78939.4369s
	iters: 1000, epoch: 6 | loss: 0.0762378
	speed: 0.0973s/iter; left time: 79150.7062s
	iters: 1100, epoch: 6 | loss: 0.0671238
	speed: 0.0984s/iter; left time: 80039.3996s
	iters: 1200, epoch: 6 | loss: 0.0719829
	speed: 0.0974s/iter; left time: 79156.1492s
	iters: 1300, epoch: 6 | loss: 0.0720381
	speed: 0.0977s/iter; left time: 79410.9916s
	iters: 1400, epoch: 6 | loss: 0.0731312
	speed: 0.0973s/iter; left time: 79046.2526s
	iters: 1500, epoch: 6 | loss: 0.0723648
	speed: 0.0977s/iter; left time: 79367.4432s
	iters: 1600, epoch: 6 | loss: 0.0675589
	speed: 0.0979s/iter; left time: 79547.1107s
	iters: 1700, epoch: 6 | loss: 0.0683485
	speed: 0.0981s/iter; left time: 79706.3894s
	iters: 1800, epoch: 6 | loss: 0.0797136
	speed: 0.0974s/iter; left time: 79084.2600s
	iters: 1900, epoch: 6 | loss: 0.0774458
	speed: 0.0973s/iter; left time: 79027.4172s
	iters: 2000, epoch: 6 | loss: 0.0763062
	speed: 0.0976s/iter; left time: 79239.4376s
	iters: 2100, epoch: 6 | loss: 0.0730917
	speed: 0.0975s/iter; left time: 79154.7352s
	iters: 2200, epoch: 6 | loss: 0.0752653
	speed: 0.0973s/iter; left time: 79016.5231s
	iters: 2300, epoch: 6 | loss: 0.0667494
	speed: 0.0974s/iter; left time: 79053.2384s
	iters: 2400, epoch: 6 | loss: 0.0712170
	speed: 0.0978s/iter; left time: 79375.5971s
	iters: 2500, epoch: 6 | loss: 0.0746323
	speed: 0.0974s/iter; left time: 79069.4669s
	iters: 2600, epoch: 6 | loss: 0.0751425
	speed: 0.0977s/iter; left time: 79324.8311s
	iters: 2700, epoch: 6 | loss: 0.0751539
	speed: 0.0974s/iter; left time: 79062.3292s
	iters: 2800, epoch: 6 | loss: 0.0698356
	speed: 0.0972s/iter; left time: 78889.9240s
	iters: 2900, epoch: 6 | loss: 0.0723523
	speed: 0.0977s/iter; left time: 79291.5689s
	iters: 3000, epoch: 6 | loss: 0.0659522
	speed: 0.0973s/iter; left time: 78938.3307s
	iters: 3100, epoch: 6 | loss: 0.0671356
	speed: 0.0975s/iter; left time: 79070.5412s
	iters: 3200, epoch: 6 | loss: 0.0703236
	speed: 0.0977s/iter; left time: 79198.8828s
	iters: 3300, epoch: 6 | loss: 0.0728686
	speed: 0.0976s/iter; left time: 79148.1585s
	iters: 3400, epoch: 6 | loss: 0.0719486
	speed: 0.0972s/iter; left time: 78810.9544s
	iters: 3500, epoch: 6 | loss: 0.0725298
	speed: 0.0974s/iter; left time: 78960.2410s
	iters: 3600, epoch: 6 | loss: 0.0660422
	speed: 0.0974s/iter; left time: 78932.6735s
	iters: 3700, epoch: 6 | loss: 0.0674326
	speed: 0.0972s/iter; left time: 78748.5535s
	iters: 3800, epoch: 6 | loss: 0.0655133
	speed: 0.0975s/iter; left time: 79041.1373s
	iters: 3900, epoch: 6 | loss: 0.0697295
	speed: 0.0977s/iter; left time: 79133.3243s
	iters: 4000, epoch: 6 | loss: 0.0637226
	speed: 0.0973s/iter; left time: 78836.6519s
	iters: 4100, epoch: 6 | loss: 0.0736240
	speed: 0.0971s/iter; left time: 78621.4854s
Epoch: 6 cost time: 407.2088088989258
Epoch: 6, Steps: 4175 | Train Loss: 0.0726838 Vali Loss: 0.2468153 Test Loss: 0.2611496
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.0681844
	speed: 4.6579s/iter; left time: 3772208.5002s
	iters: 200, epoch: 7 | loss: 0.0761306
	speed: 0.0977s/iter; left time: 79128.0864s
	iters: 300, epoch: 7 | loss: 0.0806335
	speed: 0.0984s/iter; left time: 79708.8440s
	iters: 400, epoch: 7 | loss: 0.0735246
	speed: 0.0977s/iter; left time: 79070.6988s
	iters: 500, epoch: 7 | loss: 0.0961604
	speed: 0.0979s/iter; left time: 79212.3558s
	iters: 600, epoch: 7 | loss: 0.0858907
	speed: 0.0983s/iter; left time: 79591.4181s
	iters: 700, epoch: 7 | loss: 0.0813110
	speed: 0.0972s/iter; left time: 78666.5967s
	iters: 800, epoch: 7 | loss: 0.0756867
	speed: 0.1007s/iter; left time: 81450.1967s
	iters: 900, epoch: 7 | loss: 0.0686220
	speed: 0.0977s/iter; left time: 79011.9904s
	iters: 1000, epoch: 7 | loss: 0.0717544
	speed: 0.0981s/iter; left time: 79341.4731s
	iters: 1100, epoch: 7 | loss: 0.0693521
	speed: 0.0977s/iter; left time: 79029.7064s
	iters: 1200, epoch: 7 | loss: 0.0714829
	speed: 0.0994s/iter; left time: 80370.9052s
	iters: 1300, epoch: 7 | loss: 0.0648889
	speed: 0.1003s/iter; left time: 81137.7329s
	iters: 1400, epoch: 7 | loss: 0.0739610
	speed: 0.1001s/iter; left time: 80940.6433s
	iters: 1500, epoch: 7 | loss: 0.0783712
	speed: 0.1002s/iter; left time: 80984.4022s
	iters: 1600, epoch: 7 | loss: 0.0697365
	speed: 0.0988s/iter; left time: 79837.7435s
	iters: 1700, epoch: 7 | loss: 0.0720535
	speed: 0.0974s/iter; left time: 78732.7276s
	iters: 1800, epoch: 7 | loss: 0.0646892
	speed: 0.0969s/iter; left time: 78338.8227s
	iters: 1900, epoch: 7 | loss: 0.0643479
	speed: 0.0981s/iter; left time: 79276.6958s
	iters: 2000, epoch: 7 | loss: 0.0648659
	speed: 0.0982s/iter; left time: 79359.5325s
	iters: 2100, epoch: 7 | loss: 0.0692552
	speed: 0.0971s/iter; left time: 78474.6557s
	iters: 2200, epoch: 7 | loss: 0.0652616
	speed: 0.0975s/iter; left time: 78767.5471s
	iters: 2300, epoch: 7 | loss: 0.0592835
	speed: 0.0997s/iter; left time: 80549.4570s
	iters: 2400, epoch: 7 | loss: 0.0603514
	speed: 0.0977s/iter; left time: 78921.3277s
	iters: 2500, epoch: 7 | loss: 0.0637736
	speed: 0.0983s/iter; left time: 79411.3450s
	iters: 2600, epoch: 7 | loss: 0.0638816
	speed: 0.0975s/iter; left time: 78714.2471s
	iters: 2700, epoch: 7 | loss: 0.0652692
	speed: 0.0978s/iter; left time: 78913.4167s
	iters: 2800, epoch: 7 | loss: 0.0626077
	speed: 0.0972s/iter; left time: 78490.0842s
	iters: 2900, epoch: 7 | loss: 0.0725231
	speed: 0.0978s/iter; left time: 78914.9793s
	iters: 3000, epoch: 7 | loss: 0.0610686
	speed: 0.0979s/iter; left time: 79030.8832s
	iters: 3100, epoch: 7 | loss: 0.0681501
	speed: 0.0974s/iter; left time: 78559.7038s
	iters: 3200, epoch: 7 | loss: 0.0669594
	speed: 0.0994s/iter; left time: 80187.7896s
	iters: 3300, epoch: 7 | loss: 0.0628380
	speed: 0.0993s/iter; left time: 80107.3299s
	iters: 3400, epoch: 7 | loss: 0.0626312
	speed: 0.1001s/iter; left time: 80705.8279s
	iters: 3500, epoch: 7 | loss: 0.0623198
	speed: 0.0981s/iter; left time: 79133.4735s
	iters: 3600, epoch: 7 | loss: 0.0691552
	speed: 0.0992s/iter; left time: 79994.3166s
	iters: 3700, epoch: 7 | loss: 0.0675222
	speed: 0.0995s/iter; left time: 80242.2431s
	iters: 3800, epoch: 7 | loss: 0.0652886
	speed: 0.0992s/iter; left time: 79968.7767s
	iters: 3900, epoch: 7 | loss: 0.0642338
	speed: 0.0984s/iter; left time: 79313.9130s
	iters: 4000, epoch: 7 | loss: 0.0685048
	speed: 0.0984s/iter; left time: 79277.0736s
	iters: 4100, epoch: 7 | loss: 0.0661747
	speed: 0.0994s/iter; left time: 80076.3651s
Epoch: 7 cost time: 411.3486864566803
Epoch: 7, Steps: 4175 | Train Loss: 0.0693600 Vali Loss: 0.2538544 Test Loss: 0.2686930
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 38132
test shape: (38132, 1, 96, 151) (38132, 1, 96, 151)
test shape: (38132, 96, 151) (38132, 96, 151)
mse:0.24076391756534576, mae:0.34585341811180115
>>>>>>>Overall time: 6770 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
