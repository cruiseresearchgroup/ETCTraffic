Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems06_h.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems06_h_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_h_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 86897
val 11813
test 24341
	iters: 100, epoch: 1 | loss: 0.3180609
	speed: 0.2809s/iter; left time: 152522.7576s
	iters: 200, epoch: 1 | loss: 0.2038945
	speed: 0.2766s/iter; left time: 150155.4515s
	iters: 300, epoch: 1 | loss: 0.2471102
	speed: 0.2768s/iter; left time: 150196.1917s
	iters: 400, epoch: 1 | loss: 0.2521919
	speed: 0.2769s/iter; left time: 150232.0891s
	iters: 500, epoch: 1 | loss: 0.1729593
	speed: 0.2762s/iter; left time: 149845.0823s
	iters: 600, epoch: 1 | loss: 0.1725861
	speed: 0.2759s/iter; left time: 149641.5001s
	iters: 700, epoch: 1 | loss: 0.1674891
	speed: 0.2772s/iter; left time: 150314.6068s
	iters: 800, epoch: 1 | loss: 0.1665037
	speed: 0.2766s/iter; left time: 149948.2977s
	iters: 900, epoch: 1 | loss: 0.2034412
	speed: 0.2766s/iter; left time: 149950.1467s
	iters: 1000, epoch: 1 | loss: 0.1962414
	speed: 0.2761s/iter; left time: 149641.0029s
	iters: 1100, epoch: 1 | loss: 0.2206839
	speed: 0.2769s/iter; left time: 150064.4053s
	iters: 1200, epoch: 1 | loss: 0.2050346
	speed: 0.2767s/iter; left time: 149918.3187s
	iters: 1300, epoch: 1 | loss: 0.1729472
	speed: 0.2761s/iter; left time: 149585.3340s
	iters: 1400, epoch: 1 | loss: 0.1977195
	speed: 0.2765s/iter; left time: 149756.4708s
	iters: 1500, epoch: 1 | loss: 0.1594701
	speed: 0.2764s/iter; left time: 149677.9725s
	iters: 1600, epoch: 1 | loss: 0.1572491
	speed: 0.2767s/iter; left time: 149789.5957s
	iters: 1700, epoch: 1 | loss: 0.1422523
	speed: 0.2765s/iter; left time: 149650.2073s
	iters: 1800, epoch: 1 | loss: 0.1423790
	speed: 0.2761s/iter; left time: 149429.5065s
	iters: 1900, epoch: 1 | loss: 0.1667273
	speed: 0.2761s/iter; left time: 149382.4207s
	iters: 2000, epoch: 1 | loss: 0.1747304
	speed: 0.2757s/iter; left time: 149179.6330s
	iters: 2100, epoch: 1 | loss: 0.1602131
	speed: 0.2775s/iter; left time: 150101.1894s
	iters: 2200, epoch: 1 | loss: 0.1550038
	speed: 0.2779s/iter; left time: 150268.6047s
	iters: 2300, epoch: 1 | loss: 0.1400170
	speed: 0.2775s/iter; left time: 150057.7901s
	iters: 2400, epoch: 1 | loss: 0.1476661
	speed: 0.2778s/iter; left time: 150188.8048s
	iters: 2500, epoch: 1 | loss: 0.1633674
	speed: 0.2761s/iter; left time: 149258.4491s
	iters: 2600, epoch: 1 | loss: 0.1424062
	speed: 0.2760s/iter; left time: 149124.9471s
	iters: 2700, epoch: 1 | loss: 0.1324208
	speed: 0.2759s/iter; left time: 149053.2189s
Epoch: 1 cost time: 751.6449639797211
Epoch: 1, Steps: 2715 | Train Loss: 0.1887358 Vali Loss: 0.1566844 Test Loss: 0.2688193
Validation loss decreased (inf --> 0.156684).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1337382
	speed: 3.8459s/iter; left time: 2077508.7617s
	iters: 200, epoch: 2 | loss: 0.1356176
	speed: 0.2759s/iter; left time: 148993.1431s
	iters: 300, epoch: 2 | loss: 0.1545876
	speed: 0.2762s/iter; left time: 149130.2631s
	iters: 400, epoch: 2 | loss: 0.1556721
	speed: 0.2761s/iter; left time: 149068.9162s
	iters: 500, epoch: 2 | loss: 0.1333439
	speed: 0.2754s/iter; left time: 148678.6335s
	iters: 600, epoch: 2 | loss: 0.1520758
	speed: 0.2763s/iter; left time: 149130.9094s
	iters: 700, epoch: 2 | loss: 0.1344370
	speed: 0.2767s/iter; left time: 149297.4812s
	iters: 800, epoch: 2 | loss: 0.1381333
	speed: 0.2777s/iter; left time: 149789.0679s
	iters: 900, epoch: 2 | loss: 0.1058968
	speed: 0.2775s/iter; left time: 149673.2750s
	iters: 1000, epoch: 2 | loss: 0.1434679
	speed: 0.2778s/iter; left time: 149826.6715s
	iters: 1100, epoch: 2 | loss: 0.1486292
	speed: 0.2775s/iter; left time: 149610.5810s
	iters: 1200, epoch: 2 | loss: 0.1263826
	speed: 0.2774s/iter; left time: 149543.2238s
	iters: 1300, epoch: 2 | loss: 0.1278652
	speed: 0.2774s/iter; left time: 149534.0525s
	iters: 1400, epoch: 2 | loss: 0.1445508
	speed: 0.2780s/iter; left time: 149832.6389s
	iters: 1500, epoch: 2 | loss: 0.1247297
	speed: 0.2779s/iter; left time: 149716.6519s
	iters: 1600, epoch: 2 | loss: 0.1152641
	speed: 0.2789s/iter; left time: 150247.4541s
	iters: 1700, epoch: 2 | loss: 0.1349296
	speed: 0.2782s/iter; left time: 149844.8449s
	iters: 1800, epoch: 2 | loss: 0.1318797
	speed: 0.2785s/iter; left time: 149952.8621s
	iters: 1900, epoch: 2 | loss: 0.1197936
	speed: 0.2786s/iter; left time: 149990.9721s
	iters: 2000, epoch: 2 | loss: 0.1271372
	speed: 0.2782s/iter; left time: 149776.6937s
	iters: 2100, epoch: 2 | loss: 0.1149669
	speed: 0.2776s/iter; left time: 149422.8859s
	iters: 2200, epoch: 2 | loss: 0.1259069
	speed: 0.2782s/iter; left time: 149693.6210s
	iters: 2300, epoch: 2 | loss: 0.1584217
	speed: 0.2778s/iter; left time: 149454.0370s
	iters: 2400, epoch: 2 | loss: 0.1535426
	speed: 0.2783s/iter; left time: 149703.1017s
	iters: 2500, epoch: 2 | loss: 0.3348311
	speed: 0.2786s/iter; left time: 149842.3998s
	iters: 2600, epoch: 2 | loss: 0.1848755
	speed: 0.2783s/iter; left time: 149621.1405s
	iters: 2700, epoch: 2 | loss: 0.2667437
	speed: 0.2784s/iter; left time: 149685.7002s
Epoch: 2 cost time: 753.9943482875824
Epoch: 2, Steps: 2715 | Train Loss: 0.1459881 Vali Loss: 0.1789954 Test Loss: 0.2442125
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.2244582
	speed: 3.8502s/iter; left time: 2069378.4430s
	iters: 200, epoch: 3 | loss: 0.2095167
	speed: 0.2766s/iter; left time: 148645.3172s
	iters: 300, epoch: 3 | loss: 0.2098178
	speed: 0.2776s/iter; left time: 149150.7630s
	iters: 400, epoch: 3 | loss: 0.3102421
	speed: 0.2765s/iter; left time: 148510.1696s
	iters: 500, epoch: 3 | loss: 0.2119966
	speed: 0.2763s/iter; left time: 148384.4371s
	iters: 600, epoch: 3 | loss: 0.1744819
	speed: 0.2768s/iter; left time: 148643.4720s
	iters: 700, epoch: 3 | loss: 0.2266946
	speed: 0.2772s/iter; left time: 148810.0686s
	iters: 800, epoch: 3 | loss: 0.2454358
	speed: 0.2763s/iter; left time: 148294.8713s
	iters: 900, epoch: 3 | loss: 0.2563841
	speed: 0.2764s/iter; left time: 148322.0730s
	iters: 1000, epoch: 3 | loss: 0.2270664
	speed: 0.2762s/iter; left time: 148197.1293s
	iters: 1100, epoch: 3 | loss: 0.2627219
	speed: 0.2764s/iter; left time: 148287.8448s
	iters: 1200, epoch: 3 | loss: 0.2417086
	speed: 0.2770s/iter; left time: 148575.3645s
	iters: 1300, epoch: 3 | loss: 0.2379975
	speed: 0.2761s/iter; left time: 148044.1623s
	iters: 1400, epoch: 3 | loss: 0.2788570
	speed: 0.2767s/iter; left time: 148351.4648s
	iters: 1500, epoch: 3 | loss: 0.2032738
	speed: 0.2765s/iter; left time: 148242.0429s
	iters: 1600, epoch: 3 | loss: 0.3482662
	speed: 0.2765s/iter; left time: 148185.3132s
	iters: 1700, epoch: 3 | loss: 0.2179837
	speed: 0.2761s/iter; left time: 147947.9049s
	iters: 1800, epoch: 3 | loss: 0.2203721
	speed: 0.2768s/iter; left time: 148277.5926s
	iters: 1900, epoch: 3 | loss: 0.2236993
	speed: 0.2764s/iter; left time: 148057.6093s
	iters: 2000, epoch: 3 | loss: 0.1911474
	speed: 0.2766s/iter; left time: 148137.4170s
	iters: 2100, epoch: 3 | loss: 0.2229512
	speed: 0.2763s/iter; left time: 147932.8706s
	iters: 2200, epoch: 3 | loss: 0.2028994
	speed: 0.2762s/iter; left time: 147872.7066s
	iters: 2300, epoch: 3 | loss: 0.2289811
	speed: 0.2769s/iter; left time: 148219.3414s
	iters: 2400, epoch: 3 | loss: 0.2457848
	speed: 0.2762s/iter; left time: 147812.1613s
	iters: 2500, epoch: 3 | loss: 0.1693627
	speed: 0.2762s/iter; left time: 147792.1028s
	iters: 2600, epoch: 3 | loss: 0.1833933
	speed: 0.2761s/iter; left time: 147717.2218s
	iters: 2700, epoch: 3 | loss: 0.1842684
	speed: 0.2766s/iter; left time: 147932.6012s
Epoch: 3 cost time: 751.4220600128174
Epoch: 3, Steps: 2715 | Train Loss: 0.2288271 Vali Loss: 0.1750305 Test Loss: 0.2570719
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.1895454
	speed: 3.8308s/iter; left time: 2048525.8455s
	iters: 200, epoch: 4 | loss: 0.1723654
	speed: 0.2775s/iter; left time: 148343.8261s
	iters: 300, epoch: 4 | loss: 0.1772624
	speed: 0.2787s/iter; left time: 148956.1757s
	iters: 400, epoch: 4 | loss: 0.2041944
	speed: 0.2778s/iter; left time: 148478.3039s
	iters: 500, epoch: 4 | loss: 0.1999703
	speed: 0.2779s/iter; left time: 148484.7629s
	iters: 600, epoch: 4 | loss: 0.1695072
	speed: 0.2762s/iter; left time: 147550.9815s
	iters: 700, epoch: 4 | loss: 0.1679679
	speed: 0.2765s/iter; left time: 147699.5546s
	iters: 800, epoch: 4 | loss: 0.2157831
	speed: 0.2755s/iter; left time: 147119.1053s
	iters: 900, epoch: 4 | loss: 0.2128714
	speed: 0.2757s/iter; left time: 147186.4357s
	iters: 1000, epoch: 4 | loss: 0.2498279
	speed: 0.2760s/iter; left time: 147336.4773s
	iters: 1100, epoch: 4 | loss: 0.2270272
	speed: 0.2762s/iter; left time: 147407.1113s
	iters: 1200, epoch: 4 | loss: 0.1980844
	speed: 0.2771s/iter; left time: 147881.9305s
	iters: 1300, epoch: 4 | loss: 0.2307211
	speed: 0.2758s/iter; left time: 147150.9230s
	iters: 1400, epoch: 4 | loss: 0.1938498
	speed: 0.2759s/iter; left time: 147200.3586s
	iters: 1500, epoch: 4 | loss: 0.2513755
	speed: 0.2759s/iter; left time: 147172.7954s
	iters: 1600, epoch: 4 | loss: 0.1756436
	speed: 0.2762s/iter; left time: 147295.6340s
	iters: 1700, epoch: 4 | loss: 0.2267474
	speed: 0.2763s/iter; left time: 147298.0962s
	iters: 1800, epoch: 4 | loss: 0.2043546
	speed: 0.2764s/iter; left time: 147332.0046s
	iters: 1900, epoch: 4 | loss: 0.2142753
	speed: 0.2768s/iter; left time: 147540.6407s
	iters: 2000, epoch: 4 | loss: 0.2108291
	speed: 0.2760s/iter; left time: 147082.5859s
	iters: 2100, epoch: 4 | loss: 0.1967247
	speed: 0.2762s/iter; left time: 147167.3048s
	iters: 2200, epoch: 4 | loss: 0.1829730
	speed: 0.2760s/iter; left time: 147027.7539s
	iters: 2300, epoch: 4 | loss: 0.1982537
	speed: 0.2760s/iter; left time: 146963.9301s
	iters: 2400, epoch: 4 | loss: 0.1579027
	speed: 0.2760s/iter; left time: 146940.6173s
	iters: 2500, epoch: 4 | loss: 0.1847670
	speed: 0.2762s/iter; left time: 147038.1012s
	iters: 2600, epoch: 4 | loss: 0.1813330
	speed: 0.2761s/iter; left time: 146937.5935s
	iters: 2700, epoch: 4 | loss: 0.2017771
	speed: 0.2765s/iter; left time: 147138.2620s
Epoch: 4 cost time: 751.1567969322205
Epoch: 4, Steps: 2715 | Train Loss: 0.1998295 Vali Loss: 0.1896433 Test Loss: 0.2420287
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.1701164
	speed: 3.8456s/iter; left time: 2046021.2532s
	iters: 200, epoch: 5 | loss: 0.1682871
	speed: 0.2765s/iter; left time: 147060.4540s
	iters: 300, epoch: 5 | loss: 0.1741293
	speed: 0.2767s/iter; left time: 147171.3848s
	iters: 400, epoch: 5 | loss: 0.1724030
	speed: 0.2763s/iter; left time: 146919.0615s
	iters: 500, epoch: 5 | loss: 0.2184278
	speed: 0.2767s/iter; left time: 147102.1980s
	iters: 600, epoch: 5 | loss: 0.2106581
	speed: 0.2775s/iter; left time: 147502.7960s
	iters: 700, epoch: 5 | loss: 0.1936596
	speed: 0.2774s/iter; left time: 147428.1929s
	iters: 800, epoch: 5 | loss: 0.1744359
	speed: 0.2773s/iter; left time: 147323.6396s
	iters: 900, epoch: 5 | loss: 0.1868149
	speed: 0.2772s/iter; left time: 147286.3717s
	iters: 1000, epoch: 5 | loss: 0.1825532
	speed: 0.2774s/iter; left time: 147313.7489s
	iters: 1100, epoch: 5 | loss: 0.1733720
	speed: 0.2775s/iter; left time: 147361.7049s
	iters: 1200, epoch: 5 | loss: 0.2008766
	speed: 0.2772s/iter; left time: 147181.0797s
	iters: 1300, epoch: 5 | loss: 0.1689605
	speed: 0.2775s/iter; left time: 147309.9507s
	iters: 1400, epoch: 5 | loss: 0.1486602
	speed: 0.2776s/iter; left time: 147337.1421s
	iters: 1500, epoch: 5 | loss: 0.1844179
	speed: 0.2768s/iter; left time: 146867.7770s
	iters: 1600, epoch: 5 | loss: 0.1531103
	speed: 0.2781s/iter; left time: 147527.0940s
	iters: 1700, epoch: 5 | loss: 0.1774655
	speed: 0.2773s/iter; left time: 147087.5042s
	iters: 1800, epoch: 5 | loss: 0.1729567
	speed: 0.2772s/iter; left time: 146989.2778s
	iters: 1900, epoch: 5 | loss: 0.1648243
	speed: 0.2765s/iter; left time: 146597.7688s
	iters: 2000, epoch: 5 | loss: 0.1815069
	speed: 0.2765s/iter; left time: 146598.3834s
	iters: 2100, epoch: 5 | loss: 0.1696200
	speed: 0.2762s/iter; left time: 146384.2631s
	iters: 2200, epoch: 5 | loss: 0.1658981
	speed: 0.2761s/iter; left time: 146319.6042s
	iters: 2300, epoch: 5 | loss: 0.1774320
	speed: 0.2772s/iter; left time: 146872.6858s
	iters: 2400, epoch: 5 | loss: 0.1429080
	speed: 0.2772s/iter; left time: 146848.1068s
	iters: 2500, epoch: 5 | loss: 0.1477851
	speed: 0.2764s/iter; left time: 146372.3995s
	iters: 2600, epoch: 5 | loss: 0.1669587
	speed: 0.2765s/iter; left time: 146425.8831s
	iters: 2700, epoch: 5 | loss: 0.1476770
	speed: 0.2770s/iter; left time: 146649.1652s
Epoch: 5 cost time: 752.3959760665894
Epoch: 5, Steps: 2715 | Train Loss: 0.1711387 Vali Loss: 0.2116098 Test Loss: 0.2682259
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.1584827
	speed: 3.8377s/iter; left time: 2031419.1344s
	iters: 200, epoch: 6 | loss: 0.1579110
	speed: 0.2761s/iter; left time: 146143.3121s
	iters: 300, epoch: 6 | loss: 0.2037043
	speed: 0.2769s/iter; left time: 146498.0586s
	iters: 400, epoch: 6 | loss: 0.1577535
	speed: 0.2769s/iter; left time: 146482.9432s
	iters: 500, epoch: 6 | loss: 0.1704607
	speed: 0.2760s/iter; left time: 146005.5860s
	iters: 600, epoch: 6 | loss: 0.1659861
	speed: 0.2760s/iter; left time: 145957.2212s
	iters: 700, epoch: 6 | loss: 0.1929258
	speed: 0.2763s/iter; left time: 146060.6785s
	iters: 800, epoch: 6 | loss: 0.2410768
	speed: 0.2765s/iter; left time: 146175.3033s
	iters: 900, epoch: 6 | loss: 0.1898086
	speed: 0.2766s/iter; left time: 146202.6953s
	iters: 1000, epoch: 6 | loss: 0.1596583
	speed: 0.2768s/iter; left time: 146286.6734s
	iters: 1100, epoch: 6 | loss: 0.1802931
	speed: 0.2764s/iter; left time: 146003.4934s
	iters: 1200, epoch: 6 | loss: 0.2173373
	speed: 0.2766s/iter; left time: 146116.5686s
	iters: 1300, epoch: 6 | loss: 0.1684191
	speed: 0.2770s/iter; left time: 146282.5805s
	iters: 1400, epoch: 6 | loss: 0.1674190
	speed: 0.2766s/iter; left time: 146040.1469s
	iters: 1500, epoch: 6 | loss: 0.1418693
	speed: 0.2770s/iter; left time: 146225.7865s
	iters: 1600, epoch: 6 | loss: 0.1684330
	speed: 0.2775s/iter; left time: 146495.5221s
	iters: 1700, epoch: 6 | loss: 0.1568494
	speed: 0.2762s/iter; left time: 145777.6655s
	iters: 1800, epoch: 6 | loss: 0.1316457
	speed: 0.2767s/iter; left time: 146001.7617s
	iters: 1900, epoch: 6 | loss: 0.1318564
	speed: 0.2765s/iter; left time: 145861.0766s
	iters: 2000, epoch: 6 | loss: 0.1926507
	speed: 0.2779s/iter; left time: 146546.1131s
	iters: 2100, epoch: 6 | loss: 0.1485516
	speed: 0.2770s/iter; left time: 146068.3895s
	iters: 2200, epoch: 6 | loss: 0.1378130
	speed: 0.2769s/iter; left time: 146013.9280s
	iters: 2300, epoch: 6 | loss: 0.1229754
	speed: 0.2774s/iter; left time: 146204.7887s
	iters: 2400, epoch: 6 | loss: 0.1539801
	speed: 0.2767s/iter; left time: 145817.9406s
	iters: 2500, epoch: 6 | loss: 0.1242397
	speed: 0.2777s/iter; left time: 146333.5587s
	iters: 2600, epoch: 6 | loss: 0.1319712
	speed: 0.2769s/iter; left time: 145892.1171s
	iters: 2700, epoch: 6 | loss: 0.1362151
	speed: 0.2772s/iter; left time: 145996.7809s
Epoch: 6 cost time: 751.8903977870941
Epoch: 6, Steps: 2715 | Train Loss: 0.1697613 Vali Loss: 0.1630553 Test Loss: 0.2157668
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_h_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 24341
test shape: (24341, 1, 720, 130) (24341, 1, 720, 130)
test shape: (24341, 720, 130) (24341, 720, 130)
mse:0.2688189744949341, mae:0.34588658809661865
>>>>>>>Overall time: 7249 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
