Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=1543, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=1543, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1543, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems12_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4865
val 93
test 904
	iters: 100, epoch: 1 | loss: 1.0306748
	speed: 0.2021s/iter; left time: 6124.3121s
Epoch: 1 cost time: 30.409720420837402
Epoch: 1, Steps: 152 | Train Loss: 1.0119090 Vali Loss: 0.9098573 Test Loss: 2.5895922
Validation loss decreased (inf --> 0.909857).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9774579
	speed: 0.4475s/iter; left time: 13492.0119s
Epoch: 2 cost time: 30.14830493927002
Epoch: 2, Steps: 152 | Train Loss: 0.9847659 Vali Loss: 0.9039739 Test Loss: 2.5940773
Validation loss decreased (0.909857 --> 0.903974).  Saving model ...
	iters: 100, epoch: 3 | loss: 1.0257828
	speed: 0.4443s/iter; left time: 13326.4273s
Epoch: 3 cost time: 29.822078943252563
Epoch: 3, Steps: 152 | Train Loss: 0.9831509 Vali Loss: 0.9059073 Test Loss: 2.5972679
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.9466226
	speed: 0.4431s/iter; left time: 13224.5406s
Epoch: 4 cost time: 29.861641883850098
Epoch: 4, Steps: 152 | Train Loss: 0.9829634 Vali Loss: 0.9047058 Test Loss: 2.5977027
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.9846401
	speed: 0.4441s/iter; left time: 13187.3097s
Epoch: 5 cost time: 29.963462352752686
Epoch: 5, Steps: 152 | Train Loss: 0.9827494 Vali Loss: 0.9033950 Test Loss: 2.5982811
Validation loss decreased (0.903974 --> 0.903395).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0530344
	speed: 0.4467s/iter; left time: 13196.0574s
Epoch: 6 cost time: 30.118945837020874
Epoch: 6, Steps: 152 | Train Loss: 0.9827299 Vali Loss: 0.9041034 Test Loss: 2.5994859
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.9651425
	speed: 0.4450s/iter; left time: 13076.9892s
Epoch: 7 cost time: 29.926066398620605
Epoch: 7, Steps: 152 | Train Loss: 0.9826655 Vali Loss: 0.9026129 Test Loss: 2.5976772
Validation loss decreased (0.903395 --> 0.902613).  Saving model ...
	iters: 100, epoch: 8 | loss: 0.9869293
	speed: 0.4450s/iter; left time: 13009.1922s
Epoch: 8 cost time: 29.869088411331177
Epoch: 8, Steps: 152 | Train Loss: 0.9827197 Vali Loss: 0.9084976 Test Loss: 2.5989854
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 9 | loss: 0.9492483
	speed: 0.4451s/iter; left time: 12946.3187s
Epoch: 9 cost time: 30.11983323097229
Epoch: 9, Steps: 152 | Train Loss: 0.9826844 Vali Loss: 0.9034305 Test Loss: 2.5984583
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 10 | loss: 0.9006838
	speed: 0.4463s/iter; left time: 12913.8140s
Epoch: 10 cost time: 30.139116525650024
Epoch: 10, Steps: 152 | Train Loss: 0.9825959 Vali Loss: 0.9050596 Test Loss: 2.5982194
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 11 | loss: 1.0154265
	speed: 0.4497s/iter; left time: 12943.4772s
Epoch: 11 cost time: 30.12010955810547
Epoch: 11, Steps: 152 | Train Loss: 0.9827264 Vali Loss: 0.9069117 Test Loss: 2.5990725
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 12 | loss: 0.9907792
	speed: 0.4470s/iter; left time: 12795.7627s
Epoch: 12 cost time: 30.150261640548706
Epoch: 12, Steps: 152 | Train Loss: 0.9826709 Vali Loss: 0.9037603 Test Loss: 2.5990319
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems12_d_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 904
test shape: (904, 1, 720, 1543) (904, 1, 720, 1543)
test shape: (904, 720, 1543) (904, 720, 1543)
mse:2.597667932510376, mae:0.7670287489891052
>>>>>>>Overall time: 587 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=1543, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=1543, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1543, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems12_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4865
val 93
test 904
	iters: 100, epoch: 1 | loss: 0.9879776
	speed: 0.1162s/iter; left time: 3520.1947s
Epoch: 1 cost time: 17.37813639640808
Epoch: 1, Steps: 152 | Train Loss: 0.9729866 Vali Loss: 0.8776733 Test Loss: 2.3237565
Validation loss decreased (inf --> 0.877673).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9104911
	speed: 0.2613s/iter; left time: 7878.4237s
Epoch: 2 cost time: 17.250759601593018
Epoch: 2, Steps: 152 | Train Loss: 0.9327611 Vali Loss: 0.8709766 Test Loss: 2.3196270
Validation loss decreased (0.877673 --> 0.870977).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9841226
	speed: 0.2634s/iter; left time: 7902.0647s
Epoch: 3 cost time: 17.212897539138794
Epoch: 3, Steps: 152 | Train Loss: 0.9298389 Vali Loss: 0.8697197 Test Loss: 2.3192105
Validation loss decreased (0.870977 --> 0.869720).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8998506
	speed: 0.2654s/iter; left time: 7919.5267s
Epoch: 4 cost time: 17.363529682159424
Epoch: 4, Steps: 152 | Train Loss: 0.9293232 Vali Loss: 0.8701408 Test Loss: 2.3198643
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.9437893
	speed: 0.2634s/iter; left time: 7822.5719s
Epoch: 5 cost time: 17.14145302772522
Epoch: 5, Steps: 152 | Train Loss: 0.9288745 Vali Loss: 0.8688666 Test Loss: 2.3194699
Validation loss decreased (0.869720 --> 0.868867).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0212616
	speed: 0.2620s/iter; left time: 7739.0735s
Epoch: 6 cost time: 17.063621997833252
Epoch: 6, Steps: 152 | Train Loss: 0.9288688 Vali Loss: 0.8698316 Test Loss: 2.3209307
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.9131153
	speed: 0.2615s/iter; left time: 7685.4332s
Epoch: 7 cost time: 17.177451610565186
Epoch: 7, Steps: 152 | Train Loss: 0.9286201 Vali Loss: 0.8690614 Test Loss: 2.3200004
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 8 | loss: 0.9510602
	speed: 0.2619s/iter; left time: 7656.7052s
Epoch: 8 cost time: 17.135963201522827
Epoch: 8, Steps: 152 | Train Loss: 0.9286328 Vali Loss: 0.8695842 Test Loss: 2.3199043
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 9 | loss: 0.8731007
	speed: 0.2617s/iter; left time: 7612.8602s
Epoch: 9 cost time: 17.14687967300415
Epoch: 9, Steps: 152 | Train Loss: 0.9286166 Vali Loss: 0.8687135 Test Loss: 2.3208494
Validation loss decreased (0.868867 --> 0.868713).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8450861
	speed: 0.2612s/iter; left time: 7556.9438s
Epoch: 10 cost time: 17.299254179000854
Epoch: 10, Steps: 152 | Train Loss: 0.9284347 Vali Loss: 0.8705608 Test Loss: 2.3193781
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 11 | loss: 0.9742819
	speed: 0.2646s/iter; left time: 7616.8156s
Epoch: 11 cost time: 17.327759504318237
Epoch: 11, Steps: 152 | Train Loss: 0.9286829 Vali Loss: 0.8708771 Test Loss: 2.3199191
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 12 | loss: 0.9507198
	speed: 0.2625s/iter; left time: 7515.8282s
Epoch: 12 cost time: 17.15281105041504
Epoch: 12, Steps: 152 | Train Loss: 0.9285864 Vali Loss: 0.8695853 Test Loss: 2.3208816
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 13 | loss: 0.9036078
	speed: 0.2601s/iter; left time: 7406.4874s
Epoch: 13 cost time: 17.307377338409424
Epoch: 13, Steps: 152 | Train Loss: 0.9284521 Vali Loss: 0.8703175 Test Loss: 2.3198929
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 14 | loss: 0.9023182
	speed: 0.2638s/iter; left time: 7473.2775s
Epoch: 14 cost time: 17.268871545791626
Epoch: 14, Steps: 152 | Train Loss: 0.9284543 Vali Loss: 0.8703756 Test Loss: 2.3215480
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems12_d_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 904
test shape: (904, 1, 720, 867) (904, 1, 720, 867)
test shape: (904, 720, 867) (904, 720, 867)
mse:2.320852518081665, mae:0.8292555809020996
>>>>>>>Overall time: 388 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=867, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=867, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=867, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems12_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4865
val 93
test 904
	iters: 100, epoch: 1 | loss: 0.9879776
	speed: 0.1132s/iter; left time: 3430.9001s
Epoch: 1 cost time: 17.03507089614868
Epoch: 1, Steps: 152 | Train Loss: 0.9729866 Vali Loss: 0.8776733 Test Loss: 2.3237565
Validation loss decreased (inf --> 0.877673).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9104911
	speed: 0.2544s/iter; left time: 7669.5909s
Epoch: 2 cost time: 16.86390495300293
Epoch: 2, Steps: 152 | Train Loss: 0.9327611 Vali Loss: 0.8709766 Test Loss: 2.3196270
Validation loss decreased (0.877673 --> 0.870977).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.9841226
	speed: 0.2546s/iter; left time: 7637.6342s
Epoch: 3 cost time: 17.015140771865845
Epoch: 3, Steps: 152 | Train Loss: 0.9298389 Vali Loss: 0.8697197 Test Loss: 2.3192105
Validation loss decreased (0.870977 --> 0.869720).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8998506
	speed: 0.2549s/iter; left time: 7607.6616s
Epoch: 4 cost time: 16.829782009124756
Epoch: 4, Steps: 152 | Train Loss: 0.9293232 Vali Loss: 0.8701408 Test Loss: 2.3198643
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.9437893
	speed: 0.2522s/iter; left time: 7488.8354s
Epoch: 5 cost time: 16.613056898117065
Epoch: 5, Steps: 152 | Train Loss: 0.9288745 Vali Loss: 0.8688666 Test Loss: 2.3194699
Validation loss decreased (0.869720 --> 0.868867).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0212616
	speed: 0.2520s/iter; left time: 7445.1419s
Epoch: 6 cost time: 16.89484190940857
Epoch: 6, Steps: 152 | Train Loss: 0.9288688 Vali Loss: 0.8698316 Test Loss: 2.3209307
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.9131153
	speed: 0.2541s/iter; left time: 7468.4045s
Epoch: 7 cost time: 16.851449012756348
Epoch: 7, Steps: 152 | Train Loss: 0.9286201 Vali Loss: 0.8690614 Test Loss: 2.3200004
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 8 | loss: 0.9510602
	speed: 0.2517s/iter; left time: 7359.5606s
Epoch: 8 cost time: 16.604998350143433
Epoch: 8, Steps: 152 | Train Loss: 0.9286328 Vali Loss: 0.8695842 Test Loss: 2.3199043
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 9 | loss: 0.8731007
	speed: 0.2530s/iter; left time: 7359.8768s
Epoch: 9 cost time: 16.760005950927734
Epoch: 9, Steps: 152 | Train Loss: 0.9286166 Vali Loss: 0.8687135 Test Loss: 2.3208494
Validation loss decreased (0.868867 --> 0.868713).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.8450861
	speed: 0.2524s/iter; left time: 7302.6033s
Epoch: 10 cost time: 16.805687427520752
Epoch: 10, Steps: 152 | Train Loss: 0.9284347 Vali Loss: 0.8705608 Test Loss: 2.3193781
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 11 | loss: 0.9742819
	speed: 0.2536s/iter; left time: 7299.0774s
Epoch: 11 cost time: 16.641385793685913
Epoch: 11, Steps: 152 | Train Loss: 0.9286829 Vali Loss: 0.8708771 Test Loss: 2.3199191
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 12 | loss: 0.9507198
	speed: 0.2549s/iter; left time: 7297.5641s
Epoch: 12 cost time: 16.961595058441162
Epoch: 12, Steps: 152 | Train Loss: 0.9285864 Vali Loss: 0.8695853 Test Loss: 2.3208816
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 13 | loss: 0.9036078
	speed: 0.2557s/iter; left time: 7281.2129s
Epoch: 13 cost time: 16.93554949760437
Epoch: 13, Steps: 152 | Train Loss: 0.9284521 Vali Loss: 0.8703175 Test Loss: 2.3198929
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 14 | loss: 0.9023182
	speed: 0.2528s/iter; left time: 7160.0999s
Epoch: 14 cost time: 16.572649717330933
Epoch: 14, Steps: 152 | Train Loss: 0.9284543 Vali Loss: 0.8703756 Test Loss: 2.3215480
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems12_d_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 904
test shape: (904, 1, 720, 867) (904, 1, 720, 867)
test shape: (904, 720, 867) (904, 720, 867)
mse:2.320852518081665, mae:0.8292555809020996
>>>>>>>Overall time: 374 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
