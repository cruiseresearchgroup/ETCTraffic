Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_h.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 133364
val 18779
test 37892
	iters: 100, epoch: 1 | loss: 0.3636352
	speed: 0.1688s/iter; left time: 140671.1912s
	iters: 200, epoch: 1 | loss: 0.2850068
	speed: 0.1628s/iter; left time: 135607.6968s
	iters: 300, epoch: 1 | loss: 0.3250790
	speed: 0.1624s/iter; left time: 135326.0460s
	iters: 400, epoch: 1 | loss: 0.2968096
	speed: 0.1626s/iter; left time: 135467.9816s
	iters: 500, epoch: 1 | loss: 0.2427783
	speed: 0.1623s/iter; left time: 135214.5639s
	iters: 600, epoch: 1 | loss: 0.2317757
	speed: 0.1624s/iter; left time: 135273.8522s
	iters: 700, epoch: 1 | loss: 0.2617149
	speed: 0.1633s/iter; left time: 135966.6738s
	iters: 800, epoch: 1 | loss: 0.2593560
	speed: 0.1625s/iter; left time: 135261.1748s
	iters: 900, epoch: 1 | loss: 0.2529537
	speed: 0.1633s/iter; left time: 135987.6830s
	iters: 1000, epoch: 1 | loss: 0.2313508
	speed: 0.1626s/iter; left time: 135385.1672s
	iters: 1100, epoch: 1 | loss: 0.2424574
	speed: 0.1627s/iter; left time: 135386.1012s
	iters: 1200, epoch: 1 | loss: 0.2244217
	speed: 0.1626s/iter; left time: 135340.0174s
	iters: 1300, epoch: 1 | loss: 0.2239800
	speed: 0.1629s/iter; left time: 135565.5184s
	iters: 1400, epoch: 1 | loss: 0.2048338
	speed: 0.1635s/iter; left time: 136046.3120s
	iters: 1500, epoch: 1 | loss: 0.1835274
	speed: 0.1629s/iter; left time: 135500.9799s
	iters: 1600, epoch: 1 | loss: 0.1794446
	speed: 0.1636s/iter; left time: 136094.7876s
	iters: 1700, epoch: 1 | loss: 0.2071657
	speed: 0.1625s/iter; left time: 135165.1066s
	iters: 1800, epoch: 1 | loss: 0.2124829
	speed: 0.1634s/iter; left time: 135853.9456s
	iters: 1900, epoch: 1 | loss: 0.2282666
	speed: 0.1630s/iter; left time: 135533.0192s
	iters: 2000, epoch: 1 | loss: 0.1777804
	speed: 0.1634s/iter; left time: 135865.5831s
	iters: 2100, epoch: 1 | loss: 0.2187401
	speed: 0.1629s/iter; left time: 135426.7872s
	iters: 2200, epoch: 1 | loss: 0.1912064
	speed: 0.1626s/iter; left time: 135172.1685s
	iters: 2300, epoch: 1 | loss: 0.1982916
	speed: 0.1627s/iter; left time: 135188.4246s
	iters: 2400, epoch: 1 | loss: 0.1707376
	speed: 0.1630s/iter; left time: 135433.1974s
	iters: 2500, epoch: 1 | loss: 0.1681851
	speed: 0.1623s/iter; left time: 134875.3379s
	iters: 2600, epoch: 1 | loss: 0.2022763
	speed: 0.1630s/iter; left time: 135427.7033s
	iters: 2700, epoch: 1 | loss: 0.1767947
	speed: 0.1630s/iter; left time: 135363.6139s
	iters: 2800, epoch: 1 | loss: 0.1926219
	speed: 0.1627s/iter; left time: 135128.6751s
	iters: 2900, epoch: 1 | loss: 0.1862302
	speed: 0.1625s/iter; left time: 134929.1113s
	iters: 3000, epoch: 1 | loss: 0.3158869
	speed: 0.1627s/iter; left time: 135085.5533s
	iters: 3100, epoch: 1 | loss: 0.3519180
	speed: 0.1643s/iter; left time: 136396.3329s
	iters: 3200, epoch: 1 | loss: 0.3039479
	speed: 0.1631s/iter; left time: 135407.1286s
	iters: 3300, epoch: 1 | loss: 0.2873940
	speed: 0.1626s/iter; left time: 135012.3424s
	iters: 3400, epoch: 1 | loss: 0.2664044
	speed: 0.1631s/iter; left time: 135351.0922s
	iters: 3500, epoch: 1 | loss: 0.2563276
	speed: 0.1629s/iter; left time: 135202.7108s
	iters: 3600, epoch: 1 | loss: 0.2939328
	speed: 0.1623s/iter; left time: 134717.2478s
	iters: 3700, epoch: 1 | loss: 0.2601733
	speed: 0.1630s/iter; left time: 135236.5724s
	iters: 3800, epoch: 1 | loss: 0.2755239
	speed: 0.1629s/iter; left time: 135143.8381s
	iters: 3900, epoch: 1 | loss: 0.2557628
	speed: 0.1630s/iter; left time: 135198.0681s
	iters: 4000, epoch: 1 | loss: 0.2872554
	speed: 0.1628s/iter; left time: 135016.3343s
	iters: 4100, epoch: 1 | loss: 0.2415648
	speed: 0.1628s/iter; left time: 135035.6631s
Epoch: 1 cost time: 679.4963698387146
Epoch: 1, Steps: 4167 | Train Loss: 0.2502297 Vali Loss: 0.2734587 Test Loss: 0.2475541
Validation loss decreased (inf --> 0.273459).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2859986
	speed: 5.2259s/iter; left time: 4332964.4629s
	iters: 200, epoch: 2 | loss: 0.2376742
	speed: 0.1701s/iter; left time: 141018.5114s
	iters: 300, epoch: 2 | loss: 0.2633178
	speed: 0.1705s/iter; left time: 141340.6243s
	iters: 400, epoch: 2 | loss: 0.2656129
	speed: 0.1705s/iter; left time: 141308.5669s
	iters: 500, epoch: 2 | loss: 0.2570853
	speed: 0.1706s/iter; left time: 141409.6365s
	iters: 600, epoch: 2 | loss: 0.2333153
	speed: 0.1709s/iter; left time: 141623.7125s
	iters: 700, epoch: 2 | loss: 0.2280164
	speed: 0.1691s/iter; left time: 140131.4556s
	iters: 800, epoch: 2 | loss: 0.2496024
	speed: 0.1689s/iter; left time: 139920.1511s
	iters: 900, epoch: 2 | loss: 0.2862422
	speed: 0.1672s/iter; left time: 138534.2809s
	iters: 1000, epoch: 2 | loss: 0.2347616
	speed: 0.1664s/iter; left time: 137829.7929s
	iters: 1100, epoch: 2 | loss: 0.2481595
	speed: 0.1670s/iter; left time: 138276.7032s
	iters: 1200, epoch: 2 | loss: 0.2851857
	speed: 0.1668s/iter; left time: 138103.2948s
	iters: 1300, epoch: 2 | loss: 0.2255024
	speed: 0.1661s/iter; left time: 137527.7915s
	iters: 1400, epoch: 2 | loss: 0.2637696
	speed: 0.1667s/iter; left time: 138032.7197s
	iters: 1500, epoch: 2 | loss: 0.2770637
	speed: 0.1666s/iter; left time: 137937.2075s
	iters: 1600, epoch: 2 | loss: 0.2710636
	speed: 0.1664s/iter; left time: 137740.0435s
	iters: 1700, epoch: 2 | loss: 0.2541292
	speed: 0.1670s/iter; left time: 138229.5155s
	iters: 1800, epoch: 2 | loss: 0.2220500
	speed: 0.1667s/iter; left time: 137973.4986s
	iters: 1900, epoch: 2 | loss: 0.2365659
	speed: 0.1669s/iter; left time: 138056.2110s
	iters: 2000, epoch: 2 | loss: 0.2245468
	speed: 0.1667s/iter; left time: 137898.9538s
	iters: 2100, epoch: 2 | loss: 0.2069674
	speed: 0.1663s/iter; left time: 137575.2884s
	iters: 2200, epoch: 2 | loss: 0.2323316
	speed: 0.1670s/iter; left time: 138083.9538s
	iters: 2300, epoch: 2 | loss: 0.2278132
	speed: 0.1661s/iter; left time: 137382.8132s
	iters: 2400, epoch: 2 | loss: 0.2321387
	speed: 0.1666s/iter; left time: 137787.0324s
	iters: 2500, epoch: 2 | loss: 0.2145345
	speed: 0.1667s/iter; left time: 137821.6892s
	iters: 2600, epoch: 2 | loss: 0.1934548
	speed: 0.1671s/iter; left time: 138139.2745s
	iters: 2700, epoch: 2 | loss: 0.2071148
	speed: 0.1667s/iter; left time: 137753.4445s
	iters: 2800, epoch: 2 | loss: 0.2356585
	speed: 0.1668s/iter; left time: 137846.8549s
	iters: 2900, epoch: 2 | loss: 0.2213982
	speed: 0.1670s/iter; left time: 138012.7632s
	iters: 3000, epoch: 2 | loss: 0.2514701
	speed: 0.1667s/iter; left time: 137748.6465s
	iters: 3100, epoch: 2 | loss: 0.2453274
	speed: 0.1662s/iter; left time: 137301.6775s
	iters: 3200, epoch: 2 | loss: 0.2143280
	speed: 0.1666s/iter; left time: 137588.8759s
	iters: 3300, epoch: 2 | loss: 0.2284254
	speed: 0.1668s/iter; left time: 137730.1831s
	iters: 3400, epoch: 2 | loss: 0.2418552
	speed: 0.1667s/iter; left time: 137670.7715s
	iters: 3500, epoch: 2 | loss: 0.2151254
	speed: 0.1668s/iter; left time: 137751.7250s
	iters: 3600, epoch: 2 | loss: 0.1930989
	speed: 0.1666s/iter; left time: 137556.1742s
	iters: 3700, epoch: 2 | loss: 0.2224545
	speed: 0.1668s/iter; left time: 137729.5025s
	iters: 3800, epoch: 2 | loss: 0.2120991
	speed: 0.1665s/iter; left time: 137406.5782s
	iters: 3900, epoch: 2 | loss: 0.2026782
	speed: 0.1667s/iter; left time: 137581.1556s
	iters: 4000, epoch: 2 | loss: 0.1727647
	speed: 0.1664s/iter; left time: 137317.7462s
	iters: 4100, epoch: 2 | loss: 0.1781182
	speed: 0.1671s/iter; left time: 137867.9759s
Epoch: 2 cost time: 697.7555449008942
Epoch: 2, Steps: 4167 | Train Loss: 0.2337654 Vali Loss: 0.2659763 Test Loss: 0.2600062
Validation loss decreased (0.273459 --> 0.265976).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2006292
	speed: 6.5089s/iter; left time: 5369637.2976s
	iters: 200, epoch: 3 | loss: 0.2051167
	speed: 0.1649s/iter; left time: 135999.3248s
	iters: 300, epoch: 3 | loss: 0.1985372
	speed: 0.1646s/iter; left time: 135722.4312s
	iters: 400, epoch: 3 | loss: 0.2199124
	speed: 0.1640s/iter; left time: 135280.5870s
	iters: 500, epoch: 3 | loss: 0.1913096
	speed: 0.1647s/iter; left time: 135795.9171s
	iters: 600, epoch: 3 | loss: 0.2056918
	speed: 0.1645s/iter; left time: 135653.8472s
	iters: 700, epoch: 3 | loss: 0.2137894
	speed: 0.1641s/iter; left time: 135253.0727s
	iters: 800, epoch: 3 | loss: 0.1920393
	speed: 0.1639s/iter; left time: 135074.1747s
	iters: 900, epoch: 3 | loss: 0.1739074
	speed: 0.1640s/iter; left time: 135153.4834s
	iters: 1000, epoch: 3 | loss: 0.2025838
	speed: 0.1644s/iter; left time: 135437.9023s
	iters: 1100, epoch: 3 | loss: 0.2154097
	speed: 0.1642s/iter; left time: 135312.9328s
	iters: 1200, epoch: 3 | loss: 0.1897905
	speed: 0.1638s/iter; left time: 134932.9158s
	iters: 1300, epoch: 3 | loss: 0.2008298
	speed: 0.1645s/iter; left time: 135547.5086s
	iters: 1400, epoch: 3 | loss: 0.1789474
	speed: 0.1642s/iter; left time: 135265.9071s
	iters: 1500, epoch: 3 | loss: 0.1959410
	speed: 0.1649s/iter; left time: 135827.9347s
	iters: 1600, epoch: 3 | loss: 0.1897464
	speed: 0.1645s/iter; left time: 135419.7601s
	iters: 1700, epoch: 3 | loss: 0.1951824
	speed: 0.1642s/iter; left time: 135193.3599s
	iters: 1800, epoch: 3 | loss: 0.1985744
	speed: 0.1627s/iter; left time: 133942.5455s
	iters: 1900, epoch: 3 | loss: 0.1712077
	speed: 0.1628s/iter; left time: 134021.4552s
	iters: 2000, epoch: 3 | loss: 0.1944103
	speed: 0.1628s/iter; left time: 134009.2616s
	iters: 2100, epoch: 3 | loss: 0.2023529
	speed: 0.1633s/iter; left time: 134399.9168s
	iters: 2200, epoch: 3 | loss: 0.2145632
	speed: 0.1632s/iter; left time: 134277.0033s
	iters: 2300, epoch: 3 | loss: 0.2236132
	speed: 0.1628s/iter; left time: 133964.3300s
	iters: 2400, epoch: 3 | loss: 0.1963094
	speed: 0.1625s/iter; left time: 133710.8215s
	iters: 2500, epoch: 3 | loss: 0.1923922
	speed: 0.1628s/iter; left time: 133914.4702s
	iters: 2600, epoch: 3 | loss: 0.2130637
	speed: 0.1628s/iter; left time: 133912.8225s
	iters: 2700, epoch: 3 | loss: 0.1994797
	speed: 0.1630s/iter; left time: 134046.9833s
	iters: 2800, epoch: 3 | loss: 0.2135212
	speed: 0.1637s/iter; left time: 134568.3370s
	iters: 2900, epoch: 3 | loss: 0.1958399
	speed: 0.1632s/iter; left time: 134164.3363s
	iters: 3000, epoch: 3 | loss: 0.1777345
	speed: 0.1627s/iter; left time: 133782.1285s
	iters: 3100, epoch: 3 | loss: 0.1633506
	speed: 0.1630s/iter; left time: 133973.5558s
	iters: 3200, epoch: 3 | loss: 0.1972849
	speed: 0.1630s/iter; left time: 133927.6058s
	iters: 3300, epoch: 3 | loss: 0.1727220
	speed: 0.1625s/iter; left time: 133576.5125s
	iters: 3400, epoch: 3 | loss: 0.1638087
	speed: 0.1627s/iter; left time: 133656.9915s
	iters: 3500, epoch: 3 | loss: 0.1815767
	speed: 0.1624s/iter; left time: 133412.2346s
	iters: 3600, epoch: 3 | loss: 0.1901318
	speed: 0.1634s/iter; left time: 134255.8414s
	iters: 3700, epoch: 3 | loss: 0.1652128
	speed: 0.1632s/iter; left time: 134027.1017s
	iters: 3800, epoch: 3 | loss: 0.1978675
	speed: 0.1629s/iter; left time: 133758.5731s
	iters: 3900, epoch: 3 | loss: 0.2036146
	speed: 0.1633s/iter; left time: 134127.6371s
	iters: 4000, epoch: 3 | loss: 0.2133707
	speed: 0.1630s/iter; left time: 133803.2982s
	iters: 4100, epoch: 3 | loss: 0.1799604
	speed: 0.1627s/iter; left time: 133590.2562s
Epoch: 3 cost time: 681.7973494529724
Epoch: 3, Steps: 4167 | Train Loss: 0.1949501 Vali Loss: 0.2955787 Test Loss: 0.2730659
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.1593214
	speed: 5.2163s/iter; left time: 4281549.6613s
	iters: 200, epoch: 4 | loss: 0.1869025
	speed: 0.1642s/iter; left time: 134744.7858s
	iters: 300, epoch: 4 | loss: 0.1830757
	speed: 0.1643s/iter; left time: 134825.4160s
	iters: 400, epoch: 4 | loss: 0.2043605
	speed: 0.1647s/iter; left time: 135101.3299s
	iters: 500, epoch: 4 | loss: 0.2192542
	speed: 0.1641s/iter; left time: 134603.0364s
	iters: 600, epoch: 4 | loss: 0.1655138
	speed: 0.1648s/iter; left time: 135210.2488s
	iters: 700, epoch: 4 | loss: 0.1759149
	speed: 0.1644s/iter; left time: 134810.7910s
	iters: 800, epoch: 4 | loss: 0.1706028
	speed: 0.1639s/iter; left time: 134426.1909s
	iters: 900, epoch: 4 | loss: 0.1917437
	speed: 0.1638s/iter; left time: 134315.0019s
	iters: 1000, epoch: 4 | loss: 0.2035918
	speed: 0.1643s/iter; left time: 134746.1428s
	iters: 1100, epoch: 4 | loss: 0.1885787
	speed: 0.1646s/iter; left time: 134940.1729s
	iters: 1200, epoch: 4 | loss: 0.1952381
	speed: 0.1638s/iter; left time: 134276.8514s
	iters: 1300, epoch: 4 | loss: 0.1856373
	speed: 0.1637s/iter; left time: 134192.6285s
	iters: 1400, epoch: 4 | loss: 0.1674499
	speed: 0.1643s/iter; left time: 134641.7091s
	iters: 1500, epoch: 4 | loss: 0.1931478
	speed: 0.1644s/iter; left time: 134739.2740s
	iters: 1600, epoch: 4 | loss: 0.1687296
	speed: 0.1653s/iter; left time: 135445.1881s
	iters: 1700, epoch: 4 | loss: 0.1732147
	speed: 0.1642s/iter; left time: 134484.9199s
	iters: 1800, epoch: 4 | loss: 0.1858433
	speed: 0.1651s/iter; left time: 135228.6703s
	iters: 1900, epoch: 4 | loss: 0.1950633
	speed: 0.1650s/iter; left time: 135147.5985s
	iters: 2000, epoch: 4 | loss: 0.2054974
	speed: 0.1644s/iter; left time: 134665.2266s
	iters: 2100, epoch: 4 | loss: 0.1757556
	speed: 0.1647s/iter; left time: 134865.2114s
	iters: 2200, epoch: 4 | loss: 0.2045175
	speed: 0.1657s/iter; left time: 135641.0338s
	iters: 2300, epoch: 4 | loss: 0.1998142
	speed: 0.1653s/iter; left time: 135318.4851s
	iters: 2400, epoch: 4 | loss: 0.2151275
	speed: 0.1650s/iter; left time: 135016.6342s
	iters: 2500, epoch: 4 | loss: 0.1749254
	speed: 0.1653s/iter; left time: 135266.6730s
	iters: 2600, epoch: 4 | loss: 0.1743573
	speed: 0.1647s/iter; left time: 134803.5364s
	iters: 2700, epoch: 4 | loss: 0.1668072
	speed: 0.1645s/iter; left time: 134575.6298s
	iters: 2800, epoch: 4 | loss: 0.1706722
	speed: 0.1652s/iter; left time: 135172.4531s
	iters: 2900, epoch: 4 | loss: 0.1579573
	speed: 0.1648s/iter; left time: 134824.5571s
	iters: 3000, epoch: 4 | loss: 0.1652545
	speed: 0.1648s/iter; left time: 134827.8560s
	iters: 3100, epoch: 4 | loss: 0.1722859
	speed: 0.1657s/iter; left time: 135472.5032s
	iters: 3200, epoch: 4 | loss: 0.1678299
	speed: 0.1651s/iter; left time: 135005.9955s
	iters: 3300, epoch: 4 | loss: 0.1541582
	speed: 0.1647s/iter; left time: 134681.5174s
	iters: 3400, epoch: 4 | loss: 0.2161984
	speed: 0.1651s/iter; left time: 135009.3209s
	iters: 3500, epoch: 4 | loss: 0.1815621
	speed: 0.1653s/iter; left time: 135127.4217s
	iters: 3600, epoch: 4 | loss: 0.1686820
	speed: 0.1647s/iter; left time: 134610.1910s
	iters: 3700, epoch: 4 | loss: 0.1643958
	speed: 0.1648s/iter; left time: 134708.0310s
	iters: 3800, epoch: 4 | loss: 0.1767123
	speed: 0.1653s/iter; left time: 135042.5315s
	iters: 3900, epoch: 4 | loss: 0.1850672
	speed: 0.1649s/iter; left time: 134734.8724s
	iters: 4000, epoch: 4 | loss: 0.1665062
	speed: 0.1647s/iter; left time: 134517.2851s
	iters: 4100, epoch: 4 | loss: 0.1928855
	speed: 0.1645s/iter; left time: 134375.3705s
Epoch: 4 cost time: 687.2211389541626
Epoch: 4, Steps: 4167 | Train Loss: 0.1821167 Vali Loss: 0.3388065 Test Loss: 0.3103415
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.1677217
	speed: 6.5144s/iter; left time: 5319846.2300s
	iters: 200, epoch: 5 | loss: 0.1808662
	speed: 0.1658s/iter; left time: 135391.7125s
	iters: 300, epoch: 5 | loss: 0.1800756
	speed: 0.1661s/iter; left time: 135613.9858s
	iters: 400, epoch: 5 | loss: 0.1683638
	speed: 0.1651s/iter; left time: 134808.1548s
	iters: 500, epoch: 5 | loss: 0.1805118
	speed: 0.1655s/iter; left time: 135116.3941s
	iters: 600, epoch: 5 | loss: 0.1558544
	speed: 0.1651s/iter; left time: 134784.0798s
	iters: 700, epoch: 5 | loss: 0.1653372
	speed: 0.1651s/iter; left time: 134703.2675s
	iters: 800, epoch: 5 | loss: 0.1700732
	speed: 0.1643s/iter; left time: 134078.9032s
	iters: 900, epoch: 5 | loss: 0.1775812
	speed: 0.1674s/iter; left time: 136555.9611s
	iters: 1000, epoch: 5 | loss: 0.1511204
	speed: 0.1664s/iter; left time: 135731.0017s
	iters: 1100, epoch: 5 | loss: 0.1710742
	speed: 0.1682s/iter; left time: 137151.9019s
	iters: 1200, epoch: 5 | loss: 0.1521292
	speed: 0.1668s/iter; left time: 136055.0328s
	iters: 1300, epoch: 5 | loss: 0.1628878
	speed: 0.1663s/iter; left time: 135629.7997s
	iters: 1400, epoch: 5 | loss: 0.1890279
	speed: 0.1659s/iter; left time: 135229.2027s
	iters: 1500, epoch: 5 | loss: 0.1604819
	speed: 0.1662s/iter; left time: 135469.6825s
	iters: 1600, epoch: 5 | loss: 0.1724970
	speed: 0.1646s/iter; left time: 134150.5366s
	iters: 1700, epoch: 5 | loss: 0.1684842
	speed: 0.1651s/iter; left time: 134528.2980s
	iters: 1800, epoch: 5 | loss: 0.1767081
	speed: 0.1662s/iter; left time: 135469.3234s
	iters: 1900, epoch: 5 | loss: 0.1626399
	speed: 0.1659s/iter; left time: 135172.1120s
	iters: 2000, epoch: 5 | loss: 0.1930250
	speed: 0.1654s/iter; left time: 134748.6057s
	iters: 2100, epoch: 5 | loss: 0.1644900
	speed: 0.1644s/iter; left time: 133965.9651s
	iters: 2200, epoch: 5 | loss: 0.1696778
	speed: 0.1663s/iter; left time: 135440.3493s
	iters: 2300, epoch: 5 | loss: 0.1680754
	speed: 0.1666s/iter; left time: 135649.9810s
	iters: 2400, epoch: 5 | loss: 0.1547017
	speed: 0.1663s/iter; left time: 135429.0559s
	iters: 2500, epoch: 5 | loss: 0.1565544
	speed: 0.1670s/iter; left time: 135944.3425s
	iters: 2600, epoch: 5 | loss: 0.1685535
	speed: 0.1656s/iter; left time: 134799.0049s
	iters: 2700, epoch: 5 | loss: 0.1612887
	speed: 0.1652s/iter; left time: 134463.2626s
	iters: 2800, epoch: 5 | loss: 0.1759717
	speed: 0.1650s/iter; left time: 134329.8718s
	iters: 2900, epoch: 5 | loss: 0.1568808
	speed: 0.1654s/iter; left time: 134582.7459s
	iters: 3000, epoch: 5 | loss: 0.1742824
	speed: 0.1641s/iter; left time: 133547.2695s
	iters: 3100, epoch: 5 | loss: 0.1650405
	speed: 0.1655s/iter; left time: 134652.3368s
	iters: 3200, epoch: 5 | loss: 0.2971597
	speed: 0.1653s/iter; left time: 134509.5204s
	iters: 3300, epoch: 5 | loss: 0.3191164
	speed: 0.1658s/iter; left time: 134884.0265s
	iters: 3400, epoch: 5 | loss: 0.2490115
	speed: 0.1677s/iter; left time: 136365.1330s
	iters: 3500, epoch: 5 | loss: 0.2316897
	speed: 0.1667s/iter; left time: 135580.1577s
	iters: 3600, epoch: 5 | loss: 0.2334548
	speed: 0.1668s/iter; left time: 135615.8337s
	iters: 3700, epoch: 5 | loss: 0.2064410
	speed: 0.1658s/iter; left time: 134779.2457s
	iters: 3800, epoch: 5 | loss: 0.2168317
	speed: 0.1654s/iter; left time: 134473.8985s
	iters: 3900, epoch: 5 | loss: 0.2003874
	speed: 0.1644s/iter; left time: 133630.9569s
	iters: 4000, epoch: 5 | loss: 0.1942388
	speed: 0.1651s/iter; left time: 134178.3854s
	iters: 4100, epoch: 5 | loss: 0.1983330
	speed: 0.1649s/iter; left time: 134024.3099s
Epoch: 5 cost time: 691.3523695468903
Epoch: 5, Steps: 4167 | Train Loss: 0.1863856 Vali Loss: 0.2763736 Test Loss: 0.2565908
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.1933786
	speed: 5.2142s/iter; left time: 4236390.2598s
	iters: 200, epoch: 6 | loss: 0.2258164
	speed: 0.1628s/iter; left time: 132215.7224s
	iters: 300, epoch: 6 | loss: 0.1820835
	speed: 0.1629s/iter; left time: 132290.9200s
	iters: 400, epoch: 6 | loss: 0.1948115
	speed: 0.1625s/iter; left time: 131976.0707s
	iters: 500, epoch: 6 | loss: 0.1790526
	speed: 0.1626s/iter; left time: 132025.5094s
	iters: 600, epoch: 6 | loss: 0.1850072
	speed: 0.1626s/iter; left time: 132016.3871s
	iters: 700, epoch: 6 | loss: 0.1787744
	speed: 0.1625s/iter; left time: 131942.2990s
	iters: 800, epoch: 6 | loss: 0.1769484
	speed: 0.1623s/iter; left time: 131763.3730s
	iters: 900, epoch: 6 | loss: 0.1795208
	speed: 0.1622s/iter; left time: 131679.3777s
	iters: 1000, epoch: 6 | loss: 0.1870043
	speed: 0.1622s/iter; left time: 131649.5886s
	iters: 1100, epoch: 6 | loss: 0.1554333
	speed: 0.1624s/iter; left time: 131775.7617s
	iters: 1200, epoch: 6 | loss: 0.1743466
	speed: 0.1628s/iter; left time: 132125.0131s
	iters: 1300, epoch: 6 | loss: 0.1688933
	speed: 0.1625s/iter; left time: 131853.6821s
	iters: 1400, epoch: 6 | loss: 0.1775147
	speed: 0.1621s/iter; left time: 131527.6150s
	iters: 1500, epoch: 6 | loss: 0.1641228
	speed: 0.1622s/iter; left time: 131582.0550s
	iters: 1600, epoch: 6 | loss: 0.1908903
	speed: 0.1623s/iter; left time: 131596.3480s
	iters: 1700, epoch: 6 | loss: 0.1597840
	speed: 0.1624s/iter; left time: 131683.8226s
	iters: 1800, epoch: 6 | loss: 0.1842081
	speed: 0.1624s/iter; left time: 131643.1571s
	iters: 1900, epoch: 6 | loss: 0.1528475
	speed: 0.1623s/iter; left time: 131542.5641s
	iters: 2000, epoch: 6 | loss: 0.1456127
	speed: 0.1625s/iter; left time: 131686.4138s
	iters: 2100, epoch: 6 | loss: 0.1788719
	speed: 0.1624s/iter; left time: 131584.0082s
	iters: 2200, epoch: 6 | loss: 0.1474360
	speed: 0.1624s/iter; left time: 131606.0873s
	iters: 2300, epoch: 6 | loss: 0.1736110
	speed: 0.1629s/iter; left time: 131953.7506s
	iters: 2400, epoch: 6 | loss: 0.1802998
	speed: 0.1627s/iter; left time: 131789.2528s
	iters: 2500, epoch: 6 | loss: 0.1529772
	speed: 0.1628s/iter; left time: 131908.2614s
	iters: 2600, epoch: 6 | loss: 0.1609832
	speed: 0.1625s/iter; left time: 131584.3134s
	iters: 2700, epoch: 6 | loss: 0.1539624
	speed: 0.1623s/iter; left time: 131400.9778s
	iters: 2800, epoch: 6 | loss: 0.1812229
	speed: 0.1626s/iter; left time: 131649.5159s
	iters: 2900, epoch: 6 | loss: 0.1660138
	speed: 0.1624s/iter; left time: 131471.2093s
	iters: 3000, epoch: 6 | loss: 0.1716150
	speed: 0.1624s/iter; left time: 131457.9325s
	iters: 3100, epoch: 6 | loss: 0.1652225
	speed: 0.1623s/iter; left time: 131376.0058s
	iters: 3200, epoch: 6 | loss: 0.1592890
	speed: 0.1622s/iter; left time: 131288.9257s
	iters: 3300, epoch: 6 | loss: 0.1608910
	speed: 0.1624s/iter; left time: 131427.4553s
	iters: 3400, epoch: 6 | loss: 0.1805464
	speed: 0.1626s/iter; left time: 131573.2950s
	iters: 3500, epoch: 6 | loss: 0.1721843
	speed: 0.1625s/iter; left time: 131460.9471s
	iters: 3600, epoch: 6 | loss: 0.1776456
	speed: 0.1622s/iter; left time: 131210.5321s
	iters: 3700, epoch: 6 | loss: 0.2911010
	speed: 0.1629s/iter; left time: 131802.4185s
	iters: 3800, epoch: 6 | loss: 0.1932530
	speed: 0.1625s/iter; left time: 131459.6752s
	iters: 3900, epoch: 6 | loss: 0.1966665
	speed: 0.1626s/iter; left time: 131509.9815s
	iters: 4000, epoch: 6 | loss: 0.1935650
	speed: 0.1624s/iter; left time: 131309.1772s
	iters: 4100, epoch: 6 | loss: 0.1768347
	speed: 0.1627s/iter; left time: 131538.3009s
Epoch: 6 cost time: 677.5526831150055
Epoch: 6, Steps: 4167 | Train Loss: 0.1775517 Vali Loss: 0.2858546 Test Loss: 0.2722559
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.1683634
	speed: 5.2424s/iter; left time: 4237430.1022s
	iters: 200, epoch: 7 | loss: 0.1816410
	speed: 0.1628s/iter; left time: 131536.6271s
	iters: 300, epoch: 7 | loss: 0.1909229
	speed: 0.1626s/iter; left time: 131385.0464s
	iters: 400, epoch: 7 | loss: 0.2032562
	speed: 0.1622s/iter; left time: 131097.4517s
	iters: 500, epoch: 7 | loss: 0.1559420
	speed: 0.1629s/iter; left time: 131569.9895s
	iters: 600, epoch: 7 | loss: 0.1732030
	speed: 0.1627s/iter; left time: 131394.7637s
	iters: 700, epoch: 7 | loss: 0.1718781
	speed: 0.1624s/iter; left time: 131183.9189s
	iters: 800, epoch: 7 | loss: 0.1532357
	speed: 0.1637s/iter; left time: 132191.7402s
	iters: 900, epoch: 7 | loss: 0.1756506
	speed: 0.1622s/iter; left time: 130993.2800s
	iters: 1000, epoch: 7 | loss: 0.1673932
	speed: 0.1627s/iter; left time: 131361.5861s
	iters: 1100, epoch: 7 | loss: 0.1779068
	speed: 0.1629s/iter; left time: 131508.6103s
	iters: 1200, epoch: 7 | loss: 0.1450249
	speed: 0.1626s/iter; left time: 131283.8803s
	iters: 1300, epoch: 7 | loss: 0.1664536
	speed: 0.1621s/iter; left time: 130824.2826s
	iters: 1400, epoch: 7 | loss: 0.1722391
	speed: 0.1626s/iter; left time: 131205.8967s
	iters: 1500, epoch: 7 | loss: 0.1706220
	speed: 0.1626s/iter; left time: 131176.5025s
	iters: 1600, epoch: 7 | loss: 0.1725702
	speed: 0.1625s/iter; left time: 131090.0530s
	iters: 1700, epoch: 7 | loss: 0.1708601
	speed: 0.1627s/iter; left time: 131259.7688s
	iters: 1800, epoch: 7 | loss: 0.1773664
	speed: 0.1619s/iter; left time: 130600.6113s
	iters: 1900, epoch: 7 | loss: 0.1723037
	speed: 0.1627s/iter; left time: 131253.9673s
	iters: 2000, epoch: 7 | loss: 0.1680411
	speed: 0.1626s/iter; left time: 131111.6353s
	iters: 2100, epoch: 7 | loss: 0.1363629
	speed: 0.1626s/iter; left time: 131133.6353s
	iters: 2200, epoch: 7 | loss: 0.1823156
	speed: 0.1628s/iter; left time: 131256.3396s
	iters: 2300, epoch: 7 | loss: 0.1782116
	speed: 0.1627s/iter; left time: 131140.0128s
	iters: 2400, epoch: 7 | loss: 0.1658486
	speed: 0.1624s/iter; left time: 130899.6106s
	iters: 2500, epoch: 7 | loss: 0.1663727
	speed: 0.1627s/iter; left time: 131084.8282s
	iters: 2600, epoch: 7 | loss: 0.1674910
	speed: 0.1628s/iter; left time: 131198.5146s
	iters: 2700, epoch: 7 | loss: 0.1614029
	speed: 0.1629s/iter; left time: 131219.7698s
	iters: 2800, epoch: 7 | loss: 0.1552831
	speed: 0.1628s/iter; left time: 131113.2989s
	iters: 2900, epoch: 7 | loss: 0.1610456
	speed: 0.1633s/iter; left time: 131533.4884s
	iters: 3000, epoch: 7 | loss: 0.1404757
	speed: 0.1626s/iter; left time: 130973.0259s
	iters: 3100, epoch: 7 | loss: 0.1881431
	speed: 0.1628s/iter; left time: 131089.2870s
	iters: 3200, epoch: 7 | loss: 0.1682670
	speed: 0.1625s/iter; left time: 130834.0869s
	iters: 3300, epoch: 7 | loss: 0.1559412
	speed: 0.1623s/iter; left time: 130662.0973s
	iters: 3400, epoch: 7 | loss: 0.1593390
	speed: 0.2149s/iter; left time: 173007.3439s
	iters: 3500, epoch: 7 | loss: 0.1772768
	speed: 0.2267s/iter; left time: 182487.9155s
	iters: 3600, epoch: 7 | loss: 0.1665419
	speed: 0.2261s/iter; left time: 181943.7909s
	iters: 3700, epoch: 7 | loss: 0.1525353
	speed: 0.2267s/iter; left time: 182411.2124s
	iters: 3800, epoch: 7 | loss: 0.1521001
	speed: 0.2268s/iter; left time: 182474.3868s
	iters: 3900, epoch: 7 | loss: 0.1589260
	speed: 0.2270s/iter; left time: 182647.6795s
	iters: 4000, epoch: 7 | loss: 0.1453007
	speed: 0.2268s/iter; left time: 182426.8733s
	iters: 4100, epoch: 7 | loss: 0.1452187
	speed: 0.1624s/iter; left time: 130639.1439s
Epoch: 7 cost time: 724.2168791294098
Epoch: 7, Steps: 4167 | Train Loss: 0.1640153 Vali Loss: 0.2817583 Test Loss: 0.2713341
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 37892
test shape: (37892, 1, 336, 151) (37892, 1, 336, 151)
test shape: (37892, 336, 151) (37892, 336, 151)
mse:0.2600063979625702, mae:0.36155202984809875
>>>>>>>Overall time: 9401 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
