Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_h.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_h_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_h_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 86897
val 11813
test 24341
	iters: 100, epoch: 1 | loss: 0.2768866
	speed: 0.0400s/iter; left time: 2168.8756s
	iters: 200, epoch: 1 | loss: 0.2828165
	speed: 0.0309s/iter; left time: 1670.0708s
	iters: 300, epoch: 1 | loss: 0.1664114
	speed: 0.0308s/iter; left time: 1661.5030s
	iters: 400, epoch: 1 | loss: 0.2239397
	speed: 0.0305s/iter; left time: 1645.3608s
	iters: 500, epoch: 1 | loss: 0.2020981
	speed: 0.0309s/iter; left time: 1660.3458s
	iters: 600, epoch: 1 | loss: 0.2123686
	speed: 0.0312s/iter; left time: 1674.0476s
	iters: 700, epoch: 1 | loss: 0.1979298
	speed: 0.0355s/iter; left time: 1901.6531s
	iters: 800, epoch: 1 | loss: 0.1768811
	speed: 0.0377s/iter; left time: 2017.4654s
	iters: 900, epoch: 1 | loss: 0.1552143
	speed: 0.0377s/iter; left time: 2013.1824s
	iters: 1000, epoch: 1 | loss: 0.1490173
	speed: 0.0378s/iter; left time: 2016.9586s
	iters: 1100, epoch: 1 | loss: 0.1750806
	speed: 0.0372s/iter; left time: 1979.8728s
	iters: 1200, epoch: 1 | loss: 0.3339012
	speed: 0.0342s/iter; left time: 1817.1078s
	iters: 1300, epoch: 1 | loss: 0.1726103
	speed: 0.0312s/iter; left time: 1654.2486s
	iters: 1400, epoch: 1 | loss: 0.4807003
	speed: 0.0313s/iter; left time: 1656.0392s
	iters: 1500, epoch: 1 | loss: 0.3848205
	speed: 0.0308s/iter; left time: 1625.9265s
	iters: 1600, epoch: 1 | loss: 0.2740443
	speed: 0.0317s/iter; left time: 1669.6737s
	iters: 1700, epoch: 1 | loss: 0.3672253
	speed: 0.0310s/iter; left time: 1632.6001s
	iters: 1800, epoch: 1 | loss: 0.3319677
	speed: 0.0336s/iter; left time: 1765.0511s
	iters: 1900, epoch: 1 | loss: 0.3430068
	speed: 0.0371s/iter; left time: 1943.0682s
	iters: 2000, epoch: 1 | loss: 0.3398623
	speed: 0.0374s/iter; left time: 1958.4461s
	iters: 2100, epoch: 1 | loss: 0.3793974
	speed: 0.0357s/iter; left time: 1865.3316s
	iters: 2200, epoch: 1 | loss: 0.2983772
	speed: 0.0351s/iter; left time: 1827.6206s
	iters: 2300, epoch: 1 | loss: 0.3061196
	speed: 0.0370s/iter; left time: 1924.5210s
	iters: 2400, epoch: 1 | loss: 0.3354497
	speed: 0.0369s/iter; left time: 1913.7677s
	iters: 2500, epoch: 1 | loss: 0.4204716
	speed: 0.0322s/iter; left time: 1667.7575s
	iters: 2600, epoch: 1 | loss: 0.3093546
	speed: 0.0313s/iter; left time: 1621.1204s
	iters: 2700, epoch: 1 | loss: 0.3043457
	speed: 0.0321s/iter; left time: 1655.3321s
	iters: 2800, epoch: 1 | loss: 0.3340036
	speed: 0.0333s/iter; left time: 1715.0840s
	iters: 2900, epoch: 1 | loss: 0.3096372
	speed: 0.0320s/iter; left time: 1647.2321s
	iters: 3000, epoch: 1 | loss: 0.2764649
	speed: 0.0323s/iter; left time: 1655.3897s
	iters: 3100, epoch: 1 | loss: 0.3261187
	speed: 0.0326s/iter; left time: 1668.7613s
	iters: 3200, epoch: 1 | loss: 0.3634823
	speed: 0.0308s/iter; left time: 1573.0594s
	iters: 3300, epoch: 1 | loss: 0.2613069
	speed: 0.0311s/iter; left time: 1584.0809s
	iters: 3400, epoch: 1 | loss: 0.3261149
	speed: 0.0318s/iter; left time: 1617.8616s
	iters: 3500, epoch: 1 | loss: 0.3934496
	speed: 0.0315s/iter; left time: 1602.8010s
	iters: 3600, epoch: 1 | loss: 0.2416889
	speed: 0.0321s/iter; left time: 1627.3335s
	iters: 3700, epoch: 1 | loss: 0.2685888
	speed: 0.0318s/iter; left time: 1611.1713s
	iters: 3800, epoch: 1 | loss: 0.2690086
	speed: 0.0316s/iter; left time: 1594.5026s
	iters: 3900, epoch: 1 | loss: 0.4796450
	speed: 0.0316s/iter; left time: 1594.1050s
	iters: 4000, epoch: 1 | loss: 0.2872345
	speed: 0.0315s/iter; left time: 1586.6677s
	iters: 4100, epoch: 1 | loss: 0.2725563
	speed: 0.0311s/iter; left time: 1563.9341s
	iters: 4200, epoch: 1 | loss: 0.3246158
	speed: 0.0311s/iter; left time: 1556.4546s
	iters: 4300, epoch: 1 | loss: 0.3306929
	speed: 0.0312s/iter; left time: 1562.6285s
	iters: 4400, epoch: 1 | loss: 0.5070071
	speed: 0.0313s/iter; left time: 1560.0587s
	iters: 4500, epoch: 1 | loss: 0.3026513
	speed: 0.0311s/iter; left time: 1550.7648s
	iters: 4600, epoch: 1 | loss: 0.2691467
	speed: 0.0314s/iter; left time: 1558.9023s
	iters: 4700, epoch: 1 | loss: 0.2159224
	speed: 0.0312s/iter; left time: 1545.6099s
	iters: 4800, epoch: 1 | loss: 0.2928627
	speed: 0.0310s/iter; left time: 1537.0570s
	iters: 4900, epoch: 1 | loss: 0.2247897
	speed: 0.0312s/iter; left time: 1543.4417s
	iters: 5000, epoch: 1 | loss: 0.2394384
	speed: 0.0312s/iter; left time: 1540.4028s
	iters: 5100, epoch: 1 | loss: 0.3251918
	speed: 0.0317s/iter; left time: 1559.7260s
	iters: 5200, epoch: 1 | loss: 0.2711760
	speed: 0.0325s/iter; left time: 1595.8522s
	iters: 5300, epoch: 1 | loss: 0.2657830
	speed: 0.0324s/iter; left time: 1587.9791s
	iters: 5400, epoch: 1 | loss: 0.3272519
	speed: 0.0311s/iter; left time: 1522.8674s
Epoch: 1 cost time: 178.28890681266785
Epoch: 1, Steps: 5431 | Train Loss: 0.2967210 Vali Loss: 0.2096671 Test Loss: 0.2942718
Validation loss decreased (inf --> 0.209667).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2759044
	speed: 1.3736s/iter; left time: 67005.9337s
	iters: 200, epoch: 2 | loss: 0.3193051
	speed: 0.0327s/iter; left time: 1593.4339s
	iters: 300, epoch: 2 | loss: 0.2409306
	speed: 0.0317s/iter; left time: 1541.5506s
	iters: 400, epoch: 2 | loss: 0.2274823
	speed: 0.0316s/iter; left time: 1531.6579s
	iters: 500, epoch: 2 | loss: 0.2746817
	speed: 0.0325s/iter; left time: 1571.2597s
	iters: 600, epoch: 2 | loss: 0.3564136
	speed: 0.0329s/iter; left time: 1587.4538s
	iters: 700, epoch: 2 | loss: 0.3817388
	speed: 0.0337s/iter; left time: 1621.5992s
	iters: 800, epoch: 2 | loss: 0.2908161
	speed: 0.0329s/iter; left time: 1584.1558s
	iters: 900, epoch: 2 | loss: 0.2988068
	speed: 0.0316s/iter; left time: 1517.3806s
	iters: 1000, epoch: 2 | loss: 0.3063780
	speed: 0.0316s/iter; left time: 1515.0982s
	iters: 1100, epoch: 2 | loss: 0.3281276
	speed: 0.0317s/iter; left time: 1512.9313s
	iters: 1200, epoch: 2 | loss: 0.4290486
	speed: 0.0327s/iter; left time: 1560.0035s
	iters: 1300, epoch: 2 | loss: 0.2968804
	speed: 0.0331s/iter; left time: 1572.9320s
	iters: 1400, epoch: 2 | loss: 0.5307748
	speed: 0.0331s/iter; left time: 1570.1599s
	iters: 1500, epoch: 2 | loss: 0.2880923
	speed: 0.0337s/iter; left time: 1598.8571s
	iters: 1600, epoch: 2 | loss: 0.2896512
	speed: 0.0342s/iter; left time: 1614.8628s
	iters: 1700, epoch: 2 | loss: 0.3518013
	speed: 0.0312s/iter; left time: 1472.6576s
	iters: 1800, epoch: 2 | loss: 0.3264268
	speed: 0.0327s/iter; left time: 1539.0124s
	iters: 1900, epoch: 2 | loss: 0.3523347
	speed: 0.0334s/iter; left time: 1571.0720s
	iters: 2000, epoch: 2 | loss: 0.2655975
	speed: 0.0330s/iter; left time: 1546.2317s
	iters: 2100, epoch: 2 | loss: 0.6710352
	speed: 0.0374s/iter; left time: 1751.4981s
	iters: 2200, epoch: 2 | loss: 0.2470258
	speed: 0.0369s/iter; left time: 1720.2489s
	iters: 2300, epoch: 2 | loss: 0.4041430
	speed: 0.0338s/iter; left time: 1572.4907s
	iters: 2400, epoch: 2 | loss: 0.3502115
	speed: 0.0312s/iter; left time: 1448.7320s
	iters: 2500, epoch: 2 | loss: 0.3169618
	speed: 0.0338s/iter; left time: 1565.7608s
	iters: 2600, epoch: 2 | loss: 0.3206536
	speed: 0.0334s/iter; left time: 1547.0598s
	iters: 2700, epoch: 2 | loss: 0.2832342
	speed: 0.0326s/iter; left time: 1503.2939s
	iters: 2800, epoch: 2 | loss: 0.2845145
	speed: 0.0321s/iter; left time: 1481.0743s
	iters: 2900, epoch: 2 | loss: 0.3203820
	speed: 0.0337s/iter; left time: 1551.2897s
	iters: 3000, epoch: 2 | loss: 0.2799467
	speed: 0.0326s/iter; left time: 1496.8670s
	iters: 3100, epoch: 2 | loss: 0.3619711
	speed: 0.0317s/iter; left time: 1452.9028s
	iters: 3200, epoch: 2 | loss: 0.2330953
	speed: 0.0326s/iter; left time: 1490.8713s
	iters: 3300, epoch: 2 | loss: 0.3610335
	speed: 0.0330s/iter; left time: 1502.4854s
	iters: 3400, epoch: 2 | loss: 0.2423572
	speed: 0.0319s/iter; left time: 1451.0093s
	iters: 3500, epoch: 2 | loss: 0.3823328
	speed: 0.0317s/iter; left time: 1436.8018s
	iters: 3600, epoch: 2 | loss: 0.2494595
	speed: 0.0315s/iter; left time: 1428.5783s
	iters: 3700, epoch: 2 | loss: 0.3466676
	speed: 0.0319s/iter; left time: 1443.2385s
	iters: 3800, epoch: 2 | loss: 0.3385729
	speed: 0.0319s/iter; left time: 1439.4867s
	iters: 3900, epoch: 2 | loss: 0.3103446
	speed: 0.0320s/iter; left time: 1437.7303s
	iters: 4000, epoch: 2 | loss: 0.2734206
	speed: 0.0328s/iter; left time: 1471.3793s
	iters: 4100, epoch: 2 | loss: 0.4555643
	speed: 0.0325s/iter; left time: 1453.2179s
	iters: 4200, epoch: 2 | loss: 0.2480585
	speed: 0.0314s/iter; left time: 1403.2521s
	iters: 4300, epoch: 2 | loss: 0.2163810
	speed: 0.0317s/iter; left time: 1412.2832s
	iters: 4400, epoch: 2 | loss: 0.2534131
	speed: 0.0315s/iter; left time: 1400.4414s
	iters: 4500, epoch: 2 | loss: 0.3126561
	speed: 0.0321s/iter; left time: 1426.5748s
	iters: 4600, epoch: 2 | loss: 0.2403892
	speed: 0.0323s/iter; left time: 1428.6369s
	iters: 4700, epoch: 2 | loss: 0.2334137
	speed: 0.0315s/iter; left time: 1391.1668s
	iters: 4800, epoch: 2 | loss: 0.2859511
	speed: 0.0313s/iter; left time: 1380.3537s
	iters: 4900, epoch: 2 | loss: 0.2968455
	speed: 0.0314s/iter; left time: 1379.1804s
	iters: 5000, epoch: 2 | loss: 0.3533239
	speed: 0.0314s/iter; left time: 1375.6894s
	iters: 5100, epoch: 2 | loss: 0.2614744
	speed: 0.0311s/iter; left time: 1363.4348s
	iters: 5200, epoch: 2 | loss: 0.2391081
	speed: 0.0317s/iter; left time: 1383.3595s
	iters: 5300, epoch: 2 | loss: 0.3848231
	speed: 0.0312s/iter; left time: 1359.6360s
	iters: 5400, epoch: 2 | loss: 0.3157786
	speed: 0.0317s/iter; left time: 1380.4749s
Epoch: 2 cost time: 177.00463032722473
Epoch: 2, Steps: 5431 | Train Loss: 0.3098874 Vali Loss: 0.2064754 Test Loss: 0.2846242
Validation loss decreased (0.209667 --> 0.206475).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2444114
	speed: 1.3485s/iter; left time: 58455.9896s
	iters: 200, epoch: 3 | loss: 0.2643678
	speed: 0.0306s/iter; left time: 1323.4973s
	iters: 300, epoch: 3 | loss: 0.2739804
	speed: 0.0306s/iter; left time: 1319.5997s
	iters: 400, epoch: 3 | loss: 0.2389639
	speed: 0.0305s/iter; left time: 1313.1476s
	iters: 500, epoch: 3 | loss: 0.2461204
	speed: 0.0305s/iter; left time: 1309.8384s
	iters: 600, epoch: 3 | loss: 0.2340454
	speed: 0.0306s/iter; left time: 1310.6736s
	iters: 700, epoch: 3 | loss: 0.2883205
	speed: 0.0306s/iter; left time: 1309.0986s
	iters: 800, epoch: 3 | loss: 0.3071397
	speed: 0.0307s/iter; left time: 1308.5513s
	iters: 900, epoch: 3 | loss: 0.2745268
	speed: 0.0304s/iter; left time: 1295.5735s
	iters: 1000, epoch: 3 | loss: 0.2567328
	speed: 0.0305s/iter; left time: 1296.5794s
	iters: 1100, epoch: 3 | loss: 0.2306416
	speed: 0.0307s/iter; left time: 1299.6278s
	iters: 1200, epoch: 3 | loss: 0.3281399
	speed: 0.0308s/iter; left time: 1302.0942s
	iters: 1300, epoch: 3 | loss: 0.2787896
	speed: 0.0304s/iter; left time: 1282.4074s
	iters: 1400, epoch: 3 | loss: 0.2739125
	speed: 0.0305s/iter; left time: 1283.3856s
	iters: 1500, epoch: 3 | loss: 0.3621764
	speed: 0.0304s/iter; left time: 1275.9056s
	iters: 1600, epoch: 3 | loss: 0.2496455
	speed: 0.0308s/iter; left time: 1287.2082s
	iters: 1700, epoch: 3 | loss: 0.2350177
	speed: 0.0306s/iter; left time: 1277.5731s
	iters: 1800, epoch: 3 | loss: 0.2756854
	speed: 0.0304s/iter; left time: 1266.6414s
	iters: 1900, epoch: 3 | loss: 0.3545045
	speed: 0.0308s/iter; left time: 1281.2074s
	iters: 2000, epoch: 3 | loss: 0.3907897
	speed: 0.0308s/iter; left time: 1278.1744s
	iters: 2100, epoch: 3 | loss: 0.2532861
	speed: 0.0306s/iter; left time: 1266.0283s
	iters: 2200, epoch: 3 | loss: 0.2957785
	speed: 0.0306s/iter; left time: 1263.2727s
	iters: 2300, epoch: 3 | loss: 0.2669002
	speed: 0.0307s/iter; left time: 1261.3517s
	iters: 2400, epoch: 3 | loss: 0.2881601
	speed: 0.0307s/iter; left time: 1258.9236s
	iters: 2500, epoch: 3 | loss: 0.2554076
	speed: 0.0305s/iter; left time: 1247.6624s
	iters: 2600, epoch: 3 | loss: 0.2854323
	speed: 0.0304s/iter; left time: 1243.1492s
	iters: 2700, epoch: 3 | loss: 0.2808245
	speed: 0.0306s/iter; left time: 1248.3320s
	iters: 2800, epoch: 3 | loss: 0.3135274
	speed: 0.0304s/iter; left time: 1237.6635s
	iters: 2900, epoch: 3 | loss: 0.3347752
	speed: 0.0306s/iter; left time: 1242.5332s
	iters: 3000, epoch: 3 | loss: 0.2945076
	speed: 0.0307s/iter; left time: 1240.7222s
	iters: 3100, epoch: 3 | loss: 0.2881932
	speed: 0.0313s/iter; left time: 1261.6421s
	iters: 3200, epoch: 3 | loss: 0.2854531
	speed: 0.0311s/iter; left time: 1253.3898s
	iters: 3300, epoch: 3 | loss: 0.2454619
	speed: 0.0305s/iter; left time: 1224.6662s
	iters: 3400, epoch: 3 | loss: 0.2523333
	speed: 0.0306s/iter; left time: 1226.3431s
	iters: 3500, epoch: 3 | loss: 0.2816963
	speed: 0.0311s/iter; left time: 1242.9214s
	iters: 3600, epoch: 3 | loss: 0.3499267
	speed: 0.0305s/iter; left time: 1215.8380s
	iters: 3700, epoch: 3 | loss: 0.2866910
	speed: 0.0307s/iter; left time: 1220.6715s
	iters: 3800, epoch: 3 | loss: 0.3556769
	speed: 0.0306s/iter; left time: 1213.1832s
	iters: 3900, epoch: 3 | loss: 0.3063600
	speed: 0.0308s/iter; left time: 1219.3159s
	iters: 4000, epoch: 3 | loss: 0.3187109
	speed: 0.0313s/iter; left time: 1235.0993s
	iters: 4100, epoch: 3 | loss: 0.3486322
	speed: 0.0307s/iter; left time: 1207.3925s
	iters: 4200, epoch: 3 | loss: 0.2955656
	speed: 0.0306s/iter; left time: 1202.3751s
	iters: 4300, epoch: 3 | loss: 0.2650751
	speed: 0.0306s/iter; left time: 1199.1129s
	iters: 4400, epoch: 3 | loss: 0.2535147
	speed: 0.0311s/iter; left time: 1214.4934s
	iters: 4500, epoch: 3 | loss: 0.3603227
	speed: 0.0307s/iter; left time: 1194.7664s
	iters: 4600, epoch: 3 | loss: 0.3107807
	speed: 0.0308s/iter; left time: 1197.2376s
	iters: 4700, epoch: 3 | loss: 0.2958607
	speed: 0.0306s/iter; left time: 1186.6659s
	iters: 4800, epoch: 3 | loss: 0.2409801
	speed: 0.0306s/iter; left time: 1182.3697s
	iters: 4900, epoch: 3 | loss: 0.2942403
	speed: 0.0310s/iter; left time: 1194.5107s
	iters: 5000, epoch: 3 | loss: 0.3043824
	speed: 0.0307s/iter; left time: 1180.9941s
	iters: 5100, epoch: 3 | loss: 0.4894846
	speed: 0.0307s/iter; left time: 1176.1222s
	iters: 5200, epoch: 3 | loss: 0.2675837
	speed: 0.0308s/iter; left time: 1177.7653s
	iters: 5300, epoch: 3 | loss: 0.2437601
	speed: 0.0308s/iter; left time: 1175.2599s
	iters: 5400, epoch: 3 | loss: 0.2896635
	speed: 0.0306s/iter; left time: 1162.4979s
Epoch: 3 cost time: 167.29934358596802
Epoch: 3, Steps: 5431 | Train Loss: 0.2977288 Vali Loss: 0.2045031 Test Loss: 0.2794585
Validation loss decreased (0.206475 --> 0.204503).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2874329
	speed: 1.3402s/iter; left time: 50817.5074s
	iters: 200, epoch: 4 | loss: 0.3109940
	speed: 0.0332s/iter; left time: 1257.3091s
	iters: 300, epoch: 4 | loss: 0.2861647
	speed: 0.0331s/iter; left time: 1248.3775s
	iters: 400, epoch: 4 | loss: 0.3966699
	speed: 0.0344s/iter; left time: 1294.0864s
	iters: 500, epoch: 4 | loss: 0.4091273
	speed: 0.0340s/iter; left time: 1274.6286s
	iters: 600, epoch: 4 | loss: 0.3315533
	speed: 0.0325s/iter; left time: 1214.6807s
	iters: 700, epoch: 4 | loss: 0.3241260
	speed: 0.0310s/iter; left time: 1156.1359s
	iters: 800, epoch: 4 | loss: 0.3017342
	speed: 0.0308s/iter; left time: 1147.9944s
	iters: 900, epoch: 4 | loss: 0.2734006
	speed: 0.0307s/iter; left time: 1138.2606s
	iters: 1000, epoch: 4 | loss: 0.3408617
	speed: 0.0309s/iter; left time: 1144.5042s
	iters: 1100, epoch: 4 | loss: 0.2667444
	speed: 0.0311s/iter; left time: 1149.4826s
	iters: 1200, epoch: 4 | loss: 0.2682324
	speed: 0.0309s/iter; left time: 1138.1038s
	iters: 1300, epoch: 4 | loss: 0.3503356
	speed: 0.0310s/iter; left time: 1138.8789s
	iters: 1400, epoch: 4 | loss: 0.2571106
	speed: 0.0308s/iter; left time: 1129.2879s
	iters: 1500, epoch: 4 | loss: 0.2638621
	speed: 0.0309s/iter; left time: 1128.5253s
	iters: 1600, epoch: 4 | loss: 0.3360220
	speed: 0.0310s/iter; left time: 1128.9837s
	iters: 1700, epoch: 4 | loss: 0.2939570
	speed: 0.0307s/iter; left time: 1114.0889s
	iters: 1800, epoch: 4 | loss: 0.2426628
	speed: 0.0308s/iter; left time: 1117.2803s
	iters: 1900, epoch: 4 | loss: 0.2848715
	speed: 0.0310s/iter; left time: 1119.5378s
	iters: 2000, epoch: 4 | loss: 0.2561154
	speed: 0.0307s/iter; left time: 1104.4735s
	iters: 2100, epoch: 4 | loss: 0.4076748
	speed: 0.0313s/iter; left time: 1124.9619s
	iters: 2200, epoch: 4 | loss: 0.3564049
	speed: 0.0314s/iter; left time: 1124.2845s
	iters: 2300, epoch: 4 | loss: 0.2383152
	speed: 0.0314s/iter; left time: 1119.9034s
	iters: 2400, epoch: 4 | loss: 0.3586079
	speed: 0.0309s/iter; left time: 1101.0338s
	iters: 2500, epoch: 4 | loss: 0.3249875
	speed: 0.0308s/iter; left time: 1093.9297s
	iters: 2600, epoch: 4 | loss: 0.2601724
	speed: 0.0307s/iter; left time: 1087.6899s
	iters: 2700, epoch: 4 | loss: 0.2646311
	speed: 0.0309s/iter; left time: 1091.3834s
	iters: 2800, epoch: 4 | loss: 0.3380776
	speed: 0.0310s/iter; left time: 1091.7378s
	iters: 2900, epoch: 4 | loss: 0.3542107
	speed: 0.0310s/iter; left time: 1088.9125s
	iters: 3000, epoch: 4 | loss: 0.3822514
	speed: 0.0309s/iter; left time: 1083.0201s
	iters: 3100, epoch: 4 | loss: 0.2664507
	speed: 0.0309s/iter; left time: 1079.8781s
	iters: 3200, epoch: 4 | loss: 0.2516576
	speed: 0.0309s/iter; left time: 1076.4785s
	iters: 3300, epoch: 4 | loss: 0.3587649
	speed: 0.0310s/iter; left time: 1075.9100s
	iters: 3400, epoch: 4 | loss: 0.3582199
	speed: 0.0306s/iter; left time: 1060.1050s
	iters: 3500, epoch: 4 | loss: 0.2820033
	speed: 0.0308s/iter; left time: 1064.0070s
	iters: 3600, epoch: 4 | loss: 0.2423953
	speed: 0.0306s/iter; left time: 1052.6622s
	iters: 3700, epoch: 4 | loss: 0.2701667
	speed: 0.0306s/iter; left time: 1050.3893s
	iters: 3800, epoch: 4 | loss: 0.2295220
	speed: 0.0308s/iter; left time: 1052.2853s
	iters: 3900, epoch: 4 | loss: 0.3962044
	speed: 0.0305s/iter; left time: 1042.1933s
	iters: 4000, epoch: 4 | loss: 0.2641902
	speed: 0.0308s/iter; left time: 1048.9868s
	iters: 4100, epoch: 4 | loss: 0.2748258
	speed: 0.0307s/iter; left time: 1042.2248s
	iters: 4200, epoch: 4 | loss: 0.2673391
	speed: 0.0307s/iter; left time: 1038.2564s
	iters: 4300, epoch: 4 | loss: 0.3050489
	speed: 0.0306s/iter; left time: 1032.8360s
	iters: 4400, epoch: 4 | loss: 0.3123649
	speed: 0.0306s/iter; left time: 1029.2236s
	iters: 4500, epoch: 4 | loss: 0.2748687
	speed: 0.0309s/iter; left time: 1034.0727s
	iters: 4600, epoch: 4 | loss: 0.3266598
	speed: 0.0307s/iter; left time: 1024.4437s
	iters: 4700, epoch: 4 | loss: 0.2703541
	speed: 0.0306s/iter; left time: 1020.0609s
	iters: 4800, epoch: 4 | loss: 0.2643927
	speed: 0.0307s/iter; left time: 1019.8949s
	iters: 4900, epoch: 4 | loss: 0.2244480
	speed: 0.0306s/iter; left time: 1015.0261s
	iters: 5000, epoch: 4 | loss: 0.2465232
	speed: 0.0307s/iter; left time: 1014.1969s
	iters: 5100, epoch: 4 | loss: 0.2709464
	speed: 0.0306s/iter; left time: 1007.8828s
	iters: 5200, epoch: 4 | loss: 0.2130685
	speed: 0.0306s/iter; left time: 1003.8608s
	iters: 5300, epoch: 4 | loss: 0.3638662
	speed: 0.0305s/iter; left time: 999.1015s
	iters: 5400, epoch: 4 | loss: 0.2394222
	speed: 0.0306s/iter; left time: 998.6488s
Epoch: 4 cost time: 169.6302924156189
Epoch: 4, Steps: 5431 | Train Loss: 0.2940723 Vali Loss: 0.2007913 Test Loss: 0.2748196
Validation loss decreased (0.204503 --> 0.200791).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.3052922
	speed: 1.3333s/iter; left time: 43316.0685s
	iters: 200, epoch: 5 | loss: 0.3221104
	speed: 0.0314s/iter; left time: 1015.4503s
	iters: 300, epoch: 5 | loss: 0.2142445
	speed: 0.0310s/iter; left time: 1000.3143s
	iters: 400, epoch: 5 | loss: 0.3166740
	speed: 0.0307s/iter; left time: 988.5041s
	iters: 500, epoch: 5 | loss: 0.3222929
	speed: 0.0308s/iter; left time: 987.2132s
	iters: 600, epoch: 5 | loss: 0.4685664
	speed: 0.0309s/iter; left time: 988.6245s
	iters: 700, epoch: 5 | loss: 0.2162032
	speed: 0.0308s/iter; left time: 983.6119s
	iters: 800, epoch: 5 | loss: 0.2910531
	speed: 0.0307s/iter; left time: 974.5666s
	iters: 900, epoch: 5 | loss: 0.2806138
	speed: 0.0308s/iter; left time: 976.2508s
	iters: 1000, epoch: 5 | loss: 0.2447739
	speed: 0.0307s/iter; left time: 968.2242s
	iters: 1100, epoch: 5 | loss: 0.3294180
	speed: 0.0309s/iter; left time: 973.7969s
	iters: 1200, epoch: 5 | loss: 0.2849152
	speed: 0.0311s/iter; left time: 976.1420s
	iters: 1300, epoch: 5 | loss: 0.2446183
	speed: 0.0317s/iter; left time: 992.1072s
	iters: 1400, epoch: 5 | loss: 0.2644077
	speed: 0.0313s/iter; left time: 976.5620s
	iters: 1500, epoch: 5 | loss: 0.2964190
	speed: 0.0312s/iter; left time: 969.7717s
	iters: 1600, epoch: 5 | loss: 0.3188064
	speed: 0.0313s/iter; left time: 969.4485s
	iters: 1700, epoch: 5 | loss: 0.2536197
	speed: 0.0312s/iter; left time: 962.7624s
	iters: 1800, epoch: 5 | loss: 0.4365698
	speed: 0.0312s/iter; left time: 960.6704s
	iters: 1900, epoch: 5 | loss: 0.3253812
	speed: 0.0311s/iter; left time: 955.0710s
	iters: 2000, epoch: 5 | loss: 0.2483164
	speed: 0.0311s/iter; left time: 952.6434s
	iters: 2100, epoch: 5 | loss: 0.2267721
	speed: 0.0311s/iter; left time: 948.9842s
	iters: 2200, epoch: 5 | loss: 0.2639183
	speed: 0.0311s/iter; left time: 944.8438s
	iters: 2300, epoch: 5 | loss: 0.2946860
	speed: 0.0310s/iter; left time: 937.8069s
	iters: 2400, epoch: 5 | loss: 0.3339899
	speed: 0.0311s/iter; left time: 939.4493s
	iters: 2500, epoch: 5 | loss: 0.3311256
	speed: 0.0311s/iter; left time: 936.1744s
	iters: 2600, epoch: 5 | loss: 0.2588194
	speed: 0.0311s/iter; left time: 933.1344s
	iters: 2700, epoch: 5 | loss: 0.3958966
	speed: 0.0312s/iter; left time: 931.9313s
	iters: 2800, epoch: 5 | loss: 0.2801852
	speed: 0.0312s/iter; left time: 928.2229s
	iters: 2900, epoch: 5 | loss: 0.2708932
	speed: 0.0311s/iter; left time: 923.2626s
	iters: 3000, epoch: 5 | loss: 0.3961313
	speed: 0.0313s/iter; left time: 924.7276s
	iters: 3100, epoch: 5 | loss: 0.2550079
	speed: 0.0315s/iter; left time: 928.8331s
	iters: 3200, epoch: 5 | loss: 0.2566703
	speed: 0.0314s/iter; left time: 923.2649s
	iters: 3300, epoch: 5 | loss: 0.3396383
	speed: 0.0318s/iter; left time: 930.0593s
	iters: 3400, epoch: 5 | loss: 0.2615761
	speed: 0.0312s/iter; left time: 910.1239s
	iters: 3500, epoch: 5 | loss: 0.2987272
	speed: 0.0308s/iter; left time: 894.8011s
	iters: 3600, epoch: 5 | loss: 0.2942794
	speed: 0.0311s/iter; left time: 900.2263s
	iters: 3700, epoch: 5 | loss: 0.2868885
	speed: 0.0306s/iter; left time: 885.2636s
	iters: 3800, epoch: 5 | loss: 0.3019051
	speed: 0.0308s/iter; left time: 887.3145s
	iters: 3900, epoch: 5 | loss: 0.2442976
	speed: 0.0312s/iter; left time: 895.9825s
	iters: 4000, epoch: 5 | loss: 0.3028398
	speed: 0.0312s/iter; left time: 891.2550s
	iters: 4100, epoch: 5 | loss: 0.2708773
	speed: 0.0309s/iter; left time: 880.5383s
	iters: 4200, epoch: 5 | loss: 0.2442304
	speed: 0.0312s/iter; left time: 886.4691s
	iters: 4300, epoch: 5 | loss: 0.3594006
	speed: 0.0312s/iter; left time: 881.6642s
	iters: 4400, epoch: 5 | loss: 0.2372146
	speed: 0.0310s/iter; left time: 874.4611s
	iters: 4500, epoch: 5 | loss: 0.2755869
	speed: 0.0312s/iter; left time: 875.6702s
	iters: 4600, epoch: 5 | loss: 0.2716796
	speed: 0.0312s/iter; left time: 872.4251s
	iters: 4700, epoch: 5 | loss: 0.4883737
	speed: 0.0306s/iter; left time: 854.1139s
	iters: 4800, epoch: 5 | loss: 0.2359610
	speed: 0.0309s/iter; left time: 858.1062s
	iters: 4900, epoch: 5 | loss: 0.2685072
	speed: 0.0306s/iter; left time: 846.5483s
	iters: 5000, epoch: 5 | loss: 0.3026401
	speed: 0.0311s/iter; left time: 856.8731s
	iters: 5100, epoch: 5 | loss: 0.3339611
	speed: 0.0309s/iter; left time: 848.5489s
	iters: 5200, epoch: 5 | loss: 0.4251685
	speed: 0.0309s/iter; left time: 846.2173s
	iters: 5300, epoch: 5 | loss: 0.2599538
	speed: 0.0308s/iter; left time: 839.6120s
	iters: 5400, epoch: 5 | loss: 0.2596764
	speed: 0.0309s/iter; left time: 839.1791s
Epoch: 5 cost time: 169.5365788936615
Epoch: 5, Steps: 5431 | Train Loss: 0.2910624 Vali Loss: 0.1988384 Test Loss: 0.2731173
Validation loss decreased (0.200791 --> 0.198838).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.3095336
	speed: 1.3394s/iter; left time: 36238.2021s
	iters: 200, epoch: 6 | loss: 0.2715198
	speed: 0.0306s/iter; left time: 825.4512s
	iters: 300, epoch: 6 | loss: 0.3623051
	speed: 0.0308s/iter; left time: 827.5469s
	iters: 400, epoch: 6 | loss: 0.2111826
	speed: 0.0307s/iter; left time: 821.2244s
	iters: 500, epoch: 6 | loss: 0.3206653
	speed: 0.0306s/iter; left time: 815.0407s
	iters: 600, epoch: 6 | loss: 0.3787877
	speed: 0.0307s/iter; left time: 815.0546s
	iters: 700, epoch: 6 | loss: 0.2361737
	speed: 0.0305s/iter; left time: 807.3330s
	iters: 800, epoch: 6 | loss: 0.2341128
	speed: 0.0306s/iter; left time: 806.3416s
	iters: 900, epoch: 6 | loss: 0.3405291
	speed: 0.0306s/iter; left time: 802.3399s
	iters: 1000, epoch: 6 | loss: 0.2790971
	speed: 0.0306s/iter; left time: 801.4867s
	iters: 1100, epoch: 6 | loss: 0.2726846
	speed: 0.0306s/iter; left time: 796.1423s
	iters: 1200, epoch: 6 | loss: 0.2581560
	speed: 0.0305s/iter; left time: 792.6315s
	iters: 1300, epoch: 6 | loss: 0.2887240
	speed: 0.0305s/iter; left time: 788.9275s
	iters: 1400, epoch: 6 | loss: 0.2463956
	speed: 0.0308s/iter; left time: 792.6657s
	iters: 1500, epoch: 6 | loss: 0.2089986
	speed: 0.0305s/iter; left time: 783.1945s
	iters: 1600, epoch: 6 | loss: 0.2555180
	speed: 0.0306s/iter; left time: 780.8047s
	iters: 1700, epoch: 6 | loss: 0.2512482
	speed: 0.0307s/iter; left time: 781.6901s
	iters: 1800, epoch: 6 | loss: 0.3181271
	speed: 0.0308s/iter; left time: 781.6478s
	iters: 1900, epoch: 6 | loss: 0.2876525
	speed: 0.0307s/iter; left time: 774.1693s
	iters: 2000, epoch: 6 | loss: 0.3683757
	speed: 0.0306s/iter; left time: 770.5956s
	iters: 2100, epoch: 6 | loss: 0.2701909
	speed: 0.0305s/iter; left time: 764.1041s
	iters: 2200, epoch: 6 | loss: 0.3353806
	speed: 0.0308s/iter; left time: 767.8957s
	iters: 2300, epoch: 6 | loss: 0.2917762
	speed: 0.0306s/iter; left time: 760.9819s
	iters: 2400, epoch: 6 | loss: 0.2904633
	speed: 0.0307s/iter; left time: 761.1951s
	iters: 2500, epoch: 6 | loss: 0.3161301
	speed: 0.0307s/iter; left time: 755.7352s
	iters: 2600, epoch: 6 | loss: 0.2678570
	speed: 0.0306s/iter; left time: 752.5599s
	iters: 2700, epoch: 6 | loss: 0.2653050
	speed: 0.0306s/iter; left time: 747.4986s
	iters: 2800, epoch: 6 | loss: 0.2825845
	speed: 0.0307s/iter; left time: 748.2922s
	iters: 2900, epoch: 6 | loss: 0.2693241
	speed: 0.0309s/iter; left time: 750.2091s
	iters: 3000, epoch: 6 | loss: 0.2684526
	speed: 0.0305s/iter; left time: 737.0936s
	iters: 3100, epoch: 6 | loss: 0.2762710
	speed: 0.0307s/iter; left time: 737.4459s
	iters: 3200, epoch: 6 | loss: 0.3011410
	speed: 0.0306s/iter; left time: 733.6046s
	iters: 3300, epoch: 6 | loss: 0.3317062
	speed: 0.0307s/iter; left time: 733.0437s
	iters: 3400, epoch: 6 | loss: 0.2552202
	speed: 0.0309s/iter; left time: 734.7928s
	iters: 3500, epoch: 6 | loss: 0.2643778
	speed: 0.0307s/iter; left time: 726.6695s
	iters: 3600, epoch: 6 | loss: 0.2711334
	speed: 0.0309s/iter; left time: 727.7606s
	iters: 3700, epoch: 6 | loss: 0.2406177
	speed: 0.0315s/iter; left time: 739.7438s
	iters: 3800, epoch: 6 | loss: 0.2632701
	speed: 0.0312s/iter; left time: 727.9754s
	iters: 3900, epoch: 6 | loss: 0.2811969
	speed: 0.0305s/iter; left time: 709.8072s
	iters: 4000, epoch: 6 | loss: 0.2932312
	speed: 0.0307s/iter; left time: 710.2199s
	iters: 4100, epoch: 6 | loss: 0.3238955
	speed: 0.0306s/iter; left time: 704.4734s
	iters: 4200, epoch: 6 | loss: 0.3096060
	speed: 0.0306s/iter; left time: 702.5119s
	iters: 4300, epoch: 6 | loss: 0.2136013
	speed: 0.0305s/iter; left time: 696.4415s
	iters: 4400, epoch: 6 | loss: 0.2755066
	speed: 0.0308s/iter; left time: 700.4005s
	iters: 4500, epoch: 6 | loss: 0.2207880
	speed: 0.0303s/iter; left time: 686.1581s
	iters: 4600, epoch: 6 | loss: 0.2968299
	speed: 0.0308s/iter; left time: 695.1470s
	iters: 4700, epoch: 6 | loss: 0.2579896
	speed: 0.0307s/iter; left time: 689.9495s
	iters: 4800, epoch: 6 | loss: 0.2687105
	speed: 0.0311s/iter; left time: 694.6629s
	iters: 4900, epoch: 6 | loss: 0.3091168
	speed: 0.0304s/iter; left time: 676.5113s
	iters: 5000, epoch: 6 | loss: 0.2334233
	speed: 0.0305s/iter; left time: 675.2191s
	iters: 5100, epoch: 6 | loss: 0.2834292
	speed: 0.0306s/iter; left time: 675.1361s
	iters: 5200, epoch: 6 | loss: 0.2436199
	speed: 0.0305s/iter; left time: 669.4425s
	iters: 5300, epoch: 6 | loss: 0.2672604
	speed: 0.0306s/iter; left time: 668.2633s
	iters: 5400, epoch: 6 | loss: 0.2595240
	speed: 0.0303s/iter; left time: 658.3372s
Epoch: 6 cost time: 167.21935558319092
Epoch: 6, Steps: 5431 | Train Loss: 0.2905627 Vali Loss: 0.1980786 Test Loss: 0.2723461
Validation loss decreased (0.198838 --> 0.198079).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2373699
	speed: 1.4310s/iter; left time: 30945.6281s
	iters: 200, epoch: 7 | loss: 0.3467268
	speed: 0.0369s/iter; left time: 794.5834s
	iters: 300, epoch: 7 | loss: 0.2365546
	speed: 0.0367s/iter; left time: 786.2976s
	iters: 400, epoch: 7 | loss: 0.2711187
	speed: 0.0356s/iter; left time: 758.5438s
	iters: 500, epoch: 7 | loss: 0.3120609
	speed: 0.0341s/iter; left time: 723.7661s
	iters: 600, epoch: 7 | loss: 0.3234822
	speed: 0.0350s/iter; left time: 740.2499s
	iters: 700, epoch: 7 | loss: 0.3424271
	speed: 0.0370s/iter; left time: 777.7652s
	iters: 800, epoch: 7 | loss: 0.2999001
	speed: 0.0352s/iter; left time: 735.5216s
	iters: 900, epoch: 7 | loss: 0.2612068
	speed: 0.0314s/iter; left time: 653.7353s
	iters: 1000, epoch: 7 | loss: 0.2835789
	speed: 0.0350s/iter; left time: 724.9317s
	iters: 1100, epoch: 7 | loss: 0.2730981
	speed: 0.0325s/iter; left time: 669.8970s
	iters: 1200, epoch: 7 | loss: 0.3224825
	speed: 0.0326s/iter; left time: 669.8955s
	iters: 1300, epoch: 7 | loss: 0.6047668
	speed: 0.0328s/iter; left time: 670.8303s
	iters: 1400, epoch: 7 | loss: 0.2664440
	speed: 0.0326s/iter; left time: 663.2763s
	iters: 1500, epoch: 7 | loss: 0.2518793
	speed: 0.0327s/iter; left time: 660.5789s
	iters: 1600, epoch: 7 | loss: 0.3217652
	speed: 0.0324s/iter; left time: 652.8114s
	iters: 1700, epoch: 7 | loss: 0.2886003
	speed: 0.0329s/iter; left time: 658.0598s
	iters: 1800, epoch: 7 | loss: 0.3171530
	speed: 0.0330s/iter; left time: 658.1703s
	iters: 1900, epoch: 7 | loss: 0.2483746
	speed: 0.0330s/iter; left time: 654.9397s
	iters: 2000, epoch: 7 | loss: 0.2827738
	speed: 0.0330s/iter; left time: 651.6828s
	iters: 2100, epoch: 7 | loss: 0.2851843
	speed: 0.0331s/iter; left time: 648.9720s
	iters: 2200, epoch: 7 | loss: 0.2652465
	speed: 0.0325s/iter; left time: 633.8127s
	iters: 2300, epoch: 7 | loss: 0.2453252
	speed: 0.0326s/iter; left time: 634.1105s
	iters: 2400, epoch: 7 | loss: 0.2386866
	speed: 0.0312s/iter; left time: 602.2799s
	iters: 2500, epoch: 7 | loss: 0.2659786
	speed: 0.0314s/iter; left time: 603.9254s
	iters: 2600, epoch: 7 | loss: 0.2925328
	speed: 0.0328s/iter; left time: 627.9120s
	iters: 2700, epoch: 7 | loss: 0.3154528
	speed: 0.0328s/iter; left time: 624.9153s
	iters: 2800, epoch: 7 | loss: 0.3182321
	speed: 0.0332s/iter; left time: 628.5859s
	iters: 2900, epoch: 7 | loss: 0.2431906
	speed: 0.0339s/iter; left time: 637.2977s
	iters: 3000, epoch: 7 | loss: 0.2292188
	speed: 0.0340s/iter; left time: 636.5254s
	iters: 3100, epoch: 7 | loss: 0.2375902
	speed: 0.0326s/iter; left time: 606.9539s
	iters: 3200, epoch: 7 | loss: 0.3073164
	speed: 0.0317s/iter; left time: 587.8792s
	iters: 3300, epoch: 7 | loss: 0.2285938
	speed: 0.0310s/iter; left time: 571.2182s
	iters: 3400, epoch: 7 | loss: 0.3152383
	speed: 0.0310s/iter; left time: 567.9193s
	iters: 3500, epoch: 7 | loss: 0.2888750
	speed: 0.0317s/iter; left time: 578.5273s
	iters: 3600, epoch: 7 | loss: 0.2741567
	speed: 0.0309s/iter; left time: 560.6162s
	iters: 3700, epoch: 7 | loss: 0.2386146
	speed: 0.0308s/iter; left time: 555.6629s
	iters: 3800, epoch: 7 | loss: 0.2360989
	speed: 0.0311s/iter; left time: 556.5725s
	iters: 3900, epoch: 7 | loss: 0.2861251
	speed: 0.0312s/iter; left time: 556.8289s
	iters: 4000, epoch: 7 | loss: 0.3472677
	speed: 0.0312s/iter; left time: 553.1851s
	iters: 4100, epoch: 7 | loss: 0.2263018
	speed: 0.0312s/iter; left time: 550.3980s
	iters: 4200, epoch: 7 | loss: 0.2480177
	speed: 0.0315s/iter; left time: 551.8341s
	iters: 4300, epoch: 7 | loss: 0.2356381
	speed: 0.0310s/iter; left time: 539.3256s
	iters: 4400, epoch: 7 | loss: 0.2429954
	speed: 0.0308s/iter; left time: 533.1759s
	iters: 4500, epoch: 7 | loss: 0.3193790
	speed: 0.0310s/iter; left time: 533.2947s
	iters: 4600, epoch: 7 | loss: 0.2635474
	speed: 0.0310s/iter; left time: 531.4840s
	iters: 4700, epoch: 7 | loss: 0.2851261
	speed: 0.0309s/iter; left time: 525.9701s
	iters: 4800, epoch: 7 | loss: 0.2747243
	speed: 0.0307s/iter; left time: 520.1730s
	iters: 4900, epoch: 7 | loss: 0.2340230
	speed: 0.0313s/iter; left time: 526.8110s
	iters: 5000, epoch: 7 | loss: 0.2193308
	speed: 0.0313s/iter; left time: 522.9503s
	iters: 5100, epoch: 7 | loss: 0.3129337
	speed: 0.0311s/iter; left time: 516.6915s
	iters: 5200, epoch: 7 | loss: 0.2641869
	speed: 0.0313s/iter; left time: 516.8245s
	iters: 5300, epoch: 7 | loss: 0.2346742
	speed: 0.0310s/iter; left time: 508.7216s
	iters: 5400, epoch: 7 | loss: 0.3381212
	speed: 0.0314s/iter; left time: 513.2921s
Epoch: 7 cost time: 177.32573246955872
Epoch: 7, Steps: 5431 | Train Loss: 0.2895158 Vali Loss: 0.1975664 Test Loss: 0.2719952
Validation loss decreased (0.198079 --> 0.197566).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2753835
	speed: 1.3781s/iter; left time: 22316.7253s
	iters: 200, epoch: 8 | loss: 0.2980263
	speed: 0.0333s/iter; left time: 536.4020s
	iters: 300, epoch: 8 | loss: 0.2809563
	speed: 0.0335s/iter; left time: 535.8973s
	iters: 400, epoch: 8 | loss: 0.2694663
	speed: 0.0376s/iter; left time: 598.1668s
	iters: 500, epoch: 8 | loss: 0.4542816
	speed: 0.0340s/iter; left time: 537.1374s
	iters: 600, epoch: 8 | loss: 0.2960562
	speed: 0.0310s/iter; left time: 487.0496s
	iters: 700, epoch: 8 | loss: 0.2379324
	speed: 0.0313s/iter; left time: 488.3169s
	iters: 800, epoch: 8 | loss: 0.3475970
	speed: 0.0313s/iter; left time: 485.0826s
	iters: 900, epoch: 8 | loss: 0.2176543
	speed: 0.0330s/iter; left time: 508.3511s
	iters: 1000, epoch: 8 | loss: 0.2224278
	speed: 0.0339s/iter; left time: 518.8488s
	iters: 1100, epoch: 8 | loss: 0.2787283
	speed: 0.0345s/iter; left time: 523.8848s
	iters: 1200, epoch: 8 | loss: 0.2460666
	speed: 0.0382s/iter; left time: 577.2602s
	iters: 1300, epoch: 8 | loss: 0.2691594
	speed: 0.0379s/iter; left time: 568.2761s
	iters: 1400, epoch: 8 | loss: 0.2369090
	speed: 0.0361s/iter; left time: 537.7213s
	iters: 1500, epoch: 8 | loss: 0.4345724
	speed: 0.0320s/iter; left time: 473.8824s
	iters: 1600, epoch: 8 | loss: 0.2716399
	speed: 0.0357s/iter; left time: 524.5303s
	iters: 1700, epoch: 8 | loss: 0.2827755
	speed: 0.0338s/iter; left time: 493.8933s
	iters: 1800, epoch: 8 | loss: 0.3559349
	speed: 0.0333s/iter; left time: 482.5472s
	iters: 1900, epoch: 8 | loss: 0.2920660
	speed: 0.0344s/iter; left time: 495.1865s
	iters: 2000, epoch: 8 | loss: 0.3454370
	speed: 0.0333s/iter; left time: 475.6531s
	iters: 2100, epoch: 8 | loss: 0.2992112
	speed: 0.0355s/iter; left time: 503.5108s
	iters: 2200, epoch: 8 | loss: 0.2404473
	speed: 0.0332s/iter; left time: 467.8147s
	iters: 2300, epoch: 8 | loss: 0.2916730
	speed: 0.0335s/iter; left time: 468.9046s
	iters: 2400, epoch: 8 | loss: 0.2494661
	speed: 0.0333s/iter; left time: 463.0267s
	iters: 2500, epoch: 8 | loss: 0.3261416
	speed: 0.0332s/iter; left time: 458.6450s
	iters: 2600, epoch: 8 | loss: 0.2193679
	speed: 0.0330s/iter; left time: 452.0682s
	iters: 2700, epoch: 8 | loss: 0.2720214
	speed: 0.0331s/iter; left time: 449.4224s
	iters: 2800, epoch: 8 | loss: 0.3572393
	speed: 0.0337s/iter; left time: 454.6225s
	iters: 2900, epoch: 8 | loss: 0.2523810
	speed: 0.0342s/iter; left time: 457.9072s
	iters: 3000, epoch: 8 | loss: 0.2345953
	speed: 0.0338s/iter; left time: 449.6645s
	iters: 3100, epoch: 8 | loss: 0.2823183
	speed: 0.0335s/iter; left time: 441.8452s
	iters: 3200, epoch: 8 | loss: 0.3533134
	speed: 0.0333s/iter; left time: 435.4007s
	iters: 3300, epoch: 8 | loss: 0.2742339
	speed: 0.0332s/iter; left time: 431.0970s
	iters: 3400, epoch: 8 | loss: 0.2927641
	speed: 0.0331s/iter; left time: 426.8392s
	iters: 3500, epoch: 8 | loss: 0.2599519
	speed: 0.0331s/iter; left time: 423.3457s
	iters: 3600, epoch: 8 | loss: 0.2471256
	speed: 0.0332s/iter; left time: 420.9902s
	iters: 3700, epoch: 8 | loss: 0.2420145
	speed: 0.0325s/iter; left time: 408.6924s
	iters: 3800, epoch: 8 | loss: 0.2713179
	speed: 0.0329s/iter; left time: 410.6725s
	iters: 3900, epoch: 8 | loss: 0.3453839
	speed: 0.0324s/iter; left time: 401.1293s
	iters: 4000, epoch: 8 | loss: 0.3492856
	speed: 0.0322s/iter; left time: 395.6276s
	iters: 4100, epoch: 8 | loss: 0.2641883
	speed: 0.0318s/iter; left time: 388.2028s
	iters: 4200, epoch: 8 | loss: 0.2809039
	speed: 0.0316s/iter; left time: 382.3605s
	iters: 4300, epoch: 8 | loss: 0.2783315
	speed: 0.0319s/iter; left time: 382.4774s
	iters: 4400, epoch: 8 | loss: 0.3684437
	speed: 0.0324s/iter; left time: 385.6654s
	iters: 4500, epoch: 8 | loss: 0.3866502
	speed: 0.0325s/iter; left time: 383.4672s
	iters: 4600, epoch: 8 | loss: 0.2762948
	speed: 0.0326s/iter; left time: 381.1315s
	iters: 4700, epoch: 8 | loss: 0.3640355
	speed: 0.0333s/iter; left time: 386.1020s
	iters: 4800, epoch: 8 | loss: 0.2520904
	speed: 0.0340s/iter; left time: 391.0446s
	iters: 4900, epoch: 8 | loss: 0.3180304
	speed: 0.0328s/iter; left time: 374.1665s
	iters: 5000, epoch: 8 | loss: 0.2794529
	speed: 0.0324s/iter; left time: 365.5670s
	iters: 5100, epoch: 8 | loss: 0.3038390
	speed: 0.0327s/iter; left time: 365.8092s
	iters: 5200, epoch: 8 | loss: 0.3395583
	speed: 0.0324s/iter; left time: 359.3303s
	iters: 5300, epoch: 8 | loss: 0.2606556
	speed: 0.0328s/iter; left time: 361.0847s
	iters: 5400, epoch: 8 | loss: 0.2526680
	speed: 0.0325s/iter; left time: 353.9797s
Epoch: 8 cost time: 182.28254985809326
Epoch: 8, Steps: 5431 | Train Loss: 0.2888230 Vali Loss: 0.1975080 Test Loss: 0.2716219
Validation loss decreased (0.197566 --> 0.197508).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2393362
	speed: 1.3409s/iter; left time: 14432.4762s
	iters: 200, epoch: 9 | loss: 0.3515032
	speed: 0.0311s/iter; left time: 331.1912s
	iters: 300, epoch: 9 | loss: 0.2576367
	speed: 0.0307s/iter; left time: 324.0381s
	iters: 400, epoch: 9 | loss: 0.2376425
	speed: 0.0310s/iter; left time: 324.3258s
	iters: 500, epoch: 9 | loss: 0.3186374
	speed: 0.0306s/iter; left time: 316.7451s
	iters: 600, epoch: 9 | loss: 0.2371084
	speed: 0.0306s/iter; left time: 314.0113s
	iters: 700, epoch: 9 | loss: 0.3247437
	speed: 0.0306s/iter; left time: 311.4301s
	iters: 800, epoch: 9 | loss: 0.2621101
	speed: 0.0308s/iter; left time: 310.1423s
	iters: 900, epoch: 9 | loss: 0.3164864
	speed: 0.0306s/iter; left time: 304.8454s
	iters: 1000, epoch: 9 | loss: 0.2687814
	speed: 0.0307s/iter; left time: 302.3827s
	iters: 1100, epoch: 9 | loss: 0.2775356
	speed: 0.0308s/iter; left time: 300.3476s
	iters: 1200, epoch: 9 | loss: 0.2635336
	speed: 0.0307s/iter; left time: 296.3031s
	iters: 1300, epoch: 9 | loss: 0.2530518
	speed: 0.0306s/iter; left time: 292.4437s
	iters: 1400, epoch: 9 | loss: 0.2809489
	speed: 0.0304s/iter; left time: 287.3128s
	iters: 1500, epoch: 9 | loss: 0.2606672
	speed: 0.0306s/iter; left time: 286.7334s
	iters: 1600, epoch: 9 | loss: 0.3114235
	speed: 0.0307s/iter; left time: 283.9172s
	iters: 1700, epoch: 9 | loss: 0.2419285
	speed: 0.0306s/iter; left time: 280.1935s
	iters: 1800, epoch: 9 | loss: 0.3104714
	speed: 0.0307s/iter; left time: 277.9632s
	iters: 1900, epoch: 9 | loss: 0.3079039
	speed: 0.0305s/iter; left time: 273.1462s
	iters: 2000, epoch: 9 | loss: 0.3104097
	speed: 0.0305s/iter; left time: 270.1615s
	iters: 2100, epoch: 9 | loss: 0.2579781
	speed: 0.0307s/iter; left time: 268.7727s
	iters: 2200, epoch: 9 | loss: 0.3372164
	speed: 0.0304s/iter; left time: 263.3511s
	iters: 2300, epoch: 9 | loss: 0.2076461
	speed: 0.0307s/iter; left time: 262.6616s
	iters: 2400, epoch: 9 | loss: 0.2756446
	speed: 0.0305s/iter; left time: 258.3925s
	iters: 2500, epoch: 9 | loss: 0.3506754
	speed: 0.0304s/iter; left time: 254.5200s
	iters: 2600, epoch: 9 | loss: 0.2751715
	speed: 0.0306s/iter; left time: 253.1150s
	iters: 2700, epoch: 9 | loss: 0.3328809
	speed: 0.0304s/iter; left time: 248.0516s
	iters: 2800, epoch: 9 | loss: 0.3809829
	speed: 0.0306s/iter; left time: 246.8183s
	iters: 2900, epoch: 9 | loss: 0.2929244
	speed: 0.0305s/iter; left time: 242.9957s
	iters: 3000, epoch: 9 | loss: 0.3321377
	speed: 0.0307s/iter; left time: 241.1950s
	iters: 3100, epoch: 9 | loss: 0.2419472
	speed: 0.0309s/iter; left time: 240.2613s
	iters: 3200, epoch: 9 | loss: 0.2325746
	speed: 0.0306s/iter; left time: 234.1353s
	iters: 3300, epoch: 9 | loss: 0.2668990
	speed: 0.0305s/iter; left time: 230.7703s
	iters: 3400, epoch: 9 | loss: 0.3233145
	speed: 0.0305s/iter; left time: 227.3100s
	iters: 3500, epoch: 9 | loss: 0.3077086
	speed: 0.0306s/iter; left time: 225.3610s
	iters: 3600, epoch: 9 | loss: 0.3466044
	speed: 0.0305s/iter; left time: 221.8383s
	iters: 3700, epoch: 9 | loss: 0.3473397
	speed: 0.0306s/iter; left time: 219.0065s
	iters: 3800, epoch: 9 | loss: 0.2987571
	speed: 0.0306s/iter; left time: 216.2576s
	iters: 3900, epoch: 9 | loss: 0.2628216
	speed: 0.0310s/iter; left time: 215.7406s
	iters: 4000, epoch: 9 | loss: 0.4480234
	speed: 0.0309s/iter; left time: 211.9901s
	iters: 4100, epoch: 9 | loss: 0.2958970
	speed: 0.0307s/iter; left time: 207.5184s
	iters: 4200, epoch: 9 | loss: 0.3608487
	speed: 0.0308s/iter; left time: 205.1028s
	iters: 4300, epoch: 9 | loss: 0.2875614
	speed: 0.0306s/iter; left time: 200.5994s
	iters: 4400, epoch: 9 | loss: 0.3415002
	speed: 0.0306s/iter; left time: 197.5017s
	iters: 4500, epoch: 9 | loss: 0.3307579
	speed: 0.0306s/iter; left time: 194.4364s
	iters: 4600, epoch: 9 | loss: 0.2614589
	speed: 0.0306s/iter; left time: 191.7107s
	iters: 4700, epoch: 9 | loss: 0.3603061
	speed: 0.0307s/iter; left time: 189.3236s
	iters: 4800, epoch: 9 | loss: 0.2539431
	speed: 0.0306s/iter; left time: 185.7053s
	iters: 4900, epoch: 9 | loss: 0.3315463
	speed: 0.0305s/iter; left time: 182.1516s
	iters: 5000, epoch: 9 | loss: 0.3132679
	speed: 0.0306s/iter; left time: 179.4200s
	iters: 5100, epoch: 9 | loss: 0.3347739
	speed: 0.0307s/iter; left time: 177.1109s
	iters: 5200, epoch: 9 | loss: 0.3390730
	speed: 0.0305s/iter; left time: 172.4878s
	iters: 5300, epoch: 9 | loss: 0.3182627
	speed: 0.0305s/iter; left time: 169.8803s
	iters: 5400, epoch: 9 | loss: 0.4027666
	speed: 0.0306s/iter; left time: 167.4324s
Epoch: 9 cost time: 167.12144589424133
Epoch: 9, Steps: 5431 | Train Loss: 0.2886348 Vali Loss: 0.1973691 Test Loss: 0.2716283
Validation loss decreased (0.197508 --> 0.197369).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2484042
	speed: 1.3336s/iter; left time: 7110.7622s
	iters: 200, epoch: 10 | loss: 0.3725442
	speed: 0.0308s/iter; left time: 161.0119s
	iters: 300, epoch: 10 | loss: 0.2340069
	speed: 0.0306s/iter; left time: 157.0207s
	iters: 400, epoch: 10 | loss: 0.2393845
	speed: 0.0314s/iter; left time: 157.9849s
	iters: 500, epoch: 10 | loss: 0.2284571
	speed: 0.0310s/iter; left time: 152.8665s
	iters: 600, epoch: 10 | loss: 0.2240255
	speed: 0.0309s/iter; left time: 149.4324s
	iters: 700, epoch: 10 | loss: 0.3529703
	speed: 0.0309s/iter; left time: 146.4328s
	iters: 800, epoch: 10 | loss: 0.2589408
	speed: 0.0309s/iter; left time: 143.1612s
	iters: 900, epoch: 10 | loss: 0.2581999
	speed: 0.0311s/iter; left time: 140.9185s
	iters: 1000, epoch: 10 | loss: 0.2418422
	speed: 0.0311s/iter; left time: 137.6534s
	iters: 1100, epoch: 10 | loss: 0.2567718
	speed: 0.0312s/iter; left time: 135.0206s
	iters: 1200, epoch: 10 | loss: 0.3042967
	speed: 0.0309s/iter; left time: 130.8060s
	iters: 1300, epoch: 10 | loss: 0.2123541
	speed: 0.0312s/iter; left time: 128.7919s
	iters: 1400, epoch: 10 | loss: 0.4360278
	speed: 0.0310s/iter; left time: 124.8417s
	iters: 1500, epoch: 10 | loss: 0.3936660
	speed: 0.0308s/iter; left time: 121.2107s
	iters: 1600, epoch: 10 | loss: 0.2302710
	speed: 0.0311s/iter; left time: 119.0994s
	iters: 1700, epoch: 10 | loss: 0.2988196
	speed: 0.0309s/iter; left time: 115.1630s
	iters: 1800, epoch: 10 | loss: 0.2557613
	speed: 0.0306s/iter; left time: 111.2670s
	iters: 1900, epoch: 10 | loss: 0.2784417
	speed: 0.0307s/iter; left time: 108.3461s
	iters: 2000, epoch: 10 | loss: 0.2602328
	speed: 0.0309s/iter; left time: 105.8803s
	iters: 2100, epoch: 10 | loss: 0.2461428
	speed: 0.0308s/iter; left time: 102.7261s
	iters: 2200, epoch: 10 | loss: 0.3336888
	speed: 0.0309s/iter; left time: 99.7496s
	iters: 2300, epoch: 10 | loss: 0.2720270
	speed: 0.0307s/iter; left time: 96.2546s
	iters: 2400, epoch: 10 | loss: 0.2326546
	speed: 0.0307s/iter; left time: 93.0268s
	iters: 2500, epoch: 10 | loss: 0.2958979
	speed: 0.0306s/iter; left time: 89.8049s
	iters: 2600, epoch: 10 | loss: 0.2760310
	speed: 0.0315s/iter; left time: 89.0758s
	iters: 2700, epoch: 10 | loss: 0.3797828
	speed: 0.0315s/iter; left time: 86.0039s
	iters: 2800, epoch: 10 | loss: 0.2505553
	speed: 0.0310s/iter; left time: 81.6530s
	iters: 2900, epoch: 10 | loss: 0.2104354
	speed: 0.0313s/iter; left time: 79.1279s
	iters: 3000, epoch: 10 | loss: 0.2435899
	speed: 0.0314s/iter; left time: 76.2782s
	iters: 3100, epoch: 10 | loss: 0.2678286
	speed: 0.0313s/iter; left time: 72.9290s
	iters: 3200, epoch: 10 | loss: 0.2829938
	speed: 0.0313s/iter; left time: 69.9126s
	iters: 3300, epoch: 10 | loss: 0.2888073
	speed: 0.0314s/iter; left time: 66.9163s
	iters: 3400, epoch: 10 | loss: 0.2713127
	speed: 0.0311s/iter; left time: 63.1672s
	iters: 3500, epoch: 10 | loss: 0.2594103
	speed: 0.0309s/iter; left time: 59.6949s
	iters: 3600, epoch: 10 | loss: 0.2566094
	speed: 0.0314s/iter; left time: 57.4765s
	iters: 3700, epoch: 10 | loss: 0.3386422
	speed: 0.0310s/iter; left time: 53.7122s
	iters: 3800, epoch: 10 | loss: 0.4251527
	speed: 0.0310s/iter; left time: 50.5912s
	iters: 3900, epoch: 10 | loss: 0.2970343
	speed: 0.0310s/iter; left time: 47.5137s
	iters: 4000, epoch: 10 | loss: 0.3749782
	speed: 0.0312s/iter; left time: 44.6601s
	iters: 4100, epoch: 10 | loss: 0.3033140
	speed: 0.0312s/iter; left time: 41.5917s
	iters: 4200, epoch: 10 | loss: 0.2445526
	speed: 0.0310s/iter; left time: 38.1968s
	iters: 4300, epoch: 10 | loss: 0.3021159
	speed: 0.0310s/iter; left time: 35.1408s
	iters: 4400, epoch: 10 | loss: 0.2823036
	speed: 0.0309s/iter; left time: 31.9117s
	iters: 4500, epoch: 10 | loss: 0.2953349
	speed: 0.0310s/iter; left time: 28.9131s
	iters: 4600, epoch: 10 | loss: 0.3992159
	speed: 0.0307s/iter; left time: 25.5678s
	iters: 4700, epoch: 10 | loss: 0.2553966
	speed: 0.0312s/iter; left time: 22.8253s
	iters: 4800, epoch: 10 | loss: 0.2422413
	speed: 0.0310s/iter; left time: 19.6044s
	iters: 4900, epoch: 10 | loss: 0.2340131
	speed: 0.0308s/iter; left time: 16.3862s
	iters: 5000, epoch: 10 | loss: 0.2239762
	speed: 0.0313s/iter; left time: 13.5249s
	iters: 5100, epoch: 10 | loss: 0.3023120
	speed: 0.0308s/iter; left time: 10.2326s
	iters: 5200, epoch: 10 | loss: 0.2353798
	speed: 0.0312s/iter; left time: 7.2341s
	iters: 5300, epoch: 10 | loss: 0.3112352
	speed: 0.0311s/iter; left time: 4.1045s
	iters: 5400, epoch: 10 | loss: 0.2431932
	speed: 0.0311s/iter; left time: 0.9961s
Epoch: 10 cost time: 169.2161476612091
Epoch: 10, Steps: 5431 | Train Loss: 0.2884223 Vali Loss: 0.1974448 Test Loss: 0.2711724
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_pems06_h_96_720_iTransformer_custom_ftM_sl96_ll48_pl720_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 24341
test shape: (24341, 1, 720, 130) (24341, 1, 720, 130)
test shape: (24341, 720, 130) (24341, 720, 130)
mse:0.2716256082057953, mae:0.33574098348617554
>>>>>>>Overall time: 3194 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
