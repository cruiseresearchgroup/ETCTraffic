Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=103, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems05_h.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems05_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_h_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 73678
val 10459
test 21010
	iters: 100, epoch: 1 | loss: 0.2219244
	speed: 0.0380s/iter; left time: 1744.2582s
	iters: 200, epoch: 1 | loss: 0.1822014
	speed: 0.0304s/iter; left time: 1395.4525s
	iters: 300, epoch: 1 | loss: 0.1326181
	speed: 0.0343s/iter; left time: 1568.9959s
	iters: 400, epoch: 1 | loss: 0.1155661
	speed: 0.0348s/iter; left time: 1589.1992s
	iters: 500, epoch: 1 | loss: 0.0996450
	speed: 0.0325s/iter; left time: 1482.1721s
	iters: 600, epoch: 1 | loss: 0.1481152
	speed: 0.0319s/iter; left time: 1451.0264s
	iters: 700, epoch: 1 | loss: 0.1013785
	speed: 0.0318s/iter; left time: 1442.3584s
	iters: 800, epoch: 1 | loss: 0.1025651
	speed: 0.0322s/iter; left time: 1455.3414s
	iters: 900, epoch: 1 | loss: 0.1068751
	speed: 0.0319s/iter; left time: 1439.8474s
	iters: 1000, epoch: 1 | loss: 0.1204464
	speed: 0.0322s/iter; left time: 1451.8732s
	iters: 1100, epoch: 1 | loss: 0.1055600
	speed: 0.0321s/iter; left time: 1440.4038s
	iters: 1200, epoch: 1 | loss: 0.0890532
	speed: 0.0320s/iter; left time: 1434.5327s
	iters: 1300, epoch: 1 | loss: 0.0933621
	speed: 0.0321s/iter; left time: 1435.0905s
	iters: 1400, epoch: 1 | loss: 0.1367276
	speed: 0.0320s/iter; left time: 1428.7038s
	iters: 1500, epoch: 1 | loss: 0.0960159
	speed: 0.0321s/iter; left time: 1429.3701s
	iters: 1600, epoch: 1 | loss: 0.0972191
	speed: 0.0324s/iter; left time: 1438.9720s
	iters: 1700, epoch: 1 | loss: 0.0871323
	speed: 0.0324s/iter; left time: 1437.8145s
	iters: 1800, epoch: 1 | loss: 0.0840413
	speed: 0.0323s/iter; left time: 1430.7928s
	iters: 1900, epoch: 1 | loss: 0.0979895
	speed: 0.0320s/iter; left time: 1411.5043s
	iters: 2000, epoch: 1 | loss: 0.0975358
	speed: 0.0320s/iter; left time: 1410.0602s
	iters: 2100, epoch: 1 | loss: 0.1077377
	speed: 0.0317s/iter; left time: 1394.6032s
	iters: 2200, epoch: 1 | loss: 0.0951912
	speed: 0.0302s/iter; left time: 1321.9535s
	iters: 2300, epoch: 1 | loss: 0.1289935
	speed: 0.0305s/iter; left time: 1333.4187s
	iters: 2400, epoch: 1 | loss: 0.0854404
	speed: 0.0303s/iter; left time: 1321.4121s
	iters: 2500, epoch: 1 | loss: 0.0847997
	speed: 0.0303s/iter; left time: 1318.1367s
	iters: 2600, epoch: 1 | loss: 0.1111772
	speed: 0.0305s/iter; left time: 1326.4328s
	iters: 2700, epoch: 1 | loss: 0.1028607
	speed: 0.0300s/iter; left time: 1301.5527s
	iters: 2800, epoch: 1 | loss: 0.0907959
	speed: 0.0301s/iter; left time: 1301.3659s
	iters: 2900, epoch: 1 | loss: 0.0955571
	speed: 0.0301s/iter; left time: 1296.5698s
	iters: 3000, epoch: 1 | loss: 0.1007382
	speed: 0.0296s/iter; left time: 1273.9761s
	iters: 3100, epoch: 1 | loss: 0.0988492
	speed: 0.0297s/iter; left time: 1275.1325s
	iters: 3200, epoch: 1 | loss: 0.9864136
	speed: 0.0304s/iter; left time: 1303.2128s
	iters: 3300, epoch: 1 | loss: 0.9481583
	speed: 0.0304s/iter; left time: 1300.7104s
	iters: 3400, epoch: 1 | loss: 0.8835497
	speed: 0.0300s/iter; left time: 1280.4431s
	iters: 3500, epoch: 1 | loss: 0.9530315
	speed: 0.0304s/iter; left time: 1293.4422s
	iters: 3600, epoch: 1 | loss: 0.9560354
	speed: 0.0300s/iter; left time: 1274.0920s
	iters: 3700, epoch: 1 | loss: 0.9286622
	speed: 0.0301s/iter; left time: 1275.1339s
	iters: 3800, epoch: 1 | loss: 0.9063016
	speed: 0.0302s/iter; left time: 1274.1410s
	iters: 3900, epoch: 1 | loss: 0.9484812
	speed: 0.0305s/iter; left time: 1284.4164s
	iters: 4000, epoch: 1 | loss: 0.9269269
	speed: 0.0305s/iter; left time: 1281.8906s
	iters: 4100, epoch: 1 | loss: 0.8708813
	speed: 0.0304s/iter; left time: 1276.5107s
	iters: 4200, epoch: 1 | loss: 0.8407891
	speed: 0.0304s/iter; left time: 1273.3260s
	iters: 4300, epoch: 1 | loss: 0.9051985
	speed: 0.0304s/iter; left time: 1268.6774s
	iters: 4400, epoch: 1 | loss: 0.9008361
	speed: 0.0301s/iter; left time: 1254.6544s
	iters: 4500, epoch: 1 | loss: 0.9092929
	speed: 0.0305s/iter; left time: 1265.8018s
	iters: 4600, epoch: 1 | loss: 0.9228476
	speed: 0.0324s/iter; left time: 1343.5047s
Epoch: 1 cost time: 144.37878441810608
Epoch: 1, Steps: 4604 | Train Loss: 0.3732502 Vali Loss: 1.0060499 Test Loss: 1.2497473
Validation loss decreased (inf --> 1.006050).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.9079543
	speed: 0.9585s/iter; left time: 39619.8113s
	iters: 200, epoch: 2 | loss: 0.9199248
	speed: 0.0308s/iter; left time: 1269.0882s
	iters: 300, epoch: 2 | loss: 0.9288188
	speed: 0.0296s/iter; left time: 1217.8340s
	iters: 400, epoch: 2 | loss: 0.8954970
	speed: 0.0302s/iter; left time: 1237.6324s
	iters: 500, epoch: 2 | loss: 0.9562920
	speed: 0.0298s/iter; left time: 1219.8668s
	iters: 600, epoch: 2 | loss: 0.9131821
	speed: 0.0304s/iter; left time: 1241.5888s
	iters: 700, epoch: 2 | loss: 1.0098097
	speed: 0.0301s/iter; left time: 1225.6459s
	iters: 800, epoch: 2 | loss: 0.9493570
	speed: 0.0300s/iter; left time: 1217.4294s
	iters: 900, epoch: 2 | loss: 0.9125937
	speed: 0.0298s/iter; left time: 1207.1523s
	iters: 1000, epoch: 2 | loss: 0.9507959
	speed: 0.0303s/iter; left time: 1226.7281s
	iters: 1100, epoch: 2 | loss: 0.9360361
	speed: 0.0299s/iter; left time: 1204.3492s
	iters: 1200, epoch: 2 | loss: 0.9237475
	speed: 0.0296s/iter; left time: 1191.9835s
	iters: 1300, epoch: 2 | loss: 0.9638614
	speed: 0.0297s/iter; left time: 1191.6317s
	iters: 1400, epoch: 2 | loss: 0.9426841
	speed: 0.0302s/iter; left time: 1209.2214s
	iters: 1500, epoch: 2 | loss: 0.9710181
	speed: 0.0304s/iter; left time: 1214.9734s
	iters: 1600, epoch: 2 | loss: 0.8828381
	speed: 0.0304s/iter; left time: 1210.5503s
	iters: 1700, epoch: 2 | loss: 0.8948312
	speed: 0.0304s/iter; left time: 1208.3645s
	iters: 1800, epoch: 2 | loss: 1.0098581
	speed: 0.0303s/iter; left time: 1200.5119s
	iters: 1900, epoch: 2 | loss: 0.9535760
	speed: 0.0296s/iter; left time: 1169.1027s
	iters: 2000, epoch: 2 | loss: 0.9480485
	speed: 0.0305s/iter; left time: 1201.6299s
	iters: 2100, epoch: 2 | loss: 0.9619926
	speed: 0.0304s/iter; left time: 1196.7640s
	iters: 2200, epoch: 2 | loss: 0.9467820
	speed: 0.0300s/iter; left time: 1178.9712s
	iters: 2300, epoch: 2 | loss: 0.9454213
	speed: 0.0297s/iter; left time: 1163.5571s
	iters: 2400, epoch: 2 | loss: 0.9666956
	speed: 0.0300s/iter; left time: 1171.0260s
	iters: 2500, epoch: 2 | loss: 0.9577263
	speed: 0.0294s/iter; left time: 1144.3597s
	iters: 2600, epoch: 2 | loss: 0.9355676
	speed: 0.0301s/iter; left time: 1168.6093s
	iters: 2700, epoch: 2 | loss: 0.9432944
	speed: 0.0300s/iter; left time: 1162.4525s
	iters: 2800, epoch: 2 | loss: 0.9433258
	speed: 0.0300s/iter; left time: 1158.4168s
	iters: 2900, epoch: 2 | loss: 0.9677415
	speed: 0.0303s/iter; left time: 1166.8193s
	iters: 3000, epoch: 2 | loss: 0.9524089
	speed: 0.0301s/iter; left time: 1156.8677s
	iters: 3100, epoch: 2 | loss: 0.9456612
	speed: 0.0302s/iter; left time: 1158.6303s
	iters: 3200, epoch: 2 | loss: 0.9762044
	speed: 0.0304s/iter; left time: 1160.9814s
	iters: 3300, epoch: 2 | loss: 0.9556804
	speed: 0.0304s/iter; left time: 1160.1880s
	iters: 3400, epoch: 2 | loss: 0.9736924
	speed: 0.0304s/iter; left time: 1156.3877s
	iters: 3500, epoch: 2 | loss: 0.9166530
	speed: 0.0304s/iter; left time: 1153.3406s
	iters: 3600, epoch: 2 | loss: 0.8859721
	speed: 0.0302s/iter; left time: 1141.8551s
	iters: 3700, epoch: 2 | loss: 0.9709828
	speed: 0.0301s/iter; left time: 1136.5529s
	iters: 3800, epoch: 2 | loss: 0.9738894
	speed: 0.0298s/iter; left time: 1120.3428s
	iters: 3900, epoch: 2 | loss: 0.9415341
	speed: 0.0299s/iter; left time: 1121.0789s
	iters: 4000, epoch: 2 | loss: 0.9175816
	speed: 0.0304s/iter; left time: 1138.8204s
	iters: 4100, epoch: 2 | loss: 0.9295617
	speed: 0.0304s/iter; left time: 1134.9673s
	iters: 4200, epoch: 2 | loss: 0.9414753
	speed: 0.0303s/iter; left time: 1128.7790s
	iters: 4300, epoch: 2 | loss: 0.9147539
	speed: 0.0304s/iter; left time: 1127.7991s
	iters: 4400, epoch: 2 | loss: 0.9720707
	speed: 0.0301s/iter; left time: 1114.6329s
	iters: 4500, epoch: 2 | loss: 0.9495081
	speed: 0.0304s/iter; left time: 1122.6320s
	iters: 4600, epoch: 2 | loss: 0.9735732
	speed: 0.0302s/iter; left time: 1113.9075s
Epoch: 2 cost time: 139.19923639297485
Epoch: 2, Steps: 4604 | Train Loss: 0.9319694 Vali Loss: 1.0058962 Test Loss: 1.2496235
Validation loss decreased (1.006050 --> 1.005896).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.9229456
	speed: 0.9427s/iter; left time: 34629.0322s
	iters: 200, epoch: 3 | loss: 0.9073418
	speed: 0.0305s/iter; left time: 1116.5249s
	iters: 300, epoch: 3 | loss: 0.9369228
	speed: 0.0305s/iter; left time: 1113.8321s
	iters: 400, epoch: 3 | loss: 0.9502898
	speed: 0.0305s/iter; left time: 1109.8018s
	iters: 500, epoch: 3 | loss: 0.8580119
	speed: 0.0305s/iter; left time: 1107.2393s
	iters: 600, epoch: 3 | loss: 0.9235792
	speed: 0.0304s/iter; left time: 1102.9655s
	iters: 700, epoch: 3 | loss: 0.9564344
	speed: 0.0304s/iter; left time: 1100.2497s
	iters: 800, epoch: 3 | loss: 0.9045535
	speed: 0.0304s/iter; left time: 1097.1045s
	iters: 900, epoch: 3 | loss: 0.8949090
	speed: 0.0304s/iter; left time: 1091.8736s
	iters: 1000, epoch: 3 | loss: 0.9322727
	speed: 0.0304s/iter; left time: 1088.4840s
	iters: 1100, epoch: 3 | loss: 0.9720278
	speed: 0.0304s/iter; left time: 1086.2775s
	iters: 1200, epoch: 3 | loss: 0.9304172
	speed: 0.0304s/iter; left time: 1082.9709s
	iters: 1300, epoch: 3 | loss: 0.9874455
	speed: 0.0304s/iter; left time: 1080.4163s
	iters: 1400, epoch: 3 | loss: 0.9915729
	speed: 0.0304s/iter; left time: 1076.3150s
	iters: 1500, epoch: 3 | loss: 0.9134596
	speed: 0.0304s/iter; left time: 1073.8941s
	iters: 1600, epoch: 3 | loss: 0.8980284
	speed: 0.0304s/iter; left time: 1070.6685s
	iters: 1700, epoch: 3 | loss: 0.9488008
	speed: 0.0304s/iter; left time: 1067.4296s
	iters: 1800, epoch: 3 | loss: 0.9242173
	speed: 0.0304s/iter; left time: 1065.3952s
	iters: 1900, epoch: 3 | loss: 0.9154813
	speed: 0.0304s/iter; left time: 1060.2379s
	iters: 2000, epoch: 3 | loss: 0.8700716
	speed: 0.0304s/iter; left time: 1059.0892s
	iters: 2100, epoch: 3 | loss: 0.9182224
	speed: 0.0304s/iter; left time: 1055.7550s
	iters: 2200, epoch: 3 | loss: 0.9239222
	speed: 0.0304s/iter; left time: 1052.4404s
	iters: 2300, epoch: 3 | loss: 0.9087409
	speed: 0.0304s/iter; left time: 1048.5655s
	iters: 2400, epoch: 3 | loss: 0.9329889
	speed: 0.0304s/iter; left time: 1046.1067s
	iters: 2500, epoch: 3 | loss: 0.9260142
	speed: 0.0304s/iter; left time: 1043.7306s
	iters: 2600, epoch: 3 | loss: 0.9006760
	speed: 0.0304s/iter; left time: 1041.5208s
	iters: 2700, epoch: 3 | loss: 0.9227777
	speed: 0.0304s/iter; left time: 1038.1219s
	iters: 2800, epoch: 3 | loss: 0.9393606
	speed: 0.0304s/iter; left time: 1034.1359s
	iters: 2900, epoch: 3 | loss: 0.9246964
	speed: 0.0304s/iter; left time: 1031.0186s
	iters: 3000, epoch: 3 | loss: 0.9616754
	speed: 0.0304s/iter; left time: 1027.2456s
	iters: 3100, epoch: 3 | loss: 0.9171129
	speed: 0.0304s/iter; left time: 1025.3509s
	iters: 3200, epoch: 3 | loss: 0.9449438
	speed: 0.0304s/iter; left time: 1021.0978s
	iters: 3300, epoch: 3 | loss: 0.9644770
	speed: 0.0303s/iter; left time: 1017.5656s
	iters: 3400, epoch: 3 | loss: 0.8864222
	speed: 0.0304s/iter; left time: 1015.3193s
	iters: 3500, epoch: 3 | loss: 0.8892525
	speed: 0.0304s/iter; left time: 1013.3461s
	iters: 3600, epoch: 3 | loss: 0.9078313
	speed: 0.0293s/iter; left time: 975.2742s
	iters: 3700, epoch: 3 | loss: 0.9419507
	speed: 0.0301s/iter; left time: 998.9256s
	iters: 3800, epoch: 3 | loss: 0.9875946
	speed: 0.0304s/iter; left time: 1005.1168s
	iters: 3900, epoch: 3 | loss: 0.9638850
	speed: 0.0304s/iter; left time: 1000.3738s
	iters: 4000, epoch: 3 | loss: 0.9310175
	speed: 0.0304s/iter; left time: 998.1061s
	iters: 4100, epoch: 3 | loss: 0.9177734
	speed: 0.0295s/iter; left time: 967.1399s
	iters: 4200, epoch: 3 | loss: 0.9523942
	speed: 0.0299s/iter; left time: 974.7734s
	iters: 4300, epoch: 3 | loss: 0.9227556
	speed: 0.0277s/iter; left time: 901.1701s
	iters: 4400, epoch: 3 | loss: 0.9233260
	speed: 0.0294s/iter; left time: 953.6354s
	iters: 4500, epoch: 3 | loss: 0.8992673
	speed: 0.0292s/iter; left time: 943.0506s
	iters: 4600, epoch: 3 | loss: 0.9454769
	speed: 0.0304s/iter; left time: 979.3538s
Epoch: 3 cost time: 139.69921684265137
Epoch: 3, Steps: 4604 | Train Loss: 0.9350102 Vali Loss: 1.0056906 Test Loss: 1.2493242
Validation loss decreased (1.005896 --> 1.005691).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.9453192
	speed: 0.9209s/iter; left time: 29588.8317s
	iters: 200, epoch: 4 | loss: 0.9627697
	speed: 0.0304s/iter; left time: 972.2737s
	iters: 300, epoch: 4 | loss: 0.9209700
	speed: 0.0303s/iter; left time: 967.3776s
	iters: 400, epoch: 4 | loss: 0.8976914
	speed: 0.0305s/iter; left time: 970.6322s
	iters: 500, epoch: 4 | loss: 0.9244831
	speed: 0.0301s/iter; left time: 955.8912s
	iters: 600, epoch: 4 | loss: 0.9693580
	speed: 0.0304s/iter; left time: 960.4088s
	iters: 700, epoch: 4 | loss: 0.9334447
	speed: 0.0304s/iter; left time: 957.6164s
	iters: 800, epoch: 4 | loss: 0.9344916
	speed: 0.0300s/iter; left time: 942.0853s
	iters: 900, epoch: 4 | loss: 0.9445978
	speed: 0.0305s/iter; left time: 954.2465s
	iters: 1000, epoch: 4 | loss: 0.9554003
	speed: 0.0303s/iter; left time: 945.8812s
	iters: 1100, epoch: 4 | loss: 0.8826334
	speed: 0.0305s/iter; left time: 947.9897s
	iters: 1200, epoch: 4 | loss: 0.9325899
	speed: 0.0303s/iter; left time: 939.7701s
	iters: 1300, epoch: 4 | loss: 0.9209769
	speed: 0.0301s/iter; left time: 931.6402s
	iters: 1400, epoch: 4 | loss: 0.9125266
	speed: 0.0299s/iter; left time: 922.0943s
	iters: 1500, epoch: 4 | loss: 0.9255092
	speed: 0.0303s/iter; left time: 931.5571s
	iters: 1600, epoch: 4 | loss: 0.9708111
	speed: 0.0302s/iter; left time: 924.1323s
	iters: 1700, epoch: 4 | loss: 0.9163161
	speed: 0.0301s/iter; left time: 918.4903s
	iters: 1800, epoch: 4 | loss: 0.9373897
	speed: 0.0300s/iter; left time: 911.6948s
	iters: 1900, epoch: 4 | loss: 0.9175369
	speed: 0.0303s/iter; left time: 919.9268s
	iters: 2000, epoch: 4 | loss: 0.9365514
	speed: 0.0294s/iter; left time: 890.0765s
	iters: 2100, epoch: 4 | loss: 0.9538097
	speed: 0.0300s/iter; left time: 902.3976s
	iters: 2200, epoch: 4 | loss: 0.9207440
	speed: 0.0303s/iter; left time: 910.6795s
	iters: 2300, epoch: 4 | loss: 0.9047084
	speed: 0.0304s/iter; left time: 908.9888s
	iters: 2400, epoch: 4 | loss: 0.9581369
	speed: 0.0301s/iter; left time: 899.0406s
	iters: 2500, epoch: 4 | loss: 0.8944210
	speed: 0.0300s/iter; left time: 891.1692s
	iters: 2600, epoch: 4 | loss: 0.9026405
	speed: 0.0303s/iter; left time: 898.6616s
	iters: 2700, epoch: 4 | loss: 0.9444658
	speed: 0.0304s/iter; left time: 896.4981s
	iters: 2800, epoch: 4 | loss: 0.9113317
	speed: 0.0304s/iter; left time: 894.7131s
	iters: 2900, epoch: 4 | loss: 0.9260923
	speed: 0.0304s/iter; left time: 891.6475s
	iters: 3000, epoch: 4 | loss: 0.8940364
	speed: 0.0299s/iter; left time: 873.9552s
	iters: 3100, epoch: 4 | loss: 0.9478294
	speed: 0.0303s/iter; left time: 881.4896s
	iters: 3200, epoch: 4 | loss: 0.9100763
	speed: 0.0296s/iter; left time: 859.8066s
	iters: 3300, epoch: 4 | loss: 0.9099360
	speed: 0.0304s/iter; left time: 879.6407s
	iters: 3400, epoch: 4 | loss: 0.9375816
	speed: 0.0302s/iter; left time: 870.8031s
	iters: 3500, epoch: 4 | loss: 0.9124863
	speed: 0.0299s/iter; left time: 859.9415s
	iters: 3600, epoch: 4 | loss: 0.8607825
	speed: 0.0296s/iter; left time: 847.8777s
	iters: 3700, epoch: 4 | loss: 0.9465957
	speed: 0.0302s/iter; left time: 862.6448s
	iters: 3800, epoch: 4 | loss: 0.9478853
	speed: 0.0303s/iter; left time: 861.5444s
	iters: 3900, epoch: 4 | loss: 0.9615484
	speed: 0.0304s/iter; left time: 860.6671s
	iters: 4000, epoch: 4 | loss: 0.8738679
	speed: 0.0304s/iter; left time: 858.3613s
	iters: 4100, epoch: 4 | loss: 0.9096392
	speed: 0.0304s/iter; left time: 855.6258s
	iters: 4200, epoch: 4 | loss: 0.9491258
	speed: 0.0293s/iter; left time: 820.6523s
	iters: 4300, epoch: 4 | loss: 0.9253615
	speed: 0.0304s/iter; left time: 850.3052s
	iters: 4400, epoch: 4 | loss: 0.9865122
	speed: 0.0304s/iter; left time: 845.6876s
	iters: 4500, epoch: 4 | loss: 0.8976580
	speed: 0.0302s/iter; left time: 838.0009s
	iters: 4600, epoch: 4 | loss: 0.8994713
	speed: 0.0295s/iter; left time: 815.3776s
Epoch: 4 cost time: 139.37643313407898
Epoch: 4, Steps: 4604 | Train Loss: 0.9349031 Vali Loss: 1.0056391 Test Loss: 1.2493154
Validation loss decreased (1.005691 --> 1.005639).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.9376904
	speed: 0.9632s/iter; left time: 26510.7521s
	iters: 200, epoch: 5 | loss: 0.9286697
	speed: 0.0305s/iter; left time: 835.6990s
	iters: 300, epoch: 5 | loss: 0.9534577
	speed: 0.0305s/iter; left time: 833.6006s
	iters: 400, epoch: 5 | loss: 0.9292833
	speed: 0.0305s/iter; left time: 830.6621s
	iters: 500, epoch: 5 | loss: 0.9270147
	speed: 0.0305s/iter; left time: 826.8840s
	iters: 600, epoch: 5 | loss: 0.9147397
	speed: 0.0305s/iter; left time: 824.6029s
	iters: 700, epoch: 5 | loss: 0.8767070
	speed: 0.0305s/iter; left time: 820.2458s
	iters: 800, epoch: 5 | loss: 0.9497566
	speed: 0.0292s/iter; left time: 782.2144s
	iters: 900, epoch: 5 | loss: 0.8780068
	speed: 0.0288s/iter; left time: 770.5182s
	iters: 1000, epoch: 5 | loss: 0.9210997
	speed: 0.0289s/iter; left time: 770.0475s
	iters: 1100, epoch: 5 | loss: 0.9068325
	speed: 0.0281s/iter; left time: 745.6927s
	iters: 1200, epoch: 5 | loss: 0.9780338
	speed: 0.0305s/iter; left time: 807.1999s
	iters: 1300, epoch: 5 | loss: 0.9776612
	speed: 0.0305s/iter; left time: 803.7026s
	iters: 1400, epoch: 5 | loss: 0.9610648
	speed: 0.0292s/iter; left time: 765.0283s
	iters: 1500, epoch: 5 | loss: 0.9566400
	speed: 0.0298s/iter; left time: 779.0609s
	iters: 1600, epoch: 5 | loss: 0.9328320
	speed: 0.0299s/iter; left time: 778.0859s
	iters: 1700, epoch: 5 | loss: 0.8922710
	speed: 0.0301s/iter; left time: 779.9279s
	iters: 1800, epoch: 5 | loss: 0.9012643
	speed: 0.0284s/iter; left time: 734.6987s
	iters: 1900, epoch: 5 | loss: 0.9574279
	speed: 0.0305s/iter; left time: 783.6907s
	iters: 2000, epoch: 5 | loss: 0.9320747
	speed: 0.0287s/iter; left time: 736.5672s
	iters: 2100, epoch: 5 | loss: 0.9269459
	speed: 0.0294s/iter; left time: 750.8246s
	iters: 2200, epoch: 5 | loss: 0.9707715
	speed: 0.0297s/iter; left time: 755.3446s
	iters: 2300, epoch: 5 | loss: 0.9029318
	speed: 0.0294s/iter; left time: 743.4597s
	iters: 2400, epoch: 5 | loss: 0.9213145
	speed: 0.0297s/iter; left time: 749.2546s
	iters: 2500, epoch: 5 | loss: 0.8913425
	speed: 0.0297s/iter; left time: 746.9686s
	iters: 2600, epoch: 5 | loss: 0.9419015
	speed: 0.0301s/iter; left time: 753.8511s
	iters: 2700, epoch: 5 | loss: 0.9052588
	speed: 0.0304s/iter; left time: 757.9591s
	iters: 2800, epoch: 5 | loss: 0.9478493
	speed: 0.0296s/iter; left time: 734.6783s
	iters: 2900, epoch: 5 | loss: 0.9819699
	speed: 0.0300s/iter; left time: 742.7841s
	iters: 3000, epoch: 5 | loss: 0.9872748
	speed: 0.0302s/iter; left time: 742.8148s
	iters: 3100, epoch: 5 | loss: 0.9272022
	speed: 0.0299s/iter; left time: 734.2284s
	iters: 3200, epoch: 5 | loss: 0.9535804
	speed: 0.0303s/iter; left time: 740.1658s
	iters: 3300, epoch: 5 | loss: 0.9229031
	speed: 0.0303s/iter; left time: 737.0198s
	iters: 3400, epoch: 5 | loss: 0.9827960
	speed: 0.0300s/iter; left time: 727.2233s
	iters: 3500, epoch: 5 | loss: 0.9143335
	speed: 0.0299s/iter; left time: 721.8054s
	iters: 3600, epoch: 5 | loss: 0.9298236
	speed: 0.0297s/iter; left time: 712.4341s
	iters: 3700, epoch: 5 | loss: 0.9183866
	speed: 0.0301s/iter; left time: 721.1503s
	iters: 3800, epoch: 5 | loss: 1.0133754
	speed: 0.0303s/iter; left time: 721.9728s
	iters: 3900, epoch: 5 | loss: 0.9263816
	speed: 0.0304s/iter; left time: 722.0441s
	iters: 4000, epoch: 5 | loss: 0.9327999
	speed: 0.0304s/iter; left time: 718.6285s
	iters: 4100, epoch: 5 | loss: 0.9490025
	speed: 0.0298s/iter; left time: 701.7683s
	iters: 4200, epoch: 5 | loss: 0.9024273
	speed: 0.0297s/iter; left time: 696.1126s
	iters: 4300, epoch: 5 | loss: 0.9321963
	speed: 0.0304s/iter; left time: 709.8086s
	iters: 4400, epoch: 5 | loss: 0.9509563
	speed: 0.0304s/iter; left time: 707.0147s
	iters: 4500, epoch: 5 | loss: 0.9316487
	speed: 0.0303s/iter; left time: 701.3581s
	iters: 4600, epoch: 5 | loss: 0.8605736
	speed: 0.0304s/iter; left time: 700.6697s
Epoch: 5 cost time: 138.3143835067749
Epoch: 5, Steps: 4604 | Train Loss: 0.9348433 Vali Loss: 1.0056609 Test Loss: 1.2492968
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.9605224
	speed: 0.9223s/iter; left time: 21140.2556s
	iters: 200, epoch: 6 | loss: 0.9728676
	speed: 0.0309s/iter; left time: 704.2747s
	iters: 300, epoch: 6 | loss: 0.9592082
	speed: 0.0295s/iter; left time: 670.7632s
	iters: 400, epoch: 6 | loss: 0.9244730
	speed: 0.0305s/iter; left time: 690.6015s
	iters: 500, epoch: 6 | loss: 0.9508886
	speed: 0.0302s/iter; left time: 679.2950s
	iters: 600, epoch: 6 | loss: 0.9313151
	speed: 0.0300s/iter; left time: 671.9523s
	iters: 700, epoch: 6 | loss: 0.9714647
	speed: 0.0301s/iter; left time: 672.5007s
	iters: 800, epoch: 6 | loss: 0.9508050
	speed: 0.0294s/iter; left time: 653.7669s
	iters: 900, epoch: 6 | loss: 0.9573317
	speed: 0.0299s/iter; left time: 660.4617s
	iters: 1000, epoch: 6 | loss: 0.8680562
	speed: 0.0301s/iter; left time: 663.8848s
	iters: 1100, epoch: 6 | loss: 0.8986328
	speed: 0.0305s/iter; left time: 667.9817s
	iters: 1200, epoch: 6 | loss: 0.9266965
	speed: 0.0303s/iter; left time: 660.8869s
	iters: 1300, epoch: 6 | loss: 0.9429793
	speed: 0.0305s/iter; left time: 661.8630s
	iters: 1400, epoch: 6 | loss: 0.9874916
	speed: 0.0305s/iter; left time: 658.5768s
	iters: 1500, epoch: 6 | loss: 0.9114264
	speed: 0.0305s/iter; left time: 655.3984s
	iters: 1600, epoch: 6 | loss: 0.9571236
	speed: 0.0305s/iter; left time: 653.4505s
	iters: 1700, epoch: 6 | loss: 0.9844204
	speed: 0.0305s/iter; left time: 649.6646s
	iters: 1800, epoch: 6 | loss: 0.9586441
	speed: 0.0305s/iter; left time: 646.6613s
	iters: 1900, epoch: 6 | loss: 0.9289352
	speed: 0.0305s/iter; left time: 643.7391s
	iters: 2000, epoch: 6 | loss: 0.9723288
	speed: 0.0303s/iter; left time: 637.2304s
	iters: 2100, epoch: 6 | loss: 0.9498638
	speed: 0.0308s/iter; left time: 644.1378s
	iters: 2200, epoch: 6 | loss: 0.9179507
	speed: 0.0306s/iter; left time: 636.2294s
	iters: 2300, epoch: 6 | loss: 0.9732884
	speed: 0.0300s/iter; left time: 621.6307s
	iters: 2400, epoch: 6 | loss: 0.9688812
	speed: 0.0302s/iter; left time: 621.8021s
	iters: 2500, epoch: 6 | loss: 0.9014585
	speed: 0.0299s/iter; left time: 613.1497s
	iters: 2600, epoch: 6 | loss: 0.9252812
	speed: 0.0303s/iter; left time: 619.2401s
	iters: 2700, epoch: 6 | loss: 0.9103506
	speed: 0.0297s/iter; left time: 603.2103s
	iters: 2800, epoch: 6 | loss: 1.0213513
	speed: 0.0300s/iter; left time: 606.4437s
	iters: 2900, epoch: 6 | loss: 0.9354210
	speed: 0.0301s/iter; left time: 605.5223s
	iters: 3000, epoch: 6 | loss: 0.9156587
	speed: 0.0299s/iter; left time: 598.7809s
	iters: 3100, epoch: 6 | loss: 0.9671056
	speed: 0.0302s/iter; left time: 602.5243s
	iters: 3200, epoch: 6 | loss: 0.9206184
	speed: 0.0303s/iter; left time: 599.9874s
	iters: 3300, epoch: 6 | loss: 0.9322194
	speed: 0.0299s/iter; left time: 590.3983s
	iters: 3400, epoch: 6 | loss: 0.9471007
	speed: 0.0299s/iter; left time: 586.3039s
	iters: 3500, epoch: 6 | loss: 0.9556295
	speed: 0.0299s/iter; left time: 584.5226s
	iters: 3600, epoch: 6 | loss: 0.9891793
	speed: 0.0302s/iter; left time: 585.9339s
	iters: 3700, epoch: 6 | loss: 0.9262336
	speed: 0.0297s/iter; left time: 574.5853s
	iters: 3800, epoch: 6 | loss: 0.9183502
	speed: 0.0302s/iter; left time: 580.1833s
	iters: 3900, epoch: 6 | loss: 0.9708183
	speed: 0.0302s/iter; left time: 577.4709s
	iters: 4000, epoch: 6 | loss: 0.9135383
	speed: 0.0302s/iter; left time: 574.0441s
	iters: 4100, epoch: 6 | loss: 0.9195861
	speed: 0.0299s/iter; left time: 566.0021s
	iters: 4200, epoch: 6 | loss: 0.9866493
	speed: 0.0296s/iter; left time: 556.5941s
	iters: 4300, epoch: 6 | loss: 0.9343395
	speed: 0.0295s/iter; left time: 551.3981s
	iters: 4400, epoch: 6 | loss: 0.9241983
	speed: 0.0298s/iter; left time: 555.6274s
	iters: 4500, epoch: 6 | loss: 0.8555636
	speed: 0.0304s/iter; left time: 563.3176s
	iters: 4600, epoch: 6 | loss: 0.9845890
	speed: 0.0300s/iter; left time: 552.1867s
Epoch: 6 cost time: 139.13418292999268
Epoch: 6, Steps: 4604 | Train Loss: 0.9347911 Vali Loss: 1.0057342 Test Loss: 1.2492934
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.9505544
	speed: 0.9284s/iter; left time: 17005.1347s
	iters: 200, epoch: 7 | loss: 0.9630953
	speed: 0.0305s/iter; left time: 554.7372s
	iters: 300, epoch: 7 | loss: 0.9228571
	speed: 0.0305s/iter; left time: 552.4570s
	iters: 400, epoch: 7 | loss: 0.9713454
	speed: 0.0305s/iter; left time: 549.0366s
	iters: 500, epoch: 7 | loss: 0.8468974
	speed: 0.0309s/iter; left time: 552.7986s
	iters: 600, epoch: 7 | loss: 0.9395290
	speed: 0.0304s/iter; left time: 542.3041s
	iters: 700, epoch: 7 | loss: 0.9518281
	speed: 0.0305s/iter; left time: 539.5110s
	iters: 800, epoch: 7 | loss: 0.9328861
	speed: 0.0304s/iter; left time: 536.3368s
	iters: 900, epoch: 7 | loss: 0.9170969
	speed: 0.0305s/iter; left time: 534.1568s
	iters: 1000, epoch: 7 | loss: 0.9012235
	speed: 0.0305s/iter; left time: 530.4117s
	iters: 1100, epoch: 7 | loss: 0.9328685
	speed: 0.0293s/iter; left time: 507.4656s
	iters: 1200, epoch: 7 | loss: 0.8856548
	speed: 0.0302s/iter; left time: 520.2517s
	iters: 1300, epoch: 7 | loss: 0.9536110
	speed: 0.0287s/iter; left time: 491.5175s
	iters: 1400, epoch: 7 | loss: 0.9123643
	speed: 0.0304s/iter; left time: 517.2035s
	iters: 1500, epoch: 7 | loss: 0.9879662
	speed: 0.0305s/iter; left time: 515.4939s
	iters: 1600, epoch: 7 | loss: 0.9507847
	speed: 0.0304s/iter; left time: 511.6024s
	iters: 1700, epoch: 7 | loss: 0.8723100
	speed: 0.0305s/iter; left time: 509.4082s
	iters: 1800, epoch: 7 | loss: 0.9620520
	speed: 0.0304s/iter; left time: 505.6430s
	iters: 1900, epoch: 7 | loss: 0.9589505
	speed: 0.0304s/iter; left time: 502.5688s
	iters: 2000, epoch: 7 | loss: 0.9424238
	speed: 0.0304s/iter; left time: 499.8481s
	iters: 2100, epoch: 7 | loss: 0.9292868
	speed: 0.0305s/iter; left time: 496.9235s
	iters: 2200, epoch: 7 | loss: 0.9166545
	speed: 0.0305s/iter; left time: 494.0540s
	iters: 2300, epoch: 7 | loss: 0.9517325
	speed: 0.0304s/iter; left time: 490.7083s
	iters: 2400, epoch: 7 | loss: 0.9589784
	speed: 0.0304s/iter; left time: 487.5528s
	iters: 2500, epoch: 7 | loss: 0.9623605
	speed: 0.0304s/iter; left time: 484.5330s
	iters: 2600, epoch: 7 | loss: 0.9263725
	speed: 0.0305s/iter; left time: 481.6519s
	iters: 2700, epoch: 7 | loss: 0.9164395
	speed: 0.0305s/iter; left time: 479.2411s
	iters: 2800, epoch: 7 | loss: 0.9657015
	speed: 0.0305s/iter; left time: 475.7626s
	iters: 2900, epoch: 7 | loss: 0.9489771
	speed: 0.0304s/iter; left time: 471.3436s
	iters: 3000, epoch: 7 | loss: 0.9984479
	speed: 0.0304s/iter; left time: 469.0385s
	iters: 3100, epoch: 7 | loss: 0.8800622
	speed: 0.0304s/iter; left time: 465.4150s
	iters: 3200, epoch: 7 | loss: 0.9292046
	speed: 0.0304s/iter; left time: 463.0000s
	iters: 3300, epoch: 7 | loss: 0.9555895
	speed: 0.0304s/iter; left time: 459.3121s
	iters: 3400, epoch: 7 | loss: 0.9697330
	speed: 0.0304s/iter; left time: 456.7921s
	iters: 3500, epoch: 7 | loss: 0.9370506
	speed: 0.0304s/iter; left time: 453.8276s
	iters: 3600, epoch: 7 | loss: 0.9812659
	speed: 0.0305s/iter; left time: 451.7053s
	iters: 3700, epoch: 7 | loss: 0.9794831
	speed: 0.0304s/iter; left time: 447.4986s
	iters: 3800, epoch: 7 | loss: 0.9157525
	speed: 0.0304s/iter; left time: 444.4668s
	iters: 3900, epoch: 7 | loss: 0.9501274
	speed: 0.0304s/iter; left time: 441.6140s
	iters: 4000, epoch: 7 | loss: 0.9503012
	speed: 0.0304s/iter; left time: 438.5469s
	iters: 4100, epoch: 7 | loss: 0.9248290
	speed: 0.0304s/iter; left time: 435.3593s
	iters: 4200, epoch: 7 | loss: 0.9688836
	speed: 0.0304s/iter; left time: 432.6334s
	iters: 4300, epoch: 7 | loss: 0.8805957
	speed: 0.0304s/iter; left time: 429.6552s
	iters: 4400, epoch: 7 | loss: 0.8843779
	speed: 0.0305s/iter; left time: 426.8836s
	iters: 4500, epoch: 7 | loss: 0.9373924
	speed: 0.0304s/iter; left time: 423.1043s
	iters: 4600, epoch: 7 | loss: 0.9632338
	speed: 0.0304s/iter; left time: 419.5912s
Epoch: 7 cost time: 140.37115716934204
Epoch: 7, Steps: 4604 | Train Loss: 0.9347937 Vali Loss: 1.0056777 Test Loss: 1.2492898
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_h_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 21010
test shape: (21010, 1, 96, 103) (21010, 1, 96, 103)
test shape: (21010, 96, 103) (21010, 96, 103)
mse:1.2493185997009277, mae:0.9768758416175842
>>>>>>>Overall time: 1706 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
