Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=1543, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=1543, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1543, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems12_d_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5249
val 477
test 1288
	iters: 100, epoch: 1 | loss: 0.7384658
	speed: 0.1118s/iter; left time: 3657.5165s
Epoch: 1 cost time: 18.018691062927246
Epoch: 1, Steps: 164 | Train Loss: 0.8077075 Vali Loss: 0.8470001 Test Loss: 1.9593217
Validation loss decreased (inf --> 0.847000).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7509512
	speed: 0.3348s/iter; left time: 10892.2971s
Epoch: 2 cost time: 17.791261672973633
Epoch: 2, Steps: 164 | Train Loss: 0.7802467 Vali Loss: 0.8454422 Test Loss: 1.9586635
Validation loss decreased (0.847000 --> 0.845442).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7896124
	speed: 0.3336s/iter; left time: 10801.1654s
Epoch: 3 cost time: 17.7778742313385
Epoch: 3, Steps: 164 | Train Loss: 0.7786686 Vali Loss: 0.8416458 Test Loss: 1.9595649
Validation loss decreased (0.845442 --> 0.841646).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8322619
	speed: 0.3337s/iter; left time: 10748.9944s
Epoch: 4 cost time: 17.850327014923096
Epoch: 4, Steps: 164 | Train Loss: 0.7784598 Vali Loss: 0.8419938 Test Loss: 1.9608107
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.7420824
	speed: 0.3346s/iter; left time: 10721.1340s
Epoch: 5 cost time: 17.878786325454712
Epoch: 5, Steps: 164 | Train Loss: 0.7783363 Vali Loss: 0.8421468 Test Loss: 1.9605478
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.7521036
	speed: 0.3345s/iter; left time: 10664.8810s
Epoch: 6 cost time: 17.800847053527832
Epoch: 6, Steps: 164 | Train Loss: 0.7782234 Vali Loss: 0.8432942 Test Loss: 1.9599295
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.8174308
	speed: 0.3347s/iter; left time: 10617.0024s
Epoch: 7 cost time: 17.86221742630005
Epoch: 7, Steps: 164 | Train Loss: 0.7782165 Vali Loss: 0.8425218 Test Loss: 1.9603924
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.7716971
	speed: 0.3343s/iter; left time: 10548.6169s
Epoch: 8 cost time: 17.860549449920654
Epoch: 8, Steps: 164 | Train Loss: 0.7782421 Vali Loss: 0.8414550 Test Loss: 1.9598498
Validation loss decreased (0.841646 --> 0.841455).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.7419176
	speed: 0.3383s/iter; left time: 10617.8652s
Epoch: 9 cost time: 17.81993579864502
Epoch: 9, Steps: 164 | Train Loss: 0.7782359 Vali Loss: 0.8435194 Test Loss: 1.9597808
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.8211206
	speed: 0.3342s/iter; left time: 10435.3322s
Epoch: 10 cost time: 17.769918203353882
Epoch: 10, Steps: 164 | Train Loss: 0.7781748 Vali Loss: 0.8440766 Test Loss: 1.9612993
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 11 | loss: 0.7983482
	speed: 0.3369s/iter; left time: 10464.6168s
Epoch: 11 cost time: 17.77576208114624
Epoch: 11, Steps: 164 | Train Loss: 0.7782156 Vali Loss: 0.8419941 Test Loss: 1.9605558
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 0.8288452
	speed: 0.3350s/iter; left time: 10350.6528s
Epoch: 12 cost time: 17.83544158935547
Epoch: 12, Steps: 164 | Train Loss: 0.7782843 Vali Loss: 0.8434394 Test Loss: 1.9608173
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 13 | loss: 0.7266150
	speed: 0.3341s/iter; left time: 10269.1391s
Epoch: 13 cost time: 17.680267572402954
Epoch: 13, Steps: 164 | Train Loss: 0.7782434 Vali Loss: 0.8433980 Test Loss: 1.9604803
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems12_d_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1288
test shape: (1288, 1, 336, 1543) (1288, 1, 336, 1543)
test shape: (1288, 336, 1543) (1288, 336, 1543)
mse:1.9598559141159058, mae:0.6335835456848145
>>>>>>>Overall time: 476 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=1543, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=1543, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1543, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems12_d_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5249
val 477
test 1288
	iters: 100, epoch: 1 | loss: 0.7080932
	speed: 0.0663s/iter; left time: 2168.1951s
Epoch: 1 cost time: 10.537617921829224
Epoch: 1, Steps: 164 | Train Loss: 0.7886741 Vali Loss: 0.8367141 Test Loss: 1.6585995
Validation loss decreased (inf --> 0.836714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7046477
	speed: 0.2025s/iter; left time: 6589.3301s
Epoch: 2 cost time: 10.417095184326172
Epoch: 2, Steps: 164 | Train Loss: 0.7483525 Vali Loss: 0.8338814 Test Loss: 1.6543097
Validation loss decreased (0.836714 --> 0.833881).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7518505
	speed: 0.2027s/iter; left time: 6562.2688s
Epoch: 3 cost time: 10.418094158172607
Epoch: 3, Steps: 164 | Train Loss: 0.7454240 Vali Loss: 0.8271905 Test Loss: 1.6536136
Validation loss decreased (0.833881 --> 0.827190).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8028252
	speed: 0.2000s/iter; left time: 6442.8299s
Epoch: 4 cost time: 10.259318590164185
Epoch: 4, Steps: 164 | Train Loss: 0.7448898 Vali Loss: 0.8277116 Test Loss: 1.6565349
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.7013873
	speed: 0.2004s/iter; left time: 6423.0778s
Epoch: 5 cost time: 10.437233209609985
Epoch: 5, Steps: 164 | Train Loss: 0.7446059 Vali Loss: 0.8275095 Test Loss: 1.6533055
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.6951119
	speed: 0.2014s/iter; left time: 6421.8028s
Epoch: 6 cost time: 10.423436880111694
Epoch: 6, Steps: 164 | Train Loss: 0.7443176 Vali Loss: 0.8290242 Test Loss: 1.6541797
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.7952012
	speed: 0.2022s/iter; left time: 6412.2824s
Epoch: 7 cost time: 10.392353773117065
Epoch: 7, Steps: 164 | Train Loss: 0.7443301 Vali Loss: 0.8281821 Test Loss: 1.6541649
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.7573620
	speed: 0.2007s/iter; left time: 6333.2011s
Epoch: 8 cost time: 10.278191328048706
Epoch: 8, Steps: 164 | Train Loss: 0.7442896 Vali Loss: 0.8258281 Test Loss: 1.6541638
Validation loss decreased (0.827190 --> 0.825828).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6935185
	speed: 0.2023s/iter; left time: 6349.6047s
Epoch: 9 cost time: 10.373379230499268
Epoch: 9, Steps: 164 | Train Loss: 0.7442565 Vali Loss: 0.8289934 Test Loss: 1.6544009
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.8137860
	speed: 0.2019s/iter; left time: 6304.0040s
Epoch: 10 cost time: 10.37242317199707
Epoch: 10, Steps: 164 | Train Loss: 0.7441384 Vali Loss: 0.8313337 Test Loss: 1.6565298
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 11 | loss: 0.7814137
	speed: 0.2013s/iter; left time: 6252.7684s
Epoch: 11 cost time: 10.411181449890137
Epoch: 11, Steps: 164 | Train Loss: 0.7442756 Vali Loss: 0.8282387 Test Loss: 1.6537051
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 0.8189717
	speed: 0.2011s/iter; left time: 6211.8746s
Epoch: 12 cost time: 10.372063398361206
Epoch: 12, Steps: 164 | Train Loss: 0.7441735 Vali Loss: 0.8304482 Test Loss: 1.6545748
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 13 | loss: 0.6977049
	speed: 0.2014s/iter; left time: 6190.0894s
Epoch: 13 cost time: 10.362426042556763
Epoch: 13, Steps: 164 | Train Loss: 0.7441773 Vali Loss: 0.8288211 Test Loss: 1.6542578
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems12_d_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1288
test shape: (1288, 1, 336, 867) (1288, 1, 336, 867)
test shape: (1288, 336, 867) (1288, 336, 867)
mse:1.6541671752929688, mae:0.6749155521392822
>>>>>>>Overall time: 278 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=867, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems12_d.csv', dec_in=867, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=867, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems12_d_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems12_d_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5249
val 477
test 1288
	iters: 100, epoch: 1 | loss: 0.7080932
	speed: 0.0644s/iter; left time: 2104.8940s
Epoch: 1 cost time: 10.306306838989258
Epoch: 1, Steps: 164 | Train Loss: 0.7886741 Vali Loss: 0.8367141 Test Loss: 1.6585995
Validation loss decreased (inf --> 0.836714).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7046477
	speed: 0.1959s/iter; left time: 6372.9841s
Epoch: 2 cost time: 10.140695810317993
Epoch: 2, Steps: 164 | Train Loss: 0.7483525 Vali Loss: 0.8338814 Test Loss: 1.6543097
Validation loss decreased (0.836714 --> 0.833881).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7518505
	speed: 0.1961s/iter; left time: 6349.6437s
Epoch: 3 cost time: 10.170074701309204
Epoch: 3, Steps: 164 | Train Loss: 0.7454240 Vali Loss: 0.8271905 Test Loss: 1.6536136
Validation loss decreased (0.833881 --> 0.827190).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.8028252
	speed: 0.1958s/iter; left time: 6305.1458s
Epoch: 4 cost time: 10.093054056167603
Epoch: 4, Steps: 164 | Train Loss: 0.7448898 Vali Loss: 0.8277116 Test Loss: 1.6565349
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.7013873
	speed: 0.1959s/iter; left time: 6279.1600s
Epoch: 5 cost time: 10.158652782440186
Epoch: 5, Steps: 164 | Train Loss: 0.7446059 Vali Loss: 0.8275095 Test Loss: 1.6533055
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.6951119
	speed: 0.1961s/iter; left time: 6253.1784s
Epoch: 6 cost time: 10.170275926589966
Epoch: 6, Steps: 164 | Train Loss: 0.7443176 Vali Loss: 0.8290242 Test Loss: 1.6541797
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.7952012
	speed: 0.1956s/iter; left time: 6204.3081s
Epoch: 7 cost time: 10.16105580329895
Epoch: 7, Steps: 164 | Train Loss: 0.7443301 Vali Loss: 0.8281821 Test Loss: 1.6541649
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.7573620
	speed: 0.1954s/iter; left time: 6166.0868s
Epoch: 8 cost time: 10.076244115829468
Epoch: 8, Steps: 164 | Train Loss: 0.7442896 Vali Loss: 0.8258281 Test Loss: 1.6541638
Validation loss decreased (0.827190 --> 0.825828).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.6935185
	speed: 0.1956s/iter; left time: 6140.2847s
Epoch: 9 cost time: 10.136091947555542
Epoch: 9, Steps: 164 | Train Loss: 0.7442565 Vali Loss: 0.8289934 Test Loss: 1.6544009
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.8137860
	speed: 0.1961s/iter; left time: 6124.1065s
Epoch: 10 cost time: 10.19580864906311
Epoch: 10, Steps: 164 | Train Loss: 0.7441384 Vali Loss: 0.8313337 Test Loss: 1.6565298
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 11 | loss: 0.7814137
	speed: 0.1958s/iter; left time: 6082.3712s
Epoch: 11 cost time: 10.079768419265747
Epoch: 11, Steps: 164 | Train Loss: 0.7442756 Vali Loss: 0.8282387 Test Loss: 1.6537051
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 0.8189717
	speed: 0.1962s/iter; left time: 6062.3132s
Epoch: 12 cost time: 10.192121982574463
Epoch: 12, Steps: 164 | Train Loss: 0.7441735 Vali Loss: 0.8304482 Test Loss: 1.6545748
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 13 | loss: 0.6977049
	speed: 0.1964s/iter; left time: 6036.3078s
Epoch: 13 cost time: 10.179181575775146
Epoch: 13, Steps: 164 | Train Loss: 0.7441773 Vali Loss: 0.8288211 Test Loss: 1.6542578
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems12_d_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1288
test shape: (1288, 1, 336, 867) (1288, 1, 336, 867)
test shape: (1288, 336, 867) (1288, 336, 867)
mse:1.6541671752929688, mae:0.6749155521392822
>>>>>>>Overall time: 271 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
