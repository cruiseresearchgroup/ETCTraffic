Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_d.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_d_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 3991
val 421
test 1031
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_d.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_d_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 3991
val 421
test 1031
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_d.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_d_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 3991
val 421
test 1031
	iters: 100, epoch: 1 | loss: 0.5924655
	speed: 0.0358s/iter; left time: 85.6583s
	iters: 200, epoch: 1 | loss: 0.7722927
	speed: 0.0303s/iter; left time: 69.3995s
Epoch: 1 cost time: 8.18696141242981
Epoch: 1, Steps: 249 | Train Loss: 0.6675538 Vali Loss: 1.7498137 Test Loss: 1.2860973
Validation loss decreased (inf --> 1.749814).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.7005392
	speed: 0.1053s/iter; left time: 225.5848s
	iters: 200, epoch: 2 | loss: 0.7159235
	speed: 0.0297s/iter; left time: 60.6825s
Epoch: 2 cost time: 7.979775428771973
Epoch: 2, Steps: 249 | Train Loss: 0.6897794 Vali Loss: 2.0606596 Test Loss: 1.4867802
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.7430943
	speed: 0.1040s/iter; left time: 196.8114s
	iters: 200, epoch: 3 | loss: 0.7188966
	speed: 0.0299s/iter; left time: 53.5323s
Epoch: 3 cost time: 7.920955419540405
Epoch: 3, Steps: 249 | Train Loss: 0.7658344 Vali Loss: 1.9466032 Test Loss: 1.4283886
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.7091785
	speed: 0.1027s/iter; left time: 168.7876s
	iters: 200, epoch: 4 | loss: 0.7603626
	speed: 0.0296s/iter; left time: 45.6645s
Epoch: 4 cost time: 7.683289289474487
Epoch: 4, Steps: 249 | Train Loss: 0.7241944 Vali Loss: 1.8882947 Test Loss: 1.4140258
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1031
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=107, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems10_d.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems10_d_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 3991
val 421
test 1031
	iters: 100, epoch: 1 | loss: 0.5924655
	speed: 0.0347s/iter; left time: 82.9268s
	iters: 200, epoch: 1 | loss: 0.7722927
	speed: 0.0303s/iter; left time: 69.3778s
Epoch: 1 cost time: 8.071492910385132
Epoch: 1, Steps: 249 | Train Loss: 0.6675538 Vali Loss: 1.7498137 Test Loss: 1.2860973
Validation loss decreased (inf --> 1.749814).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.7005392
	speed: 0.1028s/iter; left time: 220.2514s
	iters: 200, epoch: 2 | loss: 0.7159235
	speed: 0.0297s/iter; left time: 60.5730s
Epoch: 2 cost time: 7.772919178009033
Epoch: 2, Steps: 249 | Train Loss: 0.6897794 Vali Loss: 2.0606596 Test Loss: 1.4867802
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.7430943
	speed: 0.1008s/iter; left time: 190.8934s
	iters: 200, epoch: 3 | loss: 0.7188966
	speed: 0.0304s/iter; left time: 54.5738s
Epoch: 3 cost time: 7.965588808059692
Epoch: 3, Steps: 249 | Train Loss: 0.7658344 Vali Loss: 1.9466032 Test Loss: 1.4283886
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.7091785
	speed: 0.1005s/iter; left time: 165.1890s
	iters: 200, epoch: 4 | loss: 0.7603626
	speed: 0.0298s/iter; left time: 45.9481s
Epoch: 4 cost time: 7.852420330047607
Epoch: 4, Steps: 249 | Train Loss: 0.7241944 Vali Loss: 1.8882947 Test Loss: 1.4140258
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems10_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1031
