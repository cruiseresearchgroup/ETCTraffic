Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_h.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_h_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 87521
val 12437
test 24965
	iters: 100, epoch: 1 | loss: 0.2389283
	speed: 0.0375s/iter; left time: 2046.0511s
	iters: 200, epoch: 1 | loss: 0.1922575
	speed: 0.0300s/iter; left time: 1632.8348s
	iters: 300, epoch: 1 | loss: 0.1601757
	speed: 0.0301s/iter; left time: 1639.8934s
	iters: 400, epoch: 1 | loss: 0.1745463
	speed: 0.0298s/iter; left time: 1615.9806s
	iters: 500, epoch: 1 | loss: 0.1646366
	speed: 0.0301s/iter; left time: 1632.8145s
	iters: 600, epoch: 1 | loss: 0.0961112
	speed: 0.0297s/iter; left time: 1605.5282s
	iters: 700, epoch: 1 | loss: 0.1518731
	speed: 0.0302s/iter; left time: 1628.2591s
	iters: 800, epoch: 1 | loss: 0.1490769
	speed: 0.0304s/iter; left time: 1638.2019s
	iters: 900, epoch: 1 | loss: 0.1179853
	speed: 0.0296s/iter; left time: 1590.8517s
	iters: 1000, epoch: 1 | loss: 0.2194078
	speed: 0.0289s/iter; left time: 1553.3566s
	iters: 1100, epoch: 1 | loss: 0.1618272
	speed: 0.0299s/iter; left time: 1603.0354s
	iters: 1200, epoch: 1 | loss: 0.1808608
	speed: 0.0296s/iter; left time: 1582.4578s
	iters: 1300, epoch: 1 | loss: 0.4318033
	speed: 0.0296s/iter; left time: 1583.2945s
	iters: 1400, epoch: 1 | loss: 0.2897408
	speed: 0.0302s/iter; left time: 1607.6446s
	iters: 1500, epoch: 1 | loss: 0.2697294
	speed: 0.0298s/iter; left time: 1583.6455s
	iters: 1600, epoch: 1 | loss: 0.3093674
	speed: 0.0294s/iter; left time: 1561.1617s
	iters: 1700, epoch: 1 | loss: 0.2716068
	speed: 0.0294s/iter; left time: 1559.5345s
	iters: 1800, epoch: 1 | loss: 0.2184668
	speed: 0.0298s/iter; left time: 1576.1605s
	iters: 1900, epoch: 1 | loss: 0.2957280
	speed: 0.0297s/iter; left time: 1568.6325s
	iters: 2000, epoch: 1 | loss: 0.4550276
	speed: 0.0298s/iter; left time: 1572.8018s
	iters: 2100, epoch: 1 | loss: 0.6599611
	speed: 0.0302s/iter; left time: 1588.1925s
	iters: 2200, epoch: 1 | loss: 0.5832030
	speed: 0.0293s/iter; left time: 1537.8336s
	iters: 2300, epoch: 1 | loss: 0.6347181
	speed: 0.0296s/iter; left time: 1552.4220s
	iters: 2400, epoch: 1 | loss: 0.5880824
	speed: 0.0297s/iter; left time: 1552.1545s
	iters: 2500, epoch: 1 | loss: 0.4499519
	speed: 0.0305s/iter; left time: 1594.0639s
	iters: 2600, epoch: 1 | loss: 0.4953498
	speed: 0.0307s/iter; left time: 1598.2088s
	iters: 2700, epoch: 1 | loss: 0.3510188
	speed: 0.0304s/iter; left time: 1580.9639s
	iters: 2800, epoch: 1 | loss: 0.3153815
	speed: 0.0310s/iter; left time: 1607.0725s
	iters: 2900, epoch: 1 | loss: 0.2635731
	speed: 0.0303s/iter; left time: 1570.5126s
	iters: 3000, epoch: 1 | loss: 0.2697769
	speed: 0.0305s/iter; left time: 1575.7982s
	iters: 3100, epoch: 1 | loss: 0.2730440
	speed: 0.0304s/iter; left time: 1566.9302s
	iters: 3200, epoch: 1 | loss: 0.2300232
	speed: 0.0299s/iter; left time: 1538.7935s
	iters: 3300, epoch: 1 | loss: 0.2863203
	speed: 0.0292s/iter; left time: 1502.0728s
	iters: 3400, epoch: 1 | loss: 0.2670683
	speed: 0.0300s/iter; left time: 1539.1659s
	iters: 3500, epoch: 1 | loss: 0.3758686
	speed: 0.0295s/iter; left time: 1508.1234s
	iters: 3600, epoch: 1 | loss: 0.3779984
	speed: 0.0300s/iter; left time: 1531.4247s
	iters: 3700, epoch: 1 | loss: 0.3127578
	speed: 0.0307s/iter; left time: 1563.5688s
	iters: 3800, epoch: 1 | loss: 0.2382441
	speed: 0.0318s/iter; left time: 1616.5656s
	iters: 3900, epoch: 1 | loss: 0.2500612
	speed: 0.0305s/iter; left time: 1550.3590s
	iters: 4000, epoch: 1 | loss: 0.2962302
	speed: 0.0306s/iter; left time: 1549.7536s
	iters: 4100, epoch: 1 | loss: 0.2396700
	speed: 0.0305s/iter; left time: 1545.6600s
	iters: 4200, epoch: 1 | loss: 0.2926036
	speed: 0.0310s/iter; left time: 1564.2735s
	iters: 4300, epoch: 1 | loss: 0.2942424
	speed: 0.0305s/iter; left time: 1536.8310s
	iters: 4400, epoch: 1 | loss: 0.3201748
	speed: 0.0301s/iter; left time: 1515.2579s
	iters: 4500, epoch: 1 | loss: 0.2637351
	speed: 0.0302s/iter; left time: 1516.0518s
	iters: 4600, epoch: 1 | loss: 0.2934726
	speed: 0.0304s/iter; left time: 1521.1797s
	iters: 4700, epoch: 1 | loss: 0.2763728
	speed: 0.0301s/iter; left time: 1506.8484s
	iters: 4800, epoch: 1 | loss: 0.2675514
	speed: 0.0304s/iter; left time: 1518.8949s
	iters: 4900, epoch: 1 | loss: 0.2872482
	speed: 0.0321s/iter; left time: 1600.8408s
	iters: 5000, epoch: 1 | loss: 0.2510107
	speed: 0.0321s/iter; left time: 1595.9307s
	iters: 5100, epoch: 1 | loss: 0.2797602
	speed: 0.0351s/iter; left time: 1738.8442s
	iters: 5200, epoch: 1 | loss: 0.3040670
	speed: 0.0341s/iter; left time: 1690.1879s
	iters: 5300, epoch: 1 | loss: 0.2821043
	speed: 0.0321s/iter; left time: 1583.4216s
	iters: 5400, epoch: 1 | loss: 0.2945526
	speed: 0.0312s/iter; left time: 1536.7738s
Epoch: 1 cost time: 167.04180884361267
Epoch: 1, Steps: 5470 | Train Loss: 0.2949109 Vali Loss: 0.1925265 Test Loss: 0.2789640
Validation loss decreased (inf --> 0.192526).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2740383
	speed: 1.1250s/iter; left time: 55271.8652s
	iters: 200, epoch: 2 | loss: 0.2910857
	speed: 0.0294s/iter; left time: 1440.5629s
	iters: 300, epoch: 2 | loss: 0.3151634
	speed: 0.0302s/iter; left time: 1478.6207s
	iters: 400, epoch: 2 | loss: 0.2748237
	speed: 0.0301s/iter; left time: 1468.1697s
	iters: 500, epoch: 2 | loss: 0.3797715
	speed: 0.0306s/iter; left time: 1492.8823s
	iters: 600, epoch: 2 | loss: 0.5037041
	speed: 0.0310s/iter; left time: 1505.8757s
	iters: 700, epoch: 2 | loss: 0.3419408
	speed: 0.0310s/iter; left time: 1502.3588s
	iters: 800, epoch: 2 | loss: 0.4036284
	speed: 0.0320s/iter; left time: 1550.5709s
	iters: 900, epoch: 2 | loss: 0.2223574
	speed: 0.0300s/iter; left time: 1448.4052s
	iters: 1000, epoch: 2 | loss: 0.2382181
	speed: 0.0296s/iter; left time: 1429.0325s
	iters: 1100, epoch: 2 | loss: 0.2347323
	speed: 0.0302s/iter; left time: 1451.9296s
	iters: 1200, epoch: 2 | loss: 0.3242062
	speed: 0.0329s/iter; left time: 1579.8522s
	iters: 1300, epoch: 2 | loss: 0.2079898
	speed: 0.0310s/iter; left time: 1485.5067s
	iters: 1400, epoch: 2 | loss: 0.2566955
	speed: 0.0305s/iter; left time: 1457.8822s
	iters: 1500, epoch: 2 | loss: 0.2213022
	speed: 0.0305s/iter; left time: 1456.6115s
	iters: 1600, epoch: 2 | loss: 0.2286243
	speed: 0.0299s/iter; left time: 1425.1214s
	iters: 1700, epoch: 2 | loss: 0.3414022
	speed: 0.0297s/iter; left time: 1411.3438s
	iters: 1800, epoch: 2 | loss: 0.3073079
	speed: 0.0303s/iter; left time: 1437.7186s
	iters: 1900, epoch: 2 | loss: 0.2586530
	speed: 0.0301s/iter; left time: 1424.6251s
	iters: 2000, epoch: 2 | loss: 0.2846064
	speed: 0.0297s/iter; left time: 1403.0457s
	iters: 2100, epoch: 2 | loss: 0.2663963
	speed: 0.0294s/iter; left time: 1384.3701s
	iters: 2200, epoch: 2 | loss: 0.2444464
	speed: 0.0305s/iter; left time: 1436.5201s
	iters: 2300, epoch: 2 | loss: 0.3625160
	speed: 0.0302s/iter; left time: 1415.3490s
	iters: 2400, epoch: 2 | loss: 0.4842340
	speed: 0.0293s/iter; left time: 1373.4192s
	iters: 2500, epoch: 2 | loss: 0.4375521
	speed: 0.0298s/iter; left time: 1394.6302s
	iters: 2600, epoch: 2 | loss: 0.3938543
	speed: 0.0294s/iter; left time: 1370.3271s
	iters: 2700, epoch: 2 | loss: 0.2787646
	speed: 0.0290s/iter; left time: 1351.2387s
	iters: 2800, epoch: 2 | loss: 0.2903775
	speed: 0.0298s/iter; left time: 1382.9747s
	iters: 2900, epoch: 2 | loss: 0.2354707
	speed: 0.0293s/iter; left time: 1356.2761s
	iters: 3000, epoch: 2 | loss: 0.2321931
	speed: 0.0291s/iter; left time: 1347.4355s
	iters: 3100, epoch: 2 | loss: 0.3499308
	speed: 0.0300s/iter; left time: 1384.4263s
	iters: 3200, epoch: 2 | loss: 0.4168840
	speed: 0.0299s/iter; left time: 1377.9454s
	iters: 3300, epoch: 2 | loss: 0.2617920
	speed: 0.0300s/iter; left time: 1377.2826s
	iters: 3400, epoch: 2 | loss: 0.2774107
	speed: 0.0292s/iter; left time: 1339.1404s
	iters: 3500, epoch: 2 | loss: 0.3046618
	speed: 0.0294s/iter; left time: 1344.6339s
	iters: 3600, epoch: 2 | loss: 0.3043509
	speed: 0.0298s/iter; left time: 1359.3109s
	iters: 3700, epoch: 2 | loss: 0.3346750
	speed: 0.0292s/iter; left time: 1331.6159s
	iters: 3800, epoch: 2 | loss: 0.2451720
	speed: 0.0293s/iter; left time: 1332.9818s
	iters: 3900, epoch: 2 | loss: 0.3905538
	speed: 0.0294s/iter; left time: 1334.9575s
	iters: 4000, epoch: 2 | loss: 0.2568322
	speed: 0.0295s/iter; left time: 1334.4715s
	iters: 4100, epoch: 2 | loss: 0.3410249
	speed: 0.0297s/iter; left time: 1341.7127s
	iters: 4200, epoch: 2 | loss: 0.2790710
	speed: 0.0304s/iter; left time: 1368.8867s
	iters: 4300, epoch: 2 | loss: 0.3511460
	speed: 0.0298s/iter; left time: 1340.0604s
	iters: 4400, epoch: 2 | loss: 0.3300943
	speed: 0.0296s/iter; left time: 1328.8606s
	iters: 4500, epoch: 2 | loss: 0.2536126
	speed: 0.0289s/iter; left time: 1292.4871s
	iters: 4600, epoch: 2 | loss: 0.3018076
	speed: 0.0297s/iter; left time: 1325.8107s
	iters: 4700, epoch: 2 | loss: 0.3280004
	speed: 0.0297s/iter; left time: 1322.9091s
	iters: 4800, epoch: 2 | loss: 0.2396649
	speed: 0.0303s/iter; left time: 1346.0735s
	iters: 4900, epoch: 2 | loss: 0.2866839
	speed: 0.0303s/iter; left time: 1342.6186s
	iters: 5000, epoch: 2 | loss: 0.6862964
	speed: 0.0300s/iter; left time: 1328.6873s
	iters: 5100, epoch: 2 | loss: 0.2751616
	speed: 0.0304s/iter; left time: 1340.8846s
	iters: 5200, epoch: 2 | loss: 0.2544146
	speed: 0.0305s/iter; left time: 1341.8553s
	iters: 5300, epoch: 2 | loss: 0.2735977
	speed: 0.0294s/iter; left time: 1293.0793s
	iters: 5400, epoch: 2 | loss: 0.2495939
	speed: 0.0295s/iter; left time: 1291.4920s
Epoch: 2 cost time: 164.6999635696411
Epoch: 2, Steps: 5470 | Train Loss: 0.2910032 Vali Loss: 0.2023865 Test Loss: 0.3067504
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2662846
	speed: 1.1233s/iter; left time: 49044.4319s
	iters: 200, epoch: 3 | loss: 0.2956277
	speed: 0.0298s/iter; left time: 1296.5164s
	iters: 300, epoch: 3 | loss: 0.2710655
	speed: 0.0300s/iter; left time: 1304.9355s
	iters: 400, epoch: 3 | loss: 0.2187765
	speed: 0.0294s/iter; left time: 1274.4813s
	iters: 500, epoch: 3 | loss: 0.2372244
	speed: 0.0298s/iter; left time: 1290.1805s
	iters: 600, epoch: 3 | loss: 0.2308116
	speed: 0.0290s/iter; left time: 1252.5289s
	iters: 700, epoch: 3 | loss: 0.2294964
	speed: 0.0296s/iter; left time: 1273.4484s
	iters: 800, epoch: 3 | loss: 0.2482692
	speed: 0.0294s/iter; left time: 1263.5081s
	iters: 900, epoch: 3 | loss: 0.2435966
	speed: 0.0301s/iter; left time: 1288.5531s
	iters: 1000, epoch: 3 | loss: 0.3100151
	speed: 0.0300s/iter; left time: 1281.0768s
	iters: 1100, epoch: 3 | loss: 0.3182521
	speed: 0.0294s/iter; left time: 1254.7128s
	iters: 1200, epoch: 3 | loss: 0.2516658
	speed: 0.0296s/iter; left time: 1259.2735s
	iters: 1300, epoch: 3 | loss: 0.3439587
	speed: 0.0305s/iter; left time: 1294.7673s
	iters: 1400, epoch: 3 | loss: 0.2219076
	speed: 0.0302s/iter; left time: 1279.0866s
	iters: 1500, epoch: 3 | loss: 0.2512029
	speed: 0.0297s/iter; left time: 1253.5962s
	iters: 1600, epoch: 3 | loss: 0.3294472
	speed: 0.0298s/iter; left time: 1257.2930s
	iters: 1700, epoch: 3 | loss: 0.2698554
	speed: 0.0299s/iter; left time: 1256.8672s
	iters: 1800, epoch: 3 | loss: 0.2961358
	speed: 0.0302s/iter; left time: 1268.7446s
	iters: 1900, epoch: 3 | loss: 0.4226140
	speed: 0.0301s/iter; left time: 1261.4352s
	iters: 2000, epoch: 3 | loss: 0.2430971
	speed: 0.0302s/iter; left time: 1263.0839s
	iters: 2100, epoch: 3 | loss: 0.2488690
	speed: 0.0304s/iter; left time: 1267.7617s
	iters: 2200, epoch: 3 | loss: 0.2464098
	speed: 0.0292s/iter; left time: 1211.5923s
	iters: 2300, epoch: 3 | loss: 0.2236180
	speed: 0.0284s/iter; left time: 1178.1955s
	iters: 2400, epoch: 3 | loss: 0.2474197
	speed: 0.0295s/iter; left time: 1221.3408s
	iters: 2500, epoch: 3 | loss: 0.2914388
	speed: 0.0295s/iter; left time: 1216.0906s
	iters: 2600, epoch: 3 | loss: 0.2365533
	speed: 0.0300s/iter; left time: 1235.9291s
	iters: 2700, epoch: 3 | loss: 0.3122698
	speed: 0.0295s/iter; left time: 1212.9732s
	iters: 2800, epoch: 3 | loss: 0.2523670
	speed: 0.0299s/iter; left time: 1223.5530s
	iters: 2900, epoch: 3 | loss: 0.2256957
	speed: 0.0303s/iter; left time: 1236.8080s
	iters: 3000, epoch: 3 | loss: 0.2357100
	speed: 0.0300s/iter; left time: 1221.4705s
	iters: 3100, epoch: 3 | loss: 0.2864881
	speed: 0.0301s/iter; left time: 1224.1268s
	iters: 3200, epoch: 3 | loss: 0.3289300
	speed: 0.0302s/iter; left time: 1224.4625s
	iters: 3300, epoch: 3 | loss: 0.2229078
	speed: 0.0303s/iter; left time: 1227.1839s
	iters: 3400, epoch: 3 | loss: 0.2931261
	speed: 0.0304s/iter; left time: 1226.6717s
	iters: 3500, epoch: 3 | loss: 0.2215645
	speed: 0.0297s/iter; left time: 1196.5905s
	iters: 3600, epoch: 3 | loss: 0.2752172
	speed: 0.0301s/iter; left time: 1210.3442s
	iters: 3700, epoch: 3 | loss: 0.2615343
	speed: 0.0296s/iter; left time: 1184.3443s
	iters: 3800, epoch: 3 | loss: 0.2322201
	speed: 0.0299s/iter; left time: 1195.7098s
	iters: 3900, epoch: 3 | loss: 0.3206456
	speed: 0.0288s/iter; left time: 1148.3052s
	iters: 4000, epoch: 3 | loss: 0.4586086
	speed: 0.0299s/iter; left time: 1190.5772s
	iters: 4100, epoch: 3 | loss: 0.2126161
	speed: 0.0298s/iter; left time: 1182.0935s
	iters: 4200, epoch: 3 | loss: 0.2201904
	speed: 0.0304s/iter; left time: 1203.6428s
	iters: 4300, epoch: 3 | loss: 0.3036233
	speed: 0.0291s/iter; left time: 1147.9804s
	iters: 4400, epoch: 3 | loss: 0.2672833
	speed: 0.0296s/iter; left time: 1165.2553s
	iters: 4500, epoch: 3 | loss: 0.2511358
	speed: 0.0286s/iter; left time: 1122.1613s
	iters: 4600, epoch: 3 | loss: 0.2308306
	speed: 0.0284s/iter; left time: 1113.1023s
	iters: 4700, epoch: 3 | loss: 0.2708698
	speed: 0.0292s/iter; left time: 1141.0973s
	iters: 4800, epoch: 3 | loss: 0.2505921
	speed: 0.0296s/iter; left time: 1154.0937s
	iters: 4900, epoch: 3 | loss: 0.3259280
	speed: 0.0296s/iter; left time: 1149.5129s
	iters: 5000, epoch: 3 | loss: 0.3187529
	speed: 0.0299s/iter; left time: 1159.8460s
	iters: 5100, epoch: 3 | loss: 0.2921588
	speed: 0.0292s/iter; left time: 1129.4625s
	iters: 5200, epoch: 3 | loss: 0.2171998
	speed: 0.0295s/iter; left time: 1137.5742s
	iters: 5300, epoch: 3 | loss: 0.3036646
	speed: 0.0290s/iter; left time: 1115.1182s
	iters: 5400, epoch: 3 | loss: 0.2274611
	speed: 0.0290s/iter; left time: 1112.0152s
Epoch: 3 cost time: 163.04968333244324
Epoch: 3, Steps: 5470 | Train Loss: 0.2714050 Vali Loss: 0.1867050 Test Loss: 0.2757998
Validation loss decreased (0.192526 --> 0.186705).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2532364
	speed: 1.1239s/iter; left time: 42922.7496s
	iters: 200, epoch: 4 | loss: 0.2438495
	speed: 0.0295s/iter; left time: 1123.5877s
	iters: 300, epoch: 4 | loss: 0.2178356
	speed: 0.0292s/iter; left time: 1109.4141s
	iters: 400, epoch: 4 | loss: 0.2175951
	speed: 0.0288s/iter; left time: 1092.5400s
	iters: 500, epoch: 4 | loss: 0.1947343
	speed: 0.0302s/iter; left time: 1142.6948s
	iters: 600, epoch: 4 | loss: 0.2817971
	speed: 0.0303s/iter; left time: 1141.6505s
	iters: 700, epoch: 4 | loss: 0.2163311
	speed: 0.0297s/iter; left time: 1116.1878s
	iters: 800, epoch: 4 | loss: 0.2049565
	speed: 0.0293s/iter; left time: 1097.1544s
	iters: 900, epoch: 4 | loss: 0.2220573
	speed: 0.0287s/iter; left time: 1073.3896s
	iters: 1000, epoch: 4 | loss: 0.2192026
	speed: 0.0293s/iter; left time: 1090.9176s
	iters: 1100, epoch: 4 | loss: 0.3261022
	speed: 0.0291s/iter; left time: 1081.3705s
	iters: 1200, epoch: 4 | loss: 0.2441009
	speed: 0.0296s/iter; left time: 1099.3320s
	iters: 1300, epoch: 4 | loss: 0.2529981
	speed: 0.0297s/iter; left time: 1099.1740s
	iters: 1400, epoch: 4 | loss: 0.2993297
	speed: 0.0289s/iter; left time: 1067.1997s
	iters: 1500, epoch: 4 | loss: 0.2910760
	speed: 0.0300s/iter; left time: 1101.9218s
	iters: 1600, epoch: 4 | loss: 0.2402918
	speed: 0.0296s/iter; left time: 1087.4750s
	iters: 1700, epoch: 4 | loss: 0.2633436
	speed: 0.0291s/iter; left time: 1063.4256s
	iters: 1800, epoch: 4 | loss: 0.2223123
	speed: 0.0297s/iter; left time: 1083.1701s
	iters: 1900, epoch: 4 | loss: 0.2303047
	speed: 0.0289s/iter; left time: 1050.9683s
	iters: 2000, epoch: 4 | loss: 0.3290795
	speed: 0.0294s/iter; left time: 1067.1774s
	iters: 2100, epoch: 4 | loss: 0.2686724
	speed: 0.0305s/iter; left time: 1102.5702s
	iters: 2200, epoch: 4 | loss: 0.2344704
	speed: 0.0298s/iter; left time: 1076.1287s
	iters: 2300, epoch: 4 | loss: 0.2566710
	speed: 0.0300s/iter; left time: 1080.7978s
	iters: 2400, epoch: 4 | loss: 0.2276305
	speed: 0.0296s/iter; left time: 1060.6617s
	iters: 2500, epoch: 4 | loss: 0.3939370
	speed: 0.0305s/iter; left time: 1089.9146s
	iters: 2600, epoch: 4 | loss: 0.2698241
	speed: 0.0300s/iter; left time: 1071.1904s
	iters: 2700, epoch: 4 | loss: 0.2429263
	speed: 0.0305s/iter; left time: 1083.8117s
	iters: 2800, epoch: 4 | loss: 0.3220900
	speed: 0.0299s/iter; left time: 1059.8650s
	iters: 2900, epoch: 4 | loss: 0.2603976
	speed: 0.0303s/iter; left time: 1072.8884s
	iters: 3000, epoch: 4 | loss: 0.2055584
	speed: 0.0299s/iter; left time: 1056.0001s
	iters: 3100, epoch: 4 | loss: 0.2537981
	speed: 0.0302s/iter; left time: 1061.2033s
	iters: 3200, epoch: 4 | loss: 0.2766505
	speed: 0.0294s/iter; left time: 1031.1715s
	iters: 3300, epoch: 4 | loss: 0.2528422
	speed: 0.0299s/iter; left time: 1045.8505s
	iters: 3400, epoch: 4 | loss: 0.2828251
	speed: 0.0304s/iter; left time: 1061.8779s
	iters: 3500, epoch: 4 | loss: 0.2533248
	speed: 0.0304s/iter; left time: 1058.9003s
	iters: 3600, epoch: 4 | loss: 0.2198686
	speed: 0.0299s/iter; left time: 1037.0396s
	iters: 3700, epoch: 4 | loss: 0.2963429
	speed: 0.0300s/iter; left time: 1038.5194s
	iters: 3800, epoch: 4 | loss: 0.2486775
	speed: 0.0299s/iter; left time: 1030.8811s
	iters: 3900, epoch: 4 | loss: 0.2557706
	speed: 0.0300s/iter; left time: 1030.6024s
	iters: 4000, epoch: 4 | loss: 0.2504885
	speed: 0.0296s/iter; left time: 1015.7472s
	iters: 4100, epoch: 4 | loss: 0.2613643
	speed: 0.0292s/iter; left time: 998.0676s
	iters: 4200, epoch: 4 | loss: 0.2508614
	speed: 0.0293s/iter; left time: 1000.0743s
	iters: 4300, epoch: 4 | loss: 0.2703440
	speed: 0.0304s/iter; left time: 1033.6746s
	iters: 4400, epoch: 4 | loss: 0.2072566
	speed: 0.0306s/iter; left time: 1037.6953s
	iters: 4500, epoch: 4 | loss: 0.2898944
	speed: 0.0303s/iter; left time: 1025.5167s
	iters: 4600, epoch: 4 | loss: 0.2541376
	speed: 0.0297s/iter; left time: 1000.6896s
	iters: 4700, epoch: 4 | loss: 0.2051289
	speed: 0.0303s/iter; left time: 1017.4933s
	iters: 4800, epoch: 4 | loss: 0.2447095
	speed: 0.0304s/iter; left time: 1018.6363s
	iters: 4900, epoch: 4 | loss: 0.3278919
	speed: 0.0301s/iter; left time: 1004.4413s
	iters: 5000, epoch: 4 | loss: 0.2833351
	speed: 0.0300s/iter; left time: 999.6933s
	iters: 5100, epoch: 4 | loss: 0.2619539
	speed: 0.0296s/iter; left time: 983.4735s
	iters: 5200, epoch: 4 | loss: 0.2277597
	speed: 0.0301s/iter; left time: 996.4274s
	iters: 5300, epoch: 4 | loss: 0.2120310
	speed: 0.0301s/iter; left time: 993.3833s
	iters: 5400, epoch: 4 | loss: 0.3110437
	speed: 0.0301s/iter; left time: 990.2362s
Epoch: 4 cost time: 163.8644664287567
Epoch: 4, Steps: 5470 | Train Loss: 0.2596671 Vali Loss: 0.2049446 Test Loss: 0.3021123
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2414455
	speed: 1.1205s/iter; left time: 36664.2008s
	iters: 200, epoch: 5 | loss: 0.2688887
	speed: 0.0296s/iter; left time: 964.9268s
	iters: 300, epoch: 5 | loss: 0.2291007
	speed: 0.0297s/iter; left time: 965.0007s
	iters: 400, epoch: 5 | loss: 0.2042758
	speed: 0.0300s/iter; left time: 972.9915s
	iters: 500, epoch: 5 | loss: 0.3124218
	speed: 0.0296s/iter; left time: 956.5519s
	iters: 600, epoch: 5 | loss: 0.2090601
	speed: 0.0293s/iter; left time: 945.0675s
	iters: 700, epoch: 5 | loss: 0.3184964
	speed: 0.0301s/iter; left time: 968.1589s
	iters: 800, epoch: 5 | loss: 0.2329403
	speed: 0.0296s/iter; left time: 948.3245s
	iters: 900, epoch: 5 | loss: 0.2361360
	speed: 0.0299s/iter; left time: 955.3053s
	iters: 1000, epoch: 5 | loss: 0.2058985
	speed: 0.0303s/iter; left time: 965.3505s
	iters: 1100, epoch: 5 | loss: 0.2090530
	speed: 0.0304s/iter; left time: 964.4693s
	iters: 1200, epoch: 5 | loss: 0.2248180
	speed: 0.0296s/iter; left time: 934.7164s
	iters: 1300, epoch: 5 | loss: 0.2305810
	speed: 0.0302s/iter; left time: 952.2313s
	iters: 1400, epoch: 5 | loss: 0.3012187
	speed: 0.0299s/iter; left time: 938.5878s
	iters: 1500, epoch: 5 | loss: 0.2855800
	speed: 0.0301s/iter; left time: 941.8877s
	iters: 1600, epoch: 5 | loss: 0.2090795
	speed: 0.0304s/iter; left time: 950.3546s
	iters: 1700, epoch: 5 | loss: 0.2931155
	speed: 0.0292s/iter; left time: 908.9053s
	iters: 1800, epoch: 5 | loss: 0.3023711
	speed: 0.0294s/iter; left time: 912.2364s
	iters: 1900, epoch: 5 | loss: 0.2008597
	speed: 0.0301s/iter; left time: 929.7841s
	iters: 2000, epoch: 5 | loss: 0.2094624
	speed: 0.0305s/iter; left time: 938.6428s
	iters: 2100, epoch: 5 | loss: 0.2587841
	speed: 0.0286s/iter; left time: 878.6908s
	iters: 2200, epoch: 5 | loss: 0.2595928
	speed: 0.0287s/iter; left time: 880.2682s
	iters: 2300, epoch: 5 | loss: 0.2338633
	speed: 0.0294s/iter; left time: 897.1685s
	iters: 2400, epoch: 5 | loss: 0.2385179
	speed: 0.0290s/iter; left time: 883.6403s
	iters: 2500, epoch: 5 | loss: 0.2660936
	speed: 0.0298s/iter; left time: 903.6301s
	iters: 2600, epoch: 5 | loss: 0.3175347
	speed: 0.0300s/iter; left time: 905.9538s
	iters: 2700, epoch: 5 | loss: 0.2234033
	speed: 0.0301s/iter; left time: 905.3620s
	iters: 2800, epoch: 5 | loss: 0.3578147
	speed: 0.0304s/iter; left time: 913.4075s
	iters: 2900, epoch: 5 | loss: 0.2487469
	speed: 0.0303s/iter; left time: 905.7642s
	iters: 3000, epoch: 5 | loss: 0.4072194
	speed: 0.0294s/iter; left time: 877.8178s
	iters: 3100, epoch: 5 | loss: 0.2692575
	speed: 0.0303s/iter; left time: 899.5349s
	iters: 3200, epoch: 5 | loss: 0.3239362
	speed: 0.0295s/iter; left time: 873.5074s
	iters: 3300, epoch: 5 | loss: 0.2339781
	speed: 0.0298s/iter; left time: 879.2935s
	iters: 3400, epoch: 5 | loss: 0.2234721
	speed: 0.0302s/iter; left time: 888.4010s
	iters: 3500, epoch: 5 | loss: 0.2420282
	speed: 0.0300s/iter; left time: 880.1367s
	iters: 3600, epoch: 5 | loss: 0.3000091
	speed: 0.0297s/iter; left time: 867.2246s
	iters: 3700, epoch: 5 | loss: 0.1761708
	speed: 0.0302s/iter; left time: 879.4891s
	iters: 3800, epoch: 5 | loss: 0.2889144
	speed: 0.0294s/iter; left time: 852.1422s
	iters: 3900, epoch: 5 | loss: 0.2215196
	speed: 0.0288s/iter; left time: 833.9382s
	iters: 4000, epoch: 5 | loss: 0.2985258
	speed: 0.0297s/iter; left time: 857.1565s
	iters: 4100, epoch: 5 | loss: 0.2839028
	speed: 0.0283s/iter; left time: 813.7796s
	iters: 4200, epoch: 5 | loss: 0.3231828
	speed: 0.0292s/iter; left time: 835.3321s
	iters: 4300, epoch: 5 | loss: 0.2871833
	speed: 0.0289s/iter; left time: 824.4090s
	iters: 4400, epoch: 5 | loss: 0.2387204
	speed: 0.0297s/iter; left time: 844.1592s
	iters: 4500, epoch: 5 | loss: 0.1925682
	speed: 0.0298s/iter; left time: 844.1336s
	iters: 4600, epoch: 5 | loss: 0.2404787
	speed: 0.0294s/iter; left time: 829.2609s
	iters: 4700, epoch: 5 | loss: 0.2246288
	speed: 0.0293s/iter; left time: 824.3458s
	iters: 4800, epoch: 5 | loss: 0.5468073
	speed: 0.0299s/iter; left time: 839.1863s
	iters: 4900, epoch: 5 | loss: 0.2014383
	speed: 0.0304s/iter; left time: 848.2226s
	iters: 5000, epoch: 5 | loss: 0.3894675
	speed: 0.0296s/iter; left time: 824.4927s
	iters: 5100, epoch: 5 | loss: 0.2595587
	speed: 0.0298s/iter; left time: 826.5251s
	iters: 5200, epoch: 5 | loss: 0.2323698
	speed: 0.0295s/iter; left time: 813.6284s
	iters: 5300, epoch: 5 | loss: 0.2265523
	speed: 0.0290s/iter; left time: 798.7466s
	iters: 5400, epoch: 5 | loss: 0.2683619
	speed: 0.0294s/iter; left time: 805.3302s
Epoch: 5 cost time: 163.08649682998657
Epoch: 5, Steps: 5470 | Train Loss: 0.2601407 Vali Loss: 0.1811264 Test Loss: 0.2734260
Validation loss decreased (0.186705 --> 0.181126).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2349062
	speed: 1.1191s/iter; left time: 30497.5142s
	iters: 200, epoch: 6 | loss: 0.2180097
	speed: 0.0292s/iter; left time: 792.7208s
	iters: 300, epoch: 6 | loss: 0.2345653
	speed: 0.0291s/iter; left time: 787.5670s
	iters: 400, epoch: 6 | loss: 0.3070574
	speed: 0.0297s/iter; left time: 801.3987s
	iters: 500, epoch: 6 | loss: 0.2180616
	speed: 0.0296s/iter; left time: 794.4537s
	iters: 600, epoch: 6 | loss: 0.2592781
	speed: 0.0304s/iter; left time: 812.6333s
	iters: 700, epoch: 6 | loss: 0.2399549
	speed: 0.0299s/iter; left time: 796.3859s
	iters: 800, epoch: 6 | loss: 0.2263056
	speed: 0.0303s/iter; left time: 803.7738s
	iters: 900, epoch: 6 | loss: 0.1970239
	speed: 0.0300s/iter; left time: 794.7122s
	iters: 1000, epoch: 6 | loss: 0.2943410
	speed: 0.0304s/iter; left time: 801.3670s
	iters: 1100, epoch: 6 | loss: 0.2124144
	speed: 0.0300s/iter; left time: 788.7570s
	iters: 1200, epoch: 6 | loss: 0.2456820
	speed: 0.0304s/iter; left time: 794.8176s
	iters: 1300, epoch: 6 | loss: 0.2457537
	speed: 0.0299s/iter; left time: 779.9411s
	iters: 1400, epoch: 6 | loss: 0.2687042
	speed: 0.0293s/iter; left time: 760.1723s
	iters: 1500, epoch: 6 | loss: 0.2391268
	speed: 0.0287s/iter; left time: 742.9338s
	iters: 1600, epoch: 6 | loss: 0.2452660
	speed: 0.0294s/iter; left time: 758.2052s
	iters: 1700, epoch: 6 | loss: 0.2273067
	speed: 0.0297s/iter; left time: 761.4072s
	iters: 1800, epoch: 6 | loss: 0.2224768
	speed: 0.0289s/iter; left time: 738.4624s
	iters: 1900, epoch: 6 | loss: 0.2264631
	speed: 0.0302s/iter; left time: 767.7993s
	iters: 2000, epoch: 6 | loss: 0.3080472
	speed: 0.0292s/iter; left time: 739.3436s
	iters: 2100, epoch: 6 | loss: 0.2772308
	speed: 0.0287s/iter; left time: 724.5977s
	iters: 2200, epoch: 6 | loss: 0.2242481
	speed: 0.0294s/iter; left time: 738.9020s
	iters: 2300, epoch: 6 | loss: 0.2533055
	speed: 0.0301s/iter; left time: 754.7351s
	iters: 2400, epoch: 6 | loss: 0.2930994
	speed: 0.0300s/iter; left time: 748.2282s
	iters: 2500, epoch: 6 | loss: 0.2290295
	speed: 0.0291s/iter; left time: 723.1489s
	iters: 2600, epoch: 6 | loss: 0.1903008
	speed: 0.0287s/iter; left time: 709.6782s
	iters: 2700, epoch: 6 | loss: 0.2974882
	speed: 0.0290s/iter; left time: 715.3166s
	iters: 2800, epoch: 6 | loss: 0.2564449
	speed: 0.0292s/iter; left time: 717.9575s
	iters: 2900, epoch: 6 | loss: 0.2471057
	speed: 0.0289s/iter; left time: 705.4739s
	iters: 3000, epoch: 6 | loss: 0.2194499
	speed: 0.0289s/iter; left time: 703.2894s
	iters: 3100, epoch: 6 | loss: 0.2616667
	speed: 0.0287s/iter; left time: 696.4026s
	iters: 3200, epoch: 6 | loss: 0.2135797
	speed: 0.0289s/iter; left time: 698.7393s
	iters: 3300, epoch: 6 | loss: 0.2884365
	speed: 0.0294s/iter; left time: 706.6492s
	iters: 3400, epoch: 6 | loss: 0.3334449
	speed: 0.0297s/iter; left time: 711.5083s
	iters: 3500, epoch: 6 | loss: 0.2352716
	speed: 0.0297s/iter; left time: 708.5176s
	iters: 3600, epoch: 6 | loss: 0.3760047
	speed: 0.0290s/iter; left time: 689.5009s
	iters: 3700, epoch: 6 | loss: 0.2930190
	speed: 0.0298s/iter; left time: 705.9429s
	iters: 3800, epoch: 6 | loss: 0.2421508
	speed: 0.0302s/iter; left time: 711.1831s
	iters: 3900, epoch: 6 | loss: 0.2243420
	speed: 0.0300s/iter; left time: 704.2315s
	iters: 4000, epoch: 6 | loss: 0.2183888
	speed: 0.0305s/iter; left time: 711.2172s
	iters: 4100, epoch: 6 | loss: 0.2173843
	speed: 0.0305s/iter; left time: 708.4737s
	iters: 4200, epoch: 6 | loss: 0.1892428
	speed: 0.0293s/iter; left time: 677.9317s
	iters: 4300, epoch: 6 | loss: 0.2182766
	speed: 0.0286s/iter; left time: 660.2939s
	iters: 4400, epoch: 6 | loss: 0.2257154
	speed: 0.0291s/iter; left time: 667.1228s
	iters: 4500, epoch: 6 | loss: 0.2430588
	speed: 0.0294s/iter; left time: 671.9491s
	iters: 4600, epoch: 6 | loss: 0.2632267
	speed: 0.0297s/iter; left time: 675.5695s
	iters: 4700, epoch: 6 | loss: 0.2976636
	speed: 0.0302s/iter; left time: 683.0198s
	iters: 4800, epoch: 6 | loss: 0.2025856
	speed: 0.0294s/iter; left time: 663.8710s
	iters: 4900, epoch: 6 | loss: 0.2844714
	speed: 0.0298s/iter; left time: 669.0835s
	iters: 5000, epoch: 6 | loss: 0.2375330
	speed: 0.0305s/iter; left time: 681.2100s
	iters: 5100, epoch: 6 | loss: 0.1863838
	speed: 0.0305s/iter; left time: 678.9719s
	iters: 5200, epoch: 6 | loss: 0.2300830
	speed: 0.0295s/iter; left time: 653.4980s
	iters: 5300, epoch: 6 | loss: 0.2707011
	speed: 0.0301s/iter; left time: 662.6546s
	iters: 5400, epoch: 6 | loss: 0.2181681
	speed: 0.0298s/iter; left time: 654.4253s
Epoch: 6 cost time: 162.5818452835083
Epoch: 6, Steps: 5470 | Train Loss: 0.2571032 Vali Loss: 0.1834948 Test Loss: 0.2713579
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2481483
	speed: 1.1180s/iter; left time: 24351.1364s
	iters: 200, epoch: 7 | loss: 0.2652000
	speed: 0.0304s/iter; left time: 658.1997s
	iters: 300, epoch: 7 | loss: 0.2164484
	speed: 0.0293s/iter; left time: 631.7955s
	iters: 400, epoch: 7 | loss: 0.2793506
	speed: 0.0302s/iter; left time: 648.6322s
	iters: 500, epoch: 7 | loss: 0.2249859
	speed: 0.0303s/iter; left time: 647.2896s
	iters: 600, epoch: 7 | loss: 0.2629885
	speed: 0.0304s/iter; left time: 646.2615s
	iters: 700, epoch: 7 | loss: 0.3098632
	speed: 0.0304s/iter; left time: 643.4140s
	iters: 800, epoch: 7 | loss: 0.3373746
	speed: 0.0298s/iter; left time: 627.8572s
	iters: 900, epoch: 7 | loss: 0.2115412
	speed: 0.0304s/iter; left time: 637.9484s
	iters: 1000, epoch: 7 | loss: 0.2187611
	speed: 0.0304s/iter; left time: 635.0655s
	iters: 1100, epoch: 7 | loss: 0.2603275
	speed: 0.0295s/iter; left time: 612.5955s
	iters: 1200, epoch: 7 | loss: 0.2395556
	speed: 0.0298s/iter; left time: 615.8929s
	iters: 1300, epoch: 7 | loss: 0.3093681
	speed: 0.0300s/iter; left time: 616.7391s
	iters: 1400, epoch: 7 | loss: 0.1952998
	speed: 0.0302s/iter; left time: 618.1441s
	iters: 1500, epoch: 7 | loss: 0.2188621
	speed: 0.0301s/iter; left time: 613.2240s
	iters: 1600, epoch: 7 | loss: 0.2585562
	speed: 0.0300s/iter; left time: 608.0714s
	iters: 1700, epoch: 7 | loss: 0.2395597
	speed: 0.0303s/iter; left time: 610.8262s
	iters: 1800, epoch: 7 | loss: 0.2609220
	speed: 0.0302s/iter; left time: 606.8391s
	iters: 1900, epoch: 7 | loss: 0.2357623
	speed: 0.0304s/iter; left time: 607.8322s
	iters: 2000, epoch: 7 | loss: 0.3074800
	speed: 0.0300s/iter; left time: 597.3148s
	iters: 2100, epoch: 7 | loss: 0.2278231
	speed: 0.0299s/iter; left time: 590.8472s
	iters: 2200, epoch: 7 | loss: 0.2460449
	speed: 0.0304s/iter; left time: 598.3790s
	iters: 2300, epoch: 7 | loss: 0.2473793
	speed: 0.0300s/iter; left time: 587.6296s
	iters: 2400, epoch: 7 | loss: 0.2513477
	speed: 0.0300s/iter; left time: 583.6016s
	iters: 2500, epoch: 7 | loss: 0.2152576
	speed: 0.0305s/iter; left time: 591.2866s
	iters: 2600, epoch: 7 | loss: 0.2253450
	speed: 0.0302s/iter; left time: 581.6028s
	iters: 2700, epoch: 7 | loss: 0.2118482
	speed: 0.0305s/iter; left time: 584.9044s
	iters: 2800, epoch: 7 | loss: 0.2063720
	speed: 0.0303s/iter; left time: 577.6608s
	iters: 2900, epoch: 7 | loss: 0.2310382
	speed: 0.0304s/iter; left time: 577.6885s
	iters: 3000, epoch: 7 | loss: 0.2516784
	speed: 0.0300s/iter; left time: 567.3644s
	iters: 3100, epoch: 7 | loss: 0.2190577
	speed: 0.0304s/iter; left time: 570.5625s
	iters: 3200, epoch: 7 | loss: 0.2465719
	speed: 0.0305s/iter; left time: 569.9728s
	iters: 3300, epoch: 7 | loss: 0.2564819
	speed: 0.0295s/iter; left time: 547.3549s
	iters: 3400, epoch: 7 | loss: 0.3161326
	speed: 0.0305s/iter; left time: 562.9530s
	iters: 3500, epoch: 7 | loss: 0.2380144
	speed: 0.0301s/iter; left time: 552.7469s
	iters: 3600, epoch: 7 | loss: 0.2454469
	speed: 0.0305s/iter; left time: 557.6948s
	iters: 3700, epoch: 7 | loss: 0.1994021
	speed: 0.0305s/iter; left time: 554.0835s
	iters: 3800, epoch: 7 | loss: 0.2699887
	speed: 0.0301s/iter; left time: 543.5331s
	iters: 3900, epoch: 7 | loss: 0.2681548
	speed: 0.0300s/iter; left time: 539.8016s
	iters: 4000, epoch: 7 | loss: 0.2671676
	speed: 0.0305s/iter; left time: 545.0735s
	iters: 4100, epoch: 7 | loss: 0.2025461
	speed: 0.0302s/iter; left time: 536.3791s
	iters: 4200, epoch: 7 | loss: 0.2176827
	speed: 0.0291s/iter; left time: 514.4161s
	iters: 4300, epoch: 7 | loss: 0.2396079
	speed: 0.0298s/iter; left time: 524.3154s
	iters: 4400, epoch: 7 | loss: 0.2303024
	speed: 0.0299s/iter; left time: 521.9734s
	iters: 4500, epoch: 7 | loss: 0.2422950
	speed: 0.0297s/iter; left time: 515.5104s
	iters: 4600, epoch: 7 | loss: 0.3863564
	speed: 0.0295s/iter; left time: 509.2703s
	iters: 4700, epoch: 7 | loss: 0.2259491
	speed: 0.0298s/iter; left time: 512.7667s
	iters: 4800, epoch: 7 | loss: 0.2556747
	speed: 0.0299s/iter; left time: 509.9737s
	iters: 4900, epoch: 7 | loss: 0.2418914
	speed: 0.0304s/iter; left time: 515.6543s
	iters: 5000, epoch: 7 | loss: 0.2742864
	speed: 0.0305s/iter; left time: 514.0589s
	iters: 5100, epoch: 7 | loss: 0.2521574
	speed: 0.0303s/iter; left time: 509.2076s
	iters: 5200, epoch: 7 | loss: 0.2674995
	speed: 0.0305s/iter; left time: 508.0503s
	iters: 5300, epoch: 7 | loss: 0.2475371
	speed: 0.0303s/iter; left time: 502.5435s
	iters: 5400, epoch: 7 | loss: 0.5457680
	speed: 0.0304s/iter; left time: 501.1498s
Epoch: 7 cost time: 165.43063855171204
Epoch: 7, Steps: 5470 | Train Loss: 0.2560338 Vali Loss: 0.1809132 Test Loss: 0.2690745
Validation loss decreased (0.181126 --> 0.180913).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2174343
	speed: 1.1206s/iter; left time: 18278.8879s
	iters: 200, epoch: 8 | loss: 0.2814763
	speed: 0.0296s/iter; left time: 479.1719s
	iters: 300, epoch: 8 | loss: 0.2583029
	speed: 0.0293s/iter; left time: 472.7677s
	iters: 400, epoch: 8 | loss: 0.2852706
	speed: 0.0291s/iter; left time: 466.2760s
	iters: 500, epoch: 8 | loss: 0.2007099
	speed: 0.0297s/iter; left time: 473.1456s
	iters: 600, epoch: 8 | loss: 0.2930399
	speed: 0.0305s/iter; left time: 482.5987s
	iters: 700, epoch: 8 | loss: 0.3106402
	speed: 0.0298s/iter; left time: 467.8022s
	iters: 800, epoch: 8 | loss: 0.2525008
	speed: 0.0300s/iter; left time: 468.0134s
	iters: 900, epoch: 8 | loss: 0.2129913
	speed: 0.0283s/iter; left time: 439.6805s
	iters: 1000, epoch: 8 | loss: 0.1984054
	speed: 0.0287s/iter; left time: 442.0473s
	iters: 1100, epoch: 8 | loss: 0.2592310
	speed: 0.0297s/iter; left time: 454.1882s
	iters: 1200, epoch: 8 | loss: 0.2879623
	speed: 0.0296s/iter; left time: 450.9064s
	iters: 1300, epoch: 8 | loss: 0.3836187
	speed: 0.0301s/iter; left time: 455.0726s
	iters: 1400, epoch: 8 | loss: 0.2730744
	speed: 0.0293s/iter; left time: 440.3788s
	iters: 1500, epoch: 8 | loss: 0.2297640
	speed: 0.0298s/iter; left time: 444.6807s
	iters: 1600, epoch: 8 | loss: 0.2251671
	speed: 0.0303s/iter; left time: 449.4458s
	iters: 1700, epoch: 8 | loss: 0.2718001
	speed: 0.0305s/iter; left time: 448.1471s
	iters: 1800, epoch: 8 | loss: 0.2455524
	speed: 0.0304s/iter; left time: 444.5031s
	iters: 1900, epoch: 8 | loss: 0.2498261
	speed: 0.0297s/iter; left time: 431.2439s
	iters: 2000, epoch: 8 | loss: 0.2793593
	speed: 0.0303s/iter; left time: 436.7219s
	iters: 2100, epoch: 8 | loss: 0.2474361
	speed: 0.0301s/iter; left time: 430.5573s
	iters: 2200, epoch: 8 | loss: 0.3053646
	speed: 0.0300s/iter; left time: 426.1321s
	iters: 2300, epoch: 8 | loss: 0.2331050
	speed: 0.0300s/iter; left time: 423.6531s
	iters: 2400, epoch: 8 | loss: 0.2109952
	speed: 0.0297s/iter; left time: 416.3517s
	iters: 2500, epoch: 8 | loss: 0.2129941
	speed: 0.0304s/iter; left time: 423.2333s
	iters: 2600, epoch: 8 | loss: 0.2335141
	speed: 0.0302s/iter; left time: 416.8350s
	iters: 2700, epoch: 8 | loss: 0.3144039
	speed: 0.0303s/iter; left time: 415.5864s
	iters: 2800, epoch: 8 | loss: 0.2377695
	speed: 0.0304s/iter; left time: 413.5260s
	iters: 2900, epoch: 8 | loss: 0.3082907
	speed: 0.0303s/iter; left time: 408.8110s
	iters: 3000, epoch: 8 | loss: 0.2544860
	speed: 0.0303s/iter; left time: 406.4501s
	iters: 3100, epoch: 8 | loss: 0.2681805
	speed: 0.0304s/iter; left time: 404.4749s
	iters: 3200, epoch: 8 | loss: 0.2572890
	speed: 0.0304s/iter; left time: 401.1318s
	iters: 3300, epoch: 8 | loss: 0.2145833
	speed: 0.0303s/iter; left time: 396.9622s
	iters: 3400, epoch: 8 | loss: 0.2476026
	speed: 0.0301s/iter; left time: 391.1663s
	iters: 3500, epoch: 8 | loss: 0.2203398
	speed: 0.0305s/iter; left time: 393.3242s
	iters: 3600, epoch: 8 | loss: 0.3009440
	speed: 0.0298s/iter; left time: 382.1391s
	iters: 3700, epoch: 8 | loss: 0.3063960
	speed: 0.0282s/iter; left time: 358.1700s
	iters: 3800, epoch: 8 | loss: 0.2168703
	speed: 0.0288s/iter; left time: 363.4595s
	iters: 3900, epoch: 8 | loss: 0.2143173
	speed: 0.0282s/iter; left time: 352.7004s
	iters: 4000, epoch: 8 | loss: 0.2791864
	speed: 0.0285s/iter; left time: 353.5604s
	iters: 4100, epoch: 8 | loss: 0.2376697
	speed: 0.0286s/iter; left time: 352.1566s
	iters: 4200, epoch: 8 | loss: 0.2488390
	speed: 0.0297s/iter; left time: 363.2654s
	iters: 4300, epoch: 8 | loss: 0.2345962
	speed: 0.0298s/iter; left time: 360.6284s
	iters: 4400, epoch: 8 | loss: 0.2497277
	speed: 0.0284s/iter; left time: 340.9487s
	iters: 4500, epoch: 8 | loss: 0.2852402
	speed: 0.0296s/iter; left time: 352.9980s
	iters: 4600, epoch: 8 | loss: 0.2979922
	speed: 0.0295s/iter; left time: 348.8171s
	iters: 4700, epoch: 8 | loss: 0.3094402
	speed: 0.0293s/iter; left time: 343.2472s
	iters: 4800, epoch: 8 | loss: 0.2504627
	speed: 0.0301s/iter; left time: 348.9628s
	iters: 4900, epoch: 8 | loss: 0.2393104
	speed: 0.0300s/iter; left time: 344.9926s
	iters: 5000, epoch: 8 | loss: 0.2481847
	speed: 0.0287s/iter; left time: 327.2391s
	iters: 5100, epoch: 8 | loss: 0.1940418
	speed: 0.0297s/iter; left time: 335.7530s
	iters: 5200, epoch: 8 | loss: 0.1932958
	speed: 0.0295s/iter; left time: 330.5683s
	iters: 5300, epoch: 8 | loss: 0.2577524
	speed: 0.0288s/iter; left time: 320.2901s
	iters: 5400, epoch: 8 | loss: 0.2676031
	speed: 0.0303s/iter; left time: 333.6262s
Epoch: 8 cost time: 163.11927127838135
Epoch: 8, Steps: 5470 | Train Loss: 0.2552960 Vali Loss: 0.1808337 Test Loss: 0.2687602
Validation loss decreased (0.180913 --> 0.180834).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.4099893
	speed: 1.1684s/iter; left time: 12666.3812s
	iters: 200, epoch: 9 | loss: 0.2756699
	speed: 0.0308s/iter; left time: 330.6246s
	iters: 300, epoch: 9 | loss: 0.2560886
	speed: 0.0305s/iter; left time: 324.7353s
	iters: 400, epoch: 9 | loss: 0.2502395
	speed: 0.0302s/iter; left time: 318.7048s
	iters: 500, epoch: 9 | loss: 0.2759899
	speed: 0.0302s/iter; left time: 315.0051s
	iters: 600, epoch: 9 | loss: 0.2597776
	speed: 0.0297s/iter; left time: 307.2385s
	iters: 700, epoch: 9 | loss: 0.2340398
	speed: 0.0301s/iter; left time: 308.0098s
	iters: 800, epoch: 9 | loss: 0.2644619
	speed: 0.0297s/iter; left time: 301.6687s
	iters: 900, epoch: 9 | loss: 0.3630883
	speed: 0.0301s/iter; left time: 302.4664s
	iters: 1000, epoch: 9 | loss: 0.2538236
	speed: 0.0303s/iter; left time: 301.1201s
	iters: 1100, epoch: 9 | loss: 0.3377506
	speed: 0.0300s/iter; left time: 295.1125s
	iters: 1200, epoch: 9 | loss: 0.2753307
	speed: 0.0300s/iter; left time: 292.3317s
	iters: 1300, epoch: 9 | loss: 0.2326005
	speed: 0.0296s/iter; left time: 285.2261s
	iters: 1400, epoch: 9 | loss: 0.2186322
	speed: 0.0296s/iter; left time: 282.1564s
	iters: 1500, epoch: 9 | loss: 0.2338828
	speed: 0.0300s/iter; left time: 283.0668s
	iters: 1600, epoch: 9 | loss: 0.1925362
	speed: 0.0297s/iter; left time: 277.3339s
	iters: 1700, epoch: 9 | loss: 0.2458901
	speed: 0.0302s/iter; left time: 278.7539s
	iters: 1800, epoch: 9 | loss: 0.2653261
	speed: 0.0302s/iter; left time: 275.8175s
	iters: 1900, epoch: 9 | loss: 0.2932987
	speed: 0.0301s/iter; left time: 272.0142s
	iters: 2000, epoch: 9 | loss: 0.2112443
	speed: 0.0299s/iter; left time: 267.3482s
	iters: 2100, epoch: 9 | loss: 0.2429060
	speed: 0.0294s/iter; left time: 259.8169s
	iters: 2200, epoch: 9 | loss: 0.1920624
	speed: 0.0298s/iter; left time: 260.4659s
	iters: 2300, epoch: 9 | loss: 0.3425260
	speed: 0.0302s/iter; left time: 260.5674s
	iters: 2400, epoch: 9 | loss: 0.2449733
	speed: 0.0302s/iter; left time: 257.7745s
	iters: 2500, epoch: 9 | loss: 0.2448037
	speed: 0.0295s/iter; left time: 248.9908s
	iters: 2600, epoch: 9 | loss: 0.2896167
	speed: 0.0288s/iter; left time: 240.4151s
	iters: 2700, epoch: 9 | loss: 0.2628339
	speed: 0.0299s/iter; left time: 246.4503s
	iters: 2800, epoch: 9 | loss: 0.1980979
	speed: 0.0303s/iter; left time: 246.4620s
	iters: 2900, epoch: 9 | loss: 0.2934422
	speed: 0.0304s/iter; left time: 244.3393s
	iters: 3000, epoch: 9 | loss: 0.2933646
	speed: 0.0301s/iter; left time: 239.3631s
	iters: 3100, epoch: 9 | loss: 0.2949870
	speed: 0.0297s/iter; left time: 233.2452s
	iters: 3200, epoch: 9 | loss: 0.2165797
	speed: 0.0305s/iter; left time: 236.3907s
	iters: 3300, epoch: 9 | loss: 0.2836032
	speed: 0.0300s/iter; left time: 229.4108s
	iters: 3400, epoch: 9 | loss: 0.2336472
	speed: 0.0299s/iter; left time: 225.5781s
	iters: 3500, epoch: 9 | loss: 0.2465907
	speed: 0.0300s/iter; left time: 223.2723s
	iters: 3600, epoch: 9 | loss: 0.3464472
	speed: 0.0303s/iter; left time: 222.3933s
	iters: 3700, epoch: 9 | loss: 0.2331908
	speed: 0.0303s/iter; left time: 219.6958s
	iters: 3800, epoch: 9 | loss: 0.2289457
	speed: 0.0299s/iter; left time: 213.6027s
	iters: 3900, epoch: 9 | loss: 0.2292360
	speed: 0.0297s/iter; left time: 209.1487s
	iters: 4000, epoch: 9 | loss: 0.3009969
	speed: 0.0300s/iter; left time: 208.5268s
	iters: 4100, epoch: 9 | loss: 0.3204863
	speed: 0.0301s/iter; left time: 206.1793s
	iters: 4200, epoch: 9 | loss: 0.2765100
	speed: 0.0300s/iter; left time: 202.0157s
	iters: 4300, epoch: 9 | loss: 0.3375402
	speed: 0.0302s/iter; left time: 200.2326s
	iters: 4400, epoch: 9 | loss: 0.2247867
	speed: 0.0299s/iter; left time: 195.5914s
	iters: 4500, epoch: 9 | loss: 0.2279850
	speed: 0.0305s/iter; left time: 196.5959s
	iters: 4600, epoch: 9 | loss: 0.2870167
	speed: 0.0297s/iter; left time: 188.4406s
	iters: 4700, epoch: 9 | loss: 0.2218367
	speed: 0.0301s/iter; left time: 187.7213s
	iters: 4800, epoch: 9 | loss: 0.3211778
	speed: 0.0304s/iter; left time: 186.5012s
	iters: 4900, epoch: 9 | loss: 0.2440754
	speed: 0.0301s/iter; left time: 181.9665s
	iters: 5000, epoch: 9 | loss: 0.2131415
	speed: 0.0301s/iter; left time: 178.9965s
	iters: 5100, epoch: 9 | loss: 0.3412541
	speed: 0.0301s/iter; left time: 176.0458s
	iters: 5200, epoch: 9 | loss: 0.2954039
	speed: 0.0297s/iter; left time: 170.7076s
	iters: 5300, epoch: 9 | loss: 0.2522085
	speed: 0.0302s/iter; left time: 170.1049s
	iters: 5400, epoch: 9 | loss: 0.2413880
	speed: 0.0292s/iter; left time: 161.7863s
Epoch: 9 cost time: 164.889093875885
Epoch: 9, Steps: 5470 | Train Loss: 0.2549611 Vali Loss: 0.1809285 Test Loss: 0.2681552
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2296680
	speed: 1.1216s/iter; left time: 6024.1970s
	iters: 200, epoch: 10 | loss: 0.2476525
	speed: 0.0295s/iter; left time: 155.7120s
	iters: 300, epoch: 10 | loss: 0.2713346
	speed: 0.0299s/iter; left time: 154.4497s
	iters: 400, epoch: 10 | loss: 0.2488027
	speed: 0.0299s/iter; left time: 151.5640s
	iters: 500, epoch: 10 | loss: 0.2775824
	speed: 0.0302s/iter; left time: 150.0488s
	iters: 600, epoch: 10 | loss: 0.2876296
	speed: 0.0301s/iter; left time: 146.4947s
	iters: 700, epoch: 10 | loss: 0.2156823
	speed: 0.0302s/iter; left time: 144.1692s
	iters: 800, epoch: 10 | loss: 0.2784378
	speed: 0.0302s/iter; left time: 141.2395s
	iters: 900, epoch: 10 | loss: 0.2796617
	speed: 0.0296s/iter; left time: 135.2124s
	iters: 1000, epoch: 10 | loss: 0.2607700
	speed: 0.0301s/iter; left time: 134.7693s
	iters: 1100, epoch: 10 | loss: 0.2503283
	speed: 0.0304s/iter; left time: 132.7243s
	iters: 1200, epoch: 10 | loss: 0.3523729
	speed: 0.0300s/iter; left time: 128.0655s
	iters: 1300, epoch: 10 | loss: 0.2588435
	speed: 0.0291s/iter; left time: 121.4022s
	iters: 1400, epoch: 10 | loss: 0.2453128
	speed: 0.0291s/iter; left time: 118.5992s
	iters: 1500, epoch: 10 | loss: 0.3117945
	speed: 0.0303s/iter; left time: 120.1532s
	iters: 1600, epoch: 10 | loss: 0.2626603
	speed: 0.0304s/iter; left time: 117.5362s
	iters: 1700, epoch: 10 | loss: 0.2648208
	speed: 0.0304s/iter; left time: 114.5080s
	iters: 1800, epoch: 10 | loss: 0.2627685
	speed: 0.0304s/iter; left time: 111.4241s
	iters: 1900, epoch: 10 | loss: 0.3162966
	speed: 0.0292s/iter; left time: 104.1196s
	iters: 2000, epoch: 10 | loss: 0.2200792
	speed: 0.0299s/iter; left time: 103.6796s
	iters: 2100, epoch: 10 | loss: 0.3979100
	speed: 0.0295s/iter; left time: 99.3620s
	iters: 2200, epoch: 10 | loss: 0.2683843
	speed: 0.0301s/iter; left time: 98.3827s
	iters: 2300, epoch: 10 | loss: 0.1951335
	speed: 0.0298s/iter; left time: 94.4246s
	iters: 2400, epoch: 10 | loss: 0.2747377
	speed: 0.0301s/iter; left time: 92.4132s
	iters: 2500, epoch: 10 | loss: 0.2797560
	speed: 0.0304s/iter; left time: 90.2603s
	iters: 2600, epoch: 10 | loss: 0.3586373
	speed: 0.0304s/iter; left time: 87.1826s
	iters: 2700, epoch: 10 | loss: 0.1960789
	speed: 0.0303s/iter; left time: 84.0892s
	iters: 2800, epoch: 10 | loss: 0.2380843
	speed: 0.0303s/iter; left time: 80.9530s
	iters: 2900, epoch: 10 | loss: 0.2240047
	speed: 0.0297s/iter; left time: 76.2880s
	iters: 3000, epoch: 10 | loss: 0.2678776
	speed: 0.0301s/iter; left time: 74.2720s
	iters: 3100, epoch: 10 | loss: 0.2251881
	speed: 0.0304s/iter; left time: 72.0522s
	iters: 3200, epoch: 10 | loss: 0.2459571
	speed: 0.0304s/iter; left time: 68.9522s
	iters: 3300, epoch: 10 | loss: 0.3187815
	speed: 0.0304s/iter; left time: 65.9676s
	iters: 3400, epoch: 10 | loss: 0.2436003
	speed: 0.0304s/iter; left time: 62.9523s
	iters: 3500, epoch: 10 | loss: 0.2716209
	speed: 0.0304s/iter; left time: 59.8820s
	iters: 3600, epoch: 10 | loss: 0.2536381
	speed: 0.0299s/iter; left time: 56.0070s
	iters: 3700, epoch: 10 | loss: 0.2161330
	speed: 0.0301s/iter; left time: 53.2505s
	iters: 3800, epoch: 10 | loss: 0.2329911
	speed: 0.0304s/iter; left time: 50.8191s
	iters: 3900, epoch: 10 | loss: 0.2305024
	speed: 0.0303s/iter; left time: 47.5489s
	iters: 4000, epoch: 10 | loss: 0.1990842
	speed: 0.0303s/iter; left time: 44.5353s
	iters: 4100, epoch: 10 | loss: 0.2524110
	speed: 0.0302s/iter; left time: 41.4274s
	iters: 4200, epoch: 10 | loss: 0.2029676
	speed: 0.0291s/iter; left time: 36.9934s
	iters: 4300, epoch: 10 | loss: 0.2738168
	speed: 0.0304s/iter; left time: 35.5583s
	iters: 4400, epoch: 10 | loss: 0.2822246
	speed: 0.0301s/iter; left time: 32.1967s
	iters: 4500, epoch: 10 | loss: 0.2179994
	speed: 0.0302s/iter; left time: 29.3689s
	iters: 4600, epoch: 10 | loss: 0.4551667
	speed: 0.0302s/iter; left time: 26.3002s
	iters: 4700, epoch: 10 | loss: 0.2376788
	speed: 0.0304s/iter; left time: 23.4633s
	iters: 4800, epoch: 10 | loss: 0.2780226
	speed: 0.0304s/iter; left time: 20.4240s
	iters: 4900, epoch: 10 | loss: 0.2155668
	speed: 0.0297s/iter; left time: 16.9594s
	iters: 5000, epoch: 10 | loss: 0.2467704
	speed: 0.0302s/iter; left time: 14.2295s
	iters: 5100, epoch: 10 | loss: 0.2759752
	speed: 0.0304s/iter; left time: 11.2943s
	iters: 5200, epoch: 10 | loss: 0.2753359
	speed: 0.0303s/iter; left time: 8.2167s
	iters: 5300, epoch: 10 | loss: 0.2384585
	speed: 0.0304s/iter; left time: 5.1917s
	iters: 5400, epoch: 10 | loss: 0.2452347
	speed: 0.0304s/iter; left time: 2.1609s
Epoch: 10 cost time: 165.32130932807922
Epoch: 10, Steps: 5470 | Train Loss: 0.2546954 Vali Loss: 0.1809954 Test Loss: 0.2680021
EarlyStopping counter: 2 out of 3
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_pems06_h_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 24965
test shape: (24965, 1, 96, 130) (24965, 1, 96, 130)
test shape: (24965, 96, 130) (24965, 96, 130)
mse:0.2687602639198303, mae:0.3360491693019867
>>>>>>>Overall time: 2825 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
