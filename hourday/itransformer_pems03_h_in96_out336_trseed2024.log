Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=151, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems03_h.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=151, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems03_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_h_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 133364
val 18779
test 37892
	iters: 100, epoch: 1 | loss: 0.2904333
	speed: 0.0352s/iter; left time: 2927.3747s
	iters: 200, epoch: 1 | loss: 0.2450840
	speed: 0.0305s/iter; left time: 2535.9629s
	iters: 300, epoch: 1 | loss: 0.2124078
	speed: 0.0304s/iter; left time: 2522.9831s
	iters: 400, epoch: 1 | loss: 0.2530786
	speed: 0.0304s/iter; left time: 2519.0476s
	iters: 500, epoch: 1 | loss: 0.2300537
	speed: 0.0304s/iter; left time: 2517.1551s
	iters: 600, epoch: 1 | loss: 0.2025853
	speed: 0.0304s/iter; left time: 2514.5896s
	iters: 700, epoch: 1 | loss: 0.2719845
	speed: 0.0304s/iter; left time: 2513.1090s
	iters: 800, epoch: 1 | loss: 0.2031285
	speed: 0.0304s/iter; left time: 2507.7465s
	iters: 900, epoch: 1 | loss: 0.2538474
	speed: 0.0303s/iter; left time: 2495.9808s
	iters: 1000, epoch: 1 | loss: 0.1529923
	speed: 0.0304s/iter; left time: 2502.6104s
	iters: 1100, epoch: 1 | loss: 0.2148422
	speed: 0.0306s/iter; left time: 2519.2979s
	iters: 1200, epoch: 1 | loss: 0.1830950
	speed: 0.0304s/iter; left time: 2496.0797s
	iters: 1300, epoch: 1 | loss: 0.1619986
	speed: 0.0304s/iter; left time: 2493.1404s
	iters: 1400, epoch: 1 | loss: 0.2545907
	speed: 0.0304s/iter; left time: 2487.4235s
	iters: 1500, epoch: 1 | loss: 0.2104126
	speed: 0.0304s/iter; left time: 2485.7898s
	iters: 1600, epoch: 1 | loss: 0.2156873
	speed: 0.0304s/iter; left time: 2484.9012s
	iters: 1700, epoch: 1 | loss: 0.2400723
	speed: 0.0304s/iter; left time: 2482.2665s
	iters: 1800, epoch: 1 | loss: 0.5623168
	speed: 0.0304s/iter; left time: 2476.5574s
	iters: 1900, epoch: 1 | loss: 0.6269178
	speed: 0.0305s/iter; left time: 2481.8572s
	iters: 2000, epoch: 1 | loss: 0.7265078
	speed: 0.0304s/iter; left time: 2471.5979s
	iters: 2100, epoch: 1 | loss: 0.5518777
	speed: 0.0304s/iter; left time: 2470.8089s
	iters: 2200, epoch: 1 | loss: 0.7179170
	speed: 0.0305s/iter; left time: 2474.2491s
	iters: 2300, epoch: 1 | loss: 0.5957958
	speed: 0.0304s/iter; left time: 2460.2230s
	iters: 2400, epoch: 1 | loss: 0.5324163
	speed: 0.0304s/iter; left time: 2458.4604s
	iters: 2500, epoch: 1 | loss: 0.6367550
	speed: 0.0304s/iter; left time: 2460.5332s
	iters: 2600, epoch: 1 | loss: 0.4957470
	speed: 0.0304s/iter; left time: 2452.7197s
	iters: 2700, epoch: 1 | loss: 0.6828573
	speed: 0.0304s/iter; left time: 2452.3270s
	iters: 2800, epoch: 1 | loss: 0.5719597
	speed: 0.0305s/iter; left time: 2454.0259s
	iters: 2900, epoch: 1 | loss: 0.6949556
	speed: 0.0304s/iter; left time: 2444.7983s
	iters: 3000, epoch: 1 | loss: 0.6979889
	speed: 0.0304s/iter; left time: 2440.3715s
	iters: 3100, epoch: 1 | loss: 0.6078112
	speed: 0.0305s/iter; left time: 2446.3953s
	iters: 3200, epoch: 1 | loss: 0.5287285
	speed: 0.0304s/iter; left time: 2439.3116s
	iters: 3300, epoch: 1 | loss: 0.5977149
	speed: 0.0304s/iter; left time: 2434.3653s
	iters: 3400, epoch: 1 | loss: 0.6861340
	speed: 0.0304s/iter; left time: 2432.5711s
	iters: 3500, epoch: 1 | loss: 0.7182367
	speed: 0.0304s/iter; left time: 2429.1855s
	iters: 3600, epoch: 1 | loss: 0.5260785
	speed: 0.0305s/iter; left time: 2428.6475s
	iters: 3700, epoch: 1 | loss: 0.7077563
	speed: 0.0306s/iter; left time: 2439.0694s
	iters: 3800, epoch: 1 | loss: 0.6872723
	speed: 0.0304s/iter; left time: 2418.3240s
	iters: 3900, epoch: 1 | loss: 0.5781163
	speed: 0.0304s/iter; left time: 2417.4014s
	iters: 4000, epoch: 1 | loss: 0.6099887
	speed: 0.0304s/iter; left time: 2412.0416s
	iters: 4100, epoch: 1 | loss: 0.5573382
	speed: 0.0304s/iter; left time: 2409.0503s
	iters: 4200, epoch: 1 | loss: 0.6870936
	speed: 0.0304s/iter; left time: 2407.7025s
	iters: 4300, epoch: 1 | loss: 0.6490710
	speed: 0.0304s/iter; left time: 2400.7822s
	iters: 4400, epoch: 1 | loss: 0.5456367
	speed: 0.0305s/iter; left time: 2406.5647s
	iters: 4500, epoch: 1 | loss: 0.5668187
	speed: 0.0304s/iter; left time: 2397.1286s
	iters: 4600, epoch: 1 | loss: 0.6614146
	speed: 0.0305s/iter; left time: 2403.7344s
	iters: 4700, epoch: 1 | loss: 0.6034102
	speed: 0.0305s/iter; left time: 2401.8344s
	iters: 4800, epoch: 1 | loss: 0.5854729
	speed: 0.0304s/iter; left time: 2384.8076s
	iters: 4900, epoch: 1 | loss: 0.6421756
	speed: 0.0304s/iter; left time: 2386.3801s
	iters: 5000, epoch: 1 | loss: 0.6393853
	speed: 0.0304s/iter; left time: 2382.5692s
	iters: 5100, epoch: 1 | loss: 0.6830968
	speed: 0.0304s/iter; left time: 2379.5880s
	iters: 5200, epoch: 1 | loss: 0.6585493
	speed: 0.0304s/iter; left time: 2375.1692s
	iters: 5300, epoch: 1 | loss: 0.6324150
	speed: 0.0304s/iter; left time: 2375.7315s
	iters: 5400, epoch: 1 | loss: 0.6414356
	speed: 0.0304s/iter; left time: 2369.8713s
	iters: 5500, epoch: 1 | loss: 0.5842451
	speed: 0.0304s/iter; left time: 2366.4913s
	iters: 5600, epoch: 1 | loss: 0.6448918
	speed: 0.0304s/iter; left time: 2363.6565s
	iters: 5700, epoch: 1 | loss: 0.6750925
	speed: 0.0304s/iter; left time: 2362.7879s
	iters: 5800, epoch: 1 | loss: 0.6188983
	speed: 0.0304s/iter; left time: 2358.0842s
	iters: 5900, epoch: 1 | loss: 0.5659232
	speed: 0.0304s/iter; left time: 2354.3157s
	iters: 6000, epoch: 1 | loss: 0.6569693
	speed: 0.0304s/iter; left time: 2352.5684s
	iters: 6100, epoch: 1 | loss: 0.6726280
	speed: 0.0304s/iter; left time: 2347.7375s
	iters: 6200, epoch: 1 | loss: 0.7720327
	speed: 0.0304s/iter; left time: 2346.5564s
	iters: 6300, epoch: 1 | loss: 0.6224464
	speed: 0.0304s/iter; left time: 2341.8421s
	iters: 6400, epoch: 1 | loss: 0.5953670
	speed: 0.0304s/iter; left time: 2339.6490s
	iters: 6500, epoch: 1 | loss: 0.4981118
	speed: 0.0304s/iter; left time: 2335.9702s
	iters: 6600, epoch: 1 | loss: 0.6300732
	speed: 0.0304s/iter; left time: 2335.7320s
	iters: 6700, epoch: 1 | loss: 0.7006235
	speed: 0.0304s/iter; left time: 2329.5135s
	iters: 6800, epoch: 1 | loss: 0.6982297
	speed: 0.0304s/iter; left time: 2328.1504s
	iters: 6900, epoch: 1 | loss: 0.6744843
	speed: 0.0304s/iter; left time: 2323.8758s
	iters: 7000, epoch: 1 | loss: 0.5734830
	speed: 0.0303s/iter; left time: 2314.8877s
	iters: 7100, epoch: 1 | loss: 0.6147896
	speed: 0.0304s/iter; left time: 2318.9695s
	iters: 7200, epoch: 1 | loss: 0.7552260
	speed: 0.0304s/iter; left time: 2314.6966s
	iters: 7300, epoch: 1 | loss: 0.5172467
	speed: 0.0304s/iter; left time: 2309.2384s
	iters: 7400, epoch: 1 | loss: 0.7425095
	speed: 0.0304s/iter; left time: 2309.0404s
	iters: 7500, epoch: 1 | loss: 0.5941743
	speed: 0.0305s/iter; left time: 2310.5868s
	iters: 7600, epoch: 1 | loss: 0.6411268
	speed: 0.0305s/iter; left time: 2306.8046s
	iters: 7700, epoch: 1 | loss: 0.6922660
	speed: 0.0304s/iter; left time: 2300.1105s
	iters: 7800, epoch: 1 | loss: 0.6177557
	speed: 0.0304s/iter; left time: 2298.2777s
	iters: 7900, epoch: 1 | loss: 0.6499339
	speed: 0.0304s/iter; left time: 2294.0977s
	iters: 8000, epoch: 1 | loss: 0.6924721
	speed: 0.0304s/iter; left time: 2292.2017s
	iters: 8100, epoch: 1 | loss: 0.5856409
	speed: 0.0304s/iter; left time: 2287.6693s
	iters: 8200, epoch: 1 | loss: 0.6319216
	speed: 0.0304s/iter; left time: 2284.7326s
	iters: 8300, epoch: 1 | loss: 0.5953686
	speed: 0.0304s/iter; left time: 2282.2926s
Epoch: 1 cost time: 254.05070638656616
Epoch: 1, Steps: 8335 | Train Loss: 0.5484465 Vali Loss: 0.6664189 Test Loss: 0.5182627
Validation loss decreased (inf --> 0.666419).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.6304197
	speed: 1.8829s/iter; left time: 141059.1958s
	iters: 200, epoch: 2 | loss: 0.6085016
	speed: 0.0304s/iter; left time: 2273.6037s
	iters: 300, epoch: 2 | loss: 0.6173909
	speed: 0.0304s/iter; left time: 2268.4346s
	iters: 400, epoch: 2 | loss: 0.5947225
	speed: 0.0304s/iter; left time: 2268.0869s
	iters: 500, epoch: 2 | loss: 0.7643887
	speed: 0.0304s/iter; left time: 2263.3168s
	iters: 600, epoch: 2 | loss: 0.6378428
	speed: 0.0305s/iter; left time: 2268.6932s
	iters: 700, epoch: 2 | loss: 0.5673035
	speed: 0.0304s/iter; left time: 2257.5044s
	iters: 800, epoch: 2 | loss: 0.7318317
	speed: 0.0304s/iter; left time: 2254.3539s
	iters: 900, epoch: 2 | loss: 0.5097125
	speed: 0.0304s/iter; left time: 2253.2432s
	iters: 1000, epoch: 2 | loss: 0.6831947
	speed: 0.0304s/iter; left time: 2249.9443s
	iters: 1100, epoch: 2 | loss: 0.6089945
	speed: 0.0304s/iter; left time: 2246.7737s
	iters: 1200, epoch: 2 | loss: 0.5502686
	speed: 0.0304s/iter; left time: 2241.3864s
	iters: 1300, epoch: 2 | loss: 0.5744014
	speed: 0.0304s/iter; left time: 2240.7006s
	iters: 1400, epoch: 2 | loss: 0.6438376
	speed: 0.0304s/iter; left time: 2238.2025s
	iters: 1500, epoch: 2 | loss: 0.7932401
	speed: 0.0304s/iter; left time: 2234.0266s
	iters: 1600, epoch: 2 | loss: 0.5711255
	speed: 0.0304s/iter; left time: 2231.9402s
	iters: 1700, epoch: 2 | loss: 0.7422665
	speed: 0.0304s/iter; left time: 2228.3954s
	iters: 1800, epoch: 2 | loss: 0.6331524
	speed: 0.0304s/iter; left time: 2224.9355s
	iters: 1900, epoch: 2 | loss: 0.6288549
	speed: 0.0304s/iter; left time: 2222.9373s
	iters: 2000, epoch: 2 | loss: 0.6205412
	speed: 0.0304s/iter; left time: 2220.6921s
	iters: 2100, epoch: 2 | loss: 0.6235521
	speed: 0.0304s/iter; left time: 2214.3417s
	iters: 2200, epoch: 2 | loss: 0.6261525
	speed: 0.0304s/iter; left time: 2215.4464s
	iters: 2300, epoch: 2 | loss: 0.6156372
	speed: 0.0304s/iter; left time: 2210.3372s
	iters: 2400, epoch: 2 | loss: 0.5917779
	speed: 0.0304s/iter; left time: 2209.0052s
	iters: 2500, epoch: 2 | loss: 0.6129099
	speed: 0.0304s/iter; left time: 2205.3406s
	iters: 2600, epoch: 2 | loss: 0.6759154
	speed: 0.0304s/iter; left time: 2203.5154s
	iters: 2700, epoch: 2 | loss: 0.6288341
	speed: 0.0304s/iter; left time: 2197.3343s
	iters: 2800, epoch: 2 | loss: 0.5781717
	speed: 0.0304s/iter; left time: 2195.7440s
	iters: 2900, epoch: 2 | loss: 0.5228387
	speed: 0.0304s/iter; left time: 2192.0757s
	iters: 3000, epoch: 2 | loss: 0.7006124
	speed: 0.0304s/iter; left time: 2188.2258s
	iters: 3100, epoch: 2 | loss: 0.5942657
	speed: 0.0304s/iter; left time: 2184.5974s
	iters: 3200, epoch: 2 | loss: 0.7126990
	speed: 0.0304s/iter; left time: 2182.6561s
	iters: 3300, epoch: 2 | loss: 0.6112825
	speed: 0.0304s/iter; left time: 2180.1754s
	iters: 3400, epoch: 2 | loss: 0.5355401
	speed: 0.0304s/iter; left time: 2178.2967s
	iters: 3500, epoch: 2 | loss: 0.6178634
	speed: 0.0304s/iter; left time: 2173.1358s
	iters: 3600, epoch: 2 | loss: 0.5931882
	speed: 0.0304s/iter; left time: 2171.9961s
	iters: 3700, epoch: 2 | loss: 0.6101220
	speed: 0.0304s/iter; left time: 2167.7423s
	iters: 3800, epoch: 2 | loss: 0.6501535
	speed: 0.0304s/iter; left time: 2163.5921s
	iters: 3900, epoch: 2 | loss: 0.6340570
	speed: 0.0304s/iter; left time: 2162.0291s
	iters: 4000, epoch: 2 | loss: 0.6803593
	speed: 0.0304s/iter; left time: 2159.8549s
	iters: 4100, epoch: 2 | loss: 0.6435930
	speed: 0.0304s/iter; left time: 2158.4578s
	iters: 4200, epoch: 2 | loss: 0.6857327
	speed: 0.0304s/iter; left time: 2154.4995s
	iters: 4300, epoch: 2 | loss: 0.6339290
	speed: 0.0304s/iter; left time: 2148.8740s
	iters: 4400, epoch: 2 | loss: 0.6145303
	speed: 0.0304s/iter; left time: 2149.0868s
	iters: 4500, epoch: 2 | loss: 0.6428899
	speed: 0.0304s/iter; left time: 2143.4382s
	iters: 4600, epoch: 2 | loss: 0.6340114
	speed: 0.0304s/iter; left time: 2139.0001s
	iters: 4700, epoch: 2 | loss: 0.6576191
	speed: 0.0304s/iter; left time: 2137.5948s
	iters: 4800, epoch: 2 | loss: 0.5212893
	speed: 0.0304s/iter; left time: 2133.6992s
	iters: 4900, epoch: 2 | loss: 0.5730202
	speed: 0.0304s/iter; left time: 2130.5758s
	iters: 5000, epoch: 2 | loss: 0.6583713
	speed: 0.0304s/iter; left time: 2128.7476s
	iters: 5100, epoch: 2 | loss: 0.5993132
	speed: 0.0304s/iter; left time: 2126.0656s
	iters: 5200, epoch: 2 | loss: 0.6687835
	speed: 0.0304s/iter; left time: 2124.6252s
	iters: 5300, epoch: 2 | loss: 0.6859447
	speed: 0.0304s/iter; left time: 2119.3773s
	iters: 5400, epoch: 2 | loss: 0.6632422
	speed: 0.0304s/iter; left time: 2118.6119s
	iters: 5500, epoch: 2 | loss: 0.5723258
	speed: 0.0304s/iter; left time: 2112.6702s
	iters: 5600, epoch: 2 | loss: 0.6628203
	speed: 0.0304s/iter; left time: 2110.7290s
	iters: 5700, epoch: 2 | loss: 0.5637811
	speed: 0.0304s/iter; left time: 2109.7975s
	iters: 5800, epoch: 2 | loss: 0.7409615
	speed: 0.0304s/iter; left time: 2105.1098s
	iters: 5900, epoch: 2 | loss: 0.6139122
	speed: 0.0304s/iter; left time: 2101.6283s
	iters: 6000, epoch: 2 | loss: 0.6816844
	speed: 0.0304s/iter; left time: 2099.5369s
	iters: 6100, epoch: 2 | loss: 0.6423025
	speed: 0.0304s/iter; left time: 2095.3775s
	iters: 6200, epoch: 2 | loss: 0.6189327
	speed: 0.0304s/iter; left time: 2092.3156s
	iters: 6300, epoch: 2 | loss: 0.5468777
	speed: 0.0304s/iter; left time: 2089.2220s
	iters: 6400, epoch: 2 | loss: 0.6727536
	speed: 0.0304s/iter; left time: 2084.2178s
	iters: 6500, epoch: 2 | loss: 0.6213654
	speed: 0.0304s/iter; left time: 2083.0603s
	iters: 6600, epoch: 2 | loss: 0.6619548
	speed: 0.0304s/iter; left time: 2078.6473s
	iters: 6700, epoch: 2 | loss: 0.6575723
	speed: 0.0304s/iter; left time: 2075.5188s
	iters: 6800, epoch: 2 | loss: 0.6944238
	speed: 0.0304s/iter; left time: 2073.3661s
	iters: 6900, epoch: 2 | loss: 0.6950229
	speed: 0.0304s/iter; left time: 2070.1144s
	iters: 7000, epoch: 2 | loss: 0.4688865
	speed: 0.0304s/iter; left time: 2066.6351s
	iters: 7100, epoch: 2 | loss: 0.5932627
	speed: 0.0304s/iter; left time: 2065.2771s
	iters: 7200, epoch: 2 | loss: 0.6505768
	speed: 0.0304s/iter; left time: 2059.7323s
	iters: 7300, epoch: 2 | loss: 0.6338621
	speed: 0.0304s/iter; left time: 2058.2716s
	iters: 7400, epoch: 2 | loss: 0.7166699
	speed: 0.0304s/iter; left time: 2054.2535s
	iters: 7500, epoch: 2 | loss: 0.5304695
	speed: 0.0304s/iter; left time: 2051.1500s
	iters: 7600, epoch: 2 | loss: 0.6490908
	speed: 0.0304s/iter; left time: 2050.0605s
	iters: 7700, epoch: 2 | loss: 0.5624790
	speed: 0.0304s/iter; left time: 2046.0628s
	iters: 7800, epoch: 2 | loss: 0.7213682
	speed: 0.0304s/iter; left time: 2044.0431s
	iters: 7900, epoch: 2 | loss: 0.4512134
	speed: 0.0304s/iter; left time: 2038.1244s
	iters: 8000, epoch: 2 | loss: 0.6495094
	speed: 0.0305s/iter; left time: 2042.5719s
	iters: 8100, epoch: 2 | loss: 0.7202660
	speed: 0.0304s/iter; left time: 2031.8485s
	iters: 8200, epoch: 2 | loss: 0.6825005
	speed: 0.0304s/iter; left time: 2031.2468s
	iters: 8300, epoch: 2 | loss: 0.6436116
	speed: 0.0306s/iter; left time: 2042.5147s
Epoch: 2 cost time: 253.76331758499146
Epoch: 2, Steps: 8335 | Train Loss: 0.6310751 Vali Loss: 0.6578421 Test Loss: 0.5197136
Validation loss decreased (0.666419 --> 0.657842).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.6721168
	speed: 1.8794s/iter; left time: 125129.3147s
	iters: 200, epoch: 3 | loss: 0.6266036
	speed: 0.0304s/iter; left time: 2018.6209s
	iters: 300, epoch: 3 | loss: 0.5875984
	speed: 0.0303s/iter; left time: 2014.4523s
	iters: 400, epoch: 3 | loss: 0.6609671
	speed: 0.0304s/iter; left time: 2012.5639s
	iters: 500, epoch: 3 | loss: 0.5353124
	speed: 0.0304s/iter; left time: 2010.9254s
	iters: 600, epoch: 3 | loss: 0.6072978
	speed: 0.0305s/iter; left time: 2012.2535s
	iters: 700, epoch: 3 | loss: 0.6230043
	speed: 0.0305s/iter; left time: 2009.3205s
	iters: 800, epoch: 3 | loss: 0.5733107
	speed: 0.0305s/iter; left time: 2009.3372s
	iters: 900, epoch: 3 | loss: 0.6516602
	speed: 0.0304s/iter; left time: 1997.3596s
	iters: 1000, epoch: 3 | loss: 0.5873499
	speed: 0.0304s/iter; left time: 1995.4950s
	iters: 1100, epoch: 3 | loss: 0.5931565
	speed: 0.0305s/iter; left time: 1997.3554s
	iters: 1200, epoch: 3 | loss: 0.5751333
	speed: 0.0304s/iter; left time: 1988.5925s
	iters: 1300, epoch: 3 | loss: 0.6085476
	speed: 0.0305s/iter; left time: 1993.5764s
	iters: 1400, epoch: 3 | loss: 0.5991707
	speed: 0.0304s/iter; left time: 1982.8199s
	iters: 1500, epoch: 3 | loss: 0.6775015
	speed: 0.0304s/iter; left time: 1981.2924s
	iters: 1600, epoch: 3 | loss: 0.6859502
	speed: 0.0304s/iter; left time: 1977.3221s
	iters: 1700, epoch: 3 | loss: 0.6164965
	speed: 0.0304s/iter; left time: 1973.9046s
	iters: 1800, epoch: 3 | loss: 0.6178964
	speed: 0.0305s/iter; left time: 1979.0459s
	iters: 1900, epoch: 3 | loss: 0.5915037
	speed: 0.0304s/iter; left time: 1967.9672s
	iters: 2000, epoch: 3 | loss: 0.7224166
	speed: 0.0304s/iter; left time: 1965.0559s
	iters: 2100, epoch: 3 | loss: 0.6309546
	speed: 0.0304s/iter; left time: 1963.2103s
	iters: 2200, epoch: 3 | loss: 0.6399850
	speed: 0.0304s/iter; left time: 1960.3372s
	iters: 2300, epoch: 3 | loss: 0.6362195
	speed: 0.0304s/iter; left time: 1956.6743s
	iters: 2400, epoch: 3 | loss: 0.5940641
	speed: 0.0304s/iter; left time: 1952.3784s
	iters: 2500, epoch: 3 | loss: 0.5612994
	speed: 0.0304s/iter; left time: 1950.5712s
	iters: 2600, epoch: 3 | loss: 0.5803307
	speed: 0.0304s/iter; left time: 1947.8554s
	iters: 2700, epoch: 3 | loss: 0.7331975
	speed: 0.0304s/iter; left time: 1942.5910s
	iters: 2800, epoch: 3 | loss: 0.6084195
	speed: 0.0304s/iter; left time: 1939.7395s
	iters: 2900, epoch: 3 | loss: 0.6670874
	speed: 0.0304s/iter; left time: 1939.7933s
	iters: 3000, epoch: 3 | loss: 0.6525245
	speed: 0.0304s/iter; left time: 1935.0734s
	iters: 3100, epoch: 3 | loss: 0.5841400
	speed: 0.0304s/iter; left time: 1930.0772s
	iters: 3200, epoch: 3 | loss: 0.5807904
	speed: 0.0304s/iter; left time: 1930.1022s
	iters: 3300, epoch: 3 | loss: 0.5571633
	speed: 0.0304s/iter; left time: 1926.1850s
	iters: 3400, epoch: 3 | loss: 0.5499813
	speed: 0.0304s/iter; left time: 1923.5020s
	iters: 3500, epoch: 3 | loss: 0.5999781
	speed: 0.0304s/iter; left time: 1921.2355s
	iters: 3600, epoch: 3 | loss: 0.6130084
	speed: 0.0304s/iter; left time: 1917.4748s
	iters: 3700, epoch: 3 | loss: 0.6336731
	speed: 0.0304s/iter; left time: 1913.4020s
	iters: 3800, epoch: 3 | loss: 0.5989139
	speed: 0.0304s/iter; left time: 1912.3515s
	iters: 3900, epoch: 3 | loss: 0.5863981
	speed: 0.0304s/iter; left time: 1910.8626s
	iters: 4000, epoch: 3 | loss: 0.6166615
	speed: 0.0304s/iter; left time: 1906.0374s
	iters: 4100, epoch: 3 | loss: 0.6206505
	speed: 0.0304s/iter; left time: 1905.5312s
	iters: 4200, epoch: 3 | loss: 0.5616124
	speed: 0.0304s/iter; left time: 1900.1154s
	iters: 4300, epoch: 3 | loss: 0.6191816
	speed: 0.0304s/iter; left time: 1896.7436s
	iters: 4400, epoch: 3 | loss: 0.5231990
	speed: 0.0303s/iter; left time: 1888.0809s
	iters: 4500, epoch: 3 | loss: 0.7149400
	speed: 0.0304s/iter; left time: 1889.9166s
	iters: 4600, epoch: 3 | loss: 0.5434175
	speed: 0.0304s/iter; left time: 1886.6653s
	iters: 4700, epoch: 3 | loss: 0.6159731
	speed: 0.0304s/iter; left time: 1884.2064s
	iters: 4800, epoch: 3 | loss: 0.5624631
	speed: 0.0304s/iter; left time: 1880.9612s
	iters: 4900, epoch: 3 | loss: 0.7103451
	speed: 0.0304s/iter; left time: 1880.3698s
	iters: 5000, epoch: 3 | loss: 0.6694864
	speed: 0.0304s/iter; left time: 1876.5280s
	iters: 5100, epoch: 3 | loss: 0.6163614
	speed: 0.0304s/iter; left time: 1873.6530s
	iters: 5200, epoch: 3 | loss: 0.6226419
	speed: 0.0304s/iter; left time: 1867.8351s
	iters: 5300, epoch: 3 | loss: 0.6280405
	speed: 0.0304s/iter; left time: 1866.1131s
	iters: 5400, epoch: 3 | loss: 0.5825053
	speed: 0.0305s/iter; left time: 1866.2952s
	iters: 5500, epoch: 3 | loss: 0.6164333
	speed: 0.0304s/iter; left time: 1861.1430s
	iters: 5600, epoch: 3 | loss: 0.6351143
	speed: 0.0305s/iter; left time: 1860.5137s
	iters: 5700, epoch: 3 | loss: 0.5830160
	speed: 0.0304s/iter; left time: 1854.1076s
	iters: 5800, epoch: 3 | loss: 0.7066299
	speed: 0.0303s/iter; left time: 1843.5516s
	iters: 5900, epoch: 3 | loss: 0.6368775
	speed: 0.0304s/iter; left time: 1849.0425s
	iters: 6000, epoch: 3 | loss: 0.6323350
	speed: 0.0304s/iter; left time: 1845.8588s
	iters: 6100, epoch: 3 | loss: 0.6684863
	speed: 0.0304s/iter; left time: 1841.0061s
	iters: 6200, epoch: 3 | loss: 0.6019076
	speed: 0.0304s/iter; left time: 1839.4795s
	iters: 6300, epoch: 3 | loss: 0.6631187
	speed: 0.0304s/iter; left time: 1835.8925s
	iters: 6400, epoch: 3 | loss: 0.6365532
	speed: 0.0304s/iter; left time: 1832.5243s
	iters: 6500, epoch: 3 | loss: 0.5732102
	speed: 0.0304s/iter; left time: 1830.0670s
	iters: 6600, epoch: 3 | loss: 0.5620490
	speed: 0.0304s/iter; left time: 1827.0815s
	iters: 6700, epoch: 3 | loss: 0.5470788
	speed: 0.0302s/iter; left time: 1813.7177s
	iters: 6800, epoch: 3 | loss: 0.7538488
	speed: 0.0304s/iter; left time: 1819.2875s
	iters: 6900, epoch: 3 | loss: 0.5801103
	speed: 0.0303s/iter; left time: 1810.9474s
	iters: 7000, epoch: 3 | loss: 0.5238331
	speed: 0.0304s/iter; left time: 1814.3505s
	iters: 7100, epoch: 3 | loss: 0.6899139
	speed: 0.0304s/iter; left time: 1809.7887s
	iters: 7200, epoch: 3 | loss: 0.5446770
	speed: 0.0304s/iter; left time: 1807.8382s
	iters: 7300, epoch: 3 | loss: 0.5806510
	speed: 0.0304s/iter; left time: 1804.6529s
	iters: 7400, epoch: 3 | loss: 0.5242133
	speed: 0.0304s/iter; left time: 1801.9421s
	iters: 7500, epoch: 3 | loss: 0.6391313
	speed: 0.0304s/iter; left time: 1799.4039s
	iters: 7600, epoch: 3 | loss: 0.6840414
	speed: 0.0304s/iter; left time: 1797.8619s
	iters: 7700, epoch: 3 | loss: 0.5545630
	speed: 0.0304s/iter; left time: 1793.4157s
	iters: 7800, epoch: 3 | loss: 0.5087057
	speed: 0.0304s/iter; left time: 1792.2644s
	iters: 7900, epoch: 3 | loss: 0.6697716
	speed: 0.0304s/iter; left time: 1787.3168s
	iters: 8000, epoch: 3 | loss: 0.5787981
	speed: 0.0304s/iter; left time: 1785.7840s
	iters: 8100, epoch: 3 | loss: 0.4940318
	speed: 0.0304s/iter; left time: 1781.9019s
	iters: 8200, epoch: 3 | loss: 0.6631864
	speed: 0.0305s/iter; left time: 1782.7859s
	iters: 8300, epoch: 3 | loss: 0.6194432
	speed: 0.0304s/iter; left time: 1775.4586s
Epoch: 3 cost time: 253.74411058425903
Epoch: 3, Steps: 8335 | Train Loss: 0.6223222 Vali Loss: 0.6577185 Test Loss: 0.5187629
Validation loss decreased (0.657842 --> 0.657718).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5971345
	speed: 1.8816s/iter; left time: 109592.8815s
	iters: 200, epoch: 4 | loss: 0.5743043
	speed: 0.0304s/iter; left time: 1766.4075s
	iters: 300, epoch: 4 | loss: 0.6704252
	speed: 0.0302s/iter; left time: 1751.5358s
	iters: 400, epoch: 4 | loss: 0.5347090
	speed: 0.0306s/iter; left time: 1771.2811s
	iters: 500, epoch: 4 | loss: 0.5514504
	speed: 0.0303s/iter; left time: 1754.4645s
	iters: 600, epoch: 4 | loss: 0.5992454
	speed: 0.0304s/iter; left time: 1755.0805s
	iters: 700, epoch: 4 | loss: 0.5727578
	speed: 0.0304s/iter; left time: 1750.8753s
	iters: 800, epoch: 4 | loss: 0.6064169
	speed: 0.0305s/iter; left time: 1753.7201s
	iters: 900, epoch: 4 | loss: 0.5368361
	speed: 0.0304s/iter; left time: 1745.2966s
	iters: 1000, epoch: 4 | loss: 0.6536893
	speed: 0.0304s/iter; left time: 1744.6245s
	iters: 1100, epoch: 4 | loss: 0.6172667
	speed: 0.0304s/iter; left time: 1739.0156s
	iters: 1200, epoch: 4 | loss: 0.5944384
	speed: 0.0304s/iter; left time: 1736.4499s
	iters: 1300, epoch: 4 | loss: 0.5771031
	speed: 0.0304s/iter; left time: 1733.1987s
	iters: 1400, epoch: 4 | loss: 0.5715675
	speed: 0.0304s/iter; left time: 1730.0766s
	iters: 1500, epoch: 4 | loss: 0.6543842
	speed: 0.0304s/iter; left time: 1727.3999s
	iters: 1600, epoch: 4 | loss: 0.6180561
	speed: 0.0304s/iter; left time: 1723.7871s
	iters: 1700, epoch: 4 | loss: 0.6216651
	speed: 0.0304s/iter; left time: 1722.6987s
	iters: 1800, epoch: 4 | loss: 0.6385298
	speed: 0.0304s/iter; left time: 1718.6071s
	iters: 1900, epoch: 4 | loss: 0.6710116
	speed: 0.0304s/iter; left time: 1715.2671s
	iters: 2000, epoch: 4 | loss: 0.6183994
	speed: 0.0304s/iter; left time: 1711.7125s
	iters: 2100, epoch: 4 | loss: 0.7404727
	speed: 0.0304s/iter; left time: 1712.1149s
	iters: 2200, epoch: 4 | loss: 0.6244093
	speed: 0.0303s/iter; left time: 1703.4049s
	iters: 2300, epoch: 4 | loss: 0.6125079
	speed: 0.0304s/iter; left time: 1705.6042s
	iters: 2400, epoch: 4 | loss: 0.6139817
	speed: 0.0304s/iter; left time: 1699.0366s
	iters: 2500, epoch: 4 | loss: 0.6853344
	speed: 0.0304s/iter; left time: 1697.5875s
	iters: 2600, epoch: 4 | loss: 0.5963489
	speed: 0.0304s/iter; left time: 1695.7483s
	iters: 2700, epoch: 4 | loss: 0.6102874
	speed: 0.0304s/iter; left time: 1692.1117s
	iters: 2800, epoch: 4 | loss: 0.6717247
	speed: 0.0304s/iter; left time: 1689.9922s
	iters: 2900, epoch: 4 | loss: 0.6127375
	speed: 0.0304s/iter; left time: 1687.1612s
	iters: 3000, epoch: 4 | loss: 0.6475022
	speed: 0.0304s/iter; left time: 1683.4419s
	iters: 3100, epoch: 4 | loss: 0.6890985
	speed: 0.0304s/iter; left time: 1679.9896s
	iters: 3200, epoch: 4 | loss: 0.7275066
	speed: 0.0304s/iter; left time: 1677.5005s
	iters: 3300, epoch: 4 | loss: 0.5412375
	speed: 0.0304s/iter; left time: 1672.7141s
	iters: 3400, epoch: 4 | loss: 0.5348216
	speed: 0.0304s/iter; left time: 1672.7847s
	iters: 3500, epoch: 4 | loss: 0.5508627
	speed: 0.0304s/iter; left time: 1667.4654s
	iters: 3600, epoch: 4 | loss: 0.6139506
	speed: 0.0304s/iter; left time: 1665.3610s
	iters: 3700, epoch: 4 | loss: 0.6486554
	speed: 0.0306s/iter; left time: 1673.9865s
	iters: 3800, epoch: 4 | loss: 0.5128226
	speed: 0.0304s/iter; left time: 1660.5647s
	iters: 3900, epoch: 4 | loss: 0.5572070
	speed: 0.0305s/iter; left time: 1661.8251s
	iters: 4000, epoch: 4 | loss: 0.6319003
	speed: 0.0304s/iter; left time: 1653.4500s
	iters: 4100, epoch: 4 | loss: 0.5799206
	speed: 0.0304s/iter; left time: 1651.2691s
	iters: 4200, epoch: 4 | loss: 0.5359431
	speed: 0.0304s/iter; left time: 1647.5723s
	iters: 4300, epoch: 4 | loss: 0.6855618
	speed: 0.0304s/iter; left time: 1643.2307s
	iters: 4400, epoch: 4 | loss: 0.6079612
	speed: 0.0304s/iter; left time: 1642.3998s
	iters: 4500, epoch: 4 | loss: 0.6038285
	speed: 0.0304s/iter; left time: 1638.3970s
	iters: 4600, epoch: 4 | loss: 0.5830416
	speed: 0.0304s/iter; left time: 1634.9158s
	iters: 4700, epoch: 4 | loss: 0.5433279
	speed: 0.0304s/iter; left time: 1630.7708s
	iters: 4800, epoch: 4 | loss: 0.6108100
	speed: 0.0304s/iter; left time: 1629.7534s
	iters: 4900, epoch: 4 | loss: 0.6425648
	speed: 0.0305s/iter; left time: 1629.7629s
	iters: 5000, epoch: 4 | loss: 0.6481538
	speed: 0.0304s/iter; left time: 1622.0667s
	iters: 5100, epoch: 4 | loss: 0.6036162
	speed: 0.0304s/iter; left time: 1619.3454s
	iters: 5200, epoch: 4 | loss: 0.6614351
	speed: 0.0304s/iter; left time: 1617.2087s
	iters: 5300, epoch: 4 | loss: 0.5349063
	speed: 0.0305s/iter; left time: 1615.6205s
	iters: 5400, epoch: 4 | loss: 0.5682891
	speed: 0.0304s/iter; left time: 1607.9670s
	iters: 5500, epoch: 4 | loss: 0.6157428
	speed: 0.0304s/iter; left time: 1608.1184s
	iters: 5600, epoch: 4 | loss: 0.5832170
	speed: 0.0304s/iter; left time: 1604.5811s
	iters: 5700, epoch: 4 | loss: 0.6215614
	speed: 0.0304s/iter; left time: 1600.5512s
	iters: 5800, epoch: 4 | loss: 0.6317969
	speed: 0.0304s/iter; left time: 1598.0778s
	iters: 5900, epoch: 4 | loss: 0.5329221
	speed: 0.0304s/iter; left time: 1595.4619s
	iters: 6000, epoch: 4 | loss: 0.6212044
	speed: 0.0304s/iter; left time: 1591.4916s
	iters: 6100, epoch: 4 | loss: 0.6069258
	speed: 0.0304s/iter; left time: 1588.6027s
	iters: 6200, epoch: 4 | loss: 0.5977027
	speed: 0.0304s/iter; left time: 1584.6775s
	iters: 6300, epoch: 4 | loss: 0.6312069
	speed: 0.0304s/iter; left time: 1582.8828s
	iters: 6400, epoch: 4 | loss: 0.6335278
	speed: 0.0304s/iter; left time: 1581.0886s
	iters: 6500, epoch: 4 | loss: 0.5213408
	speed: 0.0305s/iter; left time: 1581.9930s
	iters: 6600, epoch: 4 | loss: 0.6085128
	speed: 0.0304s/iter; left time: 1572.8552s
	iters: 6700, epoch: 4 | loss: 0.5525891
	speed: 0.0304s/iter; left time: 1571.4073s
	iters: 6800, epoch: 4 | loss: 0.6148546
	speed: 0.0304s/iter; left time: 1566.7544s
	iters: 6900, epoch: 4 | loss: 0.6435069
	speed: 0.0304s/iter; left time: 1564.8335s
	iters: 7000, epoch: 4 | loss: 0.6849989
	speed: 0.0304s/iter; left time: 1560.6242s
	iters: 7100, epoch: 4 | loss: 0.5884336
	speed: 0.0304s/iter; left time: 1557.3047s
	iters: 7200, epoch: 4 | loss: 0.6949177
	speed: 0.0304s/iter; left time: 1555.6622s
	iters: 7300, epoch: 4 | loss: 0.6423187
	speed: 0.0304s/iter; left time: 1550.7869s
	iters: 7400, epoch: 4 | loss: 0.5521374
	speed: 0.0305s/iter; left time: 1555.8835s
	iters: 7500, epoch: 4 | loss: 0.6890791
	speed: 0.0304s/iter; left time: 1545.0796s
	iters: 7600, epoch: 4 | loss: 0.6337049
	speed: 0.0304s/iter; left time: 1543.7995s
	iters: 7700, epoch: 4 | loss: 0.5866285
	speed: 0.0304s/iter; left time: 1538.6905s
	iters: 7800, epoch: 4 | loss: 0.6729397
	speed: 0.0304s/iter; left time: 1534.8325s
	iters: 7900, epoch: 4 | loss: 0.6282888
	speed: 0.0305s/iter; left time: 1539.8877s
	iters: 8000, epoch: 4 | loss: 0.6567353
	speed: 0.0304s/iter; left time: 1530.7479s
	iters: 8100, epoch: 4 | loss: 0.6545236
	speed: 0.0304s/iter; left time: 1527.3701s
	iters: 8200, epoch: 4 | loss: 0.5616014
	speed: 0.0304s/iter; left time: 1525.3826s
	iters: 8300, epoch: 4 | loss: 0.6590984
	speed: 0.0304s/iter; left time: 1520.6797s
Epoch: 4 cost time: 253.86266112327576
Epoch: 4, Steps: 8335 | Train Loss: 0.6237173 Vali Loss: 0.6591763 Test Loss: 0.5182378
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5616264
	speed: 1.8816s/iter; left time: 93913.8364s
	iters: 200, epoch: 5 | loss: 0.5656624
	speed: 0.0304s/iter; left time: 1512.5675s
	iters: 300, epoch: 5 | loss: 0.5562940
	speed: 0.0303s/iter; left time: 1508.5938s
	iters: 400, epoch: 5 | loss: 0.6523123
	speed: 0.0304s/iter; left time: 1507.0116s
	iters: 500, epoch: 5 | loss: 0.5583315
	speed: 0.0304s/iter; left time: 1503.4119s
	iters: 600, epoch: 5 | loss: 0.5869236
	speed: 0.0304s/iter; left time: 1500.7569s
	iters: 700, epoch: 5 | loss: 0.5621483
	speed: 0.0304s/iter; left time: 1497.5567s
	iters: 800, epoch: 5 | loss: 0.7136714
	speed: 0.0305s/iter; left time: 1499.5179s
	iters: 900, epoch: 5 | loss: 0.5961380
	speed: 0.0304s/iter; left time: 1492.8404s
	iters: 1000, epoch: 5 | loss: 0.5502144
	speed: 0.0304s/iter; left time: 1489.3428s
	iters: 1100, epoch: 5 | loss: 0.5536261
	speed: 0.0303s/iter; left time: 1484.1190s
	iters: 1200, epoch: 5 | loss: 0.5372372
	speed: 0.0304s/iter; left time: 1483.1303s
	iters: 1300, epoch: 5 | loss: 0.6607596
	speed: 0.0304s/iter; left time: 1480.2839s
	iters: 1400, epoch: 5 | loss: 0.7696933
	speed: 0.0305s/iter; left time: 1481.3630s
	iters: 1500, epoch: 5 | loss: 0.6148594
	speed: 0.0304s/iter; left time: 1473.2967s
	iters: 1600, epoch: 5 | loss: 0.7093033
	speed: 0.0304s/iter; left time: 1471.9641s
	iters: 1700, epoch: 5 | loss: 0.6832493
	speed: 0.0304s/iter; left time: 1468.2146s
	iters: 1800, epoch: 5 | loss: 0.6752734
	speed: 0.0304s/iter; left time: 1466.1844s
	iters: 1900, epoch: 5 | loss: 0.6345780
	speed: 0.0304s/iter; left time: 1462.1044s
	iters: 2000, epoch: 5 | loss: 0.6182073
	speed: 0.0304s/iter; left time: 1459.3295s
	iters: 2100, epoch: 5 | loss: 0.5703813
	speed: 0.0304s/iter; left time: 1456.6038s
	iters: 2200, epoch: 5 | loss: 0.5849182
	speed: 0.0304s/iter; left time: 1451.3841s
	iters: 2300, epoch: 5 | loss: 0.5819533
	speed: 0.0304s/iter; left time: 1451.0744s
	iters: 2400, epoch: 5 | loss: 0.6853767
	speed: 0.0304s/iter; left time: 1449.1808s
	iters: 2500, epoch: 5 | loss: 0.6381768
	speed: 0.0304s/iter; left time: 1444.1972s
	iters: 2600, epoch: 5 | loss: 0.6046954
	speed: 0.0304s/iter; left time: 1442.6767s
	iters: 2700, epoch: 5 | loss: 0.6369364
	speed: 0.0304s/iter; left time: 1438.8189s
	iters: 2800, epoch: 5 | loss: 0.6240368
	speed: 0.0304s/iter; left time: 1434.8839s
	iters: 2900, epoch: 5 | loss: 0.6332073
	speed: 0.0304s/iter; left time: 1433.6049s
	iters: 3000, epoch: 5 | loss: 0.6622807
	speed: 0.0304s/iter; left time: 1430.1887s
	iters: 3100, epoch: 5 | loss: 0.5768144
	speed: 0.0304s/iter; left time: 1425.7830s
	iters: 3200, epoch: 5 | loss: 0.6890606
	speed: 0.0304s/iter; left time: 1423.4370s
	iters: 3300, epoch: 5 | loss: 0.6295680
	speed: 0.0304s/iter; left time: 1419.8663s
	iters: 3400, epoch: 5 | loss: 0.6438926
	speed: 0.0304s/iter; left time: 1416.3253s
	iters: 3500, epoch: 5 | loss: 0.5299217
	speed: 0.0304s/iter; left time: 1413.6189s
	iters: 3600, epoch: 5 | loss: 0.6305969
	speed: 0.0304s/iter; left time: 1409.9091s
	iters: 3700, epoch: 5 | loss: 0.6573953
	speed: 0.0304s/iter; left time: 1407.5118s
	iters: 3800, epoch: 5 | loss: 0.6396818
	speed: 0.0304s/iter; left time: 1403.7780s
	iters: 3900, epoch: 5 | loss: 0.6603479
	speed: 0.0304s/iter; left time: 1402.0127s
	iters: 4000, epoch: 5 | loss: 0.6447083
	speed: 0.0304s/iter; left time: 1399.5678s
	iters: 4100, epoch: 5 | loss: 0.6542969
	speed: 0.0304s/iter; left time: 1395.4274s
	iters: 4200, epoch: 5 | loss: 0.5930238
	speed: 0.0304s/iter; left time: 1393.2593s
	iters: 4300, epoch: 5 | loss: 0.6846657
	speed: 0.0304s/iter; left time: 1389.2129s
	iters: 4400, epoch: 5 | loss: 0.7121416
	speed: 0.0304s/iter; left time: 1388.3452s
	iters: 4500, epoch: 5 | loss: 0.5127347
	speed: 0.0304s/iter; left time: 1383.5669s
	iters: 4600, epoch: 5 | loss: 0.6579852
	speed: 0.0304s/iter; left time: 1381.6527s
	iters: 4700, epoch: 5 | loss: 0.6034975
	speed: 0.0304s/iter; left time: 1377.2577s
	iters: 4800, epoch: 5 | loss: 0.6912808
	speed: 0.0304s/iter; left time: 1374.7365s
	iters: 4900, epoch: 5 | loss: 0.6205492
	speed: 0.0304s/iter; left time: 1372.7655s
	iters: 5000, epoch: 5 | loss: 0.5513855
	speed: 0.0304s/iter; left time: 1368.1364s
	iters: 5100, epoch: 5 | loss: 0.7321556
	speed: 0.0305s/iter; left time: 1367.6332s
	iters: 5200, epoch: 5 | loss: 0.6257829
	speed: 0.0304s/iter; left time: 1364.3574s
	iters: 5300, epoch: 5 | loss: 0.6345418
	speed: 0.0304s/iter; left time: 1359.3536s
	iters: 5400, epoch: 5 | loss: 0.6232241
	speed: 0.0304s/iter; left time: 1356.6665s
	iters: 5500, epoch: 5 | loss: 0.6175850
	speed: 0.0304s/iter; left time: 1353.6542s
	iters: 5600, epoch: 5 | loss: 0.7219046
	speed: 0.0304s/iter; left time: 1351.3357s
	iters: 5700, epoch: 5 | loss: 0.6040660
	speed: 0.0304s/iter; left time: 1346.2916s
	iters: 5800, epoch: 5 | loss: 0.6543477
	speed: 0.0304s/iter; left time: 1344.7224s
	iters: 5900, epoch: 5 | loss: 0.5814553
	speed: 0.0304s/iter; left time: 1341.7362s
	iters: 6000, epoch: 5 | loss: 0.6010768
	speed: 0.0304s/iter; left time: 1336.3607s
	iters: 6100, epoch: 5 | loss: 0.7217984
	speed: 0.0304s/iter; left time: 1336.5943s
	iters: 6200, epoch: 5 | loss: 0.6275364
	speed: 0.0304s/iter; left time: 1333.5952s
	iters: 6300, epoch: 5 | loss: 0.6386024
	speed: 0.0304s/iter; left time: 1328.7936s
	iters: 6400, epoch: 5 | loss: 0.6682510
	speed: 0.0304s/iter; left time: 1325.0626s
	iters: 6500, epoch: 5 | loss: 0.7356443
	speed: 0.0304s/iter; left time: 1324.7840s
	iters: 6600, epoch: 5 | loss: 0.6560577
	speed: 0.0304s/iter; left time: 1320.1714s
	iters: 6700, epoch: 5 | loss: 0.6675148
	speed: 0.0304s/iter; left time: 1317.8929s
	iters: 6800, epoch: 5 | loss: 0.6235679
	speed: 0.0304s/iter; left time: 1314.7506s
	iters: 6900, epoch: 5 | loss: 0.6721147
	speed: 0.0304s/iter; left time: 1310.5599s
	iters: 7000, epoch: 5 | loss: 0.6301804
	speed: 0.0304s/iter; left time: 1307.7852s
	iters: 7100, epoch: 5 | loss: 0.5713279
	speed: 0.0304s/iter; left time: 1305.2382s
	iters: 7200, epoch: 5 | loss: 0.6973628
	speed: 0.0304s/iter; left time: 1301.2891s
	iters: 7300, epoch: 5 | loss: 0.6520050
	speed: 0.0304s/iter; left time: 1298.8702s
	iters: 7400, epoch: 5 | loss: 0.5701580
	speed: 0.0304s/iter; left time: 1296.5050s
	iters: 7500, epoch: 5 | loss: 0.6623181
	speed: 0.0304s/iter; left time: 1294.0703s
	iters: 7600, epoch: 5 | loss: 0.7473308
	speed: 0.0304s/iter; left time: 1290.0528s
	iters: 7700, epoch: 5 | loss: 0.6134549
	speed: 0.0304s/iter; left time: 1287.5333s
	iters: 7800, epoch: 5 | loss: 0.7426959
	speed: 0.0304s/iter; left time: 1283.8273s
	iters: 7900, epoch: 5 | loss: 0.7140943
	speed: 0.0304s/iter; left time: 1280.2463s
	iters: 8000, epoch: 5 | loss: 0.5140763
	speed: 0.0304s/iter; left time: 1277.6284s
	iters: 8100, epoch: 5 | loss: 0.7703462
	speed: 0.0304s/iter; left time: 1274.1760s
	iters: 8200, epoch: 5 | loss: 0.6870679
	speed: 0.0304s/iter; left time: 1271.3684s
	iters: 8300, epoch: 5 | loss: 0.6293009
	speed: 0.0304s/iter; left time: 1267.7788s
Epoch: 5 cost time: 253.78925347328186
Epoch: 5, Steps: 8335 | Train Loss: 0.6285350 Vali Loss: 0.7010906 Test Loss: 0.5410181
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.7694557
	speed: 1.8719s/iter; left time: 77824.7313s
	iters: 200, epoch: 6 | loss: 0.7466889
	speed: 0.0304s/iter; left time: 1259.1622s
	iters: 300, epoch: 6 | loss: 0.5443951
	speed: 0.0304s/iter; left time: 1256.4137s
	iters: 400, epoch: 6 | loss: 0.6573957
	speed: 0.0304s/iter; left time: 1254.0707s
	iters: 500, epoch: 6 | loss: 0.7239634
	speed: 0.0303s/iter; left time: 1249.0515s
	iters: 600, epoch: 6 | loss: 0.8133585
	speed: 0.0306s/iter; left time: 1257.2738s
	iters: 700, epoch: 6 | loss: 0.6262674
	speed: 0.0305s/iter; left time: 1249.9166s
	iters: 800, epoch: 6 | loss: 0.8151962
	speed: 0.0304s/iter; left time: 1242.1788s
	iters: 900, epoch: 6 | loss: 0.7465279
	speed: 0.0304s/iter; left time: 1239.2153s
	iters: 1000, epoch: 6 | loss: 0.6053014
	speed: 0.0304s/iter; left time: 1235.7075s
	iters: 1100, epoch: 6 | loss: 0.6024103
	speed: 0.0304s/iter; left time: 1233.2111s
	iters: 1200, epoch: 6 | loss: 0.7026803
	speed: 0.0304s/iter; left time: 1230.8855s
	iters: 1300, epoch: 6 | loss: 0.7573085
	speed: 0.0304s/iter; left time: 1227.0503s
	iters: 1400, epoch: 6 | loss: 0.6493468
	speed: 0.0304s/iter; left time: 1224.3720s
	iters: 1500, epoch: 6 | loss: 0.7077680
	speed: 0.0304s/iter; left time: 1220.8655s
	iters: 1600, epoch: 6 | loss: 0.6663373
	speed: 0.0304s/iter; left time: 1216.7372s
	iters: 1700, epoch: 6 | loss: 0.6572350
	speed: 0.0304s/iter; left time: 1215.2626s
	iters: 1800, epoch: 6 | loss: 0.7800807
	speed: 0.0304s/iter; left time: 1212.2930s
	iters: 1900, epoch: 6 | loss: 0.6698824
	speed: 0.0303s/iter; left time: 1206.6764s
	iters: 2000, epoch: 6 | loss: 0.7599804
	speed: 0.0304s/iter; left time: 1206.8414s
	iters: 2100, epoch: 6 | loss: 0.7788610
	speed: 0.0307s/iter; left time: 1214.0964s
	iters: 2200, epoch: 6 | loss: 0.5768013
	speed: 0.0304s/iter; left time: 1199.2525s
	iters: 2300, epoch: 6 | loss: 0.6566544
	speed: 0.0304s/iter; left time: 1195.8775s
	iters: 2400, epoch: 6 | loss: 0.7047036
	speed: 0.0304s/iter; left time: 1192.6289s
	iters: 2500, epoch: 6 | loss: 0.5833285
	speed: 0.0304s/iter; left time: 1190.7497s
	iters: 2600, epoch: 6 | loss: 0.7533457
	speed: 0.0304s/iter; left time: 1188.3758s
	iters: 2700, epoch: 6 | loss: 0.7372324
	speed: 0.0304s/iter; left time: 1184.1944s
	iters: 2800, epoch: 6 | loss: 0.6789564
	speed: 0.0304s/iter; left time: 1180.6391s
	iters: 2900, epoch: 6 | loss: 0.6100721
	speed: 0.0304s/iter; left time: 1178.3464s
	iters: 3000, epoch: 6 | loss: 0.7724395
	speed: 0.0305s/iter; left time: 1178.8530s
	iters: 3100, epoch: 6 | loss: 0.6278840
	speed: 0.0304s/iter; left time: 1171.4355s
	iters: 3200, epoch: 6 | loss: 0.6084180
	speed: 0.0304s/iter; left time: 1168.7909s
	iters: 3300, epoch: 6 | loss: 0.6485521
	speed: 0.0304s/iter; left time: 1166.2143s
	iters: 3400, epoch: 6 | loss: 0.6872050
	speed: 0.0304s/iter; left time: 1163.9481s
	iters: 3500, epoch: 6 | loss: 0.7710215
	speed: 0.0304s/iter; left time: 1159.5507s
	iters: 3600, epoch: 6 | loss: 0.7086792
	speed: 0.0304s/iter; left time: 1157.8519s
	iters: 3700, epoch: 6 | loss: 0.7310858
	speed: 0.0304s/iter; left time: 1154.1217s
	iters: 3800, epoch: 6 | loss: 0.7396754
	speed: 0.0304s/iter; left time: 1150.9781s
	iters: 3900, epoch: 6 | loss: 0.6210203
	speed: 0.0304s/iter; left time: 1147.6998s
	iters: 4000, epoch: 6 | loss: 0.7688931
	speed: 0.0304s/iter; left time: 1145.4509s
	iters: 4100, epoch: 6 | loss: 0.7541383
	speed: 0.0304s/iter; left time: 1141.2737s
	iters: 4200, epoch: 6 | loss: 0.6750742
	speed: 0.0304s/iter; left time: 1138.5623s
	iters: 4300, epoch: 6 | loss: 0.7034045
	speed: 0.0304s/iter; left time: 1135.3417s
	iters: 4400, epoch: 6 | loss: 0.7671145
	speed: 0.0304s/iter; left time: 1132.0829s
	iters: 4500, epoch: 6 | loss: 0.7792277
	speed: 0.0304s/iter; left time: 1131.1013s
	iters: 4600, epoch: 6 | loss: 0.7930484
	speed: 0.0304s/iter; left time: 1127.2025s
	iters: 4700, epoch: 6 | loss: 0.6113211
	speed: 0.0304s/iter; left time: 1123.1807s
	iters: 4800, epoch: 6 | loss: 0.6649467
	speed: 0.0304s/iter; left time: 1120.5568s
	iters: 4900, epoch: 6 | loss: 0.7046766
	speed: 0.0304s/iter; left time: 1118.1681s
	iters: 5000, epoch: 6 | loss: 0.6804783
	speed: 0.0304s/iter; left time: 1115.8819s
	iters: 5100, epoch: 6 | loss: 0.8016124
	speed: 0.0304s/iter; left time: 1111.7627s
	iters: 5200, epoch: 6 | loss: 0.7527587
	speed: 0.0303s/iter; left time: 1106.7272s
	iters: 5300, epoch: 6 | loss: 0.7204646
	speed: 0.0304s/iter; left time: 1105.3338s
	iters: 5400, epoch: 6 | loss: 0.7653587
	speed: 0.0304s/iter; left time: 1101.6947s
	iters: 5500, epoch: 6 | loss: 0.7029094
	speed: 0.0304s/iter; left time: 1099.8710s
	iters: 5600, epoch: 6 | loss: 0.6610293
	speed: 0.0304s/iter; left time: 1096.0176s
	iters: 5700, epoch: 6 | loss: 0.6478279
	speed: 0.0304s/iter; left time: 1093.2455s
	iters: 5800, epoch: 6 | loss: 0.7500297
	speed: 0.0304s/iter; left time: 1089.7724s
	iters: 5900, epoch: 6 | loss: 0.6599360
	speed: 0.0304s/iter; left time: 1086.8382s
	iters: 6000, epoch: 6 | loss: 0.6751362
	speed: 0.0304s/iter; left time: 1084.6849s
	iters: 6100, epoch: 6 | loss: 0.7265094
	speed: 0.0304s/iter; left time: 1081.0625s
	iters: 6200, epoch: 6 | loss: 0.5632406
	speed: 0.0304s/iter; left time: 1077.1358s
	iters: 6300, epoch: 6 | loss: 0.7885517
	speed: 0.0304s/iter; left time: 1074.3203s
	iters: 6400, epoch: 6 | loss: 0.7705705
	speed: 0.0304s/iter; left time: 1073.0728s
	iters: 6500, epoch: 6 | loss: 0.7857578
	speed: 0.0304s/iter; left time: 1068.2791s
	iters: 6600, epoch: 6 | loss: 0.8289756
	speed: 0.0304s/iter; left time: 1066.0036s
	iters: 6700, epoch: 6 | loss: 0.7087972
	speed: 0.0304s/iter; left time: 1063.0505s
	iters: 6800, epoch: 6 | loss: 0.7995681
	speed: 0.0304s/iter; left time: 1059.2109s
	iters: 6900, epoch: 6 | loss: 0.7568132
	speed: 0.0304s/iter; left time: 1057.4746s
	iters: 7000, epoch: 6 | loss: 0.6656801
	speed: 0.0304s/iter; left time: 1055.2678s
	iters: 7100, epoch: 6 | loss: 0.5933145
	speed: 0.0304s/iter; left time: 1051.2122s
	iters: 7200, epoch: 6 | loss: 0.6296018
	speed: 0.0304s/iter; left time: 1048.1877s
	iters: 7300, epoch: 6 | loss: 0.6936223
	speed: 0.0305s/iter; left time: 1048.1891s
	iters: 7400, epoch: 6 | loss: 0.7239472
	speed: 0.0304s/iter; left time: 1041.3598s
	iters: 7500, epoch: 6 | loss: 0.6411521
	speed: 0.0304s/iter; left time: 1039.1714s
	iters: 7600, epoch: 6 | loss: 0.7218434
	speed: 0.0304s/iter; left time: 1036.3359s
	iters: 7700, epoch: 6 | loss: 0.6558940
	speed: 0.0304s/iter; left time: 1032.9908s
	iters: 7800, epoch: 6 | loss: 0.7117534
	speed: 0.0304s/iter; left time: 1030.8277s
	iters: 7900, epoch: 6 | loss: 0.6769640
	speed: 0.0304s/iter; left time: 1025.7579s
	iters: 8000, epoch: 6 | loss: 0.6682066
	speed: 0.0304s/iter; left time: 1024.0351s
	iters: 8100, epoch: 6 | loss: 0.7653605
	speed: 0.0305s/iter; left time: 1024.8848s
	iters: 8200, epoch: 6 | loss: 0.7598269
	speed: 0.0304s/iter; left time: 1017.8722s
	iters: 8300, epoch: 6 | loss: 0.8204295
	speed: 0.0304s/iter; left time: 1014.7878s
Epoch: 6 cost time: 253.73652625083923
Epoch: 6, Steps: 8335 | Train Loss: 0.7121763 Vali Loss: 0.7832093 Test Loss: 0.6311962
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems03_h_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 37892
test shape: (37892, 1, 336, 151) (37892, 1, 336, 151)
test shape: (37892, 336, 151) (37892, 336, 151)
mse:0.5187581777572632, mae:0.5266625881195068
>>>>>>>Overall time: 2829 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
