Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems07_d.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems07_d_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_d_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5383
val 703
test 1497
	iters: 100, epoch: 1 | loss: 0.5738016
	speed: 0.3222s/iter; left time: 1050.8564s
	iters: 200, epoch: 1 | loss: 0.5598579
	speed: 0.3195s/iter; left time: 1009.7843s
	iters: 300, epoch: 1 | loss: 0.6603279
	speed: 0.3193s/iter; left time: 977.3150s
Epoch: 1 cost time: 107.6648998260498
Epoch: 1, Steps: 336 | Train Loss: 0.6155512 Vali Loss: 0.7702698 Test Loss: 1.4653507
Validation loss decreased (inf --> 0.770270).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5096583
	speed: 0.6644s/iter; left time: 1943.3850s
	iters: 200, epoch: 2 | loss: 0.5327454
	speed: 0.3193s/iter; left time: 902.0417s
	iters: 300, epoch: 2 | loss: 0.6348947
	speed: 0.3193s/iter; left time: 870.1796s
Epoch: 2 cost time: 107.43459558486938
Epoch: 2, Steps: 336 | Train Loss: 0.5817200 Vali Loss: 0.7605480 Test Loss: 1.4683586
Validation loss decreased (0.770270 --> 0.760548).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5378593
	speed: 0.6634s/iter; left time: 1717.4377s
	iters: 200, epoch: 3 | loss: 0.4995042
	speed: 0.3195s/iter; left time: 795.3030s
	iters: 300, epoch: 3 | loss: 0.6452823
	speed: 0.3193s/iter; left time: 762.9248s
Epoch: 3 cost time: 107.4655065536499
Epoch: 3, Steps: 336 | Train Loss: 0.5461434 Vali Loss: 0.7328262 Test Loss: 1.4258877
Validation loss decreased (0.760548 --> 0.732826).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.5587493
	speed: 0.6636s/iter; left time: 1495.1854s
	iters: 200, epoch: 4 | loss: 0.5227480
	speed: 0.3193s/iter; left time: 687.5140s
	iters: 300, epoch: 4 | loss: 0.4884998
	speed: 0.3194s/iter; left time: 655.7277s
Epoch: 4 cost time: 107.45520687103271
Epoch: 4, Steps: 336 | Train Loss: 0.5232004 Vali Loss: 0.7392023 Test Loss: 1.4266682
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.5229640
	speed: 0.6626s/iter; left time: 1270.2562s
	iters: 200, epoch: 5 | loss: 0.5561585
	speed: 0.3197s/iter; left time: 580.9074s
	iters: 300, epoch: 5 | loss: 0.4326412
	speed: 0.3196s/iter; left time: 548.7553s
Epoch: 5 cost time: 107.55380439758301
Epoch: 5, Steps: 336 | Train Loss: 0.5056028 Vali Loss: 0.7418926 Test Loss: 1.4356186
EarlyStopping counter: 2 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.4570537
	speed: 0.6633s/iter; left time: 1048.6263s
	iters: 200, epoch: 6 | loss: 0.4977384
	speed: 0.3197s/iter; left time: 473.4645s
	iters: 300, epoch: 6 | loss: 0.5392321
	speed: 0.3196s/iter; left time: 441.3363s
Epoch: 6 cost time: 107.51771545410156
Epoch: 6, Steps: 336 | Train Loss: 0.4936905 Vali Loss: 0.7412285 Test Loss: 1.4359630
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems07_d_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1497
test shape: (1497, 1, 96, 1613) (1497, 1, 96, 1613)
test shape: (1497, 96, 1613) (1497, 96, 1613)
mse:1.4258887767791748, mae:0.6132249236106873
>>>>>>>Overall time: 809 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
