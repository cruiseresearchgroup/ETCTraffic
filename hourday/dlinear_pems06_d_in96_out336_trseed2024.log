Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=130, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems06_d.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems06_d_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_d_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 3223
val 188
test 709
	iters: 100, epoch: 1 | loss: 0.9694523
	speed: 0.0138s/iter; left time: 275.6195s
Epoch: 1 cost time: 1.5190563201904297
Epoch: 1, Steps: 100 | Train Loss: 0.9543754 Vali Loss: 0.7488498 Test Loss: 0.6059666
Validation loss decreased (inf --> 0.748850).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7307770
	speed: 0.0327s/iter; left time: 647.7917s
Epoch: 2 cost time: 1.2938017845153809
Epoch: 2, Steps: 100 | Train Loss: 0.9038737 Vali Loss: 0.7470688 Test Loss: 0.5969802
Validation loss decreased (0.748850 --> 0.747069).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.8560327
	speed: 0.0314s/iter; left time: 618.9060s
Epoch: 3 cost time: 1.2627129554748535
Epoch: 3, Steps: 100 | Train Loss: 0.8962322 Vali Loss: 0.7497123 Test Loss: 0.5940049
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.7994474
	speed: 0.0317s/iter; left time: 621.2904s
Epoch: 4 cost time: 1.2207002639770508
Epoch: 4, Steps: 100 | Train Loss: 0.8940501 Vali Loss: 0.7327103 Test Loss: 0.5938036
Validation loss decreased (0.747069 --> 0.732710).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.8194687
	speed: 0.0317s/iter; left time: 618.7781s
Epoch: 5 cost time: 1.3190133571624756
Epoch: 5, Steps: 100 | Train Loss: 0.8938076 Vali Loss: 0.7325346 Test Loss: 0.5942590
Validation loss decreased (0.732710 --> 0.732535).  Saving model ...
	iters: 100, epoch: 6 | loss: 1.0043099
	speed: 0.0315s/iter; left time: 612.0219s
Epoch: 6 cost time: 1.2417597770690918
Epoch: 6, Steps: 100 | Train Loss: 0.8928613 Vali Loss: 0.7315027 Test Loss: 0.5944082
Validation loss decreased (0.732535 --> 0.731503).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.9995260
	speed: 0.0320s/iter; left time: 618.5682s
Epoch: 7 cost time: 1.2756030559539795
Epoch: 7, Steps: 100 | Train Loss: 0.8913060 Vali Loss: 0.7409233 Test Loss: 0.5941842
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 8 | loss: 0.8842991
	speed: 0.0315s/iter; left time: 604.5279s
Epoch: 8 cost time: 1.2655055522918701
Epoch: 8, Steps: 100 | Train Loss: 0.8926958 Vali Loss: 0.7234384 Test Loss: 0.5958924
Validation loss decreased (0.731503 --> 0.723438).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9394997
	speed: 0.0319s/iter; left time: 608.9421s
Epoch: 9 cost time: 1.2927017211914062
Epoch: 9, Steps: 100 | Train Loss: 0.8911664 Vali Loss: 0.7431709 Test Loss: 0.5940150
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.7345275
	speed: 0.0319s/iter; left time: 606.9694s
Epoch: 10 cost time: 1.2789788246154785
Epoch: 10, Steps: 100 | Train Loss: 0.8914872 Vali Loss: 0.7396320 Test Loss: 0.5942323
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 11 | loss: 0.8054240
	speed: 0.0316s/iter; left time: 597.8227s
Epoch: 11 cost time: 1.3008384704589844
Epoch: 11, Steps: 100 | Train Loss: 0.8918859 Vali Loss: 0.7531673 Test Loss: 0.5945795
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 1.0040976
	speed: 0.0316s/iter; left time: 593.4866s
Epoch: 12 cost time: 1.264519214630127
Epoch: 12, Steps: 100 | Train Loss: 0.8911179 Vali Loss: 0.7349731 Test Loss: 0.5955233
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 13 | loss: 1.1465522
	speed: 0.0323s/iter; left time: 604.6301s
Epoch: 13 cost time: 1.3002588748931885
Epoch: 13, Steps: 100 | Train Loss: 0.8917028 Vali Loss: 0.7502621 Test Loss: 0.5940399
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems06_d_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 709
test shape: (709, 1, 336, 130) (709, 1, 336, 130)
test shape: (709, 336, 130) (709, 336, 130)
mse:0.5958911180496216, mae:0.4367828071117401
>>>>>>>Overall time: 51 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
