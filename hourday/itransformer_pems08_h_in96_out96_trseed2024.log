Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=212, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems08_h.csv', dec_in=212, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=212, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems08_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_h_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 141281
val 20117
test 40325
	iters: 100, epoch: 1 | loss: 0.2088792
	speed: 0.0383s/iter; left time: 3379.0752s
	iters: 200, epoch: 1 | loss: 0.1845173
	speed: 0.0309s/iter; left time: 2725.0403s
	iters: 300, epoch: 1 | loss: 0.1862590
	speed: 0.0309s/iter; left time: 2719.4964s
	iters: 400, epoch: 1 | loss: 0.1629281
	speed: 0.0306s/iter; left time: 2692.9259s
	iters: 500, epoch: 1 | loss: 0.1915640
	speed: 0.0310s/iter; left time: 2722.0319s
	iters: 600, epoch: 1 | loss: 0.2142121
	speed: 0.0310s/iter; left time: 2715.5487s
	iters: 700, epoch: 1 | loss: 0.1513714
	speed: 0.0309s/iter; left time: 2707.0507s
	iters: 800, epoch: 1 | loss: 0.2283048
	speed: 0.0313s/iter; left time: 2734.5423s
	iters: 900, epoch: 1 | loss: 0.1529647
	speed: 0.0309s/iter; left time: 2698.2563s
	iters: 1000, epoch: 1 | loss: 0.1688897
	speed: 0.0310s/iter; left time: 2705.3216s
	iters: 1100, epoch: 1 | loss: 0.1579244
	speed: 0.0308s/iter; left time: 2683.4917s
	iters: 1200, epoch: 1 | loss: 0.2416916
	speed: 0.0304s/iter; left time: 2648.7376s
	iters: 1300, epoch: 1 | loss: 0.1825679
	speed: 0.0320s/iter; left time: 2784.3247s
	iters: 1400, epoch: 1 | loss: 0.2302789
	speed: 0.0302s/iter; left time: 2626.3374s
	iters: 1500, epoch: 1 | loss: 0.3128574
	speed: 0.0305s/iter; left time: 2644.6882s
	iters: 1600, epoch: 1 | loss: 0.4226587
	speed: 0.0309s/iter; left time: 2682.4482s
	iters: 1700, epoch: 1 | loss: 0.4817640
	speed: 0.0303s/iter; left time: 2626.9571s
	iters: 1800, epoch: 1 | loss: 0.5087977
	speed: 0.0307s/iter; left time: 2654.6503s
	iters: 1900, epoch: 1 | loss: 0.3149143
	speed: 0.0310s/iter; left time: 2678.3516s
	iters: 2000, epoch: 1 | loss: 0.3426195
	speed: 0.0305s/iter; left time: 2630.2585s
	iters: 2100, epoch: 1 | loss: 0.3044234
	speed: 0.0306s/iter; left time: 2637.8252s
	iters: 2200, epoch: 1 | loss: 0.3059413
	speed: 0.0303s/iter; left time: 2612.3716s
	iters: 2300, epoch: 1 | loss: 0.2971180
	speed: 0.0308s/iter; left time: 2649.5482s
	iters: 2400, epoch: 1 | loss: 0.3670819
	speed: 0.0308s/iter; left time: 2642.4284s
	iters: 2500, epoch: 1 | loss: 0.3885331
	speed: 0.0306s/iter; left time: 2627.0225s
	iters: 2600, epoch: 1 | loss: 0.3405672
	speed: 0.0306s/iter; left time: 2625.5095s
	iters: 2700, epoch: 1 | loss: 0.3058598
	speed: 0.0305s/iter; left time: 2610.1064s
	iters: 2800, epoch: 1 | loss: 0.2866776
	speed: 0.0305s/iter; left time: 2607.1565s
	iters: 2900, epoch: 1 | loss: 0.3288982
	speed: 0.0305s/iter; left time: 2606.5296s
	iters: 3000, epoch: 1 | loss: 0.3077855
	speed: 0.0310s/iter; left time: 2641.7700s
	iters: 3100, epoch: 1 | loss: 0.3086120
	speed: 0.0307s/iter; left time: 2616.1498s
	iters: 3200, epoch: 1 | loss: 0.2785699
	speed: 0.0305s/iter; left time: 2591.8750s
	iters: 3300, epoch: 1 | loss: 0.3552287
	speed: 0.0305s/iter; left time: 2595.2489s
	iters: 3400, epoch: 1 | loss: 0.4126195
	speed: 0.0307s/iter; left time: 2604.7358s
	iters: 3500, epoch: 1 | loss: 0.2873844
	speed: 0.0306s/iter; left time: 2595.7296s
	iters: 3600, epoch: 1 | loss: 0.3040510
	speed: 0.0307s/iter; left time: 2600.1825s
	iters: 3700, epoch: 1 | loss: 0.3726712
	speed: 0.0304s/iter; left time: 2574.9659s
	iters: 3800, epoch: 1 | loss: 0.3160949
	speed: 0.0306s/iter; left time: 2583.6309s
	iters: 3900, epoch: 1 | loss: 0.3585828
	speed: 0.0305s/iter; left time: 2574.4544s
	iters: 4000, epoch: 1 | loss: 0.3039564
	speed: 0.0307s/iter; left time: 2585.5693s
	iters: 4100, epoch: 1 | loss: 0.3197430
	speed: 0.0308s/iter; left time: 2594.5063s
	iters: 4200, epoch: 1 | loss: 0.2705282
	speed: 0.0307s/iter; left time: 2581.2239s
	iters: 4300, epoch: 1 | loss: 0.3307131
	speed: 0.0306s/iter; left time: 2571.3987s
	iters: 4400, epoch: 1 | loss: 0.3517324
	speed: 0.0305s/iter; left time: 2556.2174s
	iters: 4500, epoch: 1 | loss: 0.3845142
	speed: 0.0304s/iter; left time: 2546.5310s
	iters: 4600, epoch: 1 | loss: 0.4285500
	speed: 0.0306s/iter; left time: 2558.1326s
	iters: 4700, epoch: 1 | loss: 0.3177936
	speed: 0.0305s/iter; left time: 2550.6128s
	iters: 4800, epoch: 1 | loss: 0.3292972
	speed: 0.0303s/iter; left time: 2531.5218s
	iters: 4900, epoch: 1 | loss: 0.3230373
	speed: 0.0305s/iter; left time: 2543.9078s
	iters: 5000, epoch: 1 | loss: 0.3800026
	speed: 0.0305s/iter; left time: 2539.5007s
	iters: 5100, epoch: 1 | loss: 0.3818642
	speed: 0.0303s/iter; left time: 2523.0737s
	iters: 5200, epoch: 1 | loss: 0.3157519
	speed: 0.0305s/iter; left time: 2532.0821s
	iters: 5300, epoch: 1 | loss: 0.3444469
	speed: 0.0307s/iter; left time: 2546.9574s
	iters: 5400, epoch: 1 | loss: 0.3056203
	speed: 0.0305s/iter; left time: 2525.0824s
	iters: 5500, epoch: 1 | loss: 0.3525130
	speed: 0.0305s/iter; left time: 2521.7651s
	iters: 5600, epoch: 1 | loss: 0.3027820
	speed: 0.0307s/iter; left time: 2535.7572s
	iters: 5700, epoch: 1 | loss: 0.3060378
	speed: 0.0307s/iter; left time: 2538.9169s
	iters: 5800, epoch: 1 | loss: 0.3224824
	speed: 0.0305s/iter; left time: 2515.7777s
	iters: 5900, epoch: 1 | loss: 0.3298264
	speed: 0.0304s/iter; left time: 2506.0173s
	iters: 6000, epoch: 1 | loss: 0.2647645
	speed: 0.0304s/iter; left time: 2504.8138s
	iters: 6100, epoch: 1 | loss: 0.3360592
	speed: 0.0304s/iter; left time: 2500.8753s
	iters: 6200, epoch: 1 | loss: 0.2957269
	speed: 0.0306s/iter; left time: 2516.2563s
	iters: 6300, epoch: 1 | loss: 0.3154614
	speed: 0.0305s/iter; left time: 2503.9611s
	iters: 6400, epoch: 1 | loss: 0.3452116
	speed: 0.0308s/iter; left time: 2520.1771s
	iters: 6500, epoch: 1 | loss: 0.3237084
	speed: 0.0306s/iter; left time: 2499.1244s
	iters: 6600, epoch: 1 | loss: 0.3043311
	speed: 0.0306s/iter; left time: 2500.5422s
	iters: 6700, epoch: 1 | loss: 0.3148805
	speed: 0.0305s/iter; left time: 2490.2106s
	iters: 6800, epoch: 1 | loss: 0.6247531
	speed: 0.0305s/iter; left time: 2482.8790s
	iters: 6900, epoch: 1 | loss: 0.5177162
	speed: 0.0305s/iter; left time: 2481.9117s
	iters: 7000, epoch: 1 | loss: 0.4364937
	speed: 0.0305s/iter; left time: 2481.9648s
	iters: 7100, epoch: 1 | loss: 0.5420932
	speed: 0.0304s/iter; left time: 2470.5790s
	iters: 7200, epoch: 1 | loss: 0.4410558
	speed: 0.0305s/iter; left time: 2469.6253s
	iters: 7300, epoch: 1 | loss: 0.4086540
	speed: 0.0306s/iter; left time: 2481.1160s
	iters: 7400, epoch: 1 | loss: 0.4216670
	speed: 0.0307s/iter; left time: 2483.6923s
	iters: 7500, epoch: 1 | loss: 0.3933274
	speed: 0.0305s/iter; left time: 2464.2885s
	iters: 7600, epoch: 1 | loss: 0.3150247
	speed: 0.0306s/iter; left time: 2466.7382s
	iters: 7700, epoch: 1 | loss: 0.3787987
	speed: 0.0305s/iter; left time: 2461.6627s
	iters: 7800, epoch: 1 | loss: 0.3717128
	speed: 0.0307s/iter; left time: 2467.4463s
	iters: 7900, epoch: 1 | loss: 0.3166416
	speed: 0.0305s/iter; left time: 2455.4877s
	iters: 8000, epoch: 1 | loss: 0.3526594
	speed: 0.0305s/iter; left time: 2452.6722s
	iters: 8100, epoch: 1 | loss: 0.3754108
	speed: 0.0305s/iter; left time: 2447.9925s
	iters: 8200, epoch: 1 | loss: 0.3210689
	speed: 0.0304s/iter; left time: 2434.7524s
	iters: 8300, epoch: 1 | loss: 0.3391125
	speed: 0.0304s/iter; left time: 2434.5227s
	iters: 8400, epoch: 1 | loss: 0.3236085
	speed: 0.0304s/iter; left time: 2429.2296s
	iters: 8500, epoch: 1 | loss: 0.4515762
	speed: 0.0304s/iter; left time: 2422.3105s
	iters: 8600, epoch: 1 | loss: 0.3185335
	speed: 0.0305s/iter; left time: 2429.5475s
	iters: 8700, epoch: 1 | loss: 0.3542613
	speed: 0.0304s/iter; left time: 2419.3452s
	iters: 8800, epoch: 1 | loss: 0.3039187
	speed: 0.0305s/iter; left time: 2422.1185s
Epoch: 1 cost time: 271.1441044807434
Epoch: 1, Steps: 8830 | Train Loss: 0.3287619 Vali Loss: 0.4290000 Test Loss: 0.3630638
Validation loss decreased (inf --> 0.429000).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2875344
	speed: 2.0006s/iter; left time: 158791.9129s
	iters: 200, epoch: 2 | loss: 0.2817035
	speed: 0.0307s/iter; left time: 2437.2456s
	iters: 300, epoch: 2 | loss: 0.3685386
	speed: 0.0305s/iter; left time: 2412.7233s
	iters: 400, epoch: 2 | loss: 0.2845743
	speed: 0.0306s/iter; left time: 2416.3100s
	iters: 500, epoch: 2 | loss: 0.3018432
	speed: 0.0306s/iter; left time: 2416.8019s
	iters: 600, epoch: 2 | loss: 0.3212641
	speed: 0.0306s/iter; left time: 2410.9006s
	iters: 700, epoch: 2 | loss: 0.3697514
	speed: 0.0305s/iter; left time: 2402.4293s
	iters: 800, epoch: 2 | loss: 0.3138177
	speed: 0.0305s/iter; left time: 2399.0498s
	iters: 900, epoch: 2 | loss: 0.2730183
	speed: 0.0305s/iter; left time: 2396.1474s
	iters: 1000, epoch: 2 | loss: 0.3605710
	speed: 0.0305s/iter; left time: 2392.8356s
	iters: 1100, epoch: 2 | loss: 0.3026095
	speed: 0.0305s/iter; left time: 2392.4411s
	iters: 1200, epoch: 2 | loss: 0.3294560
	speed: 0.0305s/iter; left time: 2390.1302s
	iters: 1300, epoch: 2 | loss: 0.3127312
	speed: 0.0305s/iter; left time: 2387.0636s
	iters: 1400, epoch: 2 | loss: 0.3361969
	speed: 0.0306s/iter; left time: 2386.8722s
	iters: 1500, epoch: 2 | loss: 0.3547835
	speed: 0.0306s/iter; left time: 2385.2443s
	iters: 1600, epoch: 2 | loss: 0.3263929
	speed: 0.0306s/iter; left time: 2381.8066s
	iters: 1700, epoch: 2 | loss: 0.2931715
	speed: 0.0305s/iter; left time: 2374.4695s
	iters: 1800, epoch: 2 | loss: 0.3550971
	speed: 0.0306s/iter; left time: 2374.2285s
	iters: 1900, epoch: 2 | loss: 0.3211375
	speed: 0.0305s/iter; left time: 2368.6441s
	iters: 2000, epoch: 2 | loss: 0.3114806
	speed: 0.0306s/iter; left time: 2367.8370s
	iters: 2100, epoch: 2 | loss: 0.3471045
	speed: 0.0305s/iter; left time: 2362.6649s
	iters: 2200, epoch: 2 | loss: 0.3114749
	speed: 0.0306s/iter; left time: 2361.9688s
	iters: 2300, epoch: 2 | loss: 0.3969529
	speed: 0.0305s/iter; left time: 2357.0897s
	iters: 2400, epoch: 2 | loss: 0.3225737
	speed: 0.0306s/iter; left time: 2356.2756s
	iters: 2500, epoch: 2 | loss: 0.3517290
	speed: 0.0305s/iter; left time: 2349.0949s
	iters: 2600, epoch: 2 | loss: 0.3573166
	speed: 0.0305s/iter; left time: 2344.5132s
	iters: 2700, epoch: 2 | loss: 0.3291031
	speed: 0.0305s/iter; left time: 2339.8423s
	iters: 2800, epoch: 2 | loss: 0.3174595
	speed: 0.0305s/iter; left time: 2335.5955s
	iters: 2900, epoch: 2 | loss: 0.3398403
	speed: 0.0305s/iter; left time: 2332.5193s
	iters: 3000, epoch: 2 | loss: 0.3313009
	speed: 0.0304s/iter; left time: 2328.3965s
	iters: 3100, epoch: 2 | loss: 0.3607493
	speed: 0.0305s/iter; left time: 2328.5451s
	iters: 3200, epoch: 2 | loss: 0.3213278
	speed: 0.0305s/iter; left time: 2325.1008s
	iters: 3300, epoch: 2 | loss: 0.4040641
	speed: 0.0305s/iter; left time: 2322.4344s
	iters: 3400, epoch: 2 | loss: 0.3347311
	speed: 0.0305s/iter; left time: 2320.0195s
	iters: 3500, epoch: 2 | loss: 0.3176433
	speed: 0.0338s/iter; left time: 2565.0019s
	iters: 3600, epoch: 2 | loss: 0.3170007
	speed: 0.0313s/iter; left time: 2375.7336s
	iters: 3700, epoch: 2 | loss: 0.2847887
	speed: 0.0305s/iter; left time: 2307.3947s
	iters: 3800, epoch: 2 | loss: 0.3252481
	speed: 0.0305s/iter; left time: 2307.9112s
	iters: 3900, epoch: 2 | loss: 0.2959523
	speed: 0.0305s/iter; left time: 2306.0432s
	iters: 4000, epoch: 2 | loss: 0.3131096
	speed: 0.0305s/iter; left time: 2298.3180s
	iters: 4100, epoch: 2 | loss: 0.3537839
	speed: 0.0309s/iter; left time: 2326.1165s
	iters: 4200, epoch: 2 | loss: 0.3485525
	speed: 0.0305s/iter; left time: 2292.3480s
	iters: 4300, epoch: 2 | loss: 0.3936653
	speed: 0.0308s/iter; left time: 2317.6436s
	iters: 4400, epoch: 2 | loss: 0.4034864
	speed: 0.0347s/iter; left time: 2603.9954s
	iters: 4500, epoch: 2 | loss: 0.4842055
	speed: 0.0342s/iter; left time: 2567.4990s
	iters: 4600, epoch: 2 | loss: 0.3244439
	speed: 0.0341s/iter; left time: 2556.1797s
	iters: 4700, epoch: 2 | loss: 0.2994963
	speed: 0.0342s/iter; left time: 2557.7321s
	iters: 4800, epoch: 2 | loss: 0.4076019
	speed: 0.0338s/iter; left time: 2526.5307s
	iters: 4900, epoch: 2 | loss: 0.3629405
	speed: 0.0327s/iter; left time: 2441.7141s
	iters: 5000, epoch: 2 | loss: 0.2916586
	speed: 0.0304s/iter; left time: 2261.7412s
	iters: 5100, epoch: 2 | loss: 0.3754085
	speed: 0.0305s/iter; left time: 2265.2366s
	iters: 5200, epoch: 2 | loss: 0.3651302
	speed: 0.0305s/iter; left time: 2265.2212s
	iters: 5300, epoch: 2 | loss: 0.3711376
	speed: 0.0304s/iter; left time: 2252.0059s
	iters: 5400, epoch: 2 | loss: 0.4270563
	speed: 0.0304s/iter; left time: 2251.4329s
	iters: 5500, epoch: 2 | loss: 0.5195724
	speed: 0.0304s/iter; left time: 2250.5529s
	iters: 5600, epoch: 2 | loss: 0.3732516
	speed: 0.0304s/iter; left time: 2245.6671s
	iters: 5700, epoch: 2 | loss: 0.4615811
	speed: 0.0304s/iter; left time: 2243.5104s
	iters: 5800, epoch: 2 | loss: 0.6828542
	speed: 0.0304s/iter; left time: 2239.0871s
	iters: 5900, epoch: 2 | loss: 0.5673264
	speed: 0.0304s/iter; left time: 2235.6043s
	iters: 6000, epoch: 2 | loss: 0.6101008
	speed: 0.0343s/iter; left time: 2520.2310s
	iters: 6100, epoch: 2 | loss: 0.4576771
	speed: 0.0341s/iter; left time: 2499.1602s
	iters: 6200, epoch: 2 | loss: 0.4518310
	speed: 0.0342s/iter; left time: 2509.4452s
	iters: 6300, epoch: 2 | loss: 0.4556748
	speed: 0.0340s/iter; left time: 2490.0162s
	iters: 6400, epoch: 2 | loss: 0.4332781
	speed: 0.0305s/iter; left time: 2230.1393s
	iters: 6500, epoch: 2 | loss: 0.4898460
	speed: 0.0303s/iter; left time: 2211.3741s
	iters: 6600, epoch: 2 | loss: 0.4428891
	speed: 0.0304s/iter; left time: 2213.0015s
	iters: 6700, epoch: 2 | loss: 0.4997847
	speed: 0.0330s/iter; left time: 2402.7793s
	iters: 6800, epoch: 2 | loss: 0.5751657
	speed: 0.0306s/iter; left time: 2225.7717s
	iters: 6900, epoch: 2 | loss: 0.6656747
	speed: 0.0305s/iter; left time: 2213.6451s
	iters: 7000, epoch: 2 | loss: 0.4504997
	speed: 0.0304s/iter; left time: 2204.6249s
	iters: 7100, epoch: 2 | loss: 0.5071495
	speed: 0.0304s/iter; left time: 2198.2377s
	iters: 7200, epoch: 2 | loss: 0.6052962
	speed: 0.0304s/iter; left time: 2196.7162s
	iters: 7300, epoch: 2 | loss: 0.4395346
	speed: 0.0304s/iter; left time: 2191.7126s
	iters: 7400, epoch: 2 | loss: 0.5612938
	speed: 0.0304s/iter; left time: 2188.1718s
	iters: 7500, epoch: 2 | loss: 0.5772796
	speed: 0.0304s/iter; left time: 2185.5277s
	iters: 7600, epoch: 2 | loss: 0.5084086
	speed: 0.0304s/iter; left time: 2184.9354s
	iters: 7700, epoch: 2 | loss: 0.4899794
	speed: 0.0304s/iter; left time: 2179.6746s
	iters: 7800, epoch: 2 | loss: 0.5455115
	speed: 0.0304s/iter; left time: 2178.6413s
	iters: 7900, epoch: 2 | loss: 0.5897022
	speed: 0.0304s/iter; left time: 2173.7573s
	iters: 8000, epoch: 2 | loss: 0.5364521
	speed: 0.0303s/iter; left time: 2164.7454s
	iters: 8100, epoch: 2 | loss: 0.4701713
	speed: 0.0304s/iter; left time: 2168.2444s
	iters: 8200, epoch: 2 | loss: 0.5575002
	speed: 0.0304s/iter; left time: 2164.7395s
	iters: 8300, epoch: 2 | loss: 0.5803779
	speed: 0.0304s/iter; left time: 2160.9089s
	iters: 8400, epoch: 2 | loss: 0.5261843
	speed: 0.0304s/iter; left time: 2157.0261s
	iters: 8500, epoch: 2 | loss: 0.6744742
	speed: 0.0304s/iter; left time: 2154.8789s
	iters: 8600, epoch: 2 | loss: 0.4996409
	speed: 0.0305s/iter; left time: 2163.0448s
	iters: 8700, epoch: 2 | loss: 0.6280365
	speed: 0.0304s/iter; left time: 2149.0147s
	iters: 8800, epoch: 2 | loss: 0.6002128
	speed: 0.0304s/iter; left time: 2146.6351s
Epoch: 2 cost time: 273.8185565471649
Epoch: 2, Steps: 8830 | Train Loss: 0.4118406 Vali Loss: 0.7577747 Test Loss: 0.5947862
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5514631
	speed: 2.0981s/iter; left time: 148002.6306s
	iters: 200, epoch: 3 | loss: 0.5067936
	speed: 0.0305s/iter; left time: 2149.7907s
	iters: 300, epoch: 3 | loss: 0.4482281
	speed: 0.0304s/iter; left time: 2137.1545s
	iters: 400, epoch: 3 | loss: 0.4990186
	speed: 0.0314s/iter; left time: 2202.9786s
	iters: 500, epoch: 3 | loss: 0.5199755
	speed: 0.0313s/iter; left time: 2192.6442s
	iters: 600, epoch: 3 | loss: 0.5879599
	speed: 0.0348s/iter; left time: 2434.1348s
	iters: 700, epoch: 3 | loss: 0.5123414
	speed: 0.0306s/iter; left time: 2140.2541s
	iters: 800, epoch: 3 | loss: 0.6036589
	speed: 0.0326s/iter; left time: 2275.7000s
	iters: 900, epoch: 3 | loss: 0.6529081
	speed: 0.0308s/iter; left time: 2147.3400s
	iters: 1000, epoch: 3 | loss: 0.4776412
	speed: 0.0307s/iter; left time: 2136.3468s
	iters: 1100, epoch: 3 | loss: 0.5685509
	speed: 0.0305s/iter; left time: 2123.8297s
	iters: 1200, epoch: 3 | loss: 0.6298062
	speed: 0.0308s/iter; left time: 2140.3811s
	iters: 1300, epoch: 3 | loss: 0.5011173
	speed: 0.0307s/iter; left time: 2127.6780s
	iters: 1400, epoch: 3 | loss: 0.5507185
	speed: 0.0311s/iter; left time: 2151.1671s
	iters: 1500, epoch: 3 | loss: 0.4163905
	speed: 0.0306s/iter; left time: 2115.1997s
	iters: 1600, epoch: 3 | loss: 0.4903218
	speed: 0.0307s/iter; left time: 2120.3825s
	iters: 1700, epoch: 3 | loss: 0.6202966
	speed: 0.0305s/iter; left time: 2103.8801s
	iters: 1800, epoch: 3 | loss: 0.5369828
	speed: 0.0305s/iter; left time: 2098.6007s
	iters: 1900, epoch: 3 | loss: 0.6258192
	speed: 0.0304s/iter; left time: 2091.7514s
	iters: 2000, epoch: 3 | loss: 0.5790962
	speed: 0.0305s/iter; left time: 2091.4071s
	iters: 2100, epoch: 3 | loss: 0.4948616
	speed: 0.0305s/iter; left time: 2088.9510s
	iters: 2200, epoch: 3 | loss: 0.5754715
	speed: 0.0305s/iter; left time: 2086.9384s
	iters: 2300, epoch: 3 | loss: 0.4971730
	speed: 0.0305s/iter; left time: 2081.3641s
	iters: 2400, epoch: 3 | loss: 0.5255541
	speed: 0.0305s/iter; left time: 2082.4594s
	iters: 2500, epoch: 3 | loss: 0.4451329
	speed: 0.0304s/iter; left time: 2068.8751s
	iters: 2600, epoch: 3 | loss: 0.5213040
	speed: 0.0303s/iter; left time: 2059.4618s
	iters: 2700, epoch: 3 | loss: 0.5190386
	speed: 0.0303s/iter; left time: 2060.1749s
	iters: 2800, epoch: 3 | loss: 0.4571275
	speed: 0.0305s/iter; left time: 2066.0450s
	iters: 2900, epoch: 3 | loss: 0.4383743
	speed: 0.0305s/iter; left time: 2065.6554s
	iters: 3000, epoch: 3 | loss: 0.4485799
	speed: 0.0305s/iter; left time: 2061.7445s
	iters: 3100, epoch: 3 | loss: 0.4992509
	speed: 0.0304s/iter; left time: 2051.2673s
	iters: 3200, epoch: 3 | loss: 0.6487350
	speed: 0.0305s/iter; left time: 2055.4104s
	iters: 3300, epoch: 3 | loss: 0.4255200
	speed: 0.0302s/iter; left time: 2032.2754s
	iters: 3400, epoch: 3 | loss: 0.6809384
	speed: 0.0305s/iter; left time: 2048.5418s
	iters: 3500, epoch: 3 | loss: 0.5738077
	speed: 0.0306s/iter; left time: 2053.0023s
	iters: 3600, epoch: 3 | loss: 0.4131033
	speed: 0.0299s/iter; left time: 2007.0982s
	iters: 3700, epoch: 3 | loss: 0.4741851
	speed: 0.0304s/iter; left time: 2037.9481s
	iters: 3800, epoch: 3 | loss: 0.5009820
	speed: 0.0304s/iter; left time: 2034.4508s
	iters: 3900, epoch: 3 | loss: 0.4581094
	speed: 0.0304s/iter; left time: 2031.9707s
	iters: 4000, epoch: 3 | loss: 0.5531742
	speed: 0.0304s/iter; left time: 2025.2373s
	iters: 4100, epoch: 3 | loss: 0.5781323
	speed: 0.0305s/iter; left time: 2027.4301s
	iters: 4200, epoch: 3 | loss: 0.4963158
	speed: 0.0301s/iter; left time: 1996.8620s
	iters: 4300, epoch: 3 | loss: 0.6392662
	speed: 0.0303s/iter; left time: 2013.3793s
	iters: 4400, epoch: 3 | loss: 0.3926971
	speed: 0.0305s/iter; left time: 2019.2787s
	iters: 4500, epoch: 3 | loss: 0.4559536
	speed: 0.0305s/iter; left time: 2014.8167s
	iters: 4600, epoch: 3 | loss: 0.5188323
	speed: 0.0305s/iter; left time: 2016.1421s
	iters: 4700, epoch: 3 | loss: 0.5765014
	speed: 0.0305s/iter; left time: 2009.2315s
	iters: 4800, epoch: 3 | loss: 0.5762706
	speed: 0.0304s/iter; left time: 2001.7679s
	iters: 4900, epoch: 3 | loss: 0.4495073
	speed: 0.0304s/iter; left time: 1999.1627s
	iters: 5000, epoch: 3 | loss: 0.3608204
	speed: 0.0304s/iter; left time: 1995.9383s
	iters: 5100, epoch: 3 | loss: 0.4420578
	speed: 0.0303s/iter; left time: 1984.7388s
	iters: 5200, epoch: 3 | loss: 0.5252973
	speed: 0.0305s/iter; left time: 1993.5365s
	iters: 5300, epoch: 3 | loss: 0.5424179
	speed: 0.0305s/iter; left time: 1991.1331s
	iters: 5400, epoch: 3 | loss: 0.4942979
	speed: 0.0303s/iter; left time: 1975.0264s
	iters: 5500, epoch: 3 | loss: 0.6100633
	speed: 0.0305s/iter; left time: 1983.9035s
	iters: 5600, epoch: 3 | loss: 0.4275113
	speed: 0.0305s/iter; left time: 1982.1947s
	iters: 5700, epoch: 3 | loss: 0.4375930
	speed: 0.0304s/iter; left time: 1973.2319s
	iters: 5800, epoch: 3 | loss: 0.4498184
	speed: 0.0304s/iter; left time: 1974.0568s
	iters: 5900, epoch: 3 | loss: 0.4344739
	speed: 0.0304s/iter; left time: 1970.8239s
	iters: 6000, epoch: 3 | loss: 0.3987910
	speed: 0.0305s/iter; left time: 1971.3942s
	iters: 6100, epoch: 3 | loss: 0.5556557
	speed: 0.0305s/iter; left time: 1969.6624s
	iters: 6200, epoch: 3 | loss: 0.4619220
	speed: 0.0305s/iter; left time: 1964.8705s
	iters: 6300, epoch: 3 | loss: 0.5230568
	speed: 0.0305s/iter; left time: 1959.5501s
	iters: 6400, epoch: 3 | loss: 0.4135929
	speed: 0.0305s/iter; left time: 1957.5626s
	iters: 6500, epoch: 3 | loss: 0.4114713
	speed: 0.0304s/iter; left time: 1947.8302s
	iters: 6600, epoch: 3 | loss: 0.5478057
	speed: 0.0306s/iter; left time: 1959.9337s
	iters: 6700, epoch: 3 | loss: 0.5235023
	speed: 0.0305s/iter; left time: 1948.9068s
	iters: 6800, epoch: 3 | loss: 0.5236149
	speed: 0.0305s/iter; left time: 1946.6406s
	iters: 6900, epoch: 3 | loss: 0.6986648
	speed: 0.0304s/iter; left time: 1937.7841s
	iters: 7000, epoch: 3 | loss: 0.5652658
	speed: 0.0304s/iter; left time: 1933.0909s
	iters: 7100, epoch: 3 | loss: 0.4818087
	speed: 0.0305s/iter; left time: 1935.8747s
	iters: 7200, epoch: 3 | loss: 0.5643864
	speed: 0.0305s/iter; left time: 1934.0104s
	iters: 7300, epoch: 3 | loss: 0.6700112
	speed: 0.0304s/iter; left time: 1923.6874s
	iters: 7400, epoch: 3 | loss: 0.5677306
	speed: 0.0304s/iter; left time: 1925.2145s
	iters: 7500, epoch: 3 | loss: 0.5152367
	speed: 0.0305s/iter; left time: 1923.5574s
	iters: 7600, epoch: 3 | loss: 0.4822553
	speed: 0.0305s/iter; left time: 1922.8561s
	iters: 7700, epoch: 3 | loss: 0.5060472
	speed: 0.0304s/iter; left time: 1912.5040s
	iters: 7800, epoch: 3 | loss: 0.5364602
	speed: 0.0303s/iter; left time: 1905.6482s
	iters: 7900, epoch: 3 | loss: 0.4202037
	speed: 0.0305s/iter; left time: 1911.4487s
	iters: 8000, epoch: 3 | loss: 0.5397177
	speed: 0.0305s/iter; left time: 1911.8386s
	iters: 8100, epoch: 3 | loss: 0.6224100
	speed: 0.0305s/iter; left time: 1906.2542s
	iters: 8200, epoch: 3 | loss: 0.5749869
	speed: 0.0305s/iter; left time: 1901.6712s
	iters: 8300, epoch: 3 | loss: 0.6345645
	speed: 0.0305s/iter; left time: 1902.3279s
	iters: 8400, epoch: 3 | loss: 0.5275090
	speed: 0.0305s/iter; left time: 1897.8220s
	iters: 8500, epoch: 3 | loss: 0.4190931
	speed: 0.0305s/iter; left time: 1894.3985s
	iters: 8600, epoch: 3 | loss: 0.5148341
	speed: 0.0303s/iter; left time: 1882.9185s
	iters: 8700, epoch: 3 | loss: 0.4605176
	speed: 0.0303s/iter; left time: 1875.4009s
	iters: 8800, epoch: 3 | loss: 0.4540159
	speed: 0.0304s/iter; left time: 1879.5154s
Epoch: 3 cost time: 270.24432849884033
Epoch: 3, Steps: 8830 | Train Loss: 0.5095233 Vali Loss: 0.5872012 Test Loss: 0.5223842
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3889861
	speed: 1.9157s/iter; left time: 118218.1787s
	iters: 200, epoch: 4 | loss: 0.4005578
	speed: 0.0332s/iter; left time: 2047.2568s
	iters: 300, epoch: 4 | loss: 0.5254416
	speed: 0.0304s/iter; left time: 1870.9661s
	iters: 400, epoch: 4 | loss: 0.4379055
	speed: 0.0304s/iter; left time: 1869.2442s
	iters: 500, epoch: 4 | loss: 0.4945527
	speed: 0.0304s/iter; left time: 1861.2305s
	iters: 600, epoch: 4 | loss: 0.4501846
	speed: 0.0304s/iter; left time: 1860.1470s
	iters: 700, epoch: 4 | loss: 0.5138592
	speed: 0.0304s/iter; left time: 1855.7452s
	iters: 800, epoch: 4 | loss: 0.5128819
	speed: 0.0304s/iter; left time: 1853.1807s
	iters: 900, epoch: 4 | loss: 0.5190190
	speed: 0.0305s/iter; left time: 1859.9850s
	iters: 1000, epoch: 4 | loss: 0.4344280
	speed: 0.0303s/iter; left time: 1845.2336s
	iters: 1100, epoch: 4 | loss: 0.4914047
	speed: 0.0300s/iter; left time: 1820.3725s
	iters: 1200, epoch: 4 | loss: 0.4217991
	speed: 0.0304s/iter; left time: 1844.2394s
	iters: 1300, epoch: 4 | loss: 0.5071997
	speed: 0.0304s/iter; left time: 1839.3539s
	iters: 1400, epoch: 4 | loss: 0.4592474
	speed: 0.0304s/iter; left time: 1834.1928s
	iters: 1500, epoch: 4 | loss: 0.6219780
	speed: 0.0304s/iter; left time: 1835.2246s
	iters: 1600, epoch: 4 | loss: 0.4412341
	speed: 0.0304s/iter; left time: 1829.0770s
	iters: 1700, epoch: 4 | loss: 0.6036846
	speed: 0.0304s/iter; left time: 1825.0445s
	iters: 1800, epoch: 4 | loss: 0.4874001
	speed: 0.0304s/iter; left time: 1824.3840s
	iters: 1900, epoch: 4 | loss: 0.5260304
	speed: 0.0303s/iter; left time: 1814.6541s
	iters: 2000, epoch: 4 | loss: 0.5102130
	speed: 0.0304s/iter; left time: 1819.3168s
	iters: 2100, epoch: 4 | loss: 0.4877398
	speed: 0.0304s/iter; left time: 1814.8951s
	iters: 2200, epoch: 4 | loss: 0.5102265
	speed: 0.0304s/iter; left time: 1812.1562s
	iters: 2300, epoch: 4 | loss: 0.5237159
	speed: 0.0304s/iter; left time: 1808.9132s
	iters: 2400, epoch: 4 | loss: 0.4369815
	speed: 0.0304s/iter; left time: 1806.2808s
	iters: 2500, epoch: 4 | loss: 0.3433229
	speed: 0.0304s/iter; left time: 1805.9463s
	iters: 2600, epoch: 4 | loss: 0.4839211
	speed: 0.0304s/iter; left time: 1801.2262s
	iters: 2700, epoch: 4 | loss: 0.4471551
	speed: 0.0304s/iter; left time: 1797.7096s
	iters: 2800, epoch: 4 | loss: 0.4777780
	speed: 0.0305s/iter; left time: 1797.2452s
	iters: 2900, epoch: 4 | loss: 0.5825050
	speed: 0.0304s/iter; left time: 1791.4983s
	iters: 3000, epoch: 4 | loss: 0.5508998
	speed: 0.0304s/iter; left time: 1789.9817s
	iters: 3100, epoch: 4 | loss: 0.4571259
	speed: 0.0305s/iter; left time: 1791.9933s
	iters: 3200, epoch: 4 | loss: 0.4377272
	speed: 0.0304s/iter; left time: 1782.3291s
	iters: 3300, epoch: 4 | loss: 0.6853270
	speed: 0.0304s/iter; left time: 1776.6015s
	iters: 3400, epoch: 4 | loss: 0.4310793
	speed: 0.0304s/iter; left time: 1773.4919s
	iters: 3500, epoch: 4 | loss: 0.4777505
	speed: 0.0304s/iter; left time: 1771.0880s
	iters: 3600, epoch: 4 | loss: 0.5058156
	speed: 0.0303s/iter; left time: 1766.2359s
	iters: 3700, epoch: 4 | loss: 0.5560543
	speed: 0.0303s/iter; left time: 1761.1505s
	iters: 3800, epoch: 4 | loss: 0.5026629
	speed: 0.0305s/iter; left time: 1766.7527s
	iters: 3900, epoch: 4 | loss: 0.4393206
	speed: 0.0304s/iter; left time: 1759.5736s
	iters: 4000, epoch: 4 | loss: 0.4353964
	speed: 0.0304s/iter; left time: 1758.7609s
	iters: 4100, epoch: 4 | loss: 0.5603505
	speed: 0.0304s/iter; left time: 1752.7693s
	iters: 4200, epoch: 4 | loss: 0.4863857
	speed: 0.0304s/iter; left time: 1750.0923s
	iters: 4300, epoch: 4 | loss: 0.4519184
	speed: 0.0306s/iter; left time: 1760.2205s
	iters: 4400, epoch: 4 | loss: 0.4777626
	speed: 0.0304s/iter; left time: 1744.9180s
	iters: 4500, epoch: 4 | loss: 0.4445142
	speed: 0.0304s/iter; left time: 1741.2427s
	iters: 4600, epoch: 4 | loss: 0.5073445
	speed: 0.0304s/iter; left time: 1740.0088s
	iters: 4700, epoch: 4 | loss: 0.5133129
	speed: 0.0304s/iter; left time: 1737.6237s
	iters: 4800, epoch: 4 | loss: 0.4845784
	speed: 0.0304s/iter; left time: 1734.7140s
	iters: 4900, epoch: 4 | loss: 0.4380947
	speed: 0.0304s/iter; left time: 1729.6499s
	iters: 5000, epoch: 4 | loss: 0.4526598
	speed: 0.0304s/iter; left time: 1727.0538s
	iters: 5100, epoch: 4 | loss: 0.5299949
	speed: 0.0304s/iter; left time: 1723.4950s
	iters: 5200, epoch: 4 | loss: 0.4042243
	speed: 0.0306s/iter; left time: 1732.1590s
	iters: 5300, epoch: 4 | loss: 0.4995904
	speed: 0.0306s/iter; left time: 1728.8256s
	iters: 5400, epoch: 4 | loss: 0.3515097
	speed: 0.0307s/iter; left time: 1733.1414s
	iters: 5500, epoch: 4 | loss: 0.3984991
	speed: 0.0306s/iter; left time: 1720.9447s
	iters: 5600, epoch: 4 | loss: 0.4123870
	speed: 0.0305s/iter; left time: 1714.5829s
	iters: 5700, epoch: 4 | loss: 0.5625648
	speed: 0.0307s/iter; left time: 1722.4156s
	iters: 5800, epoch: 4 | loss: 0.4411741
	speed: 0.0308s/iter; left time: 1726.1197s
	iters: 5900, epoch: 4 | loss: 0.4604800
	speed: 0.0307s/iter; left time: 1718.1301s
	iters: 6000, epoch: 4 | loss: 0.5553905
	speed: 0.0306s/iter; left time: 1705.5997s
	iters: 6100, epoch: 4 | loss: 0.4058048
	speed: 0.0306s/iter; left time: 1704.3141s
	iters: 6200, epoch: 4 | loss: 0.5827807
	speed: 0.0307s/iter; left time: 1706.2101s
	iters: 6300, epoch: 4 | loss: 0.5010191
	speed: 0.0306s/iter; left time: 1701.2260s
	iters: 6400, epoch: 4 | loss: 0.4643993
	speed: 0.0307s/iter; left time: 1700.1309s
	iters: 6500, epoch: 4 | loss: 0.4951959
	speed: 0.0304s/iter; left time: 1681.9784s
	iters: 6600, epoch: 4 | loss: 0.4827800
	speed: 0.0305s/iter; left time: 1682.9418s
	iters: 6700, epoch: 4 | loss: 0.4242180
	speed: 0.0305s/iter; left time: 1682.8455s
	iters: 6800, epoch: 4 | loss: 0.5583232
	speed: 0.0306s/iter; left time: 1683.8769s
	iters: 6900, epoch: 4 | loss: 0.5641892
	speed: 0.0304s/iter; left time: 1671.9322s
	iters: 7000, epoch: 4 | loss: 0.5640006
	speed: 0.0305s/iter; left time: 1671.2097s
	iters: 7100, epoch: 4 | loss: 0.5158834
	speed: 0.0305s/iter; left time: 1667.4433s
	iters: 7200, epoch: 4 | loss: 0.5120181
	speed: 0.0303s/iter; left time: 1655.9236s
	iters: 7300, epoch: 4 | loss: 0.3686859
	speed: 0.0305s/iter; left time: 1661.3296s
	iters: 7400, epoch: 4 | loss: 0.4495244
	speed: 0.0302s/iter; left time: 1642.3809s
	iters: 7500, epoch: 4 | loss: 0.4593745
	speed: 0.0304s/iter; left time: 1650.8717s
	iters: 7600, epoch: 4 | loss: 0.3898380
	speed: 0.0305s/iter; left time: 1650.7623s
	iters: 7700, epoch: 4 | loss: 0.5548150
	speed: 0.0304s/iter; left time: 1646.9846s
	iters: 7800, epoch: 4 | loss: 0.5647411
	speed: 0.0304s/iter; left time: 1644.4423s
	iters: 7900, epoch: 4 | loss: 0.4776646
	speed: 0.0304s/iter; left time: 1640.5708s
	iters: 8000, epoch: 4 | loss: 0.3962944
	speed: 0.0305s/iter; left time: 1641.8104s
	iters: 8100, epoch: 4 | loss: 0.4096836
	speed: 0.0304s/iter; left time: 1630.2782s
	iters: 8200, epoch: 4 | loss: 0.4358731
	speed: 0.0307s/iter; left time: 1644.4221s
	iters: 8300, epoch: 4 | loss: 0.3980287
	speed: 0.0305s/iter; left time: 1631.0855s
	iters: 8400, epoch: 4 | loss: 0.4771022
	speed: 0.0304s/iter; left time: 1621.6011s
	iters: 8500, epoch: 4 | loss: 0.5115471
	speed: 0.0305s/iter; left time: 1623.6153s
	iters: 8600, epoch: 4 | loss: 0.5619197
	speed: 0.0304s/iter; left time: 1619.5453s
	iters: 8700, epoch: 4 | loss: 0.4031358
	speed: 0.0300s/iter; left time: 1593.2768s
	iters: 8800, epoch: 4 | loss: 0.3928236
	speed: 0.0302s/iter; left time: 1602.2205s
Epoch: 4 cost time: 269.86420822143555
Epoch: 4, Steps: 8830 | Train Loss: 0.4761458 Vali Loss: 0.5504034 Test Loss: 0.4940483
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems08_h_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 40325
test shape: (40325, 1, 96, 212) (40325, 1, 96, 212)
test shape: (40325, 96, 212) (40325, 96, 212)
mse:0.36306318640708923, mae:0.378757119178772
>>>>>>>Overall time: 2077 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
