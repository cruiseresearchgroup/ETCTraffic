Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_h.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_h_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_h_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 87425
val 12341
test 24869
	iters: 100, epoch: 1 | loss: 0.1691462
	speed: 0.0377s/iter; left time: 2054.0142s
	iters: 200, epoch: 1 | loss: 0.1628296
	speed: 0.0301s/iter; left time: 1640.7949s
	iters: 300, epoch: 1 | loss: 0.1940737
	speed: 0.0303s/iter; left time: 1644.4662s
	iters: 400, epoch: 1 | loss: 0.1475293
	speed: 0.0307s/iter; left time: 1662.8668s
	iters: 500, epoch: 1 | loss: 0.1509337
	speed: 0.0303s/iter; left time: 1641.5785s
	iters: 600, epoch: 1 | loss: 0.2198242
	speed: 0.0304s/iter; left time: 1640.6192s
	iters: 700, epoch: 1 | loss: 0.1154009
	speed: 0.0307s/iter; left time: 1655.8258s
	iters: 800, epoch: 1 | loss: 0.1157991
	speed: 0.0305s/iter; left time: 1639.6573s
	iters: 900, epoch: 1 | loss: 0.1031482
	speed: 0.0303s/iter; left time: 1629.2459s
	iters: 1000, epoch: 1 | loss: 0.1204256
	speed: 0.0303s/iter; left time: 1624.6644s
	iters: 1100, epoch: 1 | loss: 0.2979561
	speed: 0.0304s/iter; left time: 1625.9413s
	iters: 1200, epoch: 1 | loss: 0.1415631
	speed: 0.0304s/iter; left time: 1624.2690s
	iters: 1300, epoch: 1 | loss: 0.1499599
	speed: 0.0314s/iter; left time: 1677.1506s
	iters: 1400, epoch: 1 | loss: 0.1146994
	speed: 0.0314s/iter; left time: 1673.1206s
	iters: 1500, epoch: 1 | loss: 0.1279557
	speed: 0.0305s/iter; left time: 1620.3007s
	iters: 1600, epoch: 1 | loss: 0.1607725
	speed: 0.0304s/iter; left time: 1611.7651s
	iters: 1700, epoch: 1 | loss: 0.7996183
	speed: 0.0304s/iter; left time: 1609.1317s
	iters: 1800, epoch: 1 | loss: 0.4915328
	speed: 0.0304s/iter; left time: 1605.3484s
	iters: 1900, epoch: 1 | loss: 0.8918010
	speed: 0.0303s/iter; left time: 1596.2310s
	iters: 2000, epoch: 1 | loss: 0.7950591
	speed: 0.0304s/iter; left time: 1597.9453s
	iters: 2100, epoch: 1 | loss: 0.6637847
	speed: 0.0304s/iter; left time: 1595.9754s
	iters: 2200, epoch: 1 | loss: 0.5563338
	speed: 0.0304s/iter; left time: 1594.4951s
	iters: 2300, epoch: 1 | loss: 0.4323798
	speed: 0.0304s/iter; left time: 1590.3756s
	iters: 2400, epoch: 1 | loss: 0.3476220
	speed: 0.0302s/iter; left time: 1576.6587s
	iters: 2500, epoch: 1 | loss: 0.5160912
	speed: 0.0304s/iter; left time: 1583.5435s
	iters: 2600, epoch: 1 | loss: 0.8563416
	speed: 0.0305s/iter; left time: 1586.3061s
	iters: 2700, epoch: 1 | loss: 0.5234211
	speed: 0.0303s/iter; left time: 1571.7578s
	iters: 2800, epoch: 1 | loss: 0.5680624
	speed: 0.0305s/iter; left time: 1579.1500s
	iters: 2900, epoch: 1 | loss: 0.6815671
	speed: 0.0305s/iter; left time: 1576.8828s
	iters: 3000, epoch: 1 | loss: 0.6340305
	speed: 0.0305s/iter; left time: 1573.5092s
	iters: 3100, epoch: 1 | loss: 0.6089419
	speed: 0.0306s/iter; left time: 1578.9624s
	iters: 3200, epoch: 1 | loss: 0.5556540
	speed: 0.0309s/iter; left time: 1587.9845s
	iters: 3300, epoch: 1 | loss: 0.5733647
	speed: 0.0336s/iter; left time: 1723.5105s
	iters: 3400, epoch: 1 | loss: 0.5703521
	speed: 0.0342s/iter; left time: 1750.2115s
	iters: 3500, epoch: 1 | loss: 0.5209798
	speed: 0.0305s/iter; left time: 1560.9422s
	iters: 3600, epoch: 1 | loss: 0.7105747
	speed: 0.0308s/iter; left time: 1574.0983s
	iters: 3700, epoch: 1 | loss: 0.6871573
	speed: 0.0303s/iter; left time: 1545.7497s
	iters: 3800, epoch: 1 | loss: 0.5179769
	speed: 0.0329s/iter; left time: 1671.8547s
	iters: 3900, epoch: 1 | loss: 0.6669991
	speed: 0.0346s/iter; left time: 1754.1019s
	iters: 4000, epoch: 1 | loss: 0.6363344
	speed: 0.0330s/iter; left time: 1670.7643s
	iters: 4100, epoch: 1 | loss: 0.6081390
	speed: 0.0335s/iter; left time: 1692.5158s
	iters: 4200, epoch: 1 | loss: 0.5332101
	speed: 0.0308s/iter; left time: 1552.9317s
	iters: 4300, epoch: 1 | loss: 0.5283915
	speed: 0.0332s/iter; left time: 1672.9538s
	iters: 4400, epoch: 1 | loss: 0.6634971
	speed: 0.0349s/iter; left time: 1755.7562s
	iters: 4500, epoch: 1 | loss: 0.6415642
	speed: 0.0312s/iter; left time: 1562.5687s
	iters: 4600, epoch: 1 | loss: 0.5700809
	speed: 0.0303s/iter; left time: 1514.7393s
	iters: 4700, epoch: 1 | loss: 0.4876200
	speed: 0.0308s/iter; left time: 1537.5425s
	iters: 4800, epoch: 1 | loss: 0.3041646
	speed: 0.0303s/iter; left time: 1508.1363s
	iters: 4900, epoch: 1 | loss: 0.3789429
	speed: 0.0304s/iter; left time: 1512.6508s
	iters: 5000, epoch: 1 | loss: 0.2691963
	speed: 0.0307s/iter; left time: 1524.3896s
	iters: 5100, epoch: 1 | loss: 0.2819239
	speed: 0.0304s/iter; left time: 1504.0258s
	iters: 5200, epoch: 1 | loss: 0.2840625
	speed: 0.0304s/iter; left time: 1500.8495s
	iters: 5300, epoch: 1 | loss: 0.2239990
	speed: 0.0303s/iter; left time: 1492.6442s
	iters: 5400, epoch: 1 | loss: 0.4724363
	speed: 0.0302s/iter; left time: 1486.1546s
Epoch: 1 cost time: 170.15079927444458
Epoch: 1, Steps: 5464 | Train Loss: 0.4289702 Vali Loss: 0.2619797 Test Loss: 0.3928594
Validation loss decreased (inf --> 0.261980).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.4682057
	speed: 1.2422s/iter; left time: 60965.5557s
	iters: 200, epoch: 2 | loss: 0.4292063
	speed: 0.0315s/iter; left time: 1544.5496s
	iters: 300, epoch: 2 | loss: 0.3449789
	speed: 0.0309s/iter; left time: 1511.9688s
	iters: 400, epoch: 2 | loss: 0.3482269
	speed: 0.0308s/iter; left time: 1500.7739s
	iters: 500, epoch: 2 | loss: 0.2838022
	speed: 0.0304s/iter; left time: 1479.5356s
	iters: 600, epoch: 2 | loss: 0.4046331
	speed: 0.0307s/iter; left time: 1493.0115s
	iters: 700, epoch: 2 | loss: 0.4108663
	speed: 0.0306s/iter; left time: 1484.1708s
	iters: 800, epoch: 2 | loss: 0.3854167
	speed: 0.0319s/iter; left time: 1544.6926s
	iters: 900, epoch: 2 | loss: 0.2727526
	speed: 0.0309s/iter; left time: 1489.6226s
	iters: 1000, epoch: 2 | loss: 0.3415332
	speed: 0.0313s/iter; left time: 1509.9986s
	iters: 1100, epoch: 2 | loss: 0.3474317
	speed: 0.0302s/iter; left time: 1449.6704s
	iters: 1200, epoch: 2 | loss: 0.3263799
	speed: 0.0304s/iter; left time: 1457.6629s
	iters: 1300, epoch: 2 | loss: 0.3331705
	speed: 0.0304s/iter; left time: 1455.5053s
	iters: 1400, epoch: 2 | loss: 0.5275474
	speed: 0.0302s/iter; left time: 1442.4706s
	iters: 1500, epoch: 2 | loss: 0.5767992
	speed: 0.0303s/iter; left time: 1443.7042s
	iters: 1600, epoch: 2 | loss: 0.4192539
	speed: 0.0302s/iter; left time: 1435.0333s
	iters: 1700, epoch: 2 | loss: 0.4426666
	speed: 0.0303s/iter; left time: 1437.5417s
	iters: 1800, epoch: 2 | loss: 0.4350872
	speed: 0.0302s/iter; left time: 1431.3110s
	iters: 1900, epoch: 2 | loss: 0.3942058
	speed: 0.0304s/iter; left time: 1435.7015s
	iters: 2000, epoch: 2 | loss: 0.2835430
	speed: 0.0303s/iter; left time: 1429.7096s
	iters: 2100, epoch: 2 | loss: 0.3076479
	speed: 0.0304s/iter; left time: 1430.8528s
	iters: 2200, epoch: 2 | loss: 0.3156894
	speed: 0.0304s/iter; left time: 1426.3895s
	iters: 2300, epoch: 2 | loss: 0.2667982
	speed: 0.0304s/iter; left time: 1426.0265s
	iters: 2400, epoch: 2 | loss: 0.2716350
	speed: 0.0304s/iter; left time: 1422.1831s
	iters: 2500, epoch: 2 | loss: 0.3250963
	speed: 0.0303s/iter; left time: 1414.1512s
	iters: 2600, epoch: 2 | loss: 0.3790386
	speed: 0.0304s/iter; left time: 1418.2670s
	iters: 2700, epoch: 2 | loss: 0.2312993
	speed: 0.0302s/iter; left time: 1402.8174s
	iters: 2800, epoch: 2 | loss: 0.2989827
	speed: 0.0303s/iter; left time: 1404.5618s
	iters: 2900, epoch: 2 | loss: 0.3220943
	speed: 0.0303s/iter; left time: 1401.0902s
	iters: 3000, epoch: 2 | loss: 0.2970657
	speed: 0.0303s/iter; left time: 1398.8907s
	iters: 3100, epoch: 2 | loss: 0.3156492
	speed: 0.0306s/iter; left time: 1409.8323s
	iters: 3200, epoch: 2 | loss: 0.3795685
	speed: 0.0304s/iter; left time: 1397.8000s
	iters: 3300, epoch: 2 | loss: 0.3745978
	speed: 0.0304s/iter; left time: 1393.9905s
	iters: 3400, epoch: 2 | loss: 0.3728108
	speed: 0.0305s/iter; left time: 1394.2897s
	iters: 3500, epoch: 2 | loss: 0.2427772
	speed: 0.0304s/iter; left time: 1387.2426s
	iters: 3600, epoch: 2 | loss: 0.2957492
	speed: 0.0303s/iter; left time: 1379.7052s
	iters: 3700, epoch: 2 | loss: 0.2694762
	speed: 0.0303s/iter; left time: 1379.7374s
	iters: 3800, epoch: 2 | loss: 0.3098678
	speed: 0.0304s/iter; left time: 1378.9972s
	iters: 3900, epoch: 2 | loss: 0.2650003
	speed: 0.0304s/iter; left time: 1375.8646s
	iters: 4000, epoch: 2 | loss: 0.2313066
	speed: 0.0304s/iter; left time: 1374.3614s
	iters: 4100, epoch: 2 | loss: 0.2821851
	speed: 0.0302s/iter; left time: 1360.4706s
	iters: 4200, epoch: 2 | loss: 0.2506684
	speed: 0.0302s/iter; left time: 1359.5046s
	iters: 4300, epoch: 2 | loss: 0.2590607
	speed: 0.0302s/iter; left time: 1356.3639s
	iters: 4400, epoch: 2 | loss: 0.3097734
	speed: 0.0302s/iter; left time: 1350.6901s
	iters: 4500, epoch: 2 | loss: 0.2603500
	speed: 0.0305s/iter; left time: 1362.4411s
	iters: 4600, epoch: 2 | loss: 0.2830846
	speed: 0.0304s/iter; left time: 1355.4678s
	iters: 4700, epoch: 2 | loss: 0.3441708
	speed: 0.0303s/iter; left time: 1348.3033s
	iters: 4800, epoch: 2 | loss: 0.2634140
	speed: 0.0305s/iter; left time: 1353.8755s
	iters: 4900, epoch: 2 | loss: 0.4014497
	speed: 0.0308s/iter; left time: 1363.2037s
	iters: 5000, epoch: 2 | loss: 0.2234810
	speed: 0.0306s/iter; left time: 1353.0572s
	iters: 5100, epoch: 2 | loss: 0.2404048
	speed: 0.0304s/iter; left time: 1340.1357s
	iters: 5200, epoch: 2 | loss: 0.2650903
	speed: 0.0302s/iter; left time: 1329.8060s
	iters: 5300, epoch: 2 | loss: 0.3305975
	speed: 0.0307s/iter; left time: 1348.8814s
	iters: 5400, epoch: 2 | loss: 0.2739103
	speed: 0.0305s/iter; left time: 1337.2638s
Epoch: 2 cost time: 167.0519347190857
Epoch: 2, Steps: 5464 | Train Loss: 0.3242789 Vali Loss: 0.1913690 Test Loss: 0.2816910
Validation loss decreased (0.261980 --> 0.191369).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2735064
	speed: 1.2827s/iter; left time: 55941.0200s
	iters: 200, epoch: 3 | loss: 0.2732536
	speed: 0.0304s/iter; left time: 1324.3357s
	iters: 300, epoch: 3 | loss: 0.2220533
	speed: 0.0300s/iter; left time: 1302.4223s
	iters: 400, epoch: 3 | loss: 0.2515752
	speed: 0.0301s/iter; left time: 1305.7999s
	iters: 500, epoch: 3 | loss: 0.2824908
	speed: 0.0304s/iter; left time: 1313.0440s
	iters: 600, epoch: 3 | loss: 0.2399721
	speed: 0.0300s/iter; left time: 1293.2534s
	iters: 700, epoch: 3 | loss: 0.2906592
	speed: 0.0303s/iter; left time: 1302.2555s
	iters: 800, epoch: 3 | loss: 0.2173280
	speed: 0.0299s/iter; left time: 1283.2885s
	iters: 900, epoch: 3 | loss: 0.2997545
	speed: 0.0304s/iter; left time: 1300.7888s
	iters: 1000, epoch: 3 | loss: 0.3522867
	speed: 0.0304s/iter; left time: 1299.7654s
	iters: 1100, epoch: 3 | loss: 0.2531896
	speed: 0.0302s/iter; left time: 1285.8744s
	iters: 1200, epoch: 3 | loss: 0.3494487
	speed: 0.0301s/iter; left time: 1281.7464s
	iters: 1300, epoch: 3 | loss: 0.3578480
	speed: 0.0304s/iter; left time: 1290.5609s
	iters: 1400, epoch: 3 | loss: 0.2207226
	speed: 0.0301s/iter; left time: 1272.5360s
	iters: 1500, epoch: 3 | loss: 0.2045864
	speed: 0.0302s/iter; left time: 1275.6734s
	iters: 1600, epoch: 3 | loss: 0.2751152
	speed: 0.0304s/iter; left time: 1280.8695s
	iters: 1700, epoch: 3 | loss: 0.2666709
	speed: 0.0302s/iter; left time: 1269.7647s
	iters: 1800, epoch: 3 | loss: 0.2157744
	speed: 0.0302s/iter; left time: 1266.1320s
	iters: 1900, epoch: 3 | loss: 0.3971941
	speed: 0.0304s/iter; left time: 1270.6152s
	iters: 2000, epoch: 3 | loss: 0.2754387
	speed: 0.0301s/iter; left time: 1255.8935s
	iters: 2100, epoch: 3 | loss: 0.2481702
	speed: 0.0300s/iter; left time: 1247.8694s
	iters: 2200, epoch: 3 | loss: 0.3032602
	speed: 0.0298s/iter; left time: 1237.4522s
	iters: 2300, epoch: 3 | loss: 0.3193935
	speed: 0.0302s/iter; left time: 1250.3488s
	iters: 2400, epoch: 3 | loss: 0.2656713
	speed: 0.0304s/iter; left time: 1256.3058s
	iters: 2500, epoch: 3 | loss: 0.2392760
	speed: 0.0304s/iter; left time: 1251.0663s
	iters: 2600, epoch: 3 | loss: 0.2075950
	speed: 0.0304s/iter; left time: 1249.6954s
	iters: 2700, epoch: 3 | loss: 0.2542565
	speed: 0.0303s/iter; left time: 1243.1599s
	iters: 2800, epoch: 3 | loss: 0.3128892
	speed: 0.0304s/iter; left time: 1242.2250s
	iters: 2900, epoch: 3 | loss: 0.3250265
	speed: 0.0304s/iter; left time: 1240.4620s
	iters: 3000, epoch: 3 | loss: 0.2284158
	speed: 0.0304s/iter; left time: 1237.0657s
	iters: 3100, epoch: 3 | loss: 0.5044870
	speed: 0.0304s/iter; left time: 1233.2153s
	iters: 3200, epoch: 3 | loss: 0.2806359
	speed: 0.0302s/iter; left time: 1224.0563s
	iters: 3300, epoch: 3 | loss: 0.2488487
	speed: 0.0301s/iter; left time: 1217.7356s
	iters: 3400, epoch: 3 | loss: 0.2617532
	speed: 0.0304s/iter; left time: 1225.5503s
	iters: 3500, epoch: 3 | loss: 0.3251359
	speed: 0.0304s/iter; left time: 1221.7482s
	iters: 3600, epoch: 3 | loss: 0.2407517
	speed: 0.0304s/iter; left time: 1217.9437s
	iters: 3700, epoch: 3 | loss: 0.3151959
	speed: 0.0303s/iter; left time: 1212.8420s
	iters: 3800, epoch: 3 | loss: 0.2183781
	speed: 0.0304s/iter; left time: 1212.3063s
	iters: 3900, epoch: 3 | loss: 0.3222612
	speed: 0.0304s/iter; left time: 1210.0714s
	iters: 4000, epoch: 3 | loss: 0.2806617
	speed: 0.0302s/iter; left time: 1197.6608s
	iters: 4100, epoch: 3 | loss: 0.3112225
	speed: 0.0322s/iter; left time: 1275.8728s
	iters: 4200, epoch: 3 | loss: 0.3041460
	speed: 0.0302s/iter; left time: 1193.0908s
	iters: 4300, epoch: 3 | loss: 0.2882498
	speed: 0.0312s/iter; left time: 1229.8254s
	iters: 4400, epoch: 3 | loss: 0.2785723
	speed: 0.0341s/iter; left time: 1342.0739s
	iters: 4500, epoch: 3 | loss: 0.3466741
	speed: 0.0337s/iter; left time: 1322.2543s
	iters: 4600, epoch: 3 | loss: 0.2468470
	speed: 0.0334s/iter; left time: 1308.2244s
	iters: 4700, epoch: 3 | loss: 0.2278205
	speed: 0.0348s/iter; left time: 1357.5351s
	iters: 4800, epoch: 3 | loss: 0.3129869
	speed: 0.0349s/iter; left time: 1359.1938s
	iters: 4900, epoch: 3 | loss: 0.3292108
	speed: 0.0346s/iter; left time: 1341.4253s
	iters: 5000, epoch: 3 | loss: 0.2553390
	speed: 0.0350s/iter; left time: 1355.1962s
	iters: 5100, epoch: 3 | loss: 0.2348897
	speed: 0.0348s/iter; left time: 1345.2878s
	iters: 5200, epoch: 3 | loss: 0.2405438
	speed: 0.0351s/iter; left time: 1349.9134s
	iters: 5300, epoch: 3 | loss: 0.2682275
	speed: 0.0340s/iter; left time: 1304.6537s
	iters: 5400, epoch: 3 | loss: 0.2037452
	speed: 0.0343s/iter; left time: 1312.7009s
Epoch: 3 cost time: 170.9220757484436
Epoch: 3, Steps: 5464 | Train Loss: 0.2705783 Vali Loss: 0.1807431 Test Loss: 0.2666137
Validation loss decreased (0.191369 --> 0.180743).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.2347369
	speed: 1.1919s/iter; left time: 45468.1735s
	iters: 200, epoch: 4 | loss: 0.2032858
	speed: 0.0314s/iter; left time: 1194.8480s
	iters: 300, epoch: 4 | loss: 0.2197326
	speed: 0.0307s/iter; left time: 1164.9103s
	iters: 400, epoch: 4 | loss: 0.2066885
	speed: 0.0302s/iter; left time: 1141.9421s
	iters: 500, epoch: 4 | loss: 0.2273313
	speed: 0.0306s/iter; left time: 1153.4636s
	iters: 600, epoch: 4 | loss: 0.2367150
	speed: 0.0313s/iter; left time: 1177.7835s
	iters: 700, epoch: 4 | loss: 0.2857324
	speed: 0.0311s/iter; left time: 1169.4024s
	iters: 800, epoch: 4 | loss: 0.3105608
	speed: 0.0302s/iter; left time: 1130.2369s
	iters: 900, epoch: 4 | loss: 0.2717582
	speed: 0.0304s/iter; left time: 1134.6084s
	iters: 1000, epoch: 4 | loss: 0.1979522
	speed: 0.0304s/iter; left time: 1133.4680s
	iters: 1100, epoch: 4 | loss: 0.3038972
	speed: 0.0303s/iter; left time: 1126.1967s
	iters: 1200, epoch: 4 | loss: 0.2440195
	speed: 0.0304s/iter; left time: 1125.6864s
	iters: 1300, epoch: 4 | loss: 0.2759835
	speed: 0.0304s/iter; left time: 1122.2849s
	iters: 1400, epoch: 4 | loss: 0.2970689
	speed: 0.0304s/iter; left time: 1120.7389s
	iters: 1500, epoch: 4 | loss: 0.3329152
	speed: 0.0304s/iter; left time: 1115.9971s
	iters: 1600, epoch: 4 | loss: 0.2923862
	speed: 0.0304s/iter; left time: 1115.2976s
	iters: 1700, epoch: 4 | loss: 0.3065617
	speed: 0.0302s/iter; left time: 1103.8386s
	iters: 1800, epoch: 4 | loss: 0.3336236
	speed: 0.0319s/iter; left time: 1163.0774s
	iters: 1900, epoch: 4 | loss: 0.2097175
	speed: 0.0337s/iter; left time: 1223.8014s
	iters: 2000, epoch: 4 | loss: 0.2594188
	speed: 0.0320s/iter; left time: 1159.8303s
	iters: 2100, epoch: 4 | loss: 0.2715742
	speed: 0.0310s/iter; left time: 1121.7895s
	iters: 2200, epoch: 4 | loss: 0.2193672
	speed: 0.0304s/iter; left time: 1096.4880s
	iters: 2300, epoch: 4 | loss: 0.3654939
	speed: 0.0304s/iter; left time: 1093.2903s
	iters: 2400, epoch: 4 | loss: 0.2223669
	speed: 0.0303s/iter; left time: 1085.9911s
	iters: 2500, epoch: 4 | loss: 0.2718578
	speed: 0.0301s/iter; left time: 1076.0711s
	iters: 2600, epoch: 4 | loss: 0.2910879
	speed: 0.0303s/iter; left time: 1080.5352s
	iters: 2700, epoch: 4 | loss: 0.2186966
	speed: 0.0303s/iter; left time: 1076.7833s
	iters: 2800, epoch: 4 | loss: 0.3262304
	speed: 0.0304s/iter; left time: 1078.3517s
	iters: 2900, epoch: 4 | loss: 0.2476131
	speed: 0.0304s/iter; left time: 1073.1945s
	iters: 3000, epoch: 4 | loss: 0.3813615
	speed: 0.0303s/iter; left time: 1068.1644s
	iters: 3100, epoch: 4 | loss: 0.2305004
	speed: 0.0300s/iter; left time: 1053.5613s
	iters: 3200, epoch: 4 | loss: 0.2691195
	speed: 0.0304s/iter; left time: 1065.0607s
	iters: 3300, epoch: 4 | loss: 0.2426244
	speed: 0.0304s/iter; left time: 1061.7661s
	iters: 3400, epoch: 4 | loss: 0.2542017
	speed: 0.0302s/iter; left time: 1052.0673s
	iters: 3500, epoch: 4 | loss: 0.2855962
	speed: 0.0304s/iter; left time: 1055.2255s
	iters: 3600, epoch: 4 | loss: 0.2282600
	speed: 0.0304s/iter; left time: 1051.7287s
	iters: 3700, epoch: 4 | loss: 0.2492901
	speed: 0.0300s/iter; left time: 1037.3779s
	iters: 3800, epoch: 4 | loss: 0.3035956
	speed: 0.0301s/iter; left time: 1038.0237s
	iters: 3900, epoch: 4 | loss: 0.2666657
	speed: 0.0301s/iter; left time: 1034.9643s
	iters: 4000, epoch: 4 | loss: 0.2083007
	speed: 0.0300s/iter; left time: 1028.9529s
	iters: 4100, epoch: 4 | loss: 0.2676712
	speed: 0.0304s/iter; left time: 1036.7182s
	iters: 4200, epoch: 4 | loss: 0.1865326
	speed: 0.0303s/iter; left time: 1031.4813s
	iters: 4300, epoch: 4 | loss: 0.2892869
	speed: 0.0304s/iter; left time: 1031.8326s
	iters: 4400, epoch: 4 | loss: 0.2349297
	speed: 0.0303s/iter; left time: 1026.1264s
	iters: 4500, epoch: 4 | loss: 0.2505156
	speed: 0.0304s/iter; left time: 1025.2480s
	iters: 4600, epoch: 4 | loss: 0.2436962
	speed: 0.0304s/iter; left time: 1022.4255s
	iters: 4700, epoch: 4 | loss: 0.2269225
	speed: 0.0305s/iter; left time: 1022.5328s
	iters: 4800, epoch: 4 | loss: 0.2687941
	speed: 0.0304s/iter; left time: 1016.0802s
	iters: 4900, epoch: 4 | loss: 0.3561709
	speed: 0.0304s/iter; left time: 1013.7820s
	iters: 5000, epoch: 4 | loss: 0.2050294
	speed: 0.0302s/iter; left time: 1004.0339s
	iters: 5100, epoch: 4 | loss: 0.3160863
	speed: 0.0304s/iter; left time: 1007.6208s
	iters: 5200, epoch: 4 | loss: 0.2078867
	speed: 0.0300s/iter; left time: 992.8953s
	iters: 5300, epoch: 4 | loss: 0.2662601
	speed: 0.0304s/iter; left time: 1003.1042s
	iters: 5400, epoch: 4 | loss: 0.2477387
	speed: 0.0303s/iter; left time: 995.6990s
Epoch: 4 cost time: 167.33343172073364
Epoch: 4, Steps: 5464 | Train Loss: 0.2610318 Vali Loss: 0.1812583 Test Loss: 0.2616607
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2194545
	speed: 1.2158s/iter; left time: 39738.7108s
	iters: 200, epoch: 5 | loss: 0.3092457
	speed: 0.0300s/iter; left time: 978.1302s
	iters: 300, epoch: 5 | loss: 0.1976426
	speed: 0.0304s/iter; left time: 988.7747s
	iters: 400, epoch: 5 | loss: 0.2301894
	speed: 0.0311s/iter; left time: 1006.6344s
	iters: 500, epoch: 5 | loss: 0.2473259
	speed: 0.0303s/iter; left time: 979.1695s
	iters: 600, epoch: 5 | loss: 0.2640117
	speed: 0.0303s/iter; left time: 975.1687s
	iters: 700, epoch: 5 | loss: 0.2321874
	speed: 0.0304s/iter; left time: 975.2964s
	iters: 800, epoch: 5 | loss: 0.1835376
	speed: 0.0304s/iter; left time: 971.7003s
	iters: 900, epoch: 5 | loss: 0.2722460
	speed: 0.0302s/iter; left time: 963.6311s
	iters: 1000, epoch: 5 | loss: 0.2043470
	speed: 0.0303s/iter; left time: 963.8233s
	iters: 1100, epoch: 5 | loss: 0.2586912
	speed: 0.0304s/iter; left time: 964.1948s
	iters: 1200, epoch: 5 | loss: 0.2432837
	speed: 0.0302s/iter; left time: 953.8258s
	iters: 1300, epoch: 5 | loss: 0.2348022
	speed: 0.0301s/iter; left time: 946.8298s
	iters: 1400, epoch: 5 | loss: 0.2682092
	speed: 0.0303s/iter; left time: 949.8877s
	iters: 1500, epoch: 5 | loss: 0.2645770
	speed: 0.0301s/iter; left time: 943.0875s
	iters: 1600, epoch: 5 | loss: 0.2502998
	speed: 0.0304s/iter; left time: 948.8940s
	iters: 1700, epoch: 5 | loss: 0.2557528
	speed: 0.0304s/iter; left time: 944.2474s
	iters: 1800, epoch: 5 | loss: 0.2987310
	speed: 0.0304s/iter; left time: 941.5957s
	iters: 1900, epoch: 5 | loss: 0.1867526
	speed: 0.0302s/iter; left time: 933.6881s
	iters: 2000, epoch: 5 | loss: 0.1830311
	speed: 0.0304s/iter; left time: 935.1651s
	iters: 2100, epoch: 5 | loss: 0.2514977
	speed: 0.0303s/iter; left time: 930.3430s
	iters: 2200, epoch: 5 | loss: 0.2806771
	speed: 0.0304s/iter; left time: 929.9292s
	iters: 2300, epoch: 5 | loss: 0.1894659
	speed: 0.0304s/iter; left time: 928.2363s
	iters: 2400, epoch: 5 | loss: 0.2527129
	speed: 0.0304s/iter; left time: 924.6103s
	iters: 2500, epoch: 5 | loss: 0.3201629
	speed: 0.0304s/iter; left time: 919.6091s
	iters: 2600, epoch: 5 | loss: 0.2883537
	speed: 0.0300s/iter; left time: 905.8928s
	iters: 2700, epoch: 5 | loss: 0.2423534
	speed: 0.0302s/iter; left time: 907.6393s
	iters: 2800, epoch: 5 | loss: 0.2400472
	speed: 0.0301s/iter; left time: 903.5541s
	iters: 2900, epoch: 5 | loss: 0.2588612
	speed: 0.0302s/iter; left time: 901.1550s
	iters: 3000, epoch: 5 | loss: 0.2363897
	speed: 0.0299s/iter; left time: 889.6094s
	iters: 3100, epoch: 5 | loss: 0.2297220
	speed: 0.0303s/iter; left time: 899.8420s
	iters: 3200, epoch: 5 | loss: 0.2116778
	speed: 0.0304s/iter; left time: 900.1080s
	iters: 3300, epoch: 5 | loss: 0.4014878
	speed: 0.0304s/iter; left time: 895.3046s
	iters: 3400, epoch: 5 | loss: 0.2297672
	speed: 0.0301s/iter; left time: 885.6076s
	iters: 3500, epoch: 5 | loss: 0.2366357
	speed: 0.0303s/iter; left time: 887.9213s
	iters: 3600, epoch: 5 | loss: 0.2984316
	speed: 0.0304s/iter; left time: 888.5154s
	iters: 3700, epoch: 5 | loss: 0.2129191
	speed: 0.0304s/iter; left time: 884.2399s
	iters: 3800, epoch: 5 | loss: 0.2881291
	speed: 0.0302s/iter; left time: 875.3220s
	iters: 3900, epoch: 5 | loss: 0.1916967
	speed: 0.0303s/iter; left time: 876.5818s
	iters: 4000, epoch: 5 | loss: 0.1950273
	speed: 0.0302s/iter; left time: 868.4124s
	iters: 4100, epoch: 5 | loss: 0.2510753
	speed: 0.0304s/iter; left time: 871.2396s
	iters: 4200, epoch: 5 | loss: 0.3048787
	speed: 0.0303s/iter; left time: 865.7135s
	iters: 4300, epoch: 5 | loss: 0.2181589
	speed: 0.0304s/iter; left time: 865.9577s
	iters: 4400, epoch: 5 | loss: 0.2409678
	speed: 0.0302s/iter; left time: 858.4824s
	iters: 4500, epoch: 5 | loss: 0.2358860
	speed: 0.0306s/iter; left time: 864.4247s
	iters: 4600, epoch: 5 | loss: 0.2803941
	speed: 0.0302s/iter; left time: 849.9631s
	iters: 4700, epoch: 5 | loss: 0.2608627
	speed: 0.0302s/iter; left time: 849.4778s
	iters: 4800, epoch: 5 | loss: 0.2962439
	speed: 0.0304s/iter; left time: 852.0805s
	iters: 4900, epoch: 5 | loss: 0.2602999
	speed: 0.0303s/iter; left time: 845.8888s
	iters: 5000, epoch: 5 | loss: 0.2481933
	speed: 0.0304s/iter; left time: 843.4685s
	iters: 5100, epoch: 5 | loss: 0.2339240
	speed: 0.0304s/iter; left time: 841.3301s
	iters: 5200, epoch: 5 | loss: 0.2358450
	speed: 0.0304s/iter; left time: 838.1807s
	iters: 5300, epoch: 5 | loss: 0.2272968
	speed: 0.0302s/iter; left time: 828.9876s
	iters: 5400, epoch: 5 | loss: 0.2218329
	speed: 0.0304s/iter; left time: 832.8807s
Epoch: 5 cost time: 166.2613034248352
Epoch: 5, Steps: 5464 | Train Loss: 0.2556510 Vali Loss: 0.1804362 Test Loss: 0.2591687
Validation loss decreased (0.180743 --> 0.180436).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2413947
	speed: 1.2245s/iter; left time: 33331.0146s
	iters: 200, epoch: 6 | loss: 0.1923954
	speed: 0.0303s/iter; left time: 821.4842s
	iters: 300, epoch: 6 | loss: 0.3102465
	speed: 0.0304s/iter; left time: 820.6655s
	iters: 400, epoch: 6 | loss: 0.2390072
	speed: 0.0303s/iter; left time: 815.7562s
	iters: 500, epoch: 6 | loss: 0.2804807
	speed: 0.0304s/iter; left time: 815.1243s
	iters: 600, epoch: 6 | loss: 0.2318371
	speed: 0.0303s/iter; left time: 809.3528s
	iters: 700, epoch: 6 | loss: 0.2425544
	speed: 0.0303s/iter; left time: 806.7964s
	iters: 800, epoch: 6 | loss: 0.2132419
	speed: 0.0304s/iter; left time: 806.1270s
	iters: 900, epoch: 6 | loss: 0.3146968
	speed: 0.0302s/iter; left time: 797.2073s
	iters: 1000, epoch: 6 | loss: 0.2392252
	speed: 0.0305s/iter; left time: 801.6334s
	iters: 1100, epoch: 6 | loss: 0.3512639
	speed: 0.0304s/iter; left time: 798.0293s
	iters: 1200, epoch: 6 | loss: 0.2811232
	speed: 0.0303s/iter; left time: 792.5113s
	iters: 1300, epoch: 6 | loss: 0.2196468
	speed: 0.0304s/iter; left time: 790.4212s
	iters: 1400, epoch: 6 | loss: 0.2199227
	speed: 0.0303s/iter; left time: 784.7541s
	iters: 1500, epoch: 6 | loss: 0.2084371
	speed: 0.0302s/iter; left time: 779.7725s
	iters: 1600, epoch: 6 | loss: 0.2159897
	speed: 0.0303s/iter; left time: 779.1865s
	iters: 1700, epoch: 6 | loss: 0.2460938
	speed: 0.0305s/iter; left time: 780.3343s
	iters: 1800, epoch: 6 | loss: 0.2829938
	speed: 0.0303s/iter; left time: 773.9419s
	iters: 1900, epoch: 6 | loss: 0.2364027
	speed: 0.0304s/iter; left time: 772.9663s
	iters: 2000, epoch: 6 | loss: 0.2329160
	speed: 0.0304s/iter; left time: 769.0449s
	iters: 2100, epoch: 6 | loss: 0.2218483
	speed: 0.0303s/iter; left time: 764.4406s
	iters: 2200, epoch: 6 | loss: 0.2949656
	speed: 0.0302s/iter; left time: 759.2105s
	iters: 2300, epoch: 6 | loss: 0.2039620
	speed: 0.0304s/iter; left time: 760.6460s
	iters: 2400, epoch: 6 | loss: 0.2353232
	speed: 0.0301s/iter; left time: 749.0834s
	iters: 2500, epoch: 6 | loss: 0.3479711
	speed: 0.0302s/iter; left time: 750.3395s
	iters: 2600, epoch: 6 | loss: 0.2045270
	speed: 0.0304s/iter; left time: 751.1897s
	iters: 2700, epoch: 6 | loss: 0.2678400
	speed: 0.0303s/iter; left time: 747.1387s
	iters: 2800, epoch: 6 | loss: 0.2374152
	speed: 0.0301s/iter; left time: 738.3524s
	iters: 2900, epoch: 6 | loss: 0.2057117
	speed: 0.0304s/iter; left time: 742.4476s
	iters: 3000, epoch: 6 | loss: 0.2398219
	speed: 0.0301s/iter; left time: 732.0312s
	iters: 3100, epoch: 6 | loss: 0.2511872
	speed: 0.0303s/iter; left time: 733.9894s
	iters: 3200, epoch: 6 | loss: 0.2767693
	speed: 0.0304s/iter; left time: 733.5816s
	iters: 3300, epoch: 6 | loss: 0.2594120
	speed: 0.0304s/iter; left time: 730.1974s
	iters: 3400, epoch: 6 | loss: 0.2295875
	speed: 0.0303s/iter; left time: 724.8186s
	iters: 3500, epoch: 6 | loss: 0.2463299
	speed: 0.0302s/iter; left time: 718.7664s
	iters: 3600, epoch: 6 | loss: 0.1993487
	speed: 0.0302s/iter; left time: 716.4511s
	iters: 3700, epoch: 6 | loss: 0.2241447
	speed: 0.0303s/iter; left time: 714.7222s
	iters: 3800, epoch: 6 | loss: 0.2411979
	speed: 0.0304s/iter; left time: 715.3324s
	iters: 3900, epoch: 6 | loss: 0.2563035
	speed: 0.0303s/iter; left time: 709.5193s
	iters: 4000, epoch: 6 | loss: 0.2666711
	speed: 0.0304s/iter; left time: 708.5429s
	iters: 4100, epoch: 6 | loss: 0.2643750
	speed: 0.0304s/iter; left time: 706.0903s
	iters: 4200, epoch: 6 | loss: 0.2584761
	speed: 0.0301s/iter; left time: 695.8064s
	iters: 4300, epoch: 6 | loss: 0.2678401
	speed: 0.0303s/iter; left time: 697.6686s
	iters: 4400, epoch: 6 | loss: 0.3067359
	speed: 0.0304s/iter; left time: 696.6836s
	iters: 4500, epoch: 6 | loss: 0.3035517
	speed: 0.0304s/iter; left time: 694.3702s
	iters: 4600, epoch: 6 | loss: 0.2431416
	speed: 0.0301s/iter; left time: 684.7847s
	iters: 4700, epoch: 6 | loss: 0.2198227
	speed: 0.0302s/iter; left time: 684.2508s
	iters: 4800, epoch: 6 | loss: 0.1767327
	speed: 0.0304s/iter; left time: 684.0393s
	iters: 4900, epoch: 6 | loss: 0.2103796
	speed: 0.0304s/iter; left time: 680.9215s
	iters: 5000, epoch: 6 | loss: 0.1939393
	speed: 0.0302s/iter; left time: 674.7144s
	iters: 5100, epoch: 6 | loss: 0.2314141
	speed: 0.0302s/iter; left time: 670.8094s
	iters: 5200, epoch: 6 | loss: 0.2425935
	speed: 0.0301s/iter; left time: 665.9707s
	iters: 5300, epoch: 6 | loss: 0.2740209
	speed: 0.0304s/iter; left time: 670.1817s
	iters: 5400, epoch: 6 | loss: 0.2468799
	speed: 0.0305s/iter; left time: 667.5131s
Epoch: 6 cost time: 166.15275406837463
Epoch: 6, Steps: 5464 | Train Loss: 0.2531404 Vali Loss: 0.1777722 Test Loss: 0.2595605
Validation loss decreased (0.180436 --> 0.177772).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2663716
	speed: 1.2132s/iter; left time: 26395.4827s
	iters: 200, epoch: 7 | loss: 0.2610018
	speed: 0.0306s/iter; left time: 661.8601s
	iters: 300, epoch: 7 | loss: 0.2602580
	speed: 0.0304s/iter; left time: 655.0386s
	iters: 400, epoch: 7 | loss: 0.2384100
	speed: 0.0302s/iter; left time: 648.3828s
	iters: 500, epoch: 7 | loss: 0.3048370
	speed: 0.0304s/iter; left time: 649.9410s
	iters: 600, epoch: 7 | loss: 0.2213708
	speed: 0.0304s/iter; left time: 647.0614s
	iters: 700, epoch: 7 | loss: 0.2274927
	speed: 0.0298s/iter; left time: 629.4388s
	iters: 800, epoch: 7 | loss: 0.2071928
	speed: 0.0297s/iter; left time: 624.3543s
	iters: 900, epoch: 7 | loss: 0.2058046
	speed: 0.0303s/iter; left time: 635.1773s
	iters: 1000, epoch: 7 | loss: 0.2640206
	speed: 0.0301s/iter; left time: 627.4953s
	iters: 1100, epoch: 7 | loss: 0.2165726
	speed: 0.0300s/iter; left time: 623.1358s
	iters: 1200, epoch: 7 | loss: 0.2793058
	speed: 0.0305s/iter; left time: 630.2004s
	iters: 1300, epoch: 7 | loss: 0.2616946
	speed: 0.0302s/iter; left time: 619.8658s
	iters: 1400, epoch: 7 | loss: 0.2092179
	speed: 0.0299s/iter; left time: 611.8872s
	iters: 1500, epoch: 7 | loss: 0.2385031
	speed: 0.0303s/iter; left time: 617.6481s
	iters: 1600, epoch: 7 | loss: 0.3681850
	speed: 0.0303s/iter; left time: 613.2938s
	iters: 1700, epoch: 7 | loss: 0.2358731
	speed: 0.0301s/iter; left time: 606.0040s
	iters: 1800, epoch: 7 | loss: 0.2032961
	speed: 0.0302s/iter; left time: 605.0246s
	iters: 1900, epoch: 7 | loss: 0.2094221
	speed: 0.0299s/iter; left time: 596.7770s
	iters: 2000, epoch: 7 | loss: 0.2307048
	speed: 0.0301s/iter; left time: 597.3249s
	iters: 2100, epoch: 7 | loss: 0.2234402
	speed: 0.0303s/iter; left time: 598.8141s
	iters: 2200, epoch: 7 | loss: 0.2255341
	speed: 0.0299s/iter; left time: 587.1466s
	iters: 2300, epoch: 7 | loss: 0.2653877
	speed: 0.0303s/iter; left time: 593.2796s
	iters: 2400, epoch: 7 | loss: 0.2922301
	speed: 0.0301s/iter; left time: 585.1624s
	iters: 2500, epoch: 7 | loss: 0.2548064
	speed: 0.0303s/iter; left time: 586.1852s
	iters: 2600, epoch: 7 | loss: 0.2106097
	speed: 0.0303s/iter; left time: 583.8046s
	iters: 2700, epoch: 7 | loss: 0.2251424
	speed: 0.0305s/iter; left time: 584.8476s
	iters: 2800, epoch: 7 | loss: 0.3585657
	speed: 0.0290s/iter; left time: 553.4371s
	iters: 2900, epoch: 7 | loss: 0.2727740
	speed: 0.0303s/iter; left time: 575.2745s
	iters: 3000, epoch: 7 | loss: 0.2434123
	speed: 0.0304s/iter; left time: 573.4056s
	iters: 3100, epoch: 7 | loss: 0.2242505
	speed: 0.0303s/iter; left time: 568.5226s
	iters: 3200, epoch: 7 | loss: 0.2062918
	speed: 0.0304s/iter; left time: 567.3111s
	iters: 3300, epoch: 7 | loss: 0.2566967
	speed: 0.0304s/iter; left time: 564.0270s
	iters: 3400, epoch: 7 | loss: 0.2404417
	speed: 0.0302s/iter; left time: 557.7058s
	iters: 3500, epoch: 7 | loss: 0.2402249
	speed: 0.0301s/iter; left time: 553.1545s
	iters: 3600, epoch: 7 | loss: 0.2337642
	speed: 0.0304s/iter; left time: 554.2692s
	iters: 3700, epoch: 7 | loss: 0.2735595
	speed: 0.0303s/iter; left time: 550.4119s
	iters: 3800, epoch: 7 | loss: 0.2115396
	speed: 0.0305s/iter; left time: 550.7710s
	iters: 3900, epoch: 7 | loss: 0.2719408
	speed: 0.0304s/iter; left time: 545.6065s
	iters: 4000, epoch: 7 | loss: 0.2296112
	speed: 0.0310s/iter; left time: 553.0088s
	iters: 4100, epoch: 7 | loss: 0.2170142
	speed: 0.0304s/iter; left time: 539.0649s
	iters: 4200, epoch: 7 | loss: 0.2493319
	speed: 0.0305s/iter; left time: 537.8440s
	iters: 4300, epoch: 7 | loss: 0.1954118
	speed: 0.0304s/iter; left time: 533.7862s
	iters: 4400, epoch: 7 | loss: 0.3093725
	speed: 0.0305s/iter; left time: 531.6667s
	iters: 4500, epoch: 7 | loss: 0.2706375
	speed: 0.0304s/iter; left time: 527.4622s
	iters: 4600, epoch: 7 | loss: 0.2935580
	speed: 0.0304s/iter; left time: 524.9547s
	iters: 4700, epoch: 7 | loss: 0.4900544
	speed: 0.0304s/iter; left time: 522.1149s
	iters: 4800, epoch: 7 | loss: 0.2731013
	speed: 0.0304s/iter; left time: 519.2811s
	iters: 4900, epoch: 7 | loss: 0.2498150
	speed: 0.0328s/iter; left time: 556.5366s
	iters: 5000, epoch: 7 | loss: 0.2160831
	speed: 0.0304s/iter; left time: 512.7877s
	iters: 5100, epoch: 7 | loss: 0.2473613
	speed: 0.0304s/iter; left time: 510.2345s
	iters: 5200, epoch: 7 | loss: 0.2858486
	speed: 0.0304s/iter; left time: 506.8011s
	iters: 5300, epoch: 7 | loss: 0.2324735
	speed: 0.0313s/iter; left time: 518.9444s
	iters: 5400, epoch: 7 | loss: 0.3115051
	speed: 0.0304s/iter; left time: 500.2591s
Epoch: 7 cost time: 166.3582353591919
Epoch: 7, Steps: 5464 | Train Loss: 0.2521137 Vali Loss: 0.1768235 Test Loss: 0.2557598
Validation loss decreased (0.177772 --> 0.176824).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2357714
	speed: 1.2270s/iter; left time: 19992.0805s
	iters: 200, epoch: 8 | loss: 0.2580777
	speed: 0.0323s/iter; left time: 523.2565s
	iters: 300, epoch: 8 | loss: 0.2347873
	speed: 0.0330s/iter; left time: 531.8434s
	iters: 400, epoch: 8 | loss: 0.2430897
	speed: 0.0307s/iter; left time: 490.4269s
	iters: 500, epoch: 8 | loss: 0.2135043
	speed: 0.0305s/iter; left time: 484.7191s
	iters: 600, epoch: 8 | loss: 0.4164810
	speed: 0.0304s/iter; left time: 480.1819s
	iters: 700, epoch: 8 | loss: 0.2249937
	speed: 0.0302s/iter; left time: 474.4477s
	iters: 800, epoch: 8 | loss: 0.3107015
	speed: 0.0303s/iter; left time: 472.6670s
	iters: 900, epoch: 8 | loss: 0.2868751
	speed: 0.0305s/iter; left time: 472.5819s
	iters: 1000, epoch: 8 | loss: 0.3650813
	speed: 0.0302s/iter; left time: 464.6339s
	iters: 1100, epoch: 8 | loss: 0.2127550
	speed: 0.0302s/iter; left time: 462.4489s
	iters: 1200, epoch: 8 | loss: 0.3465055
	speed: 0.0303s/iter; left time: 459.6940s
	iters: 1300, epoch: 8 | loss: 0.2147207
	speed: 0.0302s/iter; left time: 455.5938s
	iters: 1400, epoch: 8 | loss: 0.2586276
	speed: 0.0304s/iter; left time: 455.9395s
	iters: 1500, epoch: 8 | loss: 0.2644379
	speed: 0.0305s/iter; left time: 454.9243s
	iters: 1600, epoch: 8 | loss: 0.2222677
	speed: 0.0298s/iter; left time: 441.5568s
	iters: 1700, epoch: 8 | loss: 0.2133263
	speed: 0.0304s/iter; left time: 446.8950s
	iters: 1800, epoch: 8 | loss: 0.1921412
	speed: 0.0303s/iter; left time: 441.9216s
	iters: 1900, epoch: 8 | loss: 0.2142471
	speed: 0.0304s/iter; left time: 440.0079s
	iters: 2000, epoch: 8 | loss: 0.3143267
	speed: 0.0304s/iter; left time: 437.5269s
	iters: 2100, epoch: 8 | loss: 0.2244292
	speed: 0.0303s/iter; left time: 433.1412s
	iters: 2200, epoch: 8 | loss: 0.2470952
	speed: 0.0306s/iter; left time: 433.8961s
	iters: 2300, epoch: 8 | loss: 0.2814203
	speed: 0.0301s/iter; left time: 424.5596s
	iters: 2400, epoch: 8 | loss: 0.4654565
	speed: 0.0303s/iter; left time: 424.4955s
	iters: 2500, epoch: 8 | loss: 0.2161506
	speed: 0.0305s/iter; left time: 423.6153s
	iters: 2600, epoch: 8 | loss: 0.2410659
	speed: 0.0303s/iter; left time: 418.1031s
	iters: 2700, epoch: 8 | loss: 0.3411067
	speed: 0.0302s/iter; left time: 413.7528s
	iters: 2800, epoch: 8 | loss: 0.2509046
	speed: 0.0304s/iter; left time: 413.6858s
	iters: 2900, epoch: 8 | loss: 0.3120624
	speed: 0.0303s/iter; left time: 409.2652s
	iters: 3000, epoch: 8 | loss: 0.2408788
	speed: 0.0303s/iter; left time: 406.2195s
	iters: 3100, epoch: 8 | loss: 0.2116152
	speed: 0.0304s/iter; left time: 404.6795s
	iters: 3200, epoch: 8 | loss: 0.3468667
	speed: 0.0305s/iter; left time: 401.8083s
	iters: 3300, epoch: 8 | loss: 0.1838261
	speed: 0.0304s/iter; left time: 398.4425s
	iters: 3400, epoch: 8 | loss: 0.2799713
	speed: 0.0304s/iter; left time: 395.3947s
	iters: 3500, epoch: 8 | loss: 0.2635405
	speed: 0.0303s/iter; left time: 390.0381s
	iters: 3600, epoch: 8 | loss: 0.2744400
	speed: 0.0304s/iter; left time: 388.3811s
	iters: 3700, epoch: 8 | loss: 0.3055995
	speed: 0.0303s/iter; left time: 384.6013s
	iters: 3800, epoch: 8 | loss: 0.2605561
	speed: 0.0303s/iter; left time: 382.1880s
	iters: 3900, epoch: 8 | loss: 0.3753644
	speed: 0.0304s/iter; left time: 379.9627s
	iters: 4000, epoch: 8 | loss: 0.2307829
	speed: 0.0304s/iter; left time: 376.8123s
	iters: 4100, epoch: 8 | loss: 0.2413428
	speed: 0.0305s/iter; left time: 374.3782s
	iters: 4200, epoch: 8 | loss: 0.2646089
	speed: 0.0304s/iter; left time: 370.9291s
	iters: 4300, epoch: 8 | loss: 0.2312073
	speed: 0.0306s/iter; left time: 369.6297s
	iters: 4400, epoch: 8 | loss: 0.1952219
	speed: 0.0303s/iter; left time: 363.1471s
	iters: 4500, epoch: 8 | loss: 0.2812776
	speed: 0.0304s/iter; left time: 361.9142s
	iters: 4600, epoch: 8 | loss: 0.4120052
	speed: 0.0304s/iter; left time: 358.4095s
	iters: 4700, epoch: 8 | loss: 0.2229593
	speed: 0.0304s/iter; left time: 354.9488s
	iters: 4800, epoch: 8 | loss: 0.2565020
	speed: 0.0305s/iter; left time: 353.2104s
	iters: 4900, epoch: 8 | loss: 0.2596853
	speed: 0.0305s/iter; left time: 350.6560s
	iters: 5000, epoch: 8 | loss: 0.2188579
	speed: 0.0305s/iter; left time: 347.3937s
	iters: 5100, epoch: 8 | loss: 0.2067817
	speed: 0.0304s/iter; left time: 343.5292s
	iters: 5200, epoch: 8 | loss: 0.2515339
	speed: 0.0299s/iter; left time: 334.3359s
	iters: 5300, epoch: 8 | loss: 0.2630086
	speed: 0.0301s/iter; left time: 334.1916s
	iters: 5400, epoch: 8 | loss: 0.2376192
	speed: 0.0302s/iter; left time: 332.5324s
Epoch: 8 cost time: 167.0901744365692
Epoch: 8, Steps: 5464 | Train Loss: 0.2516047 Vali Loss: 0.1774749 Test Loss: 0.2559186
EarlyStopping counter: 1 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2289878
	speed: 1.1990s/iter; left time: 12983.6416s
	iters: 200, epoch: 9 | loss: 0.2228371
	speed: 0.0311s/iter; left time: 333.5087s
	iters: 300, epoch: 9 | loss: 0.2158995
	speed: 0.0304s/iter; left time: 323.2598s
	iters: 400, epoch: 9 | loss: 0.2131610
	speed: 0.0305s/iter; left time: 320.6969s
	iters: 500, epoch: 9 | loss: 0.2849234
	speed: 0.0303s/iter; left time: 316.1144s
	iters: 600, epoch: 9 | loss: 0.2142326
	speed: 0.0304s/iter; left time: 313.5761s
	iters: 700, epoch: 9 | loss: 0.2301605
	speed: 0.0304s/iter; left time: 310.9487s
	iters: 800, epoch: 9 | loss: 0.1792991
	speed: 0.0303s/iter; left time: 306.9890s
	iters: 900, epoch: 9 | loss: 0.2419071
	speed: 0.0304s/iter; left time: 305.1474s
	iters: 1000, epoch: 9 | loss: 0.2033891
	speed: 0.0302s/iter; left time: 300.2663s
	iters: 1100, epoch: 9 | loss: 0.3155295
	speed: 0.0304s/iter; left time: 299.2697s
	iters: 1200, epoch: 9 | loss: 0.2756961
	speed: 0.0303s/iter; left time: 294.9905s
	iters: 1300, epoch: 9 | loss: 0.2867507
	speed: 0.0304s/iter; left time: 293.1154s
	iters: 1400, epoch: 9 | loss: 0.2544223
	speed: 0.0303s/iter; left time: 289.0993s
	iters: 1500, epoch: 9 | loss: 0.3369936
	speed: 0.0304s/iter; left time: 287.0167s
	iters: 1600, epoch: 9 | loss: 0.2551285
	speed: 0.0300s/iter; left time: 280.3294s
	iters: 1700, epoch: 9 | loss: 0.2020021
	speed: 0.0302s/iter; left time: 279.1284s
	iters: 1800, epoch: 9 | loss: 0.2335594
	speed: 0.0303s/iter; left time: 276.8068s
	iters: 1900, epoch: 9 | loss: 0.2107740
	speed: 0.0303s/iter; left time: 273.9630s
	iters: 2000, epoch: 9 | loss: 0.2968363
	speed: 0.0304s/iter; left time: 271.5836s
	iters: 2100, epoch: 9 | loss: 0.2671098
	speed: 0.0312s/iter; left time: 275.1459s
	iters: 2200, epoch: 9 | loss: 0.3062617
	speed: 0.0316s/iter; left time: 275.8520s
	iters: 2300, epoch: 9 | loss: 0.3064117
	speed: 0.0316s/iter; left time: 272.7734s
	iters: 2400, epoch: 9 | loss: 0.2480387
	speed: 0.0315s/iter; left time: 268.2542s
	iters: 2500, epoch: 9 | loss: 0.2124249
	speed: 0.0316s/iter; left time: 266.3214s
	iters: 2600, epoch: 9 | loss: 0.2655954
	speed: 0.0314s/iter; left time: 261.5792s
	iters: 2700, epoch: 9 | loss: 0.3049496
	speed: 0.0304s/iter; left time: 249.8053s
	iters: 2800, epoch: 9 | loss: 0.2413436
	speed: 0.0303s/iter; left time: 246.7024s
	iters: 2900, epoch: 9 | loss: 0.2405588
	speed: 0.0303s/iter; left time: 243.4056s
	iters: 3000, epoch: 9 | loss: 0.2233121
	speed: 0.0303s/iter; left time: 240.2136s
	iters: 3100, epoch: 9 | loss: 0.2218444
	speed: 0.0302s/iter; left time: 236.1763s
	iters: 3200, epoch: 9 | loss: 0.2192683
	speed: 0.0300s/iter; left time: 231.9589s
	iters: 3300, epoch: 9 | loss: 0.2636401
	speed: 0.0304s/iter; left time: 232.1238s
	iters: 3400, epoch: 9 | loss: 0.2327445
	speed: 0.0305s/iter; left time: 229.2970s
	iters: 3500, epoch: 9 | loss: 0.2487766
	speed: 0.0301s/iter; left time: 223.6869s
	iters: 3600, epoch: 9 | loss: 0.2437610
	speed: 0.0304s/iter; left time: 222.5400s
	iters: 3700, epoch: 9 | loss: 0.2093764
	speed: 0.0304s/iter; left time: 219.9914s
	iters: 3800, epoch: 9 | loss: 0.3620088
	speed: 0.0304s/iter; left time: 216.8345s
	iters: 3900, epoch: 9 | loss: 0.2897970
	speed: 0.0304s/iter; left time: 213.6379s
	iters: 4000, epoch: 9 | loss: 0.2465894
	speed: 0.0305s/iter; left time: 211.0651s
	iters: 4100, epoch: 9 | loss: 0.3019633
	speed: 0.0304s/iter; left time: 207.8623s
	iters: 4200, epoch: 9 | loss: 0.2354901
	speed: 0.0304s/iter; left time: 204.8582s
	iters: 4300, epoch: 9 | loss: 0.2120814
	speed: 0.0303s/iter; left time: 200.5852s
	iters: 4400, epoch: 9 | loss: 0.2305693
	speed: 0.0304s/iter; left time: 198.4504s
	iters: 4500, epoch: 9 | loss: 0.2477536
	speed: 0.0304s/iter; left time: 195.5535s
	iters: 4600, epoch: 9 | loss: 0.3493160
	speed: 0.0303s/iter; left time: 191.9286s
	iters: 4700, epoch: 9 | loss: 0.2402043
	speed: 0.0303s/iter; left time: 189.0437s
	iters: 4800, epoch: 9 | loss: 0.2467327
	speed: 0.0303s/iter; left time: 185.8665s
	iters: 4900, epoch: 9 | loss: 0.2412784
	speed: 0.0303s/iter; left time: 182.5834s
	iters: 5000, epoch: 9 | loss: 0.2761284
	speed: 0.0303s/iter; left time: 179.4167s
	iters: 5100, epoch: 9 | loss: 0.2024675
	speed: 0.0303s/iter; left time: 176.5538s
	iters: 5200, epoch: 9 | loss: 0.2777278
	speed: 0.0304s/iter; left time: 174.0618s
	iters: 5300, epoch: 9 | loss: 0.2289235
	speed: 0.0304s/iter; left time: 171.1571s
	iters: 5400, epoch: 9 | loss: 0.2762711
	speed: 0.0304s/iter; left time: 168.1165s
Epoch: 9 cost time: 167.21684384346008
Epoch: 9, Steps: 5464 | Train Loss: 0.2514492 Vali Loss: 0.1768552 Test Loss: 0.2556202
EarlyStopping counter: 2 out of 3
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2493927
	speed: 1.1975s/iter; left time: 6424.7106s
	iters: 200, epoch: 10 | loss: 0.2032594
	speed: 0.0303s/iter; left time: 159.5283s
	iters: 300, epoch: 10 | loss: 0.2205769
	speed: 0.0299s/iter; left time: 154.5040s
	iters: 400, epoch: 10 | loss: 0.2037758
	speed: 0.0304s/iter; left time: 153.9121s
	iters: 500, epoch: 10 | loss: 0.2047940
	speed: 0.0304s/iter; left time: 151.0519s
	iters: 600, epoch: 10 | loss: 0.2734173
	speed: 0.0303s/iter; left time: 147.3876s
	iters: 700, epoch: 10 | loss: 0.2433759
	speed: 0.0303s/iter; left time: 144.5277s
	iters: 800, epoch: 10 | loss: 0.2392703
	speed: 0.0304s/iter; left time: 141.7514s
	iters: 900, epoch: 10 | loss: 0.2506155
	speed: 0.0304s/iter; left time: 138.6928s
	iters: 1000, epoch: 10 | loss: 0.3252292
	speed: 0.0304s/iter; left time: 135.6313s
	iters: 1100, epoch: 10 | loss: 0.1941299
	speed: 0.0304s/iter; left time: 132.6079s
	iters: 1200, epoch: 10 | loss: 0.2519750
	speed: 0.0303s/iter; left time: 129.0603s
	iters: 1300, epoch: 10 | loss: 0.2575675
	speed: 0.0303s/iter; left time: 125.9936s
	iters: 1400, epoch: 10 | loss: 0.2443427
	speed: 0.0304s/iter; left time: 123.4882s
	iters: 1500, epoch: 10 | loss: 0.2259863
	speed: 0.0304s/iter; left time: 120.4974s
	iters: 1600, epoch: 10 | loss: 0.2595513
	speed: 0.0309s/iter; left time: 119.6199s
	iters: 1700, epoch: 10 | loss: 0.2059869
	speed: 0.0311s/iter; left time: 117.1194s
	iters: 1800, epoch: 10 | loss: 0.2085597
	speed: 0.0303s/iter; left time: 111.0472s
	iters: 1900, epoch: 10 | loss: 0.2641526
	speed: 0.0300s/iter; left time: 106.8062s
	iters: 2000, epoch: 10 | loss: 0.2853202
	speed: 0.0308s/iter; left time: 106.6296s
	iters: 2100, epoch: 10 | loss: 0.2483312
	speed: 0.0319s/iter; left time: 107.2353s
	iters: 2200, epoch: 10 | loss: 0.2364313
	speed: 0.0317s/iter; left time: 103.5486s
	iters: 2300, epoch: 10 | loss: 0.2323930
	speed: 0.0315s/iter; left time: 99.5777s
	iters: 2400, epoch: 10 | loss: 0.2519222
	speed: 0.0315s/iter; left time: 96.5612s
	iters: 2500, epoch: 10 | loss: 0.2448141
	speed: 0.0313s/iter; left time: 92.8985s
	iters: 2600, epoch: 10 | loss: 0.2363420
	speed: 0.0315s/iter; left time: 90.3282s
	iters: 2700, epoch: 10 | loss: 0.2848633
	speed: 0.0313s/iter; left time: 86.6019s
	iters: 2800, epoch: 10 | loss: 0.2165134
	speed: 0.0315s/iter; left time: 84.0363s
	iters: 2900, epoch: 10 | loss: 0.1903970
	speed: 0.0314s/iter; left time: 80.4574s
	iters: 3000, epoch: 10 | loss: 0.3135996
	speed: 0.0314s/iter; left time: 77.3734s
	iters: 3100, epoch: 10 | loss: 0.2321154
	speed: 0.0309s/iter; left time: 73.1685s
	iters: 3200, epoch: 10 | loss: 0.2525730
	speed: 0.0311s/iter; left time: 70.4094s
	iters: 3300, epoch: 10 | loss: 0.1937984
	speed: 0.0303s/iter; left time: 65.5203s
	iters: 3400, epoch: 10 | loss: 0.2498687
	speed: 0.0304s/iter; left time: 62.7200s
	iters: 3500, epoch: 10 | loss: 0.2331999
	speed: 0.0302s/iter; left time: 59.3482s
	iters: 3600, epoch: 10 | loss: 0.2324170
	speed: 0.0304s/iter; left time: 56.7015s
	iters: 3700, epoch: 10 | loss: 0.2204647
	speed: 0.0304s/iter; left time: 53.6613s
	iters: 3800, epoch: 10 | loss: 0.2503225
	speed: 0.0304s/iter; left time: 50.6164s
	iters: 3900, epoch: 10 | loss: 0.2958708
	speed: 0.0303s/iter; left time: 47.4849s
	iters: 4000, epoch: 10 | loss: 0.2299104
	speed: 0.0304s/iter; left time: 44.5065s
	iters: 4100, epoch: 10 | loss: 0.1885222
	speed: 0.0303s/iter; left time: 41.3266s
	iters: 4200, epoch: 10 | loss: 0.3231360
	speed: 0.0299s/iter; left time: 37.8485s
	iters: 4300, epoch: 10 | loss: 0.2642493
	speed: 0.0300s/iter; left time: 34.9740s
	iters: 4400, epoch: 10 | loss: 0.2541860
	speed: 0.0301s/iter; left time: 32.0676s
	iters: 4500, epoch: 10 | loss: 0.2143356
	speed: 0.0299s/iter; left time: 28.8502s
	iters: 4600, epoch: 10 | loss: 0.2634476
	speed: 0.0307s/iter; left time: 26.5569s
	iters: 4700, epoch: 10 | loss: 0.2114549
	speed: 0.0302s/iter; left time: 23.0941s
	iters: 4800, epoch: 10 | loss: 0.2509733
	speed: 0.0304s/iter; left time: 20.2202s
	iters: 4900, epoch: 10 | loss: 0.2548038
	speed: 0.0304s/iter; left time: 17.1780s
	iters: 5000, epoch: 10 | loss: 0.2267467
	speed: 0.0304s/iter; left time: 14.1365s
	iters: 5100, epoch: 10 | loss: 0.2552555
	speed: 0.0304s/iter; left time: 11.1090s
	iters: 5200, epoch: 10 | loss: 0.2269756
	speed: 0.0304s/iter; left time: 8.0504s
	iters: 5300, epoch: 10 | loss: 0.3328449
	speed: 0.0303s/iter; left time: 4.9984s
	iters: 5400, epoch: 10 | loss: 0.3338424
	speed: 0.0304s/iter; left time: 1.9766s
Epoch: 10 cost time: 167.68442392349243
Epoch: 10, Steps: 5464 | Train Loss: 0.2513437 Vali Loss: 0.1768341 Test Loss: 0.2553465
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems06_h_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 24869
test shape: (24869, 1, 192, 130) (24869, 1, 192, 130)
test shape: (24869, 192, 130) (24869, 192, 130)
mse:0.2557598352432251, mae:0.3260822892189026
>>>>>>>Overall time: 2967 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
