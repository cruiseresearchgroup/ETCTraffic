Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_d.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_d_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4759
val 79
test 873
	iters: 100, epoch: 1 | loss: 0.9669862
	speed: 0.3006s/iter; left time: 8866.6258s
Epoch: 1 cost time: 44.57682538032532
Epoch: 1, Steps: 148 | Train Loss: 0.9907872 Vali Loss: 0.9409709 Test Loss: 1.3992008
Validation loss decreased (inf --> 0.940971).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9163031
	speed: 0.5655s/iter; left time: 16600.4482s
Epoch: 2 cost time: 44.13002347946167
Epoch: 2, Steps: 148 | Train Loss: 0.9298029 Vali Loss: 0.9609694 Test Loss: 1.3965569
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.8655260
	speed: 0.5649s/iter; left time: 16498.3080s
Epoch: 3 cost time: 44.0874969959259
Epoch: 3, Steps: 148 | Train Loss: 0.8741183 Vali Loss: 0.9408167 Test Loss: 1.3931534
Validation loss decreased (0.940971 --> 0.940817).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.7112669
	speed: 0.5645s/iter; left time: 16401.2903s
Epoch: 4 cost time: 46.826762676239014
Epoch: 4, Steps: 148 | Train Loss: 0.7499298 Vali Loss: 1.0888907 Test Loss: 1.5213372
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.5481492
	speed: 0.5967s/iter; left time: 17251.3120s
Epoch: 5 cost time: 44.91763424873352
Epoch: 5, Steps: 148 | Train Loss: 0.5974940 Vali Loss: 1.1253345 Test Loss: 1.5195965
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.5565770
	speed: 0.5690s/iter; left time: 16364.6346s
Epoch: 6 cost time: 44.42024493217468
Epoch: 6, Steps: 148 | Train Loss: 0.5516364 Vali Loss: 1.0720010 Test Loss: 1.5231357
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.5572930
	speed: 0.5963s/iter; left time: 17060.9568s
Epoch: 7 cost time: 44.2740273475647
Epoch: 7, Steps: 148 | Train Loss: 0.5301261 Vali Loss: 1.0775703 Test Loss: 1.5420157
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.6100847
	speed: 0.5669s/iter; left time: 16136.5210s
Epoch: 8 cost time: 44.27266716957092
Epoch: 8, Steps: 148 | Train Loss: 0.5771409 Vali Loss: 1.0314496 Test Loss: 1.4628662
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_d_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 873
test shape: (873, 1, 720, 151) (873, 1, 720, 151)
test shape: (873, 720, 151) (873, 720, 151)
mse:1.3931552171707153, mae:0.7519032955169678
>>>>>>>Overall time: 483 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_d.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_d_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4759
val 79
test 873
	iters: 100, epoch: 1 | loss: 0.9669862
	speed: 0.3015s/iter; left time: 8893.1103s
Epoch: 1 cost time: 44.72781252861023
Epoch: 1, Steps: 148 | Train Loss: 0.9907872 Vali Loss: 0.9409709 Test Loss: 1.3992007
Validation loss decreased (inf --> 0.940971).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9163032
	speed: 0.5687s/iter; left time: 16694.1182s
Epoch: 2 cost time: 44.29714226722717
Epoch: 2, Steps: 148 | Train Loss: 0.9298031 Vali Loss: 0.9609698 Test Loss: 1.3965569
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.8655270
	speed: 0.5696s/iter; left time: 16635.8180s
Epoch: 3 cost time: 44.35972309112549
Epoch: 3, Steps: 148 | Train Loss: 0.8740700 Vali Loss: 0.9424148 Test Loss: 1.3968351
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.6621330
	speed: 0.5694s/iter; left time: 16543.8352s
Epoch: 4 cost time: 44.47987365722656
Epoch: 4, Steps: 148 | Train Loss: 0.7512638 Vali Loss: 1.0575500 Test Loss: 1.5059723
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.5705961
	speed: 0.5691s/iter; left time: 16451.4171s
Epoch: 5 cost time: 44.314929485321045
Epoch: 5, Steps: 148 | Train Loss: 0.6139587 Vali Loss: 1.0894513 Test Loss: 1.5128164
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.5516647
	speed: 0.5683s/iter; left time: 16344.9366s
Epoch: 6 cost time: 44.309908628463745
Epoch: 6, Steps: 148 | Train Loss: 0.5630665 Vali Loss: 1.0952790 Test Loss: 1.4915043
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_d_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 873
test shape: (873, 1, 720, 151) (873, 1, 720, 151)
test shape: (873, 720, 151) (873, 720, 151)
mse:1.3992040157318115, mae:0.7590168714523315
>>>>>>>Overall time: 367 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
