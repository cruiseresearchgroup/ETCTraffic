Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems03_h.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems03_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 133508
val 18923
test 38036
	iters: 100, epoch: 1 | loss: 0.3478303
	speed: 0.1316s/iter; left time: 109806.1778s
	iters: 200, epoch: 1 | loss: 0.2972681
	speed: 0.1262s/iter; left time: 105259.9399s
	iters: 300, epoch: 1 | loss: 0.2934164
	speed: 0.1262s/iter; left time: 105268.1868s
	iters: 400, epoch: 1 | loss: 0.2561309
	speed: 0.1258s/iter; left time: 104883.4923s
	iters: 500, epoch: 1 | loss: 0.2443843
	speed: 0.1262s/iter; left time: 105261.7876s
	iters: 600, epoch: 1 | loss: 0.2162893
	speed: 0.1267s/iter; left time: 105601.9519s
	iters: 700, epoch: 1 | loss: 0.1846089
	speed: 0.1261s/iter; left time: 105163.0826s
	iters: 800, epoch: 1 | loss: 0.2338025
	speed: 0.1267s/iter; left time: 105626.9382s
	iters: 900, epoch: 1 | loss: 0.2028473
	speed: 0.1260s/iter; left time: 105033.0068s
	iters: 1000, epoch: 1 | loss: 0.1976561
	speed: 0.1264s/iter; left time: 105336.5800s
	iters: 1100, epoch: 1 | loss: 0.2203823
	speed: 0.1267s/iter; left time: 105573.5612s
	iters: 1200, epoch: 1 | loss: 0.1961810
	speed: 0.1264s/iter; left time: 105317.8886s
	iters: 1300, epoch: 1 | loss: 0.1741743
	speed: 0.1259s/iter; left time: 104904.0323s
	iters: 1400, epoch: 1 | loss: 0.2449690
	speed: 0.1264s/iter; left time: 105316.4903s
	iters: 1500, epoch: 1 | loss: 0.2010674
	speed: 0.1260s/iter; left time: 104933.8289s
	iters: 1600, epoch: 1 | loss: 0.1824962
	speed: 0.1265s/iter; left time: 105327.7662s
	iters: 1700, epoch: 1 | loss: 0.1966959
	speed: 0.1350s/iter; left time: 112375.0995s
	iters: 1800, epoch: 1 | loss: 0.1653616
	speed: 0.1314s/iter; left time: 109364.8390s
	iters: 1900, epoch: 1 | loss: 0.1972878
	speed: 0.1431s/iter; left time: 119122.3856s
	iters: 2000, epoch: 1 | loss: 0.1762687
	speed: 0.1697s/iter; left time: 141260.1904s
	iters: 2100, epoch: 1 | loss: 0.1763850
	speed: 0.1724s/iter; left time: 143506.7303s
	iters: 2200, epoch: 1 | loss: 0.1774448
	speed: 0.1722s/iter; left time: 143326.9469s
	iters: 2300, epoch: 1 | loss: 0.1546506
	speed: 0.1723s/iter; left time: 143368.7230s
	iters: 2400, epoch: 1 | loss: 0.1861197
	speed: 0.1719s/iter; left time: 143060.1355s
	iters: 2500, epoch: 1 | loss: 0.1729730
	speed: 0.1651s/iter; left time: 137305.9770s
	iters: 2600, epoch: 1 | loss: 0.1584690
	speed: 0.1686s/iter; left time: 140218.1809s
	iters: 2700, epoch: 1 | loss: 0.1575927
	speed: 0.1720s/iter; left time: 143050.0541s
	iters: 2800, epoch: 1 | loss: 0.1727640
	speed: 0.1722s/iter; left time: 143222.5741s
	iters: 2900, epoch: 1 | loss: 0.1668253
	speed: 0.1715s/iter; left time: 142639.0739s
	iters: 3000, epoch: 1 | loss: 0.1722552
	speed: 0.1715s/iter; left time: 142619.9670s
	iters: 3100, epoch: 1 | loss: 0.1846226
	speed: 0.1719s/iter; left time: 142934.1834s
	iters: 3200, epoch: 1 | loss: 0.1932625
	speed: 0.1718s/iter; left time: 142815.7007s
	iters: 3300, epoch: 1 | loss: 0.1728788
	speed: 0.1718s/iter; left time: 142807.3801s
	iters: 3400, epoch: 1 | loss: 0.1780479
	speed: 0.1724s/iter; left time: 143242.3725s
	iters: 3500, epoch: 1 | loss: 0.1647385
	speed: 0.1716s/iter; left time: 142620.5192s
	iters: 3600, epoch: 1 | loss: 0.1515741
	speed: 0.1725s/iter; left time: 143323.7499s
	iters: 3700, epoch: 1 | loss: 0.1592958
	speed: 0.1722s/iter; left time: 143019.3413s
	iters: 3800, epoch: 1 | loss: 0.1610899
	speed: 0.1720s/iter; left time: 142901.2913s
	iters: 3900, epoch: 1 | loss: 0.1767642
	speed: 0.1719s/iter; left time: 142768.6626s
	iters: 4000, epoch: 1 | loss: 0.1698668
	speed: 0.1716s/iter; left time: 142511.9323s
	iters: 4100, epoch: 1 | loss: 0.1491090
	speed: 0.1724s/iter; left time: 143115.2240s
Epoch: 1 cost time: 633.2716104984283
Epoch: 1, Steps: 4172 | Train Loss: 0.2002281 Vali Loss: 0.2373107 Test Loss: 0.2374207
Validation loss decreased (inf --> 0.237311).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1563194
	speed: 4.9432s/iter; left time: 4103495.2694s
	iters: 200, epoch: 2 | loss: 0.1406961
	speed: 0.1317s/iter; left time: 109295.1908s
	iters: 300, epoch: 2 | loss: 0.1654081
	speed: 0.1314s/iter; left time: 109049.0722s
	iters: 400, epoch: 2 | loss: 0.1809983
	speed: 0.1312s/iter; left time: 108887.4705s
	iters: 500, epoch: 2 | loss: 0.1555808
	speed: 0.1317s/iter; left time: 109255.4624s
	iters: 600, epoch: 2 | loss: 0.1573139
	speed: 0.1320s/iter; left time: 109475.9824s
	iters: 700, epoch: 2 | loss: 0.1634435
	speed: 0.1311s/iter; left time: 108749.0419s
	iters: 800, epoch: 2 | loss: 0.1456322
	speed: 0.1316s/iter; left time: 109128.0057s
	iters: 900, epoch: 2 | loss: 0.1358021
	speed: 0.1316s/iter; left time: 109141.7040s
	iters: 1000, epoch: 2 | loss: 0.1671367
	speed: 0.1311s/iter; left time: 108745.8905s
	iters: 1100, epoch: 2 | loss: 0.1404282
	speed: 0.1313s/iter; left time: 108860.2304s
	iters: 1200, epoch: 2 | loss: 0.1338643
	speed: 0.1316s/iter; left time: 109106.1863s
	iters: 1300, epoch: 2 | loss: 0.1341153
	speed: 0.1312s/iter; left time: 108790.4390s
	iters: 1400, epoch: 2 | loss: 0.1514150
	speed: 0.1302s/iter; left time: 107946.2102s
	iters: 1500, epoch: 2 | loss: 0.1569789
	speed: 0.1301s/iter; left time: 107793.7786s
	iters: 1600, epoch: 2 | loss: 0.1358889
	speed: 0.1303s/iter; left time: 108007.3438s
	iters: 1700, epoch: 2 | loss: 0.1550688
	speed: 0.1309s/iter; left time: 108422.7704s
	iters: 1800, epoch: 2 | loss: 0.1467115
	speed: 0.1315s/iter; left time: 108945.1021s
	iters: 1900, epoch: 2 | loss: 0.1415885
	speed: 0.1311s/iter; left time: 108603.9911s
	iters: 2000, epoch: 2 | loss: 0.1592158
	speed: 0.1319s/iter; left time: 109213.9082s
	iters: 2100, epoch: 2 | loss: 0.1483515
	speed: 0.1316s/iter; left time: 108998.6524s
	iters: 2200, epoch: 2 | loss: 0.1629278
	speed: 0.1314s/iter; left time: 108797.0120s
	iters: 2300, epoch: 2 | loss: 0.1210156
	speed: 0.1308s/iter; left time: 108316.5906s
	iters: 2400, epoch: 2 | loss: 0.1366473
	speed: 0.1319s/iter; left time: 109203.8595s
	iters: 2500, epoch: 2 | loss: 0.1384683
	speed: 0.1313s/iter; left time: 108695.5900s
	iters: 2600, epoch: 2 | loss: 0.1259698
	speed: 0.1316s/iter; left time: 108885.5579s
	iters: 2700, epoch: 2 | loss: 0.1216635
	speed: 0.1312s/iter; left time: 108608.7322s
	iters: 2800, epoch: 2 | loss: 0.1379859
	speed: 0.1312s/iter; left time: 108577.0540s
	iters: 2900, epoch: 2 | loss: 0.1415241
	speed: 0.1325s/iter; left time: 109593.9410s
	iters: 3000, epoch: 2 | loss: 0.1329830
	speed: 0.1323s/iter; left time: 109402.9515s
	iters: 3100, epoch: 2 | loss: 0.1461437
	speed: 0.1317s/iter; left time: 108935.2781s
	iters: 3200, epoch: 2 | loss: 0.1289280
	speed: 0.1322s/iter; left time: 109294.7703s
	iters: 3300, epoch: 2 | loss: 0.1335773
	speed: 0.1318s/iter; left time: 109020.9256s
	iters: 3400, epoch: 2 | loss: 0.1403544
	speed: 0.1310s/iter; left time: 108338.1258s
	iters: 3500, epoch: 2 | loss: 0.1404554
	speed: 0.1316s/iter; left time: 108788.4564s
	iters: 3600, epoch: 2 | loss: 0.1408084
	speed: 0.1316s/iter; left time: 108766.5726s
	iters: 3700, epoch: 2 | loss: 0.1307968
	speed: 0.1318s/iter; left time: 108912.5819s
	iters: 3800, epoch: 2 | loss: 0.1346524
	speed: 0.1318s/iter; left time: 108924.6767s
	iters: 3900, epoch: 2 | loss: 0.1394594
	speed: 0.1317s/iter; left time: 108838.8621s
	iters: 4000, epoch: 2 | loss: 0.1248932
	speed: 0.1314s/iter; left time: 108588.0203s
	iters: 4100, epoch: 2 | loss: 0.1368805
	speed: 0.1317s/iter; left time: 108777.4242s
Epoch: 2 cost time: 548.7620623111725
Epoch: 2, Steps: 4172 | Train Loss: 0.1504857 Vali Loss: 0.2319420 Test Loss: 0.2348972
Validation loss decreased (0.237311 --> 0.231942).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1486335
	speed: 4.9317s/iter; left time: 4073377.8207s
	iters: 200, epoch: 3 | loss: 0.1439110
	speed: 0.1254s/iter; left time: 103587.4678s
	iters: 300, epoch: 3 | loss: 0.1266622
	speed: 0.1251s/iter; left time: 103298.9856s
	iters: 400, epoch: 3 | loss: 0.1617398
	speed: 0.1250s/iter; left time: 103182.0972s
	iters: 500, epoch: 3 | loss: 0.1407580
	speed: 0.1252s/iter; left time: 103342.9448s
	iters: 600, epoch: 3 | loss: 0.1356964
	speed: 0.1256s/iter; left time: 103659.6155s
	iters: 700, epoch: 3 | loss: 0.1431606
	speed: 0.1258s/iter; left time: 103846.8508s
	iters: 800, epoch: 3 | loss: 0.1333159
	speed: 0.1256s/iter; left time: 103675.4547s
	iters: 900, epoch: 3 | loss: 0.1213399
	speed: 0.1257s/iter; left time: 103743.9989s
	iters: 1000, epoch: 3 | loss: 0.1428555
	speed: 0.1256s/iter; left time: 103627.4754s
	iters: 1100, epoch: 3 | loss: 0.1433556
	speed: 0.1255s/iter; left time: 103545.2181s
	iters: 1200, epoch: 3 | loss: 0.1330648
	speed: 0.1487s/iter; left time: 122666.1034s
	iters: 1300, epoch: 3 | loss: 0.1408312
	speed: 0.1722s/iter; left time: 142037.6635s
	iters: 1400, epoch: 3 | loss: 0.1256666
	speed: 0.1386s/iter; left time: 114257.6765s
	iters: 1500, epoch: 3 | loss: 0.1261172
	speed: 0.1254s/iter; left time: 103405.4769s
	iters: 1600, epoch: 3 | loss: 0.1363994
	speed: 0.1261s/iter; left time: 103948.4942s
	iters: 1700, epoch: 3 | loss: 0.1156087
	speed: 0.1253s/iter; left time: 103300.2181s
	iters: 1800, epoch: 3 | loss: 0.1430559
	speed: 0.1257s/iter; left time: 103568.1303s
	iters: 1900, epoch: 3 | loss: 0.1494663
	speed: 0.1254s/iter; left time: 103339.0737s
	iters: 2000, epoch: 3 | loss: 0.1279904
	speed: 0.1258s/iter; left time: 103691.7520s
	iters: 2100, epoch: 3 | loss: 0.1310900
	speed: 0.1256s/iter; left time: 103502.2825s
	iters: 2200, epoch: 3 | loss: 0.1216437
	speed: 0.1256s/iter; left time: 103503.2819s
	iters: 2300, epoch: 3 | loss: 0.1244988
	speed: 0.1254s/iter; left time: 103309.1615s
	iters: 2400, epoch: 3 | loss: 0.1110921
	speed: 0.1254s/iter; left time: 103291.4124s
	iters: 2500, epoch: 3 | loss: 0.1274695
	speed: 0.1253s/iter; left time: 103207.5944s
	iters: 2600, epoch: 3 | loss: 0.1483707
	speed: 0.1346s/iter; left time: 110876.8980s
	iters: 2700, epoch: 3 | loss: 0.1400754
	speed: 0.1721s/iter; left time: 141659.4428s
	iters: 2800, epoch: 3 | loss: 0.1305993
	speed: 0.1719s/iter; left time: 141495.7875s
	iters: 2900, epoch: 3 | loss: 0.1207966
	speed: 0.1721s/iter; left time: 141664.3328s
	iters: 3000, epoch: 3 | loss: 0.1261463
	speed: 0.1721s/iter; left time: 141622.2015s
	iters: 3100, epoch: 3 | loss: 0.0961413
	speed: 0.1724s/iter; left time: 141859.3688s
	iters: 3200, epoch: 3 | loss: 0.1307938
	speed: 0.1721s/iter; left time: 141609.9311s
	iters: 3300, epoch: 3 | loss: 0.1321075
	speed: 0.1718s/iter; left time: 141377.6100s
	iters: 3400, epoch: 3 | loss: 0.1320372
	speed: 0.1720s/iter; left time: 141507.7703s
	iters: 3500, epoch: 3 | loss: 0.1251023
	speed: 0.1719s/iter; left time: 141436.0810s
	iters: 3600, epoch: 3 | loss: 0.1331404
	speed: 0.1725s/iter; left time: 141875.0463s
	iters: 3700, epoch: 3 | loss: 0.1329875
	speed: 0.1722s/iter; left time: 141638.9325s
	iters: 3800, epoch: 3 | loss: 0.1247564
	speed: 0.1722s/iter; left time: 141580.9128s
	iters: 3900, epoch: 3 | loss: 0.1206902
	speed: 0.1722s/iter; left time: 141578.4367s
	iters: 4000, epoch: 3 | loss: 0.1260564
	speed: 0.1725s/iter; left time: 141774.7690s
	iters: 4100, epoch: 3 | loss: 0.1066832
	speed: 0.1720s/iter; left time: 141341.7747s
Epoch: 3 cost time: 606.5923388004303
Epoch: 3, Steps: 4172 | Train Loss: 0.1307020 Vali Loss: 0.2466925 Test Loss: 0.2605185
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.1197507
	speed: 6.2477s/iter; left time: 5134240.8852s
	iters: 200, epoch: 4 | loss: 0.1097319
	speed: 0.1270s/iter; left time: 104358.1074s
	iters: 300, epoch: 4 | loss: 0.1057653
	speed: 0.1276s/iter; left time: 104844.6355s
	iters: 400, epoch: 4 | loss: 0.1155488
	speed: 0.1275s/iter; left time: 104755.9952s
	iters: 500, epoch: 4 | loss: 0.1428088
	speed: 0.1278s/iter; left time: 104971.4596s
	iters: 600, epoch: 4 | loss: 0.1030707
	speed: 0.1259s/iter; left time: 103409.0015s
	iters: 700, epoch: 4 | loss: 0.1336007
	speed: 0.1258s/iter; left time: 103312.0482s
	iters: 800, epoch: 4 | loss: 0.1299214
	speed: 0.1260s/iter; left time: 103462.6545s
	iters: 900, epoch: 4 | loss: 0.1248402
	speed: 0.1261s/iter; left time: 103495.7567s
	iters: 1000, epoch: 4 | loss: 0.1141355
	speed: 0.1263s/iter; left time: 103689.9303s
	iters: 1100, epoch: 4 | loss: 0.1139527
	speed: 0.1268s/iter; left time: 104092.1996s
	iters: 1200, epoch: 4 | loss: 0.1208128
	speed: 0.1277s/iter; left time: 104818.1667s
	iters: 1300, epoch: 4 | loss: 0.1118667
	speed: 0.1279s/iter; left time: 104924.7602s
	iters: 1400, epoch: 4 | loss: 0.1076695
	speed: 0.1275s/iter; left time: 104627.9311s
	iters: 1500, epoch: 4 | loss: 0.1159661
	speed: 0.1272s/iter; left time: 104387.2718s
	iters: 1600, epoch: 4 | loss: 0.1323914
	speed: 0.1278s/iter; left time: 104846.0130s
	iters: 1700, epoch: 4 | loss: 0.1268471
	speed: 0.1267s/iter; left time: 103917.2152s
	iters: 1800, epoch: 4 | loss: 0.1192754
	speed: 0.1260s/iter; left time: 103296.3733s
	iters: 1900, epoch: 4 | loss: 0.0980388
	speed: 0.1266s/iter; left time: 103820.0116s
	iters: 2000, epoch: 4 | loss: 0.1318398
	speed: 0.1270s/iter; left time: 104141.0589s
	iters: 2100, epoch: 4 | loss: 0.1169923
	speed: 0.1278s/iter; left time: 104756.4184s
	iters: 2200, epoch: 4 | loss: 0.1134500
	speed: 0.1281s/iter; left time: 104987.0007s
	iters: 2300, epoch: 4 | loss: 0.1201595
	speed: 0.1272s/iter; left time: 104290.8461s
	iters: 2400, epoch: 4 | loss: 0.1241751
	speed: 0.1279s/iter; left time: 104829.9362s
	iters: 2500, epoch: 4 | loss: 0.1131126
	speed: 0.1279s/iter; left time: 104812.0452s
	iters: 2600, epoch: 4 | loss: 0.1316486
	speed: 0.1261s/iter; left time: 103305.7394s
	iters: 2700, epoch: 4 | loss: 0.1361206
	speed: 0.1259s/iter; left time: 103152.7713s
	iters: 2800, epoch: 4 | loss: 0.0994439
	speed: 0.1270s/iter; left time: 103991.2316s
	iters: 2900, epoch: 4 | loss: 0.1211120
	speed: 0.1281s/iter; left time: 104937.9985s
	iters: 3000, epoch: 4 | loss: 0.1172810
	speed: 0.1275s/iter; left time: 104422.9450s
	iters: 3100, epoch: 4 | loss: 0.1221711
	speed: 0.1275s/iter; left time: 104417.1525s
	iters: 3200, epoch: 4 | loss: 0.1079783
	speed: 0.1279s/iter; left time: 104702.8488s
	iters: 3300, epoch: 4 | loss: 0.1168749
	speed: 0.1272s/iter; left time: 104099.1305s
	iters: 3400, epoch: 4 | loss: 0.1141512
	speed: 0.1267s/iter; left time: 103697.6731s
	iters: 3500, epoch: 4 | loss: 0.1098254
	speed: 0.1276s/iter; left time: 104394.0456s
	iters: 3600, epoch: 4 | loss: 0.1234716
	speed: 0.1265s/iter; left time: 103500.0268s
	iters: 3700, epoch: 4 | loss: 0.1182465
	speed: 0.1262s/iter; left time: 103228.2546s
	iters: 3800, epoch: 4 | loss: 0.0976329
	speed: 0.1264s/iter; left time: 103368.0141s
	iters: 3900, epoch: 4 | loss: 0.1074942
	speed: 0.1263s/iter; left time: 103276.3477s
	iters: 4000, epoch: 4 | loss: 0.1065561
	speed: 0.1271s/iter; left time: 103984.4928s
	iters: 4100, epoch: 4 | loss: 0.1212749
	speed: 0.1275s/iter; left time: 104256.2360s
Epoch: 4 cost time: 532.2049489021301
Epoch: 4, Steps: 4172 | Train Loss: 0.1179729 Vali Loss: 0.3124628 Test Loss: 0.2718726
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.1228167
	speed: 4.9282s/iter; left time: 4029320.0405s
	iters: 200, epoch: 5 | loss: 0.1255722
	speed: 0.1249s/iter; left time: 102107.6116s
	iters: 300, epoch: 5 | loss: 0.1164669
	speed: 0.1252s/iter; left time: 102300.4968s
	iters: 400, epoch: 5 | loss: 0.1093379
	speed: 0.1248s/iter; left time: 101996.9738s
	iters: 500, epoch: 5 | loss: 0.1026457
	speed: 0.1245s/iter; left time: 101743.8138s
	iters: 600, epoch: 5 | loss: 0.1045204
	speed: 0.1244s/iter; left time: 101609.3219s
	iters: 700, epoch: 5 | loss: 0.1041532
	speed: 0.1248s/iter; left time: 101978.9636s
	iters: 800, epoch: 5 | loss: 0.1093057
	speed: 0.1243s/iter; left time: 101538.0639s
	iters: 900, epoch: 5 | loss: 0.1020558
	speed: 0.1242s/iter; left time: 101411.6453s
	iters: 1000, epoch: 5 | loss: 0.1124950
	speed: 0.1244s/iter; left time: 101594.3465s
	iters: 1100, epoch: 5 | loss: 0.1134200
	speed: 0.1245s/iter; left time: 101687.6911s
	iters: 1200, epoch: 5 | loss: 0.0950857
	speed: 0.1243s/iter; left time: 101516.9880s
	iters: 1300, epoch: 5 | loss: 0.1078202
	speed: 0.1243s/iter; left time: 101493.5263s
	iters: 1400, epoch: 5 | loss: 0.1234711
	speed: 0.1244s/iter; left time: 101540.3635s
	iters: 1500, epoch: 5 | loss: 0.1000667
	speed: 0.1245s/iter; left time: 101641.8554s
	iters: 1600, epoch: 5 | loss: 0.1037173
	speed: 0.1248s/iter; left time: 101836.1575s
	iters: 1700, epoch: 5 | loss: 0.0935044
	speed: 0.1243s/iter; left time: 101426.6694s
	iters: 1800, epoch: 5 | loss: 0.1008371
	speed: 0.1245s/iter; left time: 101597.0094s
	iters: 1900, epoch: 5 | loss: 0.1162354
	speed: 0.1249s/iter; left time: 101919.2285s
	iters: 2000, epoch: 5 | loss: 0.1013508
	speed: 0.1248s/iter; left time: 101839.8866s
	iters: 2100, epoch: 5 | loss: 0.1088091
	speed: 0.1245s/iter; left time: 101577.8975s
	iters: 2200, epoch: 5 | loss: 0.1004277
	speed: 0.1243s/iter; left time: 101400.4685s
	iters: 2300, epoch: 5 | loss: 0.1210990
	speed: 0.1247s/iter; left time: 101716.4565s
	iters: 2400, epoch: 5 | loss: 0.1057416
	speed: 0.1246s/iter; left time: 101562.4714s
	iters: 2500, epoch: 5 | loss: 0.1281064
	speed: 0.1250s/iter; left time: 101875.0829s
	iters: 2600, epoch: 5 | loss: 0.0901048
	speed: 0.1248s/iter; left time: 101706.8942s
	iters: 2700, epoch: 5 | loss: 0.0978841
	speed: 0.1248s/iter; left time: 101726.2180s
	iters: 2800, epoch: 5 | loss: 0.1092220
	speed: 0.1247s/iter; left time: 101622.1480s
	iters: 2900, epoch: 5 | loss: 0.0986018
	speed: 0.1243s/iter; left time: 101300.1469s
	iters: 3000, epoch: 5 | loss: 0.1119422
	speed: 0.1242s/iter; left time: 101196.6983s
	iters: 3100, epoch: 5 | loss: 0.1080518
	speed: 0.1244s/iter; left time: 101336.9079s
	iters: 3200, epoch: 5 | loss: 0.1070043
	speed: 0.1249s/iter; left time: 101760.7641s
	iters: 3300, epoch: 5 | loss: 0.1032079
	speed: 0.1253s/iter; left time: 102040.4478s
	iters: 3400, epoch: 5 | loss: 0.1150311
	speed: 0.1247s/iter; left time: 101514.6375s
	iters: 3500, epoch: 5 | loss: 0.0955867
	speed: 0.1247s/iter; left time: 101524.1790s
	iters: 3600, epoch: 5 | loss: 0.0992196
	speed: 0.1247s/iter; left time: 101488.3171s
	iters: 3700, epoch: 5 | loss: 0.0999685
	speed: 0.1245s/iter; left time: 101367.7178s
	iters: 3800, epoch: 5 | loss: 0.1021186
	speed: 0.1245s/iter; left time: 101335.9801s
	iters: 3900, epoch: 5 | loss: 0.1106959
	speed: 0.1242s/iter; left time: 101073.4972s
	iters: 4000, epoch: 5 | loss: 0.0946338
	speed: 0.1250s/iter; left time: 101701.0414s
	iters: 4100, epoch: 5 | loss: 0.1065077
	speed: 0.1247s/iter; left time: 101483.6201s
Epoch: 5 cost time: 520.8569786548615
Epoch: 5, Steps: 4172 | Train Loss: 0.1090016 Vali Loss: 0.3194016 Test Loss: 0.2797141
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.1080746
	speed: 4.9274s/iter; left time: 4008128.8276s
	iters: 200, epoch: 6 | loss: 0.1205107
	speed: 0.1270s/iter; left time: 103321.0871s
	iters: 300, epoch: 6 | loss: 0.1081304
	speed: 0.1269s/iter; left time: 103228.7835s
	iters: 400, epoch: 6 | loss: 0.0997945
	speed: 0.1266s/iter; left time: 102979.9434s
	iters: 500, epoch: 6 | loss: 0.1011997
	speed: 0.1264s/iter; left time: 102736.9224s
	iters: 600, epoch: 6 | loss: 0.1122006
	speed: 0.1257s/iter; left time: 102183.7991s
	iters: 700, epoch: 6 | loss: 0.1028959
	speed: 0.1255s/iter; left time: 102046.4556s
	iters: 800, epoch: 6 | loss: 0.0998895
	speed: 0.1258s/iter; left time: 102281.9515s
	iters: 900, epoch: 6 | loss: 0.1016277
	speed: 0.1258s/iter; left time: 102192.0532s
	iters: 1000, epoch: 6 | loss: 0.1139701
	speed: 0.1261s/iter; left time: 102438.3098s
	iters: 1100, epoch: 6 | loss: 0.1108845
	speed: 0.1260s/iter; left time: 102361.2874s
	iters: 1200, epoch: 6 | loss: 0.1021718
	speed: 0.1259s/iter; left time: 102273.1095s
	iters: 1300, epoch: 6 | loss: 0.0943507
	speed: 0.1254s/iter; left time: 101890.7327s
	iters: 1400, epoch: 6 | loss: 0.0948188
	speed: 0.1257s/iter; left time: 102070.1739s
	iters: 1500, epoch: 6 | loss: 0.1024191
	speed: 0.1260s/iter; left time: 102306.9312s
	iters: 1600, epoch: 6 | loss: 0.0943659
	speed: 0.1257s/iter; left time: 102031.5161s
	iters: 1700, epoch: 6 | loss: 0.1217472
	speed: 0.1260s/iter; left time: 102265.2968s
	iters: 1800, epoch: 6 | loss: 0.1059590
	speed: 0.1251s/iter; left time: 101545.6289s
	iters: 1900, epoch: 6 | loss: 0.1125487
	speed: 0.1260s/iter; left time: 102270.4942s
	iters: 2000, epoch: 6 | loss: 0.1100673
	speed: 0.1260s/iter; left time: 102236.2406s
	iters: 2100, epoch: 6 | loss: 0.0955004
	speed: 0.1257s/iter; left time: 102035.1039s
	iters: 2200, epoch: 6 | loss: 0.1120946
	speed: 0.1257s/iter; left time: 101977.2356s
	iters: 2300, epoch: 6 | loss: 0.0917803
	speed: 0.1261s/iter; left time: 102321.4127s
	iters: 2400, epoch: 6 | loss: 0.1044361
	speed: 0.1254s/iter; left time: 101693.7794s
	iters: 2500, epoch: 6 | loss: 0.1008524
	speed: 0.1263s/iter; left time: 102458.2943s
	iters: 2600, epoch: 6 | loss: 0.0970108
	speed: 0.1261s/iter; left time: 102254.3462s
	iters: 2700, epoch: 6 | loss: 0.0978933
	speed: 0.1266s/iter; left time: 102629.7698s
	iters: 2800, epoch: 6 | loss: 0.1109266
	speed: 0.1256s/iter; left time: 101794.8732s
	iters: 2900, epoch: 6 | loss: 0.0986483
	speed: 0.1258s/iter; left time: 101951.1462s
	iters: 3000, epoch: 6 | loss: 0.1055179
	speed: 0.1257s/iter; left time: 101867.4717s
	iters: 3100, epoch: 6 | loss: 0.0984267
	speed: 0.1262s/iter; left time: 102259.5598s
	iters: 3200, epoch: 6 | loss: 0.0948120
	speed: 0.1258s/iter; left time: 101933.0262s
	iters: 3300, epoch: 6 | loss: 0.1067410
	speed: 0.1259s/iter; left time: 102014.1127s
	iters: 3400, epoch: 6 | loss: 0.1034609
	speed: 0.1257s/iter; left time: 101850.8688s
	iters: 3500, epoch: 6 | loss: 0.1013763
	speed: 0.1267s/iter; left time: 102592.8048s
	iters: 3600, epoch: 6 | loss: 0.0900411
	speed: 0.1259s/iter; left time: 101942.6364s
	iters: 3700, epoch: 6 | loss: 0.1054181
	speed: 0.1257s/iter; left time: 101793.4238s
	iters: 3800, epoch: 6 | loss: 0.1101872
	speed: 0.1258s/iter; left time: 101871.0969s
	iters: 3900, epoch: 6 | loss: 0.0875095
	speed: 0.1264s/iter; left time: 102327.4582s
	iters: 4000, epoch: 6 | loss: 0.1071071
	speed: 0.1260s/iter; left time: 102016.1044s
	iters: 4100, epoch: 6 | loss: 0.0991917
	speed: 0.1260s/iter; left time: 101967.8968s
Epoch: 6 cost time: 526.0711023807526
Epoch: 6, Steps: 4172 | Train Loss: 0.1023964 Vali Loss: 0.2651310 Test Loss: 0.2814287
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.1018319
	speed: 4.9286s/iter; left time: 3988553.8888s
	iters: 200, epoch: 7 | loss: 0.0977724
	speed: 0.1264s/iter; left time: 102285.4967s
	iters: 300, epoch: 7 | loss: 0.0994677
	speed: 0.1249s/iter; left time: 101059.6181s
	iters: 400, epoch: 7 | loss: 0.1110506
	speed: 0.1250s/iter; left time: 101159.2368s
	iters: 500, epoch: 7 | loss: 0.1082298
	speed: 0.1247s/iter; left time: 100853.0725s
	iters: 600, epoch: 7 | loss: 0.1001312
	speed: 0.1246s/iter; left time: 100785.3982s
	iters: 700, epoch: 7 | loss: 0.1053953
	speed: 0.1246s/iter; left time: 100734.9739s
	iters: 800, epoch: 7 | loss: 0.0922460
	speed: 0.1248s/iter; left time: 100916.1085s
	iters: 900, epoch: 7 | loss: 0.0988322
	speed: 0.1249s/iter; left time: 100990.0855s
	iters: 1000, epoch: 7 | loss: 0.0911036
	speed: 0.1246s/iter; left time: 100692.9007s
	iters: 1100, epoch: 7 | loss: 0.0962476
	speed: 0.1246s/iter; left time: 100695.6662s
	iters: 1200, epoch: 7 | loss: 0.1102561
	speed: 0.1251s/iter; left time: 101078.9375s
	iters: 1300, epoch: 7 | loss: 0.1035192
	speed: 0.1250s/iter; left time: 100995.4953s
	iters: 1400, epoch: 7 | loss: 0.1008900
	speed: 0.1248s/iter; left time: 100868.4312s
	iters: 1500, epoch: 7 | loss: 0.1024698
	speed: 0.1249s/iter; left time: 100935.2430s
	iters: 1600, epoch: 7 | loss: 0.0840421
	speed: 0.1251s/iter; left time: 101022.5150s
	iters: 1700, epoch: 7 | loss: 0.1052876
	speed: 0.1250s/iter; left time: 100984.9003s
	iters: 1800, epoch: 7 | loss: 0.1106122
	speed: 0.1250s/iter; left time: 100950.9558s
	iters: 1900, epoch: 7 | loss: 0.1074624
	speed: 0.1250s/iter; left time: 100938.5515s
	iters: 2000, epoch: 7 | loss: 0.1069753
	speed: 0.1250s/iter; left time: 100955.3654s
	iters: 2100, epoch: 7 | loss: 0.0972420
	speed: 0.1244s/iter; left time: 100426.0810s
	iters: 2200, epoch: 7 | loss: 0.1043060
	speed: 0.1245s/iter; left time: 100513.0516s
	iters: 2300, epoch: 7 | loss: 0.0946271
	speed: 0.1249s/iter; left time: 100764.8767s
	iters: 2400, epoch: 7 | loss: 0.0920346
	speed: 0.1249s/iter; left time: 100827.3837s
	iters: 2500, epoch: 7 | loss: 0.1000533
	speed: 0.1250s/iter; left time: 100844.5183s
	iters: 2600, epoch: 7 | loss: 0.0926879
	speed: 0.1247s/iter; left time: 100564.5399s
	iters: 2700, epoch: 7 | loss: 0.0911470
	speed: 0.1248s/iter; left time: 100660.0191s
	iters: 2800, epoch: 7 | loss: 0.0987969
	speed: 0.1247s/iter; left time: 100590.2445s
	iters: 2900, epoch: 7 | loss: 0.1003927
	speed: 0.1248s/iter; left time: 100640.5171s
	iters: 3000, epoch: 7 | loss: 0.0971271
	speed: 0.1243s/iter; left time: 100267.2937s
	iters: 3100, epoch: 7 | loss: 0.0991187
	speed: 0.1247s/iter; left time: 100575.7845s
	iters: 3200, epoch: 7 | loss: 0.0983015
	speed: 0.1250s/iter; left time: 100742.5844s
	iters: 3300, epoch: 7 | loss: 0.0962696
	speed: 0.1247s/iter; left time: 100485.5807s
	iters: 3400, epoch: 7 | loss: 0.0834774
	speed: 0.1249s/iter; left time: 100684.7152s
	iters: 3500, epoch: 7 | loss: 0.0916812
	speed: 0.1244s/iter; left time: 100229.7686s
	iters: 3600, epoch: 7 | loss: 0.1070553
	speed: 0.1245s/iter; left time: 100330.4937s
	iters: 3700, epoch: 7 | loss: 0.0968597
	speed: 0.1249s/iter; left time: 100668.0890s
	iters: 3800, epoch: 7 | loss: 0.0905083
	speed: 0.1251s/iter; left time: 100781.8694s
	iters: 3900, epoch: 7 | loss: 0.0928130
	speed: 0.1251s/iter; left time: 100761.0358s
	iters: 4000, epoch: 7 | loss: 0.1182073
	speed: 0.1243s/iter; left time: 100114.3508s
	iters: 4100, epoch: 7 | loss: 0.0942210
	speed: 0.1246s/iter; left time: 100348.6266s
Epoch: 7 cost time: 521.2555725574493
Epoch: 7, Steps: 4172 | Train Loss: 0.0977262 Vali Loss: 0.2590609 Test Loss: 0.2630769
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl192_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 38036
test shape: (38036, 1, 192, 151) (38036, 1, 192, 151)
test shape: (38036, 192, 151) (38036, 192, 151)
mse:0.23489618301391602, mae:0.3403666615486145
>>>>>>>Overall time: 8053 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
