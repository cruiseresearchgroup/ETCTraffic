Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=822, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems04_d.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems04_d_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=822, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems04_d.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems04_d_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=822, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems04_d.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems04_d_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_d_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>start training : long_term_forecast_pems04_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>start training : long_term_forecast_pems04_d_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
traintrain  51435287

train 5383
val 607
val 703
val 463
test 1497
test 1401
test 1257
	iters: 100, epoch: 1 | loss: 0.5313606
	speed: 0.1212s/iter; left time: 395.1650s
	iters: 100, epoch: 1 | loss: 0.7337849
	speed: 0.1229s/iter; left time: 393.5076s
	iters: 100, epoch: 1 | loss: 0.8214585
	speed: 0.1281s/iter; left time: 398.5029s
	iters: 200, epoch: 1 | loss: 0.6466778
	speed: 0.1143s/iter; left time: 361.2208s
	iters: 200, epoch: 1 | loss: 0.6556108
	speed: 0.1156s/iter; left time: 358.3466s
	iters: 200, epoch: 1 | loss: 0.7471771
	speed: 0.1225s/iter; left time: 368.8361s
	iters: 300, epoch: 1 | loss: 0.7842793
	speed: 0.1143s/iter; left time: 349.9340s
	iters: 300, epoch: 1 | loss: 0.7174441
	speed: 0.1168s/iter; left time: 350.3756s
	iters: 300, epoch: 1 | loss: 0.6836614
	speed: 0.1220s/iter; left time: 355.0264s
Epoch: 1 cost time: 39.20500349998474
Epoch: 1 cost time: 39.21995997428894
Epoch: 1 cost time: 39.94808006286621
Epoch: 1, Steps: 336 | Train Loss: 0.5665300 Vali Loss: 0.3747513 Test Loss: 0.5340448
Validation loss decreased (inf --> 0.374751).  Saving model ...
Updating learning rate to 0.001
Epoch: 1, Steps: 330 | Train Loss: 0.6535212 Vali Loss: 0.4561592 Test Loss: 0.6338785
Validation loss decreased (inf --> 0.456159).  Saving model ...
Updating learning rate to 0.001
Epoch: 1, Steps: 321 | Train Loss: 0.7378697 Vali Loss: 0.5228854 Test Loss: 0.7056829
Validation loss decreased (inf --> 0.522885).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.5433695
	speed: 0.2787s/iter; left time: 815.3127s
	iters: 100, epoch: 2 | loss: 0.5008408
	speed: 0.2839s/iter; left time: 815.1516s
	iters: 100, epoch: 2 | loss: 0.6980951
	speed: 0.2937s/iter; left time: 819.5100s
	iters: 200, epoch: 2 | loss: 0.6213102
	speed: 0.1144s/iter; left time: 323.2211s
	iters: 200, epoch: 2 | loss: 0.6749706
	speed: 0.1174s/iter; left time: 325.2367s
	iters: 200, epoch: 2 | loss: 0.7345606
	speed: 0.1196s/iter; left time: 321.6962s
	iters: 300, epoch: 2 | loss: 0.6062265
	speed: 0.1145s/iter; left time: 312.0171s
	iters: 300, epoch: 2 | loss: 0.7286116
	speed: 0.1174s/iter; left time: 313.6412s
Epoch: 2 cost time: 38.98146152496338
	iters: 300, epoch: 2 | loss: 0.8573011
	speed: 0.1193s/iter; left time: 308.8723s
Epoch: 2 cost time: 39.30315971374512
Epoch: 2 cost time: 39.08882236480713
Epoch: 2, Steps: 336 | Train Loss: 0.5593112 Vali Loss: 0.4210095 Test Loss: 0.5858946
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
Epoch: 2, Steps: 330 | Train Loss: 0.6927397 Vali Loss: 0.5579144 Test Loss: 0.7383682
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
Epoch: 2, Steps: 321 | Train Loss: 0.7680906 Vali Loss: 0.6073284 Test Loss: 0.7675343
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.5513715
	speed: 0.2767s/iter; left time: 716.4160s
	iters: 100, epoch: 3 | loss: 0.8408067
	speed: 0.2821s/iter; left time: 716.8708s
	iters: 100, epoch: 3 | loss: 0.9143426
	speed: 0.2944s/iter; left time: 726.9683s
	iters: 200, epoch: 3 | loss: 0.8741949
	speed: 0.1148s/iter; left time: 285.7559s
	iters: 200, epoch: 3 | loss: 0.9321014
	speed: 0.1164s/iter; left time: 284.1211s
	iters: 200, epoch: 3 | loss: 0.8792444
	speed: 0.1205s/iter; left time: 285.4714s
	iters: 300, epoch: 3 | loss: 0.6293933
	speed: 0.1150s/iter; left time: 274.6554s
	iters: 300, epoch: 3 | loss: 0.8828267
	speed: 0.1164s/iter; left time: 272.5344s
Epoch: 3 cost time: 39.151504039764404
Epoch: 3 cost time: 38.995686531066895
	iters: 300, epoch: 3 | loss: 0.9703448
	speed: 0.1206s/iter; left time: 273.6290s
Epoch: 3 cost time: 39.333606243133545
Epoch: 3, Steps: 336 | Train Loss: 0.5843976 Vali Loss: 0.3856542 Test Loss: 0.5555120
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
Epoch: 3, Steps: 330 | Train Loss: 0.7397985 Vali Loss: 0.5081235 Test Loss: 0.6998799
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
Epoch: 3, Steps: 321 | Train Loss: 0.8262283 Vali Loss: 0.5941548 Test Loss: 0.7608252
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.6289244
	speed: 0.2778s/iter; left time: 625.8628s
	iters: 100, epoch: 4 | loss: 0.6244030
	speed: 0.2889s/iter; left time: 638.6932s
	iters: 100, epoch: 4 | loss: 0.8573416
	speed: 0.3014s/iter; left time: 647.3732s
	iters: 200, epoch: 4 | loss: 0.6102073
	speed: 0.1146s/iter; left time: 246.7554s
	iters: 200, epoch: 4 | loss: 0.7109647
	speed: 0.1156s/iter; left time: 243.9563s
	iters: 200, epoch: 4 | loss: 0.8988457
	speed: 0.1229s/iter; left time: 251.6950s
	iters: 300, epoch: 4 | loss: 0.6009850
	speed: 0.1146s/iter; left time: 235.2058s
	iters: 300, epoch: 4 | loss: 0.5739968
	speed: 0.1156s/iter; left time: 232.5539s
Epoch: 4 cost time: 39.0682532787323
Epoch: 4 cost time: 38.91712522506714
	iters: 300, epoch: 4 | loss: 0.8615635
	speed: 0.1229s/iter; left time: 239.3868s
Epoch: 4 cost time: 40.27071928977966
Epoch: 4, Steps: 336 | Train Loss: 0.5488113 Vali Loss: 0.3780234 Test Loss: 0.5401972
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_d_96_96_iTransformer_custom_ftM_sl96_ll48_pl96_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1497
Epoch: 4, Steps: 330 | Train Loss: 0.7001907 Vali Loss: 0.4835394 Test Loss: 0.6850454
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1401
test shape: (1497, 1, 96, 822) (1497, 1, 96, 822)
test shape: (1497, 96, 822) (1497, 96, 822)
mse:0.5340451002120972, mae:0.44158172607421875
>>>>>>>Overall time: 218 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Epoch: 4, Steps: 321 | Train Loss: 0.8138393 Vali Loss: 0.5929064 Test Loss: 0.7580332
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems04_d_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1257
test shape: (1401, 1, 192, 822) (1401, 1, 192, 822)
test shape: (1401, 192, 822) (1401, 192, 822)
mse:0.6338783502578735, mae:0.5079771280288696
>>>>>>>Overall time: 224 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test shape: (1257, 1, 336, 822) (1257, 1, 336, 822)
test shape: (1257, 336, 822) (1257, 336, 822)
mse:0.7056798934936523, mae:0.5551214814186096
>>>>>>>Overall time: 237 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
