Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems05_h.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems05_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_h_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 73678
val 10459
test 21010
	iters: 100, epoch: 1 | loss: 0.1747076
	speed: 0.0102s/iter; left time: 4705.4201s
	iters: 200, epoch: 1 | loss: 0.1626540
	speed: 0.0057s/iter; left time: 2639.3434s
	iters: 300, epoch: 1 | loss: 0.1525212
	speed: 0.0057s/iter; left time: 2634.0387s
	iters: 400, epoch: 1 | loss: 0.1617213
	speed: 0.0057s/iter; left time: 2641.9505s
	iters: 500, epoch: 1 | loss: 0.1702790
	speed: 0.0058s/iter; left time: 2645.5702s
	iters: 600, epoch: 1 | loss: 0.1429625
	speed: 0.0058s/iter; left time: 2654.8788s
	iters: 700, epoch: 1 | loss: 0.1267517
	speed: 0.0058s/iter; left time: 2650.1332s
	iters: 800, epoch: 1 | loss: 0.1256411
	speed: 0.0058s/iter; left time: 2654.2094s
	iters: 900, epoch: 1 | loss: 0.1422647
	speed: 0.0058s/iter; left time: 2672.8082s
	iters: 1000, epoch: 1 | loss: 0.1411357
	speed: 0.0058s/iter; left time: 2666.9921s
	iters: 1100, epoch: 1 | loss: 0.1420574
	speed: 0.0058s/iter; left time: 2672.1770s
	iters: 1200, epoch: 1 | loss: 0.1250177
	speed: 0.0058s/iter; left time: 2653.7179s
	iters: 1300, epoch: 1 | loss: 0.1292719
	speed: 0.0058s/iter; left time: 2654.7884s
	iters: 1400, epoch: 1 | loss: 0.1273588
	speed: 0.0058s/iter; left time: 2648.8216s
	iters: 1500, epoch: 1 | loss: 0.1322725
	speed: 0.0058s/iter; left time: 2641.3090s
	iters: 1600, epoch: 1 | loss: 0.1298034
	speed: 0.0058s/iter; left time: 2642.6444s
	iters: 1700, epoch: 1 | loss: 0.1366851
	speed: 0.0058s/iter; left time: 2645.6862s
	iters: 1800, epoch: 1 | loss: 0.1295090
	speed: 0.0058s/iter; left time: 2647.4689s
	iters: 1900, epoch: 1 | loss: 0.1301828
	speed: 0.0058s/iter; left time: 2640.8793s
	iters: 2000, epoch: 1 | loss: 0.1617706
	speed: 0.0057s/iter; left time: 2620.7445s
	iters: 2100, epoch: 1 | loss: 0.1313368
	speed: 0.0058s/iter; left time: 2641.3303s
	iters: 2200, epoch: 1 | loss: 0.1235136
	speed: 0.0058s/iter; left time: 2644.1099s
	iters: 2300, epoch: 1 | loss: 0.1278156
	speed: 0.0057s/iter; left time: 2615.2984s
Epoch: 1 cost time: 13.76898193359375
Epoch: 1, Steps: 2302 | Train Loss: 0.1463932 Vali Loss: 0.1162890 Test Loss: 0.1504263
Validation loss decreased (inf --> 0.116289).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1416591
	speed: 0.2889s/iter; left time: 132298.6674s
	iters: 200, epoch: 2 | loss: 0.1212855
	speed: 0.0052s/iter; left time: 2368.7580s
	iters: 300, epoch: 2 | loss: 0.1519959
	speed: 0.0052s/iter; left time: 2374.7055s
	iters: 400, epoch: 2 | loss: 0.1417426
	speed: 0.0052s/iter; left time: 2376.0222s
	iters: 500, epoch: 2 | loss: 0.1413970
	speed: 0.0052s/iter; left time: 2375.0874s
	iters: 600, epoch: 2 | loss: 0.1264964
	speed: 0.0053s/iter; left time: 2426.7319s
	iters: 700, epoch: 2 | loss: 0.1394774
	speed: 0.0053s/iter; left time: 2424.7446s
	iters: 800, epoch: 2 | loss: 0.1104062
	speed: 0.0053s/iter; left time: 2425.9753s
	iters: 900, epoch: 2 | loss: 0.1261565
	speed: 0.0053s/iter; left time: 2425.4208s
	iters: 1000, epoch: 2 | loss: 0.1385535
	speed: 0.0053s/iter; left time: 2433.4812s
	iters: 1100, epoch: 2 | loss: 0.1258346
	speed: 0.0053s/iter; left time: 2422.8518s
	iters: 1200, epoch: 2 | loss: 0.1251529
	speed: 0.0053s/iter; left time: 2429.3805s
	iters: 1300, epoch: 2 | loss: 0.1200338
	speed: 0.0053s/iter; left time: 2427.7347s
	iters: 1400, epoch: 2 | loss: 0.1248991
	speed: 0.0053s/iter; left time: 2428.7004s
	iters: 1500, epoch: 2 | loss: 0.1409598
	speed: 0.0053s/iter; left time: 2426.6108s
	iters: 1600, epoch: 2 | loss: 0.1311859
	speed: 0.0053s/iter; left time: 2429.4664s
	iters: 1700, epoch: 2 | loss: 0.1632897
	speed: 0.0053s/iter; left time: 2426.3379s
	iters: 1800, epoch: 2 | loss: 0.1355296
	speed: 0.0053s/iter; left time: 2426.8648s
	iters: 1900, epoch: 2 | loss: 0.1371801
	speed: 0.0053s/iter; left time: 2425.9370s
	iters: 2000, epoch: 2 | loss: 0.1403521
	speed: 0.0053s/iter; left time: 2426.3567s
	iters: 2100, epoch: 2 | loss: 0.1468412
	speed: 0.0053s/iter; left time: 2426.3531s
	iters: 2200, epoch: 2 | loss: 0.1526086
	speed: 0.0053s/iter; left time: 2424.2895s
	iters: 2300, epoch: 2 | loss: 0.1340820
	speed: 0.0053s/iter; left time: 2398.8352s
Epoch: 2 cost time: 12.50165343284607
Epoch: 2, Steps: 2302 | Train Loss: 0.1322249 Vali Loss: 0.1144884 Test Loss: 0.1483731
Validation loss decreased (0.116289 --> 0.114488).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1210111
	speed: 0.2925s/iter; left time: 133309.1916s
	iters: 200, epoch: 3 | loss: 0.1208073
	speed: 0.0057s/iter; left time: 2581.0046s
	iters: 300, epoch: 3 | loss: 0.1591939
	speed: 0.0057s/iter; left time: 2588.4157s
	iters: 400, epoch: 3 | loss: 0.1269173
	speed: 0.0057s/iter; left time: 2593.2024s
	iters: 500, epoch: 3 | loss: 0.1382060
	speed: 0.0057s/iter; left time: 2600.4812s
	iters: 600, epoch: 3 | loss: 0.1429198
	speed: 0.0057s/iter; left time: 2594.6432s
	iters: 700, epoch: 3 | loss: 0.1218359
	speed: 0.0057s/iter; left time: 2597.3023s
	iters: 800, epoch: 3 | loss: 0.1255525
	speed: 0.0057s/iter; left time: 2599.9968s
	iters: 900, epoch: 3 | loss: 0.1228279
	speed: 0.0057s/iter; left time: 2600.0663s
	iters: 1000, epoch: 3 | loss: 0.1144206
	speed: 0.0057s/iter; left time: 2599.5989s
	iters: 1100, epoch: 3 | loss: 0.1428385
	speed: 0.0057s/iter; left time: 2604.6515s
	iters: 1200, epoch: 3 | loss: 0.1185409
	speed: 0.0057s/iter; left time: 2601.5598s
	iters: 1300, epoch: 3 | loss: 0.1263459
	speed: 0.0057s/iter; left time: 2600.3450s
	iters: 1400, epoch: 3 | loss: 0.1385023
	speed: 0.0057s/iter; left time: 2601.2126s
	iters: 1500, epoch: 3 | loss: 0.1254557
	speed: 0.0057s/iter; left time: 2602.6634s
	iters: 1600, epoch: 3 | loss: 0.1291595
	speed: 0.0058s/iter; left time: 2612.6953s
	iters: 1700, epoch: 3 | loss: 0.1504568
	speed: 0.0057s/iter; left time: 2598.9463s
	iters: 1800, epoch: 3 | loss: 0.1196877
	speed: 0.0057s/iter; left time: 2601.9676s
	iters: 1900, epoch: 3 | loss: 0.1326535
	speed: 0.0057s/iter; left time: 2598.9823s
	iters: 2000, epoch: 3 | loss: 0.1375474
	speed: 0.0057s/iter; left time: 2599.9396s
	iters: 2100, epoch: 3 | loss: 0.1406178
	speed: 0.0057s/iter; left time: 2602.0309s
	iters: 2200, epoch: 3 | loss: 0.1783643
	speed: 0.0057s/iter; left time: 2605.9270s
	iters: 2300, epoch: 3 | loss: 0.1430496
	speed: 0.0057s/iter; left time: 2573.0521s
Epoch: 3 cost time: 13.50670599937439
Epoch: 3, Steps: 2302 | Train Loss: 0.1317264 Vali Loss: 0.1144215 Test Loss: 0.1479922
Validation loss decreased (0.114488 --> 0.114422).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1368790
	speed: 0.2898s/iter; left time: 131390.5968s
	iters: 200, epoch: 4 | loss: 0.1216149
	speed: 0.0053s/iter; left time: 2380.0640s
	iters: 300, epoch: 4 | loss: 0.1501518
	speed: 0.0053s/iter; left time: 2384.1937s
	iters: 400, epoch: 4 | loss: 0.1312521
	speed: 0.0053s/iter; left time: 2389.7463s
	iters: 500, epoch: 4 | loss: 0.1594529
	speed: 0.0053s/iter; left time: 2390.8777s
	iters: 600, epoch: 4 | loss: 0.1391315
	speed: 0.0053s/iter; left time: 2390.7387s
	iters: 700, epoch: 4 | loss: 0.1226563
	speed: 0.0053s/iter; left time: 2395.0169s
	iters: 800, epoch: 4 | loss: 0.1281687
	speed: 0.0053s/iter; left time: 2395.7238s
	iters: 900, epoch: 4 | loss: 0.1118842
	speed: 0.0053s/iter; left time: 2395.2583s
	iters: 1000, epoch: 4 | loss: 0.1324508
	speed: 0.0053s/iter; left time: 2400.6054s
	iters: 1100, epoch: 4 | loss: 0.1265778
	speed: 0.0053s/iter; left time: 2396.2826s
	iters: 1200, epoch: 4 | loss: 0.1474945
	speed: 0.0053s/iter; left time: 2408.2931s
	iters: 1300, epoch: 4 | loss: 0.1350339
	speed: 0.0053s/iter; left time: 2398.7325s
	iters: 1400, epoch: 4 | loss: 0.1483284
	speed: 0.0053s/iter; left time: 2400.4214s
	iters: 1500, epoch: 4 | loss: 0.1249666
	speed: 0.0053s/iter; left time: 2399.1188s
	iters: 1600, epoch: 4 | loss: 0.1719339
	speed: 0.0053s/iter; left time: 2397.8985s
	iters: 1700, epoch: 4 | loss: 0.1248573
	speed: 0.0053s/iter; left time: 2397.7007s
	iters: 1800, epoch: 4 | loss: 0.1338438
	speed: 0.0053s/iter; left time: 2396.7780s
	iters: 1900, epoch: 4 | loss: 0.1264251
	speed: 0.0053s/iter; left time: 2406.5513s
	iters: 2000, epoch: 4 | loss: 0.1175706
	speed: 0.0053s/iter; left time: 2397.0053s
	iters: 2100, epoch: 4 | loss: 0.1149528
	speed: 0.0053s/iter; left time: 2397.7303s
	iters: 2200, epoch: 4 | loss: 0.1249028
	speed: 0.0053s/iter; left time: 2395.7336s
	iters: 2300, epoch: 4 | loss: 0.1440107
	speed: 0.0053s/iter; left time: 2369.4497s
Epoch: 4 cost time: 12.518944263458252
Epoch: 4, Steps: 2302 | Train Loss: 0.1316265 Vali Loss: 0.1142560 Test Loss: 0.1479808
Validation loss decreased (0.114422 --> 0.114256).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1364060
	speed: 0.3406s/iter; left time: 153651.4387s
	iters: 200, epoch: 5 | loss: 0.1403006
	speed: 0.0051s/iter; left time: 2318.8381s
	iters: 300, epoch: 5 | loss: 0.1271270
	speed: 0.0051s/iter; left time: 2320.6901s
	iters: 400, epoch: 5 | loss: 0.1174371
	speed: 0.0052s/iter; left time: 2329.0982s
	iters: 500, epoch: 5 | loss: 0.1331097
	speed: 0.0052s/iter; left time: 2330.7413s
	iters: 600, epoch: 5 | loss: 0.1242319
	speed: 0.0052s/iter; left time: 2336.6324s
	iters: 700, epoch: 5 | loss: 0.1181336
	speed: 0.0052s/iter; left time: 2337.0665s
	iters: 800, epoch: 5 | loss: 0.1323402
	speed: 0.0052s/iter; left time: 2342.8671s
	iters: 900, epoch: 5 | loss: 0.1318857
	speed: 0.0052s/iter; left time: 2334.9392s
	iters: 1000, epoch: 5 | loss: 0.1247270
	speed: 0.0052s/iter; left time: 2350.4124s
	iters: 1100, epoch: 5 | loss: 0.1252280
	speed: 0.0052s/iter; left time: 2361.8383s
	iters: 1200, epoch: 5 | loss: 0.1225833
	speed: 0.0053s/iter; left time: 2379.4482s
	iters: 1300, epoch: 5 | loss: 0.1246698
	speed: 0.0052s/iter; left time: 2360.4670s
	iters: 1400, epoch: 5 | loss: 0.1334363
	speed: 0.0053s/iter; left time: 2364.9247s
	iters: 1500, epoch: 5 | loss: 0.1213089
	speed: 0.0053s/iter; left time: 2362.4315s
	iters: 1600, epoch: 5 | loss: 0.1197413
	speed: 0.0053s/iter; left time: 2366.1927s
	iters: 1700, epoch: 5 | loss: 0.1402592
	speed: 0.0053s/iter; left time: 2387.7783s
	iters: 1800, epoch: 5 | loss: 0.1320790
	speed: 0.0053s/iter; left time: 2387.2621s
	iters: 1900, epoch: 5 | loss: 0.1388732
	speed: 0.0053s/iter; left time: 2390.5786s
	iters: 2000, epoch: 5 | loss: 0.1212282
	speed: 0.0053s/iter; left time: 2387.4045s
	iters: 2100, epoch: 5 | loss: 0.1271326
	speed: 0.0053s/iter; left time: 2387.2499s
	iters: 2200, epoch: 5 | loss: 0.1246645
	speed: 0.0053s/iter; left time: 2392.6509s
	iters: 2300, epoch: 5 | loss: 0.1285082
	speed: 0.0053s/iter; left time: 2364.1301s
Epoch: 5 cost time: 12.395941734313965
Epoch: 5, Steps: 2302 | Train Loss: 0.1315855 Vali Loss: 0.1146339 Test Loss: 0.1484977
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.1266539
	speed: 0.2887s/iter; left time: 129558.2144s
	iters: 200, epoch: 6 | loss: 0.1135722
	speed: 0.0055s/iter; left time: 2460.7773s
	iters: 300, epoch: 6 | loss: 0.1225002
	speed: 0.0054s/iter; left time: 2434.2694s
	iters: 400, epoch: 6 | loss: 0.1172393
	speed: 0.0054s/iter; left time: 2436.0118s
	iters: 500, epoch: 6 | loss: 0.1356990
	speed: 0.0055s/iter; left time: 2451.0863s
	iters: 600, epoch: 6 | loss: 0.1229915
	speed: 0.0054s/iter; left time: 2435.9889s
	iters: 700, epoch: 6 | loss: 0.1268351
	speed: 0.0055s/iter; left time: 2450.5466s
	iters: 800, epoch: 6 | loss: 0.1343902
	speed: 0.0055s/iter; left time: 2479.4559s
	iters: 900, epoch: 6 | loss: 0.1358368
	speed: 0.0055s/iter; left time: 2467.8638s
	iters: 1000, epoch: 6 | loss: 0.1227294
	speed: 0.0053s/iter; left time: 2377.3183s
	iters: 1100, epoch: 6 | loss: 0.1219283
	speed: 0.0052s/iter; left time: 2341.4932s
	iters: 1200, epoch: 6 | loss: 0.1323745
	speed: 0.0052s/iter; left time: 2341.8488s
	iters: 1300, epoch: 6 | loss: 0.1218969
	speed: 0.0052s/iter; left time: 2349.1606s
	iters: 1400, epoch: 6 | loss: 0.1236116
	speed: 0.0053s/iter; left time: 2355.0809s
	iters: 1500, epoch: 6 | loss: 0.1281764
	speed: 0.0053s/iter; left time: 2354.2592s
	iters: 1600, epoch: 6 | loss: 0.1437407
	speed: 0.0053s/iter; left time: 2358.6364s
	iters: 1700, epoch: 6 | loss: 0.1694470
	speed: 0.0053s/iter; left time: 2355.3700s
	iters: 1800, epoch: 6 | loss: 0.1229372
	speed: 0.0053s/iter; left time: 2353.9842s
	iters: 1900, epoch: 6 | loss: 0.1256825
	speed: 0.0053s/iter; left time: 2354.1589s
	iters: 2000, epoch: 6 | loss: 0.1460816
	speed: 0.0053s/iter; left time: 2352.0287s
	iters: 2100, epoch: 6 | loss: 0.1278634
	speed: 0.0053s/iter; left time: 2355.2509s
	iters: 2200, epoch: 6 | loss: 0.1274286
	speed: 0.0053s/iter; left time: 2352.2594s
	iters: 2300, epoch: 6 | loss: 0.1443670
	speed: 0.0052s/iter; left time: 2329.2260s
Epoch: 6 cost time: 12.612585306167603
Epoch: 6, Steps: 2302 | Train Loss: 0.1315593 Vali Loss: 0.1141765 Test Loss: 0.1478152
Validation loss decreased (0.114256 --> 0.114177).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.1307323
	speed: 0.2917s/iter; left time: 130233.7403s
	iters: 200, epoch: 7 | loss: 0.1285210
	speed: 0.0052s/iter; left time: 2316.1812s
	iters: 300, epoch: 7 | loss: 0.1373618
	speed: 0.0052s/iter; left time: 2322.1168s
	iters: 400, epoch: 7 | loss: 0.1474560
	speed: 0.0052s/iter; left time: 2327.9218s
	iters: 500, epoch: 7 | loss: 0.1351016
	speed: 0.0052s/iter; left time: 2327.8723s
	iters: 600, epoch: 7 | loss: 0.1250244
	speed: 0.0052s/iter; left time: 2330.6968s
	iters: 700, epoch: 7 | loss: 0.1367729
	speed: 0.0052s/iter; left time: 2335.3748s
	iters: 800, epoch: 7 | loss: 0.1439563
	speed: 0.0052s/iter; left time: 2331.7773s
	iters: 900, epoch: 7 | loss: 0.1256718
	speed: 0.0053s/iter; left time: 2340.5021s
	iters: 1000, epoch: 7 | loss: 0.1484956
	speed: 0.0052s/iter; left time: 2335.6849s
	iters: 1100, epoch: 7 | loss: 0.1387603
	speed: 0.0052s/iter; left time: 2335.7386s
	iters: 1200, epoch: 7 | loss: 0.1388861
	speed: 0.0052s/iter; left time: 2335.7314s
	iters: 1300, epoch: 7 | loss: 0.1300245
	speed: 0.0052s/iter; left time: 2336.5330s
	iters: 1400, epoch: 7 | loss: 0.1285625
	speed: 0.0052s/iter; left time: 2332.8474s
	iters: 1500, epoch: 7 | loss: 0.1325654
	speed: 0.0052s/iter; left time: 2331.8458s
	iters: 1600, epoch: 7 | loss: 0.1197063
	speed: 0.0052s/iter; left time: 2330.1124s
	iters: 1700, epoch: 7 | loss: 0.1263289
	speed: 0.0052s/iter; left time: 2332.0475s
	iters: 1800, epoch: 7 | loss: 0.1212572
	speed: 0.0053s/iter; left time: 2345.6317s
	iters: 1900, epoch: 7 | loss: 0.1309225
	speed: 0.0052s/iter; left time: 2319.6887s
	iters: 2000, epoch: 7 | loss: 0.1319934
	speed: 0.0052s/iter; left time: 2315.6310s
	iters: 2100, epoch: 7 | loss: 0.1258238
	speed: 0.0052s/iter; left time: 2312.8952s
	iters: 2200, epoch: 7 | loss: 0.1353632
	speed: 0.0052s/iter; left time: 2312.9958s
	iters: 2300, epoch: 7 | loss: 0.1227964
	speed: 0.0052s/iter; left time: 2292.8809s
Epoch: 7 cost time: 12.369953155517578
Epoch: 7, Steps: 2302 | Train Loss: 0.1315719 Vali Loss: 0.1141968 Test Loss: 0.1478949
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 8 | loss: 0.1295834
	speed: 0.2935s/iter; left time: 130355.0850s
	iters: 200, epoch: 8 | loss: 0.1247759
	speed: 0.0056s/iter; left time: 2505.9949s
	iters: 300, epoch: 8 | loss: 0.1441907
	speed: 0.0057s/iter; left time: 2523.3973s
	iters: 400, epoch: 8 | loss: 0.1407725
	speed: 0.0057s/iter; left time: 2532.9569s
	iters: 500, epoch: 8 | loss: 0.1192697
	speed: 0.0057s/iter; left time: 2531.2764s
	iters: 600, epoch: 8 | loss: 0.1303856
	speed: 0.0059s/iter; left time: 2596.8512s
	iters: 700, epoch: 8 | loss: 0.1404204
	speed: 0.0057s/iter; left time: 2531.9896s
	iters: 800, epoch: 8 | loss: 0.1478335
	speed: 0.0057s/iter; left time: 2530.5475s
	iters: 900, epoch: 8 | loss: 0.1441194
	speed: 0.0057s/iter; left time: 2533.0933s
	iters: 1000, epoch: 8 | loss: 0.1200172
	speed: 0.0057s/iter; left time: 2534.5776s
	iters: 1100, epoch: 8 | loss: 0.1192973
	speed: 0.0057s/iter; left time: 2532.9778s
	iters: 1200, epoch: 8 | loss: 0.1187122
	speed: 0.0057s/iter; left time: 2531.9668s
	iters: 1300, epoch: 8 | loss: 0.1340869
	speed: 0.0057s/iter; left time: 2531.9245s
	iters: 1400, epoch: 8 | loss: 0.1236120
	speed: 0.0057s/iter; left time: 2533.6781s
	iters: 1500, epoch: 8 | loss: 0.1346913
	speed: 0.0057s/iter; left time: 2532.5306s
	iters: 1600, epoch: 8 | loss: 0.1372818
	speed: 0.0057s/iter; left time: 2537.4354s
	iters: 1700, epoch: 8 | loss: 0.1434274
	speed: 0.0057s/iter; left time: 2532.4250s
	iters: 1800, epoch: 8 | loss: 0.1339338
	speed: 0.0057s/iter; left time: 2533.1125s
	iters: 1900, epoch: 8 | loss: 0.1282397
	speed: 0.0057s/iter; left time: 2531.6308s
	iters: 2000, epoch: 8 | loss: 0.1341138
	speed: 0.0057s/iter; left time: 2530.1707s
	iters: 2100, epoch: 8 | loss: 0.1329320
	speed: 0.0057s/iter; left time: 2535.1092s
	iters: 2200, epoch: 8 | loss: 0.1438835
	speed: 0.0057s/iter; left time: 2531.6911s
	iters: 2300, epoch: 8 | loss: 0.1387040
	speed: 0.0057s/iter; left time: 2510.0618s
Epoch: 8 cost time: 13.452919960021973
Epoch: 8, Steps: 2302 | Train Loss: 0.1315284 Vali Loss: 0.1139353 Test Loss: 0.1477045
Validation loss decreased (0.114177 --> 0.113935).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.1393956
	speed: 0.2895s/iter; left time: 127913.6194s
	iters: 200, epoch: 9 | loss: 0.1187380
	speed: 0.0055s/iter; left time: 2420.2555s
	iters: 300, epoch: 9 | loss: 0.1240936
	speed: 0.0057s/iter; left time: 2504.2335s
	iters: 400, epoch: 9 | loss: 0.1287584
	speed: 0.0057s/iter; left time: 2512.2712s
	iters: 500, epoch: 9 | loss: 0.1433556
	speed: 0.0055s/iter; left time: 2409.8966s
	iters: 600, epoch: 9 | loss: 0.1343617
	speed: 0.0054s/iter; left time: 2405.2445s
	iters: 700, epoch: 9 | loss: 0.1352724
	speed: 0.0054s/iter; left time: 2385.7259s
	iters: 800, epoch: 9 | loss: 0.1225538
	speed: 0.0055s/iter; left time: 2409.7295s
	iters: 900, epoch: 9 | loss: 0.1201760
	speed: 0.0054s/iter; left time: 2382.7012s
	iters: 1000, epoch: 9 | loss: 0.1381419
	speed: 0.0053s/iter; left time: 2353.6221s
	iters: 1100, epoch: 9 | loss: 0.1445091
	speed: 0.0053s/iter; left time: 2320.5394s
	iters: 1200, epoch: 9 | loss: 0.1295694
	speed: 0.0052s/iter; left time: 2309.6269s
	iters: 1300, epoch: 9 | loss: 0.1266338
	speed: 0.0052s/iter; left time: 2306.2693s
	iters: 1400, epoch: 9 | loss: 0.1110553
	speed: 0.0052s/iter; left time: 2308.9960s
	iters: 1500, epoch: 9 | loss: 0.1256345
	speed: 0.0053s/iter; left time: 2317.3566s
	iters: 1600, epoch: 9 | loss: 0.1240119
	speed: 0.0052s/iter; left time: 2307.2790s
	iters: 1700, epoch: 9 | loss: 0.1403797
	speed: 0.0052s/iter; left time: 2303.0737s
	iters: 1800, epoch: 9 | loss: 0.1307489
	speed: 0.0052s/iter; left time: 2307.4108s
	iters: 1900, epoch: 9 | loss: 0.1382195
	speed: 0.0053s/iter; left time: 2325.5631s
	iters: 2000, epoch: 9 | loss: 0.1119372
	speed: 0.0053s/iter; left time: 2323.4570s
	iters: 2100, epoch: 9 | loss: 0.1384633
	speed: 0.0053s/iter; left time: 2319.7029s
	iters: 2200, epoch: 9 | loss: 0.1271088
	speed: 0.0053s/iter; left time: 2329.2289s
	iters: 2300, epoch: 9 | loss: 0.1274503
	speed: 0.0052s/iter; left time: 2301.3493s
Epoch: 9 cost time: 12.657097816467285
Epoch: 9, Steps: 2302 | Train Loss: 0.1315570 Vali Loss: 0.1141386 Test Loss: 0.1478701
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.1409894
	speed: 0.2923s/iter; left time: 128505.2521s
	iters: 200, epoch: 10 | loss: 0.1312462
	speed: 0.0051s/iter; left time: 2248.3490s
	iters: 300, epoch: 10 | loss: 0.1244900
	speed: 0.0051s/iter; left time: 2231.2491s
	iters: 400, epoch: 10 | loss: 0.1122005
	speed: 0.0051s/iter; left time: 2238.5513s
	iters: 500, epoch: 10 | loss: 0.1359235
	speed: 0.0051s/iter; left time: 2231.9183s
	iters: 600, epoch: 10 | loss: 0.1176087
	speed: 0.0051s/iter; left time: 2233.6252s
	iters: 700, epoch: 10 | loss: 0.1206997
	speed: 0.0051s/iter; left time: 2233.1804s
	iters: 800, epoch: 10 | loss: 0.1300691
	speed: 0.0051s/iter; left time: 2232.6539s
	iters: 900, epoch: 10 | loss: 0.1228067
	speed: 0.0051s/iter; left time: 2229.8447s
	iters: 1000, epoch: 10 | loss: 0.1131105
	speed: 0.0051s/iter; left time: 2234.9624s
	iters: 1100, epoch: 10 | loss: 0.1461649
	speed: 0.0051s/iter; left time: 2256.8134s
	iters: 1200, epoch: 10 | loss: 0.1490567
	speed: 0.0051s/iter; left time: 2237.2637s
	iters: 1300, epoch: 10 | loss: 0.1238710
	speed: 0.0052s/iter; left time: 2265.3299s
	iters: 1400, epoch: 10 | loss: 0.1489841
	speed: 0.0052s/iter; left time: 2257.6428s
	iters: 1500, epoch: 10 | loss: 0.1417979
	speed: 0.0052s/iter; left time: 2259.1042s
	iters: 1600, epoch: 10 | loss: 0.1273652
	speed: 0.0052s/iter; left time: 2264.6644s
	iters: 1700, epoch: 10 | loss: 0.1115505
	speed: 0.0052s/iter; left time: 2261.4094s
	iters: 1800, epoch: 10 | loss: 0.1151612
	speed: 0.0052s/iter; left time: 2261.3076s
	iters: 1900, epoch: 10 | loss: 0.1339279
	speed: 0.0051s/iter; left time: 2244.4376s
	iters: 2000, epoch: 10 | loss: 0.1287699
	speed: 0.0052s/iter; left time: 2262.9295s
	iters: 2100, epoch: 10 | loss: 0.1467957
	speed: 0.0052s/iter; left time: 2281.6202s
	iters: 2200, epoch: 10 | loss: 0.1258052
	speed: 0.0052s/iter; left time: 2289.6246s
	iters: 2300, epoch: 10 | loss: 0.1250081
	speed: 0.0052s/iter; left time: 2263.3159s
Epoch: 10 cost time: 12.16112995147705
Epoch: 10, Steps: 2302 | Train Loss: 0.1315594 Vali Loss: 0.1143105 Test Loss: 0.1479836
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 11 | loss: 0.1394358
	speed: 0.2922s/iter; left time: 127754.1824s
	iters: 200, epoch: 11 | loss: 0.1285654
	speed: 0.0056s/iter; left time: 2433.3134s
	iters: 300, epoch: 11 | loss: 0.1210822
	speed: 0.0056s/iter; left time: 2434.6544s
	iters: 400, epoch: 11 | loss: 0.1542616
	speed: 0.0056s/iter; left time: 2434.3078s
	iters: 500, epoch: 11 | loss: 0.1356433
	speed: 0.0056s/iter; left time: 2440.2535s
	iters: 600, epoch: 11 | loss: 0.1326761
	speed: 0.0056s/iter; left time: 2448.3352s
	iters: 700, epoch: 11 | loss: 0.1276802
	speed: 0.0056s/iter; left time: 2446.4732s
	iters: 800, epoch: 11 | loss: 0.1387423
	speed: 0.0056s/iter; left time: 2443.8770s
	iters: 900, epoch: 11 | loss: 0.1262348
	speed: 0.0056s/iter; left time: 2447.0386s
	iters: 1000, epoch: 11 | loss: 0.1282986
	speed: 0.0056s/iter; left time: 2463.0216s
	iters: 1100, epoch: 11 | loss: 0.1253573
	speed: 0.0057s/iter; left time: 2466.7000s
	iters: 1200, epoch: 11 | loss: 0.1490466
	speed: 0.0057s/iter; left time: 2468.4911s
	iters: 1300, epoch: 11 | loss: 0.1362416
	speed: 0.0056s/iter; left time: 2461.6829s
	iters: 1400, epoch: 11 | loss: 0.1331273
	speed: 0.0056s/iter; left time: 2456.9907s
	iters: 1500, epoch: 11 | loss: 0.1424437
	speed: 0.0057s/iter; left time: 2478.8254s
	iters: 1600, epoch: 11 | loss: 0.1288363
	speed: 0.0057s/iter; left time: 2467.6643s
	iters: 1700, epoch: 11 | loss: 0.1224604
	speed: 0.0057s/iter; left time: 2464.4472s
	iters: 1800, epoch: 11 | loss: 0.1275636
	speed: 0.0057s/iter; left time: 2464.4548s
	iters: 1900, epoch: 11 | loss: 0.1354289
	speed: 0.0057s/iter; left time: 2464.3074s
	iters: 2000, epoch: 11 | loss: 0.1177356
	speed: 0.0057s/iter; left time: 2463.9502s
	iters: 2100, epoch: 11 | loss: 0.1152904
	speed: 0.0057s/iter; left time: 2465.6622s
	iters: 2200, epoch: 11 | loss: 0.1264370
	speed: 0.0057s/iter; left time: 2464.1702s
	iters: 2300, epoch: 11 | loss: 0.1232768
	speed: 0.0056s/iter; left time: 2441.2094s
Epoch: 11 cost time: 13.284275770187378
Epoch: 11, Steps: 2302 | Train Loss: 0.1315503 Vali Loss: 0.1144162 Test Loss: 0.1482491
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 0.1347756
	speed: 0.2912s/iter; left time: 126644.2707s
	iters: 200, epoch: 12 | loss: 0.1218005
	speed: 0.0053s/iter; left time: 2294.8241s
	iters: 300, epoch: 12 | loss: 0.1222498
	speed: 0.0057s/iter; left time: 2467.9186s
	iters: 400, epoch: 12 | loss: 0.1140453
	speed: 0.0057s/iter; left time: 2470.0259s
	iters: 500, epoch: 12 | loss: 0.1145451
	speed: 0.0054s/iter; left time: 2366.4562s
	iters: 600, epoch: 12 | loss: 0.1312626
	speed: 0.0055s/iter; left time: 2384.5616s
	iters: 700, epoch: 12 | loss: 0.1275018
	speed: 0.0053s/iter; left time: 2282.0478s
	iters: 800, epoch: 12 | loss: 0.1168178
	speed: 0.0052s/iter; left time: 2264.2799s
	iters: 900, epoch: 12 | loss: 0.1318552
	speed: 0.0052s/iter; left time: 2259.8466s
	iters: 1000, epoch: 12 | loss: 0.1248206
	speed: 0.0052s/iter; left time: 2266.2021s
	iters: 1100, epoch: 12 | loss: 0.1372184
	speed: 0.0052s/iter; left time: 2265.6252s
	iters: 1200, epoch: 12 | loss: 0.1243844
	speed: 0.0052s/iter; left time: 2263.5970s
	iters: 1300, epoch: 12 | loss: 0.1224224
	speed: 0.0052s/iter; left time: 2260.5508s
	iters: 1400, epoch: 12 | loss: 0.1381922
	speed: 0.0052s/iter; left time: 2258.8675s
	iters: 1500, epoch: 12 | loss: 0.1291602
	speed: 0.0052s/iter; left time: 2254.6717s
	iters: 1600, epoch: 12 | loss: 0.1297661
	speed: 0.0052s/iter; left time: 2249.0101s
	iters: 1700, epoch: 12 | loss: 0.1205511
	speed: 0.0052s/iter; left time: 2245.6487s
	iters: 1800, epoch: 12 | loss: 0.1521728
	speed: 0.0052s/iter; left time: 2253.0135s
	iters: 1900, epoch: 12 | loss: 0.1355353
	speed: 0.0052s/iter; left time: 2242.2969s
	iters: 2000, epoch: 12 | loss: 0.1315207
	speed: 0.0052s/iter; left time: 2241.1505s
	iters: 2100, epoch: 12 | loss: 0.1374785
	speed: 0.0052s/iter; left time: 2249.4426s
	iters: 2200, epoch: 12 | loss: 0.1360158
	speed: 0.0052s/iter; left time: 2238.8491s
	iters: 2300, epoch: 12 | loss: 0.1283543
	speed: 0.0051s/iter; left time: 2220.7847s
Epoch: 12 cost time: 12.530027389526367
Epoch: 12, Steps: 2302 | Train Loss: 0.1315334 Vali Loss: 0.1142678 Test Loss: 0.1479714
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 13 | loss: 0.1232805
	speed: 0.2910s/iter; left time: 125926.1309s
	iters: 200, epoch: 13 | loss: 0.1286362
	speed: 0.0052s/iter; left time: 2251.2299s
	iters: 300, epoch: 13 | loss: 0.1214778
	speed: 0.0052s/iter; left time: 2253.1769s
	iters: 400, epoch: 13 | loss: 0.1230108
	speed: 0.0052s/iter; left time: 2254.6166s
	iters: 500, epoch: 13 | loss: 0.1241773
	speed: 0.0052s/iter; left time: 2254.3972s
	iters: 600, epoch: 13 | loss: 0.1245940
	speed: 0.0052s/iter; left time: 2236.1004s
	iters: 700, epoch: 13 | loss: 0.1402733
	speed: 0.0052s/iter; left time: 2246.1163s
	iters: 800, epoch: 13 | loss: 0.1105090
	speed: 0.0052s/iter; left time: 2249.0621s
	iters: 900, epoch: 13 | loss: 0.1248362
	speed: 0.0052s/iter; left time: 2242.4757s
	iters: 1000, epoch: 13 | loss: 0.1353433
	speed: 0.0052s/iter; left time: 2257.9024s
	iters: 1100, epoch: 13 | loss: 0.1376424
	speed: 0.0052s/iter; left time: 2250.0711s
	iters: 1200, epoch: 13 | loss: 0.1326042
	speed: 0.0052s/iter; left time: 2243.3627s
	iters: 1300, epoch: 13 | loss: 0.1320940
	speed: 0.0052s/iter; left time: 2244.1443s
	iters: 1400, epoch: 13 | loss: 0.1326052
	speed: 0.0052s/iter; left time: 2244.5097s
	iters: 1500, epoch: 13 | loss: 0.1354054
	speed: 0.0052s/iter; left time: 2238.7751s
	iters: 1600, epoch: 13 | loss: 0.1154654
	speed: 0.0052s/iter; left time: 2247.0691s
	iters: 1700, epoch: 13 | loss: 0.1208000
	speed: 0.0052s/iter; left time: 2239.3002s
	iters: 1800, epoch: 13 | loss: 0.1483581
	speed: 0.0052s/iter; left time: 2235.7937s
	iters: 1900, epoch: 13 | loss: 0.1287101
	speed: 0.0052s/iter; left time: 2241.2291s
	iters: 2000, epoch: 13 | loss: 0.1217959
	speed: 0.0052s/iter; left time: 2239.4077s
	iters: 2100, epoch: 13 | loss: 0.1436223
	speed: 0.0052s/iter; left time: 2231.7217s
	iters: 2200, epoch: 13 | loss: 0.1190256
	speed: 0.0052s/iter; left time: 2237.0016s
	iters: 2300, epoch: 13 | loss: 0.1300249
	speed: 0.0051s/iter; left time: 2216.1000s
Epoch: 13 cost time: 12.297556161880493
Epoch: 13, Steps: 2302 | Train Loss: 0.1315318 Vali Loss: 0.1145366 Test Loss: 0.1480702
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_h_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 21010
test shape: (21010, 1, 96, 103) (21010, 1, 96, 103)
test shape: (21010, 96, 103) (21010, 96, 103)
mse:0.14770495891571045, mae:0.23595558106899261
>>>>>>>Overall time: 753 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
