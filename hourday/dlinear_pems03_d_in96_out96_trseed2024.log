Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems03_d.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems03_d_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems03_d.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems03_d_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_d_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
>>>>>>>start training : long_term_forecast_pems03_d_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5383
train 5383
val 703
val 703
test 1497
test 1497
	iters: 100, epoch: 1 | loss: 0.5067340
	speed: 0.0103s/iter; left time: 344.7659s
	iters: 100, epoch: 1 | loss: 0.5067340
	speed: 0.0107s/iter; left time: 359.9650s
Epoch: 1 cost time: 1.4962637424468994
Epoch: 1 cost time: 1.5760982036590576
Epoch: 1, Steps: 168 | Train Loss: 0.5709274 Vali Loss: 0.4444430 Test Loss: 0.6079504
Validation loss decreased (inf --> 0.444443).  Saving model ...
Epoch: 1, Steps: 168 | Train Loss: 0.5709274 Vali Loss: 0.4444430 Test Loss: 0.6079504
Validation loss decreased (inf --> 0.444443).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.5381505
	speed: 0.0402s/iter; left time: 1338.4047s
	iters: 100, epoch: 2 | loss: 0.5381505
	speed: 0.0423s/iter; left time: 1410.2732s
Epoch: 2 cost time: 1.3567924499511719
Epoch: 2 cost time: 1.4836645126342773
Epoch: 2, Steps: 168 | Train Loss: 0.5350607 Vali Loss: 0.4396448 Test Loss: 0.6028200
Validation loss decreased (0.444443 --> 0.439645).  Saving model ...
Epoch: 2, Steps: 168 | Train Loss: 0.5350607 Vali Loss: 0.4396448 Test Loss: 0.6028200
Validation loss decreased (0.444443 --> 0.439645).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.4797693
	speed: 0.0397s/iter; left time: 1317.3989s
Epoch: 3 cost time: 1.3422160148620605
	iters: 100, epoch: 3 | loss: 0.4797693
	speed: 0.0426s/iter; left time: 1412.8660s
Epoch: 3 cost time: 1.4731476306915283
Epoch: 3, Steps: 168 | Train Loss: 0.5329858 Vali Loss: 0.4404101 Test Loss: 0.6025121
EarlyStopping counter: 1 out of 5
Epoch: 3, Steps: 168 | Train Loss: 0.5329858 Vali Loss: 0.4404101 Test Loss: 0.6025121
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.4875010
	speed: 0.0401s/iter; left time: 1321.7717s
Epoch: 4 cost time: 1.348073959350586
	iters: 100, epoch: 4 | loss: 0.4875010
	speed: 0.0422s/iter; left time: 1391.3976s
Epoch: 4 cost time: 1.5341808795928955
Epoch: 4, Steps: 168 | Train Loss: 0.5328414 Vali Loss: 0.4411712 Test Loss: 0.6015794
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.5226597
	speed: 0.0394s/iter; left time: 1294.5381s
Epoch: 5 cost time: 1.3544514179229736
Epoch: 4, Steps: 168 | Train Loss: 0.5328414 Vali Loss: 0.4411712 Test Loss: 0.6015794
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.5226597
	speed: 0.0454s/iter; left time: 1491.5807s
Epoch: 5 cost time: 1.4195353984832764
Epoch: 5, Steps: 168 | Train Loss: 0.5327292 Vali Loss: 0.4391298 Test Loss: 0.6025696
Validation loss decreased (0.439645 --> 0.439130).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5214004
	speed: 0.0397s/iter; left time: 1296.7190s
Epoch: 6 cost time: 1.3468801975250244
Epoch: 5, Steps: 168 | Train Loss: 0.5327292 Vali Loss: 0.4391298 Test Loss: 0.6025696
Validation loss decreased (0.439645 --> 0.439130).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.5214004
	speed: 0.0417s/iter; left time: 1361.2814s
Epoch: 6 cost time: 1.4017548561096191
Epoch: 6, Steps: 168 | Train Loss: 0.5326004 Vali Loss: 0.4398288 Test Loss: 0.6020215
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.5014009
	speed: 0.0401s/iter; left time: 1302.2501s
Epoch: 7 cost time: 1.387760877609253
Epoch: 6, Steps: 168 | Train Loss: 0.5326004 Vali Loss: 0.4398288 Test Loss: 0.6020215
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.5014009
	speed: 0.0420s/iter; left time: 1366.0816s
Epoch: 7 cost time: 1.432875156402588
Epoch: 7, Steps: 168 | Train Loss: 0.5326804 Vali Loss: 0.4403008 Test Loss: 0.6018167
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 8 | loss: 0.4727718
	speed: 0.0401s/iter; left time: 1297.6373s
Epoch: 8 cost time: 1.3638722896575928
Epoch: 7, Steps: 168 | Train Loss: 0.5326804 Vali Loss: 0.4403008 Test Loss: 0.6018167
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 8 | loss: 0.4727718
	speed: 0.0426s/iter; left time: 1378.3910s
Epoch: 8 cost time: 1.4397766590118408
Epoch: 8, Steps: 168 | Train Loss: 0.5326289 Vali Loss: 0.4372898 Test Loss: 0.6017851
Validation loss decreased (0.439130 --> 0.437290).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5481271
	speed: 0.0406s/iter; left time: 1306.3966s
Epoch: 9 cost time: 1.4197289943695068
Epoch: 8, Steps: 168 | Train Loss: 0.5326289 Vali Loss: 0.4372898 Test Loss: 0.6017851
Validation loss decreased (0.439130 --> 0.437290).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.5481271
	speed: 0.0418s/iter; left time: 1342.8426s
Epoch: 9 cost time: 1.3935225009918213
Epoch: 9, Steps: 168 | Train Loss: 0.5326937 Vali Loss: 0.4387205 Test Loss: 0.6015815
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.5019528
	speed: 0.0402s/iter; left time: 1284.7804s
Epoch: 10 cost time: 1.3388469219207764
Epoch: 9, Steps: 168 | Train Loss: 0.5326937 Vali Loss: 0.4387205 Test Loss: 0.6015815
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.5019528
	speed: 0.0414s/iter; left time: 1325.1200s
Epoch: 10 cost time: 1.3919768333435059
Epoch: 10, Steps: 168 | Train Loss: 0.5327111 Vali Loss: 0.4397389 Test Loss: 0.6019565
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 11 | loss: 0.5349141
	speed: 0.0398s/iter; left time: 1266.8815s
Epoch: 11 cost time: 1.3815114498138428
Epoch: 10, Steps: 168 | Train Loss: 0.5327111 Vali Loss: 0.4397389 Test Loss: 0.6019565
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 11 | loss: 0.5349141
	speed: 0.0417s/iter; left time: 1325.4213s
Epoch: 11 cost time: 1.4338929653167725
Epoch: 11, Steps: 168 | Train Loss: 0.5326550 Vali Loss: 0.4393817 Test Loss: 0.6018142
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 0.5249594
	speed: 0.0396s/iter; left time: 1253.1198s
Epoch: 12 cost time: 1.3537254333496094
Epoch: 11, Steps: 168 | Train Loss: 0.5326550 Vali Loss: 0.4393817 Test Loss: 0.6018142
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 0.5249594
	speed: 0.0420s/iter; left time: 1328.8753s
Epoch: 12, Steps: 168 | Train Loss: 0.5327767 Vali Loss: 0.4400847 Test Loss: 0.6020669
EarlyStopping counter: 4 out of 5
Epoch: 12 cost time: 1.433678150177002
	iters: 100, epoch: 13 | loss: 0.5604910
	speed: 0.0397s/iter; left time: 1250.6661s
Epoch: 13 cost time: 1.3352904319763184
Epoch: 12, Steps: 168 | Train Loss: 0.5327767 Vali Loss: 0.4400847 Test Loss: 0.6020669
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 13 | loss: 0.5604910
	speed: 0.0423s/iter; left time: 1331.6545s
Epoch: 13, Steps: 168 | Train Loss: 0.5327876 Vali Loss: 0.4401707 Test Loss: 0.6023114
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_d_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1497
Epoch: 13 cost time: 1.4191310405731201
Epoch: 13, Steps: 168 | Train Loss: 0.5327876 Vali Loss: 0.4401707 Test Loss: 0.6023114
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_d_96_96_DLinear_custom_ftM_sl96_ll48_pl96_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1497
test shape: (1497, 1, 96, 151) (1497, 1, 96, 151)
test shape: (1497, 96, 151) (1497, 96, 151)
mse:0.6017850637435913, mae:0.42619630694389343
>>>>>>>Overall time: 70 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test shape: (1497, 1, 96, 151) (1497, 1, 96, 151)
test shape: (1497, 96, 151) (1497, 96, 151)
mse:0.6017850637435913, mae:0.42619630694389343
>>>>>>>Overall time: 73 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
