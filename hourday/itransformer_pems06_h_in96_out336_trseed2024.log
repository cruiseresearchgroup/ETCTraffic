Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=130, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems06_h.csv', dec_in=130, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=130, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems06_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems06_h_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 87281
val 12197
test 24725
	iters: 100, epoch: 1 | loss: 0.2527664
	speed: 0.0379s/iter; left time: 2065.4947s
	iters: 200, epoch: 1 | loss: 0.1668440
	speed: 0.0304s/iter; left time: 1654.3135s
	iters: 300, epoch: 1 | loss: 0.1287896
	speed: 0.0304s/iter; left time: 1647.0485s
	iters: 400, epoch: 1 | loss: 0.1844058
	speed: 0.0305s/iter; left time: 1653.5018s
	iters: 500, epoch: 1 | loss: 0.1511797
	speed: 0.0307s/iter; left time: 1656.9289s
	iters: 600, epoch: 1 | loss: 0.1773933
	speed: 0.0304s/iter; left time: 1638.8003s
	iters: 700, epoch: 1 | loss: 0.1564900
	speed: 0.0306s/iter; left time: 1647.1159s
	iters: 800, epoch: 1 | loss: 0.1313220
	speed: 0.0303s/iter; left time: 1626.7984s
	iters: 900, epoch: 1 | loss: 0.2080159
	speed: 0.0304s/iter; left time: 1629.8846s
	iters: 1000, epoch: 1 | loss: 0.1056190
	speed: 0.0304s/iter; left time: 1627.9942s
	iters: 1100, epoch: 1 | loss: 0.1598364
	speed: 0.0304s/iter; left time: 1623.5601s
	iters: 1200, epoch: 1 | loss: 0.2018178
	speed: 0.0304s/iter; left time: 1620.6778s
	iters: 1300, epoch: 1 | loss: 0.1587299
	speed: 0.0304s/iter; left time: 1617.7863s
	iters: 1400, epoch: 1 | loss: 0.1608780
	speed: 0.0304s/iter; left time: 1613.5942s
	iters: 1500, epoch: 1 | loss: 0.2286550
	speed: 0.0304s/iter; left time: 1612.2648s
	iters: 1600, epoch: 1 | loss: 0.1167917
	speed: 0.0304s/iter; left time: 1609.5774s
	iters: 1700, epoch: 1 | loss: 0.1289437
	speed: 0.0304s/iter; left time: 1606.0837s
	iters: 1800, epoch: 1 | loss: 0.2384969
	speed: 0.0304s/iter; left time: 1602.4361s
	iters: 1900, epoch: 1 | loss: 0.2043191
	speed: 0.0305s/iter; left time: 1604.1945s
	iters: 2000, epoch: 1 | loss: 0.6571970
	speed: 0.0304s/iter; left time: 1595.8539s
	iters: 2100, epoch: 1 | loss: 0.5049135
	speed: 0.0301s/iter; left time: 1578.1256s
	iters: 2200, epoch: 1 | loss: 0.2653082
	speed: 0.0305s/iter; left time: 1596.5538s
	iters: 2300, epoch: 1 | loss: 0.3446661
	speed: 0.0305s/iter; left time: 1593.7531s
	iters: 2400, epoch: 1 | loss: 0.2943467
	speed: 0.0305s/iter; left time: 1588.7403s
	iters: 2500, epoch: 1 | loss: 0.3075075
	speed: 0.0304s/iter; left time: 1579.7685s
	iters: 2600, epoch: 1 | loss: 0.2274793
	speed: 0.0305s/iter; left time: 1584.0969s
	iters: 2700, epoch: 1 | loss: 0.2800831
	speed: 0.0304s/iter; left time: 1575.9062s
	iters: 2800, epoch: 1 | loss: 0.2906521
	speed: 0.0304s/iter; left time: 1574.3723s
	iters: 2900, epoch: 1 | loss: 0.3090184
	speed: 0.0304s/iter; left time: 1569.4635s
	iters: 3000, epoch: 1 | loss: 0.2553512
	speed: 0.0304s/iter; left time: 1565.6996s
	iters: 3100, epoch: 1 | loss: 0.2644331
	speed: 0.0304s/iter; left time: 1563.7795s
	iters: 3200, epoch: 1 | loss: 0.3739936
	speed: 0.0304s/iter; left time: 1561.8176s
	iters: 3300, epoch: 1 | loss: 0.2817568
	speed: 0.0302s/iter; left time: 1547.7454s
	iters: 3400, epoch: 1 | loss: 0.2915336
	speed: 0.0299s/iter; left time: 1529.3695s
	iters: 3500, epoch: 1 | loss: 0.2259794
	speed: 0.0305s/iter; left time: 1556.0060s
	iters: 3600, epoch: 1 | loss: 0.2912973
	speed: 0.0305s/iter; left time: 1553.9988s
	iters: 3700, epoch: 1 | loss: 0.2801823
	speed: 0.0304s/iter; left time: 1546.7315s
	iters: 3800, epoch: 1 | loss: 0.6929434
	speed: 0.0304s/iter; left time: 1542.3795s
	iters: 3900, epoch: 1 | loss: 0.4750290
	speed: 0.0304s/iter; left time: 1540.0977s
	iters: 4000, epoch: 1 | loss: 0.4877192
	speed: 0.0305s/iter; left time: 1539.6493s
	iters: 4100, epoch: 1 | loss: 0.5284264
	speed: 0.0306s/iter; left time: 1543.1975s
	iters: 4200, epoch: 1 | loss: 0.4105335
	speed: 0.0304s/iter; left time: 1528.7230s
	iters: 4300, epoch: 1 | loss: 0.3578223
	speed: 0.0305s/iter; left time: 1532.4979s
	iters: 4400, epoch: 1 | loss: 0.3541459
	speed: 0.0304s/iter; left time: 1523.0109s
	iters: 4500, epoch: 1 | loss: 0.3533067
	speed: 0.0306s/iter; left time: 1529.6282s
	iters: 4600, epoch: 1 | loss: 0.3074415
	speed: 0.0304s/iter; left time: 1516.1831s
	iters: 4700, epoch: 1 | loss: 0.2779320
	speed: 0.0304s/iter; left time: 1515.7441s
	iters: 4800, epoch: 1 | loss: 0.3013859
	speed: 0.0304s/iter; left time: 1510.8299s
	iters: 4900, epoch: 1 | loss: 0.2742750
	speed: 0.0306s/iter; left time: 1518.4577s
	iters: 5000, epoch: 1 | loss: 0.3140994
	speed: 0.0304s/iter; left time: 1506.3923s
	iters: 5100, epoch: 1 | loss: 0.3300718
	speed: 0.0304s/iter; left time: 1502.3405s
	iters: 5200, epoch: 1 | loss: 0.2748460
	speed: 0.0304s/iter; left time: 1498.9813s
	iters: 5300, epoch: 1 | loss: 0.2872539
	speed: 0.0305s/iter; left time: 1500.3918s
	iters: 5400, epoch: 1 | loss: 0.2372530
	speed: 0.0304s/iter; left time: 1492.6230s
Epoch: 1 cost time: 166.73624324798584
Epoch: 1, Steps: 5455 | Train Loss: 0.2891722 Vali Loss: 0.1939078 Test Loss: 0.2786887
Validation loss decreased (inf --> 0.193908).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.2813385
	speed: 1.2331s/iter; left time: 60415.9909s
	iters: 200, epoch: 2 | loss: 0.3472576
	speed: 0.0305s/iter; left time: 1493.6577s
	iters: 300, epoch: 2 | loss: 0.2232531
	speed: 0.0305s/iter; left time: 1489.3782s
	iters: 400, epoch: 2 | loss: 0.2567635
	speed: 0.0306s/iter; left time: 1490.3005s
	iters: 500, epoch: 2 | loss: 0.2358529
	speed: 0.0305s/iter; left time: 1482.9675s
	iters: 600, epoch: 2 | loss: 0.3224290
	speed: 0.0305s/iter; left time: 1480.0289s
	iters: 700, epoch: 2 | loss: 0.2167197
	speed: 0.0305s/iter; left time: 1476.1210s
	iters: 800, epoch: 2 | loss: 0.3222139
	speed: 0.0309s/iter; left time: 1491.2837s
	iters: 900, epoch: 2 | loss: 0.3027778
	speed: 0.0304s/iter; left time: 1465.7629s
	iters: 1000, epoch: 2 | loss: 0.2319843
	speed: 0.0304s/iter; left time: 1464.1010s
	iters: 1100, epoch: 2 | loss: 0.2527754
	speed: 0.0305s/iter; left time: 1463.3404s
	iters: 1200, epoch: 2 | loss: 0.3691642
	speed: 0.0305s/iter; left time: 1459.1184s
	iters: 1300, epoch: 2 | loss: 0.3464610
	speed: 0.0303s/iter; left time: 1449.2996s
	iters: 1400, epoch: 2 | loss: 0.3199453
	speed: 0.0304s/iter; left time: 1450.2206s
	iters: 1500, epoch: 2 | loss: 0.3187521
	speed: 0.0304s/iter; left time: 1448.1608s
	iters: 1600, epoch: 2 | loss: 0.3115096
	speed: 0.0309s/iter; left time: 1465.5114s
	iters: 1700, epoch: 2 | loss: 0.2738115
	speed: 0.0302s/iter; left time: 1429.3818s
	iters: 1800, epoch: 2 | loss: 0.2873880
	speed: 0.0305s/iter; left time: 1440.8195s
	iters: 1900, epoch: 2 | loss: 0.2804061
	speed: 0.0305s/iter; left time: 1439.8902s
	iters: 2000, epoch: 2 | loss: 0.2518743
	speed: 0.0301s/iter; left time: 1416.9671s
	iters: 2100, epoch: 2 | loss: 0.3438008
	speed: 0.0301s/iter; left time: 1413.8505s
	iters: 2200, epoch: 2 | loss: 0.3622649
	speed: 0.0303s/iter; left time: 1419.6751s
	iters: 2300, epoch: 2 | loss: 0.3262444
	speed: 0.0305s/iter; left time: 1428.6224s
	iters: 2400, epoch: 2 | loss: 0.2422048
	speed: 0.0303s/iter; left time: 1415.1775s
	iters: 2500, epoch: 2 | loss: 0.2549072
	speed: 0.0303s/iter; left time: 1411.8570s
	iters: 2600, epoch: 2 | loss: 0.4430569
	speed: 0.0304s/iter; left time: 1414.2415s
	iters: 2700, epoch: 2 | loss: 0.3183689
	speed: 0.0302s/iter; left time: 1401.1081s
	iters: 2800, epoch: 2 | loss: 0.3375865
	speed: 0.0304s/iter; left time: 1407.9203s
	iters: 2900, epoch: 2 | loss: 0.3691468
	speed: 0.0307s/iter; left time: 1417.5607s
	iters: 3000, epoch: 2 | loss: 0.2269743
	speed: 0.0304s/iter; left time: 1401.0010s
	iters: 3100, epoch: 2 | loss: 0.3031148
	speed: 0.0302s/iter; left time: 1389.2200s
	iters: 3200, epoch: 2 | loss: 0.2230305
	speed: 0.0304s/iter; left time: 1397.4081s
	iters: 3300, epoch: 2 | loss: 0.3303203
	speed: 0.0304s/iter; left time: 1392.9781s
	iters: 3400, epoch: 2 | loss: 0.2281960
	speed: 0.0305s/iter; left time: 1395.8888s
	iters: 3500, epoch: 2 | loss: 0.2875268
	speed: 0.0305s/iter; left time: 1389.4233s
	iters: 3600, epoch: 2 | loss: 0.2635835
	speed: 0.0304s/iter; left time: 1383.0917s
	iters: 3700, epoch: 2 | loss: 0.2586296
	speed: 0.0304s/iter; left time: 1379.9949s
	iters: 3800, epoch: 2 | loss: 0.2551900
	speed: 0.0305s/iter; left time: 1383.5573s
	iters: 3900, epoch: 2 | loss: 0.3055971
	speed: 0.0307s/iter; left time: 1387.0785s
	iters: 4000, epoch: 2 | loss: 0.2897648
	speed: 0.0304s/iter; left time: 1370.0944s
	iters: 4100, epoch: 2 | loss: 0.2113475
	speed: 0.0304s/iter; left time: 1369.2691s
	iters: 4200, epoch: 2 | loss: 0.2401228
	speed: 0.0306s/iter; left time: 1372.0836s
	iters: 4300, epoch: 2 | loss: 0.2425415
	speed: 0.0304s/iter; left time: 1362.3200s
	iters: 4400, epoch: 2 | loss: 0.3500991
	speed: 0.0304s/iter; left time: 1359.8629s
	iters: 4500, epoch: 2 | loss: 0.2400899
	speed: 0.0305s/iter; left time: 1358.8967s
	iters: 4600, epoch: 2 | loss: 0.3021603
	speed: 0.0304s/iter; left time: 1353.7844s
	iters: 4700, epoch: 2 | loss: 0.2720859
	speed: 0.0305s/iter; left time: 1354.3618s
	iters: 4800, epoch: 2 | loss: 0.2191953
	speed: 0.0303s/iter; left time: 1340.7993s
	iters: 4900, epoch: 2 | loss: 0.3054386
	speed: 0.0306s/iter; left time: 1353.6484s
	iters: 5000, epoch: 2 | loss: 0.2607796
	speed: 0.0304s/iter; left time: 1341.2820s
	iters: 5100, epoch: 2 | loss: 0.2954145
	speed: 0.0311s/iter; left time: 1368.4440s
	iters: 5200, epoch: 2 | loss: 0.2630807
	speed: 0.0306s/iter; left time: 1343.5816s
	iters: 5300, epoch: 2 | loss: 0.2212720
	speed: 0.0305s/iter; left time: 1337.1390s
	iters: 5400, epoch: 2 | loss: 0.2858838
	speed: 0.0309s/iter; left time: 1349.2741s
Epoch: 2 cost time: 166.90958094596863
Epoch: 2, Steps: 5455 | Train Loss: 0.2811720 Vali Loss: 0.1888619 Test Loss: 0.2691724
Validation loss decreased (0.193908 --> 0.188862).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.2861009
	speed: 1.2530s/iter; left time: 54555.6102s
	iters: 200, epoch: 3 | loss: 0.2338886
	speed: 0.0305s/iter; left time: 1325.7246s
	iters: 300, epoch: 3 | loss: 0.2638300
	speed: 0.0303s/iter; left time: 1314.8013s
	iters: 400, epoch: 3 | loss: 0.2450593
	speed: 0.0304s/iter; left time: 1314.7575s
	iters: 500, epoch: 3 | loss: 0.2741638
	speed: 0.0305s/iter; left time: 1316.2467s
	iters: 600, epoch: 3 | loss: 0.3053785
	speed: 0.0320s/iter; left time: 1377.4929s
	iters: 700, epoch: 3 | loss: 0.2652120
	speed: 0.0304s/iter; left time: 1304.0802s
	iters: 800, epoch: 3 | loss: 0.2878365
	speed: 0.0310s/iter; left time: 1328.7431s
	iters: 900, epoch: 3 | loss: 0.3401323
	speed: 0.0340s/iter; left time: 1454.6667s
	iters: 1000, epoch: 3 | loss: 0.3334053
	speed: 0.0304s/iter; left time: 1296.1237s
	iters: 1100, epoch: 3 | loss: 0.2557561
	speed: 0.0304s/iter; left time: 1292.6998s
	iters: 1200, epoch: 3 | loss: 0.2006639
	speed: 0.0303s/iter; left time: 1285.6777s
	iters: 1300, epoch: 3 | loss: 0.2540385
	speed: 0.0304s/iter; left time: 1287.6286s
	iters: 1400, epoch: 3 | loss: 0.3084732
	speed: 0.0304s/iter; left time: 1283.1422s
	iters: 1500, epoch: 3 | loss: 0.3067526
	speed: 0.0304s/iter; left time: 1280.4329s
	iters: 1600, epoch: 3 | loss: 0.2704656
	speed: 0.0303s/iter; left time: 1273.8750s
	iters: 1700, epoch: 3 | loss: 0.2344548
	speed: 0.0302s/iter; left time: 1267.3070s
	iters: 1800, epoch: 3 | loss: 0.3058988
	speed: 0.0303s/iter; left time: 1267.9272s
	iters: 1900, epoch: 3 | loss: 0.2286062
	speed: 0.0303s/iter; left time: 1265.7822s
	iters: 2000, epoch: 3 | loss: 0.2478995
	speed: 0.0304s/iter; left time: 1266.9323s
	iters: 2100, epoch: 3 | loss: 0.2331625
	speed: 0.0304s/iter; left time: 1262.3099s
	iters: 2200, epoch: 3 | loss: 0.2346693
	speed: 0.0303s/iter; left time: 1255.5158s
	iters: 2300, epoch: 3 | loss: 0.3900474
	speed: 0.0304s/iter; left time: 1256.3219s
	iters: 2400, epoch: 3 | loss: 0.2649837
	speed: 0.0304s/iter; left time: 1253.6850s
	iters: 2500, epoch: 3 | loss: 0.2997070
	speed: 0.0303s/iter; left time: 1247.1602s
	iters: 2600, epoch: 3 | loss: 0.2692925
	speed: 0.0303s/iter; left time: 1243.7092s
	iters: 2700, epoch: 3 | loss: 0.2992545
	speed: 0.0305s/iter; left time: 1247.0745s
	iters: 2800, epoch: 3 | loss: 0.2259699
	speed: 0.0304s/iter; left time: 1242.1191s
	iters: 2900, epoch: 3 | loss: 0.2057255
	speed: 0.0304s/iter; left time: 1239.0423s
	iters: 3000, epoch: 3 | loss: 0.3682359
	speed: 0.0304s/iter; left time: 1233.4808s
	iters: 3100, epoch: 3 | loss: 0.3048368
	speed: 0.0304s/iter; left time: 1231.6928s
	iters: 3200, epoch: 3 | loss: 0.3204844
	speed: 0.0304s/iter; left time: 1228.7596s
	iters: 3300, epoch: 3 | loss: 0.2816744
	speed: 0.0304s/iter; left time: 1224.8863s
	iters: 3400, epoch: 3 | loss: 0.2525680
	speed: 0.0305s/iter; left time: 1226.7529s
	iters: 3500, epoch: 3 | loss: 0.2204334
	speed: 0.0304s/iter; left time: 1219.5099s
	iters: 3600, epoch: 3 | loss: 0.2147076
	speed: 0.0304s/iter; left time: 1217.2255s
	iters: 3700, epoch: 3 | loss: 0.3125027
	speed: 0.0304s/iter; left time: 1213.7339s
	iters: 3800, epoch: 3 | loss: 0.2695491
	speed: 0.0304s/iter; left time: 1210.6833s
	iters: 3900, epoch: 3 | loss: 0.3224200
	speed: 0.0304s/iter; left time: 1208.1211s
	iters: 4000, epoch: 3 | loss: 0.2536737
	speed: 0.0304s/iter; left time: 1204.7880s
	iters: 4100, epoch: 3 | loss: 0.2284047
	speed: 0.0305s/iter; left time: 1204.6961s
	iters: 4200, epoch: 3 | loss: 0.2276626
	speed: 0.0302s/iter; left time: 1191.0827s
	iters: 4300, epoch: 3 | loss: 0.2564425
	speed: 0.0304s/iter; left time: 1194.5934s
	iters: 4400, epoch: 3 | loss: 0.2520191
	speed: 0.0304s/iter; left time: 1191.1580s
	iters: 4500, epoch: 3 | loss: 0.2559668
	speed: 0.0302s/iter; left time: 1180.6234s
	iters: 4600, epoch: 3 | loss: 0.2705608
	speed: 0.0303s/iter; left time: 1182.2268s
	iters: 4700, epoch: 3 | loss: 0.2360002
	speed: 0.0305s/iter; left time: 1185.7595s
	iters: 4800, epoch: 3 | loss: 0.2329928
	speed: 0.0304s/iter; left time: 1179.0686s
	iters: 4900, epoch: 3 | loss: 0.2319461
	speed: 0.0304s/iter; left time: 1176.5683s
	iters: 5000, epoch: 3 | loss: 0.2920095
	speed: 0.0303s/iter; left time: 1172.5134s
	iters: 5100, epoch: 3 | loss: 0.3776094
	speed: 0.0304s/iter; left time: 1170.4942s
	iters: 5200, epoch: 3 | loss: 0.2514777
	speed: 0.0303s/iter; left time: 1166.5874s
	iters: 5300, epoch: 3 | loss: 0.2301759
	speed: 0.0304s/iter; left time: 1165.1148s
	iters: 5400, epoch: 3 | loss: 0.2493449
	speed: 0.0304s/iter; left time: 1161.1175s
Epoch: 3 cost time: 166.83862972259521
Epoch: 3, Steps: 5455 | Train Loss: 0.2682938 Vali Loss: 0.1848013 Test Loss: 0.2638683
Validation loss decreased (0.188862 --> 0.184801).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.3769500
	speed: 1.2233s/iter; left time: 46591.6203s
	iters: 200, epoch: 4 | loss: 0.2868687
	speed: 0.0305s/iter; left time: 1158.1188s
	iters: 300, epoch: 4 | loss: 0.2204610
	speed: 0.0304s/iter; left time: 1151.6955s
	iters: 400, epoch: 4 | loss: 0.2924365
	speed: 0.0304s/iter; left time: 1149.1439s
	iters: 500, epoch: 4 | loss: 0.2612852
	speed: 0.0304s/iter; left time: 1145.0997s
	iters: 600, epoch: 4 | loss: 0.2134536
	speed: 0.0304s/iter; left time: 1141.0940s
	iters: 700, epoch: 4 | loss: 0.2481749
	speed: 0.0304s/iter; left time: 1138.3750s
	iters: 800, epoch: 4 | loss: 0.2269795
	speed: 0.0304s/iter; left time: 1136.4612s
	iters: 900, epoch: 4 | loss: 0.1949016
	speed: 0.0305s/iter; left time: 1135.9009s
	iters: 1000, epoch: 4 | loss: 0.3186701
	speed: 0.0305s/iter; left time: 1133.8407s
	iters: 1100, epoch: 4 | loss: 0.2652877
	speed: 0.0304s/iter; left time: 1126.5199s
	iters: 1200, epoch: 4 | loss: 0.2313719
	speed: 0.0304s/iter; left time: 1123.9779s
	iters: 1300, epoch: 4 | loss: 0.2128848
	speed: 0.0304s/iter; left time: 1119.5782s
	iters: 1400, epoch: 4 | loss: 0.2433798
	speed: 0.0304s/iter; left time: 1117.0104s
	iters: 1500, epoch: 4 | loss: 0.2503253
	speed: 0.0304s/iter; left time: 1115.2865s
	iters: 1600, epoch: 4 | loss: 0.2620689
	speed: 0.0304s/iter; left time: 1111.1970s
	iters: 1700, epoch: 4 | loss: 0.2376049
	speed: 0.0304s/iter; left time: 1109.5962s
	iters: 1800, epoch: 4 | loss: 0.3495449
	speed: 0.0304s/iter; left time: 1106.4411s
	iters: 1900, epoch: 4 | loss: 0.2575652
	speed: 0.0304s/iter; left time: 1102.5723s
	iters: 2000, epoch: 4 | loss: 0.2264292
	speed: 0.0304s/iter; left time: 1100.5908s
	iters: 2100, epoch: 4 | loss: 0.2086981
	speed: 0.0304s/iter; left time: 1096.7513s
	iters: 2200, epoch: 4 | loss: 0.2553980
	speed: 0.0304s/iter; left time: 1092.7350s
	iters: 2300, epoch: 4 | loss: 0.2452308
	speed: 0.0304s/iter; left time: 1091.2363s
	iters: 2400, epoch: 4 | loss: 0.3412066
	speed: 0.0304s/iter; left time: 1089.5862s
	iters: 2500, epoch: 4 | loss: 0.2461468
	speed: 0.0304s/iter; left time: 1085.6824s
	iters: 2600, epoch: 4 | loss: 0.2395270
	speed: 0.0304s/iter; left time: 1081.2263s
	iters: 2700, epoch: 4 | loss: 0.2325577
	speed: 0.0304s/iter; left time: 1079.9713s
	iters: 2800, epoch: 4 | loss: 0.3253128
	speed: 0.0304s/iter; left time: 1076.4727s
	iters: 2900, epoch: 4 | loss: 0.2188076
	speed: 0.0304s/iter; left time: 1072.3830s
	iters: 3000, epoch: 4 | loss: 0.3476442
	speed: 0.0304s/iter; left time: 1069.0808s
	iters: 3100, epoch: 4 | loss: 0.3081930
	speed: 0.0304s/iter; left time: 1067.0925s
	iters: 3200, epoch: 4 | loss: 0.2490899
	speed: 0.0304s/iter; left time: 1062.5787s
	iters: 3300, epoch: 4 | loss: 0.2470626
	speed: 0.0304s/iter; left time: 1059.9417s
	iters: 3400, epoch: 4 | loss: 0.2298002
	speed: 0.0304s/iter; left time: 1057.2486s
	iters: 3500, epoch: 4 | loss: 0.2936404
	speed: 0.0304s/iter; left time: 1053.9894s
	iters: 3600, epoch: 4 | loss: 0.2724976
	speed: 0.0304s/iter; left time: 1051.4060s
	iters: 3700, epoch: 4 | loss: 0.2398596
	speed: 0.0304s/iter; left time: 1047.9709s
	iters: 3800, epoch: 4 | loss: 0.1925929
	speed: 0.0303s/iter; left time: 1043.3611s
	iters: 3900, epoch: 4 | loss: 0.2278427
	speed: 0.0304s/iter; left time: 1041.8700s
	iters: 4000, epoch: 4 | loss: 0.2326427
	speed: 0.0304s/iter; left time: 1038.9159s
	iters: 4100, epoch: 4 | loss: 0.2964716
	speed: 0.0305s/iter; left time: 1039.0344s
	iters: 4200, epoch: 4 | loss: 0.2390472
	speed: 0.0305s/iter; left time: 1035.4362s
	iters: 4300, epoch: 4 | loss: 0.2679926
	speed: 0.0306s/iter; left time: 1036.7102s
	iters: 4400, epoch: 4 | loss: 0.2353107
	speed: 0.0304s/iter; left time: 1026.0056s
	iters: 4500, epoch: 4 | loss: 0.2659364
	speed: 0.0304s/iter; left time: 1024.2730s
	iters: 4600, epoch: 4 | loss: 0.3459661
	speed: 0.0304s/iter; left time: 1020.1559s
	iters: 4700, epoch: 4 | loss: 0.2911613
	speed: 0.0304s/iter; left time: 1017.5412s
	iters: 4800, epoch: 4 | loss: 0.2492952
	speed: 0.0305s/iter; left time: 1018.8832s
	iters: 4900, epoch: 4 | loss: 0.2660950
	speed: 0.0305s/iter; left time: 1014.5444s
	iters: 5000, epoch: 4 | loss: 0.2156732
	speed: 0.0304s/iter; left time: 1007.2143s
	iters: 5100, epoch: 4 | loss: 0.2925301
	speed: 0.0304s/iter; left time: 1005.5572s
	iters: 5200, epoch: 4 | loss: 0.2393942
	speed: 0.0304s/iter; left time: 1002.6011s
	iters: 5300, epoch: 4 | loss: 0.2585273
	speed: 0.0304s/iter; left time: 999.5438s
	iters: 5400, epoch: 4 | loss: 0.3917755
	speed: 0.0304s/iter; left time: 996.8488s
Epoch: 4 cost time: 166.3822100162506
Epoch: 4, Steps: 5455 | Train Loss: 0.2649484 Vali Loss: 0.1840961 Test Loss: 0.2612782
Validation loss decreased (0.184801 --> 0.184096).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.2057218
	speed: 1.2199s/iter; left time: 39806.4721s
	iters: 200, epoch: 5 | loss: 0.2261015
	speed: 0.0304s/iter; left time: 990.3911s
	iters: 300, epoch: 5 | loss: 0.2365477
	speed: 0.0304s/iter; left time: 986.4296s
	iters: 400, epoch: 5 | loss: 0.2575829
	speed: 0.0305s/iter; left time: 987.3046s
	iters: 500, epoch: 5 | loss: 0.2321320
	speed: 0.0304s/iter; left time: 980.9718s
	iters: 600, epoch: 5 | loss: 0.2210566
	speed: 0.0305s/iter; left time: 978.8366s
	iters: 700, epoch: 5 | loss: 0.2754704
	speed: 0.0304s/iter; left time: 974.7717s
	iters: 800, epoch: 5 | loss: 0.2763602
	speed: 0.0304s/iter; left time: 971.0568s
	iters: 900, epoch: 5 | loss: 0.2500117
	speed: 0.0303s/iter; left time: 964.7512s
	iters: 1000, epoch: 5 | loss: 0.3142349
	speed: 0.0304s/iter; left time: 965.1983s
	iters: 1100, epoch: 5 | loss: 0.2214360
	speed: 0.0304s/iter; left time: 960.9946s
	iters: 1200, epoch: 5 | loss: 0.2807126
	speed: 0.0304s/iter; left time: 959.9119s
	iters: 1300, epoch: 5 | loss: 0.2375292
	speed: 0.0304s/iter; left time: 955.4560s
	iters: 1400, epoch: 5 | loss: 0.2761775
	speed: 0.0304s/iter; left time: 952.2403s
	iters: 1500, epoch: 5 | loss: 0.2813925
	speed: 0.0304s/iter; left time: 950.8251s
	iters: 1600, epoch: 5 | loss: 0.2181072
	speed: 0.0304s/iter; left time: 947.2452s
	iters: 1700, epoch: 5 | loss: 0.2527649
	speed: 0.0304s/iter; left time: 944.5028s
	iters: 1800, epoch: 5 | loss: 0.2582058
	speed: 0.0303s/iter; left time: 937.8008s
	iters: 1900, epoch: 5 | loss: 0.2690262
	speed: 0.0304s/iter; left time: 936.9603s
	iters: 2000, epoch: 5 | loss: 0.2584568
	speed: 0.0304s/iter; left time: 934.3765s
	iters: 2100, epoch: 5 | loss: 0.3200652
	speed: 0.0304s/iter; left time: 931.3999s
	iters: 2200, epoch: 5 | loss: 0.2316561
	speed: 0.0304s/iter; left time: 928.3997s
	iters: 2300, epoch: 5 | loss: 0.2558551
	speed: 0.0304s/iter; left time: 925.0353s
	iters: 2400, epoch: 5 | loss: 0.2642150
	speed: 0.0304s/iter; left time: 922.1644s
	iters: 2500, epoch: 5 | loss: 0.2492958
	speed: 0.0303s/iter; left time: 917.0326s
	iters: 2600, epoch: 5 | loss: 0.3051492
	speed: 0.0304s/iter; left time: 916.6007s
	iters: 2700, epoch: 5 | loss: 0.2536532
	speed: 0.0304s/iter; left time: 912.9172s
	iters: 2800, epoch: 5 | loss: 0.2899256
	speed: 0.0304s/iter; left time: 910.2025s
	iters: 2900, epoch: 5 | loss: 0.2479781
	speed: 0.0304s/iter; left time: 906.0381s
	iters: 3000, epoch: 5 | loss: 0.2213253
	speed: 0.0304s/iter; left time: 904.2134s
	iters: 3100, epoch: 5 | loss: 0.2646398
	speed: 0.0304s/iter; left time: 899.4692s
	iters: 3200, epoch: 5 | loss: 0.2241032
	speed: 0.0304s/iter; left time: 898.7128s
	iters: 3300, epoch: 5 | loss: 0.2219243
	speed: 0.0304s/iter; left time: 894.4335s
	iters: 3400, epoch: 5 | loss: 0.2170492
	speed: 0.0303s/iter; left time: 888.8378s
	iters: 3500, epoch: 5 | loss: 0.2750340
	speed: 0.0304s/iter; left time: 888.7868s
	iters: 3600, epoch: 5 | loss: 0.2328641
	speed: 0.0304s/iter; left time: 885.6373s
	iters: 3700, epoch: 5 | loss: 0.2262406
	speed: 0.0304s/iter; left time: 882.9568s
	iters: 3800, epoch: 5 | loss: 0.3054619
	speed: 0.0304s/iter; left time: 880.3691s
	iters: 3900, epoch: 5 | loss: 0.2352081
	speed: 0.0305s/iter; left time: 878.1141s
	iters: 4000, epoch: 5 | loss: 0.2556374
	speed: 0.0304s/iter; left time: 872.7372s
	iters: 4100, epoch: 5 | loss: 0.2085838
	speed: 0.0306s/iter; left time: 875.3158s
	iters: 4200, epoch: 5 | loss: 0.2740103
	speed: 0.0303s/iter; left time: 865.6520s
	iters: 4300, epoch: 5 | loss: 0.2574246
	speed: 0.0304s/iter; left time: 863.8976s
	iters: 4400, epoch: 5 | loss: 0.2912639
	speed: 0.0304s/iter; left time: 861.3107s
	iters: 4500, epoch: 5 | loss: 0.2529626
	speed: 0.0304s/iter; left time: 857.5419s
	iters: 4600, epoch: 5 | loss: 0.2553006
	speed: 0.0304s/iter; left time: 854.9136s
	iters: 4700, epoch: 5 | loss: 0.2804101
	speed: 0.0306s/iter; left time: 857.1023s
	iters: 4800, epoch: 5 | loss: 0.2083884
	speed: 0.0304s/iter; left time: 849.5127s
	iters: 4900, epoch: 5 | loss: 0.2073360
	speed: 0.0304s/iter; left time: 845.2095s
	iters: 5000, epoch: 5 | loss: 0.2166847
	speed: 0.0304s/iter; left time: 842.7315s
	iters: 5100, epoch: 5 | loss: 0.3203340
	speed: 0.0305s/iter; left time: 841.7857s
	iters: 5200, epoch: 5 | loss: 0.3122849
	speed: 0.0304s/iter; left time: 836.5454s
	iters: 5300, epoch: 5 | loss: 0.3245825
	speed: 0.0304s/iter; left time: 832.5569s
	iters: 5400, epoch: 5 | loss: 0.2217529
	speed: 0.0304s/iter; left time: 830.8974s
Epoch: 5 cost time: 166.42292833328247
Epoch: 5, Steps: 5455 | Train Loss: 0.2627813 Vali Loss: 0.1811649 Test Loss: 0.2580445
Validation loss decreased (0.184096 --> 0.181165).  Saving model ...
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.2671118
	speed: 1.2215s/iter; left time: 33195.4089s
	iters: 200, epoch: 6 | loss: 0.2518342
	speed: 0.0310s/iter; left time: 838.5144s
	iters: 300, epoch: 6 | loss: 0.2249653
	speed: 0.0304s/iter; left time: 820.2916s
	iters: 400, epoch: 6 | loss: 0.2360605
	speed: 0.0304s/iter; left time: 816.6298s
	iters: 500, epoch: 6 | loss: 0.2479444
	speed: 0.0304s/iter; left time: 814.2302s
	iters: 600, epoch: 6 | loss: 0.2656640
	speed: 0.0304s/iter; left time: 811.1196s
	iters: 700, epoch: 6 | loss: 0.2595659
	speed: 0.0304s/iter; left time: 807.7719s
	iters: 800, epoch: 6 | loss: 0.2050449
	speed: 0.0304s/iter; left time: 804.3833s
	iters: 900, epoch: 6 | loss: 0.2562277
	speed: 0.0306s/iter; left time: 807.0756s
	iters: 1000, epoch: 6 | loss: 0.3523476
	speed: 0.0304s/iter; left time: 798.4990s
	iters: 1100, epoch: 6 | loss: 0.2407752
	speed: 0.0304s/iter; left time: 796.1356s
	iters: 1200, epoch: 6 | loss: 0.2137170
	speed: 0.0304s/iter; left time: 792.8578s
	iters: 1300, epoch: 6 | loss: 0.2541629
	speed: 0.0304s/iter; left time: 790.3448s
	iters: 1400, epoch: 6 | loss: 0.2504624
	speed: 0.0304s/iter; left time: 787.3165s
	iters: 1500, epoch: 6 | loss: 0.2282207
	speed: 0.0304s/iter; left time: 784.0977s
	iters: 1600, epoch: 6 | loss: 0.2538389
	speed: 0.0304s/iter; left time: 779.9224s
	iters: 1700, epoch: 6 | loss: 0.2279798
	speed: 0.0304s/iter; left time: 778.1479s
	iters: 1800, epoch: 6 | loss: 0.2409394
	speed: 0.0304s/iter; left time: 774.1031s
	iters: 1900, epoch: 6 | loss: 0.2867799
	speed: 0.0304s/iter; left time: 771.3922s
	iters: 2000, epoch: 6 | loss: 0.1822009
	speed: 0.0304s/iter; left time: 767.5647s
	iters: 2100, epoch: 6 | loss: 0.2327059
	speed: 0.0304s/iter; left time: 766.0687s
	iters: 2200, epoch: 6 | loss: 0.3194766
	speed: 0.0304s/iter; left time: 761.4491s
	iters: 2300, epoch: 6 | loss: 0.2645453
	speed: 0.0304s/iter; left time: 759.8743s
	iters: 2400, epoch: 6 | loss: 0.3297234
	speed: 0.0304s/iter; left time: 756.3275s
	iters: 2500, epoch: 6 | loss: 0.2905275
	speed: 0.0304s/iter; left time: 752.6940s
	iters: 2600, epoch: 6 | loss: 0.2760944
	speed: 0.0304s/iter; left time: 750.2020s
	iters: 2700, epoch: 6 | loss: 0.3054422
	speed: 0.0304s/iter; left time: 747.3186s
	iters: 2800, epoch: 6 | loss: 0.2585399
	speed: 0.0304s/iter; left time: 744.3004s
	iters: 2900, epoch: 6 | loss: 0.2615977
	speed: 0.0304s/iter; left time: 740.0508s
	iters: 3000, epoch: 6 | loss: 0.2754661
	speed: 0.0304s/iter; left time: 737.5240s
	iters: 3100, epoch: 6 | loss: 0.2553142
	speed: 0.0304s/iter; left time: 734.6978s
	iters: 3200, epoch: 6 | loss: 0.2513570
	speed: 0.0304s/iter; left time: 732.5137s
	iters: 3300, epoch: 6 | loss: 0.3235473
	speed: 0.0304s/iter; left time: 728.7514s
	iters: 3400, epoch: 6 | loss: 0.2292601
	speed: 0.0306s/iter; left time: 730.8258s
	iters: 3500, epoch: 6 | loss: 0.2740275
	speed: 0.0302s/iter; left time: 717.9142s
	iters: 3600, epoch: 6 | loss: 0.2289782
	speed: 0.0304s/iter; left time: 719.2400s
	iters: 3700, epoch: 6 | loss: 0.2168852
	speed: 0.0304s/iter; left time: 716.7721s
	iters: 3800, epoch: 6 | loss: 0.2836923
	speed: 0.0304s/iter; left time: 712.7852s
	iters: 3900, epoch: 6 | loss: 0.2785880
	speed: 0.0304s/iter; left time: 711.3923s
	iters: 4000, epoch: 6 | loss: 0.2576775
	speed: 0.0304s/iter; left time: 707.4069s
	iters: 4100, epoch: 6 | loss: 0.2284995
	speed: 0.0304s/iter; left time: 704.1787s
	iters: 4200, epoch: 6 | loss: 0.2344371
	speed: 0.0304s/iter; left time: 702.1680s
	iters: 4300, epoch: 6 | loss: 0.1966988
	speed: 0.0304s/iter; left time: 698.0675s
	iters: 4400, epoch: 6 | loss: 0.2739773
	speed: 0.0304s/iter; left time: 694.8069s
	iters: 4500, epoch: 6 | loss: 0.2785002
	speed: 0.0304s/iter; left time: 692.4467s
	iters: 4600, epoch: 6 | loss: 0.2254962
	speed: 0.0304s/iter; left time: 689.4043s
	iters: 4700, epoch: 6 | loss: 0.2864558
	speed: 0.0304s/iter; left time: 686.7581s
	iters: 4800, epoch: 6 | loss: 0.2304868
	speed: 0.0304s/iter; left time: 683.2929s
	iters: 4900, epoch: 6 | loss: 0.2170594
	speed: 0.0304s/iter; left time: 680.0933s
	iters: 5000, epoch: 6 | loss: 0.2708720
	speed: 0.0304s/iter; left time: 676.7593s
	iters: 5100, epoch: 6 | loss: 0.2475890
	speed: 0.0304s/iter; left time: 674.0229s
	iters: 5200, epoch: 6 | loss: 0.2535290
	speed: 0.0304s/iter; left time: 671.3159s
	iters: 5300, epoch: 6 | loss: 0.3565845
	speed: 0.0303s/iter; left time: 666.9474s
	iters: 5400, epoch: 6 | loss: 0.2827449
	speed: 0.0303s/iter; left time: 663.8924s
Epoch: 6 cost time: 166.46633124351501
Epoch: 6, Steps: 5455 | Train Loss: 0.2608613 Vali Loss: 0.1818536 Test Loss: 0.2574171
EarlyStopping counter: 1 out of 3
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.2123902
	speed: 1.2209s/iter; left time: 26518.6571s
	iters: 200, epoch: 7 | loss: 0.2451122
	speed: 0.0305s/iter; left time: 659.2860s
	iters: 300, epoch: 7 | loss: 0.2364517
	speed: 0.0304s/iter; left time: 655.2391s
	iters: 400, epoch: 7 | loss: 0.3228958
	speed: 0.0305s/iter; left time: 654.2628s
	iters: 500, epoch: 7 | loss: 0.2305647
	speed: 0.0305s/iter; left time: 649.7850s
	iters: 600, epoch: 7 | loss: 0.2767546
	speed: 0.0304s/iter; left time: 645.6124s
	iters: 700, epoch: 7 | loss: 0.2522680
	speed: 0.0304s/iter; left time: 642.3671s
	iters: 800, epoch: 7 | loss: 0.2535422
	speed: 0.0304s/iter; left time: 639.4017s
	iters: 900, epoch: 7 | loss: 0.2399353
	speed: 0.0304s/iter; left time: 635.6748s
	iters: 1000, epoch: 7 | loss: 0.1971477
	speed: 0.0304s/iter; left time: 632.6743s
	iters: 1100, epoch: 7 | loss: 0.2364210
	speed: 0.0304s/iter; left time: 630.0589s
	iters: 1200, epoch: 7 | loss: 0.1941124
	speed: 0.0304s/iter; left time: 626.9462s
	iters: 1300, epoch: 7 | loss: 0.2540552
	speed: 0.0305s/iter; left time: 625.0302s
	iters: 1400, epoch: 7 | loss: 0.3643636
	speed: 0.0305s/iter; left time: 622.1085s
	iters: 1500, epoch: 7 | loss: 0.2549602
	speed: 0.0305s/iter; left time: 618.8392s
	iters: 1600, epoch: 7 | loss: 0.2051357
	speed: 0.0304s/iter; left time: 614.8926s
	iters: 1700, epoch: 7 | loss: 0.2337521
	speed: 0.0304s/iter; left time: 612.1073s
	iters: 1800, epoch: 7 | loss: 0.2651018
	speed: 0.0304s/iter; left time: 609.1540s
	iters: 1900, epoch: 7 | loss: 0.2965055
	speed: 0.0305s/iter; left time: 606.7251s
	iters: 2000, epoch: 7 | loss: 0.2068224
	speed: 0.0305s/iter; left time: 603.9661s
	iters: 2100, epoch: 7 | loss: 0.2605527
	speed: 0.0305s/iter; left time: 601.3684s
	iters: 2200, epoch: 7 | loss: 0.2656557
	speed: 0.0304s/iter; left time: 596.6501s
	iters: 2300, epoch: 7 | loss: 0.2615414
	speed: 0.0304s/iter; left time: 592.9472s
	iters: 2400, epoch: 7 | loss: 0.2558348
	speed: 0.0305s/iter; left time: 591.9113s
	iters: 2500, epoch: 7 | loss: 0.3866465
	speed: 0.0305s/iter; left time: 589.0921s
	iters: 2600, epoch: 7 | loss: 0.2090002
	speed: 0.0305s/iter; left time: 585.6715s
	iters: 2700, epoch: 7 | loss: 0.2628484
	speed: 0.0305s/iter; left time: 582.8358s
	iters: 2800, epoch: 7 | loss: 0.3436988
	speed: 0.0303s/iter; left time: 576.6585s
	iters: 2900, epoch: 7 | loss: 0.2928549
	speed: 0.0304s/iter; left time: 574.8664s
	iters: 3000, epoch: 7 | loss: 0.2550251
	speed: 0.0304s/iter; left time: 572.0532s
	iters: 3100, epoch: 7 | loss: 0.2139340
	speed: 0.0305s/iter; left time: 570.0616s
	iters: 3200, epoch: 7 | loss: 0.2344142
	speed: 0.0307s/iter; left time: 572.1975s
	iters: 3300, epoch: 7 | loss: 0.3102921
	speed: 0.0305s/iter; left time: 564.9999s
	iters: 3400, epoch: 7 | loss: 0.2600298
	speed: 0.0305s/iter; left time: 562.3653s
	iters: 3500, epoch: 7 | loss: 0.2077643
	speed: 0.0305s/iter; left time: 558.2653s
	iters: 3600, epoch: 7 | loss: 0.2610626
	speed: 0.0304s/iter; left time: 553.6849s
	iters: 3700, epoch: 7 | loss: 0.2479786
	speed: 0.0304s/iter; left time: 551.5525s
	iters: 3800, epoch: 7 | loss: 0.2082272
	speed: 0.0305s/iter; left time: 548.7971s
	iters: 3900, epoch: 7 | loss: 0.2736604
	speed: 0.0305s/iter; left time: 546.0625s
	iters: 4000, epoch: 7 | loss: 0.2227140
	speed: 0.0305s/iter; left time: 543.4430s
	iters: 4100, epoch: 7 | loss: 0.2216003
	speed: 0.0305s/iter; left time: 540.0237s
	iters: 4200, epoch: 7 | loss: 0.2731028
	speed: 0.0304s/iter; left time: 536.5072s
	iters: 4300, epoch: 7 | loss: 0.3834653
	speed: 0.0305s/iter; left time: 534.0684s
	iters: 4400, epoch: 7 | loss: 0.2819664
	speed: 0.0305s/iter; left time: 530.5127s
	iters: 4500, epoch: 7 | loss: 0.2385304
	speed: 0.0304s/iter; left time: 526.4457s
	iters: 4600, epoch: 7 | loss: 0.2611641
	speed: 0.0304s/iter; left time: 524.2301s
	iters: 4700, epoch: 7 | loss: 0.3139030
	speed: 0.0305s/iter; left time: 522.1190s
	iters: 4800, epoch: 7 | loss: 0.2505132
	speed: 0.0304s/iter; left time: 517.9128s
	iters: 4900, epoch: 7 | loss: 0.2820602
	speed: 0.0304s/iter; left time: 515.0274s
	iters: 5000, epoch: 7 | loss: 0.2597598
	speed: 0.0304s/iter; left time: 511.7420s
	iters: 5100, epoch: 7 | loss: 0.2810517
	speed: 0.0304s/iter; left time: 508.3445s
	iters: 5200, epoch: 7 | loss: 0.2135459
	speed: 0.0304s/iter; left time: 505.7249s
	iters: 5300, epoch: 7 | loss: 0.2744339
	speed: 0.0304s/iter; left time: 502.7869s
	iters: 5400, epoch: 7 | loss: 0.2353958
	speed: 0.0304s/iter; left time: 499.3333s
Epoch: 7 cost time: 166.65966796875
Epoch: 7, Steps: 5455 | Train Loss: 0.2602268 Vali Loss: 0.1807746 Test Loss: 0.2571958
Validation loss decreased (0.181165 --> 0.180775).  Saving model ...
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.2243175
	speed: 1.2184s/iter; left time: 19818.6861s
	iters: 200, epoch: 8 | loss: 0.2705976
	speed: 0.0304s/iter; left time: 491.8955s
	iters: 300, epoch: 8 | loss: 0.2556457
	speed: 0.0306s/iter; left time: 491.9569s
	iters: 400, epoch: 8 | loss: 0.2734350
	speed: 0.0306s/iter; left time: 488.6637s
	iters: 500, epoch: 8 | loss: 0.2518397
	speed: 0.0304s/iter; left time: 482.4612s
	iters: 600, epoch: 8 | loss: 0.2464149
	speed: 0.0304s/iter; left time: 479.9841s
	iters: 700, epoch: 8 | loss: 0.2166124
	speed: 0.0304s/iter; left time: 476.7640s
	iters: 800, epoch: 8 | loss: 0.2441116
	speed: 0.0304s/iter; left time: 473.0701s
	iters: 900, epoch: 8 | loss: 0.2386631
	speed: 0.0304s/iter; left time: 470.6607s
	iters: 1000, epoch: 8 | loss: 0.2642741
	speed: 0.0304s/iter; left time: 467.5301s
	iters: 1100, epoch: 8 | loss: 0.2908380
	speed: 0.0304s/iter; left time: 464.8342s
	iters: 1200, epoch: 8 | loss: 0.1991795
	speed: 0.0304s/iter; left time: 461.4600s
	iters: 1300, epoch: 8 | loss: 0.2412990
	speed: 0.0305s/iter; left time: 458.8409s
	iters: 1400, epoch: 8 | loss: 0.2530247
	speed: 0.0304s/iter; left time: 455.2968s
	iters: 1500, epoch: 8 | loss: 0.2950693
	speed: 0.0304s/iter; left time: 452.2315s
	iters: 1600, epoch: 8 | loss: 0.2821906
	speed: 0.0304s/iter; left time: 448.6078s
	iters: 1700, epoch: 8 | loss: 0.2581615
	speed: 0.0305s/iter; left time: 447.1341s
	iters: 1800, epoch: 8 | loss: 0.2355077
	speed: 0.0304s/iter; left time: 443.1826s
	iters: 1900, epoch: 8 | loss: 0.2135494
	speed: 0.0304s/iter; left time: 439.8656s
	iters: 2000, epoch: 8 | loss: 0.2725751
	speed: 0.0304s/iter; left time: 436.5611s
	iters: 2100, epoch: 8 | loss: 0.2140584
	speed: 0.0304s/iter; left time: 433.4104s
	iters: 2200, epoch: 8 | loss: 0.2002341
	speed: 0.0304s/iter; left time: 430.6096s
	iters: 2300, epoch: 8 | loss: 0.2335156
	speed: 0.0304s/iter; left time: 427.8659s
	iters: 2400, epoch: 8 | loss: 0.2407307
	speed: 0.0305s/iter; left time: 426.3824s
	iters: 2500, epoch: 8 | loss: 0.2314135
	speed: 0.0304s/iter; left time: 421.8958s
	iters: 2600, epoch: 8 | loss: 0.2441842
	speed: 0.0306s/iter; left time: 420.7327s
	iters: 2700, epoch: 8 | loss: 0.2774251
	speed: 0.0305s/iter; left time: 416.9352s
	iters: 2800, epoch: 8 | loss: 0.2562577
	speed: 0.0305s/iter; left time: 414.0018s
	iters: 2900, epoch: 8 | loss: 0.2723067
	speed: 0.0304s/iter; left time: 409.7996s
	iters: 3000, epoch: 8 | loss: 0.2622484
	speed: 0.0304s/iter; left time: 406.7624s
	iters: 3100, epoch: 8 | loss: 0.1972529
	speed: 0.0304s/iter; left time: 403.8064s
	iters: 3200, epoch: 8 | loss: 0.2795112
	speed: 0.0304s/iter; left time: 400.2891s
	iters: 3300, epoch: 8 | loss: 0.2293575
	speed: 0.0305s/iter; left time: 398.0240s
	iters: 3400, epoch: 8 | loss: 0.2438401
	speed: 0.0304s/iter; left time: 394.3852s
	iters: 3500, epoch: 8 | loss: 0.2955723
	speed: 0.0304s/iter; left time: 391.5584s
	iters: 3600, epoch: 8 | loss: 0.2810531
	speed: 0.0305s/iter; left time: 389.6417s
	iters: 3700, epoch: 8 | loss: 0.2378840
	speed: 0.0305s/iter; left time: 386.1176s
	iters: 3800, epoch: 8 | loss: 0.3304646
	speed: 0.0307s/iter; left time: 385.6422s
	iters: 3900, epoch: 8 | loss: 0.3215158
	speed: 0.0305s/iter; left time: 379.7616s
	iters: 4000, epoch: 8 | loss: 0.3043761
	speed: 0.0304s/iter; left time: 376.4711s
	iters: 4100, epoch: 8 | loss: 0.2333277
	speed: 0.0304s/iter; left time: 373.0385s
	iters: 4200, epoch: 8 | loss: 0.2715352
	speed: 0.0304s/iter; left time: 370.1606s
	iters: 4300, epoch: 8 | loss: 0.2331524
	speed: 0.0304s/iter; left time: 367.3267s
	iters: 4400, epoch: 8 | loss: 0.3021904
	speed: 0.0305s/iter; left time: 364.4206s
	iters: 4500, epoch: 8 | loss: 0.2182127
	speed: 0.0304s/iter; left time: 360.7428s
	iters: 4600, epoch: 8 | loss: 0.2631837
	speed: 0.0304s/iter; left time: 358.1218s
	iters: 4700, epoch: 8 | loss: 0.2565513
	speed: 0.0306s/iter; left time: 357.3405s
	iters: 4800, epoch: 8 | loss: 0.2589365
	speed: 0.0305s/iter; left time: 352.5628s
	iters: 4900, epoch: 8 | loss: 0.2571664
	speed: 0.0305s/iter; left time: 349.9815s
	iters: 5000, epoch: 8 | loss: 0.2440081
	speed: 0.0306s/iter; left time: 347.5952s
	iters: 5100, epoch: 8 | loss: 0.3296206
	speed: 0.0305s/iter; left time: 343.9430s
	iters: 5200, epoch: 8 | loss: 0.3235919
	speed: 0.0305s/iter; left time: 340.2731s
	iters: 5300, epoch: 8 | loss: 0.2874978
	speed: 0.0305s/iter; left time: 337.7357s
	iters: 5400, epoch: 8 | loss: 0.2550036
	speed: 0.0305s/iter; left time: 334.2216s
Epoch: 8 cost time: 166.7427167892456
Epoch: 8, Steps: 5455 | Train Loss: 0.2597739 Vali Loss: 0.1806218 Test Loss: 0.2567141
Validation loss decreased (0.180775 --> 0.180622).  Saving model ...
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.2131686
	speed: 1.2200s/iter; left time: 13189.4239s
	iters: 200, epoch: 9 | loss: 0.2812659
	speed: 0.0305s/iter; left time: 326.3781s
	iters: 300, epoch: 9 | loss: 0.2394558
	speed: 0.0304s/iter; left time: 322.8978s
	iters: 400, epoch: 9 | loss: 0.2034346
	speed: 0.0304s/iter; left time: 319.7454s
	iters: 500, epoch: 9 | loss: 0.2814142
	speed: 0.0305s/iter; left time: 317.1214s
	iters: 600, epoch: 9 | loss: 0.2331834
	speed: 0.0304s/iter; left time: 313.6005s
	iters: 700, epoch: 9 | loss: 0.2104861
	speed: 0.0304s/iter; left time: 310.6724s
	iters: 800, epoch: 9 | loss: 0.2512712
	speed: 0.0304s/iter; left time: 307.6421s
	iters: 900, epoch: 9 | loss: 0.2632009
	speed: 0.0304s/iter; left time: 304.3855s
	iters: 1000, epoch: 9 | loss: 0.2629223
	speed: 0.0304s/iter; left time: 301.6499s
	iters: 1100, epoch: 9 | loss: 0.4397281
	speed: 0.0304s/iter; left time: 298.5834s
	iters: 1200, epoch: 9 | loss: 0.3398588
	speed: 0.0302s/iter; left time: 292.7960s
	iters: 1300, epoch: 9 | loss: 0.2298990
	speed: 0.0305s/iter; left time: 293.1100s
	iters: 1400, epoch: 9 | loss: 0.2313134
	speed: 0.0305s/iter; left time: 289.7214s
	iters: 1500, epoch: 9 | loss: 0.2705383
	speed: 0.0304s/iter; left time: 286.3759s
	iters: 1600, epoch: 9 | loss: 0.2560510
	speed: 0.0307s/iter; left time: 285.3993s
	iters: 1700, epoch: 9 | loss: 0.2574944
	speed: 0.0304s/iter; left time: 280.2759s
	iters: 1800, epoch: 9 | loss: 0.2249406
	speed: 0.0304s/iter; left time: 276.8090s
	iters: 1900, epoch: 9 | loss: 0.2243894
	speed: 0.0304s/iter; left time: 273.9822s
	iters: 2000, epoch: 9 | loss: 0.2223585
	speed: 0.0304s/iter; left time: 271.2324s
	iters: 2100, epoch: 9 | loss: 0.2237870
	speed: 0.0306s/iter; left time: 269.8665s
	iters: 2200, epoch: 9 | loss: 0.2558538
	speed: 0.0304s/iter; left time: 264.8645s
	iters: 2300, epoch: 9 | loss: 0.2305147
	speed: 0.0304s/iter; left time: 261.7667s
	iters: 2400, epoch: 9 | loss: 0.2397471
	speed: 0.0304s/iter; left time: 258.8058s
	iters: 2500, epoch: 9 | loss: 0.2291607
	speed: 0.0304s/iter; left time: 255.8022s
	iters: 2600, epoch: 9 | loss: 0.3164022
	speed: 0.0304s/iter; left time: 252.8531s
	iters: 2700, epoch: 9 | loss: 0.2247397
	speed: 0.0304s/iter; left time: 249.6970s
	iters: 2800, epoch: 9 | loss: 0.2326790
	speed: 0.0304s/iter; left time: 246.3591s
	iters: 2900, epoch: 9 | loss: 0.2302846
	speed: 0.0304s/iter; left time: 243.5015s
	iters: 3000, epoch: 9 | loss: 0.2607076
	speed: 0.0304s/iter; left time: 240.8658s
	iters: 3100, epoch: 9 | loss: 0.2103565
	speed: 0.0304s/iter; left time: 237.5909s
	iters: 3200, epoch: 9 | loss: 0.2378978
	speed: 0.0304s/iter; left time: 234.4045s
	iters: 3300, epoch: 9 | loss: 0.2740994
	speed: 0.0305s/iter; left time: 232.1023s
	iters: 3400, epoch: 9 | loss: 0.2458197
	speed: 0.0306s/iter; left time: 229.8557s
	iters: 3500, epoch: 9 | loss: 0.2609811
	speed: 0.0308s/iter; left time: 227.9438s
	iters: 3600, epoch: 9 | loss: 0.2505014
	speed: 0.0306s/iter; left time: 223.5270s
	iters: 3700, epoch: 9 | loss: 0.2185009
	speed: 0.0309s/iter; left time: 222.9915s
	iters: 3800, epoch: 9 | loss: 0.2420477
	speed: 0.0304s/iter; left time: 216.3508s
	iters: 3900, epoch: 9 | loss: 0.2422413
	speed: 0.0304s/iter; left time: 213.1523s
	iters: 4000, epoch: 9 | loss: 0.2562932
	speed: 0.0304s/iter; left time: 210.1896s
	iters: 4100, epoch: 9 | loss: 0.3547761
	speed: 0.0305s/iter; left time: 207.4526s
	iters: 4200, epoch: 9 | loss: 0.2629748
	speed: 0.0304s/iter; left time: 204.3057s
	iters: 4300, epoch: 9 | loss: 0.3861644
	speed: 0.0304s/iter; left time: 201.1672s
	iters: 4400, epoch: 9 | loss: 0.2426124
	speed: 0.0305s/iter; left time: 198.3313s
	iters: 4500, epoch: 9 | loss: 0.2036561
	speed: 0.0306s/iter; left time: 196.2084s
	iters: 4600, epoch: 9 | loss: 0.2930033
	speed: 0.0304s/iter; left time: 192.1320s
	iters: 4700, epoch: 9 | loss: 0.2420554
	speed: 0.0304s/iter; left time: 188.8279s
	iters: 4800, epoch: 9 | loss: 0.2555458
	speed: 0.0304s/iter; left time: 185.6173s
	iters: 4900, epoch: 9 | loss: 0.2352826
	speed: 0.0304s/iter; left time: 182.7939s
	iters: 5000, epoch: 9 | loss: 0.3072541
	speed: 0.0304s/iter; left time: 179.6103s
	iters: 5100, epoch: 9 | loss: 0.2097036
	speed: 0.0304s/iter; left time: 176.5124s
	iters: 5200, epoch: 9 | loss: 0.3391583
	speed: 0.0304s/iter; left time: 173.5960s
	iters: 5300, epoch: 9 | loss: 0.2280803
	speed: 0.0304s/iter; left time: 170.5323s
	iters: 5400, epoch: 9 | loss: 0.2224006
	speed: 0.0304s/iter; left time: 167.3613s
Epoch: 9 cost time: 166.62340903282166
Epoch: 9, Steps: 5455 | Train Loss: 0.2594235 Vali Loss: 0.1806161 Test Loss: 0.2567138
Validation loss decreased (0.180622 --> 0.180616).  Saving model ...
Updating learning rate to 3.90625e-06
	iters: 100, epoch: 10 | loss: 0.2695680
	speed: 1.2100s/iter; left time: 6480.8175s
	iters: 200, epoch: 10 | loss: 0.2325473
	speed: 0.0304s/iter; left time: 159.7730s
	iters: 300, epoch: 10 | loss: 0.2915534
	speed: 0.0304s/iter; left time: 156.8452s
	iters: 400, epoch: 10 | loss: 0.1939017
	speed: 0.0304s/iter; left time: 153.5495s
	iters: 500, epoch: 10 | loss: 0.2846589
	speed: 0.0304s/iter; left time: 150.8116s
	iters: 600, epoch: 10 | loss: 0.2527204
	speed: 0.0304s/iter; left time: 147.6396s
	iters: 700, epoch: 10 | loss: 0.3190515
	speed: 0.0304s/iter; left time: 144.7211s
	iters: 800, epoch: 10 | loss: 0.2216218
	speed: 0.0304s/iter; left time: 141.4265s
	iters: 900, epoch: 10 | loss: 0.2368515
	speed: 0.0306s/iter; left time: 139.4125s
	iters: 1000, epoch: 10 | loss: 0.2311939
	speed: 0.0304s/iter; left time: 135.3891s
	iters: 1100, epoch: 10 | loss: 0.2235716
	speed: 0.0304s/iter; left time: 132.3209s
	iters: 1200, epoch: 10 | loss: 0.2500161
	speed: 0.0304s/iter; left time: 129.4479s
	iters: 1300, epoch: 10 | loss: 0.2250215
	speed: 0.0304s/iter; left time: 126.3407s
	iters: 1400, epoch: 10 | loss: 0.2346719
	speed: 0.0304s/iter; left time: 123.2724s
	iters: 1500, epoch: 10 | loss: 0.2507425
	speed: 0.0304s/iter; left time: 120.1202s
	iters: 1600, epoch: 10 | loss: 0.2275917
	speed: 0.0304s/iter; left time: 117.2824s
	iters: 1700, epoch: 10 | loss: 0.2580861
	speed: 0.0304s/iter; left time: 114.0673s
	iters: 1800, epoch: 10 | loss: 0.2834448
	speed: 0.0305s/iter; left time: 111.4169s
	iters: 1900, epoch: 10 | loss: 0.2215460
	speed: 0.0304s/iter; left time: 108.0340s
	iters: 2000, epoch: 10 | loss: 0.2603707
	speed: 0.0304s/iter; left time: 105.1821s
	iters: 2100, epoch: 10 | loss: 0.3130452
	speed: 0.0304s/iter; left time: 102.0328s
	iters: 2200, epoch: 10 | loss: 0.2320066
	speed: 0.0304s/iter; left time: 99.0108s
	iters: 2300, epoch: 10 | loss: 0.2307852
	speed: 0.0303s/iter; left time: 95.6970s
	iters: 2400, epoch: 10 | loss: 0.2257158
	speed: 0.0304s/iter; left time: 92.9134s
	iters: 2500, epoch: 10 | loss: 0.2841889
	speed: 0.0304s/iter; left time: 89.7895s
	iters: 2600, epoch: 10 | loss: 0.2640516
	speed: 0.0304s/iter; left time: 86.8565s
	iters: 2700, epoch: 10 | loss: 0.2613324
	speed: 0.0304s/iter; left time: 83.7890s
	iters: 2800, epoch: 10 | loss: 0.2743638
	speed: 0.0303s/iter; left time: 80.6041s
	iters: 2900, epoch: 10 | loss: 0.2214656
	speed: 0.0304s/iter; left time: 77.7299s
	iters: 3000, epoch: 10 | loss: 0.2655530
	speed: 0.0304s/iter; left time: 74.6283s
	iters: 3100, epoch: 10 | loss: 0.2684326
	speed: 0.0304s/iter; left time: 71.6521s
	iters: 3200, epoch: 10 | loss: 0.2475808
	speed: 0.0304s/iter; left time: 68.5757s
	iters: 3300, epoch: 10 | loss: 0.2336227
	speed: 0.0304s/iter; left time: 65.5549s
	iters: 3400, epoch: 10 | loss: 0.2178754
	speed: 0.0304s/iter; left time: 62.5602s
	iters: 3500, epoch: 10 | loss: 0.2684973
	speed: 0.0304s/iter; left time: 59.4556s
	iters: 3600, epoch: 10 | loss: 0.2369480
	speed: 0.0304s/iter; left time: 56.4898s
	iters: 3700, epoch: 10 | loss: 0.2635492
	speed: 0.0304s/iter; left time: 53.3524s
	iters: 3800, epoch: 10 | loss: 0.2738683
	speed: 0.0304s/iter; left time: 50.3894s
	iters: 3900, epoch: 10 | loss: 0.2935128
	speed: 0.0304s/iter; left time: 47.2600s
	iters: 4000, epoch: 10 | loss: 0.2404179
	speed: 0.0304s/iter; left time: 44.3075s
	iters: 4100, epoch: 10 | loss: 0.2779195
	speed: 0.0304s/iter; left time: 41.2112s
	iters: 4200, epoch: 10 | loss: 0.2079676
	speed: 0.0304s/iter; left time: 38.2124s
	iters: 4300, epoch: 10 | loss: 0.2425915
	speed: 0.0304s/iter; left time: 35.1482s
	iters: 4400, epoch: 10 | loss: 0.2158218
	speed: 0.0304s/iter; left time: 32.1006s
	iters: 4500, epoch: 10 | loss: 0.2705252
	speed: 0.0304s/iter; left time: 29.0858s
	iters: 4600, epoch: 10 | loss: 0.2524702
	speed: 0.0304s/iter; left time: 26.0540s
	iters: 4700, epoch: 10 | loss: 0.2300388
	speed: 0.0304s/iter; left time: 22.9508s
	iters: 4800, epoch: 10 | loss: 0.2344206
	speed: 0.0304s/iter; left time: 19.9437s
	iters: 4900, epoch: 10 | loss: 0.2764917
	speed: 0.0304s/iter; left time: 16.8987s
	iters: 5000, epoch: 10 | loss: 0.3008609
	speed: 0.0304s/iter; left time: 13.8675s
	iters: 5100, epoch: 10 | loss: 0.2467652
	speed: 0.0304s/iter; left time: 10.8302s
	iters: 5200, epoch: 10 | loss: 0.2135213
	speed: 0.0304s/iter; left time: 7.7746s
	iters: 5300, epoch: 10 | loss: 0.2293372
	speed: 0.0304s/iter; left time: 4.7463s
	iters: 5400, epoch: 10 | loss: 0.2165923
	speed: 0.0304s/iter; left time: 1.7024s
Epoch: 10 cost time: 166.44930601119995
Epoch: 10, Steps: 5455 | Train Loss: 0.2592920 Vali Loss: 0.1806037 Test Loss: 0.2564098
Validation loss decreased (0.180616 --> 0.180604).  Saving model ...
Updating learning rate to 1.953125e-06
>>>>>>>testing : long_term_forecast_pems06_h_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 24725
test shape: (24725, 1, 336, 130) (24725, 1, 336, 130)
test shape: (24725, 336, 130) (24725, 336, 130)
mse:0.25641000270843506, mae:0.3254361152648926
>>>>>>>Overall time: 2966 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
