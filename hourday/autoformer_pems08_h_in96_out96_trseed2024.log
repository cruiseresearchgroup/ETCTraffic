Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=212, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems08_h.csv', dec_in=212, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=212, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems08_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 141281
val 20117
test 40325
	iters: 100, epoch: 1 | loss: 0.2703905
	speed: 0.1053s/iter; left time: 92979.7075s
	iters: 200, epoch: 1 | loss: 0.2434826
	speed: 0.1010s/iter; left time: 89163.6894s
	iters: 300, epoch: 1 | loss: 0.2072175
	speed: 0.1010s/iter; left time: 89157.4890s
	iters: 400, epoch: 1 | loss: 0.2005666
	speed: 0.1012s/iter; left time: 89350.5341s
	iters: 500, epoch: 1 | loss: 0.1895642
	speed: 0.1010s/iter; left time: 89164.3586s
	iters: 600, epoch: 1 | loss: 0.1806283
	speed: 0.1015s/iter; left time: 89607.2512s
	iters: 700, epoch: 1 | loss: 0.1845758
	speed: 0.1013s/iter; left time: 89407.4447s
	iters: 800, epoch: 1 | loss: 0.2003329
	speed: 0.1016s/iter; left time: 89603.2169s
	iters: 900, epoch: 1 | loss: 0.1530934
	speed: 0.1012s/iter; left time: 89285.2872s
	iters: 1000, epoch: 1 | loss: 0.1203969
	speed: 0.1014s/iter; left time: 89431.6050s
	iters: 1100, epoch: 1 | loss: 0.1702770
	speed: 0.1012s/iter; left time: 89217.8334s
	iters: 1200, epoch: 1 | loss: 0.1451776
	speed: 0.1018s/iter; left time: 89787.3171s
	iters: 1300, epoch: 1 | loss: 0.1586555
	speed: 0.1016s/iter; left time: 89563.7698s
	iters: 1400, epoch: 1 | loss: 0.1361702
	speed: 0.1010s/iter; left time: 89028.4687s
	iters: 1500, epoch: 1 | loss: 0.1265851
	speed: 0.1011s/iter; left time: 89137.4693s
	iters: 1600, epoch: 1 | loss: 0.1536335
	speed: 0.1005s/iter; left time: 88578.0556s
	iters: 1700, epoch: 1 | loss: 0.1587713
	speed: 0.1009s/iter; left time: 88903.0000s
	iters: 1800, epoch: 1 | loss: 0.1595028
	speed: 0.1011s/iter; left time: 89130.7038s
	iters: 1900, epoch: 1 | loss: 0.1407493
	speed: 0.1008s/iter; left time: 88846.3689s
	iters: 2000, epoch: 1 | loss: 0.1171939
	speed: 0.1011s/iter; left time: 89048.2858s
	iters: 2100, epoch: 1 | loss: 0.1555426
	speed: 0.1010s/iter; left time: 88978.0884s
	iters: 2200, epoch: 1 | loss: 0.1211075
	speed: 0.1011s/iter; left time: 89010.5356s
	iters: 2300, epoch: 1 | loss: 0.1206742
	speed: 0.1007s/iter; left time: 88677.7228s
	iters: 2400, epoch: 1 | loss: 0.1107358
	speed: 0.1016s/iter; left time: 89425.9761s
	iters: 2500, epoch: 1 | loss: 0.1312421
	speed: 0.1009s/iter; left time: 88845.2687s
	iters: 2600, epoch: 1 | loss: 0.1289618
	speed: 0.1005s/iter; left time: 88520.4400s
	iters: 2700, epoch: 1 | loss: 0.1325316
	speed: 0.1009s/iter; left time: 88811.3493s
	iters: 2800, epoch: 1 | loss: 0.1338024
	speed: 0.1010s/iter; left time: 88935.7743s
	iters: 2900, epoch: 1 | loss: 0.1243933
	speed: 0.1012s/iter; left time: 89094.8581s
	iters: 3000, epoch: 1 | loss: 0.1734885
	speed: 0.1010s/iter; left time: 88911.0029s
	iters: 3100, epoch: 1 | loss: 0.1234212
	speed: 0.1010s/iter; left time: 88862.0430s
	iters: 3200, epoch: 1 | loss: 0.1675876
	speed: 0.1012s/iter; left time: 89065.6693s
	iters: 3300, epoch: 1 | loss: 0.1312913
	speed: 0.1010s/iter; left time: 88886.3573s
	iters: 3400, epoch: 1 | loss: 0.1414418
	speed: 0.1007s/iter; left time: 88587.8451s
	iters: 3500, epoch: 1 | loss: 0.1295244
	speed: 0.1011s/iter; left time: 88876.5014s
	iters: 3600, epoch: 1 | loss: 0.1269978
	speed: 0.1011s/iter; left time: 88863.9157s
	iters: 3700, epoch: 1 | loss: 0.1271963
	speed: 0.1013s/iter; left time: 89066.5697s
	iters: 3800, epoch: 1 | loss: 0.1309070
	speed: 0.1018s/iter; left time: 89526.7705s
	iters: 3900, epoch: 1 | loss: 0.1235525
	speed: 0.1009s/iter; left time: 88717.3325s
	iters: 4000, epoch: 1 | loss: 0.1184864
	speed: 0.1017s/iter; left time: 89420.8522s
	iters: 4100, epoch: 1 | loss: 0.1478697
	speed: 0.1016s/iter; left time: 89289.5090s
	iters: 4200, epoch: 1 | loss: 0.1384279
	speed: 0.1019s/iter; left time: 89550.7108s
	iters: 4300, epoch: 1 | loss: 0.1462529
	speed: 0.1014s/iter; left time: 89096.5972s
	iters: 4400, epoch: 1 | loss: 0.1163732
	speed: 0.1014s/iter; left time: 89073.9457s
Epoch: 1 cost time: 447.20723032951355
Epoch: 1, Steps: 4415 | Train Loss: 0.1579487 Vali Loss: 0.2301475 Test Loss: 0.3141935
Validation loss decreased (inf --> 0.230148).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1040307
	speed: 4.9004s/iter; left time: 4304956.6711s
	iters: 200, epoch: 2 | loss: 0.1297523
	speed: 0.1035s/iter; left time: 90941.3522s
	iters: 300, epoch: 2 | loss: 0.1298356
	speed: 0.1030s/iter; left time: 90436.0849s
	iters: 400, epoch: 2 | loss: 0.1263380
	speed: 0.1011s/iter; left time: 88790.0998s
	iters: 500, epoch: 2 | loss: 0.1150812
	speed: 0.1002s/iter; left time: 88026.8662s
	iters: 600, epoch: 2 | loss: 0.1232308
	speed: 0.1004s/iter; left time: 88168.3405s
	iters: 700, epoch: 2 | loss: 0.1089896
	speed: 0.1006s/iter; left time: 88335.7173s
	iters: 800, epoch: 2 | loss: 0.1555521
	speed: 0.1005s/iter; left time: 88250.4543s
	iters: 900, epoch: 2 | loss: 0.1134221
	speed: 0.1005s/iter; left time: 88215.7438s
	iters: 1000, epoch: 2 | loss: 0.1170959
	speed: 0.1006s/iter; left time: 88281.5104s
	iters: 1100, epoch: 2 | loss: 0.1099104
	speed: 0.1009s/iter; left time: 88521.9451s
	iters: 1200, epoch: 2 | loss: 0.1220239
	speed: 0.1008s/iter; left time: 88402.1164s
	iters: 1300, epoch: 2 | loss: 0.1083622
	speed: 0.1006s/iter; left time: 88269.1041s
	iters: 1400, epoch: 2 | loss: 0.1178846
	speed: 0.1001s/iter; left time: 87837.2667s
	iters: 1500, epoch: 2 | loss: 0.0961034
	speed: 0.1004s/iter; left time: 88030.4133s
	iters: 1600, epoch: 2 | loss: 0.1130967
	speed: 0.1011s/iter; left time: 88647.5037s
	iters: 1700, epoch: 2 | loss: 0.1124144
	speed: 0.1005s/iter; left time: 88165.7929s
	iters: 1800, epoch: 2 | loss: 0.1293904
	speed: 0.1002s/iter; left time: 87863.6629s
	iters: 1900, epoch: 2 | loss: 0.1254063
	speed: 0.1004s/iter; left time: 88028.9642s
	iters: 2000, epoch: 2 | loss: 0.1153574
	speed: 0.1005s/iter; left time: 88054.9411s
	iters: 2100, epoch: 2 | loss: 0.1217647
	speed: 0.1002s/iter; left time: 87848.6935s
	iters: 2200, epoch: 2 | loss: 0.1198542
	speed: 0.1001s/iter; left time: 87747.4821s
	iters: 2300, epoch: 2 | loss: 0.1025075
	speed: 0.1000s/iter; left time: 87629.6300s
	iters: 2400, epoch: 2 | loss: 0.1217128
	speed: 0.1004s/iter; left time: 87931.1881s
	iters: 2500, epoch: 2 | loss: 0.1407848
	speed: 0.1004s/iter; left time: 87942.2906s
	iters: 2600, epoch: 2 | loss: 0.1086811
	speed: 0.1002s/iter; left time: 87782.4894s
	iters: 2700, epoch: 2 | loss: 0.1312616
	speed: 0.1001s/iter; left time: 87706.9363s
	iters: 2800, epoch: 2 | loss: 0.1135272
	speed: 0.1006s/iter; left time: 88073.5899s
	iters: 2900, epoch: 2 | loss: 0.1205982
	speed: 0.1004s/iter; left time: 87951.2663s
	iters: 3000, epoch: 2 | loss: 0.1073266
	speed: 0.1005s/iter; left time: 88027.5494s
	iters: 3100, epoch: 2 | loss: 0.1134116
	speed: 0.1004s/iter; left time: 87880.0708s
	iters: 3200, epoch: 2 | loss: 0.1129265
	speed: 0.1002s/iter; left time: 87724.7636s
	iters: 3300, epoch: 2 | loss: 0.1064031
	speed: 0.1002s/iter; left time: 87745.0308s
	iters: 3400, epoch: 2 | loss: 0.0998674
	speed: 0.1005s/iter; left time: 87916.4532s
	iters: 3500, epoch: 2 | loss: 0.1059093
	speed: 0.1004s/iter; left time: 87817.1759s
	iters: 3600, epoch: 2 | loss: 0.1025033
	speed: 0.1003s/iter; left time: 87734.7102s
	iters: 3700, epoch: 2 | loss: 0.1249692
	speed: 0.1008s/iter; left time: 88227.6478s
	iters: 3800, epoch: 2 | loss: 0.0877426
	speed: 0.1004s/iter; left time: 87871.6662s
	iters: 3900, epoch: 2 | loss: 0.1149958
	speed: 0.1006s/iter; left time: 87968.1859s
	iters: 4000, epoch: 2 | loss: 0.1132734
	speed: 0.1004s/iter; left time: 87764.8039s
	iters: 4100, epoch: 2 | loss: 0.1218126
	speed: 0.1007s/iter; left time: 88024.0677s
	iters: 4200, epoch: 2 | loss: 0.1011744
	speed: 0.1001s/iter; left time: 87566.7110s
	iters: 4300, epoch: 2 | loss: 0.1077214
	speed: 0.1004s/iter; left time: 87796.6719s
	iters: 4400, epoch: 2 | loss: 0.1061440
	speed: 0.1010s/iter; left time: 88249.0874s
Epoch: 2 cost time: 444.6116168498993
Epoch: 2, Steps: 4415 | Train Loss: 0.1160265 Vali Loss: 0.2417714 Test Loss: 0.3318570
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.1160040
	speed: 4.9187s/iter; left time: 4299301.5334s
	iters: 200, epoch: 3 | loss: 0.0996907
	speed: 0.1001s/iter; left time: 87463.6787s
	iters: 300, epoch: 3 | loss: 0.1022202
	speed: 0.1003s/iter; left time: 87655.0906s
	iters: 400, epoch: 3 | loss: 0.1050233
	speed: 0.1005s/iter; left time: 87814.3122s
	iters: 500, epoch: 3 | loss: 0.1112498
	speed: 0.1005s/iter; left time: 87802.5020s
	iters: 600, epoch: 3 | loss: 0.0984144
	speed: 0.1007s/iter; left time: 87945.2139s
	iters: 700, epoch: 3 | loss: 0.1046043
	speed: 0.1007s/iter; left time: 87919.9526s
	iters: 800, epoch: 3 | loss: 0.1021560
	speed: 0.1007s/iter; left time: 87939.6074s
	iters: 900, epoch: 3 | loss: 0.1011614
	speed: 0.1006s/iter; left time: 87894.4664s
	iters: 1000, epoch: 3 | loss: 0.0994680
	speed: 0.1006s/iter; left time: 87829.0526s
	iters: 1100, epoch: 3 | loss: 0.0960877
	speed: 0.1002s/iter; left time: 87471.4186s
	iters: 1200, epoch: 3 | loss: 0.1050603
	speed: 0.1001s/iter; left time: 87347.4202s
	iters: 1300, epoch: 3 | loss: 0.0975562
	speed: 0.1006s/iter; left time: 87783.7825s
	iters: 1400, epoch: 3 | loss: 0.0979542
	speed: 0.1003s/iter; left time: 87505.5459s
	iters: 1500, epoch: 3 | loss: 0.0955139
	speed: 0.1005s/iter; left time: 87677.2860s
	iters: 1600, epoch: 3 | loss: 0.1063183
	speed: 0.1002s/iter; left time: 87422.4583s
	iters: 1700, epoch: 3 | loss: 0.0952412
	speed: 0.1000s/iter; left time: 87216.2121s
	iters: 1800, epoch: 3 | loss: 0.1098582
	speed: 0.1002s/iter; left time: 87372.8651s
	iters: 1900, epoch: 3 | loss: 0.1139759
	speed: 0.1006s/iter; left time: 87790.8386s
	iters: 2000, epoch: 3 | loss: 0.1028157
	speed: 0.1002s/iter; left time: 87370.9894s
	iters: 2100, epoch: 3 | loss: 0.0925343
	speed: 0.1001s/iter; left time: 87259.3040s
	iters: 2200, epoch: 3 | loss: 0.1025554
	speed: 0.1008s/iter; left time: 87900.2415s
	iters: 2300, epoch: 3 | loss: 0.1059518
	speed: 0.1005s/iter; left time: 87595.9413s
	iters: 2400, epoch: 3 | loss: 0.0843783
	speed: 0.1006s/iter; left time: 87692.2681s
	iters: 2500, epoch: 3 | loss: 0.0934348
	speed: 0.1003s/iter; left time: 87449.9818s
	iters: 2600, epoch: 3 | loss: 0.0936427
	speed: 0.1001s/iter; left time: 87268.7108s
	iters: 2700, epoch: 3 | loss: 0.0925485
	speed: 0.1003s/iter; left time: 87370.5868s
	iters: 2800, epoch: 3 | loss: 0.1071095
	speed: 0.0999s/iter; left time: 87077.2303s
	iters: 2900, epoch: 3 | loss: 0.0908222
	speed: 0.1006s/iter; left time: 87647.2344s
	iters: 3000, epoch: 3 | loss: 0.0920806
	speed: 0.1005s/iter; left time: 87524.9899s
	iters: 3100, epoch: 3 | loss: 0.1093772
	speed: 0.1007s/iter; left time: 87759.4629s
	iters: 3200, epoch: 3 | loss: 0.1013601
	speed: 0.1006s/iter; left time: 87588.9096s
	iters: 3300, epoch: 3 | loss: 0.1044511
	speed: 0.1004s/iter; left time: 87471.3974s
	iters: 3400, epoch: 3 | loss: 0.0940567
	speed: 0.1007s/iter; left time: 87657.1962s
	iters: 3500, epoch: 3 | loss: 0.0951190
	speed: 0.1006s/iter; left time: 87578.4109s
	iters: 3600, epoch: 3 | loss: 0.0886706
	speed: 0.1005s/iter; left time: 87515.3413s
	iters: 3700, epoch: 3 | loss: 0.1064373
	speed: 0.1004s/iter; left time: 87352.1080s
	iters: 3800, epoch: 3 | loss: 0.0983049
	speed: 0.1003s/iter; left time: 87259.9250s
	iters: 3900, epoch: 3 | loss: 0.1007425
	speed: 0.1003s/iter; left time: 87309.5628s
	iters: 4000, epoch: 3 | loss: 0.0904004
	speed: 0.1006s/iter; left time: 87561.7452s
	iters: 4100, epoch: 3 | loss: 0.1009817
	speed: 0.1002s/iter; left time: 87172.7251s
	iters: 4200, epoch: 3 | loss: 0.0930840
	speed: 0.1003s/iter; left time: 87249.2489s
	iters: 4300, epoch: 3 | loss: 0.1064807
	speed: 0.1002s/iter; left time: 87193.1371s
	iters: 4400, epoch: 3 | loss: 0.0940636
	speed: 0.1010s/iter; left time: 87825.9466s
Epoch: 3 cost time: 443.62392473220825
Epoch: 3, Steps: 4415 | Train Loss: 0.0982586 Vali Loss: 0.2855199 Test Loss: 0.3756118
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.0795993
	speed: 4.8970s/iter; left time: 4258676.2117s
	iters: 200, epoch: 4 | loss: 0.0912830
	speed: 0.0996s/iter; left time: 86566.6315s
	iters: 300, epoch: 4 | loss: 0.0990653
	speed: 0.1000s/iter; left time: 86936.4251s
	iters: 400, epoch: 4 | loss: 0.0869000
	speed: 0.1004s/iter; left time: 87244.6488s
	iters: 500, epoch: 4 | loss: 0.0897708
	speed: 0.1003s/iter; left time: 87182.1798s
	iters: 600, epoch: 4 | loss: 0.0935624
	speed: 0.1003s/iter; left time: 87201.6236s
	iters: 700, epoch: 4 | loss: 0.0882360
	speed: 0.1003s/iter; left time: 87127.0088s
	iters: 800, epoch: 4 | loss: 0.0901543
	speed: 0.1003s/iter; left time: 87148.6791s
	iters: 900, epoch: 4 | loss: 0.0949288
	speed: 0.1000s/iter; left time: 86920.6956s
	iters: 1000, epoch: 4 | loss: 0.0832346
	speed: 0.1001s/iter; left time: 86991.6018s
	iters: 1100, epoch: 4 | loss: 0.0933632
	speed: 0.1004s/iter; left time: 87205.9253s
	iters: 1200, epoch: 4 | loss: 0.0991480
	speed: 0.1005s/iter; left time: 87278.0285s
	iters: 1300, epoch: 4 | loss: 0.0882697
	speed: 0.1004s/iter; left time: 87174.9185s
	iters: 1400, epoch: 4 | loss: 0.0889905
	speed: 0.1002s/iter; left time: 87022.6370s
	iters: 1500, epoch: 4 | loss: 0.0863935
	speed: 0.1003s/iter; left time: 87128.6996s
	iters: 1600, epoch: 4 | loss: 0.0829865
	speed: 0.1002s/iter; left time: 86990.8993s
	iters: 1700, epoch: 4 | loss: 0.0921734
	speed: 0.1008s/iter; left time: 87461.3321s
	iters: 1800, epoch: 4 | loss: 0.0946812
	speed: 0.1007s/iter; left time: 87364.3845s
	iters: 1900, epoch: 4 | loss: 0.0849806
	speed: 0.1003s/iter; left time: 87055.6339s
	iters: 2000, epoch: 4 | loss: 0.1008544
	speed: 0.1004s/iter; left time: 87114.2134s
	iters: 2100, epoch: 4 | loss: 0.0870123
	speed: 0.1002s/iter; left time: 86968.1604s
	iters: 2200, epoch: 4 | loss: 0.0890043
	speed: 0.1006s/iter; left time: 87308.1149s
	iters: 2300, epoch: 4 | loss: 0.0845219
	speed: 0.1009s/iter; left time: 87490.0752s
	iters: 2400, epoch: 4 | loss: 0.0847746
	speed: 0.1004s/iter; left time: 87040.9372s
	iters: 2500, epoch: 4 | loss: 0.0805457
	speed: 0.1000s/iter; left time: 86739.4081s
	iters: 2600, epoch: 4 | loss: 0.0790615
	speed: 0.1006s/iter; left time: 87262.5096s
	iters: 2700, epoch: 4 | loss: 0.0858494
	speed: 0.1002s/iter; left time: 86918.8588s
	iters: 2800, epoch: 4 | loss: 0.0874730
	speed: 0.1003s/iter; left time: 86979.7338s
	iters: 2900, epoch: 4 | loss: 0.0788945
	speed: 0.1006s/iter; left time: 87243.6172s
	iters: 3000, epoch: 4 | loss: 0.0789462
	speed: 0.1000s/iter; left time: 86683.2729s
	iters: 3100, epoch: 4 | loss: 0.0883354
	speed: 0.1004s/iter; left time: 87023.5584s
	iters: 3200, epoch: 4 | loss: 0.0757934
	speed: 0.1002s/iter; left time: 86797.0260s
	iters: 3300, epoch: 4 | loss: 0.0916118
	speed: 0.1004s/iter; left time: 87035.0906s
	iters: 3400, epoch: 4 | loss: 0.0801602
	speed: 0.1004s/iter; left time: 86945.6004s
	iters: 3500, epoch: 4 | loss: 0.0742117
	speed: 0.1004s/iter; left time: 86961.9283s
	iters: 3600, epoch: 4 | loss: 0.0948636
	speed: 0.1004s/iter; left time: 86957.1802s
	iters: 3700, epoch: 4 | loss: 0.0758625
	speed: 0.1001s/iter; left time: 86715.3957s
	iters: 3800, epoch: 4 | loss: 0.0819930
	speed: 0.1001s/iter; left time: 86694.2838s
	iters: 3900, epoch: 4 | loss: 0.0841288
	speed: 0.1006s/iter; left time: 87088.0470s
	iters: 4000, epoch: 4 | loss: 0.0838276
	speed: 0.1006s/iter; left time: 87098.8387s
	iters: 4100, epoch: 4 | loss: 0.0816087
	speed: 0.1001s/iter; left time: 86670.4722s
	iters: 4200, epoch: 4 | loss: 0.0819200
	speed: 0.0999s/iter; left time: 86506.7844s
	iters: 4300, epoch: 4 | loss: 0.0740014
	speed: 0.1002s/iter; left time: 86741.7084s
	iters: 4400, epoch: 4 | loss: 0.0719470
	speed: 0.1000s/iter; left time: 86524.7333s
Epoch: 4 cost time: 443.1275761127472
Epoch: 4, Steps: 4415 | Train Loss: 0.0869622 Vali Loss: 0.2433163 Test Loss: 0.3895426
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.0853281
	speed: 6.1928s/iter; left time: 5358225.5687s
	iters: 200, epoch: 5 | loss: 0.0811406
	speed: 0.1008s/iter; left time: 87177.1349s
	iters: 300, epoch: 5 | loss: 0.0824422
	speed: 0.1004s/iter; left time: 86835.3863s
	iters: 400, epoch: 5 | loss: 0.0849230
	speed: 0.1009s/iter; left time: 87275.2456s
	iters: 500, epoch: 5 | loss: 0.0773550
	speed: 0.1007s/iter; left time: 87077.1990s
	iters: 600, epoch: 5 | loss: 0.0744049
	speed: 0.1010s/iter; left time: 87355.2740s
	iters: 700, epoch: 5 | loss: 0.0809942
	speed: 0.1009s/iter; left time: 87270.5718s
	iters: 800, epoch: 5 | loss: 0.0902490
	speed: 0.1010s/iter; left time: 87331.6774s
	iters: 900, epoch: 5 | loss: 0.0792569
	speed: 0.1005s/iter; left time: 86881.6560s
	iters: 1000, epoch: 5 | loss: 0.0826654
	speed: 0.1010s/iter; left time: 87264.5470s
	iters: 1100, epoch: 5 | loss: 0.0796048
	speed: 0.1006s/iter; left time: 86962.4745s
	iters: 1200, epoch: 5 | loss: 0.0832582
	speed: 0.1007s/iter; left time: 87043.4556s
	iters: 1300, epoch: 5 | loss: 0.0807149
	speed: 0.1010s/iter; left time: 87251.8515s
	iters: 1400, epoch: 5 | loss: 0.0808658
	speed: 0.1006s/iter; left time: 86877.6371s
	iters: 1500, epoch: 5 | loss: 0.0871397
	speed: 0.1008s/iter; left time: 87108.1354s
	iters: 1600, epoch: 5 | loss: 0.0914330
	speed: 0.1005s/iter; left time: 86814.2836s
	iters: 1700, epoch: 5 | loss: 0.0791137
	speed: 0.1004s/iter; left time: 86698.2394s
	iters: 1800, epoch: 5 | loss: 0.0780130
	speed: 0.1007s/iter; left time: 86998.5032s
	iters: 1900, epoch: 5 | loss: 0.0733201
	speed: 0.1005s/iter; left time: 86808.1072s
	iters: 2000, epoch: 5 | loss: 0.0771371
	speed: 0.1016s/iter; left time: 87705.4571s
	iters: 2100, epoch: 5 | loss: 0.0825090
	speed: 0.1006s/iter; left time: 86855.7265s
	iters: 2200, epoch: 5 | loss: 0.0748886
	speed: 0.1013s/iter; left time: 87479.3320s
	iters: 2300, epoch: 5 | loss: 0.0812746
	speed: 0.1003s/iter; left time: 86578.8045s
	iters: 2400, epoch: 5 | loss: 0.0736709
	speed: 0.1014s/iter; left time: 87464.6068s
	iters: 2500, epoch: 5 | loss: 0.0815446
	speed: 0.1010s/iter; left time: 87180.3075s
	iters: 2600, epoch: 5 | loss: 0.0872288
	speed: 0.1009s/iter; left time: 87038.4755s
	iters: 2700, epoch: 5 | loss: 0.0802671
	speed: 0.1011s/iter; left time: 87237.9643s
	iters: 2800, epoch: 5 | loss: 0.0817870
	speed: 0.1005s/iter; left time: 86644.5412s
	iters: 2900, epoch: 5 | loss: 0.0888410
	speed: 0.1005s/iter; left time: 86688.6074s
	iters: 3000, epoch: 5 | loss: 0.0760511
	speed: 0.1014s/iter; left time: 87479.4797s
	iters: 3100, epoch: 5 | loss: 0.0977871
	speed: 0.1008s/iter; left time: 86875.9082s
	iters: 3200, epoch: 5 | loss: 0.0726081
	speed: 0.1017s/iter; left time: 87654.1576s
	iters: 3300, epoch: 5 | loss: 0.0698010
	speed: 0.1006s/iter; left time: 86742.9106s
	iters: 3400, epoch: 5 | loss: 0.0705803
	speed: 0.1005s/iter; left time: 86627.0018s
	iters: 3500, epoch: 5 | loss: 0.0769016
	speed: 0.1009s/iter; left time: 86955.9774s
	iters: 3600, epoch: 5 | loss: 0.0695053
	speed: 0.1013s/iter; left time: 87280.4385s
	iters: 3700, epoch: 5 | loss: 0.0917943
	speed: 0.1006s/iter; left time: 86703.7863s
	iters: 3800, epoch: 5 | loss: 0.0849016
	speed: 0.1003s/iter; left time: 86409.4809s
	iters: 3900, epoch: 5 | loss: 0.0752539
	speed: 0.1015s/iter; left time: 87457.6448s
	iters: 4000, epoch: 5 | loss: 0.0742396
	speed: 0.1006s/iter; left time: 86612.8612s
	iters: 4100, epoch: 5 | loss: 0.0832409
	speed: 0.1013s/iter; left time: 87284.2435s
	iters: 4200, epoch: 5 | loss: 0.0766755
	speed: 0.1010s/iter; left time: 86959.4907s
	iters: 4300, epoch: 5 | loss: 0.0777111
	speed: 0.1011s/iter; left time: 87074.5937s
	iters: 4400, epoch: 5 | loss: 0.0761080
	speed: 0.1009s/iter; left time: 86868.4002s
Epoch: 5 cost time: 445.5396041870117
Epoch: 5, Steps: 4415 | Train Loss: 0.0788611 Vali Loss: 0.2417962 Test Loss: 0.3727764
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.0768293
	speed: 4.8982s/iter; left time: 4216475.6177s
	iters: 200, epoch: 6 | loss: 0.0700469
	speed: 0.1002s/iter; left time: 86259.0935s
	iters: 300, epoch: 6 | loss: 0.0801835
	speed: 0.1003s/iter; left time: 86340.7915s
	iters: 400, epoch: 6 | loss: 0.0737702
	speed: 0.1008s/iter; left time: 86745.6979s
	iters: 500, epoch: 6 | loss: 0.0794463
	speed: 0.1005s/iter; left time: 86448.8972s
	iters: 600, epoch: 6 | loss: 0.0675514
	speed: 0.1005s/iter; left time: 86466.8219s
	iters: 700, epoch: 6 | loss: 0.0638755
	speed: 0.1005s/iter; left time: 86418.2445s
	iters: 800, epoch: 6 | loss: 0.0725753
	speed: 0.1008s/iter; left time: 86672.5522s
	iters: 900, epoch: 6 | loss: 0.0708102
	speed: 0.1023s/iter; left time: 87976.5570s
	iters: 1000, epoch: 6 | loss: 0.0812272
	speed: 0.1018s/iter; left time: 87555.6718s
	iters: 1100, epoch: 6 | loss: 0.0715790
	speed: 0.1035s/iter; left time: 88974.9938s
	iters: 1200, epoch: 6 | loss: 0.0767128
	speed: 0.1024s/iter; left time: 88046.9824s
	iters: 1300, epoch: 6 | loss: 0.0810557
	speed: 0.1030s/iter; left time: 88545.6811s
	iters: 1400, epoch: 6 | loss: 0.0748747
	speed: 0.1028s/iter; left time: 88326.0908s
	iters: 1500, epoch: 6 | loss: 0.0751996
	speed: 0.1027s/iter; left time: 88279.8255s
	iters: 1600, epoch: 6 | loss: 0.0757404
	speed: 0.1027s/iter; left time: 88267.9616s
	iters: 1700, epoch: 6 | loss: 0.0698814
	speed: 0.1029s/iter; left time: 88440.5172s
	iters: 1800, epoch: 6 | loss: 0.0719343
	speed: 0.1027s/iter; left time: 88247.8031s
	iters: 1900, epoch: 6 | loss: 0.0718049
	speed: 0.1030s/iter; left time: 88474.7909s
	iters: 2000, epoch: 6 | loss: 0.0752752
	speed: 0.1029s/iter; left time: 88388.0907s
	iters: 2100, epoch: 6 | loss: 0.0781667
	speed: 0.1027s/iter; left time: 88230.9585s
	iters: 2200, epoch: 6 | loss: 0.0835861
	speed: 0.1028s/iter; left time: 88280.9451s
	iters: 2300, epoch: 6 | loss: 0.0790427
	speed: 0.1037s/iter; left time: 89016.5649s
	iters: 2400, epoch: 6 | loss: 0.0706179
	speed: 0.1025s/iter; left time: 87982.7753s
	iters: 2500, epoch: 6 | loss: 0.0750418
	speed: 0.1038s/iter; left time: 89137.5114s
	iters: 2600, epoch: 6 | loss: 0.0765310
	speed: 0.1025s/iter; left time: 87951.4024s
	iters: 2700, epoch: 6 | loss: 0.0686703
	speed: 0.1030s/iter; left time: 88425.0175s
	iters: 2800, epoch: 6 | loss: 0.0791270
	speed: 0.1036s/iter; left time: 88922.8992s
	iters: 2900, epoch: 6 | loss: 0.0684613
	speed: 0.1026s/iter; left time: 88024.0287s
	iters: 3000, epoch: 6 | loss: 0.0738850
	speed: 0.1030s/iter; left time: 88389.6958s
	iters: 3100, epoch: 6 | loss: 0.0735132
	speed: 0.1031s/iter; left time: 88444.2551s
	iters: 3200, epoch: 6 | loss: 0.0692168
	speed: 0.1028s/iter; left time: 88176.3512s
	iters: 3300, epoch: 6 | loss: 0.0712618
	speed: 0.1033s/iter; left time: 88562.1452s
	iters: 3400, epoch: 6 | loss: 0.0670579
	speed: 0.1033s/iter; left time: 88577.1869s
	iters: 3500, epoch: 6 | loss: 0.0735589
	speed: 0.1026s/iter; left time: 87936.4355s
	iters: 3600, epoch: 6 | loss: 0.0675197
	speed: 0.1028s/iter; left time: 88156.8130s
	iters: 3700, epoch: 6 | loss: 0.0765066
	speed: 0.1036s/iter; left time: 88846.8295s
	iters: 3800, epoch: 6 | loss: 0.0732997
	speed: 0.1027s/iter; left time: 88028.7160s
	iters: 3900, epoch: 6 | loss: 0.0678454
	speed: 0.1029s/iter; left time: 88198.7862s
	iters: 4000, epoch: 6 | loss: 0.0712554
	speed: 0.1030s/iter; left time: 88276.9783s
	iters: 4100, epoch: 6 | loss: 0.0626462
	speed: 0.1027s/iter; left time: 88019.7473s
	iters: 4200, epoch: 6 | loss: 0.0663083
	speed: 0.1025s/iter; left time: 87795.7110s
	iters: 4300, epoch: 6 | loss: 0.0663164
	speed: 0.1025s/iter; left time: 87819.8237s
	iters: 4400, epoch: 6 | loss: 0.0708378
	speed: 0.1029s/iter; left time: 88104.4475s
Epoch: 6 cost time: 452.6405072212219
Epoch: 6, Steps: 4415 | Train Loss: 0.0726011 Vali Loss: 0.2441051 Test Loss: 0.3855811
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems08_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 40325
test shape: (40325, 1, 96, 212) (40325, 1, 96, 212)
test shape: (40325, 96, 212) (40325, 96, 212)
mse:0.31419292092323303, mae:0.3839896321296692
>>>>>>>Overall time: 6457 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=212, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems08_h.csv', dec_in=212, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=212, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems08_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 141281
val 20117
test 40325
	iters: 100, epoch: 1 | loss: 0.2703828
	speed: 0.1081s/iter; left time: 95444.4015s
	iters: 200, epoch: 1 | loss: 0.2434849
	speed: 0.1015s/iter; left time: 89632.8219s
	iters: 300, epoch: 1 | loss: 0.2072183
	speed: 0.1024s/iter; left time: 90401.4159s
	iters: 400, epoch: 1 | loss: 0.2005666
	speed: 0.1018s/iter; left time: 89875.6246s
	iters: 500, epoch: 1 | loss: 0.1895639
	speed: 0.1012s/iter; left time: 89334.6075s
	iters: 600, epoch: 1 | loss: 0.1806283
	speed: 0.1015s/iter; left time: 89605.6228s
	iters: 700, epoch: 1 | loss: 0.1845760
	speed: 0.1016s/iter; left time: 89653.1585s
	iters: 800, epoch: 1 | loss: 0.2003324
	speed: 0.1017s/iter; left time: 89721.6113s
	iters: 900, epoch: 1 | loss: 0.1530934
	speed: 0.1019s/iter; left time: 89907.7669s
	iters: 1000, epoch: 1 | loss: 0.1203971
	speed: 0.1013s/iter; left time: 89322.8139s
	iters: 1100, epoch: 1 | loss: 0.1702771
	speed: 0.1015s/iter; left time: 89504.2265s
	iters: 1200, epoch: 1 | loss: 0.1451780
	speed: 0.1018s/iter; left time: 89739.4480s
	iters: 1300, epoch: 1 | loss: 0.1586556
	speed: 0.1017s/iter; left time: 89693.1733s
	iters: 1400, epoch: 1 | loss: 0.1361702
	speed: 0.1015s/iter; left time: 89482.1324s
	iters: 1500, epoch: 1 | loss: 0.1265853
	speed: 0.1020s/iter; left time: 89951.9096s
	iters: 1600, epoch: 1 | loss: 0.1536331
	speed: 0.1014s/iter; left time: 89406.6323s
	iters: 1700, epoch: 1 | loss: 0.1587709
	speed: 0.1015s/iter; left time: 89418.3157s
	iters: 1800, epoch: 1 | loss: 0.1595032
	speed: 0.1014s/iter; left time: 89374.7288s
	iters: 1900, epoch: 1 | loss: 0.1407495
	speed: 0.1017s/iter; left time: 89627.0174s
	iters: 2000, epoch: 1 | loss: 0.1171950
	speed: 0.1015s/iter; left time: 89379.1728s
	iters: 2100, epoch: 1 | loss: 0.1555420
	speed: 0.1015s/iter; left time: 89401.8963s
	iters: 2200, epoch: 1 | loss: 0.1217407
	speed: 0.1013s/iter; left time: 89258.7065s
	iters: 2300, epoch: 1 | loss: 0.1203147
	speed: 0.1015s/iter; left time: 89407.7698s
	iters: 2400, epoch: 1 | loss: 0.1109468
	speed: 0.1019s/iter; left time: 89760.3262s
	iters: 2500, epoch: 1 | loss: 0.1286569
	speed: 0.1016s/iter; left time: 89458.6148s
	iters: 2600, epoch: 1 | loss: 0.1311362
	speed: 0.1019s/iter; left time: 89705.8222s
	iters: 2700, epoch: 1 | loss: 0.1325154
	speed: 0.1016s/iter; left time: 89443.6971s
	iters: 2800, epoch: 1 | loss: 0.1334015
	speed: 0.1014s/iter; left time: 89242.5820s
	iters: 2900, epoch: 1 | loss: 0.1241686
	speed: 0.1013s/iter; left time: 89139.5860s
	iters: 3000, epoch: 1 | loss: 0.1727817
	speed: 0.1014s/iter; left time: 89201.3465s
	iters: 3100, epoch: 1 | loss: 0.1235002
	speed: 0.1015s/iter; left time: 89323.9303s
	iters: 3200, epoch: 1 | loss: 0.1679972
	speed: 0.1016s/iter; left time: 89418.9696s
	iters: 3300, epoch: 1 | loss: 0.1308686
	speed: 0.1014s/iter; left time: 89215.1852s
	iters: 3400, epoch: 1 | loss: 0.1411922
	speed: 0.1016s/iter; left time: 89396.1427s
	iters: 3500, epoch: 1 | loss: 0.1289560
	speed: 0.1016s/iter; left time: 89323.6304s
	iters: 3600, epoch: 1 | loss: 0.1272882
	speed: 0.1018s/iter; left time: 89493.6965s
	iters: 3700, epoch: 1 | loss: 0.1267702
	speed: 0.1014s/iter; left time: 89137.8332s
	iters: 3800, epoch: 1 | loss: 0.1313090
	speed: 0.1015s/iter; left time: 89279.0798s
	iters: 3900, epoch: 1 | loss: 0.1230192
	speed: 0.1014s/iter; left time: 89167.1862s
	iters: 4000, epoch: 1 | loss: 0.1180654
	speed: 0.1016s/iter; left time: 89263.6578s
	iters: 4100, epoch: 1 | loss: 0.1473124
	speed: 0.1021s/iter; left time: 89718.1759s
	iters: 4200, epoch: 1 | loss: 0.1386361
	speed: 0.1014s/iter; left time: 89074.6862s
	iters: 4300, epoch: 1 | loss: 0.1461519
	speed: 0.1012s/iter; left time: 88887.4652s
	iters: 4400, epoch: 1 | loss: 0.1165517
	speed: 0.1016s/iter; left time: 89293.8356s
Epoch: 1 cost time: 449.29924964904785
Epoch: 1, Steps: 4415 | Train Loss: 0.1579302 Vali Loss: 0.2326918 Test Loss: 0.3219945
Validation loss decreased (inf --> 0.232692).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1040837
	speed: 4.9875s/iter; left time: 4381409.9573s
	iters: 200, epoch: 2 | loss: 0.1308063
	speed: 0.1037s/iter; left time: 91115.1612s
	iters: 300, epoch: 2 | loss: 0.1305561
	speed: 0.1029s/iter; left time: 90370.7521s
	iters: 400, epoch: 2 | loss: 0.1260045
	speed: 0.1015s/iter; left time: 89096.8982s
	iters: 500, epoch: 2 | loss: 0.1152914
	speed: 0.1014s/iter; left time: 88999.6078s
	iters: 600, epoch: 2 | loss: 0.1195714
	speed: 0.1013s/iter; left time: 88972.6694s
	iters: 700, epoch: 2 | loss: 0.1091019
	speed: 0.1016s/iter; left time: 89199.2484s
	iters: 800, epoch: 2 | loss: 0.1550368
	speed: 0.1016s/iter; left time: 89190.1090s
	iters: 900, epoch: 2 | loss: 0.1143599
	speed: 0.1012s/iter; left time: 88863.6568s
	iters: 1000, epoch: 2 | loss: 0.1170255
	speed: 0.1013s/iter; left time: 88935.2521s
	iters: 1100, epoch: 2 | loss: 0.1098929
	speed: 0.1015s/iter; left time: 89098.4790s
	iters: 1200, epoch: 2 | loss: 0.1207133
	speed: 0.1017s/iter; left time: 89236.3383s
	iters: 1300, epoch: 2 | loss: 0.1087792
	speed: 0.1017s/iter; left time: 89209.0247s
	iters: 1400, epoch: 2 | loss: 0.1173985
	speed: 0.1016s/iter; left time: 89101.8371s
	iters: 1500, epoch: 2 | loss: 0.0967670
	speed: 0.1016s/iter; left time: 89130.2734s
	iters: 1600, epoch: 2 | loss: 0.1134731
	speed: 0.1015s/iter; left time: 88973.7673s
	iters: 1700, epoch: 2 | loss: 0.1090705
	speed: 0.1017s/iter; left time: 89160.6038s
	iters: 1800, epoch: 2 | loss: 0.1288303
	speed: 0.1015s/iter; left time: 88987.6215s
	iters: 1900, epoch: 2 | loss: 0.1240984
	speed: 0.1016s/iter; left time: 89080.8568s
	iters: 2000, epoch: 2 | loss: 0.1165623
	speed: 0.1017s/iter; left time: 89108.0848s
	iters: 2100, epoch: 2 | loss: 0.1235243
	speed: 0.1016s/iter; left time: 89018.0153s
	iters: 2200, epoch: 2 | loss: 0.1190106
	speed: 0.1018s/iter; left time: 89233.6135s
	iters: 2300, epoch: 2 | loss: 0.1016827
	speed: 0.1016s/iter; left time: 89037.8328s
	iters: 2400, epoch: 2 | loss: 0.1190766
	speed: 0.1023s/iter; left time: 89629.3889s
	iters: 2500, epoch: 2 | loss: 0.1383735
	speed: 0.1030s/iter; left time: 90239.9427s
	iters: 2600, epoch: 2 | loss: 0.1082571
	speed: 0.1023s/iter; left time: 89652.1120s
	iters: 2700, epoch: 2 | loss: 0.1457586
	speed: 0.1019s/iter; left time: 89240.5863s
	iters: 2800, epoch: 2 | loss: 0.1123136
	speed: 0.1021s/iter; left time: 89439.3642s
	iters: 2900, epoch: 2 | loss: 0.1212708
	speed: 0.1019s/iter; left time: 89201.5149s
	iters: 3000, epoch: 2 | loss: 0.1075454
	speed: 0.1021s/iter; left time: 89368.6166s
	iters: 3100, epoch: 2 | loss: 0.1134442
	speed: 0.1016s/iter; left time: 88989.4111s
	iters: 3200, epoch: 2 | loss: 0.1117292
	speed: 0.1014s/iter; left time: 88747.1086s
	iters: 3300, epoch: 2 | loss: 0.1073474
	speed: 0.1016s/iter; left time: 88912.6850s
	iters: 3400, epoch: 2 | loss: 0.0993340
	speed: 0.1031s/iter; left time: 90228.2123s
	iters: 3500, epoch: 2 | loss: 0.1068216
	speed: 0.1036s/iter; left time: 90671.4686s
	iters: 3600, epoch: 2 | loss: 0.1019590
	speed: 0.1060s/iter; left time: 92732.3205s
	iters: 3700, epoch: 2 | loss: 0.1240577
	speed: 0.1058s/iter; left time: 92533.9004s
	iters: 3800, epoch: 2 | loss: 0.0874985
	speed: 0.1030s/iter; left time: 90095.2886s
	iters: 3900, epoch: 2 | loss: 0.1154710
	speed: 0.1012s/iter; left time: 88481.6232s
	iters: 4000, epoch: 2 | loss: 0.1191083
	speed: 0.1013s/iter; left time: 88635.4293s
	iters: 4100, epoch: 2 | loss: 0.1053142
	speed: 0.1018s/iter; left time: 88993.1756s
	iters: 4200, epoch: 2 | loss: 0.1020248
	speed: 0.1013s/iter; left time: 88542.1165s
	iters: 4300, epoch: 2 | loss: 0.1084532
	speed: 0.1014s/iter; left time: 88623.1729s
	iters: 4400, epoch: 2 | loss: 0.1074494
	speed: 0.1012s/iter; left time: 88447.4407s
Epoch: 2 cost time: 451.16551446914673
Epoch: 2, Steps: 4415 | Train Loss: 0.1155805 Vali Loss: 0.2226970 Test Loss: 0.3399339
Validation loss decreased (0.232692 --> 0.222697).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1161584
	speed: 5.0090s/iter; left time: 4378236.5880s
	iters: 200, epoch: 3 | loss: 0.1042718
	speed: 0.1014s/iter; left time: 88582.2242s
	iters: 300, epoch: 3 | loss: 0.1063684
	speed: 0.1013s/iter; left time: 88517.9538s
	iters: 400, epoch: 3 | loss: 0.1057752
	speed: 0.1014s/iter; left time: 88608.8007s
	iters: 500, epoch: 3 | loss: 0.1103809
	speed: 0.1011s/iter; left time: 88321.2737s
	iters: 600, epoch: 3 | loss: 0.0995039
	speed: 0.1014s/iter; left time: 88622.0928s
	iters: 700, epoch: 3 | loss: 0.1050647
	speed: 0.1014s/iter; left time: 88592.0454s
	iters: 800, epoch: 3 | loss: 0.1006150
	speed: 0.1013s/iter; left time: 88472.5125s
	iters: 900, epoch: 3 | loss: 0.1009049
	speed: 0.1011s/iter; left time: 88321.7323s
	iters: 1000, epoch: 3 | loss: 0.0984147
	speed: 0.1015s/iter; left time: 88647.4734s
	iters: 1100, epoch: 3 | loss: 0.0953739
	speed: 0.1017s/iter; left time: 88803.6359s
	iters: 1200, epoch: 3 | loss: 0.1028181
	speed: 0.1021s/iter; left time: 89147.6935s
	iters: 1300, epoch: 3 | loss: 0.0950113
	speed: 0.1023s/iter; left time: 89337.2950s
	iters: 1400, epoch: 3 | loss: 0.0999119
	speed: 0.1014s/iter; left time: 88529.4627s
	iters: 1500, epoch: 3 | loss: 0.0955657
	speed: 0.1012s/iter; left time: 88334.7108s
	iters: 1600, epoch: 3 | loss: 0.1061962
	speed: 0.1017s/iter; left time: 88768.3171s
	iters: 1700, epoch: 3 | loss: 0.1016179
	speed: 0.1014s/iter; left time: 88463.0355s
	iters: 1800, epoch: 3 | loss: 0.1100862
	speed: 0.1012s/iter; left time: 88266.0010s
	iters: 1900, epoch: 3 | loss: 0.1160644
	speed: 0.1012s/iter; left time: 88246.4060s
	iters: 2000, epoch: 3 | loss: 0.1021102
	speed: 0.1014s/iter; left time: 88447.2586s
	iters: 2100, epoch: 3 | loss: 0.0926885
	speed: 0.1026s/iter; left time: 89510.8951s
	iters: 2200, epoch: 3 | loss: 0.1017275
	speed: 0.1013s/iter; left time: 88332.0583s
	iters: 2300, epoch: 3 | loss: 0.1045120
	speed: 0.1014s/iter; left time: 88437.2275s
	iters: 2400, epoch: 3 | loss: 0.0840058
	speed: 0.1015s/iter; left time: 88512.2700s
	iters: 2500, epoch: 3 | loss: 0.0939394
	speed: 0.1014s/iter; left time: 88362.5432s
	iters: 2600, epoch: 3 | loss: 0.0933143
	speed: 0.1014s/iter; left time: 88391.8358s
	iters: 2700, epoch: 3 | loss: 0.0929776
	speed: 0.1013s/iter; left time: 88273.4559s
	iters: 2800, epoch: 3 | loss: 0.1073984
	speed: 0.1016s/iter; left time: 88551.4109s
	iters: 2900, epoch: 3 | loss: 0.0937237
	speed: 0.1014s/iter; left time: 88378.2471s
	iters: 3000, epoch: 3 | loss: 0.0918938
	speed: 0.1015s/iter; left time: 88400.4076s
	iters: 3100, epoch: 3 | loss: 0.1089667
	speed: 0.1013s/iter; left time: 88261.7565s
	iters: 3200, epoch: 3 | loss: 0.1049580
	speed: 0.1014s/iter; left time: 88317.0127s
	iters: 3300, epoch: 3 | loss: 0.1060039
	speed: 0.1015s/iter; left time: 88411.5107s
	iters: 3400, epoch: 3 | loss: 0.0946043
	speed: 0.1012s/iter; left time: 88158.9888s
	iters: 3500, epoch: 3 | loss: 0.0936208
	speed: 0.1012s/iter; left time: 88085.4165s
	iters: 3600, epoch: 3 | loss: 0.0892812
	speed: 0.1014s/iter; left time: 88270.5141s
	iters: 3700, epoch: 3 | loss: 0.1095310
	speed: 0.1012s/iter; left time: 88082.6198s
	iters: 3800, epoch: 3 | loss: 0.0982477
	speed: 0.1018s/iter; left time: 88627.3356s
	iters: 3900, epoch: 3 | loss: 0.1014610
	speed: 0.1014s/iter; left time: 88219.0400s
	iters: 4000, epoch: 3 | loss: 0.0889950
	speed: 0.1013s/iter; left time: 88167.2088s
	iters: 4100, epoch: 3 | loss: 0.0987264
	speed: 0.1016s/iter; left time: 88358.9002s
	iters: 4200, epoch: 3 | loss: 0.0915635
	speed: 0.1012s/iter; left time: 88009.4621s
	iters: 4300, epoch: 3 | loss: 0.1058576
	speed: 0.1013s/iter; left time: 88115.7806s
	iters: 4400, epoch: 3 | loss: 0.0932015
	speed: 0.1012s/iter; left time: 88023.1530s
Epoch: 3 cost time: 448.45067739486694
Epoch: 3, Steps: 4415 | Train Loss: 0.0982256 Vali Loss: 0.2791584 Test Loss: 0.3744728
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.0789093
	speed: 4.9913s/iter; left time: 4340704.4063s
	iters: 200, epoch: 4 | loss: 0.0922385
	speed: 0.1031s/iter; left time: 89626.3097s
	iters: 300, epoch: 4 | loss: 0.0991106
	speed: 0.1028s/iter; left time: 89370.2342s
	iters: 400, epoch: 4 | loss: 0.0875735
	speed: 0.1038s/iter; left time: 90212.2521s
	iters: 500, epoch: 4 | loss: 0.0894389
	speed: 0.1034s/iter; left time: 89891.9605s
	iters: 600, epoch: 4 | loss: 0.0931277
	speed: 0.1015s/iter; left time: 88261.3182s
	iters: 700, epoch: 4 | loss: 0.0910241
	speed: 0.1022s/iter; left time: 88793.3537s
	iters: 800, epoch: 4 | loss: 0.0903908
	speed: 0.1020s/iter; left time: 88669.0637s
	iters: 900, epoch: 4 | loss: 0.0959930
	speed: 0.1019s/iter; left time: 88562.1137s
	iters: 1000, epoch: 4 | loss: 0.0828275
	speed: 0.1013s/iter; left time: 87987.2495s
	iters: 1100, epoch: 4 | loss: 0.0919690
	speed: 0.1018s/iter; left time: 88429.7944s
	iters: 1200, epoch: 4 | loss: 0.0985269
	speed: 0.1022s/iter; left time: 88792.3250s
	iters: 1300, epoch: 4 | loss: 0.0881833
	speed: 0.1016s/iter; left time: 88250.9163s
	iters: 1400, epoch: 4 | loss: 0.0886867
	speed: 0.1022s/iter; left time: 88756.0908s
	iters: 1500, epoch: 4 | loss: 0.0875717
	speed: 0.1023s/iter; left time: 88821.7506s
	iters: 1600, epoch: 4 | loss: 0.0812515
	speed: 0.1025s/iter; left time: 89026.9398s
	iters: 1700, epoch: 4 | loss: 0.0916664
	speed: 0.1021s/iter; left time: 88654.7212s
	iters: 1800, epoch: 4 | loss: 0.0943870
	speed: 0.1026s/iter; left time: 89068.6563s
	iters: 1900, epoch: 4 | loss: 0.0874464
	speed: 0.1030s/iter; left time: 89354.2696s
	iters: 2000, epoch: 4 | loss: 0.0964021
	speed: 0.1022s/iter; left time: 88683.5876s
	iters: 2100, epoch: 4 | loss: 0.0869785
	speed: 0.1020s/iter; left time: 88459.7648s
	iters: 2200, epoch: 4 | loss: 0.0886886
	speed: 0.1022s/iter; left time: 88696.0336s
	iters: 2300, epoch: 4 | loss: 0.0850273
	speed: 0.1027s/iter; left time: 89101.1163s
	iters: 2400, epoch: 4 | loss: 0.0857772
	speed: 0.1014s/iter; left time: 87978.2114s
	iters: 2500, epoch: 4 | loss: 0.0775087
	speed: 0.1033s/iter; left time: 89599.2515s
	iters: 2600, epoch: 4 | loss: 0.0789018
	speed: 0.1034s/iter; left time: 89623.6576s
	iters: 2700, epoch: 4 | loss: 0.0866762
	speed: 0.1029s/iter; left time: 89239.8289s
	iters: 2800, epoch: 4 | loss: 0.0870267
	speed: 0.1024s/iter; left time: 88761.3833s
	iters: 2900, epoch: 4 | loss: 0.0799141
	speed: 0.1016s/iter; left time: 88107.4921s
	iters: 3000, epoch: 4 | loss: 0.0802582
	speed: 0.1019s/iter; left time: 88327.6321s
	iters: 3100, epoch: 4 | loss: 0.0886197
	speed: 0.1018s/iter; left time: 88267.5618s
	iters: 3200, epoch: 4 | loss: 0.0783782
	speed: 0.1015s/iter; left time: 87922.2172s
	iters: 3300, epoch: 4 | loss: 0.0918667
	speed: 0.1015s/iter; left time: 87977.5401s
	iters: 3400, epoch: 4 | loss: 0.0809046
	speed: 0.1015s/iter; left time: 87894.1646s
	iters: 3500, epoch: 4 | loss: 0.0737203
	speed: 0.1018s/iter; left time: 88165.9989s
	iters: 3600, epoch: 4 | loss: 0.0935632
	speed: 0.1017s/iter; left time: 88049.9858s
	iters: 3700, epoch: 4 | loss: 0.0783371
	speed: 0.1012s/iter; left time: 87609.4666s
	iters: 3800, epoch: 4 | loss: 0.0789569
	speed: 0.1016s/iter; left time: 88020.1203s
	iters: 3900, epoch: 4 | loss: 0.0828550
	speed: 0.1017s/iter; left time: 88100.8352s
	iters: 4000, epoch: 4 | loss: 0.0845409
	speed: 0.1018s/iter; left time: 88095.8742s
	iters: 4100, epoch: 4 | loss: 0.0804272
	speed: 0.1019s/iter; left time: 88167.9506s
	iters: 4200, epoch: 4 | loss: 0.0823649
	speed: 0.1015s/iter; left time: 87865.2354s
	iters: 4300, epoch: 4 | loss: 0.0742271
	speed: 0.1017s/iter; left time: 88033.3150s
	iters: 4400, epoch: 4 | loss: 0.0716063
	speed: 0.1014s/iter; left time: 87726.7626s
Epoch: 4 cost time: 451.28349137306213
Epoch: 4, Steps: 4415 | Train Loss: 0.0868817 Vali Loss: 0.2436558 Test Loss: 0.3795153
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.0858096
	speed: 5.0158s/iter; left time: 4339849.7321s
	iters: 200, epoch: 5 | loss: 0.0807115
	speed: 0.1017s/iter; left time: 88008.3629s
	iters: 300, epoch: 5 | loss: 0.0825460
	speed: 0.1017s/iter; left time: 88017.1562s
	iters: 400, epoch: 5 | loss: 0.0843239
	speed: 0.1014s/iter; left time: 87661.9249s
	iters: 500, epoch: 5 | loss: 0.0770053
	speed: 0.1017s/iter; left time: 87925.8735s
	iters: 600, epoch: 5 | loss: 0.0738522
	speed: 0.1016s/iter; left time: 87869.3267s
	iters: 700, epoch: 5 | loss: 0.0816803
	speed: 0.1015s/iter; left time: 87730.2579s
	iters: 800, epoch: 5 | loss: 0.0893208
	speed: 0.1031s/iter; left time: 89105.5194s
	iters: 900, epoch: 5 | loss: 0.0784471
	speed: 0.1028s/iter; left time: 88868.4484s
	iters: 1000, epoch: 5 | loss: 0.0827946
	speed: 0.1023s/iter; left time: 88429.0024s
	iters: 1100, epoch: 5 | loss: 0.0771074
	speed: 0.1025s/iter; left time: 88580.9091s
	iters: 1200, epoch: 5 | loss: 0.0832900
	speed: 0.1023s/iter; left time: 88365.6789s
	iters: 1300, epoch: 5 | loss: 0.0788153
	speed: 0.1038s/iter; left time: 89645.4960s
	iters: 1400, epoch: 5 | loss: 0.0786450
	speed: 0.1015s/iter; left time: 87716.2191s
	iters: 1500, epoch: 5 | loss: 0.0818345
	speed: 0.1028s/iter; left time: 88842.6349s
	iters: 1600, epoch: 5 | loss: 0.0831664
	speed: 0.1025s/iter; left time: 88509.2349s
	iters: 1700, epoch: 5 | loss: 0.0800989
	speed: 0.1012s/iter; left time: 87433.3208s
	iters: 1800, epoch: 5 | loss: 0.0775837
	speed: 0.1011s/iter; left time: 87318.1405s
	iters: 1900, epoch: 5 | loss: 0.0725042
	speed: 0.1026s/iter; left time: 88568.0858s
	iters: 2000, epoch: 5 | loss: 0.0766224
	speed: 0.1029s/iter; left time: 88843.4203s
	iters: 2100, epoch: 5 | loss: 0.0837529
	speed: 0.1027s/iter; left time: 88639.2170s
	iters: 2200, epoch: 5 | loss: 0.0752945
	speed: 0.1019s/iter; left time: 87967.3479s
	iters: 2300, epoch: 5 | loss: 0.0806068
	speed: 0.1018s/iter; left time: 87862.8378s
	iters: 2400, epoch: 5 | loss: 0.0729207
	speed: 0.1018s/iter; left time: 87858.1279s
	iters: 2500, epoch: 5 | loss: 0.0819067
	speed: 0.1015s/iter; left time: 87610.1477s
	iters: 2600, epoch: 5 | loss: 0.0882768
	speed: 0.1016s/iter; left time: 87627.1353s
	iters: 2700, epoch: 5 | loss: 0.0808293
	speed: 0.1028s/iter; left time: 88701.1660s
	iters: 2800, epoch: 5 | loss: 0.0779719
	speed: 0.1017s/iter; left time: 87708.5073s
	iters: 2900, epoch: 5 | loss: 0.0862612
	speed: 0.1027s/iter; left time: 88605.2323s
	iters: 3000, epoch: 5 | loss: 0.0752940
	speed: 0.1024s/iter; left time: 88339.1040s
	iters: 3100, epoch: 5 | loss: 0.0946598
	speed: 0.1025s/iter; left time: 88339.5497s
	iters: 3200, epoch: 5 | loss: 0.0699464
	speed: 0.1016s/iter; left time: 87602.7350s
	iters: 3300, epoch: 5 | loss: 0.0705878
	speed: 0.1019s/iter; left time: 87868.2837s
	iters: 3400, epoch: 5 | loss: 0.0705325
	speed: 0.1018s/iter; left time: 87772.4433s
	iters: 3500, epoch: 5 | loss: 0.0775507
	speed: 0.1019s/iter; left time: 87814.5916s
	iters: 3600, epoch: 5 | loss: 0.0709738
	speed: 0.1017s/iter; left time: 87614.0154s
	iters: 3700, epoch: 5 | loss: 0.0928219
	speed: 0.1021s/iter; left time: 87970.3129s
	iters: 3800, epoch: 5 | loss: 0.0841372
	speed: 0.1015s/iter; left time: 87483.8211s
	iters: 3900, epoch: 5 | loss: 0.0755712
	speed: 0.1018s/iter; left time: 87677.7872s
	iters: 4000, epoch: 5 | loss: 0.0741400
	speed: 0.1015s/iter; left time: 87408.8847s
	iters: 4100, epoch: 5 | loss: 0.0828617
	speed: 0.1016s/iter; left time: 87477.5425s
	iters: 4200, epoch: 5 | loss: 0.0761581
	speed: 0.1021s/iter; left time: 87891.4533s
	iters: 4300, epoch: 5 | loss: 0.0789106
	speed: 0.1018s/iter; left time: 87647.6802s
	iters: 4400, epoch: 5 | loss: 0.0769087
	speed: 0.1025s/iter; left time: 88229.7501s
Epoch: 5 cost time: 451.0225603580475
Epoch: 5, Steps: 4415 | Train Loss: 0.0784924 Vali Loss: 0.2332980 Test Loss: 0.3650951
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.0769611
	speed: 5.0203s/iter; left time: 4321634.6172s
	iters: 200, epoch: 6 | loss: 0.0698012
	speed: 0.1043s/iter; left time: 89782.3249s
	iters: 300, epoch: 6 | loss: 0.0798843
	speed: 0.1067s/iter; left time: 91819.6270s
	iters: 400, epoch: 6 | loss: 0.0732771
	speed: 0.1053s/iter; left time: 90582.2045s
	iters: 500, epoch: 6 | loss: 0.0784699
	speed: 0.1070s/iter; left time: 92064.2326s
	iters: 600, epoch: 6 | loss: 0.0674000
	speed: 0.1023s/iter; left time: 88050.1008s
	iters: 700, epoch: 6 | loss: 0.0639714
	speed: 0.1018s/iter; left time: 87538.8507s
	iters: 800, epoch: 6 | loss: 0.0723597
	speed: 0.1015s/iter; left time: 87315.9184s
	iters: 900, epoch: 6 | loss: 0.0707502
	speed: 0.1018s/iter; left time: 87591.2691s
	iters: 1000, epoch: 6 | loss: 0.0819728
	speed: 0.1025s/iter; left time: 88112.5022s
	iters: 1100, epoch: 6 | loss: 0.0720434
	speed: 0.1022s/iter; left time: 87838.4698s
	iters: 1200, epoch: 6 | loss: 0.0753630
	speed: 0.1018s/iter; left time: 87501.4854s
	iters: 1300, epoch: 6 | loss: 0.0815172
	speed: 0.1016s/iter; left time: 87340.4945s
	iters: 1400, epoch: 6 | loss: 0.0759804
	speed: 0.1019s/iter; left time: 87572.4206s
	iters: 1500, epoch: 6 | loss: 0.0745225
	speed: 0.1024s/iter; left time: 87994.4036s
	iters: 1600, epoch: 6 | loss: 0.0770015
	speed: 0.1019s/iter; left time: 87596.3140s
	iters: 1700, epoch: 6 | loss: 0.0695738
	speed: 0.1021s/iter; left time: 87695.5317s
	iters: 1800, epoch: 6 | loss: 0.0705273
	speed: 0.1021s/iter; left time: 87690.3007s
	iters: 1900, epoch: 6 | loss: 0.0712852
	speed: 0.1018s/iter; left time: 87485.4383s
	iters: 2000, epoch: 6 | loss: 0.0737094
	speed: 0.1024s/iter; left time: 87949.3882s
	iters: 2100, epoch: 6 | loss: 0.0762459
	speed: 0.1020s/iter; left time: 87608.4121s
	iters: 2200, epoch: 6 | loss: 0.0841223
	speed: 0.1019s/iter; left time: 87481.9087s
	iters: 2300, epoch: 6 | loss: 0.0782526
	speed: 0.1020s/iter; left time: 87556.2839s
	iters: 2400, epoch: 6 | loss: 0.0713187
	speed: 0.1017s/iter; left time: 87271.9043s
	iters: 2500, epoch: 6 | loss: 0.0749114
	speed: 0.1018s/iter; left time: 87382.9700s
	iters: 2600, epoch: 6 | loss: 0.0745191
	speed: 0.1016s/iter; left time: 87183.0251s
	iters: 2700, epoch: 6 | loss: 0.0681610
	speed: 0.1021s/iter; left time: 87640.5077s
	iters: 2800, epoch: 6 | loss: 0.0784939
	speed: 0.1020s/iter; left time: 87492.9647s
	iters: 2900, epoch: 6 | loss: 0.0693273
	speed: 0.1017s/iter; left time: 87266.9012s
	iters: 3000, epoch: 6 | loss: 0.0722462
	speed: 0.1018s/iter; left time: 87352.0078s
	iters: 3100, epoch: 6 | loss: 0.0736775
	speed: 0.1023s/iter; left time: 87771.9065s
	iters: 3200, epoch: 6 | loss: 0.0689383
	speed: 0.1021s/iter; left time: 87577.8883s
	iters: 3300, epoch: 6 | loss: 0.0712491
	speed: 0.1018s/iter; left time: 87321.0761s
	iters: 3400, epoch: 6 | loss: 0.0664681
	speed: 0.1022s/iter; left time: 87674.8340s
	iters: 3500, epoch: 6 | loss: 0.0740709
	speed: 0.1019s/iter; left time: 87331.0515s
	iters: 3600, epoch: 6 | loss: 0.0674229
	speed: 0.1022s/iter; left time: 87643.9080s
	iters: 3700, epoch: 6 | loss: 0.0769480
	speed: 0.1020s/iter; left time: 87442.8363s
	iters: 3800, epoch: 6 | loss: 0.0731502
	speed: 0.1018s/iter; left time: 87263.2378s
	iters: 3900, epoch: 6 | loss: 0.0679843
	speed: 0.1019s/iter; left time: 87361.1418s
	iters: 4000, epoch: 6 | loss: 0.0712337
	speed: 0.1024s/iter; left time: 87732.8228s
	iters: 4100, epoch: 6 | loss: 0.0616781
	speed: 0.1023s/iter; left time: 87688.0628s
	iters: 4200, epoch: 6 | loss: 0.0663834
	speed: 0.1020s/iter; left time: 87406.5110s
	iters: 4300, epoch: 6 | loss: 0.0650801
	speed: 0.1021s/iter; left time: 87463.7574s
	iters: 4400, epoch: 6 | loss: 0.0704250
	speed: 0.1021s/iter; left time: 87428.8743s
Epoch: 6 cost time: 452.39451813697815
Epoch: 6, Steps: 4415 | Train Loss: 0.0724676 Vali Loss: 0.2392357 Test Loss: 0.3804533
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.0716968
	speed: 5.0030s/iter; left time: 4284606.1500s
	iters: 200, epoch: 7 | loss: 0.0709239
	speed: 0.1029s/iter; left time: 88087.1217s
	iters: 300, epoch: 7 | loss: 0.0721800
	speed: 0.1033s/iter; left time: 88414.5993s
	iters: 400, epoch: 7 | loss: 0.0683736
	speed: 0.1031s/iter; left time: 88223.9333s
	iters: 500, epoch: 7 | loss: 0.0696428
	speed: 0.1028s/iter; left time: 87987.0975s
	iters: 600, epoch: 7 | loss: 0.0639365
	speed: 0.1028s/iter; left time: 88002.2535s
	iters: 700, epoch: 7 | loss: 0.0623202
	speed: 0.1025s/iter; left time: 87699.0481s
	iters: 800, epoch: 7 | loss: 0.0738286
	speed: 0.1029s/iter; left time: 88055.9626s
	iters: 900, epoch: 7 | loss: 0.0671601
	speed: 0.1030s/iter; left time: 88098.0414s
	iters: 1000, epoch: 7 | loss: 0.0682590
	speed: 0.1031s/iter; left time: 88214.3163s
	iters: 1100, epoch: 7 | loss: 0.0754070
	speed: 0.1029s/iter; left time: 88046.8463s
	iters: 1200, epoch: 7 | loss: 0.0703132
	speed: 0.1030s/iter; left time: 88062.7390s
	iters: 1300, epoch: 7 | loss: 0.0690965
	speed: 0.1031s/iter; left time: 88133.6802s
	iters: 1400, epoch: 7 | loss: 0.0690483
	speed: 0.1028s/iter; left time: 87947.5820s
	iters: 1500, epoch: 7 | loss: 0.0780832
	speed: 0.1027s/iter; left time: 87840.5537s
	iters: 1600, epoch: 7 | loss: 0.0672818
	speed: 0.1028s/iter; left time: 87894.3591s
	iters: 1700, epoch: 7 | loss: 0.0646010
	speed: 0.1032s/iter; left time: 88252.7308s
	iters: 1800, epoch: 7 | loss: 0.0667328
	speed: 0.1032s/iter; left time: 88211.9457s
	iters: 1900, epoch: 7 | loss: 0.0708913
	speed: 0.1028s/iter; left time: 87836.6690s
	iters: 2000, epoch: 7 | loss: 0.0687900
	speed: 0.1027s/iter; left time: 87745.9293s
	iters: 2100, epoch: 7 | loss: 0.0613928
	speed: 0.1028s/iter; left time: 87855.6791s
	iters: 2200, epoch: 7 | loss: 0.0663436
	speed: 0.1030s/iter; left time: 88012.5474s
	iters: 2300, epoch: 7 | loss: 0.0675143
	speed: 0.1029s/iter; left time: 87916.7570s
	iters: 2400, epoch: 7 | loss: 0.0604299
	speed: 0.1028s/iter; left time: 87764.9888s
	iters: 2500, epoch: 7 | loss: 0.0668459
	speed: 0.1028s/iter; left time: 87794.5621s
	iters: 2600, epoch: 7 | loss: 0.0675233
	speed: 0.1033s/iter; left time: 88204.5817s
	iters: 2700, epoch: 7 | loss: 0.0703551
	speed: 0.1029s/iter; left time: 87837.3183s
	iters: 2800, epoch: 7 | loss: 0.0722248
	speed: 0.1030s/iter; left time: 87943.5413s
	iters: 2900, epoch: 7 | loss: 0.0713149
	speed: 0.1029s/iter; left time: 87843.2612s
	iters: 3000, epoch: 7 | loss: 0.0583557
	speed: 0.1029s/iter; left time: 87823.5507s
	iters: 3100, epoch: 7 | loss: 0.0714658
	speed: 0.1026s/iter; left time: 87571.4747s
	iters: 3200, epoch: 7 | loss: 0.0672097
	speed: 0.1030s/iter; left time: 87907.1292s
	iters: 3300, epoch: 7 | loss: 0.0667746
	speed: 0.1025s/iter; left time: 87481.9759s
	iters: 3400, epoch: 7 | loss: 0.0732446
	speed: 0.1031s/iter; left time: 87960.8062s
	iters: 3500, epoch: 7 | loss: 0.0706873
	speed: 0.1033s/iter; left time: 88122.8507s
	iters: 3600, epoch: 7 | loss: 0.0646376
	speed: 0.1018s/iter; left time: 86852.1434s
	iters: 3700, epoch: 7 | loss: 0.0648854
	speed: 0.1018s/iter; left time: 86837.0907s
	iters: 3800, epoch: 7 | loss: 0.0678338
	speed: 0.1022s/iter; left time: 87164.4590s
	iters: 3900, epoch: 7 | loss: 0.0714939
	speed: 0.1023s/iter; left time: 87179.9069s
	iters: 4000, epoch: 7 | loss: 0.0661760
	speed: 0.1019s/iter; left time: 86867.0482s
	iters: 4100, epoch: 7 | loss: 0.0587639
	speed: 0.1022s/iter; left time: 87150.1509s
	iters: 4200, epoch: 7 | loss: 0.0642387
	speed: 0.1025s/iter; left time: 87352.7454s
	iters: 4300, epoch: 7 | loss: 0.0646793
	speed: 0.1020s/iter; left time: 86916.0195s
	iters: 4400, epoch: 7 | loss: 0.0643433
	speed: 0.1020s/iter; left time: 86932.6945s
Epoch: 7 cost time: 454.1641149520874
Epoch: 7, Steps: 4415 | Train Loss: 0.0679249 Vali Loss: 0.2397757 Test Loss: 0.3704190
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems08_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 40325
test shape: (40325, 1, 96, 212) (40325, 1, 96, 212)
test shape: (40325, 96, 212) (40325, 96, 212)
mse:0.33993276953697205, mae:0.4049399197101593
>>>>>>>Overall time: 7411 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=212, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems08_h.csv', dec_in=212, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=212, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems08_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 141281
val 20117
test 40325
	iters: 100, epoch: 1 | loss: 0.2737038
	speed: 0.1056s/iter; left time: 93250.2315s
	iters: 200, epoch: 1 | loss: 0.2480893
	speed: 0.1015s/iter; left time: 89601.4314s
	iters: 300, epoch: 1 | loss: 0.2082497
	speed: 0.1013s/iter; left time: 89437.1570s
	iters: 400, epoch: 1 | loss: 0.1995950
	speed: 0.1016s/iter; left time: 89691.8722s
	iters: 500, epoch: 1 | loss: 0.1884448
	speed: 0.1012s/iter; left time: 89344.6417s
	iters: 600, epoch: 1 | loss: 0.1825814
	speed: 0.1013s/iter; left time: 89381.0897s
	iters: 700, epoch: 1 | loss: 0.1829981
	speed: 0.1015s/iter; left time: 89522.5857s
	iters: 800, epoch: 1 | loss: 0.2005257
	speed: 0.1012s/iter; left time: 89283.5905s
	iters: 900, epoch: 1 | loss: 0.1542435
	speed: 0.1016s/iter; left time: 89605.4010s
	iters: 1000, epoch: 1 | loss: 0.1203897
	speed: 0.1011s/iter; left time: 89196.7562s
	iters: 1100, epoch: 1 | loss: 0.1703760
	speed: 0.1013s/iter; left time: 89322.5563s
	iters: 1200, epoch: 1 | loss: 0.1452139
	speed: 0.1016s/iter; left time: 89604.9674s
	iters: 1300, epoch: 1 | loss: 0.1586103
	speed: 0.1014s/iter; left time: 89360.8188s
	iters: 1400, epoch: 1 | loss: 0.1360408
	speed: 0.1009s/iter; left time: 88991.2714s
	iters: 1500, epoch: 1 | loss: 0.1266507
	speed: 0.1012s/iter; left time: 89178.4076s
	iters: 1600, epoch: 1 | loss: 0.1540845
	speed: 0.1011s/iter; left time: 89129.8117s
	iters: 1700, epoch: 1 | loss: 0.1598915
	speed: 0.1012s/iter; left time: 89171.5882s
	iters: 1800, epoch: 1 | loss: 0.1595569
	speed: 0.1013s/iter; left time: 89226.9293s
	iters: 1900, epoch: 1 | loss: 0.1419052
	speed: 0.1014s/iter; left time: 89320.9190s
	iters: 2000, epoch: 1 | loss: 0.1172713
	speed: 0.1014s/iter; left time: 89360.9828s
	iters: 2100, epoch: 1 | loss: 0.1561605
	speed: 0.1012s/iter; left time: 89108.8867s
	iters: 2200, epoch: 1 | loss: 0.1206893
	speed: 0.1013s/iter; left time: 89182.0042s
	iters: 2300, epoch: 1 | loss: 0.1216728
	speed: 0.1011s/iter; left time: 89001.6478s
	iters: 2400, epoch: 1 | loss: 0.1120601
	speed: 0.1013s/iter; left time: 89240.8596s
	iters: 2500, epoch: 1 | loss: 0.1293256
	speed: 0.1014s/iter; left time: 89285.0108s
	iters: 2600, epoch: 1 | loss: 0.1323308
	speed: 0.1011s/iter; left time: 89004.4387s
	iters: 2700, epoch: 1 | loss: 0.1314664
	speed: 0.1011s/iter; left time: 88981.9504s
	iters: 2800, epoch: 1 | loss: 0.1333347
	speed: 0.1017s/iter; left time: 89504.1448s
	iters: 2900, epoch: 1 | loss: 0.1249853
	speed: 0.1012s/iter; left time: 89049.0286s
	iters: 3000, epoch: 1 | loss: 0.1731097
	speed: 0.1013s/iter; left time: 89183.8547s
	iters: 3100, epoch: 1 | loss: 0.1234430
	speed: 0.1012s/iter; left time: 89050.7927s
	iters: 3200, epoch: 1 | loss: 0.1678400
	speed: 0.1013s/iter; left time: 89122.3131s
	iters: 3300, epoch: 1 | loss: 0.1307203
	speed: 0.1017s/iter; left time: 89445.1053s
	iters: 3400, epoch: 1 | loss: 0.1420329
	speed: 0.1012s/iter; left time: 88985.9667s
	iters: 3500, epoch: 1 | loss: 0.1289977
	speed: 0.1016s/iter; left time: 89360.3387s
	iters: 3600, epoch: 1 | loss: 0.1281504
	speed: 0.1014s/iter; left time: 89172.4805s
	iters: 3700, epoch: 1 | loss: 0.1278279
	speed: 0.1015s/iter; left time: 89233.9267s
	iters: 3800, epoch: 1 | loss: 0.1319828
	speed: 0.1010s/iter; left time: 88802.2537s
	iters: 3900, epoch: 1 | loss: 0.1227583
	speed: 0.1013s/iter; left time: 89045.0327s
	iters: 4000, epoch: 1 | loss: 0.1173741
	speed: 0.1014s/iter; left time: 89110.6360s
	iters: 4100, epoch: 1 | loss: 0.1464092
	speed: 0.1012s/iter; left time: 88903.1706s
	iters: 4200, epoch: 1 | loss: 0.1380942
	speed: 0.1014s/iter; left time: 89145.1025s
	iters: 4300, epoch: 1 | loss: 0.1461878
	speed: 0.1010s/iter; left time: 88787.2620s
	iters: 4400, epoch: 1 | loss: 0.1146692
	speed: 0.1013s/iter; left time: 89011.1221s
Epoch: 1 cost time: 447.807110786438
Epoch: 1, Steps: 4415 | Train Loss: 0.1580221 Vali Loss: 0.2295269 Test Loss: 0.3046620
Validation loss decreased (inf --> 0.229527).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1038673
	speed: 4.9975s/iter; left time: 4390264.8879s
	iters: 200, epoch: 2 | loss: 0.1289565
	speed: 0.1013s/iter; left time: 88997.4577s
	iters: 300, epoch: 2 | loss: 0.1307823
	speed: 0.1011s/iter; left time: 88803.0331s
	iters: 400, epoch: 2 | loss: 0.1267858
	speed: 0.1011s/iter; left time: 88825.4278s
	iters: 500, epoch: 2 | loss: 0.1165111
	speed: 0.1014s/iter; left time: 89021.9499s
	iters: 600, epoch: 2 | loss: 0.1249938
	speed: 0.1013s/iter; left time: 88966.1195s
	iters: 700, epoch: 2 | loss: 0.1089254
	speed: 0.1013s/iter; left time: 88925.7002s
	iters: 800, epoch: 2 | loss: 0.1561390
	speed: 0.1014s/iter; left time: 88990.6249s
	iters: 900, epoch: 2 | loss: 0.1121654
	speed: 0.1014s/iter; left time: 89019.0759s
	iters: 1000, epoch: 2 | loss: 0.1182210
	speed: 0.1013s/iter; left time: 88864.2071s
	iters: 1100, epoch: 2 | loss: 0.1097860
	speed: 0.1013s/iter; left time: 88899.0736s
	iters: 1200, epoch: 2 | loss: 0.1206421
	speed: 0.1017s/iter; left time: 89230.3723s
	iters: 1300, epoch: 2 | loss: 0.1076027
	speed: 0.1013s/iter; left time: 88831.5451s
	iters: 1400, epoch: 2 | loss: 0.1212795
	speed: 0.1015s/iter; left time: 89035.9044s
	iters: 1500, epoch: 2 | loss: 0.0960262
	speed: 0.1011s/iter; left time: 88699.4325s
	iters: 1600, epoch: 2 | loss: 0.1140829
	speed: 0.1010s/iter; left time: 88616.6316s
	iters: 1700, epoch: 2 | loss: 0.1093611
	speed: 0.1012s/iter; left time: 88769.3432s
	iters: 1800, epoch: 2 | loss: 0.1289248
	speed: 0.1014s/iter; left time: 88925.2684s
	iters: 1900, epoch: 2 | loss: 0.1247430
	speed: 0.1013s/iter; left time: 88837.5972s
	iters: 2000, epoch: 2 | loss: 0.1181043
	speed: 0.1014s/iter; left time: 88867.2334s
	iters: 2100, epoch: 2 | loss: 0.1199714
	speed: 0.1012s/iter; left time: 88696.1296s
	iters: 2200, epoch: 2 | loss: 0.1169275
	speed: 0.1012s/iter; left time: 88677.9803s
	iters: 2300, epoch: 2 | loss: 0.1040973
	speed: 0.1012s/iter; left time: 88651.1792s
	iters: 2400, epoch: 2 | loss: 0.1203935
	speed: 0.1012s/iter; left time: 88699.8028s
	iters: 2500, epoch: 2 | loss: 0.1394666
	speed: 0.1013s/iter; left time: 88762.7273s
	iters: 2600, epoch: 2 | loss: 0.1129563
	speed: 0.1012s/iter; left time: 88634.3564s
	iters: 2700, epoch: 2 | loss: 0.1368391
	speed: 0.1016s/iter; left time: 88960.3899s
	iters: 2800, epoch: 2 | loss: 0.1105035
	speed: 0.1018s/iter; left time: 89126.8561s
	iters: 2900, epoch: 2 | loss: 0.1228978
	speed: 0.1013s/iter; left time: 88722.2692s
	iters: 3000, epoch: 2 | loss: 0.1092478
	speed: 0.1012s/iter; left time: 88646.4086s
	iters: 3100, epoch: 2 | loss: 0.1134389
	speed: 0.1012s/iter; left time: 88611.9065s
	iters: 3200, epoch: 2 | loss: 0.1141603
	speed: 0.1015s/iter; left time: 88834.4176s
	iters: 3300, epoch: 2 | loss: 0.1080568
	speed: 0.1014s/iter; left time: 88761.2489s
	iters: 3400, epoch: 2 | loss: 0.0981940
	speed: 0.1013s/iter; left time: 88692.2700s
	iters: 3500, epoch: 2 | loss: 0.1071009
	speed: 0.1013s/iter; left time: 88647.0077s
	iters: 3600, epoch: 2 | loss: 0.1020402
	speed: 0.1017s/iter; left time: 88946.6031s
	iters: 3700, epoch: 2 | loss: 0.1272024
	speed: 0.1014s/iter; left time: 88749.4855s
	iters: 3800, epoch: 2 | loss: 0.0879696
	speed: 0.1017s/iter; left time: 88981.8089s
	iters: 3900, epoch: 2 | loss: 0.1155149
	speed: 0.1016s/iter; left time: 88896.8354s
	iters: 4000, epoch: 2 | loss: 0.1132414
	speed: 0.1013s/iter; left time: 88637.6437s
	iters: 4100, epoch: 2 | loss: 0.1048050
	speed: 0.1015s/iter; left time: 88729.1058s
	iters: 4200, epoch: 2 | loss: 0.1002941
	speed: 0.1013s/iter; left time: 88608.5621s
	iters: 4300, epoch: 2 | loss: 0.1079059
	speed: 0.1018s/iter; left time: 88973.5811s
	iters: 4400, epoch: 2 | loss: 0.1095363
	speed: 0.1012s/iter; left time: 88445.6170s
Epoch: 2 cost time: 447.83791851997375
Epoch: 2, Steps: 4415 | Train Loss: 0.1158207 Vali Loss: 0.2458684 Test Loss: 0.3467160
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.1196993
	speed: 4.9699s/iter; left time: 4344066.1753s
	iters: 200, epoch: 3 | loss: 0.1015254
	speed: 0.1018s/iter; left time: 88950.2781s
	iters: 300, epoch: 3 | loss: 0.1063434
	speed: 0.1014s/iter; left time: 88649.1812s
	iters: 400, epoch: 3 | loss: 0.1088469
	speed: 0.1015s/iter; left time: 88674.2267s
	iters: 500, epoch: 3 | loss: 0.1123205
	speed: 0.1017s/iter; left time: 88850.1751s
	iters: 600, epoch: 3 | loss: 0.0985981
	speed: 0.1020s/iter; left time: 89085.4185s
	iters: 700, epoch: 3 | loss: 0.1018581
	speed: 0.1014s/iter; left time: 88557.1695s
	iters: 800, epoch: 3 | loss: 0.1022940
	speed: 0.1016s/iter; left time: 88773.6641s
	iters: 900, epoch: 3 | loss: 0.1012365
	speed: 0.1013s/iter; left time: 88465.5492s
	iters: 1000, epoch: 3 | loss: 0.0971618
	speed: 0.1025s/iter; left time: 89458.4102s
	iters: 1100, epoch: 3 | loss: 0.0975530
	speed: 0.1022s/iter; left time: 89257.8372s
	iters: 1200, epoch: 3 | loss: 0.1027401
	speed: 0.1021s/iter; left time: 89144.2260s
	iters: 1300, epoch: 3 | loss: 0.0962714
	speed: 0.1016s/iter; left time: 88692.8719s
	iters: 1400, epoch: 3 | loss: 0.0989402
	speed: 0.1017s/iter; left time: 88778.7337s
	iters: 1500, epoch: 3 | loss: 0.0965297
	speed: 0.1020s/iter; left time: 88972.3324s
	iters: 1600, epoch: 3 | loss: 0.1075290
	speed: 0.1015s/iter; left time: 88547.7021s
	iters: 1700, epoch: 3 | loss: 0.0908252
	speed: 0.1013s/iter; left time: 88410.2334s
	iters: 1800, epoch: 3 | loss: 0.1126446
	speed: 0.1014s/iter; left time: 88451.3736s
	iters: 1900, epoch: 3 | loss: 0.1160032
	speed: 0.1016s/iter; left time: 88633.3697s
	iters: 2000, epoch: 3 | loss: 0.1032935
	speed: 0.1017s/iter; left time: 88668.0324s
	iters: 2100, epoch: 3 | loss: 0.0930235
	speed: 0.1013s/iter; left time: 88383.6743s
	iters: 2200, epoch: 3 | loss: 0.1021957
	speed: 0.1012s/iter; left time: 88231.8741s
	iters: 2300, epoch: 3 | loss: 0.1051331
	speed: 0.1017s/iter; left time: 88690.3906s
	iters: 2400, epoch: 3 | loss: 0.0849247
	speed: 0.1020s/iter; left time: 88882.0204s
	iters: 2500, epoch: 3 | loss: 0.0937909
	speed: 0.1021s/iter; left time: 88968.7075s
	iters: 2600, epoch: 3 | loss: 0.0940114
	speed: 0.1019s/iter; left time: 88819.7516s
	iters: 2700, epoch: 3 | loss: 0.0918876
	speed: 0.1013s/iter; left time: 88288.8396s
	iters: 2800, epoch: 3 | loss: 0.1210918
	speed: 0.1021s/iter; left time: 88923.4805s
	iters: 2900, epoch: 3 | loss: 0.1013754
	speed: 0.1022s/iter; left time: 89057.0082s
	iters: 3000, epoch: 3 | loss: 0.0929451
	speed: 0.1022s/iter; left time: 89014.4930s
	iters: 3100, epoch: 3 | loss: 0.1124873
	speed: 0.1022s/iter; left time: 89060.0454s
	iters: 3200, epoch: 3 | loss: 0.1008321
	speed: 0.1023s/iter; left time: 89091.9006s
	iters: 3300, epoch: 3 | loss: 0.1053063
	speed: 0.1019s/iter; left time: 88776.8286s
	iters: 3400, epoch: 3 | loss: 0.0935780
	speed: 0.1018s/iter; left time: 88607.8975s
	iters: 3500, epoch: 3 | loss: 0.0950697
	speed: 0.1018s/iter; left time: 88670.7166s
	iters: 3600, epoch: 3 | loss: 0.0919724
	speed: 0.1017s/iter; left time: 88517.2660s
	iters: 3700, epoch: 3 | loss: 0.1095457
	speed: 0.1022s/iter; left time: 88960.0362s
	iters: 3800, epoch: 3 | loss: 0.1016215
	speed: 0.1022s/iter; left time: 88926.9734s
	iters: 3900, epoch: 3 | loss: 0.0993018
	speed: 0.1014s/iter; left time: 88279.5852s
	iters: 4000, epoch: 3 | loss: 0.0912789
	speed: 0.1019s/iter; left time: 88710.7172s
	iters: 4100, epoch: 3 | loss: 0.0991511
	speed: 0.1018s/iter; left time: 88576.1139s
	iters: 4200, epoch: 3 | loss: 0.0906567
	speed: 0.1022s/iter; left time: 88926.8043s
	iters: 4300, epoch: 3 | loss: 0.1054345
	speed: 0.1018s/iter; left time: 88595.3343s
	iters: 4400, epoch: 3 | loss: 0.0917169
	speed: 0.1017s/iter; left time: 88490.5142s
Epoch: 3 cost time: 449.6773397922516
Epoch: 3, Steps: 4415 | Train Loss: 0.0986750 Vali Loss: 0.2695028 Test Loss: 0.3771887
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.0803544
	speed: 5.0047s/iter; left time: 4352329.0604s
	iters: 200, epoch: 4 | loss: 0.0922908
	speed: 0.1014s/iter; left time: 88164.3673s
	iters: 300, epoch: 4 | loss: 0.0985501
	speed: 0.1013s/iter; left time: 88035.3304s
	iters: 400, epoch: 4 | loss: 0.0865829
	speed: 0.1016s/iter; left time: 88292.5469s
	iters: 500, epoch: 4 | loss: 0.0896065
	speed: 0.1015s/iter; left time: 88198.8475s
	iters: 600, epoch: 4 | loss: 0.0936647
	speed: 0.1014s/iter; left time: 88165.3222s
	iters: 700, epoch: 4 | loss: 0.0895151
	speed: 0.1012s/iter; left time: 87974.2169s
	iters: 800, epoch: 4 | loss: 0.0906884
	speed: 0.1014s/iter; left time: 88079.4118s
	iters: 900, epoch: 4 | loss: 0.0966315
	speed: 0.1013s/iter; left time: 88020.0813s
	iters: 1000, epoch: 4 | loss: 0.0831600
	speed: 0.1012s/iter; left time: 87914.4877s
	iters: 1100, epoch: 4 | loss: 0.0939265
	speed: 0.1013s/iter; left time: 88002.4607s
	iters: 1200, epoch: 4 | loss: 0.0979253
	speed: 0.1015s/iter; left time: 88174.2350s
	iters: 1300, epoch: 4 | loss: 0.0939904
	speed: 0.1013s/iter; left time: 87958.6815s
	iters: 1400, epoch: 4 | loss: 0.0888252
	speed: 0.1011s/iter; left time: 87831.9549s
	iters: 1500, epoch: 4 | loss: 0.0890902
	speed: 0.1013s/iter; left time: 87982.2882s
	iters: 1600, epoch: 4 | loss: 0.0818980
	speed: 0.1013s/iter; left time: 87955.2609s
	iters: 1700, epoch: 4 | loss: 0.0901877
	speed: 0.1013s/iter; left time: 87922.5047s
	iters: 1800, epoch: 4 | loss: 0.0919131
	speed: 0.1012s/iter; left time: 87848.8878s
	iters: 1900, epoch: 4 | loss: 0.0854157
	speed: 0.1012s/iter; left time: 87830.8831s
	iters: 2000, epoch: 4 | loss: 0.0966030
	speed: 0.1012s/iter; left time: 87836.6227s
	iters: 2100, epoch: 4 | loss: 0.0898823
	speed: 0.1013s/iter; left time: 87907.3145s
	iters: 2200, epoch: 4 | loss: 0.0887068
	speed: 0.1012s/iter; left time: 87834.8533s
	iters: 2300, epoch: 4 | loss: 0.0858155
	speed: 0.1017s/iter; left time: 88230.9518s
	iters: 2400, epoch: 4 | loss: 0.0867753
	speed: 0.1016s/iter; left time: 88130.4096s
	iters: 2500, epoch: 4 | loss: 0.0784022
	speed: 0.1017s/iter; left time: 88159.4958s
	iters: 2600, epoch: 4 | loss: 0.0797397
	speed: 0.1014s/iter; left time: 87966.8274s
	iters: 2700, epoch: 4 | loss: 0.0885504
	speed: 0.1014s/iter; left time: 87884.0699s
	iters: 2800, epoch: 4 | loss: 0.0875606
	speed: 0.1012s/iter; left time: 87722.4509s
	iters: 2900, epoch: 4 | loss: 0.0808024
	speed: 0.1014s/iter; left time: 87867.2846s
	iters: 3000, epoch: 4 | loss: 0.0810283
	speed: 0.1017s/iter; left time: 88130.0823s
	iters: 3100, epoch: 4 | loss: 0.0877336
	speed: 0.1013s/iter; left time: 87807.2012s
	iters: 3200, epoch: 4 | loss: 0.0772015
	speed: 0.1022s/iter; left time: 88578.1736s
	iters: 3300, epoch: 4 | loss: 0.0928510
	speed: 0.1014s/iter; left time: 87823.8307s
	iters: 3400, epoch: 4 | loss: 0.0820087
	speed: 0.1014s/iter; left time: 87864.2657s
	iters: 3500, epoch: 4 | loss: 0.0742802
	speed: 0.1015s/iter; left time: 87883.3212s
	iters: 3600, epoch: 4 | loss: 0.0945586
	speed: 0.1014s/iter; left time: 87785.3937s
	iters: 3700, epoch: 4 | loss: 0.0788693
	speed: 0.1040s/iter; left time: 90087.0146s
	iters: 3800, epoch: 4 | loss: 0.0807112
	speed: 0.1016s/iter; left time: 87959.4211s
	iters: 3900, epoch: 4 | loss: 0.0828002
	speed: 0.1012s/iter; left time: 87654.8051s
	iters: 4000, epoch: 4 | loss: 0.0856952
	speed: 0.1013s/iter; left time: 87687.9580s
	iters: 4100, epoch: 4 | loss: 0.0809163
	speed: 0.1028s/iter; left time: 88990.8627s
	iters: 4200, epoch: 4 | loss: 0.0829534
	speed: 0.1013s/iter; left time: 87721.0195s
	iters: 4300, epoch: 4 | loss: 0.0747775
	speed: 0.1013s/iter; left time: 87673.6795s
	iters: 4400, epoch: 4 | loss: 0.0717155
	speed: 0.1016s/iter; left time: 87884.8365s
Epoch: 4 cost time: 448.3536114692688
Epoch: 4, Steps: 4415 | Train Loss: 0.0872579 Vali Loss: 0.2596155 Test Loss: 0.3854347
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.0849876
	speed: 4.9878s/iter; left time: 4315646.0127s
	iters: 200, epoch: 5 | loss: 0.0825591
	speed: 0.1013s/iter; left time: 87612.5947s
	iters: 300, epoch: 5 | loss: 0.0828720
	speed: 0.1032s/iter; left time: 89294.1418s
	iters: 400, epoch: 5 | loss: 0.0853156
	speed: 0.1044s/iter; left time: 90342.1465s
	iters: 500, epoch: 5 | loss: 0.0757861
	speed: 0.1038s/iter; left time: 89776.5197s
	iters: 600, epoch: 5 | loss: 0.0731512
	speed: 0.1023s/iter; left time: 88467.7299s
	iters: 700, epoch: 5 | loss: 0.0816097
	speed: 0.1025s/iter; left time: 88628.3680s
	iters: 800, epoch: 5 | loss: 0.0898029
	speed: 0.1019s/iter; left time: 88088.4526s
	iters: 900, epoch: 5 | loss: 0.0794782
	speed: 0.1023s/iter; left time: 88432.5000s
	iters: 1000, epoch: 5 | loss: 0.0845246
	speed: 0.1023s/iter; left time: 88410.1836s
	iters: 1100, epoch: 5 | loss: 0.0779399
	speed: 0.1021s/iter; left time: 88251.1552s
	iters: 1200, epoch: 5 | loss: 0.0840392
	speed: 0.1022s/iter; left time: 88293.7342s
	iters: 1300, epoch: 5 | loss: 0.0798064
	speed: 0.1025s/iter; left time: 88527.0106s
	iters: 1400, epoch: 5 | loss: 0.0794872
	speed: 0.1020s/iter; left time: 88130.3308s
	iters: 1500, epoch: 5 | loss: 0.0834696
	speed: 0.1019s/iter; left time: 88066.2518s
	iters: 1600, epoch: 5 | loss: 0.0768036
	speed: 0.1023s/iter; left time: 88389.0984s
	iters: 1700, epoch: 5 | loss: 0.0789035
	speed: 0.1025s/iter; left time: 88535.8535s
	iters: 1800, epoch: 5 | loss: 0.0773880
	speed: 0.1022s/iter; left time: 88291.6352s
	iters: 1900, epoch: 5 | loss: 0.0731450
	speed: 0.1024s/iter; left time: 88386.1382s
	iters: 2000, epoch: 5 | loss: 0.0800274
	speed: 0.1019s/iter; left time: 88013.1765s
	iters: 2100, epoch: 5 | loss: 0.0829698
	speed: 0.1023s/iter; left time: 88270.3760s
	iters: 2200, epoch: 5 | loss: 0.0753429
	speed: 0.1025s/iter; left time: 88453.5282s
	iters: 2300, epoch: 5 | loss: 0.0808184
	speed: 0.1021s/iter; left time: 88134.6061s
	iters: 2400, epoch: 5 | loss: 0.0726875
	speed: 0.1024s/iter; left time: 88332.5567s
	iters: 2500, epoch: 5 | loss: 0.0834574
	speed: 0.1032s/iter; left time: 89053.7670s
	iters: 2600, epoch: 5 | loss: 0.0898229
	speed: 0.1022s/iter; left time: 88157.8306s
	iters: 2700, epoch: 5 | loss: 0.0814285
	speed: 0.1028s/iter; left time: 88674.7621s
	iters: 2800, epoch: 5 | loss: 0.0796143
	speed: 0.1022s/iter; left time: 88108.6159s
	iters: 2900, epoch: 5 | loss: 0.0865196
	speed: 0.1027s/iter; left time: 88613.1775s
	iters: 3000, epoch: 5 | loss: 0.0759455
	speed: 0.1024s/iter; left time: 88311.9876s
	iters: 3100, epoch: 5 | loss: 0.0923292
	speed: 0.1027s/iter; left time: 88572.1488s
	iters: 3200, epoch: 5 | loss: 0.0718940
	speed: 0.1027s/iter; left time: 88500.1949s
	iters: 3300, epoch: 5 | loss: 0.0706955
	speed: 0.1027s/iter; left time: 88510.8626s
	iters: 3400, epoch: 5 | loss: 0.0710453
	speed: 0.1022s/iter; left time: 88114.6773s
	iters: 3500, epoch: 5 | loss: 0.0773734
	speed: 0.1026s/iter; left time: 88401.4743s
	iters: 3600, epoch: 5 | loss: 0.0707991
	speed: 0.1028s/iter; left time: 88576.7018s
	iters: 3700, epoch: 5 | loss: 0.0917102
	speed: 0.1024s/iter; left time: 88258.7219s
	iters: 3800, epoch: 5 | loss: 0.0844805
	speed: 0.1023s/iter; left time: 88122.3176s
	iters: 3900, epoch: 5 | loss: 0.0765303
	speed: 0.1022s/iter; left time: 87996.2323s
	iters: 4000, epoch: 5 | loss: 0.0750969
	speed: 0.1020s/iter; left time: 87871.7223s
	iters: 4100, epoch: 5 | loss: 0.0844988
	speed: 0.1023s/iter; left time: 88108.9400s
	iters: 4200, epoch: 5 | loss: 0.0753267
	speed: 0.1025s/iter; left time: 88308.7253s
	iters: 4300, epoch: 5 | loss: 0.0781157
	speed: 0.1018s/iter; left time: 87621.2535s
	iters: 4400, epoch: 5 | loss: 0.0763003
	speed: 0.1025s/iter; left time: 88278.9602s
Epoch: 5 cost time: 452.43503046035767
Epoch: 5, Steps: 4415 | Train Loss: 0.0787700 Vali Loss: 0.2382360 Test Loss: 0.3720364
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.0778463
	speed: 4.9927s/iter; left time: 4297864.4660s
	iters: 200, epoch: 6 | loss: 0.0704519
	speed: 0.1015s/iter; left time: 87379.9181s
	iters: 300, epoch: 6 | loss: 0.0807673
	speed: 0.1013s/iter; left time: 87221.5211s
	iters: 400, epoch: 6 | loss: 0.0748571
	speed: 0.1013s/iter; left time: 87185.7469s
	iters: 500, epoch: 6 | loss: 0.0790848
	speed: 0.1012s/iter; left time: 87099.9036s
	iters: 600, epoch: 6 | loss: 0.0677550
	speed: 0.1012s/iter; left time: 87085.5820s
	iters: 700, epoch: 6 | loss: 0.0655267
	speed: 0.1012s/iter; left time: 87013.4905s
	iters: 800, epoch: 6 | loss: 0.0724126
	speed: 0.1015s/iter; left time: 87266.2915s
	iters: 900, epoch: 6 | loss: 0.0711331
	speed: 0.1012s/iter; left time: 87002.9649s
	iters: 1000, epoch: 6 | loss: 0.0810408
	speed: 0.1009s/iter; left time: 86743.0494s
	iters: 1100, epoch: 6 | loss: 0.0712222
	speed: 0.1013s/iter; left time: 87129.1053s
	iters: 1200, epoch: 6 | loss: 0.0763464
	speed: 0.1012s/iter; left time: 87024.1343s
	iters: 1300, epoch: 6 | loss: 0.0817052
	speed: 0.1015s/iter; left time: 87244.5878s
	iters: 1400, epoch: 6 | loss: 0.0762483
	speed: 0.1010s/iter; left time: 86849.0592s
	iters: 1500, epoch: 6 | loss: 0.0748143
	speed: 0.1012s/iter; left time: 86971.9882s
	iters: 1600, epoch: 6 | loss: 0.0758264
	speed: 0.1014s/iter; left time: 87100.3402s
	iters: 1700, epoch: 6 | loss: 0.0706980
	speed: 0.1015s/iter; left time: 87186.4659s
	iters: 1800, epoch: 6 | loss: 0.0699558
	speed: 0.1012s/iter; left time: 86951.6431s
	iters: 1900, epoch: 6 | loss: 0.0727617
	speed: 0.1012s/iter; left time: 86912.9105s
	iters: 2000, epoch: 6 | loss: 0.0748077
	speed: 0.1012s/iter; left time: 86886.0232s
	iters: 2100, epoch: 6 | loss: 0.0791234
	speed: 0.1012s/iter; left time: 86932.4213s
	iters: 2200, epoch: 6 | loss: 0.0828342
	speed: 0.1011s/iter; left time: 86827.5860s
	iters: 2300, epoch: 6 | loss: 0.0787608
	speed: 0.1015s/iter; left time: 87116.8360s
	iters: 2400, epoch: 6 | loss: 0.0708841
	speed: 0.1011s/iter; left time: 86772.7937s
	iters: 2500, epoch: 6 | loss: 0.0743837
	speed: 0.1014s/iter; left time: 87007.1360s
	iters: 2600, epoch: 6 | loss: 0.0734354
	speed: 0.1012s/iter; left time: 86862.8726s
	iters: 2700, epoch: 6 | loss: 0.0681494
	speed: 0.1011s/iter; left time: 86730.0253s
	iters: 2800, epoch: 6 | loss: 0.0798137
	speed: 0.1013s/iter; left time: 86906.8400s
	iters: 2900, epoch: 6 | loss: 0.0698984
	speed: 0.1011s/iter; left time: 86708.1221s
	iters: 3000, epoch: 6 | loss: 0.0720989
	speed: 0.1013s/iter; left time: 86933.8371s
	iters: 3100, epoch: 6 | loss: 0.0744473
	speed: 0.1013s/iter; left time: 86887.9925s
	iters: 3200, epoch: 6 | loss: 0.0696939
	speed: 0.1014s/iter; left time: 86986.6422s
	iters: 3300, epoch: 6 | loss: 0.0720142
	speed: 0.1016s/iter; left time: 87107.8936s
	iters: 3400, epoch: 6 | loss: 0.0680121
	speed: 0.1015s/iter; left time: 87076.9727s
	iters: 3500, epoch: 6 | loss: 0.0735431
	speed: 0.1015s/iter; left time: 87018.2221s
	iters: 3600, epoch: 6 | loss: 0.0694260
	speed: 0.1016s/iter; left time: 87144.5344s
	iters: 3700, epoch: 6 | loss: 0.0775857
	speed: 0.1012s/iter; left time: 86773.2266s
	iters: 3800, epoch: 6 | loss: 0.0727162
	speed: 0.1013s/iter; left time: 86825.3199s
	iters: 3900, epoch: 6 | loss: 0.0680538
	speed: 0.1015s/iter; left time: 86958.7816s
	iters: 4000, epoch: 6 | loss: 0.0709485
	speed: 0.1013s/iter; left time: 86827.1274s
	iters: 4100, epoch: 6 | loss: 0.0623845
	speed: 0.1012s/iter; left time: 86712.8882s
	iters: 4200, epoch: 6 | loss: 0.0673552
	speed: 0.1012s/iter; left time: 86737.4083s
	iters: 4300, epoch: 6 | loss: 0.0650890
	speed: 0.1014s/iter; left time: 86877.8363s
	iters: 4400, epoch: 6 | loss: 0.0718494
	speed: 0.1012s/iter; left time: 86682.8236s
Epoch: 6 cost time: 447.5583086013794
Epoch: 6, Steps: 4415 | Train Loss: 0.0728176 Vali Loss: 0.2456922 Test Loss: 0.3821454
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems08_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 40325
test shape: (40325, 1, 96, 212) (40325, 1, 96, 212)
test shape: (40325, 96, 212) (40325, 96, 212)
mse:0.3046613335609436, mae:0.3767346739768982
>>>>>>>Overall time: 6406 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
