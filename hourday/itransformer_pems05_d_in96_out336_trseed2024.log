Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=103, checkpoints='./checkpoints/', d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems05_d.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems05_d_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_d_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 2646
val 106
test 544
	iters: 100, epoch: 1 | loss: 0.9037249
	speed: 0.0368s/iter; left time: 57.0112s
Epoch: 1 cost time: 5.7639312744140625
Epoch: 1, Steps: 165 | Train Loss: 0.9009532 Vali Loss: 0.8071490 Test Loss: 0.8041930
Validation loss decreased (inf --> 0.807149).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.9271411
	speed: 0.0915s/iter; left time: 126.8578s
Epoch: 2 cost time: 5.654606580734253
Epoch: 2, Steps: 165 | Train Loss: 0.8766069 Vali Loss: 0.7819504 Test Loss: 0.7871784
Validation loss decreased (0.807149 --> 0.781950).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.8398066
	speed: 0.0941s/iter; left time: 114.8774s
Epoch: 3 cost time: 5.725789546966553
Epoch: 3, Steps: 165 | Train Loss: 0.8308182 Vali Loss: 0.8167100 Test Loss: 0.7432315
EarlyStopping counter: 1 out of 3
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.7370575
	speed: 0.0907s/iter; left time: 95.7848s
Epoch: 4 cost time: 5.575717210769653
Epoch: 4, Steps: 165 | Train Loss: 0.7715606 Vali Loss: 0.8011045 Test Loss: 0.7271741
EarlyStopping counter: 2 out of 3
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.6382574
	speed: 0.0895s/iter; left time: 79.7161s
Epoch: 5 cost time: 5.634213209152222
Epoch: 5, Steps: 165 | Train Loss: 0.7369971 Vali Loss: 0.9074356 Test Loss: 0.7165559
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems05_d_96_336_iTransformer_custom_ftM_sl96_ll48_pl336_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 544
test shape: (544, 1, 336, 103) (544, 1, 336, 103)
test shape: (544, 336, 103) (544, 336, 103)
mse:0.7871777415275574, mae:0.5823413729667664
>>>>>>>Overall time: 53 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
