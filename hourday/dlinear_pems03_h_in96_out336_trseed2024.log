Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=151, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems03_h.csv', dec_in=151, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=151, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems03_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems03_h_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 133364
val 18779
test 37892
	iters: 100, epoch: 1 | loss: 0.3199069
	speed: 0.0177s/iter; left time: 14728.2131s
	iters: 200, epoch: 1 | loss: 0.3009205
	speed: 0.0105s/iter; left time: 8713.1569s
	iters: 300, epoch: 1 | loss: 0.2578957
	speed: 0.0109s/iter; left time: 9079.1853s
	iters: 400, epoch: 1 | loss: 0.2216788
	speed: 0.0109s/iter; left time: 9045.9675s
	iters: 500, epoch: 1 | loss: 0.2578936
	speed: 0.0108s/iter; left time: 9026.8526s
	iters: 600, epoch: 1 | loss: 0.2849321
	speed: 0.0108s/iter; left time: 9035.1287s
	iters: 700, epoch: 1 | loss: 0.2795088
	speed: 0.0109s/iter; left time: 9039.7814s
	iters: 800, epoch: 1 | loss: 0.2690101
	speed: 0.0109s/iter; left time: 9046.9438s
	iters: 900, epoch: 1 | loss: 0.2526131
	speed: 0.0109s/iter; left time: 9051.6172s
	iters: 1000, epoch: 1 | loss: 0.2485474
	speed: 0.0109s/iter; left time: 9057.8789s
	iters: 1100, epoch: 1 | loss: 0.2730891
	speed: 0.0109s/iter; left time: 9046.3133s
	iters: 1200, epoch: 1 | loss: 0.2546909
	speed: 0.0109s/iter; left time: 9055.9287s
	iters: 1300, epoch: 1 | loss: 0.2887717
	speed: 0.0109s/iter; left time: 9052.8507s
	iters: 1400, epoch: 1 | loss: 0.2371650
	speed: 0.0109s/iter; left time: 9055.8252s
	iters: 1500, epoch: 1 | loss: 0.2458164
	speed: 0.0109s/iter; left time: 9055.8078s
	iters: 1600, epoch: 1 | loss: 0.3287086
	speed: 0.0109s/iter; left time: 9059.9469s
	iters: 1700, epoch: 1 | loss: 0.2948241
	speed: 0.0109s/iter; left time: 9086.1587s
	iters: 1800, epoch: 1 | loss: 0.2496502
	speed: 0.0109s/iter; left time: 9042.6941s
	iters: 1900, epoch: 1 | loss: 0.2146189
	speed: 0.0109s/iter; left time: 9043.9084s
	iters: 2000, epoch: 1 | loss: 0.2312122
	speed: 0.0109s/iter; left time: 9046.1211s
	iters: 2100, epoch: 1 | loss: 0.2132418
	speed: 0.0107s/iter; left time: 8871.6081s
	iters: 2200, epoch: 1 | loss: 0.2795269
	speed: 0.0104s/iter; left time: 8662.8172s
	iters: 2300, epoch: 1 | loss: 0.2295939
	speed: 0.0104s/iter; left time: 8664.8007s
	iters: 2400, epoch: 1 | loss: 0.2576758
	speed: 0.0105s/iter; left time: 8756.7962s
	iters: 2500, epoch: 1 | loss: 0.2354096
	speed: 0.0109s/iter; left time: 9032.9568s
	iters: 2600, epoch: 1 | loss: 0.2783541
	speed: 0.0109s/iter; left time: 9042.0390s
	iters: 2700, epoch: 1 | loss: 0.2426923
	speed: 0.0109s/iter; left time: 9037.6729s
	iters: 2800, epoch: 1 | loss: 0.2887457
	speed: 0.0109s/iter; left time: 9032.0262s
	iters: 2900, epoch: 1 | loss: 0.2562183
	speed: 0.0109s/iter; left time: 9026.3411s
	iters: 3000, epoch: 1 | loss: 0.2919206
	speed: 0.0109s/iter; left time: 9018.5624s
	iters: 3100, epoch: 1 | loss: 0.2456703
	speed: 0.0109s/iter; left time: 9029.5202s
	iters: 3200, epoch: 1 | loss: 0.2731056
	speed: 0.0109s/iter; left time: 9057.5490s
	iters: 3300, epoch: 1 | loss: 0.2572766
	speed: 0.0109s/iter; left time: 9027.6441s
	iters: 3400, epoch: 1 | loss: 0.2630600
	speed: 0.0109s/iter; left time: 9020.9583s
	iters: 3500, epoch: 1 | loss: 0.2308041
	speed: 0.0108s/iter; left time: 8993.0173s
	iters: 3600, epoch: 1 | loss: 0.2688354
	speed: 0.0105s/iter; left time: 8718.8097s
	iters: 3700, epoch: 1 | loss: 0.2921663
	speed: 0.0105s/iter; left time: 8717.4583s
	iters: 3800, epoch: 1 | loss: 0.2712682
	speed: 0.0106s/iter; left time: 8770.0687s
	iters: 3900, epoch: 1 | loss: 0.2564943
	speed: 0.0106s/iter; left time: 8779.5190s
	iters: 4000, epoch: 1 | loss: 0.3039166
	speed: 0.0106s/iter; left time: 8755.3442s
	iters: 4100, epoch: 1 | loss: 0.2576951
	speed: 0.0106s/iter; left time: 8764.4297s
Epoch: 1 cost time: 45.706717014312744
Epoch: 1, Steps: 4167 | Train Loss: 0.2587496 Vali Loss: 0.2176996 Test Loss: 0.1666371
Validation loss decreased (inf --> 0.217700).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2374476
	speed: 0.8749s/iter; left time: 725412.2782s
	iters: 200, epoch: 2 | loss: 0.2510724
	speed: 0.0106s/iter; left time: 8777.2189s
	iters: 300, epoch: 2 | loss: 0.2188098
	speed: 0.0104s/iter; left time: 8631.9630s
	iters: 400, epoch: 2 | loss: 0.2583616
	speed: 0.0106s/iter; left time: 8779.4548s
	iters: 500, epoch: 2 | loss: 0.2542395
	speed: 0.0103s/iter; left time: 8533.7174s
	iters: 600, epoch: 2 | loss: 0.2487557
	speed: 0.0103s/iter; left time: 8558.3252s
	iters: 700, epoch: 2 | loss: 0.2725348
	speed: 0.0103s/iter; left time: 8573.4609s
	iters: 800, epoch: 2 | loss: 0.2800592
	speed: 0.0104s/iter; left time: 8583.9767s
	iters: 900, epoch: 2 | loss: 0.2338268
	speed: 0.0104s/iter; left time: 8579.0204s
	iters: 1000, epoch: 2 | loss: 0.2992335
	speed: 0.0103s/iter; left time: 8566.9522s
	iters: 1100, epoch: 2 | loss: 0.2468389
	speed: 0.0103s/iter; left time: 8563.0372s
	iters: 1200, epoch: 2 | loss: 0.2734084
	speed: 0.0103s/iter; left time: 8568.3561s
	iters: 1300, epoch: 2 | loss: 0.2788051
	speed: 0.0104s/iter; left time: 8571.6147s
	iters: 1400, epoch: 2 | loss: 0.2496814
	speed: 0.0103s/iter; left time: 8561.0365s
	iters: 1500, epoch: 2 | loss: 0.2743841
	speed: 0.0104s/iter; left time: 8587.1415s
	iters: 1600, epoch: 2 | loss: 0.2319495
	speed: 0.0104s/iter; left time: 8579.6812s
	iters: 1700, epoch: 2 | loss: 0.2637927
	speed: 0.0104s/iter; left time: 8580.5209s
	iters: 1800, epoch: 2 | loss: 0.2903150
	speed: 0.0104s/iter; left time: 8586.7279s
	iters: 1900, epoch: 2 | loss: 0.2119091
	speed: 0.0104s/iter; left time: 8583.4573s
	iters: 2000, epoch: 2 | loss: 0.2544346
	speed: 0.0104s/iter; left time: 8580.2760s
	iters: 2100, epoch: 2 | loss: 0.2368013
	speed: 0.0104s/iter; left time: 8592.3903s
	iters: 2200, epoch: 2 | loss: 0.2999223
	speed: 0.0104s/iter; left time: 8582.2338s
	iters: 2300, epoch: 2 | loss: 0.2626070
	speed: 0.0104s/iter; left time: 8585.8234s
	iters: 2400, epoch: 2 | loss: 0.2645424
	speed: 0.0104s/iter; left time: 8580.5566s
	iters: 2500, epoch: 2 | loss: 0.2679861
	speed: 0.0104s/iter; left time: 8593.7856s
	iters: 2600, epoch: 2 | loss: 0.2464081
	speed: 0.0104s/iter; left time: 8587.7500s
	iters: 2700, epoch: 2 | loss: 0.2150224
	speed: 0.0104s/iter; left time: 8577.4453s
	iters: 2800, epoch: 2 | loss: 0.2484464
	speed: 0.0104s/iter; left time: 8579.7749s
	iters: 2900, epoch: 2 | loss: 0.2717471
	speed: 0.0104s/iter; left time: 8599.9236s
	iters: 3000, epoch: 2 | loss: 0.2190938
	speed: 0.0104s/iter; left time: 8596.8204s
	iters: 3100, epoch: 2 | loss: 0.1989804
	speed: 0.0104s/iter; left time: 8572.4119s
	iters: 3200, epoch: 2 | loss: 0.2602570
	speed: 0.0104s/iter; left time: 8603.6313s
	iters: 3300, epoch: 2 | loss: 0.2449942
	speed: 0.0104s/iter; left time: 8571.5456s
	iters: 3400, epoch: 2 | loss: 0.2335131
	speed: 0.0104s/iter; left time: 8573.2919s
	iters: 3500, epoch: 2 | loss: 0.2452287
	speed: 0.0104s/iter; left time: 8559.8490s
	iters: 3600, epoch: 2 | loss: 0.2447365
	speed: 0.0104s/iter; left time: 8568.3948s
	iters: 3700, epoch: 2 | loss: 0.2327726
	speed: 0.0104s/iter; left time: 8578.0110s
	iters: 3800, epoch: 2 | loss: 0.2407895
	speed: 0.0104s/iter; left time: 8570.1667s
	iters: 3900, epoch: 2 | loss: 0.2592790
	speed: 0.0104s/iter; left time: 8567.7470s
	iters: 4000, epoch: 2 | loss: 0.2577417
	speed: 0.0104s/iter; left time: 8558.1404s
	iters: 4100, epoch: 2 | loss: 0.2415798
	speed: 0.0104s/iter; left time: 8575.8043s
Epoch: 2 cost time: 43.86683797836304
Epoch: 2, Steps: 4167 | Train Loss: 0.2516677 Vali Loss: 0.2174445 Test Loss: 0.1666421
Validation loss decreased (0.217700 --> 0.217445).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.2562951
	speed: 0.8748s/iter; left time: 721715.2413s
	iters: 200, epoch: 3 | loss: 0.2389685
	speed: 0.0103s/iter; left time: 8530.3946s
	iters: 300, epoch: 3 | loss: 0.2709306
	speed: 0.0105s/iter; left time: 8619.8304s
	iters: 400, epoch: 3 | loss: 0.2578278
	speed: 0.0104s/iter; left time: 8579.6352s
	iters: 500, epoch: 3 | loss: 0.2768528
	speed: 0.0104s/iter; left time: 8577.5057s
	iters: 600, epoch: 3 | loss: 0.2591730
	speed: 0.0104s/iter; left time: 8578.5569s
	iters: 700, epoch: 3 | loss: 0.2443387
	speed: 0.0104s/iter; left time: 8573.4990s
	iters: 800, epoch: 3 | loss: 0.1953408
	speed: 0.0104s/iter; left time: 8592.4570s
	iters: 900, epoch: 3 | loss: 0.2173286
	speed: 0.0104s/iter; left time: 8594.1910s
	iters: 1000, epoch: 3 | loss: 0.2220337
	speed: 0.0104s/iter; left time: 8589.7296s
	iters: 1100, epoch: 3 | loss: 0.2279178
	speed: 0.0104s/iter; left time: 8596.6631s
	iters: 1200, epoch: 3 | loss: 0.2903373
	speed: 0.0104s/iter; left time: 8601.7168s
	iters: 1300, epoch: 3 | loss: 0.2395875
	speed: 0.0104s/iter; left time: 8607.0204s
	iters: 1400, epoch: 3 | loss: 0.2602848
	speed: 0.0105s/iter; left time: 8615.5765s
	iters: 1500, epoch: 3 | loss: 0.2852124
	speed: 0.0105s/iter; left time: 8609.2329s
	iters: 1600, epoch: 3 | loss: 0.2439051
	speed: 0.0105s/iter; left time: 8607.2922s
	iters: 1700, epoch: 3 | loss: 0.2885177
	speed: 0.0104s/iter; left time: 8601.5572s
	iters: 1800, epoch: 3 | loss: 0.2514496
	speed: 0.0104s/iter; left time: 8596.3612s
	iters: 1900, epoch: 3 | loss: 0.2507716
	speed: 0.0104s/iter; left time: 8594.7969s
	iters: 2000, epoch: 3 | loss: 0.2502225
	speed: 0.0104s/iter; left time: 8586.6903s
	iters: 2100, epoch: 3 | loss: 0.2190371
	speed: 0.0104s/iter; left time: 8590.0736s
	iters: 2200, epoch: 3 | loss: 0.2913476
	speed: 0.0103s/iter; left time: 8514.5534s
	iters: 2300, epoch: 3 | loss: 0.2865074
	speed: 0.0104s/iter; left time: 8530.5338s
	iters: 2400, epoch: 3 | loss: 0.2778346
	speed: 0.0104s/iter; left time: 8524.4425s
	iters: 2500, epoch: 3 | loss: 0.2471783
	speed: 0.0108s/iter; left time: 8887.8806s
	iters: 2600, epoch: 3 | loss: 0.2270301
	speed: 0.0109s/iter; left time: 8972.4019s
	iters: 2700, epoch: 3 | loss: 0.2476046
	speed: 0.0109s/iter; left time: 8967.4543s
	iters: 2800, epoch: 3 | loss: 0.2458066
	speed: 0.0109s/iter; left time: 8984.1058s
	iters: 2900, epoch: 3 | loss: 0.2730410
	speed: 0.0109s/iter; left time: 8963.7092s
	iters: 3000, epoch: 3 | loss: 0.2338422
	speed: 0.0105s/iter; left time: 8654.6640s
	iters: 3100, epoch: 3 | loss: 0.2570136
	speed: 0.0104s/iter; left time: 8585.4364s
	iters: 3200, epoch: 3 | loss: 0.2164723
	speed: 0.0104s/iter; left time: 8577.1575s
	iters: 3300, epoch: 3 | loss: 0.2580163
	speed: 0.0104s/iter; left time: 8573.6374s
	iters: 3400, epoch: 3 | loss: 0.2586267
	speed: 0.0104s/iter; left time: 8570.3824s
	iters: 3500, epoch: 3 | loss: 0.2285056
	speed: 0.0104s/iter; left time: 8582.0831s
	iters: 3600, epoch: 3 | loss: 0.2361160
	speed: 0.0105s/iter; left time: 8585.5314s
	iters: 3700, epoch: 3 | loss: 0.2553782
	speed: 0.0104s/iter; left time: 8571.1875s
	iters: 3800, epoch: 3 | loss: 0.3099725
	speed: 0.0104s/iter; left time: 8566.8505s
	iters: 3900, epoch: 3 | loss: 0.2518339
	speed: 0.0104s/iter; left time: 8577.2488s
	iters: 4000, epoch: 3 | loss: 0.2573645
	speed: 0.0105s/iter; left time: 8595.9347s
	iters: 4100, epoch: 3 | loss: 0.2627645
	speed: 0.0105s/iter; left time: 8588.7398s
Epoch: 3 cost time: 44.2614221572876
Epoch: 3, Steps: 4167 | Train Loss: 0.2516175 Vali Loss: 0.2171970 Test Loss: 0.1665260
Validation loss decreased (0.217445 --> 0.217197).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.2520371
	speed: 0.8083s/iter; left time: 663466.6041s
	iters: 200, epoch: 4 | loss: 0.2092484
	speed: 0.0108s/iter; left time: 8835.1070s
	iters: 300, epoch: 4 | loss: 0.2532052
	speed: 0.0108s/iter; left time: 8864.2167s
	iters: 400, epoch: 4 | loss: 0.3041685
	speed: 0.0105s/iter; left time: 8575.8708s
	iters: 500, epoch: 4 | loss: 0.2302900
	speed: 0.0104s/iter; left time: 8524.9773s
	iters: 600, epoch: 4 | loss: 0.2567743
	speed: 0.0104s/iter; left time: 8521.8944s
	iters: 700, epoch: 4 | loss: 0.2365325
	speed: 0.0103s/iter; left time: 8451.1260s
	iters: 800, epoch: 4 | loss: 0.2819273
	speed: 0.0102s/iter; left time: 8372.6943s
	iters: 900, epoch: 4 | loss: 0.2647354
	speed: 0.0102s/iter; left time: 8367.4876s
	iters: 1000, epoch: 4 | loss: 0.2804258
	speed: 0.0103s/iter; left time: 8476.9209s
	iters: 1100, epoch: 4 | loss: 0.2491929
	speed: 0.0103s/iter; left time: 8427.8968s
	iters: 1200, epoch: 4 | loss: 0.2382353
	speed: 0.0103s/iter; left time: 8435.0925s
	iters: 1300, epoch: 4 | loss: 0.2429160
	speed: 0.0103s/iter; left time: 8436.0625s
	iters: 1400, epoch: 4 | loss: 0.2251075
	speed: 0.0103s/iter; left time: 8428.7047s
	iters: 1500, epoch: 4 | loss: 0.2604195
	speed: 0.0103s/iter; left time: 8445.4500s
	iters: 1600, epoch: 4 | loss: 0.2772471
	speed: 0.0104s/iter; left time: 8509.4410s
	iters: 1700, epoch: 4 | loss: 0.2228858
	speed: 0.0104s/iter; left time: 8505.4863s
	iters: 1800, epoch: 4 | loss: 0.2511885
	speed: 0.0104s/iter; left time: 8506.5318s
	iters: 1900, epoch: 4 | loss: 0.2002961
	speed: 0.0104s/iter; left time: 8495.2067s
	iters: 2000, epoch: 4 | loss: 0.2246035
	speed: 0.0104s/iter; left time: 8516.3937s
	iters: 2100, epoch: 4 | loss: 0.2877420
	speed: 0.0104s/iter; left time: 8515.0219s
	iters: 2200, epoch: 4 | loss: 0.2666814
	speed: 0.0104s/iter; left time: 8507.7670s
	iters: 2300, epoch: 4 | loss: 0.2910880
	speed: 0.0104s/iter; left time: 8516.2599s
	iters: 2400, epoch: 4 | loss: 0.2649997
	speed: 0.0104s/iter; left time: 8516.0548s
	iters: 2500, epoch: 4 | loss: 0.2923508
	speed: 0.0104s/iter; left time: 8507.8651s
	iters: 2600, epoch: 4 | loss: 0.2501952
	speed: 0.0104s/iter; left time: 8504.9857s
	iters: 2700, epoch: 4 | loss: 0.2990468
	speed: 0.0104s/iter; left time: 8509.2485s
	iters: 2800, epoch: 4 | loss: 0.2296715
	speed: 0.0104s/iter; left time: 8513.9644s
	iters: 2900, epoch: 4 | loss: 0.2438597
	speed: 0.0104s/iter; left time: 8524.0500s
	iters: 3000, epoch: 4 | loss: 0.2422598
	speed: 0.0104s/iter; left time: 8516.7171s
	iters: 3100, epoch: 4 | loss: 0.2730545
	speed: 0.0104s/iter; left time: 8509.5633s
	iters: 3200, epoch: 4 | loss: 0.2310923
	speed: 0.0104s/iter; left time: 8499.1824s
	iters: 3300, epoch: 4 | loss: 0.2696303
	speed: 0.0104s/iter; left time: 8522.7121s
	iters: 3400, epoch: 4 | loss: 0.2522925
	speed: 0.0104s/iter; left time: 8510.3768s
	iters: 3500, epoch: 4 | loss: 0.2515242
	speed: 0.0104s/iter; left time: 8510.7428s
	iters: 3600, epoch: 4 | loss: 0.2204664
	speed: 0.0104s/iter; left time: 8504.6353s
	iters: 3700, epoch: 4 | loss: 0.2312562
	speed: 0.0104s/iter; left time: 8506.6069s
	iters: 3800, epoch: 4 | loss: 0.3014247
	speed: 0.0104s/iter; left time: 8506.9510s
	iters: 3900, epoch: 4 | loss: 0.2600283
	speed: 0.0104s/iter; left time: 8512.4665s
	iters: 4000, epoch: 4 | loss: 0.2946558
	speed: 0.0104s/iter; left time: 8505.4083s
	iters: 4100, epoch: 4 | loss: 0.2683603
	speed: 0.0104s/iter; left time: 8511.7478s
Epoch: 4 cost time: 43.94652438163757
Epoch: 4, Steps: 4167 | Train Loss: 0.2516076 Vali Loss: 0.2173681 Test Loss: 0.1667064
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 5 | loss: 0.2430044
	speed: 0.8049s/iter; left time: 657267.7039s
	iters: 200, epoch: 5 | loss: 0.2555935
	speed: 0.0108s/iter; left time: 8805.4034s
	iters: 300, epoch: 5 | loss: 0.2468216
	speed: 0.0108s/iter; left time: 8850.4616s
	iters: 400, epoch: 5 | loss: 0.2258831
	speed: 0.0108s/iter; left time: 8839.5449s
	iters: 500, epoch: 5 | loss: 0.1980595
	speed: 0.0104s/iter; left time: 8469.8353s
	iters: 600, epoch: 5 | loss: 0.2334016
	speed: 0.0104s/iter; left time: 8479.8148s
	iters: 700, epoch: 5 | loss: 0.2829719
	speed: 0.0104s/iter; left time: 8483.9335s
	iters: 800, epoch: 5 | loss: 0.2818337
	speed: 0.0104s/iter; left time: 8473.5212s
	iters: 900, epoch: 5 | loss: 0.2919001
	speed: 0.0104s/iter; left time: 8485.3709s
	iters: 1000, epoch: 5 | loss: 0.2480919
	speed: 0.0104s/iter; left time: 8490.8733s
	iters: 1100, epoch: 5 | loss: 0.2532602
	speed: 0.0104s/iter; left time: 8505.1697s
	iters: 1200, epoch: 5 | loss: 0.2228116
	speed: 0.0104s/iter; left time: 8477.4655s
	iters: 1300, epoch: 5 | loss: 0.2446656
	speed: 0.0104s/iter; left time: 8512.7815s
	iters: 1400, epoch: 5 | loss: 0.2980692
	speed: 0.0104s/iter; left time: 8499.0633s
	iters: 1500, epoch: 5 | loss: 0.2200540
	speed: 0.0104s/iter; left time: 8487.5640s
	iters: 1600, epoch: 5 | loss: 0.2678888
	speed: 0.0104s/iter; left time: 8494.3121s
	iters: 1700, epoch: 5 | loss: 0.2619532
	speed: 0.0105s/iter; left time: 8520.6029s
	iters: 1800, epoch: 5 | loss: 0.2377152
	speed: 0.0104s/iter; left time: 8472.3243s
	iters: 1900, epoch: 5 | loss: 0.2245715
	speed: 0.0104s/iter; left time: 8490.9605s
	iters: 2000, epoch: 5 | loss: 0.2625990
	speed: 0.0105s/iter; left time: 8519.8501s
	iters: 2100, epoch: 5 | loss: 0.2533825
	speed: 0.0104s/iter; left time: 8506.5741s
	iters: 2200, epoch: 5 | loss: 0.2367712
	speed: 0.0104s/iter; left time: 8500.0243s
	iters: 2300, epoch: 5 | loss: 0.2433125
	speed: 0.0104s/iter; left time: 8502.0293s
	iters: 2400, epoch: 5 | loss: 0.2447198
	speed: 0.0104s/iter; left time: 8496.6267s
	iters: 2500, epoch: 5 | loss: 0.2769151
	speed: 0.0104s/iter; left time: 8488.8315s
	iters: 2600, epoch: 5 | loss: 0.2565677
	speed: 0.0104s/iter; left time: 8496.9235s
	iters: 2700, epoch: 5 | loss: 0.2372758
	speed: 0.0104s/iter; left time: 8496.9492s
	iters: 2800, epoch: 5 | loss: 0.2606837
	speed: 0.0104s/iter; left time: 8488.3973s
	iters: 2900, epoch: 5 | loss: 0.2459768
	speed: 0.0104s/iter; left time: 8488.5381s
	iters: 3000, epoch: 5 | loss: 0.2567037
	speed: 0.0104s/iter; left time: 8488.0848s
	iters: 3100, epoch: 5 | loss: 0.2803527
	speed: 0.0104s/iter; left time: 8474.9448s
	iters: 3200, epoch: 5 | loss: 0.2338824
	speed: 0.0106s/iter; left time: 8642.2772s
	iters: 3300, epoch: 5 | loss: 0.2537377
	speed: 0.0105s/iter; left time: 8552.1238s
	iters: 3400, epoch: 5 | loss: 0.2574261
	speed: 0.0105s/iter; left time: 8535.9608s
	iters: 3500, epoch: 5 | loss: 0.2612460
	speed: 0.0105s/iter; left time: 8519.8693s
	iters: 3600, epoch: 5 | loss: 0.2338925
	speed: 0.0105s/iter; left time: 8504.4329s
	iters: 3700, epoch: 5 | loss: 0.2447184
	speed: 0.0105s/iter; left time: 8507.9210s
	iters: 3800, epoch: 5 | loss: 0.2719350
	speed: 0.0105s/iter; left time: 8510.2257s
	iters: 3900, epoch: 5 | loss: 0.2920039
	speed: 0.0105s/iter; left time: 8505.6672s
	iters: 4000, epoch: 5 | loss: 0.2608654
	speed: 0.0105s/iter; left time: 8513.5323s
	iters: 4100, epoch: 5 | loss: 0.2242813
	speed: 0.0105s/iter; left time: 8511.2313s
Epoch: 5 cost time: 44.23900127410889
Epoch: 5, Steps: 4167 | Train Loss: 0.2515916 Vali Loss: 0.2174937 Test Loss: 0.1668988
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 6 | loss: 0.2338187
	speed: 0.8041s/iter; left time: 653294.4022s
	iters: 200, epoch: 6 | loss: 0.2493810
	speed: 0.0102s/iter; left time: 8266.0074s
	iters: 300, epoch: 6 | loss: 0.2568808
	speed: 0.0102s/iter; left time: 8304.2873s
	iters: 400, epoch: 6 | loss: 0.2651494
	speed: 0.0102s/iter; left time: 8308.2742s
	iters: 500, epoch: 6 | loss: 0.2935929
	speed: 0.0103s/iter; left time: 8336.2930s
	iters: 600, epoch: 6 | loss: 0.2623579
	speed: 0.0107s/iter; left time: 8654.3494s
	iters: 700, epoch: 6 | loss: 0.2526428
	speed: 0.0108s/iter; left time: 8804.4067s
	iters: 800, epoch: 6 | loss: 0.2147151
	speed: 0.0108s/iter; left time: 8785.7449s
	iters: 900, epoch: 6 | loss: 0.2805136
	speed: 0.0108s/iter; left time: 8803.4163s
	iters: 1000, epoch: 6 | loss: 0.2497851
	speed: 0.0109s/iter; left time: 8813.1711s
	iters: 1100, epoch: 6 | loss: 0.2164884
	speed: 0.0109s/iter; left time: 8818.2104s
	iters: 1200, epoch: 6 | loss: 0.2549227
	speed: 0.0109s/iter; left time: 8821.2499s
	iters: 1300, epoch: 6 | loss: 0.2543287
	speed: 0.0109s/iter; left time: 8819.7371s
	iters: 1400, epoch: 6 | loss: 0.2913231
	speed: 0.0108s/iter; left time: 8779.2608s
	iters: 1500, epoch: 6 | loss: 0.2478217
	speed: 0.0109s/iter; left time: 8821.5038s
	iters: 1600, epoch: 6 | loss: 0.2496021
	speed: 0.0109s/iter; left time: 8817.2239s
	iters: 1700, epoch: 6 | loss: 0.2889159
	speed: 0.0109s/iter; left time: 8819.5141s
	iters: 1800, epoch: 6 | loss: 0.2339009
	speed: 0.0109s/iter; left time: 8812.9212s
	iters: 1900, epoch: 6 | loss: 0.2785974
	speed: 0.0109s/iter; left time: 8816.7840s
	iters: 2000, epoch: 6 | loss: 0.2305212
	speed: 0.0109s/iter; left time: 8817.3642s
	iters: 2100, epoch: 6 | loss: 0.2604940
	speed: 0.0109s/iter; left time: 8813.9113s
	iters: 2200, epoch: 6 | loss: 0.2356503
	speed: 0.0109s/iter; left time: 8816.6222s
	iters: 2300, epoch: 6 | loss: 0.2605143
	speed: 0.0109s/iter; left time: 8813.8226s
	iters: 2400, epoch: 6 | loss: 0.2605475
	speed: 0.0109s/iter; left time: 8807.6818s
	iters: 2500, epoch: 6 | loss: 0.2406757
	speed: 0.0109s/iter; left time: 8815.7609s
	iters: 2600, epoch: 6 | loss: 0.2461818
	speed: 0.0109s/iter; left time: 8796.5008s
	iters: 2700, epoch: 6 | loss: 0.2486638
	speed: 0.0110s/iter; left time: 8892.1244s
	iters: 2800, epoch: 6 | loss: 0.2633780
	speed: 0.0109s/iter; left time: 8815.3360s
	iters: 2900, epoch: 6 | loss: 0.2834827
	speed: 0.0109s/iter; left time: 8792.7524s
	iters: 3000, epoch: 6 | loss: 0.2866417
	speed: 0.0108s/iter; left time: 8778.3908s
	iters: 3100, epoch: 6 | loss: 0.2568574
	speed: 0.0108s/iter; left time: 8778.4471s
	iters: 3200, epoch: 6 | loss: 0.2559584
	speed: 0.0108s/iter; left time: 8774.5897s
	iters: 3300, epoch: 6 | loss: 0.2458776
	speed: 0.0109s/iter; left time: 8781.2329s
	iters: 3400, epoch: 6 | loss: 0.2180416
	speed: 0.0108s/iter; left time: 8777.0013s
	iters: 3500, epoch: 6 | loss: 0.2509960
	speed: 0.0109s/iter; left time: 8779.0473s
	iters: 3600, epoch: 6 | loss: 0.2628776
	speed: 0.0108s/iter; left time: 8771.0902s
	iters: 3700, epoch: 6 | loss: 0.2554042
	speed: 0.0108s/iter; left time: 8763.5880s
	iters: 3800, epoch: 6 | loss: 0.2482254
	speed: 0.0108s/iter; left time: 8772.1689s
	iters: 3900, epoch: 6 | loss: 0.2735370
	speed: 0.0108s/iter; left time: 8769.3606s
	iters: 4000, epoch: 6 | loss: 0.2833957
	speed: 0.0108s/iter; left time: 8761.7892s
	iters: 4100, epoch: 6 | loss: 0.2412696
	speed: 0.0108s/iter; left time: 8764.0692s
Epoch: 6 cost time: 45.486823081970215
Epoch: 6, Steps: 4167 | Train Loss: 0.2516015 Vali Loss: 0.2172578 Test Loss: 0.1666997
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 7 | loss: 0.2464056
	speed: 0.8069s/iter; left time: 652205.1628s
	iters: 200, epoch: 7 | loss: 0.2339723
	speed: 0.0104s/iter; left time: 8372.4388s
	iters: 300, epoch: 7 | loss: 0.2326156
	speed: 0.0104s/iter; left time: 8377.1270s
	iters: 400, epoch: 7 | loss: 0.2867890
	speed: 0.0104s/iter; left time: 8396.8591s
	iters: 500, epoch: 7 | loss: 0.2402289
	speed: 0.0104s/iter; left time: 8410.9866s
	iters: 600, epoch: 7 | loss: 0.2325234
	speed: 0.0104s/iter; left time: 8410.3692s
	iters: 700, epoch: 7 | loss: 0.2626407
	speed: 0.0104s/iter; left time: 8423.3819s
	iters: 800, epoch: 7 | loss: 0.3102650
	speed: 0.0104s/iter; left time: 8426.3093s
	iters: 900, epoch: 7 | loss: 0.2489796
	speed: 0.0104s/iter; left time: 8430.4448s
	iters: 1000, epoch: 7 | loss: 0.2557099
	speed: 0.0105s/iter; left time: 8439.2683s
	iters: 1100, epoch: 7 | loss: 0.2684162
	speed: 0.0105s/iter; left time: 8443.5084s
	iters: 1200, epoch: 7 | loss: 0.2181698
	speed: 0.0104s/iter; left time: 8428.0825s
	iters: 1300, epoch: 7 | loss: 0.2298404
	speed: 0.0104s/iter; left time: 8433.6887s
	iters: 1400, epoch: 7 | loss: 0.2120820
	speed: 0.0104s/iter; left time: 8432.7784s
	iters: 1500, epoch: 7 | loss: 0.2787974
	speed: 0.0105s/iter; left time: 8434.5576s
	iters: 1600, epoch: 7 | loss: 0.2532362
	speed: 0.0104s/iter; left time: 8430.7943s
	iters: 1700, epoch: 7 | loss: 0.2321561
	speed: 0.0105s/iter; left time: 8435.8790s
	iters: 1800, epoch: 7 | loss: 0.2657674
	speed: 0.0105s/iter; left time: 8431.9256s
	iters: 1900, epoch: 7 | loss: 0.2283500
	speed: 0.0105s/iter; left time: 8446.1629s
	iters: 2000, epoch: 7 | loss: 0.2619861
	speed: 0.0105s/iter; left time: 8447.8419s
	iters: 2100, epoch: 7 | loss: 0.2848246
	speed: 0.0105s/iter; left time: 8440.3506s
	iters: 2200, epoch: 7 | loss: 0.3369489
	speed: 0.0105s/iter; left time: 8434.0813s
	iters: 2300, epoch: 7 | loss: 0.2906227
	speed: 0.0105s/iter; left time: 8429.0146s
	iters: 2400, epoch: 7 | loss: 0.2392795
	speed: 0.0105s/iter; left time: 8441.1169s
	iters: 2500, epoch: 7 | loss: 0.2439363
	speed: 0.0105s/iter; left time: 8436.2844s
	iters: 2600, epoch: 7 | loss: 0.2996555
	speed: 0.0105s/iter; left time: 8437.8888s
	iters: 2700, epoch: 7 | loss: 0.2520354
	speed: 0.0105s/iter; left time: 8426.6914s
	iters: 2800, epoch: 7 | loss: 0.2352920
	speed: 0.0105s/iter; left time: 8428.8358s
	iters: 2900, epoch: 7 | loss: 0.2744507
	speed: 0.0105s/iter; left time: 8423.0095s
	iters: 3000, epoch: 7 | loss: 0.2579611
	speed: 0.0105s/iter; left time: 8422.6110s
	iters: 3100, epoch: 7 | loss: 0.2381652
	speed: 0.0105s/iter; left time: 8442.1090s
	iters: 3200, epoch: 7 | loss: 0.2580090
	speed: 0.0105s/iter; left time: 8421.1069s
	iters: 3300, epoch: 7 | loss: 0.2997811
	speed: 0.0105s/iter; left time: 8422.7195s
	iters: 3400, epoch: 7 | loss: 0.2681457
	speed: 0.0105s/iter; left time: 8417.7926s
	iters: 3500, epoch: 7 | loss: 0.2351595
	speed: 0.0105s/iter; left time: 8426.5743s
	iters: 3600, epoch: 7 | loss: 0.2466317
	speed: 0.0105s/iter; left time: 8410.5320s
	iters: 3700, epoch: 7 | loss: 0.2394291
	speed: 0.0105s/iter; left time: 8416.4532s
	iters: 3800, epoch: 7 | loss: 0.2444050
	speed: 0.0105s/iter; left time: 8412.2114s
	iters: 3900, epoch: 7 | loss: 0.2483374
	speed: 0.0105s/iter; left time: 8420.9538s
	iters: 4000, epoch: 7 | loss: 0.2552094
	speed: 0.0105s/iter; left time: 8413.3558s
	iters: 4100, epoch: 7 | loss: 0.2482234
	speed: 0.0105s/iter; left time: 8416.0607s
Epoch: 7 cost time: 44.13582491874695
Epoch: 7, Steps: 4167 | Train Loss: 0.2516063 Vali Loss: 0.2172401 Test Loss: 0.1666086
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 8 | loss: 0.2431409
	speed: 0.8760s/iter; left time: 704396.8261s
	iters: 200, epoch: 8 | loss: 0.2576137
	speed: 0.0103s/iter; left time: 8271.6609s
	iters: 300, epoch: 8 | loss: 0.2455906
	speed: 0.0103s/iter; left time: 8304.6041s
	iters: 400, epoch: 8 | loss: 0.2578924
	speed: 0.0104s/iter; left time: 8334.0719s
	iters: 500, epoch: 8 | loss: 0.2719984
	speed: 0.0104s/iter; left time: 8335.0894s
	iters: 600, epoch: 8 | loss: 0.2454128
	speed: 0.0104s/iter; left time: 8361.8114s
	iters: 700, epoch: 8 | loss: 0.2898475
	speed: 0.0104s/iter; left time: 8364.1791s
	iters: 800, epoch: 8 | loss: 0.2380139
	speed: 0.0104s/iter; left time: 8369.4441s
	iters: 900, epoch: 8 | loss: 0.2337057
	speed: 0.0105s/iter; left time: 8434.5700s
	iters: 1000, epoch: 8 | loss: 0.2831724
	speed: 0.0109s/iter; left time: 8753.6214s
	iters: 1100, epoch: 8 | loss: 0.2715958
	speed: 0.0109s/iter; left time: 8749.5808s
	iters: 1200, epoch: 8 | loss: 0.2180121
	speed: 0.0109s/iter; left time: 8754.3883s
	iters: 1300, epoch: 8 | loss: 0.2422101
	speed: 0.0109s/iter; left time: 8762.2630s
	iters: 1400, epoch: 8 | loss: 0.2649211
	speed: 0.0109s/iter; left time: 8752.7286s
	iters: 1500, epoch: 8 | loss: 0.3081751
	speed: 0.0109s/iter; left time: 8754.7082s
	iters: 1600, epoch: 8 | loss: 0.2261654
	speed: 0.0109s/iter; left time: 8748.3992s
	iters: 1700, epoch: 8 | loss: 0.2448269
	speed: 0.0109s/iter; left time: 8758.4585s
	iters: 1800, epoch: 8 | loss: 0.3076386
	speed: 0.0109s/iter; left time: 8758.6222s
	iters: 1900, epoch: 8 | loss: 0.2544834
	speed: 0.0109s/iter; left time: 8755.6809s
	iters: 2000, epoch: 8 | loss: 0.2614388
	speed: 0.0109s/iter; left time: 8750.8235s
	iters: 2100, epoch: 8 | loss: 0.2322926
	speed: 0.0109s/iter; left time: 8761.2092s
	iters: 2200, epoch: 8 | loss: 0.2142615
	speed: 0.0109s/iter; left time: 8749.7969s
	iters: 2300, epoch: 8 | loss: 0.2622299
	speed: 0.0109s/iter; left time: 8761.1069s
	iters: 2400, epoch: 8 | loss: 0.2545966
	speed: 0.0109s/iter; left time: 8749.4254s
	iters: 2500, epoch: 8 | loss: 0.2410316
	speed: 0.0109s/iter; left time: 8766.1224s
	iters: 2600, epoch: 8 | loss: 0.2829376
	speed: 0.0104s/iter; left time: 8299.2255s
	iters: 2700, epoch: 8 | loss: 0.2250334
	speed: 0.0106s/iter; left time: 8526.2720s
	iters: 2800, epoch: 8 | loss: 0.2693875
	speed: 0.0103s/iter; left time: 8277.3117s
	iters: 2900, epoch: 8 | loss: 0.2518674
	speed: 0.0104s/iter; left time: 8362.8160s
	iters: 3000, epoch: 8 | loss: 0.2683221
	speed: 0.0104s/iter; left time: 8369.8778s
	iters: 3100, epoch: 8 | loss: 0.2165297
	speed: 0.0105s/iter; left time: 8377.3042s
	iters: 3200, epoch: 8 | loss: 0.2732660
	speed: 0.0104s/iter; left time: 8369.7575s
	iters: 3300, epoch: 8 | loss: 0.2463915
	speed: 0.0104s/iter; left time: 8366.3372s
	iters: 3400, epoch: 8 | loss: 0.2228017
	speed: 0.0105s/iter; left time: 8377.4359s
	iters: 3500, epoch: 8 | loss: 0.2565721
	speed: 0.0105s/iter; left time: 8371.4758s
	iters: 3600, epoch: 8 | loss: 0.2146353
	speed: 0.0104s/iter; left time: 8365.3776s
	iters: 3700, epoch: 8 | loss: 0.2568121
	speed: 0.0104s/iter; left time: 8357.2194s
	iters: 3800, epoch: 8 | loss: 0.2223736
	speed: 0.0105s/iter; left time: 8375.2668s
	iters: 3900, epoch: 8 | loss: 0.2573909
	speed: 0.0105s/iter; left time: 8369.5837s
	iters: 4000, epoch: 8 | loss: 0.2572877
	speed: 0.0105s/iter; left time: 8363.0355s
	iters: 4100, epoch: 8 | loss: 0.2747994
	speed: 0.0105s/iter; left time: 8362.7497s
Epoch: 8 cost time: 44.833637952804565
Epoch: 8, Steps: 4167 | Train Loss: 0.2515992 Vali Loss: 0.2176897 Test Loss: 0.1668462
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems03_h_96_336_DLinear_custom_ftM_sl96_ll48_pl336_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 37892
test shape: (37892, 1, 336, 151) (37892, 1, 336, 151)
test shape: (37892, 336, 151) (37892, 336, 151)
mse:0.166525736451149, mae:0.21648868918418884
>>>>>>>Overall time: 1813 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
