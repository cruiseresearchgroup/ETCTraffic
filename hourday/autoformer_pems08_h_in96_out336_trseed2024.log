Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=212, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems08_h.csv', dec_in=212, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=212, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems08_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 141041
val 19877
test 40085
	iters: 100, epoch: 1 | loss: 0.3177589
	speed: 0.1713s/iter; left time: 150947.6995s
	iters: 200, epoch: 1 | loss: 0.3207503
	speed: 0.1668s/iter; left time: 146944.2644s
	iters: 300, epoch: 1 | loss: 0.3372318
	speed: 0.1678s/iter; left time: 147859.1797s
	iters: 400, epoch: 1 | loss: 0.2512001
	speed: 0.1679s/iter; left time: 147911.6258s
	iters: 500, epoch: 1 | loss: 0.2353216
	speed: 0.1669s/iter; left time: 147000.4090s
	iters: 600, epoch: 1 | loss: 0.2231016
	speed: 0.1672s/iter; left time: 147278.0628s
	iters: 700, epoch: 1 | loss: 0.2305349
	speed: 0.1672s/iter; left time: 147227.9852s
	iters: 800, epoch: 1 | loss: 0.2120427
	speed: 0.1670s/iter; left time: 147056.9599s
	iters: 900, epoch: 1 | loss: 0.2289743
	speed: 0.1666s/iter; left time: 146726.4140s
	iters: 1000, epoch: 1 | loss: 0.1922287
	speed: 0.1671s/iter; left time: 147076.1290s
	iters: 1100, epoch: 1 | loss: 0.2255013
	speed: 0.1670s/iter; left time: 147002.8838s
	iters: 1200, epoch: 1 | loss: 0.2066925
	speed: 0.1674s/iter; left time: 147366.3540s
	iters: 1300, epoch: 1 | loss: 0.1973447
	speed: 0.1678s/iter; left time: 147689.3471s
	iters: 1400, epoch: 1 | loss: 0.2160975
	speed: 0.1675s/iter; left time: 147408.5095s
	iters: 1500, epoch: 1 | loss: 0.2134406
	speed: 0.1667s/iter; left time: 146721.9096s
	iters: 1600, epoch: 1 | loss: 0.2276515
	speed: 0.1672s/iter; left time: 147133.4805s
	iters: 1700, epoch: 1 | loss: 0.1992791
	speed: 0.1676s/iter; left time: 147430.2132s
	iters: 1800, epoch: 1 | loss: 0.1926545
	speed: 0.1671s/iter; left time: 147004.2847s
	iters: 1900, epoch: 1 | loss: 0.1934035
	speed: 0.1672s/iter; left time: 147040.8899s
	iters: 2000, epoch: 1 | loss: 0.3263219
	speed: 0.1671s/iter; left time: 146930.4423s
	iters: 2100, epoch: 1 | loss: 0.2843887
	speed: 0.1672s/iter; left time: 147034.0728s
	iters: 2200, epoch: 1 | loss: 0.2999965
	speed: 0.1671s/iter; left time: 146875.3581s
	iters: 2300, epoch: 1 | loss: 0.3112812
	speed: 0.1671s/iter; left time: 146866.1015s
	iters: 2400, epoch: 1 | loss: 0.2881002
	speed: 0.1671s/iter; left time: 146869.5537s
	iters: 2500, epoch: 1 | loss: 0.2832702
	speed: 0.1674s/iter; left time: 147134.3327s
	iters: 2600, epoch: 1 | loss: 0.2190868
	speed: 0.1674s/iter; left time: 147110.3530s
	iters: 2700, epoch: 1 | loss: 0.2181405
	speed: 0.1676s/iter; left time: 147307.6076s
	iters: 2800, epoch: 1 | loss: 0.1892027
	speed: 0.1670s/iter; left time: 146729.3650s
	iters: 2900, epoch: 1 | loss: 0.2097316
	speed: 0.1671s/iter; left time: 146766.3490s
	iters: 3000, epoch: 1 | loss: 0.2032390
	speed: 0.1675s/iter; left time: 147170.1806s
	iters: 3100, epoch: 1 | loss: 0.2087911
	speed: 0.1670s/iter; left time: 146667.5981s
	iters: 3200, epoch: 1 | loss: 0.1967059
	speed: 0.1678s/iter; left time: 147367.5107s
	iters: 3300, epoch: 1 | loss: 0.1983421
	speed: 0.1673s/iter; left time: 146897.6364s
	iters: 3400, epoch: 1 | loss: 0.2059796
	speed: 0.1677s/iter; left time: 147247.2568s
	iters: 3500, epoch: 1 | loss: 0.2086636
	speed: 0.1672s/iter; left time: 146802.7612s
	iters: 3600, epoch: 1 | loss: 0.1968688
	speed: 0.1677s/iter; left time: 147221.3898s
	iters: 3700, epoch: 1 | loss: 0.2155032
	speed: 0.1668s/iter; left time: 146396.0450s
	iters: 3800, epoch: 1 | loss: 0.2186469
	speed: 0.1677s/iter; left time: 147182.2725s
	iters: 3900, epoch: 1 | loss: 0.1873856
	speed: 0.1681s/iter; left time: 147501.5764s
	iters: 4000, epoch: 1 | loss: 0.1836665
	speed: 0.1671s/iter; left time: 146634.5405s
	iters: 4100, epoch: 1 | loss: 0.1878319
	speed: 0.1673s/iter; left time: 146804.0644s
	iters: 4200, epoch: 1 | loss: 0.1956615
	speed: 0.1672s/iter; left time: 146698.2869s
	iters: 4300, epoch: 1 | loss: 0.1837804
	speed: 0.1670s/iter; left time: 146443.8704s
	iters: 4400, epoch: 1 | loss: 0.1891224
	speed: 0.1672s/iter; left time: 146657.4004s
Epoch: 1 cost time: 737.766193151474
Epoch: 1, Steps: 4407 | Train Loss: 0.2295823 Vali Loss: 0.2751522 Test Loss: 0.4252592
Validation loss decreased (inf --> 0.275152).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.1971768
	speed: 5.5561s/iter; left time: 4872130.7435s
	iters: 200, epoch: 2 | loss: 0.2067368
	speed: 0.1683s/iter; left time: 147592.6400s
	iters: 300, epoch: 2 | loss: 0.1761689
	speed: 0.1686s/iter; left time: 147806.4396s
	iters: 400, epoch: 2 | loss: 0.2089422
	speed: 0.1684s/iter; left time: 147609.2100s
	iters: 500, epoch: 2 | loss: 0.1866480
	speed: 0.1689s/iter; left time: 148069.7289s
	iters: 600, epoch: 2 | loss: 0.1668843
	speed: 0.1691s/iter; left time: 148178.7459s
	iters: 700, epoch: 2 | loss: 0.4084784
	speed: 0.1691s/iter; left time: 148140.8934s
	iters: 800, epoch: 2 | loss: 0.2903983
	speed: 0.1689s/iter; left time: 148004.9228s
	iters: 900, epoch: 2 | loss: 0.2645249
	speed: 0.1695s/iter; left time: 148485.8394s
	iters: 1000, epoch: 2 | loss: 0.2766491
	speed: 0.1688s/iter; left time: 147886.6142s
	iters: 1100, epoch: 2 | loss: 0.2707193
	speed: 0.1689s/iter; left time: 147926.9242s
	iters: 1200, epoch: 2 | loss: 0.2369203
	speed: 0.1691s/iter; left time: 148104.3855s
	iters: 1300, epoch: 2 | loss: 0.2822689
	speed: 0.1687s/iter; left time: 147725.6955s
	iters: 1400, epoch: 2 | loss: 0.2416507
	speed: 0.1688s/iter; left time: 147834.2289s
	iters: 1500, epoch: 2 | loss: 0.2579639
	speed: 0.1688s/iter; left time: 147769.9812s
	iters: 1600, epoch: 2 | loss: 0.2785832
	speed: 0.1684s/iter; left time: 147454.5324s
	iters: 1700, epoch: 2 | loss: 0.2290374
	speed: 0.1686s/iter; left time: 147552.2965s
	iters: 1800, epoch: 2 | loss: 0.1988994
	speed: 0.1688s/iter; left time: 147737.4035s
	iters: 1900, epoch: 2 | loss: 0.2125151
	speed: 0.1688s/iter; left time: 147741.3263s
	iters: 2000, epoch: 2 | loss: 0.1809315
	speed: 0.1688s/iter; left time: 147666.6592s
	iters: 2100, epoch: 2 | loss: 0.1953691
	speed: 0.1693s/iter; left time: 148083.7001s
	iters: 2200, epoch: 2 | loss: 0.1919625
	speed: 0.1696s/iter; left time: 148349.0719s
	iters: 2300, epoch: 2 | loss: 0.1778437
	speed: 0.1691s/iter; left time: 147873.0619s
	iters: 2400, epoch: 2 | loss: 0.1787376
	speed: 0.1688s/iter; left time: 147613.5605s
	iters: 2500, epoch: 2 | loss: 0.1835368
	speed: 0.1684s/iter; left time: 147240.4762s
	iters: 2600, epoch: 2 | loss: 0.1873632
	speed: 0.1689s/iter; left time: 147697.2347s
	iters: 2700, epoch: 2 | loss: 0.1760511
	speed: 0.1691s/iter; left time: 147802.3833s
	iters: 2800, epoch: 2 | loss: 0.1740581
	speed: 0.1690s/iter; left time: 147765.3421s
	iters: 2900, epoch: 2 | loss: 0.3303201
	speed: 0.1695s/iter; left time: 148193.1444s
	iters: 3000, epoch: 2 | loss: 0.2073845
	speed: 0.1690s/iter; left time: 147679.8045s
	iters: 3100, epoch: 2 | loss: 0.1935332
	speed: 0.1692s/iter; left time: 147840.4092s
	iters: 3200, epoch: 2 | loss: 0.1777309
	speed: 0.1690s/iter; left time: 147659.5413s
	iters: 3300, epoch: 2 | loss: 0.1956367
	speed: 0.1686s/iter; left time: 147319.2326s
	iters: 3400, epoch: 2 | loss: 0.1966449
	speed: 0.1685s/iter; left time: 147229.6725s
	iters: 3500, epoch: 2 | loss: 0.2084618
	speed: 0.1685s/iter; left time: 147155.2777s
	iters: 3600, epoch: 2 | loss: 0.1809410
	speed: 0.1693s/iter; left time: 147831.8397s
	iters: 3700, epoch: 2 | loss: 0.1703023
	speed: 0.1695s/iter; left time: 148056.4596s
	iters: 3800, epoch: 2 | loss: 0.1892065
	speed: 0.1694s/iter; left time: 147949.1802s
	iters: 3900, epoch: 2 | loss: 0.1712391
	speed: 0.1691s/iter; left time: 147610.8995s
	iters: 4000, epoch: 2 | loss: 0.1705714
	speed: 0.1685s/iter; left time: 147125.1349s
	iters: 4100, epoch: 2 | loss: 0.1672853
	speed: 0.1689s/iter; left time: 147454.8795s
	iters: 4200, epoch: 2 | loss: 0.1769836
	speed: 0.1687s/iter; left time: 147215.4467s
	iters: 4300, epoch: 2 | loss: 0.1665668
	speed: 0.1695s/iter; left time: 147930.1163s
	iters: 4400, epoch: 2 | loss: 0.1448956
	speed: 0.1688s/iter; left time: 147325.2161s
Epoch: 2 cost time: 744.8853125572205
Epoch: 2, Steps: 4407 | Train Loss: 0.2059442 Vali Loss: 0.2690426 Test Loss: 0.4945014
Validation loss decreased (0.275152 --> 0.269043).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.1625511
	speed: 5.5237s/iter; left time: 4819367.5345s
	iters: 200, epoch: 3 | loss: 0.1582583
	speed: 0.1722s/iter; left time: 150239.3079s
	iters: 300, epoch: 3 | loss: 0.1571319
	speed: 0.1720s/iter; left time: 150043.3573s
	iters: 400, epoch: 3 | loss: 0.1755397
	speed: 0.1729s/iter; left time: 150838.2170s
	iters: 500, epoch: 3 | loss: 0.1585679
	speed: 0.1727s/iter; left time: 150622.1849s
	iters: 600, epoch: 3 | loss: 0.1724606
	speed: 0.1729s/iter; left time: 150726.7083s
	iters: 700, epoch: 3 | loss: 0.1606981
	speed: 0.1727s/iter; left time: 150582.9378s
	iters: 800, epoch: 3 | loss: 0.1517858
	speed: 0.1722s/iter; left time: 150150.5442s
	iters: 900, epoch: 3 | loss: 0.1685969
	speed: 0.1731s/iter; left time: 150879.9580s
	iters: 1000, epoch: 3 | loss: 0.1783164
	speed: 0.1728s/iter; left time: 150625.8643s
	iters: 1100, epoch: 3 | loss: 0.1557345
	speed: 0.1725s/iter; left time: 150364.3822s
	iters: 1200, epoch: 3 | loss: 0.1713680
	speed: 0.1725s/iter; left time: 150345.2379s
	iters: 1300, epoch: 3 | loss: 0.1826784
	speed: 0.1722s/iter; left time: 150049.4669s
	iters: 1400, epoch: 3 | loss: 0.1519062
	speed: 0.1730s/iter; left time: 150750.9204s
	iters: 1500, epoch: 3 | loss: 0.1637255
	speed: 0.1725s/iter; left time: 150294.7773s
	iters: 1600, epoch: 3 | loss: 0.1536414
	speed: 0.1723s/iter; left time: 150056.7089s
	iters: 1700, epoch: 3 | loss: 0.1649065
	speed: 0.1727s/iter; left time: 150418.0875s
	iters: 1800, epoch: 3 | loss: 0.1459094
	speed: 0.1728s/iter; left time: 150487.5684s
	iters: 1900, epoch: 3 | loss: 0.1621501
	speed: 0.1728s/iter; left time: 150427.1581s
	iters: 2000, epoch: 3 | loss: 0.1257807
	speed: 0.1723s/iter; left time: 150018.8430s
	iters: 2100, epoch: 3 | loss: 0.1377701
	speed: 0.1723s/iter; left time: 149948.0345s
	iters: 2200, epoch: 3 | loss: 0.1709756
	speed: 0.1720s/iter; left time: 149685.8584s
	iters: 2300, epoch: 3 | loss: 0.1448067
	speed: 0.1721s/iter; left time: 149785.4127s
	iters: 2400, epoch: 3 | loss: 0.1621592
	speed: 0.1723s/iter; left time: 149975.9609s
	iters: 2500, epoch: 3 | loss: 0.1630212
	speed: 0.1729s/iter; left time: 150455.1582s
	iters: 2600, epoch: 3 | loss: 0.1544292
	speed: 0.1725s/iter; left time: 150065.0788s
	iters: 2700, epoch: 3 | loss: 0.1472968
	speed: 0.1727s/iter; left time: 150246.6987s
	iters: 2800, epoch: 3 | loss: 0.1638398
	speed: 0.1723s/iter; left time: 149820.8701s
	iters: 2900, epoch: 3 | loss: 0.1481786
	speed: 0.1724s/iter; left time: 149925.9419s
	iters: 3000, epoch: 3 | loss: 0.1582154
	speed: 0.1730s/iter; left time: 150432.5485s
	iters: 3100, epoch: 3 | loss: 0.1476609
	speed: 0.1723s/iter; left time: 149819.6171s
	iters: 3200, epoch: 3 | loss: 0.1610398
	speed: 0.1732s/iter; left time: 150579.9462s
	iters: 3300, epoch: 3 | loss: 0.1556445
	speed: 0.1721s/iter; left time: 149617.8288s
	iters: 3400, epoch: 3 | loss: 0.1345110
	speed: 0.1726s/iter; left time: 150050.7485s
	iters: 3500, epoch: 3 | loss: 0.1598991
	speed: 0.1723s/iter; left time: 149785.8796s
	iters: 3600, epoch: 3 | loss: 0.1323065
	speed: 0.1724s/iter; left time: 149847.9439s
	iters: 3700, epoch: 3 | loss: 0.1535915
	speed: 0.1723s/iter; left time: 149747.6417s
	iters: 3800, epoch: 3 | loss: 0.1579330
	speed: 0.1721s/iter; left time: 149492.7364s
	iters: 3900, epoch: 3 | loss: 0.3576484
	speed: 0.1730s/iter; left time: 150305.9062s
	iters: 4000, epoch: 3 | loss: 0.3050736
	speed: 0.1723s/iter; left time: 149681.1089s
	iters: 4100, epoch: 3 | loss: 0.2723989
	speed: 0.1727s/iter; left time: 149976.3494s
	iters: 4200, epoch: 3 | loss: 0.2655007
	speed: 0.1719s/iter; left time: 149250.4960s
	iters: 4300, epoch: 3 | loss: 0.2072422
	speed: 0.1725s/iter; left time: 149739.7957s
	iters: 4400, epoch: 3 | loss: 0.2231530
	speed: 0.1723s/iter; left time: 149627.3588s
Epoch: 3 cost time: 760.6790056228638
Epoch: 3, Steps: 4407 | Train Loss: 0.1704418 Vali Loss: 0.3081490 Test Loss: 0.3951127
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.3299247
	speed: 5.5660s/iter; left time: 4831702.5840s
	iters: 200, epoch: 4 | loss: 0.2731341
	speed: 0.1682s/iter; left time: 145978.1249s
	iters: 300, epoch: 4 | loss: 0.2191308
	speed: 0.1670s/iter; left time: 144934.6299s
	iters: 400, epoch: 4 | loss: 0.2666216
	speed: 0.1673s/iter; left time: 145142.5165s
	iters: 500, epoch: 4 | loss: 0.2539741
	speed: 0.1676s/iter; left time: 145401.0120s
	iters: 600, epoch: 4 | loss: 0.2184257
	speed: 0.1673s/iter; left time: 145182.9778s
	iters: 700, epoch: 4 | loss: 0.2125435
	speed: 0.1675s/iter; left time: 145334.4819s
	iters: 800, epoch: 4 | loss: 0.1908406
	speed: 0.1671s/iter; left time: 144913.3732s
	iters: 900, epoch: 4 | loss: 0.1559287
	speed: 0.1669s/iter; left time: 144720.0942s
	iters: 1000, epoch: 4 | loss: 0.1873456
	speed: 0.1670s/iter; left time: 144796.8801s
	iters: 1100, epoch: 4 | loss: 0.1680490
	speed: 0.1674s/iter; left time: 145159.2267s
	iters: 1200, epoch: 4 | loss: 0.1523816
	speed: 0.1670s/iter; left time: 144766.7925s
	iters: 1300, epoch: 4 | loss: 0.1707385
	speed: 0.1675s/iter; left time: 145176.4782s
	iters: 1400, epoch: 4 | loss: 0.1465518
	speed: 0.1673s/iter; left time: 145001.9923s
	iters: 1500, epoch: 4 | loss: 0.1602126
	speed: 0.1675s/iter; left time: 145149.9373s
	iters: 1600, epoch: 4 | loss: 0.2392830
	speed: 0.1669s/iter; left time: 144641.8036s
	iters: 1700, epoch: 4 | loss: 0.1935809
	speed: 0.1673s/iter; left time: 144985.7127s
	iters: 1800, epoch: 4 | loss: 0.2026743
	speed: 0.1669s/iter; left time: 144627.4539s
	iters: 1900, epoch: 4 | loss: 0.1906491
	speed: 0.1672s/iter; left time: 144845.6100s
	iters: 2000, epoch: 4 | loss: 0.1785376
	speed: 0.1672s/iter; left time: 144816.4637s
	iters: 2100, epoch: 4 | loss: 0.1748374
	speed: 0.1676s/iter; left time: 145197.2639s
	iters: 2200, epoch: 4 | loss: 0.1616995
	speed: 0.1671s/iter; left time: 144724.2676s
	iters: 2300, epoch: 4 | loss: 0.1547727
	speed: 0.1671s/iter; left time: 144647.7327s
	iters: 2400, epoch: 4 | loss: 0.1688565
	speed: 0.1672s/iter; left time: 144795.1731s
	iters: 2500, epoch: 4 | loss: 0.1462488
	speed: 0.1667s/iter; left time: 144324.3404s
	iters: 2600, epoch: 4 | loss: 0.1541994
	speed: 0.1678s/iter; left time: 145250.0216s
	iters: 2700, epoch: 4 | loss: 0.1847910
	speed: 0.1671s/iter; left time: 144582.5252s
	iters: 2800, epoch: 4 | loss: 0.1621153
	speed: 0.1680s/iter; left time: 145387.8814s
	iters: 2900, epoch: 4 | loss: 0.1394597
	speed: 0.1679s/iter; left time: 145318.9823s
	iters: 3000, epoch: 4 | loss: 0.3035514
	speed: 0.1681s/iter; left time: 145468.9240s
	iters: 3100, epoch: 4 | loss: 0.1583207
	speed: 0.1681s/iter; left time: 145406.9269s
	iters: 3200, epoch: 4 | loss: 0.1536436
	speed: 0.1686s/iter; left time: 145841.1684s
	iters: 3300, epoch: 4 | loss: 0.1574163
	speed: 0.1682s/iter; left time: 145453.9932s
	iters: 3400, epoch: 4 | loss: 0.1609936
	speed: 0.1685s/iter; left time: 145684.9435s
	iters: 3500, epoch: 4 | loss: 0.1545586
	speed: 0.1673s/iter; left time: 144666.7468s
	iters: 3600, epoch: 4 | loss: 0.1521041
	speed: 0.1670s/iter; left time: 144422.3888s
	iters: 3700, epoch: 4 | loss: 0.1506272
	speed: 0.1674s/iter; left time: 144685.0722s
	iters: 3800, epoch: 4 | loss: 0.1517300
	speed: 0.1673s/iter; left time: 144600.0248s
	iters: 3900, epoch: 4 | loss: 0.1648871
	speed: 0.1669s/iter; left time: 144277.9763s
	iters: 4000, epoch: 4 | loss: 0.1573943
	speed: 0.1674s/iter; left time: 144685.1393s
	iters: 4100, epoch: 4 | loss: 0.1618975
	speed: 0.1672s/iter; left time: 144484.8333s
	iters: 4200, epoch: 4 | loss: 0.1478484
	speed: 0.1673s/iter; left time: 144561.6207s
	iters: 4300, epoch: 4 | loss: 0.1654897
	speed: 0.1678s/iter; left time: 144938.4384s
	iters: 4400, epoch: 4 | loss: 0.1589938
	speed: 0.1670s/iter; left time: 144267.8984s
Epoch: 4 cost time: 738.3609211444855
Epoch: 4, Steps: 4407 | Train Loss: 0.1870018 Vali Loss: 0.2785710 Test Loss: 0.5161523
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.1630232
	speed: 5.5521s/iter; left time: 4795162.6657s
	iters: 200, epoch: 5 | loss: 0.1720464
	speed: 0.1675s/iter; left time: 144626.6262s
	iters: 300, epoch: 5 | loss: 0.1384354
	speed: 0.1671s/iter; left time: 144268.9037s
	iters: 400, epoch: 5 | loss: 0.1568403
	speed: 0.1670s/iter; left time: 144157.3777s
	iters: 500, epoch: 5 | loss: 0.1611591
	speed: 0.1669s/iter; left time: 144039.1413s
	iters: 600, epoch: 5 | loss: 0.1210543
	speed: 0.1670s/iter; left time: 144122.5225s
	iters: 700, epoch: 5 | loss: 0.1558685
	speed: 0.1671s/iter; left time: 144211.9283s
	iters: 800, epoch: 5 | loss: 0.1486608
	speed: 0.1672s/iter; left time: 144246.4403s
	iters: 900, epoch: 5 | loss: 0.1549875
	speed: 0.1672s/iter; left time: 144296.1765s
	iters: 1000, epoch: 5 | loss: 0.1451479
	speed: 0.1672s/iter; left time: 144262.3352s
	iters: 1100, epoch: 5 | loss: 0.1576561
	speed: 0.1677s/iter; left time: 144634.9780s
	iters: 1200, epoch: 5 | loss: 0.1367543
	speed: 0.1672s/iter; left time: 144228.1904s
	iters: 1300, epoch: 5 | loss: 0.1433283
	speed: 0.1667s/iter; left time: 143791.7571s
	iters: 1400, epoch: 5 | loss: 0.1615181
	speed: 0.1665s/iter; left time: 143590.0193s
	iters: 1500, epoch: 5 | loss: 0.1476906
	speed: 0.1671s/iter; left time: 144066.8064s
	iters: 1600, epoch: 5 | loss: 0.1487913
	speed: 0.1665s/iter; left time: 143533.0009s
	iters: 1700, epoch: 5 | loss: 0.1315664
	speed: 0.1663s/iter; left time: 143364.2331s
	iters: 1800, epoch: 5 | loss: 0.1415413
	speed: 0.1676s/iter; left time: 144427.6956s
	iters: 1900, epoch: 5 | loss: 0.1257892
	speed: 0.1668s/iter; left time: 143740.5670s
	iters: 2000, epoch: 5 | loss: 0.1462860
	speed: 0.1661s/iter; left time: 143140.3362s
	iters: 2100, epoch: 5 | loss: 0.1406557
	speed: 0.1669s/iter; left time: 143780.4649s
	iters: 2200, epoch: 5 | loss: 0.1371711
	speed: 0.1664s/iter; left time: 143338.2307s
	iters: 2300, epoch: 5 | loss: 0.1588014
	speed: 0.1667s/iter; left time: 143573.6335s
	iters: 2400, epoch: 5 | loss: 0.1404221
	speed: 0.1670s/iter; left time: 143846.3772s
	iters: 2500, epoch: 5 | loss: 0.1501894
	speed: 0.1675s/iter; left time: 144263.8374s
	iters: 2600, epoch: 5 | loss: 0.1394063
	speed: 0.1670s/iter; left time: 143833.1485s
	iters: 2700, epoch: 5 | loss: 0.2605258
	speed: 0.1671s/iter; left time: 143860.4948s
	iters: 2800, epoch: 5 | loss: 0.2021760
	speed: 0.1671s/iter; left time: 143826.6967s
	iters: 2900, epoch: 5 | loss: 0.1876688
	speed: 0.1664s/iter; left time: 143236.0050s
	iters: 3000, epoch: 5 | loss: 0.1484651
	speed: 0.1669s/iter; left time: 143633.7964s
	iters: 3100, epoch: 5 | loss: 0.2686691
	speed: 0.1669s/iter; left time: 143662.9885s
	iters: 3200, epoch: 5 | loss: 0.2128989
	speed: 0.1670s/iter; left time: 143725.4824s
	iters: 3300, epoch: 5 | loss: 0.1753702
	speed: 0.1678s/iter; left time: 144352.0090s
	iters: 3400, epoch: 5 | loss: 0.1430562
	speed: 0.1668s/iter; left time: 143508.1657s
	iters: 3500, epoch: 5 | loss: 0.1596078
	speed: 0.1666s/iter; left time: 143329.9534s
	iters: 3600, epoch: 5 | loss: 0.1456437
	speed: 0.1668s/iter; left time: 143446.6772s
	iters: 3700, epoch: 5 | loss: 0.1550241
	speed: 0.1666s/iter; left time: 143279.4271s
	iters: 3800, epoch: 5 | loss: 0.1526147
	speed: 0.1670s/iter; left time: 143582.8706s
	iters: 3900, epoch: 5 | loss: 0.1559182
	speed: 0.1669s/iter; left time: 143484.8060s
	iters: 4000, epoch: 5 | loss: 0.1440473
	speed: 0.1670s/iter; left time: 143600.3475s
	iters: 4100, epoch: 5 | loss: 0.1551151
	speed: 0.1663s/iter; left time: 142943.0857s
	iters: 4200, epoch: 5 | loss: 0.1389487
	speed: 0.1673s/iter; left time: 143776.4290s
	iters: 4300, epoch: 5 | loss: 0.1575074
	speed: 0.1671s/iter; left time: 143648.7598s
	iters: 4400, epoch: 5 | loss: 0.1490382
	speed: 0.1667s/iter; left time: 143229.0840s
Epoch: 5 cost time: 736.2060630321503
Epoch: 5, Steps: 4407 | Train Loss: 0.1593235 Vali Loss: 0.2705655 Test Loss: 0.4680450
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.1446277
	speed: 5.5612s/iter; left time: 4778581.8958s
	iters: 200, epoch: 6 | loss: 0.1323133
	speed: 0.1667s/iter; left time: 143191.2983s
	iters: 300, epoch: 6 | loss: 0.1552862
	speed: 0.1671s/iter; left time: 143562.8468s
	iters: 400, epoch: 6 | loss: 0.1499594
	speed: 0.1671s/iter; left time: 143528.9981s
	iters: 500, epoch: 6 | loss: 0.1444885
	speed: 0.1671s/iter; left time: 143532.3724s
	iters: 600, epoch: 6 | loss: 0.1337600
	speed: 0.1669s/iter; left time: 143350.9037s
	iters: 700, epoch: 6 | loss: 0.1368913
	speed: 0.1669s/iter; left time: 143311.6957s
	iters: 800, epoch: 6 | loss: 0.1321359
	speed: 0.1670s/iter; left time: 143394.8574s
	iters: 900, epoch: 6 | loss: 0.2055391
	speed: 0.1672s/iter; left time: 143570.5864s
	iters: 1000, epoch: 6 | loss: 0.1913221
	speed: 0.1686s/iter; left time: 144737.4026s
	iters: 1100, epoch: 6 | loss: 0.1624812
	speed: 0.1687s/iter; left time: 144813.2651s
	iters: 1200, epoch: 6 | loss: 0.1661428
	speed: 0.1685s/iter; left time: 144595.1124s
	iters: 1300, epoch: 6 | loss: 0.1493440
	speed: 0.1690s/iter; left time: 145001.3977s
	iters: 1400, epoch: 6 | loss: 0.1597264
	speed: 0.1685s/iter; left time: 144578.0011s
	iters: 1500, epoch: 6 | loss: 0.1427433
	speed: 0.1692s/iter; left time: 145192.4600s
	iters: 1600, epoch: 6 | loss: 0.1462213
	speed: 0.1685s/iter; left time: 144525.4103s
	iters: 1700, epoch: 6 | loss: 0.1553907
	speed: 0.1674s/iter; left time: 143545.4930s
	iters: 1800, epoch: 6 | loss: 0.1372521
	speed: 0.1669s/iter; left time: 143092.2288s
	iters: 1900, epoch: 6 | loss: 0.1359255
	speed: 0.1670s/iter; left time: 143216.1988s
	iters: 2000, epoch: 6 | loss: 0.1351074
	speed: 0.1666s/iter; left time: 142844.1590s
	iters: 2100, epoch: 6 | loss: 0.1439850
	speed: 0.1677s/iter; left time: 143797.0665s
	iters: 2200, epoch: 6 | loss: 0.1291027
	speed: 0.1670s/iter; left time: 143189.3242s
	iters: 2300, epoch: 6 | loss: 0.1290025
	speed: 0.1668s/iter; left time: 142984.9448s
	iters: 2400, epoch: 6 | loss: 0.1397469
	speed: 0.1668s/iter; left time: 142980.7557s
	iters: 2500, epoch: 6 | loss: 0.1315566
	speed: 0.1676s/iter; left time: 143596.1407s
	iters: 2600, epoch: 6 | loss: 0.1343821
	speed: 0.1670s/iter; left time: 143041.9938s
	iters: 2700, epoch: 6 | loss: 0.1460000
	speed: 0.1674s/iter; left time: 143408.4334s
	iters: 2800, epoch: 6 | loss: 0.1335433
	speed: 0.1668s/iter; left time: 142849.0752s
	iters: 2900, epoch: 6 | loss: 0.1342407
	speed: 0.1672s/iter; left time: 143223.2688s
	iters: 3000, epoch: 6 | loss: 0.1248204
	speed: 0.1672s/iter; left time: 143149.3736s
	iters: 3100, epoch: 6 | loss: 0.1423271
	speed: 0.1665s/iter; left time: 142581.8188s
	iters: 3200, epoch: 6 | loss: 0.1413072
	speed: 0.1670s/iter; left time: 142951.4959s
	iters: 3300, epoch: 6 | loss: 0.1328660
	speed: 0.1674s/iter; left time: 143307.0017s
	iters: 3400, epoch: 6 | loss: 0.1262594
	speed: 0.1685s/iter; left time: 144247.2985s
	iters: 3500, epoch: 6 | loss: 0.1584485
	speed: 0.1688s/iter; left time: 144490.6341s
	iters: 3600, epoch: 6 | loss: 0.1346099
	speed: 0.1689s/iter; left time: 144503.9013s
	iters: 3700, epoch: 6 | loss: 0.1317816
	speed: 0.1692s/iter; left time: 144750.1902s
	iters: 3800, epoch: 6 | loss: 0.1362944
	speed: 0.1689s/iter; left time: 144532.7319s
	iters: 3900, epoch: 6 | loss: 0.1349555
	speed: 0.1692s/iter; left time: 144726.6568s
	iters: 4000, epoch: 6 | loss: 0.1367831
	speed: 0.1684s/iter; left time: 144067.1902s
	iters: 4100, epoch: 6 | loss: 0.1321587
	speed: 0.1692s/iter; left time: 144732.2269s
	iters: 4200, epoch: 6 | loss: 0.1357913
	speed: 0.1684s/iter; left time: 144032.7238s
	iters: 4300, epoch: 6 | loss: 0.1247610
	speed: 0.1686s/iter; left time: 144167.4436s
	iters: 4400, epoch: 6 | loss: 0.1392762
	speed: 0.1689s/iter; left time: 144373.8815s
Epoch: 6 cost time: 739.8568739891052
Epoch: 6, Steps: 4407 | Train Loss: 0.1450241 Vali Loss: 0.2748790 Test Loss: 0.4843612
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.1340533
	speed: 6.9044s/iter; left time: 5902285.1212s
	iters: 200, epoch: 7 | loss: 0.1300271
	speed: 0.1671s/iter; left time: 142806.9727s
	iters: 300, epoch: 7 | loss: 0.1616442
	speed: 0.1667s/iter; left time: 142430.7824s
	iters: 400, epoch: 7 | loss: 0.1545678
	speed: 0.1670s/iter; left time: 142677.4425s
	iters: 500, epoch: 7 | loss: 0.2582511
	speed: 0.1667s/iter; left time: 142446.7071s
	iters: 600, epoch: 7 | loss: 0.2320710
	speed: 0.1665s/iter; left time: 142282.8644s
	iters: 700, epoch: 7 | loss: 0.2026380
	speed: 0.1660s/iter; left time: 141808.4128s
	iters: 800, epoch: 7 | loss: 0.2196598
	speed: 0.1659s/iter; left time: 141739.9110s
	iters: 900, epoch: 7 | loss: 0.2207493
	speed: 0.1663s/iter; left time: 141990.8925s
	iters: 1000, epoch: 7 | loss: 0.1938549
	speed: 0.1661s/iter; left time: 141856.9591s
	iters: 1100, epoch: 7 | loss: 0.2406577
	speed: 0.1661s/iter; left time: 141844.3273s
	iters: 1200, epoch: 7 | loss: 0.1901503
	speed: 0.1664s/iter; left time: 142033.2477s
	iters: 1300, epoch: 7 | loss: 0.1984047
	speed: 0.1664s/iter; left time: 142023.3829s
	iters: 1400, epoch: 7 | loss: 0.1556360
	speed: 0.1667s/iter; left time: 142290.4818s
	iters: 1500, epoch: 7 | loss: 0.1900798
	speed: 0.1664s/iter; left time: 142025.0180s
	iters: 1600, epoch: 7 | loss: 0.1868158
	speed: 0.1662s/iter; left time: 141815.7950s
	iters: 1700, epoch: 7 | loss: 0.1626631
	speed: 0.1672s/iter; left time: 142647.1189s
	iters: 1800, epoch: 7 | loss: 0.1651653
	speed: 0.1671s/iter; left time: 142591.5255s
	iters: 1900, epoch: 7 | loss: 0.2130394
	speed: 0.1671s/iter; left time: 142531.8674s
	iters: 2000, epoch: 7 | loss: 0.2014903
	speed: 0.1664s/iter; left time: 141957.5729s
	iters: 2100, epoch: 7 | loss: 0.1718393
	speed: 0.1662s/iter; left time: 141746.7183s
	iters: 2200, epoch: 7 | loss: 0.1788809
	speed: 0.1664s/iter; left time: 141938.1123s
	iters: 2300, epoch: 7 | loss: 0.1840880
	speed: 0.1661s/iter; left time: 141638.8767s
	iters: 2400, epoch: 7 | loss: 0.1604011
	speed: 0.1671s/iter; left time: 142432.2006s
	iters: 2500, epoch: 7 | loss: 0.1750851
	speed: 0.1667s/iter; left time: 142144.7107s
	iters: 2600, epoch: 7 | loss: 0.1467297
	speed: 0.1668s/iter; left time: 142181.7954s
	iters: 2700, epoch: 7 | loss: 0.1754624
	speed: 0.1669s/iter; left time: 142209.1324s
	iters: 2800, epoch: 7 | loss: 0.1705235
	speed: 0.1667s/iter; left time: 142068.8963s
	iters: 2900, epoch: 7 | loss: 0.1559872
	speed: 0.1672s/iter; left time: 142483.2349s
	iters: 3000, epoch: 7 | loss: 0.1593842
	speed: 0.1672s/iter; left time: 142481.4442s
	iters: 3100, epoch: 7 | loss: 0.1611239
	speed: 0.1669s/iter; left time: 142147.4999s
	iters: 3200, epoch: 7 | loss: 0.1756526
	speed: 0.1670s/iter; left time: 142271.0223s
	iters: 3300, epoch: 7 | loss: 0.1446505
	speed: 0.1672s/iter; left time: 142364.8156s
	iters: 3400, epoch: 7 | loss: 0.1685444
	speed: 0.1667s/iter; left time: 141950.8051s
	iters: 3500, epoch: 7 | loss: 0.1566225
	speed: 0.1672s/iter; left time: 142331.2716s
	iters: 3600, epoch: 7 | loss: 0.1699879
	speed: 0.1666s/iter; left time: 141825.5203s
	iters: 3700, epoch: 7 | loss: 0.1471648
	speed: 0.1668s/iter; left time: 141973.0834s
	iters: 3800, epoch: 7 | loss: 0.1741093
	speed: 0.1667s/iter; left time: 141898.3323s
	iters: 3900, epoch: 7 | loss: 0.1811039
	speed: 0.1668s/iter; left time: 141994.6911s
	iters: 4000, epoch: 7 | loss: 0.1520296
	speed: 0.1669s/iter; left time: 142026.9322s
	iters: 4100, epoch: 7 | loss: 0.1596375
	speed: 0.1668s/iter; left time: 141928.7428s
	iters: 4200, epoch: 7 | loss: 0.1451760
	speed: 0.1671s/iter; left time: 142194.0417s
	iters: 4300, epoch: 7 | loss: 0.1634321
	speed: 0.1667s/iter; left time: 141781.6967s
	iters: 4400, epoch: 7 | loss: 0.1516661
	speed: 0.1667s/iter; left time: 141827.4297s
Epoch: 7 cost time: 735.1818101406097
Epoch: 7, Steps: 4407 | Train Loss: 0.1747652 Vali Loss: 0.2778964 Test Loss: 0.4207149
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems08_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 40085
test shape: (40085, 1, 336, 212) (40085, 1, 336, 212)
test shape: (40085, 336, 212) (40085, 336, 212)
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=212, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems08_h.csv', dec_in=212, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=212, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems08_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 141041
val 19877
test 40085
	iters: 100, epoch: 1 | loss: 0.3177589
	speed: 0.1800s/iter; left time: 158605.8329s
	iters: 200, epoch: 1 | loss: 0.3207503
	speed: 0.1741s/iter; left time: 153394.0496s
	iters: 300, epoch: 1 | loss: 0.3372318
	speed: 0.1734s/iter; left time: 152802.7895s
	iters: 400, epoch: 1 | loss: 0.2512001
	speed: 0.1739s/iter; left time: 153244.2887s
	iters: 500, epoch: 1 | loss: 0.2353217
	speed: 0.1746s/iter; left time: 153835.9573s
	iters: 600, epoch: 1 | loss: 0.2231016
	speed: 0.1746s/iter; left time: 153825.6590s
	iters: 700, epoch: 1 | loss: 0.2305349
	speed: 0.1755s/iter; left time: 154573.2635s
	iters: 800, epoch: 1 | loss: 0.2120427
	speed: 0.1750s/iter; left time: 154133.7809s
	iters: 900, epoch: 1 | loss: 0.2289743
	speed: 0.1735s/iter; left time: 152758.8698s
	iters: 1000, epoch: 1 | loss: 0.1922290
	speed: 0.1736s/iter; left time: 152860.3495s
	iters: 1100, epoch: 1 | loss: 0.2255012
	speed: 0.1736s/iter; left time: 152823.9906s
	iters: 1200, epoch: 1 | loss: 0.2066924
	speed: 0.1727s/iter; left time: 152007.4975s
	iters: 1300, epoch: 1 | loss: 0.1973448
	speed: 0.1726s/iter; left time: 151945.2167s
	iters: 1400, epoch: 1 | loss: 0.2160975
	speed: 0.1730s/iter; left time: 152239.8474s
	iters: 1500, epoch: 1 | loss: 0.2134407
	speed: 0.1728s/iter; left time: 152022.9981s
	iters: 1600, epoch: 1 | loss: 0.2276520
	speed: 0.1729s/iter; left time: 152108.0757s
	iters: 1700, epoch: 1 | loss: 0.1992790
	speed: 0.1721s/iter; left time: 151425.9769s
	iters: 1800, epoch: 1 | loss: 0.1926545
	speed: 0.1722s/iter; left time: 151457.6037s
	iters: 1900, epoch: 1 | loss: 0.1934034
	speed: 0.1727s/iter; left time: 151919.7620s
	iters: 2000, epoch: 1 | loss: 0.3243462
	speed: 0.1729s/iter; left time: 152008.5269s
	iters: 2100, epoch: 1 | loss: 0.2849682
	speed: 0.1728s/iter; left time: 151914.1562s
	iters: 2200, epoch: 1 | loss: 0.3023774
	speed: 0.1722s/iter; left time: 151355.6169s
	iters: 2300, epoch: 1 | loss: 0.3140023
	speed: 0.1724s/iter; left time: 151519.0424s
	iters: 2400, epoch: 1 | loss: 0.2899978
	speed: 0.1738s/iter; left time: 152773.9375s
	iters: 2500, epoch: 1 | loss: 0.2921255
	speed: 0.1731s/iter; left time: 152164.4106s
	iters: 2600, epoch: 1 | loss: 0.2566455
	speed: 0.1722s/iter; left time: 151361.9896s
	iters: 2700, epoch: 1 | loss: 0.2780780
	speed: 0.1725s/iter; left time: 151568.6005s
	iters: 2800, epoch: 1 | loss: 0.2392139
	speed: 0.1722s/iter; left time: 151303.4756s
	iters: 2900, epoch: 1 | loss: 0.2591516
	speed: 0.1719s/iter; left time: 151038.0846s
	iters: 3000, epoch: 1 | loss: 0.2471763
	speed: 0.1739s/iter; left time: 152719.6872s
	iters: 3100, epoch: 1 | loss: 0.2748790
	speed: 0.1737s/iter; left time: 152555.2225s
	iters: 3200, epoch: 1 | loss: 0.2479904
	speed: 0.1722s/iter; left time: 151259.9895s
	iters: 3300, epoch: 1 | loss: 0.2437214
	speed: 0.1727s/iter; left time: 151664.1818s
	iters: 3400, epoch: 1 | loss: 0.2422145
	speed: 0.1717s/iter; left time: 150773.3434s
	iters: 3500, epoch: 1 | loss: 0.2394539
	speed: 0.1717s/iter; left time: 150735.9624s
	iters: 3600, epoch: 1 | loss: 0.2184867
	speed: 0.1725s/iter; left time: 151397.9003s
	iters: 3700, epoch: 1 | loss: 0.2238721
	speed: 0.1719s/iter; left time: 150913.7536s
	iters: 3800, epoch: 1 | loss: 0.2327763
	speed: 0.1728s/iter; left time: 151618.0211s
	iters: 3900, epoch: 1 | loss: 0.2000628
	speed: 0.1740s/iter; left time: 152694.3321s
	iters: 4000, epoch: 1 | loss: 0.1937751
	speed: 0.1735s/iter; left time: 152213.3145s
	iters: 4100, epoch: 1 | loss: 0.1918258
	speed: 0.1750s/iter; left time: 153520.1158s
	iters: 4200, epoch: 1 | loss: 0.2053835
	speed: 0.1752s/iter; left time: 153691.5735s
	iters: 4300, epoch: 1 | loss: 0.1929148
	speed: 0.1756s/iter; left time: 154030.1103s
	iters: 4400, epoch: 1 | loss: 0.1996157
	speed: 0.1756s/iter; left time: 153980.9132s
Epoch: 1 cost time: 764.5995404720306
Epoch: 1, Steps: 4407 | Train Loss: 0.2437660 Vali Loss: 0.2909469 Test Loss: 0.4510157
Validation loss decreased (inf --> 0.290947).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2109523
	speed: 5.6499s/iter; left time: 4954323.7045s
	iters: 200, epoch: 2 | loss: 0.2191943
	speed: 0.1757s/iter; left time: 154066.3788s
	iters: 300, epoch: 2 | loss: 0.1864646
	speed: 0.1752s/iter; left time: 153607.7685s
	iters: 400, epoch: 2 | loss: 0.2171421
	speed: 0.1755s/iter; left time: 153839.9079s
	iters: 500, epoch: 2 | loss: 0.1966608
	speed: 0.1763s/iter; left time: 154492.8797s
	iters: 600, epoch: 2 | loss: 0.1725138
	speed: 0.1763s/iter; left time: 154506.4955s
	iters: 700, epoch: 2 | loss: 0.1813949
	speed: 0.1761s/iter; left time: 154284.3472s
	iters: 800, epoch: 2 | loss: 0.1900413
	speed: 0.1762s/iter; left time: 154409.5830s
	iters: 900, epoch: 2 | loss: 0.1765580
	speed: 0.1767s/iter; left time: 154825.1065s
	iters: 1000, epoch: 2 | loss: 0.1931863
	speed: 0.1759s/iter; left time: 154049.5707s
	iters: 1100, epoch: 2 | loss: 0.1846598
	speed: 0.1764s/iter; left time: 154472.5858s
	iters: 1200, epoch: 2 | loss: 0.1645955
	speed: 0.1761s/iter; left time: 154247.7583s
	iters: 1300, epoch: 2 | loss: 0.1956972
	speed: 0.1766s/iter; left time: 154664.7648s
	iters: 1400, epoch: 2 | loss: 0.1700961
	speed: 0.1762s/iter; left time: 154298.5231s
	iters: 1500, epoch: 2 | loss: 0.1964111
	speed: 0.1757s/iter; left time: 153848.5793s
	iters: 1600, epoch: 2 | loss: 0.1878321
	speed: 0.1761s/iter; left time: 154133.7198s
	iters: 1700, epoch: 2 | loss: 0.1888071
	speed: 0.1756s/iter; left time: 153744.4671s
	iters: 1800, epoch: 2 | loss: 0.1751493
	speed: 0.1758s/iter; left time: 153897.2418s
	iters: 1900, epoch: 2 | loss: 0.1872267
	speed: 0.1759s/iter; left time: 153946.2841s
	iters: 2000, epoch: 2 | loss: 0.1703513
	speed: 0.1762s/iter; left time: 154159.9938s
	iters: 2100, epoch: 2 | loss: 0.1794430
	speed: 0.1764s/iter; left time: 154295.3811s
	iters: 2200, epoch: 2 | loss: 0.1787062
	speed: 0.1760s/iter; left time: 153975.1351s
	iters: 2300, epoch: 2 | loss: 0.1673484
	speed: 0.1761s/iter; left time: 154035.9023s
	iters: 2400, epoch: 2 | loss: 0.1645692
	speed: 0.1765s/iter; left time: 154346.7477s
	iters: 2500, epoch: 2 | loss: 0.1688992
	speed: 0.1762s/iter; left time: 154063.6516s
	iters: 2600, epoch: 2 | loss: 0.1738150
	speed: 0.1758s/iter; left time: 153737.4000s
	iters: 2700, epoch: 2 | loss: 0.5410117
	speed: 0.1757s/iter; left time: 153588.4144s
	iters: 2800, epoch: 2 | loss: 0.2913674
	speed: 0.1761s/iter; left time: 153918.6362s
	iters: 2900, epoch: 2 | loss: 0.2849373
	speed: 0.1760s/iter; left time: 153866.0826s
	iters: 3000, epoch: 2 | loss: 0.2824667
	speed: 0.1761s/iter; left time: 153938.5671s
	iters: 3100, epoch: 2 | loss: 0.2615541
	speed: 0.1761s/iter; left time: 153898.4601s
	iters: 3200, epoch: 2 | loss: 0.2446774
	speed: 0.1762s/iter; left time: 154003.0967s
	iters: 3300, epoch: 2 | loss: 0.2696379
	speed: 0.1759s/iter; left time: 153713.4384s
	iters: 3400, epoch: 2 | loss: 0.2862910
	speed: 0.1758s/iter; left time: 153607.2838s
	iters: 3500, epoch: 2 | loss: 0.2869022
	speed: 0.1760s/iter; left time: 153698.3878s
	iters: 3600, epoch: 2 | loss: 0.2437092
	speed: 0.1759s/iter; left time: 153599.2790s
	iters: 3700, epoch: 2 | loss: 0.2514381
	speed: 0.1761s/iter; left time: 153750.3631s
	iters: 3800, epoch: 2 | loss: 0.2554498
	speed: 0.1763s/iter; left time: 153959.6089s
	iters: 3900, epoch: 2 | loss: 0.2205978
	speed: 0.1758s/iter; left time: 153461.2315s
	iters: 4000, epoch: 2 | loss: 0.2215291
	speed: 0.1761s/iter; left time: 153739.4355s
	iters: 4100, epoch: 2 | loss: 0.2168338
	speed: 0.1757s/iter; left time: 153356.3078s
	iters: 4200, epoch: 2 | loss: 0.2220863
	speed: 0.1763s/iter; left time: 153887.7188s
	iters: 4300, epoch: 2 | loss: 0.2013599
	speed: 0.1758s/iter; left time: 153441.9425s
	iters: 4400, epoch: 2 | loss: 0.1752992
	speed: 0.1757s/iter; left time: 153290.9319s
Epoch: 2 cost time: 776.3811202049255
Epoch: 2, Steps: 4407 | Train Loss: 0.2098815 Vali Loss: 0.3340335 Test Loss: 0.4274471
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.1957341
	speed: 5.6707s/iter; left time: 4947623.8644s
	iters: 200, epoch: 3 | loss: 0.1912588
	speed: 0.1741s/iter; left time: 151908.8803s
	iters: 300, epoch: 3 | loss: 0.1894936
	speed: 0.1742s/iter; left time: 151984.7228s
	iters: 400, epoch: 3 | loss: 0.2684590
	speed: 0.1740s/iter; left time: 151771.3874s
	iters: 500, epoch: 3 | loss: 0.2091155
	speed: 0.1732s/iter; left time: 151046.6259s
	iters: 600, epoch: 3 | loss: 0.2137928
	speed: 0.1736s/iter; left time: 151389.6157s
	iters: 700, epoch: 3 | loss: 0.1840223
	speed: 0.1739s/iter; left time: 151585.8844s
	iters: 800, epoch: 3 | loss: 0.1926954
	speed: 0.1752s/iter; left time: 152770.9868s
	iters: 900, epoch: 3 | loss: 0.2014794
	speed: 0.1741s/iter; left time: 151764.0618s
	iters: 1000, epoch: 3 | loss: 0.2065492
	speed: 0.1736s/iter; left time: 151338.0721s
	iters: 1100, epoch: 3 | loss: 0.1870939
	speed: 0.1747s/iter; left time: 152247.2561s
	iters: 1200, epoch: 3 | loss: 0.1963262
	speed: 0.1744s/iter; left time: 151954.1247s
	iters: 1300, epoch: 3 | loss: 0.2154610
	speed: 0.1746s/iter; left time: 152156.3787s
	iters: 1400, epoch: 3 | loss: 0.1827490
	speed: 0.1749s/iter; left time: 152332.6562s
	iters: 1500, epoch: 3 | loss: 0.1935326
	speed: 0.1731s/iter; left time: 150810.6689s
	iters: 1600, epoch: 3 | loss: 0.1806266
	speed: 0.1729s/iter; left time: 150559.2096s
	iters: 1700, epoch: 3 | loss: 0.1872439
	speed: 0.1751s/iter; left time: 152475.4744s
	iters: 1800, epoch: 3 | loss: 0.1660207
	speed: 0.1751s/iter; left time: 152516.5502s
	iters: 1900, epoch: 3 | loss: 0.1844360
	speed: 0.1744s/iter; left time: 151863.2578s
	iters: 2000, epoch: 3 | loss: 0.1459271
	speed: 0.1743s/iter; left time: 151737.5797s
	iters: 2100, epoch: 3 | loss: 0.1606415
	speed: 0.1740s/iter; left time: 151490.2455s
	iters: 2200, epoch: 3 | loss: 0.1932702
	speed: 0.1741s/iter; left time: 151564.6831s
	iters: 2300, epoch: 3 | loss: 0.1650269
	speed: 0.1740s/iter; left time: 151435.2652s
	iters: 2400, epoch: 3 | loss: 0.1870817
	speed: 0.1744s/iter; left time: 151786.6651s
	iters: 2500, epoch: 3 | loss: 0.1879140
	speed: 0.1750s/iter; left time: 152235.2866s
	iters: 2600, epoch: 3 | loss: 0.1733016
	speed: 0.1734s/iter; left time: 150884.7736s
	iters: 2700, epoch: 3 | loss: 0.1782499
	speed: 0.1749s/iter; left time: 152139.2150s
	iters: 2800, epoch: 3 | loss: 0.1769270
	speed: 0.1736s/iter; left time: 151013.6403s
	iters: 2900, epoch: 3 | loss: 0.1662298
	speed: 0.1760s/iter; left time: 153100.1274s
	iters: 3000, epoch: 3 | loss: 0.1789670
	speed: 0.1762s/iter; left time: 153235.6832s
	iters: 3100, epoch: 3 | loss: 0.1729377
	speed: 0.1755s/iter; left time: 152618.6606s
	iters: 3200, epoch: 3 | loss: 0.1765455
	speed: 0.1759s/iter; left time: 152925.6866s
	iters: 3300, epoch: 3 | loss: 0.1734521
	speed: 0.1755s/iter; left time: 152539.3934s
	iters: 3400, epoch: 3 | loss: 0.1510078
	speed: 0.1759s/iter; left time: 152891.8825s
	iters: 3500, epoch: 3 | loss: 0.1793600
	speed: 0.1748s/iter; left time: 151905.3036s
	iters: 3600, epoch: 3 | loss: 0.1459363
	speed: 0.1733s/iter; left time: 150628.3843s
	iters: 3700, epoch: 3 | loss: 0.1716733
	speed: 0.1742s/iter; left time: 151322.9373s
	iters: 3800, epoch: 3 | loss: 0.1692362
	speed: 0.1755s/iter; left time: 152499.3377s
	iters: 3900, epoch: 3 | loss: 0.1564057
	speed: 0.1757s/iter; left time: 152647.2705s
	iters: 4000, epoch: 3 | loss: 0.2761152
	speed: 0.1756s/iter; left time: 152485.2425s
	iters: 4100, epoch: 3 | loss: 0.2323667
	speed: 0.1758s/iter; left time: 152685.8800s
	iters: 4200, epoch: 3 | loss: 0.1812295
	speed: 0.1761s/iter; left time: 152886.9870s
	iters: 4300, epoch: 3 | loss: 0.1499463
	speed: 0.1755s/iter; left time: 152420.7263s
	iters: 4400, epoch: 3 | loss: 0.1454566
	speed: 0.1756s/iter; left time: 152414.9644s
Epoch: 3 cost time: 770.2802391052246
Epoch: 3, Steps: 4407 | Train Loss: 0.1859887 Vali Loss: 0.2650402 Test Loss: 0.4875659
Validation loss decreased (0.290947 --> 0.265040).  Saving model ...
Traceback (most recent call last):
  File "/jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 372, in save
    _save(obj, opened_zipfile, pickle_module, pickle_protocol)
  File "/jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 493, in _save
    zip_file.write_record(name, buf_value, len(buf_value))
OSError: [Errno 122] Disk quota exceeded

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 373, in save
    return
  File "/jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 259, in __exit__
    self.file_like.write_end_of_file()
RuntimeError: [enforce fail at inline_container.cc:274] . unexpected pos 3689728 vs 3689616

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/hourdayweek/exp/exp_long_term_forecasting.py", line 214, in train
    early_stopping(vali_loss, self.model, path)
  File "/g/data/hn98/du/exlts/hourdayweek/utils/tools.py", line 51, in __call__
    self.save_checkpoint(val_loss, model, path)
  File "/g/data/hn98/du/exlts/hourdayweek/utils/tools.py", line 57, in save_checkpoint
    torch.save(model.state_dict(), path + '/' + 'checkpoint.pth')
  File "/jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 374, in save
    _legacy_save(obj, opened_file, pickle_module, pickle_protocol)
  File "/jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/serialization.py", line 214, in __exit__
    self.file_like.close()
OSError: [Errno 122] Disk quota exceeded
terminate called after throwing an instance of 'c10::Error'
  what():  [enforce fail at inline_container.cc:274] . unexpected pos 3689728 vs 3689616
frame #0: c10::ThrowEnforceNotMet(char const*, int, char const*, std::string const&, void const*) + 0x47 (0x1522466f06a7 in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1c99500 (0x152285a57500 in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #2: <unknown function> + 0x1c956d3 (0x152285a536d3 in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #3: caffe2::serialize::PyTorchStreamWriter::writeRecord(std::string const&, void const*, unsigned long, bool) + 0xa9 (0x152285a58609 in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #4: caffe2::serialize::PyTorchStreamWriter::writeEndOfFile() + 0xe1 (0x152285a59141 in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #5: caffe2::serialize::PyTorchStreamWriter::~PyTorchStreamWriter() + 0x115 (0x152285a59935 in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_cpu.so)
frame #6: <unknown function> + 0x654323 (0x15229512a323 in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #7: <unknown function> + 0x2c2b90 (0x152294d98b90 in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #8: <unknown function> + 0x2c3cfe (0x152294d99cfe in /jobfs/116450645.gadi-pbs/timesnet/lib/python3.8/site-packages/torch/lib/libtorch_python.so)
frame #9: python() [0x4e0800]
frame #10: python() [0x4f16a8]
frame #11: python() [0x4f1691]
frame #12: python() [0x4f1691]
frame #13: python() [0x4f1691]
frame #14: python() [0x4f1691]
frame #15: python() [0x4c9280]
<omitting python frames>
frame #21: __libc_start_main + 0xe5 (0x1522a3ee9d85 in /lib64/libc.so.6)
frame #22: python() [0x57a64d]

Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=212, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems08_h.csv', dec_in=212, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=212, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems08_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems08_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 141041
val 19877
test 40085
	iters: 100, epoch: 1 | loss: 0.3177589
	speed: 0.1791s/iter; left time: 157829.3000s
	iters: 200, epoch: 1 | loss: 0.3207503
	speed: 0.1749s/iter; left time: 154151.6846s
	iters: 300, epoch: 1 | loss: 0.3372318
	speed: 0.1751s/iter; left time: 154283.2639s
	iters: 400, epoch: 1 | loss: 0.2512001
	speed: 0.1764s/iter; left time: 155427.7987s
	iters: 500, epoch: 1 | loss: 0.2353216
	speed: 0.1752s/iter; left time: 154310.6181s
	iters: 600, epoch: 1 | loss: 0.2231016
	speed: 0.1741s/iter; left time: 153360.4454s
	iters: 700, epoch: 1 | loss: 0.2305348
	speed: 0.1742s/iter; left time: 153452.4900s
	iters: 800, epoch: 1 | loss: 0.2120427
	speed: 0.1740s/iter; left time: 153236.1894s
	iters: 900, epoch: 1 | loss: 0.2289744
	speed: 0.1733s/iter; left time: 152590.2579s
	iters: 1000, epoch: 1 | loss: 0.1922292
	speed: 0.1734s/iter; left time: 152677.1159s
	iters: 1100, epoch: 1 | loss: 0.2255010
	speed: 0.1737s/iter; left time: 152920.6614s
	iters: 1200, epoch: 1 | loss: 0.2066923
	speed: 0.1737s/iter; left time: 152880.9802s
	iters: 1300, epoch: 1 | loss: 0.1973448
	speed: 0.1738s/iter; left time: 152975.8906s
	iters: 1400, epoch: 1 | loss: 0.2160974
	speed: 0.1738s/iter; left time: 152917.6718s
	iters: 1500, epoch: 1 | loss: 0.2134407
	speed: 0.1737s/iter; left time: 152875.4940s
	iters: 1600, epoch: 1 | loss: 0.2276526
	speed: 0.1739s/iter; left time: 152997.8689s
	iters: 1700, epoch: 1 | loss: 0.1996017
	speed: 0.1737s/iter; left time: 152806.5963s
	iters: 1800, epoch: 1 | loss: 0.1922618
	speed: 0.1739s/iter; left time: 152965.8884s
	iters: 1900, epoch: 1 | loss: 0.1904024
	speed: 0.1735s/iter; left time: 152602.5169s
	iters: 2000, epoch: 1 | loss: 0.1970638
	speed: 0.1738s/iter; left time: 152856.7666s
	iters: 2100, epoch: 1 | loss: 0.1961447
	speed: 0.1735s/iter; left time: 152555.3936s
	iters: 2200, epoch: 1 | loss: 0.2177240
	speed: 0.1738s/iter; left time: 152819.4496s
	iters: 2300, epoch: 1 | loss: 0.1975748
	speed: 0.1743s/iter; left time: 153234.0035s
	iters: 2400, epoch: 1 | loss: 0.4139210
	speed: 0.1739s/iter; left time: 152828.5557s
	iters: 2500, epoch: 1 | loss: 0.3233172
	speed: 0.1748s/iter; left time: 153637.7916s
	iters: 2600, epoch: 1 | loss: 0.2774093
	speed: 0.1745s/iter; left time: 153321.8901s
	iters: 2700, epoch: 1 | loss: 0.2932351
	speed: 0.1745s/iter; left time: 153363.3167s
	iters: 2800, epoch: 1 | loss: 0.2547708
	speed: 0.1744s/iter; left time: 153256.4616s
	iters: 2900, epoch: 1 | loss: 0.2741012
	speed: 0.1746s/iter; left time: 153376.5690s
	iters: 3000, epoch: 1 | loss: 0.2666449
	speed: 0.1744s/iter; left time: 153216.2640s
	iters: 3100, epoch: 1 | loss: 0.2724501
	speed: 0.1740s/iter; left time: 152791.9760s
	iters: 3200, epoch: 1 | loss: 0.2290466
	speed: 0.1745s/iter; left time: 153211.7262s
	iters: 3300, epoch: 1 | loss: 0.2197481
	speed: 0.1739s/iter; left time: 152684.6814s
	iters: 3400, epoch: 1 | loss: 0.2185894
	speed: 0.1742s/iter; left time: 152961.0716s
	iters: 3500, epoch: 1 | loss: 0.2260721
	speed: 0.1743s/iter; left time: 153026.8019s
	iters: 3600, epoch: 1 | loss: 0.2134995
	speed: 0.1748s/iter; left time: 153453.1284s
	iters: 3700, epoch: 1 | loss: 0.2052493
	speed: 0.1747s/iter; left time: 153369.7299s
	iters: 3800, epoch: 1 | loss: 0.3487037
	speed: 0.1739s/iter; left time: 152658.0263s
	iters: 3900, epoch: 1 | loss: 0.2098088
	speed: 0.1741s/iter; left time: 152797.9613s
	iters: 4000, epoch: 1 | loss: 0.2735493
	speed: 0.1740s/iter; left time: 152625.4518s
	iters: 4100, epoch: 1 | loss: 0.2201773
	speed: 0.1741s/iter; left time: 152746.5070s
	iters: 4200, epoch: 1 | loss: 0.2203450
	speed: 0.1745s/iter; left time: 153090.9246s
	iters: 4300, epoch: 1 | loss: 0.1998677
	speed: 0.1746s/iter; left time: 153134.1081s
	iters: 4400, epoch: 1 | loss: 0.2054896
	speed: 0.1743s/iter; left time: 152866.4667s
Epoch: 1 cost time: 768.4251794815063
Epoch: 1, Steps: 4407 | Train Loss: 0.2413036 Vali Loss: 0.2896103 Test Loss: 0.4285795
Validation loss decreased (inf --> 0.289610).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.2147581
	speed: 5.6532s/iter; left time: 4957297.8344s
	iters: 200, epoch: 2 | loss: 0.2170659
	speed: 0.1711s/iter; left time: 150029.1375s
	iters: 300, epoch: 2 | loss: 0.1881606
	speed: 0.1738s/iter; left time: 152325.9650s
	iters: 400, epoch: 2 | loss: 0.2192194
	speed: 0.1738s/iter; left time: 152379.9706s
	iters: 500, epoch: 2 | loss: 0.2000931
	speed: 0.1748s/iter; left time: 153199.4406s
	iters: 600, epoch: 2 | loss: 0.1744023
	speed: 0.1766s/iter; left time: 154739.6007s
	iters: 700, epoch: 2 | loss: 0.1838491
	speed: 0.1759s/iter; left time: 154178.5268s
	iters: 800, epoch: 2 | loss: 0.1903820
	speed: 0.1762s/iter; left time: 154394.7865s
	iters: 900, epoch: 2 | loss: 0.1778643
	speed: 0.1757s/iter; left time: 153887.8730s
	iters: 1000, epoch: 2 | loss: 0.1934610
	speed: 0.1763s/iter; left time: 154463.4509s
	iters: 1100, epoch: 2 | loss: 0.1869084
	speed: 0.1764s/iter; left time: 154538.8891s
	iters: 1200, epoch: 2 | loss: 0.1610066
	speed: 0.1768s/iter; left time: 154870.4624s
	iters: 1300, epoch: 2 | loss: 0.1968282
	speed: 0.1768s/iter; left time: 154811.2940s
	iters: 1400, epoch: 2 | loss: 0.1702590
	speed: 0.1762s/iter; left time: 154258.7401s
	iters: 1500, epoch: 2 | loss: 0.1957307
	speed: 0.1757s/iter; left time: 153865.5515s
	iters: 1600, epoch: 2 | loss: 0.1900451
	speed: 0.1765s/iter; left time: 154521.5827s
	iters: 1700, epoch: 2 | loss: 0.1904385
	speed: 0.1757s/iter; left time: 153826.7146s
	iters: 1800, epoch: 2 | loss: 0.1756142
	speed: 0.1754s/iter; left time: 153540.4018s
	iters: 1900, epoch: 2 | loss: 0.1895417
	speed: 0.1756s/iter; left time: 153635.5147s
	iters: 2000, epoch: 2 | loss: 0.1752892
	speed: 0.1753s/iter; left time: 153417.6609s
	iters: 2100, epoch: 2 | loss: 0.1797069
	speed: 0.1751s/iter; left time: 153234.3517s
	iters: 2200, epoch: 2 | loss: 0.1807022
	speed: 0.1757s/iter; left time: 153699.8286s
	iters: 2300, epoch: 2 | loss: 0.1678798
	speed: 0.1767s/iter; left time: 154549.5069s
	iters: 2400, epoch: 2 | loss: 0.1654244
	speed: 0.1754s/iter; left time: 153371.0080s
	iters: 2500, epoch: 2 | loss: 0.1704258
	speed: 0.1765s/iter; left time: 154366.9377s
	iters: 2600, epoch: 2 | loss: 0.1768968
	speed: 0.1764s/iter; left time: 154251.5060s
	iters: 2700, epoch: 2 | loss: 0.1688757
	speed: 0.1739s/iter; left time: 151998.5736s
	iters: 2800, epoch: 2 | loss: 0.1582274
	speed: 0.1743s/iter; left time: 152332.3642s
	iters: 2900, epoch: 2 | loss: 0.1747663
	speed: 0.1745s/iter; left time: 152551.5814s
	iters: 3000, epoch: 2 | loss: 0.1677250
	speed: 0.1740s/iter; left time: 152049.5328s
	iters: 3100, epoch: 2 | loss: 0.1762120
	speed: 0.1751s/iter; left time: 153033.4365s
	iters: 3200, epoch: 2 | loss: 0.1641380
	speed: 0.1758s/iter; left time: 153655.1878s
	iters: 3300, epoch: 2 | loss: 0.1853163
	speed: 0.1757s/iter; left time: 153539.2310s
	iters: 3400, epoch: 2 | loss: 0.1750655
	speed: 0.1751s/iter; left time: 152940.9823s
	iters: 3500, epoch: 2 | loss: 0.1987463
	speed: 0.1753s/iter; left time: 153131.2326s
	iters: 3600, epoch: 2 | loss: 0.1653060
	speed: 0.1754s/iter; left time: 153165.4311s
	iters: 3700, epoch: 2 | loss: 0.1673131
	speed: 0.1754s/iter; left time: 153192.8550s
	iters: 3800, epoch: 2 | loss: 0.1722864
	speed: 0.1746s/iter; left time: 152450.8623s
	iters: 3900, epoch: 2 | loss: 0.1573543
	speed: 0.1749s/iter; left time: 152746.6786s
	iters: 4000, epoch: 2 | loss: 0.1650908
	speed: 0.1741s/iter; left time: 152009.1782s
	iters: 4100, epoch: 2 | loss: 0.1559174
	speed: 0.1742s/iter; left time: 152029.2367s
	iters: 4200, epoch: 2 | loss: 0.1652233
	speed: 0.1748s/iter; left time: 152570.9129s
	iters: 4300, epoch: 2 | loss: 0.1559357
	speed: 0.1743s/iter; left time: 152121.4571s
	iters: 4400, epoch: 2 | loss: 0.1364807
	speed: 0.1741s/iter; left time: 151886.3342s
Epoch: 2 cost time: 772.8996324539185
Epoch: 2, Steps: 4407 | Train Loss: 0.1771259 Vali Loss: 0.3984754 Test Loss: 0.6182925
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.1553307
	speed: 5.6560s/iter; left time: 4934745.3607s
	iters: 200, epoch: 3 | loss: 0.1592136
	speed: 0.1743s/iter; left time: 152031.0347s
	iters: 300, epoch: 3 | loss: 0.1494556
	speed: 0.1752s/iter; left time: 152803.2739s
	iters: 400, epoch: 3 | loss: 0.1668124
	speed: 0.1745s/iter; left time: 152228.0296s
	iters: 500, epoch: 3 | loss: 0.1502639
	speed: 0.1741s/iter; left time: 151788.4554s
	iters: 600, epoch: 3 | loss: 0.1708246
	speed: 0.1746s/iter; left time: 152268.5956s
	iters: 700, epoch: 3 | loss: 0.1520559
	speed: 0.1746s/iter; left time: 152255.4239s
	iters: 800, epoch: 3 | loss: 0.1512201
	speed: 0.1746s/iter; left time: 152184.0136s
	iters: 900, epoch: 3 | loss: 0.1658554
	speed: 0.1744s/iter; left time: 152056.2095s
	iters: 1000, epoch: 3 | loss: 0.1722535
	speed: 0.1743s/iter; left time: 151888.5099s
	iters: 1100, epoch: 3 | loss: 0.1559263
	speed: 0.1745s/iter; left time: 152081.2597s
	iters: 1200, epoch: 3 | loss: 0.1705644
	speed: 0.1743s/iter; left time: 151853.7833s
	iters: 1300, epoch: 3 | loss: 0.1722261
	speed: 0.1743s/iter; left time: 151870.1316s
	iters: 1400, epoch: 3 | loss: 0.1519268
	speed: 0.1745s/iter; left time: 151998.7856s
	iters: 1500, epoch: 3 | loss: 0.1634120
	speed: 0.1745s/iter; left time: 152037.2114s
	iters: 1600, epoch: 3 | loss: 0.1517363
	speed: 0.1730s/iter; left time: 150687.5701s
	iters: 1700, epoch: 3 | loss: 0.3409420
	speed: 0.1736s/iter; left time: 151144.4863s
	iters: 1800, epoch: 3 | loss: 0.2733333
	speed: 0.1720s/iter; left time: 149794.5872s
	iters: 1900, epoch: 3 | loss: 0.2830614
	speed: 0.1721s/iter; left time: 149886.8150s
	iters: 2000, epoch: 3 | loss: 0.2489727
	speed: 0.1733s/iter; left time: 150905.0815s
	iters: 2100, epoch: 3 | loss: 0.2520877
	speed: 0.1748s/iter; left time: 152186.3584s
	iters: 2200, epoch: 3 | loss: 0.2991240
	speed: 0.1748s/iter; left time: 152117.3036s
	iters: 2300, epoch: 3 | loss: 0.2540896
	speed: 0.1748s/iter; left time: 152121.3809s
	iters: 2400, epoch: 3 | loss: 0.2661202
	speed: 0.1744s/iter; left time: 151748.2295s
	iters: 2500, epoch: 3 | loss: 0.2812614
	speed: 0.1745s/iter; left time: 151865.0970s
	iters: 2600, epoch: 3 | loss: 0.2589464
	speed: 0.1750s/iter; left time: 152228.9990s
	iters: 2700, epoch: 3 | loss: 0.2638049
	speed: 0.1754s/iter; left time: 152541.7501s
	iters: 2800, epoch: 3 | loss: 0.2705293
	speed: 0.1755s/iter; left time: 152673.2992s
	iters: 2900, epoch: 3 | loss: 0.2564135
	speed: 0.1750s/iter; left time: 152189.1248s
	iters: 3000, epoch: 3 | loss: 0.2657419
	speed: 0.1753s/iter; left time: 152467.2678s
	iters: 3100, epoch: 3 | loss: 0.2597662
	speed: 0.1752s/iter; left time: 152324.1883s
	iters: 3200, epoch: 3 | loss: 0.2561741
	speed: 0.1750s/iter; left time: 152101.4974s
	iters: 3300, epoch: 3 | loss: 0.2450093
	speed: 0.1747s/iter; left time: 151831.6184s
	iters: 3400, epoch: 3 | loss: 0.1953556
	speed: 0.1745s/iter; left time: 151704.7718s
	iters: 3500, epoch: 3 | loss: 0.2405095
	speed: 0.1751s/iter; left time: 152176.7565s
	iters: 3600, epoch: 3 | loss: 0.2002455
	speed: 0.1745s/iter; left time: 151613.0344s
	iters: 3700, epoch: 3 | loss: 0.2138298
	speed: 0.1750s/iter; left time: 152057.9947s
	iters: 3800, epoch: 3 | loss: 0.2196924
	speed: 0.1745s/iter; left time: 151635.2680s
	iters: 3900, epoch: 3 | loss: 0.2066606
	speed: 0.1752s/iter; left time: 152207.4182s
	iters: 4000, epoch: 3 | loss: 0.2209135
	speed: 0.1745s/iter; left time: 151588.3516s
	iters: 4100, epoch: 3 | loss: 0.1840904
	speed: 0.1746s/iter; left time: 151603.4394s
	iters: 4200, epoch: 3 | loss: 0.1930883
	speed: 0.1749s/iter; left time: 151878.0396s
	iters: 4300, epoch: 3 | loss: 0.1681436
	speed: 0.1746s/iter; left time: 151586.9475s
	iters: 4400, epoch: 3 | loss: 0.1675430
	speed: 0.1747s/iter; left time: 151704.5930s
Epoch: 3 cost time: 769.3885185718536
Epoch: 3, Steps: 4407 | Train Loss: 0.2100199 Vali Loss: 0.2647293 Test Loss: 0.3865910
Validation loss decreased (0.289610 --> 0.264729).  Saving model ...
	iters: 100, epoch: 4 | loss: 0.1942397
	speed: 5.6881s/iter; left time: 4937763.9231s
	iters: 200, epoch: 4 | loss: 0.1699527
	speed: 0.1752s/iter; left time: 152041.8502s
	iters: 300, epoch: 4 | loss: 0.1727290
	speed: 0.1761s/iter; left time: 152845.5897s
	iters: 400, epoch: 4 | loss: 0.1907673
	speed: 0.1756s/iter; left time: 152414.8714s
	iters: 500, epoch: 4 | loss: 0.1989766
	speed: 0.1752s/iter; left time: 152025.0473s
	iters: 600, epoch: 4 | loss: 0.1830425
	speed: 0.1754s/iter; left time: 152194.6115s
	iters: 700, epoch: 4 | loss: 0.1820443
	speed: 0.1750s/iter; left time: 151800.5906s
	iters: 800, epoch: 4 | loss: 0.1606856
	speed: 0.1758s/iter; left time: 152458.2899s
	iters: 900, epoch: 4 | loss: 0.1305713
	speed: 0.1751s/iter; left time: 151838.5595s
	iters: 1000, epoch: 4 | loss: 0.1677922
	speed: 0.1751s/iter; left time: 151807.5222s
	iters: 1100, epoch: 4 | loss: 0.1550824
	speed: 0.1753s/iter; left time: 152005.7452s
	iters: 1200, epoch: 4 | loss: 0.1515258
	speed: 0.1752s/iter; left time: 151887.1320s
	iters: 1300, epoch: 4 | loss: 0.1684527
	speed: 0.1752s/iter; left time: 151903.5436s
	iters: 1400, epoch: 4 | loss: 0.1484453
	speed: 0.1753s/iter; left time: 151958.8980s
	iters: 1500, epoch: 4 | loss: 0.1588572
	speed: 0.1755s/iter; left time: 152089.5986s
	iters: 1600, epoch: 4 | loss: 0.1503802
	speed: 0.1756s/iter; left time: 152201.2550s
	iters: 1700, epoch: 4 | loss: 0.1536374
	speed: 0.1753s/iter; left time: 151913.7883s
	iters: 1800, epoch: 4 | loss: 0.1609483
	speed: 0.1756s/iter; left time: 152107.1322s
	iters: 1900, epoch: 4 | loss: 0.1593111
	speed: 0.1752s/iter; left time: 151765.2274s
	iters: 2000, epoch: 4 | loss: 0.1512835
	speed: 0.1757s/iter; left time: 152200.7862s
	iters: 2100, epoch: 4 | loss: 0.1385151
	speed: 0.1752s/iter; left time: 151699.3353s
	iters: 2200, epoch: 4 | loss: 0.1527680
	speed: 0.1755s/iter; left time: 151979.1861s
	iters: 2300, epoch: 4 | loss: 0.1485832
	speed: 0.1754s/iter; left time: 151887.9219s
	iters: 2400, epoch: 4 | loss: 0.1627891
	speed: 0.1751s/iter; left time: 151607.9612s
	iters: 2500, epoch: 4 | loss: 0.1429127
	speed: 0.1754s/iter; left time: 151858.9730s
	iters: 2600, epoch: 4 | loss: 0.1512960
	speed: 0.1752s/iter; left time: 151688.1514s
	iters: 2700, epoch: 4 | loss: 0.1562362
	speed: 0.1754s/iter; left time: 151809.9727s
	iters: 2800, epoch: 4 | loss: 0.1573666
	speed: 0.1753s/iter; left time: 151739.5187s
	iters: 2900, epoch: 4 | loss: 0.1340593
	speed: 0.1752s/iter; left time: 151594.8505s
	iters: 3000, epoch: 4 | loss: 0.1440074
	speed: 0.1753s/iter; left time: 151697.7005s
	iters: 3100, epoch: 4 | loss: 0.1292479
	speed: 0.1752s/iter; left time: 151522.1413s
	iters: 3200, epoch: 4 | loss: 0.1409771
	speed: 0.1754s/iter; left time: 151714.1281s
	iters: 3300, epoch: 4 | loss: 0.1367608
	speed: 0.1760s/iter; left time: 152244.3041s
	iters: 3400, epoch: 4 | loss: 0.1530190
	speed: 0.1752s/iter; left time: 151469.8281s
	iters: 3500, epoch: 4 | loss: 0.1467804
	speed: 0.1755s/iter; left time: 151749.0842s
	iters: 3600, epoch: 4 | loss: 0.1460368
	speed: 0.1757s/iter; left time: 151869.3605s
	iters: 3700, epoch: 4 | loss: 0.1386164
	speed: 0.1755s/iter; left time: 151693.8356s
	iters: 3800, epoch: 4 | loss: 0.1310119
	speed: 0.1756s/iter; left time: 151743.9993s
	iters: 3900, epoch: 4 | loss: 0.1376182
	speed: 0.1754s/iter; left time: 151612.8409s
	iters: 4000, epoch: 4 | loss: 0.1399100
	speed: 0.1753s/iter; left time: 151487.5169s
	iters: 4100, epoch: 4 | loss: 0.1483115
	speed: 0.1756s/iter; left time: 151697.8806s
	iters: 4200, epoch: 4 | loss: 0.1370753
	speed: 0.1760s/iter; left time: 152027.2552s
	iters: 4300, epoch: 4 | loss: 0.1527797
	speed: 0.1756s/iter; left time: 151725.3079s
	iters: 4400, epoch: 4 | loss: 0.1526782
	speed: 0.1753s/iter; left time: 151401.4627s
Epoch: 4 cost time: 773.4176988601685
Epoch: 4, Steps: 4407 | Train Loss: 0.1557804 Vali Loss: 0.2613153 Test Loss: 0.4520169
Validation loss decreased (0.264729 --> 0.261315).  Saving model ...
	iters: 100, epoch: 5 | loss: 0.1485439
	speed: 5.6700s/iter; left time: 4897032.9132s
	iters: 200, epoch: 5 | loss: 0.1532670
	speed: 0.1765s/iter; left time: 152388.4112s
	iters: 300, epoch: 5 | loss: 0.1304464
	speed: 0.1763s/iter; left time: 152200.2445s
	iters: 400, epoch: 5 | loss: 0.1443634
	speed: 0.1756s/iter; left time: 151648.0365s
	iters: 500, epoch: 5 | loss: 0.1475778
	speed: 0.1758s/iter; left time: 151754.3819s
	iters: 600, epoch: 5 | loss: 0.1153203
	speed: 0.1757s/iter; left time: 151637.3107s
	iters: 700, epoch: 5 | loss: 0.1416905
	speed: 0.1754s/iter; left time: 151349.8189s
	iters: 800, epoch: 5 | loss: 0.1404862
	speed: 0.1760s/iter; left time: 151851.6462s
	iters: 900, epoch: 5 | loss: 0.1474010
	speed: 0.1757s/iter; left time: 151648.3029s
	iters: 1000, epoch: 5 | loss: 0.1374891
	speed: 0.1754s/iter; left time: 151345.2807s
	iters: 1100, epoch: 5 | loss: 0.1486006
	speed: 0.1760s/iter; left time: 151789.5524s
	iters: 1200, epoch: 5 | loss: 0.1287814
	speed: 0.1757s/iter; left time: 151563.2456s
	iters: 1300, epoch: 5 | loss: 0.1348072
	speed: 0.1759s/iter; left time: 151744.2654s
	iters: 1400, epoch: 5 | loss: 0.1340079
	speed: 0.1759s/iter; left time: 151720.6204s
	iters: 1500, epoch: 5 | loss: 0.1384103
	speed: 0.1756s/iter; left time: 151423.4150s
	iters: 1600, epoch: 5 | loss: 0.1360558
	speed: 0.1758s/iter; left time: 151583.6084s
	iters: 1700, epoch: 5 | loss: 0.1253158
	speed: 0.1756s/iter; left time: 151394.6729s
	iters: 1800, epoch: 5 | loss: 0.1320919
	speed: 0.1757s/iter; left time: 151450.1969s
	iters: 1900, epoch: 5 | loss: 0.1197363
	speed: 0.1754s/iter; left time: 151186.2052s
	iters: 2000, epoch: 5 | loss: 0.1340763
	speed: 0.1759s/iter; left time: 151599.5230s
	iters: 2100, epoch: 5 | loss: 0.1291156
	speed: 0.1757s/iter; left time: 151363.8334s
	iters: 2200, epoch: 5 | loss: 0.1258329
	speed: 0.1761s/iter; left time: 151719.0974s
	iters: 2300, epoch: 5 | loss: 0.1458804
	speed: 0.1757s/iter; left time: 151361.0109s
	iters: 2400, epoch: 5 | loss: 0.1240160
	speed: 0.1756s/iter; left time: 151277.9575s
	iters: 2500, epoch: 5 | loss: 0.1326464
	speed: 0.1756s/iter; left time: 151245.8157s
	iters: 2600, epoch: 5 | loss: 0.1286886
	speed: 0.1755s/iter; left time: 151166.3100s
	iters: 2700, epoch: 5 | loss: 0.1222489
	speed: 0.1757s/iter; left time: 151268.0970s
	iters: 2800, epoch: 5 | loss: 0.1294723
	speed: 0.1760s/iter; left time: 151536.0649s
	iters: 2900, epoch: 5 | loss: 0.1272033
	speed: 0.1757s/iter; left time: 151257.5263s
	iters: 3000, epoch: 5 | loss: 0.1162513
	speed: 0.1763s/iter; left time: 151790.1028s
	iters: 3100, epoch: 5 | loss: 0.1227901
	speed: 0.1761s/iter; left time: 151532.2651s
	iters: 3200, epoch: 5 | loss: 0.1412192
	speed: 0.1761s/iter; left time: 151557.7726s
	iters: 3300, epoch: 5 | loss: 0.1332795
	speed: 0.1757s/iter; left time: 151176.0706s
	iters: 3400, epoch: 5 | loss: 0.1203120
	speed: 0.1761s/iter; left time: 151501.7315s
	iters: 3500, epoch: 5 | loss: 0.1341677
	speed: 0.1762s/iter; left time: 151543.3632s
	iters: 3600, epoch: 5 | loss: 0.1254075
	speed: 0.1757s/iter; left time: 151152.9836s
	iters: 3700, epoch: 5 | loss: 0.1322624
	speed: 0.1760s/iter; left time: 151374.2723s
	iters: 3800, epoch: 5 | loss: 0.1335655
	speed: 0.1763s/iter; left time: 151641.8000s
	iters: 3900, epoch: 5 | loss: 0.1357252
	speed: 0.1756s/iter; left time: 151017.2006s
	iters: 4000, epoch: 5 | loss: 0.1255503
	speed: 0.1761s/iter; left time: 151428.4785s
	iters: 4100, epoch: 5 | loss: 0.1355175
	speed: 0.1759s/iter; left time: 151243.2992s
	iters: 4200, epoch: 5 | loss: 0.1239057
	speed: 0.1759s/iter; left time: 151205.7308s
	iters: 4300, epoch: 5 | loss: 0.1335638
	speed: 0.1754s/iter; left time: 150785.3624s
	iters: 4400, epoch: 5 | loss: 0.1296516
	speed: 0.1759s/iter; left time: 151195.7897s
Epoch: 5 cost time: 775.3088054656982
Epoch: 5, Steps: 4407 | Train Loss: 0.1338425 Vali Loss: 0.2843773 Test Loss: 0.4780215
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 6 | loss: 0.1269637
	speed: 5.6432s/iter; left time: 4848988.4372s
	iters: 200, epoch: 6 | loss: 0.1225443
	speed: 0.1752s/iter; left time: 150491.8569s
	iters: 300, epoch: 6 | loss: 0.1327024
	speed: 0.1745s/iter; left time: 149899.6624s
	iters: 400, epoch: 6 | loss: 0.1317398
	speed: 0.1749s/iter; left time: 150206.8744s
	iters: 500, epoch: 6 | loss: 0.1307207
	speed: 0.1744s/iter; left time: 149808.0470s
	iters: 600, epoch: 6 | loss: 0.1188433
	speed: 0.1748s/iter; left time: 150078.6081s
	iters: 700, epoch: 6 | loss: 0.1235161
	speed: 0.1743s/iter; left time: 149684.2471s
	iters: 800, epoch: 6 | loss: 0.1239367
	speed: 0.1743s/iter; left time: 149661.3966s
	iters: 900, epoch: 6 | loss: 0.1238467
	speed: 0.1746s/iter; left time: 149892.7118s
	iters: 1000, epoch: 6 | loss: 0.1415940
	speed: 0.1743s/iter; left time: 149627.4646s
	iters: 1100, epoch: 6 | loss: 0.1210743
	speed: 0.1746s/iter; left time: 149859.0942s
	iters: 1200, epoch: 6 | loss: 0.1279946
	speed: 0.1746s/iter; left time: 149874.2226s
	iters: 1300, epoch: 6 | loss: 0.1186858
	speed: 0.1744s/iter; left time: 149629.3094s
	iters: 1400, epoch: 6 | loss: 0.1395207
	speed: 0.1745s/iter; left time: 149687.3584s
	iters: 1500, epoch: 6 | loss: 0.1244559
	speed: 0.1742s/iter; left time: 149479.0451s
	iters: 1600, epoch: 6 | loss: 0.1306404
	speed: 0.1747s/iter; left time: 149840.3212s
	iters: 1700, epoch: 6 | loss: 0.1402615
	speed: 0.1745s/iter; left time: 149695.5247s
	iters: 1800, epoch: 6 | loss: 0.1195377
	speed: 0.1749s/iter; left time: 150006.1919s
	iters: 1900, epoch: 6 | loss: 0.1209043
	speed: 0.1744s/iter; left time: 149556.9559s
	iters: 2000, epoch: 6 | loss: 0.1196420
	speed: 0.1752s/iter; left time: 150232.0660s
	iters: 2100, epoch: 6 | loss: 0.1200035
	speed: 0.1745s/iter; left time: 149628.5096s
	iters: 2200, epoch: 6 | loss: 0.1101573
	speed: 0.1746s/iter; left time: 149703.1563s
	iters: 2300, epoch: 6 | loss: 0.1139344
	speed: 0.1750s/iter; left time: 149973.8073s
	iters: 2400, epoch: 6 | loss: 0.1248470
	speed: 0.1749s/iter; left time: 149872.3347s
	iters: 2500, epoch: 6 | loss: 0.1124446
	speed: 0.1749s/iter; left time: 149891.8189s
	iters: 2600, epoch: 6 | loss: 0.1221903
	speed: 0.1746s/iter; left time: 149604.5050s
	iters: 2700, epoch: 6 | loss: 0.1269236
	speed: 0.1751s/iter; left time: 149978.9183s
	iters: 2800, epoch: 6 | loss: 0.1148447
	speed: 0.1746s/iter; left time: 149567.5131s
	iters: 2900, epoch: 6 | loss: 0.1150530
	speed: 0.1756s/iter; left time: 150371.2950s
	iters: 3000, epoch: 6 | loss: 0.1153019
	speed: 0.1747s/iter; left time: 149636.2250s
	iters: 3100, epoch: 6 | loss: 0.1243744
	speed: 0.1740s/iter; left time: 148951.7903s
	iters: 3200, epoch: 6 | loss: 0.1267612
	speed: 0.1748s/iter; left time: 149699.8363s
	iters: 3300, epoch: 6 | loss: 0.1203748
	speed: 0.1745s/iter; left time: 149426.2462s
	iters: 3400, epoch: 6 | loss: 0.1120046
	speed: 0.1754s/iter; left time: 150108.9120s
	iters: 3500, epoch: 6 | loss: 0.1325850
	speed: 0.1755s/iter; left time: 150246.5341s
	iters: 3600, epoch: 6 | loss: 0.1180944
	speed: 0.1751s/iter; left time: 149859.0943s
	iters: 3700, epoch: 6 | loss: 0.1162975
	speed: 0.1756s/iter; left time: 150239.0672s
	iters: 3800, epoch: 6 | loss: 0.1209151
	speed: 0.1754s/iter; left time: 150032.0539s
	iters: 3900, epoch: 6 | loss: 0.1206453
	speed: 0.1758s/iter; left time: 150409.6211s
	iters: 4000, epoch: 6 | loss: 0.1207317
	speed: 0.1757s/iter; left time: 150314.0480s
	iters: 4100, epoch: 6 | loss: 0.1179369
	speed: 0.1755s/iter; left time: 150129.3023s
	iters: 4200, epoch: 6 | loss: 0.1193476
	speed: 0.1755s/iter; left time: 150117.4291s
	iters: 4300, epoch: 6 | loss: 0.1107289
	speed: 0.1754s/iter; left time: 150015.6466s
	iters: 4400, epoch: 6 | loss: 0.1257258
	speed: 0.1749s/iter; left time: 149554.6509s
Epoch: 6 cost time: 771.0305767059326
Epoch: 6, Steps: 4407 | Train Loss: 0.1239700 Vali Loss: 0.2897356 Test Loss: 0.5005022
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 7 | loss: 0.1128916
	speed: 5.6825s/iter; left time: 4857752.2588s
	iters: 200, epoch: 7 | loss: 0.1164416
	speed: 0.1749s/iter; left time: 149478.4415s
	iters: 300, epoch: 7 | loss: 0.1289845
	speed: 0.1745s/iter; left time: 149158.9655s
	iters: 400, epoch: 7 | loss: 0.1330942
	speed: 0.1741s/iter; left time: 148811.7880s
	iters: 500, epoch: 7 | loss: 0.1095685
	speed: 0.1742s/iter; left time: 148824.3453s
	iters: 600, epoch: 7 | loss: 0.1197678
	speed: 0.1742s/iter; left time: 148863.8770s
	iters: 700, epoch: 7 | loss: 0.1092498
	speed: 0.1745s/iter; left time: 149042.6270s
	iters: 800, epoch: 7 | loss: 0.1248822
	speed: 0.1742s/iter; left time: 148807.6805s
	iters: 900, epoch: 7 | loss: 0.1285860
	speed: 0.1747s/iter; left time: 149176.3089s
	iters: 1000, epoch: 7 | loss: 0.1144085
	speed: 0.1746s/iter; left time: 149109.2371s
	iters: 1100, epoch: 7 | loss: 0.1315742
	speed: 0.1748s/iter; left time: 149221.2789s
	iters: 1200, epoch: 7 | loss: 0.1127849
	speed: 0.1750s/iter; left time: 149385.7966s
	iters: 1300, epoch: 7 | loss: 0.1225527
	speed: 0.1745s/iter; left time: 148965.8406s
	iters: 1400, epoch: 7 | loss: 0.0990814
	speed: 0.1750s/iter; left time: 149405.1232s
	iters: 1500, epoch: 7 | loss: 0.1278159
	speed: 0.1745s/iter; left time: 148916.6699s
	iters: 1600, epoch: 7 | loss: 0.1113480
	speed: 0.1747s/iter; left time: 149078.3751s
	iters: 1700, epoch: 7 | loss: 0.1127097
	speed: 0.1749s/iter; left time: 149222.4128s
	iters: 1800, epoch: 7 | loss: 0.1163205
	speed: 0.1750s/iter; left time: 149280.2751s
	iters: 1900, epoch: 7 | loss: 0.1305229
	speed: 0.1752s/iter; left time: 149461.3202s
	iters: 2000, epoch: 7 | loss: 0.1312841
	speed: 0.1749s/iter; left time: 149155.2605s
	iters: 2100, epoch: 7 | loss: 0.1161488
	speed: 0.1750s/iter; left time: 149274.8007s
	iters: 2200, epoch: 7 | loss: 0.1188109
	speed: 0.1748s/iter; left time: 149090.8471s
	iters: 2300, epoch: 7 | loss: 0.1219382
	speed: 0.1750s/iter; left time: 149256.9831s
	iters: 2400, epoch: 7 | loss: 0.1109354
	speed: 0.1751s/iter; left time: 149308.9993s
	iters: 2500, epoch: 7 | loss: 0.1252339
	speed: 0.1752s/iter; left time: 149372.2099s
	iters: 2600, epoch: 7 | loss: 0.1064066
	speed: 0.1753s/iter; left time: 149426.0393s
	iters: 2700, epoch: 7 | loss: 0.1146456
	speed: 0.1754s/iter; left time: 149509.8171s
	iters: 2800, epoch: 7 | loss: 0.1218944
	speed: 0.1748s/iter; left time: 148966.8875s
	iters: 2900, epoch: 7 | loss: 0.1112912
	speed: 0.1747s/iter; left time: 148853.4318s
	iters: 3000, epoch: 7 | loss: 0.1084865
	speed: 0.1747s/iter; left time: 148795.2541s
	iters: 3100, epoch: 7 | loss: 0.1184224
	speed: 0.1744s/iter; left time: 148594.6912s
	iters: 3200, epoch: 7 | loss: 0.1274483
	speed: 0.1746s/iter; left time: 148757.5398s
	iters: 3300, epoch: 7 | loss: 0.1021259
	speed: 0.1751s/iter; left time: 149099.2586s
	iters: 3400, epoch: 7 | loss: 0.1141501
	speed: 0.1749s/iter; left time: 148954.7113s
	iters: 3500, epoch: 7 | loss: 0.1099717
	speed: 0.1745s/iter; left time: 148582.1720s
	iters: 3600, epoch: 7 | loss: 0.1205340
	speed: 0.1751s/iter; left time: 149086.1139s
	iters: 3700, epoch: 7 | loss: 0.1092324
	speed: 0.1749s/iter; left time: 148912.9839s
	iters: 3800, epoch: 7 | loss: 0.1269753
	speed: 0.1750s/iter; left time: 148910.7998s
	iters: 3900, epoch: 7 | loss: 0.1264860
	speed: 0.1747s/iter; left time: 148676.6555s
	iters: 4000, epoch: 7 | loss: 0.1112884
	speed: 0.1750s/iter; left time: 148952.8307s
	iters: 4100, epoch: 7 | loss: 0.1120245
	speed: 0.1745s/iter; left time: 148510.3478s
	iters: 4200, epoch: 7 | loss: 0.1007749
	speed: 0.1750s/iter; left time: 148923.8345s
	iters: 4300, epoch: 7 | loss: 0.1202973
	speed: 0.1747s/iter; left time: 148645.5407s
	iters: 4400, epoch: 7 | loss: 0.1122490
	speed: 0.1747s/iter; left time: 148634.3206s
Epoch: 7 cost time: 770.7090036869049
Epoch: 7, Steps: 4407 | Train Loss: 0.1164709 Vali Loss: 0.2912920 Test Loss: 0.4712454
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 8 | loss: 0.1109712
	speed: 5.6868s/iter; left time: 4836368.8329s
	iters: 200, epoch: 8 | loss: 0.1033474
	speed: 0.1739s/iter; left time: 147841.6344s
	iters: 300, epoch: 8 | loss: 0.1152125
	speed: 0.1742s/iter; left time: 148081.7848s
	iters: 400, epoch: 8 | loss: 0.1237611
	speed: 0.1743s/iter; left time: 148160.3189s
	iters: 500, epoch: 8 | loss: 0.1101524
	speed: 0.1740s/iter; left time: 147893.8690s
	iters: 600, epoch: 8 | loss: 0.1090064
	speed: 0.1746s/iter; left time: 148392.5532s
	iters: 700, epoch: 8 | loss: 0.1095023
	speed: 0.1744s/iter; left time: 148180.7326s
	iters: 800, epoch: 8 | loss: 0.1057643
	speed: 0.1738s/iter; left time: 147726.2692s
	iters: 900, epoch: 8 | loss: 0.1263878
	speed: 0.1742s/iter; left time: 147982.2809s
	iters: 1000, epoch: 8 | loss: 0.1196508
	speed: 0.1740s/iter; left time: 147788.8996s
	iters: 1100, epoch: 8 | loss: 0.1161076
	speed: 0.1742s/iter; left time: 147945.7096s
	iters: 1200, epoch: 8 | loss: 0.1054264
	speed: 0.1744s/iter; left time: 148107.4884s
	iters: 1300, epoch: 8 | loss: 0.1091033
	speed: 0.1752s/iter; left time: 148826.4410s
	iters: 1400, epoch: 8 | loss: 0.1018266
	speed: 0.1764s/iter; left time: 149805.9338s
	iters: 1500, epoch: 8 | loss: 0.1132703
	speed: 0.1766s/iter; left time: 149902.4704s
	iters: 1600, epoch: 8 | loss: 0.1094906
	speed: 0.1767s/iter; left time: 150025.9710s
	iters: 1700, epoch: 8 | loss: 0.1088203
	speed: 0.1763s/iter; left time: 149685.3844s
	iters: 1800, epoch: 8 | loss: 0.1148295
	speed: 0.1760s/iter; left time: 149389.1093s
	iters: 1900, epoch: 8 | loss: 0.1151841
	speed: 0.1741s/iter; left time: 147742.7486s
	iters: 2000, epoch: 8 | loss: 0.1117337
	speed: 0.1746s/iter; left time: 148140.2299s
	iters: 2100, epoch: 8 | loss: 0.1157578
	speed: 0.1741s/iter; left time: 147727.5381s
	iters: 2200, epoch: 8 | loss: 0.1105284
	speed: 0.1742s/iter; left time: 147809.8706s
	iters: 2300, epoch: 8 | loss: 0.1217704
	speed: 0.1739s/iter; left time: 147483.1289s
	iters: 2400, epoch: 8 | loss: 0.1100147
	speed: 0.1740s/iter; left time: 147597.3458s
	iters: 2500, epoch: 8 | loss: 0.1100642
	speed: 0.1743s/iter; left time: 147839.8161s
	iters: 2600, epoch: 8 | loss: 0.1007786
	speed: 0.1742s/iter; left time: 147741.4778s
	iters: 2700, epoch: 8 | loss: 0.1093215
	speed: 0.1740s/iter; left time: 147560.9488s
	iters: 2800, epoch: 8 | loss: 0.1118663
	speed: 0.1752s/iter; left time: 148513.0711s
	iters: 2900, epoch: 8 | loss: 0.0980001
	speed: 0.1760s/iter; left time: 149179.0493s
	iters: 3000, epoch: 8 | loss: 0.1114551
	speed: 0.1767s/iter; left time: 149777.9218s
	iters: 3100, epoch: 8 | loss: 0.1150865
	speed: 0.1765s/iter; left time: 149562.8629s
	iters: 3200, epoch: 8 | loss: 0.1144261
	speed: 0.1767s/iter; left time: 149753.4208s
	iters: 3300, epoch: 8 | loss: 0.1137521
	speed: 0.1766s/iter; left time: 149645.6272s
	iters: 3400, epoch: 8 | loss: 0.1127131
	speed: 0.1742s/iter; left time: 147545.7013s
	iters: 3500, epoch: 8 | loss: 0.1148954
	speed: 0.1747s/iter; left time: 147961.0738s
	iters: 3600, epoch: 8 | loss: 0.1167874
	speed: 0.1763s/iter; left time: 149330.7579s
	iters: 3700, epoch: 8 | loss: 0.1130449
	speed: 0.1747s/iter; left time: 147905.7579s
	iters: 3800, epoch: 8 | loss: 0.0979761
	speed: 0.1764s/iter; left time: 149345.2606s
	iters: 3900, epoch: 8 | loss: 0.1103453
	speed: 0.1758s/iter; left time: 148842.4767s
	iters: 4000, epoch: 8 | loss: 0.1077607
	speed: 0.1765s/iter; left time: 149386.5312s
	iters: 4100, epoch: 8 | loss: 0.1149360
	speed: 0.1767s/iter; left time: 149548.6610s
	iters: 4200, epoch: 8 | loss: 0.1104740
	speed: 0.1767s/iter; left time: 149548.6072s
	iters: 4300, epoch: 8 | loss: 0.1126327
	speed: 0.1747s/iter; left time: 147840.3114s
	iters: 4400, epoch: 8 | loss: 0.1146909
	speed: 0.1745s/iter; left time: 147630.2216s
Epoch: 8 cost time: 771.9663953781128
Epoch: 8, Steps: 4407 | Train Loss: 0.1106224 Vali Loss: 0.2893211 Test Loss: 0.4474181
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 9 | loss: 0.0982636
	speed: 5.6760s/iter; left time: 4802179.4916s
	iters: 200, epoch: 9 | loss: 0.1181888
	speed: 0.1754s/iter; left time: 148358.5898s
	iters: 300, epoch: 9 | loss: 0.0986808
	speed: 0.1756s/iter; left time: 148562.3152s
	iters: 400, epoch: 9 | loss: 0.1007550
	speed: 0.1755s/iter; left time: 148446.0278s
	iters: 500, epoch: 9 | loss: 0.1121762
	speed: 0.1750s/iter; left time: 147958.3703s
	iters: 600, epoch: 9 | loss: 0.1134621
	speed: 0.1755s/iter; left time: 148387.4642s
	iters: 700, epoch: 9 | loss: 0.1014805
	speed: 0.1747s/iter; left time: 147737.2558s
	iters: 800, epoch: 9 | loss: 0.1054057
	speed: 0.1748s/iter; left time: 147759.9575s
	iters: 900, epoch: 9 | loss: 0.1079921
	speed: 0.1749s/iter; left time: 147798.7956s
	iters: 1000, epoch: 9 | loss: 0.1100473
	speed: 0.1749s/iter; left time: 147851.2155s
	iters: 1100, epoch: 9 | loss: 0.1003238
	speed: 0.1750s/iter; left time: 147875.4164s
	iters: 1200, epoch: 9 | loss: 0.1104264
	speed: 0.1748s/iter; left time: 147659.6617s
	iters: 1300, epoch: 9 | loss: 0.1041459
	speed: 0.1742s/iter; left time: 147194.1203s
	iters: 1400, epoch: 9 | loss: 0.1076095
	speed: 0.1746s/iter; left time: 147504.3863s
	iters: 1500, epoch: 9 | loss: 0.1125456
	speed: 0.1749s/iter; left time: 147759.0343s
	iters: 1600, epoch: 9 | loss: 0.1042359
	speed: 0.1748s/iter; left time: 147627.0481s
	iters: 1700, epoch: 9 | loss: 0.1046167
	speed: 0.1742s/iter; left time: 147076.6801s
	iters: 1800, epoch: 9 | loss: 0.1005096
	speed: 0.1748s/iter; left time: 147604.1644s
	iters: 1900, epoch: 9 | loss: 0.1045560
	speed: 0.1747s/iter; left time: 147484.3643s
	iters: 2000, epoch: 9 | loss: 0.1186058
	speed: 0.1746s/iter; left time: 147393.0608s
	iters: 2100, epoch: 9 | loss: 0.1084114
	speed: 0.1745s/iter; left time: 147312.5569s
	iters: 2200, epoch: 9 | loss: 0.0956560
	speed: 0.1755s/iter; left time: 148127.4078s
	iters: 2300, epoch: 9 | loss: 0.1052257
	speed: 0.1750s/iter; left time: 147700.8543s
	iters: 2400, epoch: 9 | loss: 0.0902244
	speed: 0.1743s/iter; left time: 147045.6414s
	iters: 2500, epoch: 9 | loss: 0.1078866
	speed: 0.1749s/iter; left time: 147595.1386s
	iters: 2600, epoch: 9 | loss: 0.1107789
	speed: 0.1754s/iter; left time: 147924.7673s
	iters: 2700, epoch: 9 | loss: 0.1041229
	speed: 0.1745s/iter; left time: 147197.1277s
	iters: 2800, epoch: 9 | loss: 0.0985159
	speed: 0.1747s/iter; left time: 147355.1167s
	iters: 2900, epoch: 9 | loss: 0.0990347
	speed: 0.1748s/iter; left time: 147409.3789s
	iters: 3000, epoch: 9 | loss: 0.1054202
	speed: 0.1745s/iter; left time: 147150.6399s
	iters: 3100, epoch: 9 | loss: 0.0987085
	speed: 0.1751s/iter; left time: 147577.5266s
	iters: 3200, epoch: 9 | loss: 0.1126944
	speed: 0.1751s/iter; left time: 147567.4051s
	iters: 3300, epoch: 9 | loss: 0.1073304
	speed: 0.1742s/iter; left time: 146860.9944s
	iters: 3400, epoch: 9 | loss: 0.1095826
	speed: 0.1747s/iter; left time: 147248.9383s
	iters: 3500, epoch: 9 | loss: 0.1002041
	speed: 0.1747s/iter; left time: 147181.4572s
	iters: 3600, epoch: 9 | loss: 0.1042441
	speed: 0.1747s/iter; left time: 147187.8168s
	iters: 3700, epoch: 9 | loss: 0.1122431
	speed: 0.1749s/iter; left time: 147337.9765s
	iters: 3800, epoch: 9 | loss: 0.1055573
	speed: 0.1746s/iter; left time: 147082.5992s
	iters: 3900, epoch: 9 | loss: 0.0982559
	speed: 0.1751s/iter; left time: 147469.8463s
	iters: 4000, epoch: 9 | loss: 0.1072072
	speed: 0.1746s/iter; left time: 147069.2050s
	iters: 4100, epoch: 9 | loss: 0.1019595
	speed: 0.1745s/iter; left time: 146914.7292s
	iters: 4200, epoch: 9 | loss: 0.1068525
	speed: 0.1740s/iter; left time: 146525.4438s
	iters: 4300, epoch: 9 | loss: 0.1057549
	speed: 0.1750s/iter; left time: 147304.3955s
	iters: 4400, epoch: 9 | loss: 0.0971310
	speed: 0.1744s/iter; left time: 146817.9990s
Epoch: 9 cost time: 770.8328740596771
Epoch: 9, Steps: 4407 | Train Loss: 0.1061219 Vali Loss: 0.2770619 Test Loss: 0.4701604
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems08_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 40085
test shape: (40085, 1, 336, 212) (40085, 1, 336, 212)
test shape: (40085, 336, 212) (40085, 336, 212)
mse:0.4520150423049927, mae:0.4678231179714203
>>>>>>>Overall time: 12714 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
