Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=16, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=512, d_layers=1, d_model=512, data='custom', data_path='pems07_d.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=4, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.001, loss='MSE', lradj='type1', mask_rate=0.25, model='iTransformer', model_id='pems07_d_96_192', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=3, pred_len=192, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=10, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 5287
val 607
test 1401
	iters: 100, epoch: 1 | loss: 0.6460998
	speed: 0.3286s/iter; left time: 1051.9879s
	iters: 200, epoch: 1 | loss: 0.7408494
	speed: 0.3248s/iter; left time: 1007.1646s
	iters: 300, epoch: 1 | loss: 0.7612438
	speed: 0.3247s/iter; left time: 974.4273s
Epoch: 1 cost time: 107.6319227218628
Epoch: 1, Steps: 330 | Train Loss: 0.7383151 Vali Loss: 1.0849032 Test Loss: 1.7722746
Validation loss decreased (inf --> 1.084903).  Saving model ...
Updating learning rate to 0.001
	iters: 100, epoch: 2 | loss: 0.6902683
	speed: 0.6667s/iter; left time: 1914.2014s
	iters: 200, epoch: 2 | loss: 0.6618049
	speed: 0.3250s/iter; left time: 900.6055s
	iters: 300, epoch: 2 | loss: 0.6439334
	speed: 0.3252s/iter; left time: 868.7053s
Epoch: 2 cost time: 107.56096959114075
Epoch: 2, Steps: 330 | Train Loss: 0.7096767 Vali Loss: 1.0821216 Test Loss: 1.7708822
Validation loss decreased (1.084903 --> 1.082122).  Saving model ...
Updating learning rate to 0.0005
	iters: 100, epoch: 3 | loss: 0.6632644
	speed: 0.6691s/iter; left time: 1700.1277s
	iters: 200, epoch: 3 | loss: 0.5617452
	speed: 0.3255s/iter; left time: 794.4859s
	iters: 300, epoch: 3 | loss: 0.5538566
	speed: 0.3256s/iter; left time: 762.2782s
Epoch: 3 cost time: 107.69997310638428
Epoch: 3, Steps: 330 | Train Loss: 0.6810548 Vali Loss: 1.0755972 Test Loss: 1.7654793
Validation loss decreased (1.082122 --> 1.075597).  Saving model ...
Updating learning rate to 0.00025
	iters: 100, epoch: 4 | loss: 0.6606204
	speed: 0.6697s/iter; left time: 1480.7440s
	iters: 200, epoch: 4 | loss: 0.6305013
	speed: 0.3255s/iter; left time: 687.1645s
	iters: 300, epoch: 4 | loss: 0.6504508
	speed: 0.3256s/iter; left time: 654.8680s
Epoch: 4 cost time: 107.7099061012268
Epoch: 4, Steps: 330 | Train Loss: 0.6574387 Vali Loss: 1.0410513 Test Loss: 1.7641360
Validation loss decreased (1.075597 --> 1.041051).  Saving model ...
Updating learning rate to 0.000125
	iters: 100, epoch: 5 | loss: 0.6171847
	speed: 0.6681s/iter; left time: 1256.7685s
	iters: 200, epoch: 5 | loss: 0.6248180
	speed: 0.3255s/iter; left time: 579.7558s
	iters: 300, epoch: 5 | loss: 0.6172106
	speed: 0.3254s/iter; left time: 546.9448s
Epoch: 5 cost time: 107.6310122013092
Epoch: 5, Steps: 330 | Train Loss: 0.6386518 Vali Loss: 1.0476561 Test Loss: 1.7787215
EarlyStopping counter: 1 out of 3
Updating learning rate to 6.25e-05
	iters: 100, epoch: 6 | loss: 0.5930685
	speed: 0.6669s/iter; left time: 1034.4187s
	iters: 200, epoch: 6 | loss: 0.5841035
	speed: 0.3258s/iter; left time: 472.7614s
	iters: 300, epoch: 6 | loss: 0.6600151
	speed: 0.3256s/iter; left time: 439.8652s
Epoch: 6 cost time: 107.69010353088379
Epoch: 6, Steps: 330 | Train Loss: 0.6258003 Vali Loss: 1.0377177 Test Loss: 1.7724617
Validation loss decreased (1.041051 --> 1.037718).  Saving model ...
Updating learning rate to 3.125e-05
	iters: 100, epoch: 7 | loss: 0.6219079
	speed: 0.6676s/iter; left time: 815.1273s
	iters: 200, epoch: 7 | loss: 0.6290487
	speed: 0.3253s/iter; left time: 364.6638s
	iters: 300, epoch: 7 | loss: 0.5878699
	speed: 0.3251s/iter; left time: 331.9545s
Epoch: 7 cost time: 107.58631777763367
Epoch: 7, Steps: 330 | Train Loss: 0.6180927 Vali Loss: 1.0431625 Test Loss: 1.7838706
EarlyStopping counter: 1 out of 3
Updating learning rate to 1.5625e-05
	iters: 100, epoch: 8 | loss: 0.6106926
	speed: 0.6665s/iter; left time: 593.8084s
	iters: 200, epoch: 8 | loss: 0.5770023
	speed: 0.3254s/iter; left time: 257.3736s
	iters: 300, epoch: 8 | loss: 0.5905204
	speed: 0.3252s/iter; left time: 224.7027s
Epoch: 8 cost time: 107.59288597106934
Epoch: 8, Steps: 330 | Train Loss: 0.6138948 Vali Loss: 1.0405314 Test Loss: 1.7845298
EarlyStopping counter: 2 out of 3
Updating learning rate to 7.8125e-06
	iters: 100, epoch: 9 | loss: 0.6426383
	speed: 0.6665s/iter; left time: 373.9069s
	iters: 200, epoch: 9 | loss: 0.5704640
	speed: 0.3253s/iter; left time: 149.9480s
	iters: 300, epoch: 9 | loss: 0.6235551
	speed: 0.3253s/iter; left time: 117.4329s
Epoch: 9 cost time: 107.53835773468018
Epoch: 9, Steps: 330 | Train Loss: 0.6117960 Vali Loss: 1.0470200 Test Loss: 1.7858970
EarlyStopping counter: 3 out of 3
Early stopping
>>>>>>>testing : long_term_forecast_pems07_d_96_192_iTransformer_custom_ftM_sl96_ll48_pl192_dm512_nh8_el4_dl1_df512_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 1401
test shape: (1401, 1, 192, 1613) (1401, 1, 192, 1613)
test shape: (1401, 192, 1613) (1401, 192, 1613)
mse:1.7724682092666626, mae:0.7300938367843628
>>>>>>>Overall time: 1217 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
