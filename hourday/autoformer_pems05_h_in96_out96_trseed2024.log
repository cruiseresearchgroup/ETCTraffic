Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=103, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems05_h.csv', dec_in=103, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=103, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems05_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems05_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 73678
val 10459
test 21010
	iters: 100, epoch: 1 | loss: 0.1769393
	speed: 0.1328s/iter; left time: 61133.4720s
	iters: 200, epoch: 1 | loss: 0.1585790
	speed: 0.1277s/iter; left time: 58750.1101s
	iters: 300, epoch: 1 | loss: 0.1248329
	speed: 0.1283s/iter; left time: 59018.7915s
	iters: 400, epoch: 1 | loss: 0.1025514
	speed: 0.1273s/iter; left time: 58543.2218s
	iters: 500, epoch: 1 | loss: 0.1117322
	speed: 0.1281s/iter; left time: 58914.9220s
	iters: 600, epoch: 1 | loss: 0.0959789
	speed: 0.1276s/iter; left time: 58669.5212s
	iters: 700, epoch: 1 | loss: 0.1086688
	speed: 0.1279s/iter; left time: 58780.6667s
	iters: 800, epoch: 1 | loss: 0.0995247
	speed: 0.1282s/iter; left time: 58903.7944s
	iters: 900, epoch: 1 | loss: 0.0963254
	speed: 0.1280s/iter; left time: 58837.8643s
	iters: 1000, epoch: 1 | loss: 0.0928919
	speed: 0.1279s/iter; left time: 58748.9934s
	iters: 1100, epoch: 1 | loss: 0.0916852
	speed: 0.1284s/iter; left time: 58994.7585s
	iters: 1200, epoch: 1 | loss: 0.0932054
	speed: 0.1277s/iter; left time: 58618.9197s
	iters: 1300, epoch: 1 | loss: 0.0822918
	speed: 0.1277s/iter; left time: 58616.0701s
	iters: 1400, epoch: 1 | loss: 0.0804816
	speed: 0.1276s/iter; left time: 58554.3153s
	iters: 1500, epoch: 1 | loss: 0.0750783
	speed: 0.1279s/iter; left time: 58684.1477s
	iters: 1600, epoch: 1 | loss: 0.0742337
	speed: 0.1278s/iter; left time: 58643.3053s
	iters: 1700, epoch: 1 | loss: 0.0854622
	speed: 0.1281s/iter; left time: 58742.1217s
	iters: 1800, epoch: 1 | loss: 0.0654343
	speed: 0.1278s/iter; left time: 58620.6347s
	iters: 1900, epoch: 1 | loss: 0.0634681
	speed: 0.1275s/iter; left time: 58446.4057s
	iters: 2000, epoch: 1 | loss: 0.0703689
	speed: 0.1277s/iter; left time: 58534.6655s
	iters: 2100, epoch: 1 | loss: 0.0708171
	speed: 0.1279s/iter; left time: 58604.1232s
	iters: 2200, epoch: 1 | loss: 0.0834080
	speed: 0.1283s/iter; left time: 58792.7452s
	iters: 2300, epoch: 1 | loss: 0.0820969
	speed: 0.1279s/iter; left time: 58605.1710s
Epoch: 1 cost time: 295.0132722854614
Epoch: 1, Steps: 2302 | Train Loss: 0.1009969 Vali Loss: 0.1142265 Test Loss: 0.1505343
Validation loss decreased (inf --> 0.114226).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0723607
	speed: 2.5800s/iter; left time: 1181622.6994s
	iters: 200, epoch: 2 | loss: 0.1395859
	speed: 0.1289s/iter; left time: 59004.5427s
	iters: 300, epoch: 2 | loss: 0.1476883
	speed: 0.1287s/iter; left time: 58901.9973s
	iters: 400, epoch: 2 | loss: 0.0977623
	speed: 0.1285s/iter; left time: 58806.6016s
	iters: 500, epoch: 2 | loss: 0.0863105
	speed: 0.1286s/iter; left time: 58865.3754s
	iters: 600, epoch: 2 | loss: 0.0851702
	speed: 0.1292s/iter; left time: 59100.6097s
	iters: 700, epoch: 2 | loss: 0.0892167
	speed: 0.1281s/iter; left time: 58584.3492s
	iters: 800, epoch: 2 | loss: 0.0874478
	speed: 0.1289s/iter; left time: 58952.0595s
	iters: 900, epoch: 2 | loss: 0.0754948
	speed: 0.1292s/iter; left time: 59052.9974s
	iters: 1000, epoch: 2 | loss: 0.0836695
	speed: 0.1289s/iter; left time: 58908.3712s
	iters: 1100, epoch: 2 | loss: 0.0672959
	speed: 0.1290s/iter; left time: 58930.0820s
	iters: 1200, epoch: 2 | loss: 0.0732461
	speed: 0.1278s/iter; left time: 58400.7804s
	iters: 1300, epoch: 2 | loss: 0.0791591
	speed: 0.1275s/iter; left time: 58238.0443s
	iters: 1400, epoch: 2 | loss: 0.0745214
	speed: 0.1278s/iter; left time: 58366.7614s
	iters: 1500, epoch: 2 | loss: 0.0653357
	speed: 0.1282s/iter; left time: 58553.8492s
	iters: 1600, epoch: 2 | loss: 0.0904182
	speed: 0.1275s/iter; left time: 58209.5607s
	iters: 1700, epoch: 2 | loss: 0.0792376
	speed: 0.1283s/iter; left time: 58542.6486s
	iters: 1800, epoch: 2 | loss: 0.0651072
	speed: 0.1279s/iter; left time: 58382.6436s
	iters: 1900, epoch: 2 | loss: 0.0602283
	speed: 0.1276s/iter; left time: 58211.1566s
	iters: 2000, epoch: 2 | loss: 0.0689042
	speed: 0.1276s/iter; left time: 58189.4764s
	iters: 2100, epoch: 2 | loss: 0.0694183
	speed: 0.1274s/iter; left time: 58085.9600s
	iters: 2200, epoch: 2 | loss: 0.0778675
	speed: 0.1275s/iter; left time: 58148.0408s
	iters: 2300, epoch: 2 | loss: 0.0778613
	speed: 0.1275s/iter; left time: 58133.8311s
Epoch: 2 cost time: 295.6539857387543
Epoch: 2, Steps: 2302 | Train Loss: 0.0827156 Vali Loss: 0.1099374 Test Loss: 0.1553550
Validation loss decreased (0.114226 --> 0.109937).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0636001
	speed: 2.5645s/iter; left time: 1168635.8900s
	iters: 200, epoch: 3 | loss: 0.0709437
	speed: 0.1278s/iter; left time: 58222.2529s
	iters: 300, epoch: 3 | loss: 0.0666787
	speed: 0.1277s/iter; left time: 58184.0266s
	iters: 400, epoch: 3 | loss: 0.0567614
	speed: 0.1276s/iter; left time: 58117.3736s
	iters: 500, epoch: 3 | loss: 0.0780343
	speed: 0.1283s/iter; left time: 58434.5011s
	iters: 600, epoch: 3 | loss: 0.0638576
	speed: 0.1276s/iter; left time: 58082.7627s
	iters: 700, epoch: 3 | loss: 0.0613838
	speed: 0.1274s/iter; left time: 57999.8129s
	iters: 800, epoch: 3 | loss: 0.0665494
	speed: 0.1278s/iter; left time: 58151.5997s
	iters: 900, epoch: 3 | loss: 0.0660721
	speed: 0.1276s/iter; left time: 58046.8896s
	iters: 1000, epoch: 3 | loss: 0.0699610
	speed: 0.1278s/iter; left time: 58103.9356s
	iters: 1100, epoch: 3 | loss: 0.0719126
	speed: 0.1273s/iter; left time: 57884.1315s
	iters: 1200, epoch: 3 | loss: 0.0668694
	speed: 0.1278s/iter; left time: 58078.3645s
	iters: 1300, epoch: 3 | loss: 0.0588284
	speed: 0.1279s/iter; left time: 58131.1316s
	iters: 1400, epoch: 3 | loss: 0.0583386
	speed: 0.1279s/iter; left time: 58118.7358s
	iters: 1500, epoch: 3 | loss: 0.0555802
	speed: 0.1280s/iter; left time: 58168.2622s
	iters: 1600, epoch: 3 | loss: 0.0625261
	speed: 0.1282s/iter; left time: 58220.0103s
	iters: 1700, epoch: 3 | loss: 0.0523592
	speed: 0.1281s/iter; left time: 58166.6002s
	iters: 1800, epoch: 3 | loss: 0.0513605
	speed: 0.1276s/iter; left time: 57937.2639s
	iters: 1900, epoch: 3 | loss: 0.0545940
	speed: 0.1283s/iter; left time: 58218.3149s
	iters: 2000, epoch: 3 | loss: 0.0516834
	speed: 0.1282s/iter; left time: 58171.3773s
	iters: 2100, epoch: 3 | loss: 0.0575855
	speed: 0.1278s/iter; left time: 57989.5951s
	iters: 2200, epoch: 3 | loss: 0.0527307
	speed: 0.1282s/iter; left time: 58145.2466s
	iters: 2300, epoch: 3 | loss: 0.0524030
	speed: 0.1275s/iter; left time: 57822.7726s
Epoch: 3 cost time: 294.74051427841187
Epoch: 3, Steps: 2302 | Train Loss: 0.0619331 Vali Loss: 0.1172680 Test Loss: 0.1723576
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.0516556
	speed: 2.5597s/iter; left time: 1160560.9746s
	iters: 200, epoch: 4 | loss: 0.0561812
	speed: 0.1023s/iter; left time: 46379.6157s
	iters: 300, epoch: 4 | loss: 0.0573308
	speed: 0.1026s/iter; left time: 46518.1042s
	iters: 400, epoch: 4 | loss: 0.0568928
	speed: 0.1031s/iter; left time: 46726.9764s
	iters: 500, epoch: 4 | loss: 0.0586121
	speed: 0.1037s/iter; left time: 46977.4915s
	iters: 600, epoch: 4 | loss: 0.0559119
	speed: 0.1035s/iter; left time: 46856.6310s
	iters: 700, epoch: 4 | loss: 0.0509788
	speed: 0.1038s/iter; left time: 46980.8343s
	iters: 800, epoch: 4 | loss: 0.0543589
	speed: 0.1035s/iter; left time: 46846.0693s
	iters: 900, epoch: 4 | loss: 0.0555229
	speed: 0.1036s/iter; left time: 46891.7442s
	iters: 1000, epoch: 4 | loss: 0.0582045
	speed: 0.1045s/iter; left time: 47295.9227s
	iters: 1100, epoch: 4 | loss: 0.0502784
	speed: 0.1034s/iter; left time: 46767.5017s
	iters: 1200, epoch: 4 | loss: 0.0530863
	speed: 0.1040s/iter; left time: 47040.7034s
	iters: 1300, epoch: 4 | loss: 0.0516151
	speed: 0.1036s/iter; left time: 46849.0295s
	iters: 1400, epoch: 4 | loss: 0.0533511
	speed: 0.1032s/iter; left time: 46636.0808s
	iters: 1500, epoch: 4 | loss: 0.0568648
	speed: 0.1038s/iter; left time: 46903.4235s
	iters: 1600, epoch: 4 | loss: 0.0540341
	speed: 0.1042s/iter; left time: 47070.7165s
	iters: 1700, epoch: 4 | loss: 0.0529013
	speed: 0.1034s/iter; left time: 46697.4126s
	iters: 1800, epoch: 4 | loss: 0.0498930
	speed: 0.1053s/iter; left time: 47570.9820s
	iters: 1900, epoch: 4 | loss: 0.0530491
	speed: 0.1081s/iter; left time: 48801.7115s
	iters: 2000, epoch: 4 | loss: 0.0509705
	speed: 0.1058s/iter; left time: 47786.6167s
	iters: 2100, epoch: 4 | loss: 0.0473061
	speed: 0.1046s/iter; left time: 47200.7297s
	iters: 2200, epoch: 4 | loss: 0.0502813
	speed: 0.1044s/iter; left time: 47096.2741s
	iters: 2300, epoch: 4 | loss: 0.0450555
	speed: 0.1042s/iter; left time: 47018.7545s
Epoch: 4 cost time: 239.77535128593445
Epoch: 4, Steps: 2302 | Train Loss: 0.0534966 Vali Loss: 0.1264018 Test Loss: 0.1604148
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.0467737
	speed: 2.5563s/iter; left time: 1153111.4543s
	iters: 200, epoch: 5 | loss: 0.0497353
	speed: 0.0976s/iter; left time: 44016.8318s
	iters: 300, epoch: 5 | loss: 0.0554576
	speed: 0.0974s/iter; left time: 43907.0172s
	iters: 400, epoch: 5 | loss: 0.0482347
	speed: 0.0971s/iter; left time: 43788.0683s
	iters: 500, epoch: 5 | loss: 0.0499139
	speed: 0.0967s/iter; left time: 43586.3836s
	iters: 600, epoch: 5 | loss: 0.0548112
	speed: 0.0971s/iter; left time: 43765.8932s
	iters: 700, epoch: 5 | loss: 0.0500354
	speed: 0.0968s/iter; left time: 43594.1906s
	iters: 800, epoch: 5 | loss: 0.0511538
	speed: 0.0973s/iter; left time: 43837.0548s
	iters: 900, epoch: 5 | loss: 0.0505886
	speed: 0.0973s/iter; left time: 43824.9340s
	iters: 1000, epoch: 5 | loss: 0.0473678
	speed: 0.0965s/iter; left time: 43431.6196s
	iters: 1100, epoch: 5 | loss: 0.0451015
	speed: 0.0969s/iter; left time: 43603.0244s
	iters: 1200, epoch: 5 | loss: 0.0431882
	speed: 0.0967s/iter; left time: 43535.7078s
	iters: 1300, epoch: 5 | loss: 0.0511796
	speed: 0.0963s/iter; left time: 43325.7884s
	iters: 1400, epoch: 5 | loss: 0.0442566
	speed: 0.0966s/iter; left time: 43471.1721s
	iters: 1500, epoch: 5 | loss: 0.0438351
	speed: 0.0961s/iter; left time: 43223.5165s
	iters: 1600, epoch: 5 | loss: 0.0437989
	speed: 0.0968s/iter; left time: 43533.0744s
	iters: 1700, epoch: 5 | loss: 0.0467777
	speed: 0.0971s/iter; left time: 43637.4136s
	iters: 1800, epoch: 5 | loss: 0.0469304
	speed: 0.0967s/iter; left time: 43437.5812s
	iters: 1900, epoch: 5 | loss: 0.0407339
	speed: 0.0967s/iter; left time: 43428.7487s
	iters: 2000, epoch: 5 | loss: 0.0441717
	speed: 0.0968s/iter; left time: 43479.3135s
	iters: 2100, epoch: 5 | loss: 0.0478621
	speed: 0.0970s/iter; left time: 43567.3416s
	iters: 2200, epoch: 5 | loss: 0.0456315
	speed: 0.0969s/iter; left time: 43498.2543s
	iters: 2300, epoch: 5 | loss: 0.0445957
	speed: 0.0967s/iter; left time: 43407.5938s
Epoch: 5 cost time: 223.42722749710083
Epoch: 5, Steps: 2302 | Train Loss: 0.0468787 Vali Loss: 0.1210738 Test Loss: 0.2025858
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.0472811
	speed: 2.5482s/iter; left time: 1143612.9506s
	iters: 200, epoch: 6 | loss: 0.0439490
	speed: 0.0961s/iter; left time: 43104.3499s
	iters: 300, epoch: 6 | loss: 0.0392559
	speed: 0.0974s/iter; left time: 43684.0810s
	iters: 400, epoch: 6 | loss: 0.0428206
	speed: 0.0968s/iter; left time: 43426.4825s
	iters: 500, epoch: 6 | loss: 0.0466790
	speed: 0.0973s/iter; left time: 43613.2286s
	iters: 600, epoch: 6 | loss: 0.0390764
	speed: 0.0970s/iter; left time: 43472.9171s
	iters: 700, epoch: 6 | loss: 0.0390484
	speed: 0.0970s/iter; left time: 43460.9232s
	iters: 800, epoch: 6 | loss: 0.0427102
	speed: 0.0972s/iter; left time: 43555.8139s
	iters: 900, epoch: 6 | loss: 0.0438559
	speed: 0.0968s/iter; left time: 43385.6456s
	iters: 1000, epoch: 6 | loss: 0.0388055
	speed: 0.0966s/iter; left time: 43270.2455s
	iters: 1100, epoch: 6 | loss: 0.0415017
	speed: 0.0965s/iter; left time: 43210.5882s
	iters: 1200, epoch: 6 | loss: 0.0404764
	speed: 0.0963s/iter; left time: 43110.2326s
	iters: 1300, epoch: 6 | loss: 0.0406817
	speed: 0.0965s/iter; left time: 43213.5791s
	iters: 1400, epoch: 6 | loss: 0.0404009
	speed: 0.0970s/iter; left time: 43407.1628s
	iters: 1500, epoch: 6 | loss: 0.0444249
	speed: 0.0966s/iter; left time: 43220.0104s
	iters: 1600, epoch: 6 | loss: 0.0388210
	speed: 0.0975s/iter; left time: 43625.4068s
	iters: 1700, epoch: 6 | loss: 0.0428989
	speed: 0.0964s/iter; left time: 43093.8534s
	iters: 1800, epoch: 6 | loss: 0.0383095
	speed: 0.0966s/iter; left time: 43175.3362s
	iters: 1900, epoch: 6 | loss: 0.0391843
	speed: 0.0965s/iter; left time: 43128.9016s
	iters: 2000, epoch: 6 | loss: 0.0402011
	speed: 0.0966s/iter; left time: 43191.6378s
	iters: 2100, epoch: 6 | loss: 0.0419782
	speed: 0.0966s/iter; left time: 43180.5348s
	iters: 2200, epoch: 6 | loss: 0.0411706
	speed: 0.0965s/iter; left time: 43113.3850s
	iters: 2300, epoch: 6 | loss: 0.0400236
	speed: 0.0967s/iter; left time: 43170.9343s
Epoch: 6 cost time: 223.1256537437439
Epoch: 6, Steps: 2302 | Train Loss: 0.0415774 Vali Loss: 0.1131785 Test Loss: 0.1743194
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.0385634
	speed: 2.5426s/iter; left time: 1135241.0099s
	iters: 200, epoch: 7 | loss: 0.0356560
	speed: 0.0962s/iter; left time: 42928.8155s
	iters: 300, epoch: 7 | loss: 0.0377830
	speed: 0.0959s/iter; left time: 42804.1774s
	iters: 400, epoch: 7 | loss: 0.0372936
	speed: 0.0958s/iter; left time: 42727.8596s
	iters: 500, epoch: 7 | loss: 0.0347016
	speed: 0.0960s/iter; left time: 42844.3694s
	iters: 600, epoch: 7 | loss: 0.0391915
	speed: 0.0960s/iter; left time: 42826.1265s
	iters: 700, epoch: 7 | loss: 0.0361400
	speed: 0.0961s/iter; left time: 42836.9022s
	iters: 800, epoch: 7 | loss: 0.0362965
	speed: 0.0966s/iter; left time: 43082.0684s
	iters: 900, epoch: 7 | loss: 0.0362677
	speed: 0.0956s/iter; left time: 42599.1218s
	iters: 1000, epoch: 7 | loss: 0.0340964
	speed: 0.0964s/iter; left time: 42945.0647s
	iters: 1100, epoch: 7 | loss: 0.0339996
	speed: 0.0959s/iter; left time: 42741.0329s
	iters: 1200, epoch: 7 | loss: 0.0360918
	speed: 0.0966s/iter; left time: 43040.3107s
	iters: 1300, epoch: 7 | loss: 0.0389085
	speed: 0.0952s/iter; left time: 42386.1726s
	iters: 1400, epoch: 7 | loss: 0.0365462
	speed: 0.0962s/iter; left time: 42814.9400s
	iters: 1500, epoch: 7 | loss: 0.0373774
	speed: 0.0976s/iter; left time: 43422.4692s
	iters: 1600, epoch: 7 | loss: 0.0372928
	speed: 0.0966s/iter; left time: 43003.1854s
	iters: 1700, epoch: 7 | loss: 0.0352569
	speed: 0.0970s/iter; left time: 43158.2331s
	iters: 1800, epoch: 7 | loss: 0.0346301
	speed: 0.0977s/iter; left time: 43439.0557s
	iters: 1900, epoch: 7 | loss: 0.0359806
	speed: 0.0978s/iter; left time: 43468.5824s
	iters: 2000, epoch: 7 | loss: 0.0367984
	speed: 0.0971s/iter; left time: 43174.9270s
	iters: 2100, epoch: 7 | loss: 0.0362417
	speed: 0.0972s/iter; left time: 43199.9913s
	iters: 2200, epoch: 7 | loss: 0.0367158
	speed: 0.0970s/iter; left time: 43106.8044s
	iters: 2300, epoch: 7 | loss: 0.0345341
	speed: 0.0975s/iter; left time: 43322.9876s
Epoch: 7 cost time: 222.69459652900696
Epoch: 7, Steps: 2302 | Train Loss: 0.0373901 Vali Loss: 0.1244807 Test Loss: 0.1798834
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems05_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 21010
test shape: (21010, 1, 96, 103) (21010, 1, 96, 103)
test shape: (21010, 96, 103) (21010, 96, 103)
mse:0.15535497665405273, mae:0.2716156542301178
>>>>>>>Overall time: 3911 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
