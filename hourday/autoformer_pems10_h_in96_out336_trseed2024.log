Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems10_h.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems10_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 102250
val 14335
test 29002
	iters: 100, epoch: 1 | loss: 0.2489479
	speed: 0.1668s/iter; left time: 106574.6569s
	iters: 200, epoch: 1 | loss: 0.2132721
	speed: 0.1630s/iter; left time: 104113.9716s
	iters: 300, epoch: 1 | loss: 0.1607906
	speed: 0.1630s/iter; left time: 104077.8390s
	iters: 400, epoch: 1 | loss: 0.1720072
	speed: 0.1628s/iter; left time: 103994.5336s
	iters: 500, epoch: 1 | loss: 0.1479936
	speed: 0.1625s/iter; left time: 103733.1745s
	iters: 600, epoch: 1 | loss: 0.1417286
	speed: 0.1626s/iter; left time: 103823.4469s
	iters: 700, epoch: 1 | loss: 0.1406569
	speed: 0.1634s/iter; left time: 104287.1609s
	iters: 800, epoch: 1 | loss: 0.1138481
	speed: 0.1633s/iter; left time: 104223.9820s
	iters: 900, epoch: 1 | loss: 0.1195329
	speed: 0.1635s/iter; left time: 104343.1107s
	iters: 1000, epoch: 1 | loss: 0.0955596
	speed: 0.1629s/iter; left time: 103916.6194s
	iters: 1100, epoch: 1 | loss: 0.1046733
	speed: 0.1631s/iter; left time: 104020.4350s
	iters: 1200, epoch: 1 | loss: 0.1102521
	speed: 0.1624s/iter; left time: 103592.6442s
	iters: 1300, epoch: 1 | loss: 0.1434391
	speed: 0.1632s/iter; left time: 104086.2081s
	iters: 1400, epoch: 1 | loss: 0.1693858
	speed: 0.2238s/iter; left time: 142723.2442s
	iters: 1500, epoch: 1 | loss: 0.1015538
	speed: 0.2244s/iter; left time: 143037.5329s
	iters: 1600, epoch: 1 | loss: 0.1561336
	speed: 0.2244s/iter; left time: 143055.9356s
	iters: 1700, epoch: 1 | loss: 0.1346156
	speed: 0.2241s/iter; left time: 142819.3658s
	iters: 1800, epoch: 1 | loss: 0.1065310
	speed: 0.2244s/iter; left time: 142963.8405s
	iters: 1900, epoch: 1 | loss: 0.1296580
	speed: 0.2238s/iter; left time: 142552.7219s
	iters: 2000, epoch: 1 | loss: 0.1235926
	speed: 0.2247s/iter; left time: 143138.9727s
	iters: 2100, epoch: 1 | loss: 0.1245807
	speed: 0.2241s/iter; left time: 142760.9459s
	iters: 2200, epoch: 1 | loss: 0.1057309
	speed: 0.2238s/iter; left time: 142509.6135s
	iters: 2300, epoch: 1 | loss: 0.1221354
	speed: 0.2237s/iter; left time: 142401.3134s
	iters: 2400, epoch: 1 | loss: 0.1525845
	speed: 0.2239s/iter; left time: 142560.1763s
	iters: 2500, epoch: 1 | loss: 0.1041643
	speed: 0.2239s/iter; left time: 142481.2648s
	iters: 2600, epoch: 1 | loss: 0.0981450
	speed: 0.2242s/iter; left time: 142685.7643s
	iters: 2700, epoch: 1 | loss: 0.1128563
	speed: 0.2240s/iter; left time: 142556.4546s
	iters: 2800, epoch: 1 | loss: 0.1154189
	speed: 0.2241s/iter; left time: 142597.8497s
	iters: 2900, epoch: 1 | loss: 0.1107501
	speed: 0.2241s/iter; left time: 142530.6283s
	iters: 3000, epoch: 1 | loss: 0.1100753
	speed: 0.2242s/iter; left time: 142591.1426s
	iters: 3100, epoch: 1 | loss: 0.1021934
	speed: 0.2234s/iter; left time: 142066.6308s
Epoch: 1 cost time: 637.1430332660675
Epoch: 1, Steps: 3195 | Train Loss: 0.1382910 Vali Loss: 0.2274367 Test Loss: 0.2841357
Validation loss decreased (inf --> 0.227437).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0990189
	speed: 4.1426s/iter; left time: 2633451.9588s
	iters: 200, epoch: 2 | loss: 0.1259475
	speed: 0.1837s/iter; left time: 116767.0483s
	iters: 300, epoch: 2 | loss: 0.1150093
	speed: 0.2018s/iter; left time: 128260.5144s
	iters: 400, epoch: 2 | loss: 0.1149504
	speed: 0.2033s/iter; left time: 129156.5789s
	iters: 500, epoch: 2 | loss: 0.1107973
	speed: 0.2208s/iter; left time: 140267.7773s
	iters: 600, epoch: 2 | loss: 0.0924230
	speed: 0.2033s/iter; left time: 129131.2094s
	iters: 700, epoch: 2 | loss: 0.1123031
	speed: 0.2205s/iter; left time: 140035.0384s
	iters: 800, epoch: 2 | loss: 0.0982240
	speed: 0.2225s/iter; left time: 141319.3340s
	iters: 900, epoch: 2 | loss: 0.1336930
	speed: 0.1926s/iter; left time: 122300.9392s
	iters: 1000, epoch: 2 | loss: 0.0883015
	speed: 0.2114s/iter; left time: 134208.5442s
	iters: 1100, epoch: 2 | loss: 0.1077037
	speed: 0.2251s/iter; left time: 142880.2031s
	iters: 1200, epoch: 2 | loss: 0.1270517
	speed: 0.2253s/iter; left time: 142964.5276s
	iters: 1300, epoch: 2 | loss: 0.1050738
	speed: 0.2222s/iter; left time: 140967.8002s
	iters: 1400, epoch: 2 | loss: 0.0937309
	speed: 0.2248s/iter; left time: 142618.5104s
	iters: 1500, epoch: 2 | loss: 0.1268891
	speed: 0.2003s/iter; left time: 127058.2864s
	iters: 1600, epoch: 2 | loss: 0.1204622
	speed: 0.2159s/iter; left time: 136950.4292s
	iters: 1700, epoch: 2 | loss: 0.1051343
	speed: 0.2255s/iter; left time: 143003.5264s
	iters: 1800, epoch: 2 | loss: 0.1011835
	speed: 0.2253s/iter; left time: 142825.0405s
	iters: 1900, epoch: 2 | loss: 0.1030485
	speed: 0.1879s/iter; left time: 119136.0618s
	iters: 2000, epoch: 2 | loss: 0.0978803
	speed: 0.1706s/iter; left time: 108100.3465s
	iters: 2100, epoch: 2 | loss: 0.1360779
	speed: 0.1946s/iter; left time: 123337.0312s
	iters: 2200, epoch: 2 | loss: 0.0945109
	speed: 0.2082s/iter; left time: 131912.9922s
	iters: 2300, epoch: 2 | loss: 0.0953401
	speed: 0.1763s/iter; left time: 111656.8009s
	iters: 2400, epoch: 2 | loss: 0.0850730
	speed: 0.2255s/iter; left time: 142824.5550s
	iters: 2500, epoch: 2 | loss: 0.0897325
	speed: 0.2226s/iter; left time: 140969.8765s
	iters: 2600, epoch: 2 | loss: 0.0922609
	speed: 0.2071s/iter; left time: 131109.9954s
	iters: 2700, epoch: 2 | loss: 0.0930316
	speed: 0.1744s/iter; left time: 110385.6806s
	iters: 2800, epoch: 2 | loss: 0.0940496
	speed: 0.1657s/iter; left time: 104870.9984s
	iters: 2900, epoch: 2 | loss: 0.0903935
	speed: 0.1922s/iter; left time: 121660.6823s
	iters: 3000, epoch: 2 | loss: 0.1056122
	speed: 0.1880s/iter; left time: 118951.2018s
	iters: 3100, epoch: 2 | loss: 0.0811317
	speed: 0.1632s/iter; left time: 103288.5398s
Epoch: 2 cost time: 647.2247350215912
Epoch: 2, Steps: 3195 | Train Loss: 0.1011189 Vali Loss: 0.2632925 Test Loss: 0.3361732
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.1072204
	speed: 4.0423s/iter; left time: 2556810.9463s
	iters: 200, epoch: 3 | loss: 0.1053048
	speed: 0.1630s/iter; left time: 103060.9368s
	iters: 300, epoch: 3 | loss: 0.0837019
	speed: 0.1631s/iter; left time: 103126.8694s
	iters: 400, epoch: 3 | loss: 0.0885811
	speed: 0.1623s/iter; left time: 102609.3000s
	iters: 500, epoch: 3 | loss: 0.0873135
	speed: 0.1630s/iter; left time: 103023.9079s
	iters: 600, epoch: 3 | loss: 0.0758655
	speed: 0.1630s/iter; left time: 103012.7493s
	iters: 700, epoch: 3 | loss: 0.0890744
	speed: 0.1625s/iter; left time: 102655.3213s
	iters: 800, epoch: 3 | loss: 0.0817412
	speed: 0.1627s/iter; left time: 102822.9749s
	iters: 900, epoch: 3 | loss: 0.1034819
	speed: 0.1631s/iter; left time: 103019.6262s
	iters: 1000, epoch: 3 | loss: 0.0913852
	speed: 0.1628s/iter; left time: 102845.6889s
	iters: 1100, epoch: 3 | loss: 0.0803563
	speed: 0.1629s/iter; left time: 102879.3916s
	iters: 1200, epoch: 3 | loss: 0.0853723
	speed: 0.1629s/iter; left time: 102883.8104s
	iters: 1300, epoch: 3 | loss: 0.0752721
	speed: 0.1626s/iter; left time: 102636.0703s
	iters: 1400, epoch: 3 | loss: 0.0898428
	speed: 0.1638s/iter; left time: 103404.3854s
	iters: 1500, epoch: 3 | loss: 0.2366274
	speed: 0.1652s/iter; left time: 104282.4083s
	iters: 1600, epoch: 3 | loss: 0.1869738
	speed: 0.1643s/iter; left time: 103644.1703s
	iters: 1700, epoch: 3 | loss: 0.1809084
	speed: 0.1651s/iter; left time: 104150.0502s
	iters: 1800, epoch: 3 | loss: 0.1751120
	speed: 0.1644s/iter; left time: 103719.8676s
	iters: 1900, epoch: 3 | loss: 0.1502296
	speed: 0.1644s/iter; left time: 103717.3228s
	iters: 2000, epoch: 3 | loss: 0.1584458
	speed: 0.1655s/iter; left time: 104357.5097s
	iters: 2100, epoch: 3 | loss: 0.1439326
	speed: 0.1656s/iter; left time: 104389.2877s
	iters: 2200, epoch: 3 | loss: 0.1168866
	speed: 0.1635s/iter; left time: 103080.8237s
	iters: 2300, epoch: 3 | loss: 0.1266466
	speed: 0.1628s/iter; left time: 102617.7880s
	iters: 2400, epoch: 3 | loss: 0.1306344
	speed: 0.1632s/iter; left time: 102855.9581s
	iters: 2500, epoch: 3 | loss: 0.1311308
	speed: 0.1625s/iter; left time: 102381.6906s
	iters: 2600, epoch: 3 | loss: 0.1584370
	speed: 0.1629s/iter; left time: 102644.8622s
	iters: 2700, epoch: 3 | loss: 0.1244109
	speed: 0.1621s/iter; left time: 102130.2071s
	iters: 2800, epoch: 3 | loss: 0.1314268
	speed: 0.1623s/iter; left time: 102208.7949s
	iters: 2900, epoch: 3 | loss: 0.1277010
	speed: 0.1626s/iter; left time: 102374.7099s
	iters: 3000, epoch: 3 | loss: 0.1645594
	speed: 0.1623s/iter; left time: 102209.9928s
	iters: 3100, epoch: 3 | loss: 0.1435147
	speed: 0.1621s/iter; left time: 102037.6953s
Epoch: 3 cost time: 522.0287573337555
Epoch: 3, Steps: 3195 | Train Loss: 0.1270039 Vali Loss: 0.2632995 Test Loss: 0.3106496
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.1040033
	speed: 4.0327s/iter; left time: 2537816.5155s
	iters: 200, epoch: 4 | loss: 0.1166683
	speed: 0.1625s/iter; left time: 102244.8262s
	iters: 300, epoch: 4 | loss: 0.1029241
	speed: 0.1628s/iter; left time: 102448.9208s
	iters: 400, epoch: 4 | loss: 0.1130005
	speed: 0.1623s/iter; left time: 102073.7616s
	iters: 500, epoch: 4 | loss: 0.1028303
	speed: 0.1627s/iter; left time: 102340.5813s
	iters: 600, epoch: 4 | loss: 0.1073858
	speed: 0.1623s/iter; left time: 102051.5837s
	iters: 700, epoch: 4 | loss: 0.1039844
	speed: 0.1625s/iter; left time: 102184.8414s
	iters: 800, epoch: 4 | loss: 0.1120139
	speed: 0.1624s/iter; left time: 102098.1568s
	iters: 900, epoch: 4 | loss: 0.1091901
	speed: 0.1624s/iter; left time: 102069.6288s
	iters: 1000, epoch: 4 | loss: 0.1151210
	speed: 0.1628s/iter; left time: 102325.7473s
	iters: 1100, epoch: 4 | loss: 0.1194127
	speed: 0.1623s/iter; left time: 101948.1907s
	iters: 1200, epoch: 4 | loss: 0.1061713
	speed: 0.1625s/iter; left time: 102099.8367s
	iters: 1300, epoch: 4 | loss: 0.1053364
	speed: 0.1622s/iter; left time: 101857.5089s
	iters: 1400, epoch: 4 | loss: 0.1026005
	speed: 0.1625s/iter; left time: 102064.4362s
	iters: 1500, epoch: 4 | loss: 0.1109050
	speed: 0.1621s/iter; left time: 101803.0708s
	iters: 1600, epoch: 4 | loss: 0.1011863
	speed: 0.1625s/iter; left time: 102001.4270s
	iters: 1700, epoch: 4 | loss: 0.0923784
	speed: 0.1628s/iter; left time: 102185.7472s
	iters: 1800, epoch: 4 | loss: 0.1128122
	speed: 0.1628s/iter; left time: 102164.1772s
	iters: 1900, epoch: 4 | loss: 0.0833708
	speed: 0.1621s/iter; left time: 101693.4003s
	iters: 2000, epoch: 4 | loss: 0.0844838
	speed: 0.1630s/iter; left time: 102246.0629s
	iters: 2100, epoch: 4 | loss: 0.0977614
	speed: 0.1627s/iter; left time: 102046.6167s
	iters: 2200, epoch: 4 | loss: 0.0986082
	speed: 0.1630s/iter; left time: 102206.4807s
	iters: 2300, epoch: 4 | loss: 0.0905428
	speed: 0.1627s/iter; left time: 102034.2341s
	iters: 2400, epoch: 4 | loss: 0.0889897
	speed: 0.1623s/iter; left time: 101757.0325s
	iters: 2500, epoch: 4 | loss: 0.0786728
	speed: 0.1628s/iter; left time: 102077.7593s
	iters: 2600, epoch: 4 | loss: 0.0965371
	speed: 0.1621s/iter; left time: 101604.1435s
	iters: 2700, epoch: 4 | loss: 0.1100340
	speed: 0.1620s/iter; left time: 101551.1152s
	iters: 2800, epoch: 4 | loss: 0.0929707
	speed: 0.1631s/iter; left time: 102170.0769s
	iters: 2900, epoch: 4 | loss: 0.0826651
	speed: 0.1628s/iter; left time: 102015.5390s
	iters: 3000, epoch: 4 | loss: 0.0874684
	speed: 0.1622s/iter; left time: 101590.7247s
	iters: 3100, epoch: 4 | loss: 0.1591187
	speed: 0.1629s/iter; left time: 102001.3535s
Epoch: 4 cost time: 519.6735615730286
Epoch: 4, Steps: 3195 | Train Loss: 0.1101115 Vali Loss: 0.3417771 Test Loss: 0.3565387
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.1218532
	speed: 4.0418s/iter; left time: 2530669.9501s
	iters: 200, epoch: 5 | loss: 0.0994424
	speed: 0.1653s/iter; left time: 103503.3041s
	iters: 300, epoch: 5 | loss: 0.0975823
	speed: 0.1652s/iter; left time: 103405.3247s
	iters: 400, epoch: 5 | loss: 0.0878998
	speed: 0.1647s/iter; left time: 103069.0857s
	iters: 500, epoch: 5 | loss: 0.0963835
	speed: 0.1626s/iter; left time: 101726.7806s
	iters: 600, epoch: 5 | loss: 0.1004390
	speed: 0.1624s/iter; left time: 101627.3487s
	iters: 700, epoch: 5 | loss: 0.0959195
	speed: 0.1626s/iter; left time: 101686.3092s
	iters: 800, epoch: 5 | loss: 0.0892363
	speed: 0.1625s/iter; left time: 101644.4474s
	iters: 900, epoch: 5 | loss: 0.0953042
	speed: 0.1622s/iter; left time: 101421.7574s
	iters: 1000, epoch: 5 | loss: 0.0776223
	speed: 0.1627s/iter; left time: 101703.8427s
	iters: 1100, epoch: 5 | loss: 0.0880596
	speed: 0.1624s/iter; left time: 101546.4047s
	iters: 1200, epoch: 5 | loss: 0.0821115
	speed: 0.1625s/iter; left time: 101550.7948s
	iters: 1300, epoch: 5 | loss: 0.0934010
	speed: 0.1622s/iter; left time: 101337.3463s
	iters: 1400, epoch: 5 | loss: 0.1000336
	speed: 0.1626s/iter; left time: 101568.5185s
	iters: 1500, epoch: 5 | loss: 0.0843660
	speed: 0.1625s/iter; left time: 101527.9878s
	iters: 1600, epoch: 5 | loss: 0.0784228
	speed: 0.1622s/iter; left time: 101300.7638s
	iters: 1700, epoch: 5 | loss: 0.0893368
	speed: 0.1624s/iter; left time: 101440.5204s
	iters: 1800, epoch: 5 | loss: 0.0822927
	speed: 0.1621s/iter; left time: 101202.0762s
	iters: 1900, epoch: 5 | loss: 0.0735056
	speed: 0.1623s/iter; left time: 101298.3978s
	iters: 2000, epoch: 5 | loss: 0.0905198
	speed: 0.1622s/iter; left time: 101267.1246s
	iters: 2100, epoch: 5 | loss: 0.0882385
	speed: 0.1622s/iter; left time: 101205.5587s
	iters: 2200, epoch: 5 | loss: 0.0790526
	speed: 0.1619s/iter; left time: 101021.0555s
	iters: 2300, epoch: 5 | loss: 0.0784269
	speed: 0.1624s/iter; left time: 101315.9062s
	iters: 2400, epoch: 5 | loss: 0.0993558
	speed: 0.1622s/iter; left time: 101197.9731s
	iters: 2500, epoch: 5 | loss: 0.0849413
	speed: 0.1623s/iter; left time: 101200.7020s
	iters: 2600, epoch: 5 | loss: 0.1025656
	speed: 0.1624s/iter; left time: 101272.3022s
	iters: 2700, epoch: 5 | loss: 0.0674801
	speed: 0.1623s/iter; left time: 101208.2258s
	iters: 2800, epoch: 5 | loss: 0.0799230
	speed: 0.1620s/iter; left time: 101022.6317s
	iters: 2900, epoch: 5 | loss: 0.0949651
	speed: 0.1621s/iter; left time: 101009.5049s
	iters: 3000, epoch: 5 | loss: 0.0956946
	speed: 0.1627s/iter; left time: 101371.5976s
	iters: 3100, epoch: 5 | loss: 0.0996242
	speed: 0.1621s/iter; left time: 101002.8498s
Epoch: 5 cost time: 520.1537549495697
Epoch: 5, Steps: 3195 | Train Loss: 0.0942805 Vali Loss: 0.3251103 Test Loss: 0.3233670
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 6 | loss: 0.0852734
	speed: 4.8632s/iter; left time: 3029442.1920s
	iters: 200, epoch: 6 | loss: 0.0872526
	speed: 0.1632s/iter; left time: 101656.6709s
	iters: 300, epoch: 6 | loss: 0.0732511
	speed: 0.1627s/iter; left time: 101321.8346s
	iters: 400, epoch: 6 | loss: 0.0917579
	speed: 0.1634s/iter; left time: 101749.5291s
	iters: 500, epoch: 6 | loss: 0.0945462
	speed: 0.1623s/iter; left time: 101019.6138s
	iters: 600, epoch: 6 | loss: 0.0696775
	speed: 0.1623s/iter; left time: 100990.8587s
	iters: 700, epoch: 6 | loss: 0.0817074
	speed: 0.1620s/iter; left time: 100815.8657s
	iters: 800, epoch: 6 | loss: 0.0711349
	speed: 0.1625s/iter; left time: 101123.2355s
	iters: 900, epoch: 6 | loss: 0.0808025
	speed: 0.1622s/iter; left time: 100922.5680s
	iters: 1000, epoch: 6 | loss: 0.0774246
	speed: 0.1626s/iter; left time: 101113.4888s
	iters: 1100, epoch: 6 | loss: 0.0768119
	speed: 0.1625s/iter; left time: 101053.7165s
	iters: 1200, epoch: 6 | loss: 0.0841095
	speed: 0.1621s/iter; left time: 100772.9086s
	iters: 1300, epoch: 6 | loss: 0.0746192
	speed: 0.1629s/iter; left time: 101282.1283s
	iters: 1400, epoch: 6 | loss: 0.0764133
	speed: 0.1627s/iter; left time: 101140.0766s
	iters: 1500, epoch: 6 | loss: 0.0806111
	speed: 0.1652s/iter; left time: 102690.5963s
	iters: 1600, epoch: 6 | loss: 0.0893403
	speed: 0.1631s/iter; left time: 101348.1057s
	iters: 1700, epoch: 6 | loss: 0.0772980
	speed: 0.1620s/iter; left time: 100659.7985s
	iters: 1800, epoch: 6 | loss: 0.0762989
	speed: 0.1623s/iter; left time: 100836.8407s
	iters: 1900, epoch: 6 | loss: 0.0683253
	speed: 0.1624s/iter; left time: 100843.1937s
	iters: 2000, epoch: 6 | loss: 0.0731766
	speed: 0.1625s/iter; left time: 100904.5067s
	iters: 2100, epoch: 6 | loss: 0.0761020
	speed: 0.1621s/iter; left time: 100672.4707s
	iters: 2200, epoch: 6 | loss: 0.0821944
	speed: 0.1622s/iter; left time: 100668.6287s
	iters: 2300, epoch: 6 | loss: 0.0765735
	speed: 0.1626s/iter; left time: 100936.3417s
	iters: 2400, epoch: 6 | loss: 0.0725801
	speed: 0.1622s/iter; left time: 100638.5627s
	iters: 2500, epoch: 6 | loss: 0.0801667
	speed: 0.1626s/iter; left time: 100913.1254s
	iters: 2600, epoch: 6 | loss: 0.0746466
	speed: 0.1625s/iter; left time: 100816.5964s
	iters: 2700, epoch: 6 | loss: 0.2236032
	speed: 0.1622s/iter; left time: 100589.8639s
	iters: 2800, epoch: 6 | loss: 0.0929451
	speed: 0.1624s/iter; left time: 100750.9500s
	iters: 2900, epoch: 6 | loss: 0.0739430
	speed: 0.1622s/iter; left time: 100559.9284s
	iters: 3000, epoch: 6 | loss: 0.0879302
	speed: 0.1623s/iter; left time: 100630.2938s
	iters: 3100, epoch: 6 | loss: 0.0734818
	speed: 0.1625s/iter; left time: 100738.3637s
Epoch: 6 cost time: 519.7421898841858
Epoch: 6, Steps: 3195 | Train Loss: 0.0802438 Vali Loss: 0.2515818 Test Loss: 0.3294939
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems10_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 29002
test shape: (29002, 1, 336, 107) (29002, 1, 336, 107)
test shape: (29002, 336, 107) (29002, 336, 107)
mse:0.28413599729537964, mae:0.36218973994255066
>>>>>>>Overall time: 6274 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems10_h.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems10_h_96_336', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=336, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 102250
val 14335
test 29002
	iters: 100, epoch: 1 | loss: 0.2489480
	speed: 0.2279s/iter; left time: 145627.4909s
	iters: 200, epoch: 1 | loss: 0.2132721
	speed: 0.2245s/iter; left time: 143414.8776s
	iters: 300, epoch: 1 | loss: 0.1607906
	speed: 0.1632s/iter; left time: 104216.7579s
	iters: 400, epoch: 1 | loss: 0.1720072
	speed: 0.1621s/iter; left time: 103547.8148s
	iters: 500, epoch: 1 | loss: 0.1479936
	speed: 0.1621s/iter; left time: 103484.3675s
	iters: 600, epoch: 1 | loss: 0.1417286
	speed: 0.1620s/iter; left time: 103413.5346s
	iters: 700, epoch: 1 | loss: 0.1406406
	speed: 0.1620s/iter; left time: 103374.7245s
	iters: 800, epoch: 1 | loss: 0.1147735
	speed: 0.1620s/iter; left time: 103392.7741s
	iters: 900, epoch: 1 | loss: 0.1174635
	speed: 0.1619s/iter; left time: 103336.3245s
	iters: 1000, epoch: 1 | loss: 0.0955939
	speed: 0.1618s/iter; left time: 103209.1407s
	iters: 1100, epoch: 1 | loss: 0.1036699
	speed: 0.1619s/iter; left time: 103252.2048s
	iters: 1200, epoch: 1 | loss: 0.1098046
	speed: 0.1623s/iter; left time: 103509.0913s
	iters: 1300, epoch: 1 | loss: 0.1434468
	speed: 0.1620s/iter; left time: 103277.1726s
	iters: 1400, epoch: 1 | loss: 0.1200944
	speed: 0.1621s/iter; left time: 103355.9888s
	iters: 1500, epoch: 1 | loss: 0.0896886
	speed: 0.1617s/iter; left time: 103103.4644s
	iters: 1600, epoch: 1 | loss: 0.1011640
	speed: 0.1621s/iter; left time: 103348.3318s
	iters: 1700, epoch: 1 | loss: 0.1086361
	speed: 0.1622s/iter; left time: 103339.7818s
	iters: 1800, epoch: 1 | loss: 0.2253755
	speed: 0.1622s/iter; left time: 103372.8299s
	iters: 1900, epoch: 1 | loss: 0.1330470
	speed: 0.1622s/iter; left time: 103327.4048s
	iters: 2000, epoch: 1 | loss: 0.1221331
	speed: 0.1619s/iter; left time: 103138.5070s
	iters: 2100, epoch: 1 | loss: 0.1227213
	speed: 0.1621s/iter; left time: 103230.1255s
	iters: 2200, epoch: 1 | loss: 0.1026013
	speed: 0.1618s/iter; left time: 103063.1397s
	iters: 2300, epoch: 1 | loss: 0.1152708
	speed: 0.1619s/iter; left time: 103052.4944s
	iters: 2400, epoch: 1 | loss: 0.1461788
	speed: 0.1620s/iter; left time: 103133.7714s
	iters: 2500, epoch: 1 | loss: 0.0991417
	speed: 0.1621s/iter; left time: 103200.4343s
	iters: 2600, epoch: 1 | loss: 0.0919461
	speed: 0.1617s/iter; left time: 102929.1704s
	iters: 2700, epoch: 1 | loss: 0.1047811
	speed: 0.1624s/iter; left time: 103308.8022s
	iters: 2800, epoch: 1 | loss: 0.1073140
	speed: 0.1619s/iter; left time: 103022.8148s
	iters: 2900, epoch: 1 | loss: 0.1007254
	speed: 0.1619s/iter; left time: 102978.9422s
	iters: 3000, epoch: 1 | loss: 0.1005115
	speed: 0.1621s/iter; left time: 103085.9501s
	iters: 3100, epoch: 1 | loss: 0.0947790
	speed: 0.1621s/iter; left time: 103084.8405s
Epoch: 1 cost time: 530.8017816543579
Epoch: 1, Steps: 3195 | Train Loss: 0.1308813 Vali Loss: 0.2272797 Test Loss: 0.2914343
Validation loss decreased (inf --> 0.227280).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0861808
	speed: 4.0274s/iter; left time: 2560221.4135s
	iters: 200, epoch: 2 | loss: 0.1154874
	speed: 0.1621s/iter; left time: 103005.5740s
	iters: 300, epoch: 2 | loss: 0.0973785
	speed: 0.1620s/iter; left time: 102983.6605s
	iters: 400, epoch: 2 | loss: 0.1016335
	speed: 0.1622s/iter; left time: 103033.5805s
	iters: 500, epoch: 2 | loss: 0.0963352
	speed: 0.1624s/iter; left time: 103168.8687s
	iters: 600, epoch: 2 | loss: 0.0795303
	speed: 0.1623s/iter; left time: 103068.5699s
	iters: 700, epoch: 2 | loss: 0.0979645
	speed: 0.1623s/iter; left time: 103102.0131s
	iters: 800, epoch: 2 | loss: 0.0868000
	speed: 0.1621s/iter; left time: 102949.1341s
	iters: 900, epoch: 2 | loss: 0.1177723
	speed: 0.1618s/iter; left time: 102710.8389s
	iters: 1000, epoch: 2 | loss: 0.0756611
	speed: 0.1620s/iter; left time: 102819.1466s
	iters: 1100, epoch: 2 | loss: 0.0934210
	speed: 0.1619s/iter; left time: 102773.3397s
	iters: 1200, epoch: 2 | loss: 0.1120806
	speed: 0.1620s/iter; left time: 102803.1841s
	iters: 1300, epoch: 2 | loss: 0.0882312
	speed: 0.1622s/iter; left time: 102909.8087s
	iters: 1400, epoch: 2 | loss: 0.0815546
	speed: 0.1619s/iter; left time: 102705.8773s
	iters: 1500, epoch: 2 | loss: 0.1114765
	speed: 0.1620s/iter; left time: 102770.0019s
	iters: 1600, epoch: 2 | loss: 0.1030155
	speed: 0.1621s/iter; left time: 102822.8802s
	iters: 1700, epoch: 2 | loss: 0.0876389
	speed: 0.1621s/iter; left time: 102789.0787s
	iters: 1800, epoch: 2 | loss: 0.0867526
	speed: 0.1619s/iter; left time: 102636.9814s
	iters: 1900, epoch: 2 | loss: 0.0867854
	speed: 0.1619s/iter; left time: 102650.2218s
	iters: 2000, epoch: 2 | loss: 0.0852180
	speed: 0.1618s/iter; left time: 102559.7558s
	iters: 2100, epoch: 2 | loss: 0.1194558
	speed: 0.1620s/iter; left time: 102636.6999s
	iters: 2200, epoch: 2 | loss: 0.0811398
	speed: 0.1617s/iter; left time: 102475.5553s
	iters: 2300, epoch: 2 | loss: 0.0813243
	speed: 0.1624s/iter; left time: 102860.9222s
	iters: 2400, epoch: 2 | loss: 0.0707756
	speed: 0.1620s/iter; left time: 102605.0823s
	iters: 2500, epoch: 2 | loss: 0.0752059
	speed: 0.1882s/iter; left time: 119182.2140s
	iters: 2600, epoch: 2 | loss: 0.0804890
	speed: 0.1623s/iter; left time: 102770.2126s
	iters: 2700, epoch: 2 | loss: 0.0820898
	speed: 0.1623s/iter; left time: 102734.0185s
	iters: 2800, epoch: 2 | loss: 0.0788244
	speed: 0.1623s/iter; left time: 102710.1550s
	iters: 2900, epoch: 2 | loss: 0.0766250
	speed: 0.1621s/iter; left time: 102577.1202s
	iters: 3000, epoch: 2 | loss: 0.0930840
	speed: 0.1619s/iter; left time: 102461.5617s
	iters: 3100, epoch: 2 | loss: 0.0683778
	speed: 0.1620s/iter; left time: 102477.0996s
Epoch: 2 cost time: 520.8062980175018
Epoch: 2, Steps: 3195 | Train Loss: 0.0872191 Vali Loss: 0.2954291 Test Loss: 0.3509728
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.0944532
	speed: 4.0159s/iter; left time: 2540072.5268s
	iters: 200, epoch: 3 | loss: 0.0897720
	speed: 0.1628s/iter; left time: 102939.8466s
	iters: 300, epoch: 3 | loss: 0.0709152
	speed: 0.1633s/iter; left time: 103249.0275s
	iters: 400, epoch: 3 | loss: 0.0759942
	speed: 0.1624s/iter; left time: 102676.0903s
	iters: 500, epoch: 3 | loss: 0.0732456
	speed: 0.1619s/iter; left time: 102323.3253s
	iters: 600, epoch: 3 | loss: 0.0645991
	speed: 0.1620s/iter; left time: 102364.5224s
	iters: 700, epoch: 3 | loss: 0.0776308
	speed: 0.1620s/iter; left time: 102341.6727s
	iters: 800, epoch: 3 | loss: 0.0703503
	speed: 0.1635s/iter; left time: 103282.2278s
	iters: 900, epoch: 3 | loss: 0.0888846
	speed: 0.1642s/iter; left time: 103706.7783s
	iters: 1000, epoch: 3 | loss: 0.0774492
	speed: 0.1639s/iter; left time: 103491.3522s
	iters: 1100, epoch: 3 | loss: 0.0694587
	speed: 0.1634s/iter; left time: 103190.3513s
	iters: 1200, epoch: 3 | loss: 0.0748532
	speed: 0.1637s/iter; left time: 103338.4024s
	iters: 1300, epoch: 3 | loss: 0.0637643
	speed: 0.1619s/iter; left time: 102211.6911s
	iters: 1400, epoch: 3 | loss: 0.0782131
	speed: 0.1621s/iter; left time: 102331.3668s
	iters: 1500, epoch: 3 | loss: 0.0795996
	speed: 0.1623s/iter; left time: 102435.3387s
	iters: 1600, epoch: 3 | loss: 0.0669699
	speed: 0.1620s/iter; left time: 102220.0949s
	iters: 1700, epoch: 3 | loss: 0.0770189
	speed: 0.1620s/iter; left time: 102192.2695s
	iters: 1800, epoch: 3 | loss: 0.0654872
	speed: 0.1620s/iter; left time: 102209.9714s
	iters: 1900, epoch: 3 | loss: 0.0630060
	speed: 0.1621s/iter; left time: 102249.2441s
	iters: 2000, epoch: 3 | loss: 0.0700980
	speed: 0.1619s/iter; left time: 102069.8567s
	iters: 2100, epoch: 3 | loss: 0.0663540
	speed: 0.1621s/iter; left time: 102225.5576s
	iters: 2200, epoch: 3 | loss: 0.0619680
	speed: 0.1619s/iter; left time: 102055.6670s
	iters: 2300, epoch: 3 | loss: 0.0598033
	speed: 0.1626s/iter; left time: 102491.1683s
	iters: 2400, epoch: 3 | loss: 0.0741845
	speed: 0.1621s/iter; left time: 102155.6798s
	iters: 2500, epoch: 3 | loss: 0.0680503
	speed: 0.1619s/iter; left time: 101989.3961s
	iters: 2600, epoch: 3 | loss: 0.0786345
	speed: 0.1622s/iter; left time: 102208.4197s
	iters: 2700, epoch: 3 | loss: 0.0691250
	speed: 0.1621s/iter; left time: 102105.3279s
	iters: 2800, epoch: 3 | loss: 0.0738036
	speed: 0.1621s/iter; left time: 102065.2041s
	iters: 2900, epoch: 3 | loss: 0.0659937
	speed: 0.1624s/iter; left time: 102235.5770s
	iters: 3000, epoch: 3 | loss: 0.0623524
	speed: 0.1623s/iter; left time: 102215.5258s
	iters: 3100, epoch: 3 | loss: 0.0719517
	speed: 0.1619s/iter; left time: 101890.3773s
Epoch: 3 cost time: 519.2349174022675
Epoch: 3, Steps: 3195 | Train Loss: 0.0738932 Vali Loss: 0.2610409 Test Loss: 0.3177037
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.0601037
	speed: 4.0307s/iter; left time: 2536558.1278s
	iters: 200, epoch: 4 | loss: 0.0659561
	speed: 0.1628s/iter; left time: 102409.2611s
	iters: 300, epoch: 4 | loss: 0.0599339
	speed: 0.1621s/iter; left time: 102002.8792s
	iters: 400, epoch: 4 | loss: 0.0653194
	speed: 0.1691s/iter; left time: 106376.4306s
	iters: 500, epoch: 4 | loss: 0.0646098
	speed: 0.2254s/iter; left time: 141753.2518s
	iters: 600, epoch: 4 | loss: 0.0636424
	speed: 0.2235s/iter; left time: 140535.4670s
	iters: 700, epoch: 4 | loss: 0.0564795
	speed: 0.2209s/iter; left time: 138886.6991s
	iters: 800, epoch: 4 | loss: 0.0705645
	speed: 0.1620s/iter; left time: 101848.3487s
	iters: 900, epoch: 4 | loss: 0.0612577
	speed: 0.1620s/iter; left time: 101835.6217s
	iters: 1000, epoch: 4 | loss: 0.0649410
	speed: 0.1619s/iter; left time: 101764.9200s
	iters: 1100, epoch: 4 | loss: 0.0705168
	speed: 0.1619s/iter; left time: 101693.9509s
	iters: 1200, epoch: 4 | loss: 0.0653088
	speed: 0.1622s/iter; left time: 101922.4796s
	iters: 1300, epoch: 4 | loss: 0.0691472
	speed: 0.1620s/iter; left time: 101784.0304s
	iters: 1400, epoch: 4 | loss: 0.0665671
	speed: 0.1623s/iter; left time: 101924.7989s
	iters: 1500, epoch: 4 | loss: 0.0705266
	speed: 0.1622s/iter; left time: 101866.3953s
	iters: 1600, epoch: 4 | loss: 0.0607025
	speed: 0.1620s/iter; left time: 101693.1998s
	iters: 1700, epoch: 4 | loss: 0.0599169
	speed: 0.1620s/iter; left time: 101671.0814s
	iters: 1800, epoch: 4 | loss: 0.0695029
	speed: 0.1619s/iter; left time: 101587.6921s
	iters: 1900, epoch: 4 | loss: 0.0576396
	speed: 0.1619s/iter; left time: 101564.7344s
	iters: 2000, epoch: 4 | loss: 0.0599416
	speed: 0.1620s/iter; left time: 101638.3377s
	iters: 2100, epoch: 4 | loss: 0.0624916
	speed: 0.1619s/iter; left time: 101545.7650s
	iters: 2200, epoch: 4 | loss: 0.0646599
	speed: 0.1619s/iter; left time: 101572.7513s
	iters: 2300, epoch: 4 | loss: 0.0646810
	speed: 0.1621s/iter; left time: 101641.7439s
	iters: 2400, epoch: 4 | loss: 0.0618433
	speed: 0.1620s/iter; left time: 101573.5995s
	iters: 2500, epoch: 4 | loss: 0.0538369
	speed: 0.1621s/iter; left time: 101614.0335s
	iters: 2600, epoch: 4 | loss: 0.0603997
	speed: 0.1620s/iter; left time: 101550.7903s
	iters: 2700, epoch: 4 | loss: 0.0723497
	speed: 0.1623s/iter; left time: 101684.8422s
	iters: 2800, epoch: 4 | loss: 0.0633693
	speed: 0.1625s/iter; left time: 101813.1781s
	iters: 2900, epoch: 4 | loss: 0.0598776
	speed: 0.1619s/iter; left time: 101426.7702s
	iters: 3000, epoch: 4 | loss: 0.0612923
	speed: 0.1619s/iter; left time: 101405.9633s
	iters: 3100, epoch: 4 | loss: 0.0569529
	speed: 0.1618s/iter; left time: 101313.3966s
Epoch: 4 cost time: 537.2731742858887
Epoch: 4, Steps: 3195 | Train Loss: 0.0662417 Vali Loss: 0.2968610 Test Loss: 0.4010720
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.0616388
	speed: 4.0306s/iter; left time: 2523654.3548s
	iters: 200, epoch: 5 | loss: 0.0593808
	speed: 0.1622s/iter; left time: 101515.4882s
	iters: 300, epoch: 5 | loss: 0.0631670
	speed: 0.1620s/iter; left time: 101388.3935s
	iters: 400, epoch: 5 | loss: 0.0550746
	speed: 0.1620s/iter; left time: 101397.6679s
	iters: 500, epoch: 5 | loss: 0.0641057
	speed: 0.1620s/iter; left time: 101370.0127s
	iters: 600, epoch: 5 | loss: 0.0669171
	speed: 0.1620s/iter; left time: 101368.7774s
	iters: 700, epoch: 5 | loss: 0.0653984
	speed: 0.1621s/iter; left time: 101384.0138s
	iters: 800, epoch: 5 | loss: 0.0563814
	speed: 0.1622s/iter; left time: 101447.2632s
	iters: 900, epoch: 5 | loss: 0.0580627
	speed: 0.1621s/iter; left time: 101382.5293s
	iters: 1000, epoch: 5 | loss: 0.0546792
	speed: 0.1623s/iter; left time: 101445.4606s
	iters: 1100, epoch: 5 | loss: 0.0545283
	speed: 0.1621s/iter; left time: 101330.7834s
	iters: 1200, epoch: 5 | loss: 0.0562058
	speed: 0.1621s/iter; left time: 101317.2261s
	iters: 1300, epoch: 5 | loss: 0.0658142
	speed: 0.1619s/iter; left time: 101182.0988s
	iters: 1400, epoch: 5 | loss: 0.0667265
	speed: 0.1623s/iter; left time: 101407.4697s
	iters: 1500, epoch: 5 | loss: 0.0534606
	speed: 0.1620s/iter; left time: 101206.0296s
	iters: 1600, epoch: 5 | loss: 0.0566210
	speed: 0.1619s/iter; left time: 101149.4852s
	iters: 1700, epoch: 5 | loss: 0.0610774
	speed: 0.1620s/iter; left time: 101175.3817s
	iters: 1800, epoch: 5 | loss: 0.0629804
	speed: 0.1619s/iter; left time: 101074.4499s
	iters: 1900, epoch: 5 | loss: 0.0513117
	speed: 0.1619s/iter; left time: 101057.9757s
	iters: 2000, epoch: 5 | loss: 0.0647515
	speed: 0.1619s/iter; left time: 101030.1700s
	iters: 2100, epoch: 5 | loss: 0.0603932
	speed: 0.1619s/iter; left time: 101030.1226s
	iters: 2200, epoch: 5 | loss: 0.0589152
	speed: 0.1618s/iter; left time: 100987.2769s
	iters: 2300, epoch: 5 | loss: 0.0526782
	speed: 0.1620s/iter; left time: 101074.9375s
	iters: 2400, epoch: 5 | loss: 0.0703115
	speed: 0.1620s/iter; left time: 101034.0200s
	iters: 2500, epoch: 5 | loss: 0.0592996
	speed: 0.1628s/iter; left time: 101532.4711s
	iters: 2600, epoch: 5 | loss: 0.0734552
	speed: 0.1619s/iter; left time: 100989.5000s
	iters: 2700, epoch: 5 | loss: 0.0495660
	speed: 0.1621s/iter; left time: 101085.2447s
	iters: 2800, epoch: 5 | loss: 0.0563140
	speed: 0.1621s/iter; left time: 101051.5472s
	iters: 2900, epoch: 5 | loss: 0.0621272
	speed: 0.1619s/iter; left time: 100909.8179s
	iters: 3000, epoch: 5 | loss: 0.0691350
	speed: 0.1620s/iter; left time: 100934.6271s
	iters: 3100, epoch: 5 | loss: 0.0580775
	speed: 0.1620s/iter; left time: 100971.0973s
Epoch: 5 cost time: 518.0655989646912
Epoch: 5, Steps: 3195 | Train Loss: 0.0609127 Vali Loss: 0.2217048 Test Loss: 0.3293928
Validation loss decreased (0.227280 --> 0.221705).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.0561656
	speed: 4.0192s/iter; left time: 2503644.1135s
	iters: 200, epoch: 6 | loss: 0.0621503
	speed: 0.1621s/iter; left time: 100929.4399s
	iters: 300, epoch: 6 | loss: 0.0519101
	speed: 0.1622s/iter; left time: 101001.3499s
	iters: 400, epoch: 6 | loss: 0.0635453
	speed: 0.1619s/iter; left time: 100811.2979s
	iters: 500, epoch: 6 | loss: 0.0717089
	speed: 0.1618s/iter; left time: 100705.8740s
	iters: 600, epoch: 6 | loss: 0.0522232
	speed: 0.1619s/iter; left time: 100744.4351s
	iters: 700, epoch: 6 | loss: 0.0637016
	speed: 0.1622s/iter; left time: 100927.4756s
	iters: 800, epoch: 6 | loss: 0.0526747
	speed: 0.1619s/iter; left time: 100760.5088s
	iters: 900, epoch: 6 | loss: 0.0615345
	speed: 0.1623s/iter; left time: 100951.6785s
	iters: 1000, epoch: 6 | loss: 0.0598232
	speed: 0.1619s/iter; left time: 100732.0383s
	iters: 1100, epoch: 6 | loss: 0.0533715
	speed: 0.1620s/iter; left time: 100753.7857s
	iters: 1200, epoch: 6 | loss: 0.0599800
	speed: 0.1619s/iter; left time: 100678.3828s
	iters: 1300, epoch: 6 | loss: 0.0549122
	speed: 0.1621s/iter; left time: 100801.3528s
	iters: 1400, epoch: 6 | loss: 0.0591174
	speed: 0.1624s/iter; left time: 100965.7005s
	iters: 1500, epoch: 6 | loss: 0.0623849
	speed: 0.1623s/iter; left time: 100901.6025s
	iters: 1600, epoch: 6 | loss: 0.0678591
	speed: 0.1621s/iter; left time: 100763.6935s
	iters: 1700, epoch: 6 | loss: 0.0604845
	speed: 0.1620s/iter; left time: 100664.7774s
	iters: 1800, epoch: 6 | loss: 0.0572794
	speed: 0.1619s/iter; left time: 100575.1938s
	iters: 1900, epoch: 6 | loss: 0.0485986
	speed: 0.1621s/iter; left time: 100658.0852s
	iters: 2000, epoch: 6 | loss: 0.0550584
	speed: 0.1620s/iter; left time: 100616.0319s
	iters: 2100, epoch: 6 | loss: 0.0596587
	speed: 0.1621s/iter; left time: 100638.8641s
	iters: 2200, epoch: 6 | loss: 0.0565899
	speed: 0.1620s/iter; left time: 100545.3561s
	iters: 2300, epoch: 6 | loss: 0.0609525
	speed: 0.1620s/iter; left time: 100529.8992s
	iters: 2400, epoch: 6 | loss: 0.0571310
	speed: 0.1622s/iter; left time: 100645.0200s
	iters: 2500, epoch: 6 | loss: 0.0593136
	speed: 0.1624s/iter; left time: 100759.7257s
	iters: 2600, epoch: 6 | loss: 0.0567122
	speed: 0.1621s/iter; left time: 100550.9154s
	iters: 2700, epoch: 6 | loss: 0.0650172
	speed: 0.1620s/iter; left time: 100482.3870s
	iters: 2800, epoch: 6 | loss: 0.0547803
	speed: 0.1618s/iter; left time: 100351.3487s
	iters: 2900, epoch: 6 | loss: 0.0523903
	speed: 0.1618s/iter; left time: 100357.0788s
	iters: 3000, epoch: 6 | loss: 0.2059595
	speed: 0.1623s/iter; left time: 100615.3723s
	iters: 3100, epoch: 6 | loss: 0.1670685
	speed: 0.1617s/iter; left time: 100242.8047s
Epoch: 6 cost time: 518.0250768661499
Epoch: 6, Steps: 3195 | Train Loss: 0.0695677 Vali Loss: 0.2818129 Test Loss: 0.3190268
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.1744108
	speed: 4.0218s/iter; left time: 2492441.0098s
	iters: 200, epoch: 7 | loss: 0.1424479
	speed: 0.1622s/iter; left time: 100534.8972s
	iters: 300, epoch: 7 | loss: 0.1116051
	speed: 0.1623s/iter; left time: 100541.6600s
	iters: 400, epoch: 7 | loss: 0.1065089
	speed: 0.1622s/iter; left time: 100490.4554s
	iters: 500, epoch: 7 | loss: 0.1068902
	speed: 0.1624s/iter; left time: 100568.2962s
	iters: 600, epoch: 7 | loss: 0.1042633
	speed: 0.1621s/iter; left time: 100361.1526s
	iters: 700, epoch: 7 | loss: 0.1000642
	speed: 0.1618s/iter; left time: 100176.6081s
	iters: 800, epoch: 7 | loss: 0.1060624
	speed: 0.1621s/iter; left time: 100361.4021s
	iters: 900, epoch: 7 | loss: 0.0939928
	speed: 0.1620s/iter; left time: 100245.7722s
	iters: 1000, epoch: 7 | loss: 0.1019329
	speed: 0.1621s/iter; left time: 100300.5103s
	iters: 1100, epoch: 7 | loss: 0.0789292
	speed: 0.1621s/iter; left time: 100285.8983s
	iters: 1200, epoch: 7 | loss: 0.0722223
	speed: 0.1622s/iter; left time: 100335.2301s
	iters: 1300, epoch: 7 | loss: 0.0793665
	speed: 0.1621s/iter; left time: 100244.2988s
	iters: 1400, epoch: 7 | loss: 0.0653491
	speed: 0.1616s/iter; left time: 99968.3904s
	iters: 1500, epoch: 7 | loss: 0.0804473
	speed: 0.1620s/iter; left time: 100158.7500s
	iters: 1600, epoch: 7 | loss: 0.0753077
	speed: 0.1623s/iter; left time: 100333.8519s
	iters: 1700, epoch: 7 | loss: 0.0748509
	speed: 0.1621s/iter; left time: 100170.7160s
	iters: 1800, epoch: 7 | loss: 0.0622114
	speed: 0.1623s/iter; left time: 100322.6001s
	iters: 1900, epoch: 7 | loss: 0.0774876
	speed: 0.1621s/iter; left time: 100157.6785s
	iters: 2000, epoch: 7 | loss: 0.0729565
	speed: 0.1618s/iter; left time: 99977.4429s
	iters: 2100, epoch: 7 | loss: 0.0693042
	speed: 0.1621s/iter; left time: 100146.9217s
	iters: 2200, epoch: 7 | loss: 0.0598288
	speed: 0.1621s/iter; left time: 100141.3267s
	iters: 2300, epoch: 7 | loss: 0.0773032
	speed: 0.1620s/iter; left time: 100028.5339s
	iters: 2400, epoch: 7 | loss: 0.0727161
	speed: 0.1620s/iter; left time: 99998.5351s
	iters: 2500, epoch: 7 | loss: 0.0648858
	speed: 0.1618s/iter; left time: 99875.7138s
	iters: 2600, epoch: 7 | loss: 0.0651312
	speed: 0.1619s/iter; left time: 99923.1198s
	iters: 2700, epoch: 7 | loss: 0.0774565
	speed: 0.1621s/iter; left time: 100026.2209s
	iters: 2800, epoch: 7 | loss: 0.0687890
	speed: 0.1623s/iter; left time: 100130.7619s
	iters: 2900, epoch: 7 | loss: 0.0600510
	speed: 0.1618s/iter; left time: 99839.7902s
	iters: 3000, epoch: 7 | loss: 0.0769216
	speed: 0.1624s/iter; left time: 100149.3551s
	iters: 3100, epoch: 7 | loss: 0.0656887
	speed: 0.1619s/iter; left time: 99876.0811s
Epoch: 7 cost time: 518.1265072822571
Epoch: 7, Steps: 3195 | Train Loss: 0.0861530 Vali Loss: 0.2508623 Test Loss: 0.3303123
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 8 | loss: 0.0626577
	speed: 4.0878s/iter; left time: 2520261.8624s
	iters: 200, epoch: 8 | loss: 0.0783739
	speed: 0.2246s/iter; left time: 138453.4467s
	iters: 300, epoch: 8 | loss: 0.0646137
	speed: 0.2241s/iter; left time: 138140.2568s
	iters: 400, epoch: 8 | loss: 0.0573254
	speed: 0.2250s/iter; left time: 138680.3643s
	iters: 500, epoch: 8 | loss: 0.0649972
	speed: 0.2238s/iter; left time: 137876.7666s
	iters: 600, epoch: 8 | loss: 0.0747648
	speed: 0.2245s/iter; left time: 138303.9054s
	iters: 700, epoch: 8 | loss: 0.0618130
	speed: 0.2246s/iter; left time: 138330.5382s
	iters: 800, epoch: 8 | loss: 0.0654014
	speed: 0.2249s/iter; left time: 138474.5062s
	iters: 900, epoch: 8 | loss: 0.0572961
	speed: 0.2244s/iter; left time: 138151.4373s
	iters: 1000, epoch: 8 | loss: 0.0524785
	speed: 0.2244s/iter; left time: 138145.4177s
	iters: 1100, epoch: 8 | loss: 0.0583632
	speed: 0.2245s/iter; left time: 138209.7223s
	iters: 1200, epoch: 8 | loss: 0.0696338
	speed: 0.2239s/iter; left time: 137790.6626s
	iters: 1300, epoch: 8 | loss: 0.0683332
	speed: 0.2242s/iter; left time: 137945.6063s
	iters: 1400, epoch: 8 | loss: 0.0630125
	speed: 0.2248s/iter; left time: 138334.0538s
	iters: 1500, epoch: 8 | loss: 0.0636860
	speed: 0.2251s/iter; left time: 138489.0289s
	iters: 1600, epoch: 8 | loss: 0.0645962
	speed: 0.2242s/iter; left time: 137884.6739s
	iters: 1700, epoch: 8 | loss: 0.0696293
	speed: 0.2243s/iter; left time: 137955.5722s
	iters: 1800, epoch: 8 | loss: 0.0626154
	speed: 0.2245s/iter; left time: 138022.7812s
	iters: 1900, epoch: 8 | loss: 0.0571486
	speed: 0.2255s/iter; left time: 138651.0231s
	iters: 2000, epoch: 8 | loss: 0.0563095
	speed: 0.2249s/iter; left time: 138236.0737s
	iters: 2100, epoch: 8 | loss: 0.0514193
	speed: 0.2247s/iter; left time: 138106.2462s
	iters: 2200, epoch: 8 | loss: 0.0610591
	speed: 0.2251s/iter; left time: 138308.4727s
	iters: 2300, epoch: 8 | loss: 0.0570357
	speed: 0.2242s/iter; left time: 137731.9127s
	iters: 2400, epoch: 8 | loss: 0.0638160
	speed: 0.2246s/iter; left time: 137970.8744s
	iters: 2500, epoch: 8 | loss: 0.0695219
	speed: 0.2249s/iter; left time: 138101.7770s
	iters: 2600, epoch: 8 | loss: 0.0612291
	speed: 0.2253s/iter; left time: 138334.0714s
	iters: 2700, epoch: 8 | loss: 0.0613880
	speed: 0.2247s/iter; left time: 137951.3242s
	iters: 2800, epoch: 8 | loss: 0.0547632
	speed: 0.2242s/iter; left time: 137599.1894s
	iters: 2900, epoch: 8 | loss: 0.0624860
	speed: 0.2242s/iter; left time: 137596.8871s
	iters: 3000, epoch: 8 | loss: 0.0646574
	speed: 0.2245s/iter; left time: 137731.2172s
	iters: 3100, epoch: 8 | loss: 0.0691199
	speed: 0.2252s/iter; left time: 138197.3038s
Epoch: 8 cost time: 716.5482776165009
Epoch: 8, Steps: 3195 | Train Loss: 0.0619095 Vali Loss: 0.3609347 Test Loss: 0.5623114
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 9 | loss: 0.0633341
	speed: 4.1434s/iter; left time: 2541287.4884s
	iters: 200, epoch: 9 | loss: 0.0555791
	speed: 0.2230s/iter; left time: 136771.9296s
	iters: 300, epoch: 9 | loss: 0.0664843
	speed: 0.2232s/iter; left time: 136861.3843s
	iters: 400, epoch: 9 | loss: 0.0600164
	speed: 0.2231s/iter; left time: 136748.9112s
	iters: 500, epoch: 9 | loss: 0.0579488
	speed: 0.2238s/iter; left time: 137201.7835s
	iters: 600, epoch: 9 | loss: 0.0577520
	speed: 0.2234s/iter; left time: 136903.7534s
	iters: 700, epoch: 9 | loss: 0.0617490
	speed: 0.2241s/iter; left time: 137340.8811s
	iters: 800, epoch: 9 | loss: 0.0546722
	speed: 0.2230s/iter; left time: 136621.7691s
	iters: 900, epoch: 9 | loss: 0.0582152
	speed: 0.2244s/iter; left time: 137477.2081s
	iters: 1000, epoch: 9 | loss: 0.0602704
	speed: 0.2234s/iter; left time: 136814.4711s
	iters: 1100, epoch: 9 | loss: 0.0651223
	speed: 0.2240s/iter; left time: 137178.7314s
	iters: 1200, epoch: 9 | loss: 0.0542972
	speed: 0.2232s/iter; left time: 136654.6022s
	iters: 1300, epoch: 9 | loss: 0.0621459
	speed: 0.2234s/iter; left time: 136749.4573s
	iters: 1400, epoch: 9 | loss: 0.0587716
	speed: 0.2236s/iter; left time: 136858.0229s
	iters: 1500, epoch: 9 | loss: 0.0455943
	speed: 0.2236s/iter; left time: 136859.3675s
	iters: 1600, epoch: 9 | loss: 0.0583832
	speed: 0.2236s/iter; left time: 136814.6635s
	iters: 1700, epoch: 9 | loss: 0.0555205
	speed: 0.2240s/iter; left time: 137060.0837s
	iters: 1800, epoch: 9 | loss: 0.0585993
	speed: 0.2236s/iter; left time: 136759.0728s
	iters: 1900, epoch: 9 | loss: 0.0647485
	speed: 0.2242s/iter; left time: 137133.8859s
	iters: 2000, epoch: 9 | loss: 0.0503120
	speed: 0.2239s/iter; left time: 136921.3032s
	iters: 2100, epoch: 9 | loss: 0.0660351
	speed: 0.2239s/iter; left time: 136866.9576s
	iters: 2200, epoch: 9 | loss: 0.0535223
	speed: 0.2235s/iter; left time: 136587.3831s
	iters: 2300, epoch: 9 | loss: 0.0508670
	speed: 0.2236s/iter; left time: 136676.9696s
	iters: 2400, epoch: 9 | loss: 0.0609419
	speed: 0.2231s/iter; left time: 136298.8550s
	iters: 2500, epoch: 9 | loss: 0.0485523
	speed: 0.2240s/iter; left time: 136876.1163s
	iters: 2600, epoch: 9 | loss: 0.0571978
	speed: 0.2237s/iter; left time: 136673.5839s
	iters: 2700, epoch: 9 | loss: 0.0582416
	speed: 0.2236s/iter; left time: 136569.3869s
	iters: 2800, epoch: 9 | loss: 0.0466662
	speed: 0.2234s/iter; left time: 136391.8913s
	iters: 2900, epoch: 9 | loss: 0.0527279
	speed: 0.2241s/iter; left time: 136813.4087s
	iters: 3000, epoch: 9 | loss: 0.0497630
	speed: 0.2240s/iter; left time: 136709.2719s
	iters: 3100, epoch: 9 | loss: 0.0488033
	speed: 0.2239s/iter; left time: 136669.3842s
Epoch: 9 cost time: 714.8908367156982
Epoch: 9, Steps: 3195 | Train Loss: 0.0566992 Vali Loss: 0.3639238 Test Loss: 0.4817432
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 10 | loss: 0.0542384
	speed: 4.1513s/iter; left time: 2532925.2679s
	iters: 200, epoch: 10 | loss: 0.0563731
	speed: 0.2235s/iter; left time: 136342.1722s
	iters: 300, epoch: 10 | loss: 0.0469626
	speed: 0.2230s/iter; left time: 136040.1215s
	iters: 400, epoch: 10 | loss: 0.0568724
	speed: 0.2234s/iter; left time: 136223.5991s
	iters: 500, epoch: 10 | loss: 0.0590822
	speed: 0.2233s/iter; left time: 136142.2643s
	iters: 600, epoch: 10 | loss: 0.0578623
	speed: 0.2232s/iter; left time: 136054.5897s
	iters: 700, epoch: 10 | loss: 0.0524366
	speed: 0.2230s/iter; left time: 135935.8395s
	iters: 800, epoch: 10 | loss: 0.0568126
	speed: 0.2228s/iter; left time: 135804.7425s
	iters: 900, epoch: 10 | loss: 0.0546546
	speed: 0.2231s/iter; left time: 135941.6114s
	iters: 1000, epoch: 10 | loss: 0.0672930
	speed: 0.2231s/iter; left time: 135930.2905s
	iters: 1100, epoch: 10 | loss: 0.0464283
	speed: 0.2230s/iter; left time: 135848.1162s
	iters: 1200, epoch: 10 | loss: 0.0587088
	speed: 0.2232s/iter; left time: 135918.3747s
	iters: 1300, epoch: 10 | loss: 0.0477831
	speed: 0.2230s/iter; left time: 135811.0964s
	iters: 1400, epoch: 10 | loss: 0.0569521
	speed: 0.2231s/iter; left time: 135858.3167s
	iters: 1500, epoch: 10 | loss: 0.0572765
	speed: 0.2237s/iter; left time: 136149.3332s
	iters: 1600, epoch: 10 | loss: 0.0597948
	speed: 0.2230s/iter; left time: 135733.1613s
	iters: 1700, epoch: 10 | loss: 0.0510162
	speed: 0.2235s/iter; left time: 136033.5449s
	iters: 1800, epoch: 10 | loss: 0.0466766
	speed: 0.2234s/iter; left time: 135943.6779s
	iters: 1900, epoch: 10 | loss: 0.0532840
	speed: 0.2233s/iter; left time: 135841.8657s
	iters: 2000, epoch: 10 | loss: 0.0449366
	speed: 0.2232s/iter; left time: 135747.9353s
	iters: 2100, epoch: 10 | loss: 0.0529204
	speed: 0.2231s/iter; left time: 135695.2615s
	iters: 2200, epoch: 10 | loss: 0.0542905
	speed: 0.2231s/iter; left time: 135628.1008s
	iters: 2300, epoch: 10 | loss: 0.0588660
	speed: 0.2233s/iter; left time: 135728.8932s
	iters: 2400, epoch: 10 | loss: 0.0565477
	speed: 0.2230s/iter; left time: 135537.1408s
	iters: 2500, epoch: 10 | loss: 0.0501922
	speed: 0.2228s/iter; left time: 135435.5996s
	iters: 2600, epoch: 10 | loss: 0.0490179
	speed: 0.2238s/iter; left time: 135994.9234s
	iters: 2700, epoch: 10 | loss: 0.0462185
	speed: 0.2231s/iter; left time: 135549.8060s
	iters: 2800, epoch: 10 | loss: 0.0545409
	speed: 0.2232s/iter; left time: 135594.0804s
	iters: 2900, epoch: 10 | loss: 0.0501133
	speed: 0.2231s/iter; left time: 135471.1857s
	iters: 3000, epoch: 10 | loss: 0.0527073
	speed: 0.2231s/iter; left time: 135499.0838s
	iters: 3100, epoch: 10 | loss: 0.0504337
	speed: 0.2232s/iter; left time: 135518.2380s
Epoch: 10 cost time: 713.3970010280609
Epoch: 10, Steps: 3195 | Train Loss: 0.0528640 Vali Loss: 0.2431201 Test Loss: 0.3885634
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems10_h_96_336_Autoformer_custom_ftM_sl96_ll48_pl336_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 29002
test shape: (29002, 1, 336, 107) (29002, 1, 336, 107)
test shape: (29002, 336, 107) (29002, 336, 107)
mse:0.329394668340683, mae:0.3860894739627838
>>>>>>>Overall time: 10104 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
