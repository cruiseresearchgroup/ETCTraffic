Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems10_h.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems10_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 102490
val 14575
test 29242
	iters: 100, epoch: 1 | loss: 0.2180912
	speed: 0.1329s/iter; left time: 85089.0398s
	iters: 200, epoch: 1 | loss: 0.1845378
	speed: 0.1295s/iter; left time: 82881.4890s
	iters: 300, epoch: 1 | loss: 0.1422768
	speed: 0.1298s/iter; left time: 83090.4864s
	iters: 400, epoch: 1 | loss: 0.1215330
	speed: 0.1296s/iter; left time: 82951.2786s
	iters: 500, epoch: 1 | loss: 0.1189166
	speed: 0.1293s/iter; left time: 82722.7716s
	iters: 600, epoch: 1 | loss: 0.1143419
	speed: 0.1294s/iter; left time: 82807.4853s
	iters: 700, epoch: 1 | loss: 0.1061258
	speed: 0.1297s/iter; left time: 82941.3109s
	iters: 800, epoch: 1 | loss: 0.0946731
	speed: 0.1297s/iter; left time: 82988.1742s
	iters: 900, epoch: 1 | loss: 0.0957760
	speed: 0.1295s/iter; left time: 82834.7251s
	iters: 1000, epoch: 1 | loss: 0.1016049
	speed: 0.1307s/iter; left time: 83591.5435s
	iters: 1100, epoch: 1 | loss: 0.0816169
	speed: 0.1295s/iter; left time: 82767.3071s
	iters: 1200, epoch: 1 | loss: 0.0711656
	speed: 0.1301s/iter; left time: 83153.9389s
	iters: 1300, epoch: 1 | loss: 0.0970771
	speed: 0.1297s/iter; left time: 82900.9126s
	iters: 1400, epoch: 1 | loss: 0.1032959
	speed: 0.1299s/iter; left time: 82996.3425s
	iters: 1500, epoch: 1 | loss: 0.0774083
	speed: 0.1302s/iter; left time: 83184.9939s
	iters: 1600, epoch: 1 | loss: 0.0923267
	speed: 0.1300s/iter; left time: 83062.0925s
	iters: 1700, epoch: 1 | loss: 0.0776084
	speed: 0.1305s/iter; left time: 83356.6718s
	iters: 1800, epoch: 1 | loss: 0.0710133
	speed: 0.1303s/iter; left time: 83207.8085s
	iters: 1900, epoch: 1 | loss: 0.1150967
	speed: 0.1308s/iter; left time: 83515.7842s
	iters: 2000, epoch: 1 | loss: 0.1066373
	speed: 0.1296s/iter; left time: 82716.3072s
	iters: 2100, epoch: 1 | loss: 0.0676888
	speed: 0.1300s/iter; left time: 82950.5501s
	iters: 2200, epoch: 1 | loss: 0.0784110
	speed: 0.1302s/iter; left time: 83064.8781s
	iters: 2300, epoch: 1 | loss: 0.0680230
	speed: 0.1292s/iter; left time: 82422.7793s
	iters: 2400, epoch: 1 | loss: 0.0792798
	speed: 0.1303s/iter; left time: 83108.2099s
	iters: 2500, epoch: 1 | loss: 0.0647524
	speed: 0.1299s/iter; left time: 82884.8314s
	iters: 2600, epoch: 1 | loss: 0.0847525
	speed: 0.1298s/iter; left time: 82764.1421s
	iters: 2700, epoch: 1 | loss: 0.0923204
	speed: 0.1300s/iter; left time: 82873.6579s
	iters: 2800, epoch: 1 | loss: 0.0891889
	speed: 0.1301s/iter; left time: 82931.0775s
	iters: 2900, epoch: 1 | loss: 0.0948937
	speed: 0.1305s/iter; left time: 83220.1946s
	iters: 3000, epoch: 1 | loss: 0.0932000
	speed: 0.1296s/iter; left time: 82636.2702s
	iters: 3100, epoch: 1 | loss: 0.0889992
	speed: 0.1299s/iter; left time: 82783.1725s
	iters: 3200, epoch: 1 | loss: 0.0763209
	speed: 0.1291s/iter; left time: 82238.9500s
Epoch: 1 cost time: 416.3162214756012
Epoch: 1, Steps: 3202 | Train Loss: 0.1034144 Vali Loss: 0.1912015 Test Loss: 0.2531903
Validation loss decreased (inf --> 0.191201).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0778057
	speed: 3.5870s/iter; left time: 2285242.4293s
	iters: 200, epoch: 2 | loss: 0.0799528
	speed: 0.1290s/iter; left time: 82169.1006s
	iters: 300, epoch: 2 | loss: 0.0624074
	speed: 0.1283s/iter; left time: 81690.8886s
	iters: 400, epoch: 2 | loss: 0.0632506
	speed: 0.1291s/iter; left time: 82234.6638s
	iters: 500, epoch: 2 | loss: 0.0642361
	speed: 0.1289s/iter; left time: 82073.8930s
	iters: 600, epoch: 2 | loss: 0.0960838
	speed: 0.1295s/iter; left time: 82412.2191s
	iters: 700, epoch: 2 | loss: 0.0650689
	speed: 0.1295s/iter; left time: 82397.2034s
	iters: 800, epoch: 2 | loss: 0.0681199
	speed: 0.1287s/iter; left time: 81911.5984s
	iters: 900, epoch: 2 | loss: 0.0793098
	speed: 0.1285s/iter; left time: 81747.9821s
	iters: 1000, epoch: 2 | loss: 0.0832591
	speed: 0.1291s/iter; left time: 82120.2119s
	iters: 1100, epoch: 2 | loss: 0.0646324
	speed: 0.1296s/iter; left time: 82448.6600s
	iters: 1200, epoch: 2 | loss: 0.0556145
	speed: 0.1293s/iter; left time: 82259.8606s
	iters: 1300, epoch: 2 | loss: 0.0616126
	speed: 0.1288s/iter; left time: 81898.2400s
	iters: 1400, epoch: 2 | loss: 0.0612976
	speed: 0.1289s/iter; left time: 81962.0029s
	iters: 1500, epoch: 2 | loss: 0.0788991
	speed: 0.1285s/iter; left time: 81715.6722s
	iters: 1600, epoch: 2 | loss: 0.0548917
	speed: 0.1288s/iter; left time: 81864.5109s
	iters: 1700, epoch: 2 | loss: 0.0688720
	speed: 0.1295s/iter; left time: 82328.4783s
	iters: 1800, epoch: 2 | loss: 0.0618587
	speed: 0.1289s/iter; left time: 81884.6620s
	iters: 1900, epoch: 2 | loss: 0.0585322
	speed: 0.1295s/iter; left time: 82240.7290s
	iters: 2000, epoch: 2 | loss: 0.0808088
	speed: 0.1288s/iter; left time: 81815.2887s
	iters: 2100, epoch: 2 | loss: 0.0500389
	speed: 0.1293s/iter; left time: 82093.9786s
	iters: 2200, epoch: 2 | loss: 0.0526070
	speed: 0.1295s/iter; left time: 82204.3838s
	iters: 2300, epoch: 2 | loss: 0.0695319
	speed: 0.1287s/iter; left time: 81700.1083s
	iters: 2400, epoch: 2 | loss: 0.0603594
	speed: 0.1289s/iter; left time: 81799.4479s
	iters: 2500, epoch: 2 | loss: 0.0633183
	speed: 0.1290s/iter; left time: 81901.8997s
	iters: 2600, epoch: 2 | loss: 0.0571847
	speed: 0.1295s/iter; left time: 82210.9791s
	iters: 2700, epoch: 2 | loss: 0.0658118
	speed: 0.1293s/iter; left time: 82051.0276s
	iters: 2800, epoch: 2 | loss: 0.0792608
	speed: 0.1298s/iter; left time: 82333.2274s
	iters: 2900, epoch: 2 | loss: 0.0592450
	speed: 0.1294s/iter; left time: 82050.4740s
	iters: 3000, epoch: 2 | loss: 0.0589277
	speed: 0.1290s/iter; left time: 81833.2243s
	iters: 3100, epoch: 2 | loss: 0.0667701
	speed: 0.1295s/iter; left time: 82142.0023s
	iters: 3200, epoch: 2 | loss: 0.0661414
	speed: 0.1294s/iter; left time: 82056.6016s
Epoch: 2 cost time: 413.66102266311646
Epoch: 2, Steps: 3202 | Train Loss: 0.0656189 Vali Loss: 0.1829485 Test Loss: 0.2524720
Validation loss decreased (0.191201 --> 0.182948).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0589145
	speed: 3.5686s/iter; left time: 2262129.7695s
	iters: 200, epoch: 3 | loss: 0.0638580
	speed: 0.1303s/iter; left time: 82558.8537s
	iters: 300, epoch: 3 | loss: 0.0685093
	speed: 0.1300s/iter; left time: 82408.5320s
	iters: 400, epoch: 3 | loss: 0.0605796
	speed: 0.1296s/iter; left time: 82130.2353s
	iters: 500, epoch: 3 | loss: 0.0746783
	speed: 0.1314s/iter; left time: 83270.6129s
	iters: 600, epoch: 3 | loss: 0.0520092
	speed: 0.1320s/iter; left time: 83617.4561s
	iters: 700, epoch: 3 | loss: 0.0649297
	speed: 0.1310s/iter; left time: 82947.0248s
	iters: 800, epoch: 3 | loss: 0.0591097
	speed: 0.1307s/iter; left time: 82771.0576s
	iters: 900, epoch: 3 | loss: 0.0619638
	speed: 0.1289s/iter; left time: 81603.3844s
	iters: 1000, epoch: 3 | loss: 0.0613173
	speed: 0.1290s/iter; left time: 81652.7561s
	iters: 1100, epoch: 3 | loss: 0.0510651
	speed: 0.1284s/iter; left time: 81234.8848s
	iters: 1200, epoch: 3 | loss: 0.0580919
	speed: 0.1290s/iter; left time: 81629.2627s
	iters: 1300, epoch: 3 | loss: 0.0563497
	speed: 0.1284s/iter; left time: 81232.3645s
	iters: 1400, epoch: 3 | loss: 0.0613832
	speed: 0.1290s/iter; left time: 81627.1408s
	iters: 1500, epoch: 3 | loss: 0.0475811
	speed: 0.1290s/iter; left time: 81583.1848s
	iters: 1600, epoch: 3 | loss: 0.0553034
	speed: 0.1291s/iter; left time: 81653.5548s
	iters: 1700, epoch: 3 | loss: 0.0536381
	speed: 0.1285s/iter; left time: 81254.3035s
	iters: 1800, epoch: 3 | loss: 0.0531512
	speed: 0.1286s/iter; left time: 81320.2788s
	iters: 1900, epoch: 3 | loss: 0.0473499
	speed: 0.1294s/iter; left time: 81772.8851s
	iters: 2000, epoch: 3 | loss: 0.0512077
	speed: 0.1305s/iter; left time: 82487.0779s
	iters: 2100, epoch: 3 | loss: 0.0544499
	speed: 0.1302s/iter; left time: 82265.4369s
	iters: 2200, epoch: 3 | loss: 0.0578884
	speed: 0.1304s/iter; left time: 82404.3969s
	iters: 2300, epoch: 3 | loss: 0.0434785
	speed: 0.1293s/iter; left time: 81652.3146s
	iters: 2400, epoch: 3 | loss: 0.0486191
	speed: 0.1284s/iter; left time: 81125.0660s
	iters: 2500, epoch: 3 | loss: 0.0450487
	speed: 0.1291s/iter; left time: 81528.3440s
	iters: 2600, epoch: 3 | loss: 0.0558559
	speed: 0.1288s/iter; left time: 81301.5811s
	iters: 2700, epoch: 3 | loss: 0.0609988
	speed: 0.1289s/iter; left time: 81372.6021s
	iters: 2800, epoch: 3 | loss: 0.0515109
	speed: 0.1286s/iter; left time: 81144.6724s
	iters: 2900, epoch: 3 | loss: 0.0656292
	speed: 0.1288s/iter; left time: 81294.1898s
	iters: 3000, epoch: 3 | loss: 0.0512507
	speed: 0.1289s/iter; left time: 81357.8786s
	iters: 3100, epoch: 3 | loss: 0.0486493
	speed: 0.1287s/iter; left time: 81226.9118s
	iters: 3200, epoch: 3 | loss: 0.0503286
	speed: 0.1284s/iter; left time: 80978.8843s
Epoch: 3 cost time: 414.56457471847534
Epoch: 3, Steps: 3202 | Train Loss: 0.0556479 Vali Loss: 0.2805043 Test Loss: 0.2877332
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.0472425
	speed: 3.5704s/iter; left time: 2251857.3997s
	iters: 200, epoch: 4 | loss: 0.0416667
	speed: 0.1291s/iter; left time: 81398.5481s
	iters: 300, epoch: 4 | loss: 0.0587875
	speed: 0.1294s/iter; left time: 81599.0547s
	iters: 400, epoch: 4 | loss: 0.0503913
	speed: 0.1286s/iter; left time: 81040.3149s
	iters: 500, epoch: 4 | loss: 0.0564636
	speed: 0.1291s/iter; left time: 81343.9125s
	iters: 600, epoch: 4 | loss: 0.0469815
	speed: 0.1292s/iter; left time: 81394.6813s
	iters: 700, epoch: 4 | loss: 0.0513511
	speed: 0.1288s/iter; left time: 81139.3918s
	iters: 800, epoch: 4 | loss: 0.0409200
	speed: 0.1295s/iter; left time: 81608.2380s
	iters: 900, epoch: 4 | loss: 0.0554208
	speed: 0.1289s/iter; left time: 81166.7043s
	iters: 1000, epoch: 4 | loss: 0.0557886
	speed: 0.1286s/iter; left time: 80987.7398s
	iters: 1100, epoch: 4 | loss: 0.0538790
	speed: 0.1292s/iter; left time: 81334.8870s
	iters: 1200, epoch: 4 | loss: 0.0559911
	speed: 0.1292s/iter; left time: 81334.9668s
	iters: 1300, epoch: 4 | loss: 0.0454758
	speed: 0.1297s/iter; left time: 81622.0992s
	iters: 1400, epoch: 4 | loss: 0.0542796
	speed: 0.1286s/iter; left time: 80931.6084s
	iters: 1500, epoch: 4 | loss: 0.0465841
	speed: 0.1289s/iter; left time: 81086.6667s
	iters: 1600, epoch: 4 | loss: 0.0508139
	speed: 0.1285s/iter; left time: 80869.8043s
	iters: 1700, epoch: 4 | loss: 0.0426502
	speed: 0.1303s/iter; left time: 81981.8925s
	iters: 1800, epoch: 4 | loss: 0.0488062
	speed: 0.1285s/iter; left time: 80843.5992s
	iters: 1900, epoch: 4 | loss: 0.0513652
	speed: 0.1295s/iter; left time: 81442.4591s
	iters: 2000, epoch: 4 | loss: 0.0437195
	speed: 0.1301s/iter; left time: 81837.5545s
	iters: 2100, epoch: 4 | loss: 0.0470057
	speed: 0.1289s/iter; left time: 81054.2041s
	iters: 2200, epoch: 4 | loss: 0.0506152
	speed: 0.1292s/iter; left time: 81221.0732s
	iters: 2300, epoch: 4 | loss: 0.0518369
	speed: 0.1292s/iter; left time: 81198.7689s
	iters: 2400, epoch: 4 | loss: 0.0456385
	speed: 0.1286s/iter; left time: 80782.5730s
	iters: 2500, epoch: 4 | loss: 0.0419096
	speed: 0.1287s/iter; left time: 80847.1613s
	iters: 2600, epoch: 4 | loss: 0.0522688
	speed: 0.1289s/iter; left time: 80993.2975s
	iters: 2700, epoch: 4 | loss: 0.0505999
	speed: 0.1294s/iter; left time: 81280.2868s
	iters: 2800, epoch: 4 | loss: 0.0551365
	speed: 0.1288s/iter; left time: 80875.9167s
	iters: 2900, epoch: 4 | loss: 0.0529561
	speed: 0.1287s/iter; left time: 80822.9437s
	iters: 3000, epoch: 4 | loss: 0.0460403
	speed: 0.1284s/iter; left time: 80586.8164s
	iters: 3100, epoch: 4 | loss: 0.0488965
	speed: 0.1287s/iter; left time: 80796.1071s
	iters: 3200, epoch: 4 | loss: 0.0431900
	speed: 0.1284s/iter; left time: 80605.0240s
Epoch: 4 cost time: 413.29098653793335
Epoch: 4, Steps: 3202 | Train Loss: 0.0490029 Vali Loss: 0.2748928 Test Loss: 0.2843357
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.0442328
	speed: 3.5680s/iter; left time: 2238911.4789s
	iters: 200, epoch: 5 | loss: 0.0438260
	speed: 0.1293s/iter; left time: 81110.0654s
	iters: 300, epoch: 5 | loss: 0.0486302
	speed: 0.1282s/iter; left time: 80403.7566s
	iters: 400, epoch: 5 | loss: 0.0440538
	speed: 0.1288s/iter; left time: 80770.7939s
	iters: 500, epoch: 5 | loss: 0.0401112
	speed: 0.1281s/iter; left time: 80334.2236s
	iters: 600, epoch: 5 | loss: 0.0374387
	speed: 0.1291s/iter; left time: 80943.1136s
	iters: 700, epoch: 5 | loss: 0.0497383
	speed: 0.1282s/iter; left time: 80363.9546s
	iters: 800, epoch: 5 | loss: 0.0386936
	speed: 0.1285s/iter; left time: 80560.0495s
	iters: 900, epoch: 5 | loss: 0.0498665
	speed: 0.1288s/iter; left time: 80739.5256s
	iters: 1000, epoch: 5 | loss: 0.0442187
	speed: 0.1283s/iter; left time: 80387.2413s
	iters: 1100, epoch: 5 | loss: 0.0428260
	speed: 0.1280s/iter; left time: 80199.1367s
	iters: 1200, epoch: 5 | loss: 0.0462825
	speed: 0.1287s/iter; left time: 80646.4067s
	iters: 1300, epoch: 5 | loss: 0.0403555
	speed: 0.1278s/iter; left time: 80044.1111s
	iters: 1400, epoch: 5 | loss: 0.0396537
	speed: 0.1283s/iter; left time: 80328.3371s
	iters: 1500, epoch: 5 | loss: 0.0544193
	speed: 0.1283s/iter; left time: 80348.9191s
	iters: 1600, epoch: 5 | loss: 0.0436331
	speed: 0.1284s/iter; left time: 80372.3337s
	iters: 1700, epoch: 5 | loss: 0.0552084
	speed: 0.1282s/iter; left time: 80243.1024s
	iters: 1800, epoch: 5 | loss: 0.0516469
	speed: 0.1283s/iter; left time: 80317.1524s
	iters: 1900, epoch: 5 | loss: 0.0441350
	speed: 0.1283s/iter; left time: 80306.8868s
	iters: 2000, epoch: 5 | loss: 0.0402348
	speed: 0.1283s/iter; left time: 80257.5885s
	iters: 2100, epoch: 5 | loss: 0.0393422
	speed: 0.1286s/iter; left time: 80436.3084s
	iters: 2200, epoch: 5 | loss: 0.0423071
	speed: 0.1282s/iter; left time: 80152.9374s
	iters: 2300, epoch: 5 | loss: 0.0403558
	speed: 0.1280s/iter; left time: 80067.7657s
	iters: 2400, epoch: 5 | loss: 0.0432717
	speed: 0.1283s/iter; left time: 80207.9730s
	iters: 2500, epoch: 5 | loss: 0.0524604
	speed: 0.1278s/iter; left time: 79899.8869s
	iters: 2600, epoch: 5 | loss: 0.0435377
	speed: 0.1280s/iter; left time: 79987.4332s
	iters: 2700, epoch: 5 | loss: 0.0404505
	speed: 0.1280s/iter; left time: 79958.0395s
	iters: 2800, epoch: 5 | loss: 0.0522121
	speed: 0.1291s/iter; left time: 80683.0124s
	iters: 2900, epoch: 5 | loss: 0.0486196
	speed: 0.1282s/iter; left time: 80080.1568s
	iters: 3000, epoch: 5 | loss: 0.0398726
	speed: 0.1280s/iter; left time: 79918.8832s
	iters: 3100, epoch: 5 | loss: 0.0412642
	speed: 0.1285s/iter; left time: 80233.0862s
	iters: 3200, epoch: 5 | loss: 0.0439978
	speed: 0.1277s/iter; left time: 79708.5308s
Epoch: 5 cost time: 411.1558737754822
Epoch: 5, Steps: 3202 | Train Loss: 0.0447723 Vali Loss: 0.2657308 Test Loss: 0.3137318
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.0489056
	speed: 3.5464s/iter; left time: 2213967.6690s
	iters: 200, epoch: 6 | loss: 0.0449603
	speed: 0.1278s/iter; left time: 79802.2350s
	iters: 300, epoch: 6 | loss: 0.0411032
	speed: 0.1275s/iter; left time: 79585.3883s
	iters: 400, epoch: 6 | loss: 0.0501446
	speed: 0.1280s/iter; left time: 79856.8305s
	iters: 500, epoch: 6 | loss: 0.0405034
	speed: 0.1289s/iter; left time: 80390.8319s
	iters: 600, epoch: 6 | loss: 0.0443453
	speed: 0.1279s/iter; left time: 79776.7398s
	iters: 700, epoch: 6 | loss: 0.0403190
	speed: 0.1277s/iter; left time: 79658.1763s
	iters: 800, epoch: 6 | loss: 0.0379521
	speed: 0.1281s/iter; left time: 79884.7468s
	iters: 900, epoch: 6 | loss: 0.0430745
	speed: 0.1284s/iter; left time: 80076.7742s
	iters: 1000, epoch: 6 | loss: 0.0392124
	speed: 0.1275s/iter; left time: 79488.9471s
	iters: 1100, epoch: 6 | loss: 0.0553308
	speed: 0.1278s/iter; left time: 79665.5950s
	iters: 1200, epoch: 6 | loss: 0.0404934
	speed: 0.1284s/iter; left time: 80025.0801s
	iters: 1300, epoch: 6 | loss: 0.0387985
	speed: 0.1287s/iter; left time: 80196.9778s
	iters: 1400, epoch: 6 | loss: 0.0436977
	speed: 0.1280s/iter; left time: 79718.3131s
	iters: 1500, epoch: 6 | loss: 0.0430938
	speed: 0.1279s/iter; left time: 79672.6654s
	iters: 1600, epoch: 6 | loss: 0.0456781
	speed: 0.1280s/iter; left time: 79742.7173s
	iters: 1700, epoch: 6 | loss: 0.0389776
	speed: 0.1283s/iter; left time: 79874.8083s
	iters: 1800, epoch: 6 | loss: 0.0398565
	speed: 0.1281s/iter; left time: 79741.5508s
	iters: 1900, epoch: 6 | loss: 0.0452577
	speed: 0.1281s/iter; left time: 79713.4073s
	iters: 2000, epoch: 6 | loss: 0.0448712
	speed: 0.1281s/iter; left time: 79756.4170s
	iters: 2100, epoch: 6 | loss: 0.0406342
	speed: 0.1284s/iter; left time: 79886.8110s
	iters: 2200, epoch: 6 | loss: 0.0418363
	speed: 0.1281s/iter; left time: 79700.5484s
	iters: 2300, epoch: 6 | loss: 0.0475255
	speed: 0.1286s/iter; left time: 80006.5529s
	iters: 2400, epoch: 6 | loss: 0.0420222
	speed: 0.1282s/iter; left time: 79766.1419s
	iters: 2500, epoch: 6 | loss: 0.0408160
	speed: 0.1277s/iter; left time: 79438.1526s
	iters: 2600, epoch: 6 | loss: 0.0425424
	speed: 0.1285s/iter; left time: 79876.1537s
	iters: 2700, epoch: 6 | loss: 0.0420804
	speed: 0.1284s/iter; left time: 79797.8731s
	iters: 2800, epoch: 6 | loss: 0.0367181
	speed: 0.1285s/iter; left time: 79864.0349s
	iters: 2900, epoch: 6 | loss: 0.0354008
	speed: 0.1287s/iter; left time: 79993.8287s
	iters: 3000, epoch: 6 | loss: 0.0393135
	speed: 0.1280s/iter; left time: 79543.6671s
	iters: 3100, epoch: 6 | loss: 0.0403793
	speed: 0.1278s/iter; left time: 79407.9516s
	iters: 3200, epoch: 6 | loss: 0.0398849
	speed: 0.1283s/iter; left time: 79708.3101s
Epoch: 6 cost time: 410.5473532676697
Epoch: 6, Steps: 3202 | Train Loss: 0.0407650 Vali Loss: 0.2209284 Test Loss: 0.3058366
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.0440250
	speed: 3.5544s/iter; left time: 2207611.0503s
	iters: 200, epoch: 7 | loss: 0.0364460
	speed: 0.0958s/iter; left time: 59500.6417s
	iters: 300, epoch: 7 | loss: 0.0385792
	speed: 0.0964s/iter; left time: 59849.3466s
	iters: 400, epoch: 7 | loss: 0.0435214
	speed: 0.0960s/iter; left time: 59593.9155s
	iters: 500, epoch: 7 | loss: 0.0388993
	speed: 0.1285s/iter; left time: 79779.9802s
	iters: 600, epoch: 7 | loss: 0.0355351
	speed: 0.1294s/iter; left time: 80273.3910s
	iters: 700, epoch: 7 | loss: 0.0434771
	speed: 0.1279s/iter; left time: 79343.2107s
	iters: 800, epoch: 7 | loss: 0.0353278
	speed: 0.1284s/iter; left time: 79645.6925s
	iters: 900, epoch: 7 | loss: 0.0359523
	speed: 0.1283s/iter; left time: 79590.0467s
	iters: 1000, epoch: 7 | loss: 0.0356601
	speed: 0.1284s/iter; left time: 79622.4651s
	iters: 1100, epoch: 7 | loss: 0.0345126
	speed: 0.1288s/iter; left time: 79857.4019s
	iters: 1200, epoch: 7 | loss: 0.0403764
	speed: 0.1287s/iter; left time: 79764.5191s
	iters: 1300, epoch: 7 | loss: 0.0331669
	speed: 0.1190s/iter; left time: 73744.8192s
	iters: 1400, epoch: 7 | loss: 0.0348964
	speed: 0.0955s/iter; left time: 59220.7197s
	iters: 1500, epoch: 7 | loss: 0.0348094
	speed: 0.0956s/iter; left time: 59247.5751s
	iters: 1600, epoch: 7 | loss: 0.0359622
	speed: 0.0956s/iter; left time: 59253.0966s
	iters: 1700, epoch: 7 | loss: 0.0413788
	speed: 0.0955s/iter; left time: 59136.7375s
	iters: 1800, epoch: 7 | loss: 0.0421136
	speed: 0.0953s/iter; left time: 59001.0780s
	iters: 1900, epoch: 7 | loss: 0.0389091
	speed: 0.0947s/iter; left time: 58674.8741s
	iters: 2000, epoch: 7 | loss: 0.0354186
	speed: 0.0949s/iter; left time: 58735.6046s
	iters: 2100, epoch: 7 | loss: 0.0354023
	speed: 0.0955s/iter; left time: 59135.6030s
	iters: 2200, epoch: 7 | loss: 0.0366582
	speed: 0.0965s/iter; left time: 59755.1367s
	iters: 2300, epoch: 7 | loss: 0.0428883
	speed: 0.0953s/iter; left time: 58959.5893s
	iters: 2400, epoch: 7 | loss: 0.0369007
	speed: 0.0981s/iter; left time: 60672.3681s
	iters: 2500, epoch: 7 | loss: 0.0336348
	speed: 0.0986s/iter; left time: 60974.7379s
	iters: 2600, epoch: 7 | loss: 0.0320846
	speed: 0.0985s/iter; left time: 60940.2749s
	iters: 2700, epoch: 7 | loss: 0.0352597
	speed: 0.0985s/iter; left time: 60921.2868s
	iters: 2800, epoch: 7 | loss: 0.0370078
	speed: 0.0990s/iter; left time: 61192.9559s
	iters: 2900, epoch: 7 | loss: 0.0379803
	speed: 0.0987s/iter; left time: 61051.1240s
	iters: 3000, epoch: 7 | loss: 0.0369051
	speed: 0.0986s/iter; left time: 60951.7531s
	iters: 3100, epoch: 7 | loss: 0.0390377
	speed: 0.0978s/iter; left time: 60440.6262s
	iters: 3200, epoch: 7 | loss: 0.0375408
	speed: 0.0978s/iter; left time: 60450.7237s
Epoch: 7 cost time: 339.31604528427124
Epoch: 7, Steps: 3202 | Train Loss: 0.0378381 Vali Loss: 0.2629491 Test Loss: 0.3011136
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems10_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 29242
test shape: (29242, 1, 96, 107) (29242, 1, 96, 107)
test shape: (29242, 96, 107) (29242, 96, 107)
mse:0.25247257947921753, mae:0.33998361229896545
>>>>>>>Overall time: 5778 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=107, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems10_h.csv', dec_in=107, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=107, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems10_h_96_96', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=96, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems10_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 102490
val 14575
test 29242
	iters: 100, epoch: 1 | loss: 0.2180912
	speed: 0.1015s/iter; left time: 64967.1479s
	iters: 200, epoch: 1 | loss: 0.1845381
	speed: 0.0962s/iter; left time: 61616.4981s
	iters: 300, epoch: 1 | loss: 0.1422762
	speed: 0.0972s/iter; left time: 62237.6508s
	iters: 400, epoch: 1 | loss: 0.1215332
	speed: 0.0970s/iter; left time: 62060.8331s
	iters: 500, epoch: 1 | loss: 0.1189167
	speed: 0.0972s/iter; left time: 62173.9579s
	iters: 600, epoch: 1 | loss: 0.1143417
	speed: 0.0968s/iter; left time: 61964.3299s
	iters: 700, epoch: 1 | loss: 0.1061258
	speed: 0.0981s/iter; left time: 62778.6845s
	iters: 800, epoch: 1 | loss: 0.0946731
	speed: 0.0971s/iter; left time: 62090.7644s
	iters: 900, epoch: 1 | loss: 0.0957762
	speed: 0.0969s/iter; left time: 61957.0720s
	iters: 1000, epoch: 1 | loss: 0.1016081
	speed: 0.0973s/iter; left time: 62214.0208s
	iters: 1100, epoch: 1 | loss: 0.0816170
	speed: 0.0974s/iter; left time: 62279.6935s
	iters: 1200, epoch: 1 | loss: 0.0711653
	speed: 0.0966s/iter; left time: 61768.3311s
	iters: 1300, epoch: 1 | loss: 0.0970770
	speed: 0.0966s/iter; left time: 61728.2616s
	iters: 1400, epoch: 1 | loss: 0.1032959
	speed: 0.0967s/iter; left time: 61793.3716s
	iters: 1500, epoch: 1 | loss: 0.0774084
	speed: 0.0972s/iter; left time: 62116.6202s
	iters: 1600, epoch: 1 | loss: 0.0923267
	speed: 0.0977s/iter; left time: 62438.4029s
	iters: 1700, epoch: 1 | loss: 0.0776086
	speed: 0.0983s/iter; left time: 62774.0473s
	iters: 1800, epoch: 1 | loss: 0.0710134
	speed: 0.0965s/iter; left time: 61655.0673s
	iters: 1900, epoch: 1 | loss: 0.1150967
	speed: 0.0962s/iter; left time: 61453.8914s
	iters: 2000, epoch: 1 | loss: 0.1066373
	speed: 0.0966s/iter; left time: 61690.5965s
	iters: 2100, epoch: 1 | loss: 0.0676887
	speed: 0.0969s/iter; left time: 61879.3202s
	iters: 2200, epoch: 1 | loss: 0.0784111
	speed: 0.0974s/iter; left time: 62170.0485s
	iters: 2300, epoch: 1 | loss: 0.0680230
	speed: 0.0974s/iter; left time: 62167.2916s
	iters: 2400, epoch: 1 | loss: 0.0792946
	speed: 0.0977s/iter; left time: 62325.9119s
	iters: 2500, epoch: 1 | loss: 0.0647219
	speed: 0.0977s/iter; left time: 62321.6455s
	iters: 2600, epoch: 1 | loss: 0.0847257
	speed: 0.0973s/iter; left time: 62068.8674s
	iters: 2700, epoch: 1 | loss: 0.0907618
	speed: 0.0970s/iter; left time: 61829.4492s
	iters: 2800, epoch: 1 | loss: 0.0869769
	speed: 0.0962s/iter; left time: 61351.3210s
	iters: 2900, epoch: 1 | loss: 0.0954279
	speed: 0.0966s/iter; left time: 61561.0553s
	iters: 3000, epoch: 1 | loss: 0.0937143
	speed: 0.0957s/iter; left time: 61014.6149s
	iters: 3100, epoch: 1 | loss: 0.0887771
	speed: 0.0965s/iter; left time: 61472.3308s
	iters: 3200, epoch: 1 | loss: 0.0752456
	speed: 0.0979s/iter; left time: 62384.2671s
Epoch: 1 cost time: 311.27205872535706
Epoch: 1, Steps: 3202 | Train Loss: 0.1033879 Vali Loss: 0.1917903 Test Loss: 0.2637141
Validation loss decreased (inf --> 0.191790).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.0802710
	speed: 3.5134s/iter; left time: 2238398.7580s
	iters: 200, epoch: 2 | loss: 0.0808766
	speed: 0.1022s/iter; left time: 65095.5177s
	iters: 300, epoch: 2 | loss: 0.0626261
	speed: 0.1028s/iter; left time: 65472.9482s
	iters: 400, epoch: 2 | loss: 0.0629285
	speed: 0.1022s/iter; left time: 65051.2825s
	iters: 500, epoch: 2 | loss: 0.0638525
	speed: 0.1021s/iter; left time: 65036.1610s
	iters: 600, epoch: 2 | loss: 0.0979356
	speed: 0.1022s/iter; left time: 65057.5752s
	iters: 700, epoch: 2 | loss: 0.0650126
	speed: 0.1032s/iter; left time: 65689.7163s
	iters: 800, epoch: 2 | loss: 0.0682166
	speed: 0.1019s/iter; left time: 64819.7216s
	iters: 900, epoch: 2 | loss: 0.0816273
	speed: 0.1014s/iter; left time: 64549.6950s
	iters: 1000, epoch: 2 | loss: 0.0842893
	speed: 0.1021s/iter; left time: 64977.0186s
	iters: 1100, epoch: 2 | loss: 0.0643900
	speed: 0.1025s/iter; left time: 65194.0054s
	iters: 1200, epoch: 2 | loss: 0.0556791
	speed: 0.1019s/iter; left time: 64803.9996s
	iters: 1300, epoch: 2 | loss: 0.0640295
	speed: 0.1028s/iter; left time: 65358.4322s
	iters: 1400, epoch: 2 | loss: 0.0611064
	speed: 0.1024s/iter; left time: 65076.9526s
	iters: 1500, epoch: 2 | loss: 0.0802143
	speed: 0.1022s/iter; left time: 64949.5927s
	iters: 1600, epoch: 2 | loss: 0.0553414
	speed: 0.1020s/iter; left time: 64857.1826s
	iters: 1700, epoch: 2 | loss: 0.0692458
	speed: 0.1027s/iter; left time: 65243.3821s
	iters: 1800, epoch: 2 | loss: 0.0613482
	speed: 0.1018s/iter; left time: 64701.3385s
	iters: 1900, epoch: 2 | loss: 0.0566899
	speed: 0.1028s/iter; left time: 65313.7642s
	iters: 2000, epoch: 2 | loss: 0.0794231
	speed: 0.0991s/iter; left time: 62977.9240s
	iters: 2100, epoch: 2 | loss: 0.0507112
	speed: 0.0971s/iter; left time: 61692.6083s
	iters: 2200, epoch: 2 | loss: 0.0538929
	speed: 0.0968s/iter; left time: 61458.1310s
	iters: 2300, epoch: 2 | loss: 0.0701274
	speed: 0.0970s/iter; left time: 61565.6536s
	iters: 2400, epoch: 2 | loss: 0.0601470
	speed: 0.0972s/iter; left time: 61683.0102s
	iters: 2500, epoch: 2 | loss: 0.0636334
	speed: 0.0973s/iter; left time: 61766.0746s
	iters: 2600, epoch: 2 | loss: 0.0556876
	speed: 0.0982s/iter; left time: 62342.8870s
	iters: 2700, epoch: 2 | loss: 0.0665763
	speed: 0.0973s/iter; left time: 61752.7972s
	iters: 2800, epoch: 2 | loss: 0.0786407
	speed: 0.0970s/iter; left time: 61551.7030s
	iters: 2900, epoch: 2 | loss: 0.0592718
	speed: 0.0974s/iter; left time: 61807.9665s
	iters: 3000, epoch: 2 | loss: 0.0587263
	speed: 0.0976s/iter; left time: 61877.9434s
	iters: 3100, epoch: 2 | loss: 0.0680228
	speed: 0.0977s/iter; left time: 61939.7375s
	iters: 3200, epoch: 2 | loss: 0.0657440
	speed: 0.0980s/iter; left time: 62118.3096s
Epoch: 2 cost time: 321.3494346141815
Epoch: 2, Steps: 3202 | Train Loss: 0.0656625 Vali Loss: 0.1890847 Test Loss: 0.2604136
Validation loss decreased (0.191790 --> 0.189085).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.0585981
	speed: 3.5106s/iter; left time: 2225336.6246s
	iters: 200, epoch: 3 | loss: 0.0603663
	speed: 0.0995s/iter; left time: 63039.9224s
	iters: 300, epoch: 3 | loss: 0.0687854
	speed: 0.0965s/iter; left time: 61132.1382s
	iters: 400, epoch: 3 | loss: 0.0607297
	speed: 0.0959s/iter; left time: 60748.0496s
	iters: 500, epoch: 3 | loss: 0.0743550
	speed: 0.0952s/iter; left time: 60318.6955s
	iters: 600, epoch: 3 | loss: 0.0525078
	speed: 0.0951s/iter; left time: 60249.3061s
	iters: 700, epoch: 3 | loss: 0.0640313
	speed: 0.0951s/iter; left time: 60195.7186s
	iters: 800, epoch: 3 | loss: 0.0590149
	speed: 0.0951s/iter; left time: 60223.2726s
	iters: 900, epoch: 3 | loss: 0.0616128
	speed: 0.0952s/iter; left time: 60284.3828s
	iters: 1000, epoch: 3 | loss: 0.0620802
	speed: 0.0952s/iter; left time: 60279.3203s
	iters: 1100, epoch: 3 | loss: 0.0512652
	speed: 0.0956s/iter; left time: 60500.7731s
	iters: 1200, epoch: 3 | loss: 0.0578692
	speed: 0.0953s/iter; left time: 60273.9314s
	iters: 1300, epoch: 3 | loss: 0.0568572
	speed: 0.0955s/iter; left time: 60406.9113s
	iters: 1400, epoch: 3 | loss: 0.0616043
	speed: 0.0958s/iter; left time: 60627.6357s
	iters: 1500, epoch: 3 | loss: 0.0489198
	speed: 0.0960s/iter; left time: 60751.3038s
	iters: 1600, epoch: 3 | loss: 0.0550211
	speed: 0.0954s/iter; left time: 60316.4992s
	iters: 1700, epoch: 3 | loss: 0.0544973
	speed: 0.0953s/iter; left time: 60259.7476s
	iters: 1800, epoch: 3 | loss: 0.0544544
	speed: 0.0956s/iter; left time: 60421.3684s
	iters: 1900, epoch: 3 | loss: 0.0492015
	speed: 0.0958s/iter; left time: 60546.0202s
	iters: 2000, epoch: 3 | loss: 0.0504828
	speed: 0.0956s/iter; left time: 60397.3943s
	iters: 2100, epoch: 3 | loss: 0.0550980
	speed: 0.0955s/iter; left time: 60363.0156s
	iters: 2200, epoch: 3 | loss: 0.0566905
	speed: 0.0960s/iter; left time: 60642.4085s
	iters: 2300, epoch: 3 | loss: 0.0439854
	speed: 0.0964s/iter; left time: 60896.1924s
	iters: 2400, epoch: 3 | loss: 0.0488875
	speed: 0.0954s/iter; left time: 60279.4876s
	iters: 2500, epoch: 3 | loss: 0.0448224
	speed: 0.0967s/iter; left time: 61034.9421s
	iters: 2600, epoch: 3 | loss: 0.0587163
	speed: 0.0959s/iter; left time: 60568.5755s
	iters: 2700, epoch: 3 | loss: 0.0605543
	speed: 0.0965s/iter; left time: 60889.2292s
	iters: 2800, epoch: 3 | loss: 0.0506501
	speed: 0.0968s/iter; left time: 61112.5924s
	iters: 2900, epoch: 3 | loss: 0.0642229
	speed: 0.0966s/iter; left time: 60977.3576s
	iters: 3000, epoch: 3 | loss: 0.0459288
	speed: 0.0974s/iter; left time: 61477.5219s
	iters: 3100, epoch: 3 | loss: 0.0507829
	speed: 0.0963s/iter; left time: 60769.0999s
	iters: 3200, epoch: 3 | loss: 0.0496489
	speed: 0.0967s/iter; left time: 61029.3959s
Epoch: 3 cost time: 308.0199840068817
Epoch: 3, Steps: 3202 | Train Loss: 0.0556842 Vali Loss: 0.2754542 Test Loss: 0.3060413
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.0470719
	speed: 3.5005s/iter; left time: 2207770.0568s
	iters: 200, epoch: 4 | loss: 0.0425704
	speed: 0.0963s/iter; left time: 60696.9097s
	iters: 300, epoch: 4 | loss: 0.0582614
	speed: 0.0964s/iter; left time: 60807.4199s
	iters: 400, epoch: 4 | loss: 0.0505344
	speed: 0.0968s/iter; left time: 61027.9943s
	iters: 500, epoch: 4 | loss: 0.0565739
	speed: 0.0963s/iter; left time: 60701.1465s
	iters: 600, epoch: 4 | loss: 0.0455449
	speed: 0.0976s/iter; left time: 61500.5862s
	iters: 700, epoch: 4 | loss: 0.0508940
	speed: 0.0972s/iter; left time: 61255.5502s
	iters: 800, epoch: 4 | loss: 0.0409546
	speed: 0.0978s/iter; left time: 61640.0050s
	iters: 900, epoch: 4 | loss: 0.0560719
	speed: 0.0972s/iter; left time: 61200.3659s
	iters: 1000, epoch: 4 | loss: 0.0549428
	speed: 0.0972s/iter; left time: 61185.9997s
	iters: 1100, epoch: 4 | loss: 0.0538759
	speed: 0.0984s/iter; left time: 61969.8678s
	iters: 1200, epoch: 4 | loss: 0.0563797
	speed: 0.0975s/iter; left time: 61372.4892s
	iters: 1300, epoch: 4 | loss: 0.0453771
	speed: 0.0966s/iter; left time: 60788.0393s
	iters: 1400, epoch: 4 | loss: 0.0571693
	speed: 0.0970s/iter; left time: 61082.6222s
	iters: 1500, epoch: 4 | loss: 0.0461973
	speed: 0.0966s/iter; left time: 60775.5031s
	iters: 1600, epoch: 4 | loss: 0.0506537
	speed: 0.0974s/iter; left time: 61298.9663s
	iters: 1700, epoch: 4 | loss: 0.0425751
	speed: 0.0973s/iter; left time: 61180.2666s
	iters: 1800, epoch: 4 | loss: 0.0488584
	speed: 0.0978s/iter; left time: 61539.0452s
	iters: 1900, epoch: 4 | loss: 0.0516039
	speed: 0.0969s/iter; left time: 60963.3810s
	iters: 2000, epoch: 4 | loss: 0.0425868
	speed: 0.0973s/iter; left time: 61161.8672s
	iters: 2100, epoch: 4 | loss: 0.0480835
	speed: 0.0965s/iter; left time: 60681.8120s
	iters: 2200, epoch: 4 | loss: 0.0519644
	speed: 0.0979s/iter; left time: 61508.9055s
	iters: 2300, epoch: 4 | loss: 0.0514049
	speed: 0.0972s/iter; left time: 61092.9898s
	iters: 2400, epoch: 4 | loss: 0.0455716
	speed: 0.0979s/iter; left time: 61503.1382s
	iters: 2500, epoch: 4 | loss: 0.0427507
	speed: 0.0977s/iter; left time: 61411.4373s
	iters: 2600, epoch: 4 | loss: 0.0477936
	speed: 0.0975s/iter; left time: 61272.8624s
	iters: 2700, epoch: 4 | loss: 0.0505266
	speed: 0.0973s/iter; left time: 61137.6709s
	iters: 2800, epoch: 4 | loss: 0.0546941
	speed: 0.0972s/iter; left time: 61069.8630s
	iters: 2900, epoch: 4 | loss: 0.0511422
	speed: 0.0976s/iter; left time: 61252.3915s
	iters: 3000, epoch: 4 | loss: 0.0465560
	speed: 0.0976s/iter; left time: 61249.9376s
	iters: 3100, epoch: 4 | loss: 0.0474171
	speed: 0.0973s/iter; left time: 61081.0600s
	iters: 3200, epoch: 4 | loss: 0.0430246
	speed: 0.0966s/iter; left time: 60620.9193s
Epoch: 4 cost time: 311.3957870006561
Epoch: 4, Steps: 3202 | Train Loss: 0.0492096 Vali Loss: 0.3558984 Test Loss: 0.2986552
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.0450938
	speed: 3.5086s/iter; left time: 2201626.1655s
	iters: 200, epoch: 5 | loss: 0.0427957
	speed: 0.0976s/iter; left time: 61232.3646s
	iters: 300, epoch: 5 | loss: 0.0485445
	speed: 0.0983s/iter; left time: 61646.4620s
	iters: 400, epoch: 5 | loss: 0.0441087
	speed: 0.0976s/iter; left time: 61235.3604s
	iters: 500, epoch: 5 | loss: 0.0402067
	speed: 0.0981s/iter; left time: 61526.7203s
	iters: 600, epoch: 5 | loss: 0.0377888
	speed: 0.0979s/iter; left time: 61373.4375s
	iters: 700, epoch: 5 | loss: 0.0493804
	speed: 0.0978s/iter; left time: 61287.4662s
	iters: 800, epoch: 5 | loss: 0.0394055
	speed: 0.0980s/iter; left time: 61424.3164s
	iters: 900, epoch: 5 | loss: 0.0500670
	speed: 0.0980s/iter; left time: 61396.0923s
	iters: 1000, epoch: 5 | loss: 0.0446688
	speed: 0.0976s/iter; left time: 61160.7981s
	iters: 1100, epoch: 5 | loss: 0.0427740
	speed: 0.0975s/iter; left time: 61101.2306s
	iters: 1200, epoch: 5 | loss: 0.0462282
	speed: 0.0961s/iter; left time: 60171.2500s
	iters: 1300, epoch: 5 | loss: 0.0414333
	speed: 0.0965s/iter; left time: 60457.9589s
	iters: 1400, epoch: 5 | loss: 0.0418878
	speed: 0.0990s/iter; left time: 61991.3877s
	iters: 1500, epoch: 5 | loss: 0.0539535
	speed: 0.0990s/iter; left time: 61970.4642s
	iters: 1600, epoch: 5 | loss: 0.0448161
	speed: 0.0994s/iter; left time: 62248.0723s
	iters: 1700, epoch: 5 | loss: 0.0490632
	speed: 0.0985s/iter; left time: 61667.3193s
	iters: 1800, epoch: 5 | loss: 0.0485364
	speed: 0.0989s/iter; left time: 61868.3767s
	iters: 1900, epoch: 5 | loss: 0.0432368
	speed: 0.0995s/iter; left time: 62253.2793s
	iters: 2000, epoch: 5 | loss: 0.0401914
	speed: 0.0988s/iter; left time: 61831.4170s
	iters: 2100, epoch: 5 | loss: 0.0403689
	speed: 0.0987s/iter; left time: 61740.4309s
	iters: 2200, epoch: 5 | loss: 0.0425764
	speed: 0.0994s/iter; left time: 62167.6684s
	iters: 2300, epoch: 5 | loss: 0.0404853
	speed: 0.0993s/iter; left time: 62081.7902s
	iters: 2400, epoch: 5 | loss: 0.0433981
	speed: 0.0993s/iter; left time: 62053.7260s
	iters: 2500, epoch: 5 | loss: 0.0535800
	speed: 0.0994s/iter; left time: 62106.5556s
	iters: 2600, epoch: 5 | loss: 0.0435826
	speed: 0.0996s/iter; left time: 62249.6830s
	iters: 2700, epoch: 5 | loss: 0.0406689
	speed: 0.0992s/iter; left time: 61972.3152s
	iters: 2800, epoch: 5 | loss: 0.0415912
	speed: 0.0998s/iter; left time: 62378.2947s
	iters: 2900, epoch: 5 | loss: 0.0535142
	speed: 0.0991s/iter; left time: 61916.3795s
	iters: 3000, epoch: 5 | loss: 0.0407872
	speed: 0.0992s/iter; left time: 61948.1477s
	iters: 3100, epoch: 5 | loss: 0.0414660
	speed: 0.0992s/iter; left time: 61966.7079s
	iters: 3200, epoch: 5 | loss: 0.0437606
	speed: 0.0992s/iter; left time: 61957.6308s
Epoch: 5 cost time: 315.83197712898254
Epoch: 5, Steps: 3202 | Train Loss: 0.0444708 Vali Loss: 0.3634529 Test Loss: 0.3460819
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.0500239
	speed: 3.4976s/iter; left time: 2183499.0168s
	iters: 200, epoch: 6 | loss: 0.0446662
	speed: 0.0972s/iter; left time: 60647.0707s
	iters: 300, epoch: 6 | loss: 0.0415728
	speed: 0.0972s/iter; left time: 60662.6691s
	iters: 400, epoch: 6 | loss: 0.0477793
	speed: 0.0971s/iter; left time: 60581.3722s
	iters: 500, epoch: 6 | loss: 0.0402323
	speed: 0.0963s/iter; left time: 60077.6130s
	iters: 600, epoch: 6 | loss: 0.0442470
	speed: 0.0972s/iter; left time: 60652.2016s
	iters: 700, epoch: 6 | loss: 0.0409937
	speed: 0.0965s/iter; left time: 60204.8037s
	iters: 800, epoch: 6 | loss: 0.0377769
	speed: 0.0966s/iter; left time: 60258.1223s
	iters: 900, epoch: 6 | loss: 0.0413522
	speed: 0.0968s/iter; left time: 60344.6965s
	iters: 1000, epoch: 6 | loss: 0.0411464
	speed: 0.0968s/iter; left time: 60362.4963s
	iters: 1100, epoch: 6 | loss: 0.0545076
	speed: 0.0971s/iter; left time: 60521.2636s
	iters: 1200, epoch: 6 | loss: 0.0412150
	speed: 0.0960s/iter; left time: 59854.8673s
	iters: 1300, epoch: 6 | loss: 0.0393649
	speed: 0.0964s/iter; left time: 60040.4882s
	iters: 1400, epoch: 6 | loss: 0.0438581
	speed: 0.0970s/iter; left time: 60449.9386s
	iters: 1500, epoch: 6 | loss: 0.0429078
	speed: 0.0962s/iter; left time: 59913.4124s
	iters: 1600, epoch: 6 | loss: 0.0452041
	speed: 0.0964s/iter; left time: 60018.1999s
	iters: 1700, epoch: 6 | loss: 0.0390341
	speed: 0.0969s/iter; left time: 60329.4765s
	iters: 1800, epoch: 6 | loss: 0.0402029
	speed: 0.0966s/iter; left time: 60123.1442s
	iters: 1900, epoch: 6 | loss: 0.0448877
	speed: 0.0968s/iter; left time: 60279.9404s
	iters: 2000, epoch: 6 | loss: 0.0426261
	speed: 0.0969s/iter; left time: 60295.4666s
	iters: 2100, epoch: 6 | loss: 0.0409162
	speed: 0.0967s/iter; left time: 60180.0223s
	iters: 2200, epoch: 6 | loss: 0.0424812
	speed: 0.0969s/iter; left time: 60290.2994s
	iters: 2300, epoch: 6 | loss: 0.0444116
	speed: 0.0963s/iter; left time: 59933.8314s
	iters: 2400, epoch: 6 | loss: 0.0374473
	speed: 0.0968s/iter; left time: 60209.7717s
	iters: 2500, epoch: 6 | loss: 0.0397730
	speed: 0.0969s/iter; left time: 60279.5348s
	iters: 2600, epoch: 6 | loss: 0.0420437
	speed: 0.0967s/iter; left time: 60139.6103s
	iters: 2700, epoch: 6 | loss: 0.0413338
	speed: 0.0970s/iter; left time: 60292.9239s
	iters: 2800, epoch: 6 | loss: 0.0370911
	speed: 0.0961s/iter; left time: 59755.8735s
	iters: 2900, epoch: 6 | loss: 0.0349581
	speed: 0.0964s/iter; left time: 59900.5784s
	iters: 3000, epoch: 6 | loss: 0.0387908
	speed: 0.0967s/iter; left time: 60070.7350s
	iters: 3100, epoch: 6 | loss: 0.0403542
	speed: 0.0962s/iter; left time: 59789.9623s
	iters: 3200, epoch: 6 | loss: 0.0396745
	speed: 0.0968s/iter; left time: 60108.3021s
Epoch: 6 cost time: 309.9106388092041
Epoch: 6, Steps: 3202 | Train Loss: 0.0404220 Vali Loss: 0.2650447 Test Loss: 0.3723563
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 7 | loss: 0.0444149
	speed: 3.5002s/iter; left time: 2173929.5724s
	iters: 200, epoch: 7 | loss: 0.0367556
	speed: 0.1007s/iter; left time: 62503.1917s
	iters: 300, epoch: 7 | loss: 0.0390842
	speed: 0.0994s/iter; left time: 61692.2985s
	iters: 400, epoch: 7 | loss: 0.0428510
	speed: 0.0975s/iter; left time: 60517.5690s
	iters: 500, epoch: 7 | loss: 0.0391622
	speed: 0.0971s/iter; left time: 60270.5551s
	iters: 600, epoch: 7 | loss: 0.0357615
	speed: 0.0971s/iter; left time: 60283.4073s
	iters: 700, epoch: 7 | loss: 0.0441218
	speed: 0.0969s/iter; left time: 60120.0321s
	iters: 800, epoch: 7 | loss: 0.0347586
	speed: 0.0976s/iter; left time: 60534.3586s
	iters: 900, epoch: 7 | loss: 0.0360588
	speed: 0.0974s/iter; left time: 60442.9091s
	iters: 1000, epoch: 7 | loss: 0.0367000
	speed: 0.0980s/iter; left time: 60750.7572s
	iters: 1100, epoch: 7 | loss: 0.0353481
	speed: 0.0977s/iter; left time: 60570.9670s
	iters: 1200, epoch: 7 | loss: 0.0398192
	speed: 0.0972s/iter; left time: 60235.2863s
	iters: 1300, epoch: 7 | loss: 0.0331069
	speed: 0.0976s/iter; left time: 60485.8698s
	iters: 1400, epoch: 7 | loss: 0.0344606
	speed: 0.0977s/iter; left time: 60535.2421s
	iters: 1500, epoch: 7 | loss: 0.0339781
	speed: 0.0974s/iter; left time: 60361.0063s
	iters: 1600, epoch: 7 | loss: 0.0354987
	speed: 0.0984s/iter; left time: 60990.7272s
	iters: 1700, epoch: 7 | loss: 0.0416190
	speed: 0.0979s/iter; left time: 60652.5574s
	iters: 1800, epoch: 7 | loss: 0.0455261
	speed: 0.0987s/iter; left time: 61126.0559s
	iters: 1900, epoch: 7 | loss: 0.0384738
	speed: 0.0981s/iter; left time: 60763.6004s
	iters: 2000, epoch: 7 | loss: 0.0346557
	speed: 0.0985s/iter; left time: 60992.3436s
	iters: 2100, epoch: 7 | loss: 0.0358063
	speed: 0.0990s/iter; left time: 61275.5635s
	iters: 2200, epoch: 7 | loss: 0.0353730
	speed: 0.0986s/iter; left time: 61062.8177s
	iters: 2300, epoch: 7 | loss: 0.0402039
	speed: 0.0988s/iter; left time: 61168.9072s
	iters: 2400, epoch: 7 | loss: 0.0366817
	speed: 0.0987s/iter; left time: 61070.1067s
	iters: 2500, epoch: 7 | loss: 0.0336837
	speed: 0.0984s/iter; left time: 60864.0399s
	iters: 2600, epoch: 7 | loss: 0.0327748
	speed: 0.0991s/iter; left time: 61316.1784s
	iters: 2700, epoch: 7 | loss: 0.0343729
	speed: 0.0990s/iter; left time: 61246.7722s
	iters: 2800, epoch: 7 | loss: 0.0368772
	speed: 0.0986s/iter; left time: 60965.1800s
	iters: 2900, epoch: 7 | loss: 0.0377520
	speed: 0.0987s/iter; left time: 61034.2159s
	iters: 3000, epoch: 7 | loss: 0.0358519
	speed: 0.0985s/iter; left time: 60894.0183s
	iters: 3100, epoch: 7 | loss: 0.0383529
	speed: 0.0986s/iter; left time: 60959.6183s
	iters: 3200, epoch: 7 | loss: 0.0369619
	speed: 0.0981s/iter; left time: 60616.4106s
Epoch: 7 cost time: 315.02403140068054
Epoch: 7, Steps: 3202 | Train Loss: 0.0376922 Vali Loss: 0.2650723 Test Loss: 0.2984274
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems10_h_96_96_Autoformer_custom_ftM_sl96_ll48_pl96_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 29242
test shape: (29242, 1, 96, 107) (29242, 1, 96, 107)
test shape: (29242, 96, 107) (29242, 96, 107)
mse:0.2604140639305115, mae:0.345885306596756
>>>>>>>Overall time: 5133 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
