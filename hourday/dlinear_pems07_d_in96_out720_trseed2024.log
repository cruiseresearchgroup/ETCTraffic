Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=1613, checkpoints='./checkpoints/', d_conv=4, d_ff=2048, d_layers=1, d_model=512, data='custom', data_path='pems07_d.csv', dec_in=1613, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=1613, expand=2, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='DLinear', model_id='pems07_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems07_d_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4759
val 79
test 873
	iters: 100, epoch: 1 | loss: 0.9323616
	speed: 0.2763s/iter; left time: 8150.9575s
Epoch: 1 cost time: 40.75531792640686
Epoch: 1, Steps: 148 | Train Loss: 0.9775838 Vali Loss: 1.6414025 Test Loss: 2.7849414
Validation loss decreased (inf --> 1.641402).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.9234768
	speed: 0.6291s/iter; left time: 18465.7145s
Epoch: 2 cost time: 40.486021995544434
Epoch: 2, Steps: 148 | Train Loss: 0.9391755 Vali Loss: 1.6417810 Test Loss: 2.7797530
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 3 | loss: 0.9582689
	speed: 0.6296s/iter; left time: 18386.5283s
Epoch: 3 cost time: 40.52018713951111
Epoch: 3, Steps: 148 | Train Loss: 0.9371649 Vali Loss: 1.6425426 Test Loss: 2.7821910
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 4 | loss: 0.9448147
	speed: 0.6300s/iter; left time: 18305.8895s
Epoch: 4 cost time: 40.42708873748779
Epoch: 4, Steps: 148 | Train Loss: 0.9364250 Vali Loss: 1.6435049 Test Loss: 2.7835348
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 5 | loss: 0.9534343
	speed: 0.6286s/iter; left time: 18171.1729s
Epoch: 5 cost time: 40.672141790390015
Epoch: 5, Steps: 148 | Train Loss: 0.9359082 Vali Loss: 1.6412677 Test Loss: 2.7785909
Validation loss decreased (1.641402 --> 1.641268).  Saving model ...
	iters: 100, epoch: 6 | loss: 0.9760832
	speed: 0.6285s/iter; left time: 18076.4029s
Epoch: 6 cost time: 40.51541090011597
Epoch: 6, Steps: 148 | Train Loss: 0.9363797 Vali Loss: 1.6416675 Test Loss: 2.7783623
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 7 | loss: 0.9633622
	speed: 0.6291s/iter; left time: 18001.5183s
Epoch: 7 cost time: 40.4076669216156
Epoch: 7, Steps: 148 | Train Loss: 0.9362798 Vali Loss: 1.6421103 Test Loss: 2.7790251
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 8 | loss: 0.9108354
	speed: 0.6236s/iter; left time: 17750.9966s
Epoch: 8 cost time: 39.991830587387085
Epoch: 8, Steps: 148 | Train Loss: 0.9356579 Vali Loss: 1.6344924 Test Loss: 2.7800364
Validation loss decreased (1.641268 --> 1.634492).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.9110572
	speed: 0.6262s/iter; left time: 17730.8945s
Epoch: 9 cost time: 40.54087591171265
Epoch: 9, Steps: 148 | Train Loss: 0.9362868 Vali Loss: 1.6378381 Test Loss: 2.7822106
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 10 | loss: 0.9052218
	speed: 0.6293s/iter; left time: 17726.0332s
Epoch: 10 cost time: 40.3172972202301
Epoch: 10, Steps: 148 | Train Loss: 0.9359069 Vali Loss: 1.6412387 Test Loss: 2.7810004
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 11 | loss: 0.9422998
	speed: 0.6228s/iter; left time: 17450.2115s
Epoch: 11 cost time: 39.809508085250854
Epoch: 11, Steps: 148 | Train Loss: 0.9359684 Vali Loss: 1.6403894 Test Loss: 2.7816930
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 12 | loss: 0.9341577
	speed: 0.6277s/iter; left time: 17496.2270s
Epoch: 12 cost time: 40.39386987686157
Epoch: 12, Steps: 148 | Train Loss: 0.9363464 Vali Loss: 1.6410844 Test Loss: 2.7820330
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 13 | loss: 0.9072538
	speed: 0.6261s/iter; left time: 17357.9256s
Epoch: 13 cost time: 40.49462652206421
Epoch: 13, Steps: 148 | Train Loss: 0.9360354 Vali Loss: 1.6433080 Test Loss: 2.7822583
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems07_d_96_720_DLinear_custom_ftM_sl96_ll48_pl720_dm512_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 873
test shape: (873, 1, 720, 1613) (873, 1, 720, 1613)
test shape: (873, 720, 1613) (873, 720, 1613)
mse:2.7800331115722656, mae:1.0087621212005615
>>>>>>>Overall time: 852 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
