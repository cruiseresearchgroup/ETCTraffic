Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems04_d.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems04_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_d_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/hourdayweek/exp/exp_long_term_forecasting.py", line 84, in train
    train_data, train_loader = self._get_data(flag='train')
  File "/g/data/hn98/du/exlts/hourdayweek/exp/exp_long_term_forecasting.py", line 31, in _get_data
    data_set, data_loader = data_provider(self.args, flag)
  File "/g/data/hn98/du/exlts/hourdayweek/data_provider/data_factory.py", line 74, in data_provider
    data_set = Data(
  File "/g/data/hn98/du/exlts/hourdayweek/data_provider/data_loader.py", line 320, in __init__
    self.__read_data__()
  File "/g/data/hn98/du/exlts/hourdayweek/data_provider/data_loader.py", line 324, in __read_data__
    df_raw = pd.read_csv(os.path.join(self.root_path,
  File "/jobfs/116408134.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/util/_decorators.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/jobfs/116408134.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/util/_decorators.py", line 331, in wrapper
    return func(*args, **kwargs)
  File "/jobfs/116408134.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 950, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/jobfs/116408134.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 605, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/jobfs/116408134.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1442, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/jobfs/116408134.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1735, in _make_engine
    self.handles = get_handle(
  File "/jobfs/116408134.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/common.py", line 856, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: '../../data/pems/pems04_d.csv'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems04_d.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems04_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_d_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
Traceback (most recent call last):
  File "run.py", line 158, in <module>
    exp.train(setting)
  File "/g/data/hn98/du/exlts/hourdayweek/exp/exp_long_term_forecasting.py", line 84, in train
    train_data, train_loader = self._get_data(flag='train')
  File "/g/data/hn98/du/exlts/hourdayweek/exp/exp_long_term_forecasting.py", line 31, in _get_data
    data_set, data_loader = data_provider(self.args, flag)
  File "/g/data/hn98/du/exlts/hourdayweek/data_provider/data_factory.py", line 74, in data_provider
    data_set = Data(
  File "/g/data/hn98/du/exlts/hourdayweek/data_provider/data_loader.py", line 320, in __init__
    self.__read_data__()
  File "/g/data/hn98/du/exlts/hourdayweek/data_provider/data_loader.py", line 324, in __read_data__
    df_raw = pd.read_csv(os.path.join(self.root_path,
  File "/jobfs/116443177.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/util/_decorators.py", line 211, in wrapper
    return func(*args, **kwargs)
  File "/jobfs/116443177.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/util/_decorators.py", line 331, in wrapper
    return func(*args, **kwargs)
  File "/jobfs/116443177.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 950, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/jobfs/116443177.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 605, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/jobfs/116443177.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1442, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/jobfs/116443177.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/parsers/readers.py", line 1735, in _make_engine
    self.handles = get_handle(
  File "/jobfs/116443177.gadi-pbs/timesnet/lib/python3.8/site-packages/pandas/io/common.py", line 856, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: '../../data/pems/pems04_d.csv'
Args in experiment:
Namespace(activation='gelu', anomaly_ratio=0.25, batch_size=32, c_out=822, checkpoints='./checkpoints/', d_ff=2048, d_layers=1, d_model=128, data='custom', data_path='pems04_d.csv', dec_in=822, des='Exp', devices='0,1,2,3', distil=True, dropout=0, e_layers=2, embed='timeF', enc_in=822, factor=3, features='M', freq='h', gap_day=365, gpu=0, inverse=False, is_training=1, itr=1, label_len=48, learning_rate=0.0005, loss='MSE', lradj='type3', mask_rate=0.25, model='Autoformer', model_id='pems04_d_96_720', moving_avg=25, n_heads=8, num_kernels=6, num_workers=10, output_attention=False, p_hidden_dims=[128, 128], p_hidden_layers=2, patience=5, pred_len=720, root_path='../../data/pems/', samle_rate=1.0, sample_seed=7, seasonal_patterns='Monthly', seq_len=96, target='OT', task_name='long_term_forecast', top_k=5, train_epochs=200, train_seed=2024, use_amp=False, use_gpu=True, use_multi_gpu=False)
Use GPU: cuda:0
>>>>>>>start training : long_term_forecast_pems04_d_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
train 4759
val 79
test 873
	iters: 100, epoch: 1 | loss: 0.7582422
	speed: 0.4479s/iter; left time: 13214.4877s
Epoch: 1 cost time: 67.45562291145325
Epoch: 1, Steps: 148 | Train Loss: 0.8850859 Vali Loss: 0.5386092 Test Loss: 0.8925247
Validation loss decreased (inf --> 0.538609).  Saving model ...
	iters: 100, epoch: 2 | loss: 0.7768485
	speed: 0.7616s/iter; left time: 22354.4197s
Epoch: 2 cost time: 55.09548854827881
Epoch: 2, Steps: 148 | Train Loss: 0.7818419 Vali Loss: 0.5318229 Test Loss: 0.8744184
Validation loss decreased (0.538609 --> 0.531823).  Saving model ...
	iters: 100, epoch: 3 | loss: 0.7789387
	speed: 0.8314s/iter; left time: 24280.1455s
Epoch: 3 cost time: 72.55817174911499
Epoch: 3, Steps: 148 | Train Loss: 0.7572287 Vali Loss: 0.5605735 Test Loss: 0.9104517
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 4 | loss: 0.7627975
	speed: 0.8304s/iter; left time: 24127.6749s
Epoch: 4 cost time: 65.02124452590942
Epoch: 4, Steps: 148 | Train Loss: 0.8214534 Vali Loss: 0.5449691 Test Loss: 0.8906471
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 5 | loss: 0.7693759
	speed: 0.7569s/iter; left time: 21880.3619s
Epoch: 5 cost time: 55.40074920654297
Epoch: 5, Steps: 148 | Train Loss: 0.7910579 Vali Loss: 0.5448165 Test Loss: 0.9040619
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 6 | loss: 0.7685729
	speed: 0.7219s/iter; left time: 20761.3015s
Epoch: 6 cost time: 55.65455937385559
Epoch: 6, Steps: 148 | Train Loss: 0.8099574 Vali Loss: 0.5251518 Test Loss: 0.9164231
Validation loss decreased (0.531823 --> 0.525152).  Saving model ...
	iters: 100, epoch: 7 | loss: 0.8859549
	speed: 0.7182s/iter; left time: 20549.3335s
Epoch: 7 cost time: 55.629486322402954
Epoch: 7, Steps: 148 | Train Loss: 0.7843271 Vali Loss: 0.5260274 Test Loss: 0.9243900
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 8 | loss: 0.7501374
	speed: 0.7139s/iter; left time: 20319.9141s
Epoch: 8 cost time: 55.10384917259216
Epoch: 8, Steps: 148 | Train Loss: 0.7713966 Vali Loss: 0.5247722 Test Loss: 0.9245513
Validation loss decreased (0.525152 --> 0.524772).  Saving model ...
	iters: 100, epoch: 9 | loss: 0.8038235
	speed: 0.7240s/iter; left time: 20502.8080s
Epoch: 9 cost time: 56.6994743347168
Epoch: 9, Steps: 148 | Train Loss: 0.7463219 Vali Loss: 0.5149025 Test Loss: 0.9448525
Validation loss decreased (0.524772 --> 0.514903).  Saving model ...
	iters: 100, epoch: 10 | loss: 0.7473696
	speed: 0.7328s/iter; left time: 20641.1927s
Epoch: 10 cost time: 56.684903144836426
Epoch: 10, Steps: 148 | Train Loss: 0.7182152 Vali Loss: 0.5183153 Test Loss: 0.9098611
EarlyStopping counter: 1 out of 5
	iters: 100, epoch: 11 | loss: 0.7425928
	speed: 0.7171s/iter; left time: 20094.4159s
Epoch: 11 cost time: 55.07035803794861
Epoch: 11, Steps: 148 | Train Loss: 0.6958681 Vali Loss: 0.5201612 Test Loss: 0.9231334
EarlyStopping counter: 2 out of 5
	iters: 100, epoch: 12 | loss: 0.6016499
	speed: 0.7477s/iter; left time: 20840.4562s
Epoch: 12 cost time: 55.47537112236023
Epoch: 12, Steps: 148 | Train Loss: 0.6614915 Vali Loss: 0.5423815 Test Loss: 1.1291821
EarlyStopping counter: 3 out of 5
	iters: 100, epoch: 13 | loss: 0.5869434
	speed: 0.7141s/iter; left time: 19798.8907s
Epoch: 13 cost time: 55.274805784225464
Epoch: 13, Steps: 148 | Train Loss: 0.6937087 Vali Loss: 0.5245749 Test Loss: 0.9038780
EarlyStopping counter: 4 out of 5
	iters: 100, epoch: 14 | loss: 0.7144701
	speed: 0.7190s/iter; left time: 19828.6598s
Epoch: 14 cost time: 55.46752619743347
Epoch: 14, Steps: 148 | Train Loss: 0.6463452 Vali Loss: 0.5294760 Test Loss: 0.9903027
EarlyStopping counter: 5 out of 5
Early stopping
>>>>>>>testing : long_term_forecast_pems04_d_96_720_Autoformer_custom_ftM_sl96_ll48_pl720_dm128_nh8_el2_dl1_df2048_fc3_ebtimeF_dtTrue_srate1.0_sseed7_trainseed2024_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
test 873
test shape: (873, 1, 720, 822) (873, 1, 720, 822)
test shape: (873, 720, 822) (873, 720, 822)
mse:0.9448585510253906, mae:0.6881740689277649
>>>>>>>Overall time: 1087 seconds<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
